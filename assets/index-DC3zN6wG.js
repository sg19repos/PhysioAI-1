var n9=t=>{throw TypeError(t)};var FD=(t,e,n)=>e.has(t)||n9("Cannot "+n);var ye=(t,e,n)=>(FD(t,e,"read from private field"),n?n.call(t):e.get(t)),rn=(t,e,n)=>e.has(t)?n9("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Nt=(t,e,n,r)=>(FD(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),zn=(t,e,n)=>(FD(t,e,"access private method"),n);var CC=(t,e,n,r)=>({set _(i){Nt(t,e,i,n)},get _(){return ye(t,e,r)}});import{Pose as u1e}from"@mediapipe/pose";import{WebGPUBackend as Ote,webgpu_util as nA}from"@tensorflow/tfjs-backend-webgpu";function Dte(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in t)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(t,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();var kc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function lr(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function d1e(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var i=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:function(){return t[r]}})}),n}var $te={exports:{}},Pk={},Lte={exports:{}},On={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var k_=Symbol.for("react.element"),h1e=Symbol.for("react.portal"),f1e=Symbol.for("react.fragment"),p1e=Symbol.for("react.strict_mode"),m1e=Symbol.for("react.profiler"),g1e=Symbol.for("react.provider"),y1e=Symbol.for("react.context"),v1e=Symbol.for("react.forward_ref"),x1e=Symbol.for("react.suspense"),b1e=Symbol.for("react.memo"),w1e=Symbol.for("react.lazy"),r9=Symbol.iterator;function S1e(t){return t===null||typeof t!="object"?null:(t=r9&&t[r9]||t["@@iterator"],typeof t=="function"?t:null)}var Fte={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jte=Object.assign,zte={};function $0(t,e,n){this.props=t,this.context=e,this.refs=zte,this.updater=n||Fte}$0.prototype.isReactComponent={};$0.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};$0.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Bte(){}Bte.prototype=$0.prototype;function bB(t,e,n){this.props=t,this.context=e,this.refs=zte,this.updater=n||Fte}var wB=bB.prototype=new Bte;wB.constructor=bB;jte(wB,$0.prototype);wB.isPureReactComponent=!0;var i9=Array.isArray,Ute=Object.prototype.hasOwnProperty,SB={current:null},Vte={key:!0,ref:!0,__self:!0,__source:!0};function Wte(t,e,n){var r,i={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)Ute.call(e,r)&&!Vte.hasOwnProperty(r)&&(i[r]=e[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:k_,type:t,key:s,ref:a,props:i,_owner:SB.current}}function _1e(t,e){return{$$typeof:k_,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function _B(t){return typeof t=="object"&&t!==null&&t.$$typeof===k_}function T1e(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var s9=/\/+/g;function jD(t,e){return typeof t=="object"&&t!==null&&t.key!=null?T1e(""+t.key):e.toString(36)}function S2(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case k_:case h1e:a=!0}}if(a)return a=t,i=i(a),t=r===""?"."+jD(a,0):r,i9(i)?(n="",t!=null&&(n=t.replace(s9,"$&/")+"/"),S2(i,e,n,"",function(c){return c})):i!=null&&(_B(i)&&(i=_1e(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(s9,"$&/")+"/")+t)),e.push(i)),1;if(a=0,r=r===""?".":r+":",i9(t))for(var o=0;o<t.length;o++){s=t[o];var l=r+jD(s,o);a+=S2(s,e,n,l,i)}else if(l=S1e(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=r+jD(s,o++),a+=S2(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function NC(t,e,n){if(t==null)return t;var r=[],i=0;return S2(t,r,"","",function(s){return e.call(n,s,i++)}),r}function E1e(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Xa={current:null},_2={transition:null},C1e={ReactCurrentDispatcher:Xa,ReactCurrentBatchConfig:_2,ReactCurrentOwner:SB};function Hte(){throw Error("act(...) is not supported in production builds of React.")}On.Children={map:NC,forEach:function(t,e,n){NC(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return NC(t,function(){e++}),e},toArray:function(t){return NC(t,function(e){return e})||[]},only:function(t){if(!_B(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};On.Component=$0;On.Fragment=f1e;On.Profiler=m1e;On.PureComponent=bB;On.StrictMode=p1e;On.Suspense=x1e;On.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=C1e;On.act=Hte;On.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=jte({},t.props),i=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=SB.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)Ute.call(e,l)&&!Vte.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];r.children=o}return{$$typeof:k_,type:t.type,key:i,ref:s,props:r,_owner:a}};On.createContext=function(t){return t={$$typeof:y1e,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:g1e,_context:t},t.Consumer=t};On.createElement=Wte;On.createFactory=function(t){var e=Wte.bind(null,t);return e.type=t,e};On.createRef=function(){return{current:null}};On.forwardRef=function(t){return{$$typeof:v1e,render:t}};On.isValidElement=_B;On.lazy=function(t){return{$$typeof:w1e,_payload:{_status:-1,_result:t},_init:E1e}};On.memo=function(t,e){return{$$typeof:b1e,type:t,compare:e===void 0?null:e}};On.startTransition=function(t){var e=_2.transition;_2.transition={};try{t()}finally{_2.transition=e}};On.unstable_act=Hte;On.useCallback=function(t,e){return Xa.current.useCallback(t,e)};On.useContext=function(t){return Xa.current.useContext(t)};On.useDebugValue=function(){};On.useDeferredValue=function(t){return Xa.current.useDeferredValue(t)};On.useEffect=function(t,e){return Xa.current.useEffect(t,e)};On.useId=function(){return Xa.current.useId()};On.useImperativeHandle=function(t,e,n){return Xa.current.useImperativeHandle(t,e,n)};On.useInsertionEffect=function(t,e){return Xa.current.useInsertionEffect(t,e)};On.useLayoutEffect=function(t,e){return Xa.current.useLayoutEffect(t,e)};On.useMemo=function(t,e){return Xa.current.useMemo(t,e)};On.useReducer=function(t,e,n){return Xa.current.useReducer(t,e,n)};On.useRef=function(t){return Xa.current.useRef(t)};On.useState=function(t){return Xa.current.useState(t)};On.useSyncExternalStore=function(t,e,n){return Xa.current.useSyncExternalStore(t,e,n)};On.useTransition=function(){return Xa.current.useTransition()};On.version="18.3.1";Lte.exports=On;var P=Lte.exports;const le=lr(P),TB=Dte({__proto__:null,default:le},[P]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N1e=P,A1e=Symbol.for("react.element"),I1e=Symbol.for("react.fragment"),k1e=Object.prototype.hasOwnProperty,M1e=N1e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,R1e={key:!0,ref:!0,__self:!0,__source:!0};function Gte(t,e,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)k1e.call(e,r)&&!R1e.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:A1e,type:t,key:s,ref:a,props:i,_owner:M1e.current}}Pk.Fragment=I1e;Pk.jsx=Gte;Pk.jsxs=Gte;$te.exports=Pk;var v=$te.exports,qte={exports:{}},rl={},Xte={exports:{}},Kte={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,V){var H=L.length;L.push(V);e:for(;0<H;){var K=H-1>>>1,te=L[K];if(0<i(te,V))L[K]=V,L[H]=te,H=K;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var V=L[0],H=L.pop();if(H!==V){L[0]=H;e:for(var K=0,te=L.length,J=te>>>1;K<J;){var oe=2*(K+1)-1,fe=L[oe],Ee=oe+1,me=L[Ee];if(0>i(fe,H))Ee<te&&0>i(me,fe)?(L[K]=me,L[Ee]=H,K=Ee):(L[K]=fe,L[oe]=H,K=oe);else if(Ee<te&&0>i(me,H))L[K]=me,L[Ee]=H,K=Ee;else break e}}return V}function i(L,V){var H=L.sortIndex-V.sortIndex;return H!==0?H:L.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(L){for(var V=n(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=L)r(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(c)}}function _(L){if(g=!1,b(L),!p)if(n(l)!==null)p=!0,B(T);else{var V=n(c);V!==null&&W(_,V.startTime-L)}}function T(L,V){p=!1,g&&(g=!1,y(I),I=-1),f=!0;var H=h;try{for(b(V),d=n(l);d!==null&&(!(d.expirationTime>V)||L&&!R());){var K=d.callback;if(typeof K=="function"){d.callback=null,h=d.priorityLevel;var te=K(d.expirationTime<=V);V=t.unstable_now(),typeof te=="function"?d.callback=te:d===n(l)&&r(l),b(V)}else r(l);d=n(l)}if(d!==null)var J=!0;else{var oe=n(c);oe!==null&&W(_,oe.startTime-V),J=!1}return J}finally{d=null,h=H,f=!1}}var E=!1,C=null,I=-1,A=5,k=-1;function R(){return!(t.unstable_now()-k<A)}function $(){if(C!==null){var L=t.unstable_now();k=L;var V=!0;try{V=C(!0,L)}finally{V?z():(E=!1,C=null)}}else E=!1}var z;if(typeof x=="function")z=function(){x($)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,j=O.port2;O.port1.onmessage=$,z=function(){j.postMessage(null)}}else z=function(){m($,0)};function B(L){C=L,E||(E=!0,z())}function W(L,V){I=m(function(){L(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,B(T))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var H=h;h=V;try{return L()}finally{h=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,V){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var H=h;h=L;try{return V()}finally{h=H}},t.unstable_scheduleCallback=function(L,V,H){var K=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?K+H:K):H=K,L){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=H+te,L={id:u++,callback:V,priorityLevel:L,startTime:H,expirationTime:te,sortIndex:-1},H>K?(L.sortIndex=H,e(c,L),n(l)===null&&L===n(c)&&(g?(y(I),I=-1):g=!0,W(_,H-K))):(L.sortIndex=te,e(l,L),p||f||(p=!0,B(T))),L},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(L){var V=h;return function(){var H=h;h=V;try{return L.apply(this,arguments)}finally{h=H}}}})(Kte);Xte.exports=Kte;var P1e=Xte.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var O1e=P,Qo=P1e;function Qe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Yte=new Set,C1={};function Wg(t,e){Px(t,e),Px(t+"Capture",e)}function Px(t,e){for(C1[t]=e,t=0;t<e.length;t++)Yte.add(e[t])}var Yd=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),C3=Object.prototype.hasOwnProperty,D1e=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,a9={},o9={};function $1e(t){return C3.call(o9,t)?!0:C3.call(a9,t)?!1:D1e.test(t)?o9[t]=!0:(a9[t]=!0,!1)}function L1e(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function F1e(t,e,n,r){if(e===null||typeof e>"u"||L1e(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ka(t,e,n,r,i,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var Gs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gs[t]=new Ka(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gs[e]=new Ka(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gs[t]=new Ka(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gs[t]=new Ka(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gs[t]=new Ka(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gs[t]=new Ka(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gs[t]=new Ka(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gs[t]=new Ka(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gs[t]=new Ka(t,5,!1,t.toLowerCase(),null,!1,!1)});var EB=/[\-:]([a-z])/g;function CB(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(EB,CB);Gs[e]=new Ka(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(EB,CB);Gs[e]=new Ka(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(EB,CB);Gs[e]=new Ka(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gs[t]=new Ka(t,1,!1,t.toLowerCase(),null,!1,!1)});Gs.xlinkHref=new Ka("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gs[t]=new Ka(t,1,!1,t.toLowerCase(),null,!0,!0)});function NB(t,e,n,r){var i=Gs.hasOwnProperty(e)?Gs[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(F1e(e,n,i,r)&&(n=null),r||i===null?$1e(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ph=O1e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,AC=Symbol.for("react.element"),bv=Symbol.for("react.portal"),wv=Symbol.for("react.fragment"),AB=Symbol.for("react.strict_mode"),N3=Symbol.for("react.profiler"),Zte=Symbol.for("react.provider"),Qte=Symbol.for("react.context"),IB=Symbol.for("react.forward_ref"),A3=Symbol.for("react.suspense"),I3=Symbol.for("react.suspense_list"),kB=Symbol.for("react.memo"),Xh=Symbol.for("react.lazy"),Jte=Symbol.for("react.offscreen"),l9=Symbol.iterator;function Zb(t){return t===null||typeof t!="object"?null:(t=l9&&t[l9]||t["@@iterator"],typeof t=="function"?t:null)}var ui=Object.assign,zD;function Lw(t){if(zD===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);zD=e&&e[1]||""}return`
`+zD+t}var BD=!1;function UD(t,e){if(!t||BD)return"";BD=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{BD=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Lw(t):""}function j1e(t){switch(t.tag){case 5:return Lw(t.type);case 16:return Lw("Lazy");case 13:return Lw("Suspense");case 19:return Lw("SuspenseList");case 0:case 2:case 15:return t=UD(t.type,!1),t;case 11:return t=UD(t.type.render,!1),t;case 1:return t=UD(t.type,!0),t;default:return""}}function k3(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case wv:return"Fragment";case bv:return"Portal";case N3:return"Profiler";case AB:return"StrictMode";case A3:return"Suspense";case I3:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Qte:return(t.displayName||"Context")+".Consumer";case Zte:return(t._context.displayName||"Context")+".Provider";case IB:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case kB:return e=t.displayName||null,e!==null?e:k3(t.type)||"Memo";case Xh:e=t._payload,t=t._init;try{return k3(t(e))}catch{}}return null}function z1e(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return k3(e);case 8:return e===AB?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ff(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function ene(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function B1e(t){var e=ene(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function IC(t){t._valueTracker||(t._valueTracker=B1e(t))}function tne(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=ene(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function rA(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function M3(t,e){var n=e.checked;return ui({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function c9(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ff(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function nne(t,e){e=e.checked,e!=null&&NB(t,"checked",e,!1)}function R3(t,e){nne(t,e);var n=Ff(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?P3(t,e.type,n):e.hasOwnProperty("defaultValue")&&P3(t,e.type,Ff(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function u9(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function P3(t,e,n){(e!=="number"||rA(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Fw=Array.isArray;function Hv(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ff(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function O3(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Qe(91));return ui({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function d9(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Qe(92));if(Fw(n)){if(1<n.length)throw Error(Qe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ff(n)}}function rne(t,e){var n=Ff(e.value),r=Ff(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function h9(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ine(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function D3(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ine(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var kC,sne=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(kC=kC||document.createElement("div"),kC.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=kC.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function N1(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var t1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},U1e=["Webkit","ms","Moz","O"];Object.keys(t1).forEach(function(t){U1e.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),t1[e]=t1[t]})});function ane(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||t1.hasOwnProperty(t)&&t1[t]?(""+e).trim():e+"px"}function one(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=ane(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var V1e=ui({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $3(t,e){if(e){if(V1e[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Qe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Qe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Qe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Qe(62))}}function L3(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var F3=null;function MB(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var j3=null,Gv=null,qv=null;function f9(t){if(t=P_(t)){if(typeof j3!="function")throw Error(Qe(280));var e=t.stateNode;e&&(e=Fk(e),j3(t.stateNode,t.type,e))}}function lne(t){Gv?qv?qv.push(t):qv=[t]:Gv=t}function cne(){if(Gv){var t=Gv,e=qv;if(qv=Gv=null,f9(t),e)for(t=0;t<e.length;t++)f9(e[t])}}function une(t,e){return t(e)}function dne(){}var VD=!1;function hne(t,e,n){if(VD)return t(e,n);VD=!0;try{return une(t,e,n)}finally{VD=!1,(Gv!==null||qv!==null)&&(dne(),cne())}}function A1(t,e){var n=t.stateNode;if(n===null)return null;var r=Fk(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Qe(231,e,typeof n));return n}var z3=!1;if(Yd)try{var Qb={};Object.defineProperty(Qb,"passive",{get:function(){z3=!0}}),window.addEventListener("test",Qb,Qb),window.removeEventListener("test",Qb,Qb)}catch{z3=!1}function W1e(t,e,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var n1=!1,iA=null,sA=!1,B3=null,H1e={onError:function(t){n1=!0,iA=t}};function G1e(t,e,n,r,i,s,a,o,l){n1=!1,iA=null,W1e.apply(H1e,arguments)}function q1e(t,e,n,r,i,s,a,o,l){if(G1e.apply(this,arguments),n1){if(n1){var c=iA;n1=!1,iA=null}else throw Error(Qe(198));sA||(sA=!0,B3=c)}}function Hg(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function fne(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function p9(t){if(Hg(t)!==t)throw Error(Qe(188))}function X1e(t){var e=t.alternate;if(!e){if(e=Hg(t),e===null)throw Error(Qe(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return p9(i),t;if(s===r)return p9(i),e;s=s.sibling}throw Error(Qe(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(Qe(189))}}if(n.alternate!==r)throw Error(Qe(190))}if(n.tag!==3)throw Error(Qe(188));return n.stateNode.current===n?t:e}function pne(t){return t=X1e(t),t!==null?mne(t):null}function mne(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=mne(t);if(e!==null)return e;t=t.sibling}return null}var gne=Qo.unstable_scheduleCallback,m9=Qo.unstable_cancelCallback,K1e=Qo.unstable_shouldYield,Y1e=Qo.unstable_requestPaint,ki=Qo.unstable_now,Z1e=Qo.unstable_getCurrentPriorityLevel,RB=Qo.unstable_ImmediatePriority,yne=Qo.unstable_UserBlockingPriority,aA=Qo.unstable_NormalPriority,Q1e=Qo.unstable_LowPriority,vne=Qo.unstable_IdlePriority,Ok=null,Mu=null;function J1e(t){if(Mu&&typeof Mu.onCommitFiberRoot=="function")try{Mu.onCommitFiberRoot(Ok,t,void 0,(t.current.flags&128)===128)}catch{}}var Dc=Math.clz32?Math.clz32:nSe,eSe=Math.log,tSe=Math.LN2;function nSe(t){return t>>>=0,t===0?32:31-(eSe(t)/tSe|0)|0}var MC=64,RC=4194304;function jw(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function oA(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=jw(o):(s&=a,s!==0&&(r=jw(s)))}else a=n&~i,a!==0?r=jw(a):s!==0&&(r=jw(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Dc(e),i=1<<n,r|=t[n],e&=~i;return r}function rSe(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iSe(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-Dc(s),o=1<<a,l=i[a];l===-1?(!(o&n)||o&r)&&(i[a]=rSe(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function U3(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function xne(){var t=MC;return MC<<=1,!(MC&4194240)&&(MC=64),t}function WD(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function M_(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Dc(e),t[e]=n}function sSe(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Dc(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function PB(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Dc(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var pr=0;function bne(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var wne,OB,Sne,_ne,Tne,V3=!1,PC=[],wf=null,Sf=null,_f=null,I1=new Map,k1=new Map,Jh=[],aSe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function g9(t,e){switch(t){case"focusin":case"focusout":wf=null;break;case"dragenter":case"dragleave":Sf=null;break;case"mouseover":case"mouseout":_f=null;break;case"pointerover":case"pointerout":I1.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":k1.delete(e.pointerId)}}function Jb(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=P_(e),e!==null&&OB(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function oSe(t,e,n,r,i){switch(e){case"focusin":return wf=Jb(wf,t,e,n,r,i),!0;case"dragenter":return Sf=Jb(Sf,t,e,n,r,i),!0;case"mouseover":return _f=Jb(_f,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return I1.set(s,Jb(I1.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,k1.set(s,Jb(k1.get(s)||null,t,e,n,r,i)),!0}return!1}function Ene(t){var e=wm(t.target);if(e!==null){var n=Hg(e);if(n!==null){if(e=n.tag,e===13){if(e=fne(n),e!==null){t.blockedOn=e,Tne(t.priority,function(){Sne(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function T2(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=W3(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);F3=r,n.target.dispatchEvent(r),F3=null}else return e=P_(n),e!==null&&OB(e),t.blockedOn=n,!1;e.shift()}return!0}function y9(t,e,n){T2(t)&&n.delete(e)}function lSe(){V3=!1,wf!==null&&T2(wf)&&(wf=null),Sf!==null&&T2(Sf)&&(Sf=null),_f!==null&&T2(_f)&&(_f=null),I1.forEach(y9),k1.forEach(y9)}function ew(t,e){t.blockedOn===e&&(t.blockedOn=null,V3||(V3=!0,Qo.unstable_scheduleCallback(Qo.unstable_NormalPriority,lSe)))}function M1(t){function e(i){return ew(i,t)}if(0<PC.length){ew(PC[0],t);for(var n=1;n<PC.length;n++){var r=PC[n];r.blockedOn===t&&(r.blockedOn=null)}}for(wf!==null&&ew(wf,t),Sf!==null&&ew(Sf,t),_f!==null&&ew(_f,t),I1.forEach(e),k1.forEach(e),n=0;n<Jh.length;n++)r=Jh[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Jh.length&&(n=Jh[0],n.blockedOn===null);)Ene(n),n.blockedOn===null&&Jh.shift()}var Xv=ph.ReactCurrentBatchConfig,lA=!0;function cSe(t,e,n,r){var i=pr,s=Xv.transition;Xv.transition=null;try{pr=1,DB(t,e,n,r)}finally{pr=i,Xv.transition=s}}function uSe(t,e,n,r){var i=pr,s=Xv.transition;Xv.transition=null;try{pr=4,DB(t,e,n,r)}finally{pr=i,Xv.transition=s}}function DB(t,e,n,r){if(lA){var i=W3(t,e,n,r);if(i===null)e$(t,e,r,cA,n),g9(t,r);else if(oSe(i,t,e,n,r))r.stopPropagation();else if(g9(t,r),e&4&&-1<aSe.indexOf(t)){for(;i!==null;){var s=P_(i);if(s!==null&&wne(s),s=W3(t,e,n,r),s===null&&e$(t,e,r,cA,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else e$(t,e,r,null,n)}}var cA=null;function W3(t,e,n,r){if(cA=null,t=MB(r),t=wm(t),t!==null)if(e=Hg(t),e===null)t=null;else if(n=e.tag,n===13){if(t=fne(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return cA=t,null}function Cne(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Z1e()){case RB:return 1;case yne:return 4;case aA:case Q1e:return 16;case vne:return 536870912;default:return 16}default:return 16}}var ff=null,$B=null,E2=null;function Nne(){if(E2)return E2;var t,e=$B,n=e.length,r,i="value"in ff?ff.value:ff.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===i[s-r];r++);return E2=i.slice(t,1<r?1-r:void 0)}function C2(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function OC(){return!0}function v9(){return!1}function il(t){function e(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?OC:v9,this.isPropagationStopped=v9,this}return ui(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=OC)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=OC)},persist:function(){},isPersistent:OC}),e}var L0={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},LB=il(L0),R_=ui({},L0,{view:0,detail:0}),dSe=il(R_),HD,GD,tw,Dk=ui({},R_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:FB,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==tw&&(tw&&t.type==="mousemove"?(HD=t.screenX-tw.screenX,GD=t.screenY-tw.screenY):GD=HD=0,tw=t),HD)},movementY:function(t){return"movementY"in t?t.movementY:GD}}),x9=il(Dk),hSe=ui({},Dk,{dataTransfer:0}),fSe=il(hSe),pSe=ui({},R_,{relatedTarget:0}),qD=il(pSe),mSe=ui({},L0,{animationName:0,elapsedTime:0,pseudoElement:0}),gSe=il(mSe),ySe=ui({},L0,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),vSe=il(ySe),xSe=ui({},L0,{data:0}),b9=il(xSe),bSe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},wSe={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},SSe={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _Se(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=SSe[t])?!!e[t]:!1}function FB(){return _Se}var TSe=ui({},R_,{key:function(t){if(t.key){var e=bSe[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=C2(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?wSe[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:FB,charCode:function(t){return t.type==="keypress"?C2(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?C2(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),ESe=il(TSe),CSe=ui({},Dk,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),w9=il(CSe),NSe=ui({},R_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:FB}),ASe=il(NSe),ISe=ui({},L0,{propertyName:0,elapsedTime:0,pseudoElement:0}),kSe=il(ISe),MSe=ui({},Dk,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),RSe=il(MSe),PSe=[9,13,27,32],jB=Yd&&"CompositionEvent"in window,r1=null;Yd&&"documentMode"in document&&(r1=document.documentMode);var OSe=Yd&&"TextEvent"in window&&!r1,Ane=Yd&&(!jB||r1&&8<r1&&11>=r1),S9=" ",_9=!1;function Ine(t,e){switch(t){case"keyup":return PSe.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kne(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sv=!1;function DSe(t,e){switch(t){case"compositionend":return kne(e);case"keypress":return e.which!==32?null:(_9=!0,S9);case"textInput":return t=e.data,t===S9&&_9?null:t;default:return null}}function $Se(t,e){if(Sv)return t==="compositionend"||!jB&&Ine(t,e)?(t=Nne(),E2=$B=ff=null,Sv=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ane&&e.locale!=="ko"?null:e.data;default:return null}}var LSe={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function T9(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!LSe[t.type]:e==="textarea"}function Mne(t,e,n,r){lne(r),e=uA(e,"onChange"),0<e.length&&(n=new LB("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var i1=null,R1=null;function FSe(t){Une(t,0)}function $k(t){var e=Ev(t);if(tne(e))return t}function jSe(t,e){if(t==="change")return e}var Rne=!1;if(Yd){var XD;if(Yd){var KD="oninput"in document;if(!KD){var E9=document.createElement("div");E9.setAttribute("oninput","return;"),KD=typeof E9.oninput=="function"}XD=KD}else XD=!1;Rne=XD&&(!document.documentMode||9<document.documentMode)}function C9(){i1&&(i1.detachEvent("onpropertychange",Pne),R1=i1=null)}function Pne(t){if(t.propertyName==="value"&&$k(R1)){var e=[];Mne(e,R1,t,MB(t)),hne(FSe,e)}}function zSe(t,e,n){t==="focusin"?(C9(),i1=e,R1=n,i1.attachEvent("onpropertychange",Pne)):t==="focusout"&&C9()}function BSe(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return $k(R1)}function USe(t,e){if(t==="click")return $k(e)}function VSe(t,e){if(t==="input"||t==="change")return $k(e)}function WSe(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Uc=typeof Object.is=="function"?Object.is:WSe;function P1(t,e){if(Uc(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!C3.call(e,i)||!Uc(t[i],e[i]))return!1}return!0}function N9(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function A9(t,e){var n=N9(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=N9(n)}}function One(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?One(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function Dne(){for(var t=window,e=rA();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=rA(t.document)}return e}function zB(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function HSe(t){var e=Dne(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&One(n.ownerDocument.documentElement,n)){if(r!==null&&zB(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=A9(n,s);var a=A9(n,r);i&&a&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var GSe=Yd&&"documentMode"in document&&11>=document.documentMode,_v=null,H3=null,s1=null,G3=!1;function I9(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G3||_v==null||_v!==rA(r)||(r=_v,"selectionStart"in r&&zB(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),s1&&P1(s1,r)||(s1=r,r=uA(H3,"onSelect"),0<r.length&&(e=new LB("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=_v)))}function DC(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Tv={animationend:DC("Animation","AnimationEnd"),animationiteration:DC("Animation","AnimationIteration"),animationstart:DC("Animation","AnimationStart"),transitionend:DC("Transition","TransitionEnd")},YD={},$ne={};Yd&&($ne=document.createElement("div").style,"AnimationEvent"in window||(delete Tv.animationend.animation,delete Tv.animationiteration.animation,delete Tv.animationstart.animation),"TransitionEvent"in window||delete Tv.transitionend.transition);function Lk(t){if(YD[t])return YD[t];if(!Tv[t])return t;var e=Tv[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in $ne)return YD[t]=e[n];return t}var Lne=Lk("animationend"),Fne=Lk("animationiteration"),jne=Lk("animationstart"),zne=Lk("transitionend"),Bne=new Map,k9="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function op(t,e){Bne.set(t,e),Wg(e,[t])}for(var ZD=0;ZD<k9.length;ZD++){var QD=k9[ZD],qSe=QD.toLowerCase(),XSe=QD[0].toUpperCase()+QD.slice(1);op(qSe,"on"+XSe)}op(Lne,"onAnimationEnd");op(Fne,"onAnimationIteration");op(jne,"onAnimationStart");op("dblclick","onDoubleClick");op("focusin","onFocus");op("focusout","onBlur");op(zne,"onTransitionEnd");Px("onMouseEnter",["mouseout","mouseover"]);Px("onMouseLeave",["mouseout","mouseover"]);Px("onPointerEnter",["pointerout","pointerover"]);Px("onPointerLeave",["pointerout","pointerover"]);Wg("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Wg("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Wg("onBeforeInput",["compositionend","keypress","textInput","paste"]);Wg("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Wg("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Wg("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zw="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KSe=new Set("cancel close invalid load scroll toggle".split(" ").concat(zw));function M9(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,q1e(r,e,void 0,t),t.currentTarget=null}function Une(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;M9(i,o,c),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;M9(i,o,c),s=l}}}if(sA)throw t=B3,sA=!1,B3=null,t}function Fr(t,e){var n=e[Z3];n===void 0&&(n=e[Z3]=new Set);var r=t+"__bubble";n.has(r)||(Vne(e,t,2,!1),n.add(r))}function JD(t,e,n){var r=0;e&&(r|=4),Vne(n,t,r,e)}var $C="_reactListening"+Math.random().toString(36).slice(2);function O1(t){if(!t[$C]){t[$C]=!0,Yte.forEach(function(n){n!=="selectionchange"&&(KSe.has(n)||JD(n,!1,t),JD(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[$C]||(e[$C]=!0,JD("selectionchange",!1,e))}}function Vne(t,e,n,r){switch(Cne(e)){case 1:var i=cSe;break;case 4:i=uSe;break;default:i=DB}n=i.bind(null,e,n,t),i=void 0,!z3||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function e$(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=wm(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}hne(function(){var c=s,u=MB(n),d=[];e:{var h=Bne.get(t);if(h!==void 0){var f=LB,p=t;switch(t){case"keypress":if(C2(n)===0)break e;case"keydown":case"keyup":f=ESe;break;case"focusin":p="focus",f=qD;break;case"focusout":p="blur",f=qD;break;case"beforeblur":case"afterblur":f=qD;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=x9;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=fSe;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=ASe;break;case Lne:case Fne:case jne:f=gSe;break;case zne:f=kSe;break;case"scroll":f=dSe;break;case"wheel":f=RSe;break;case"copy":case"cut":case"paste":f=vSe;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=w9}var g=(e&4)!==0,m=!g&&t==="scroll",y=g?h!==null?h+"Capture":null:h;g=[];for(var x=c,b;x!==null;){b=x;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,y!==null&&(_=A1(x,y),_!=null&&g.push(D1(x,_,b)))),m)break;x=x.return}0<g.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:g}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==F3&&(p=n.relatedTarget||n.fromElement)&&(wm(p)||p[Zd]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?wm(p):null,p!==null&&(m=Hg(p),p!==m||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(g=x9,_="onMouseLeave",y="onMouseEnter",x="mouse",(t==="pointerout"||t==="pointerover")&&(g=w9,_="onPointerLeave",y="onPointerEnter",x="pointer"),m=f==null?h:Ev(f),b=p==null?h:Ev(p),h=new g(_,x+"leave",f,n,u),h.target=m,h.relatedTarget=b,_=null,wm(u)===c&&(g=new g(y,x+"enter",p,n,u),g.target=b,g.relatedTarget=m,_=g),m=_,f&&p)t:{for(g=f,y=p,x=0,b=g;b;b=ky(b))x++;for(b=0,_=y;_;_=ky(_))b++;for(;0<x-b;)g=ky(g),x--;for(;0<b-x;)y=ky(y),b--;for(;x--;){if(g===y||y!==null&&g===y.alternate)break t;g=ky(g),y=ky(y)}g=null}else g=null;f!==null&&R9(d,h,f,g,!1),p!==null&&m!==null&&R9(d,m,p,g,!0)}}e:{if(h=c?Ev(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var T=jSe;else if(T9(h))if(Rne)T=VSe;else{T=BSe;var E=zSe}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(T=USe);if(T&&(T=T(t,c))){Mne(d,T,n,u);break e}E&&E(t,h,c),t==="focusout"&&(E=h._wrapperState)&&E.controlled&&h.type==="number"&&P3(h,"number",h.value)}switch(E=c?Ev(c):window,t){case"focusin":(T9(E)||E.contentEditable==="true")&&(_v=E,H3=c,s1=null);break;case"focusout":s1=H3=_v=null;break;case"mousedown":G3=!0;break;case"contextmenu":case"mouseup":case"dragend":G3=!1,I9(d,n,u);break;case"selectionchange":if(GSe)break;case"keydown":case"keyup":I9(d,n,u)}var C;if(jB)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Sv?Ine(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(Ane&&n.locale!=="ko"&&(Sv||I!=="onCompositionStart"?I==="onCompositionEnd"&&Sv&&(C=Nne()):(ff=u,$B="value"in ff?ff.value:ff.textContent,Sv=!0)),E=uA(c,I),0<E.length&&(I=new b9(I,t,null,n,u),d.push({event:I,listeners:E}),C?I.data=C:(C=kne(n),C!==null&&(I.data=C)))),(C=OSe?DSe(t,n):$Se(t,n))&&(c=uA(c,"onBeforeInput"),0<c.length&&(u=new b9("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}Une(d,e)})}function D1(t,e,n){return{instance:t,listener:e,currentTarget:n}}function uA(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=A1(t,n),s!=null&&r.unshift(D1(t,s,i)),s=A1(t,e),s!=null&&r.push(D1(t,s,i))),t=t.return}return r}function ky(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function R9(t,e,n,r,i){for(var s=e._reactName,a=[];n!==null&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&c!==null&&(o=c,i?(l=A1(n,s),l!=null&&a.unshift(D1(n,l,o))):i||(l=A1(n,s),l!=null&&a.push(D1(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var YSe=/\r\n?/g,ZSe=/\u0000|\uFFFD/g;function P9(t){return(typeof t=="string"?t:""+t).replace(YSe,`
`).replace(ZSe,"")}function LC(t,e,n){if(e=P9(e),P9(t)!==e&&n)throw Error(Qe(425))}function dA(){}var q3=null,X3=null;function K3(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Y3=typeof setTimeout=="function"?setTimeout:void 0,QSe=typeof clearTimeout=="function"?clearTimeout:void 0,O9=typeof Promise=="function"?Promise:void 0,JSe=typeof queueMicrotask=="function"?queueMicrotask:typeof O9<"u"?function(t){return O9.resolve(null).then(t).catch(e_e)}:Y3;function e_e(t){setTimeout(function(){throw t})}function t$(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),M1(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);M1(e)}function Tf(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function D9(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var F0=Math.random().toString(36).slice(2),Tu="__reactFiber$"+F0,$1="__reactProps$"+F0,Zd="__reactContainer$"+F0,Z3="__reactEvents$"+F0,t_e="__reactListeners$"+F0,n_e="__reactHandles$"+F0;function wm(t){var e=t[Tu];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Zd]||n[Tu]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=D9(t);t!==null;){if(n=t[Tu])return n;t=D9(t)}return e}t=n,n=t.parentNode}return null}function P_(t){return t=t[Tu]||t[Zd],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Ev(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Qe(33))}function Fk(t){return t[$1]||null}var Q3=[],Cv=-1;function lp(t){return{current:t}}function Ur(t){0>Cv||(t.current=Q3[Cv],Q3[Cv]=null,Cv--)}function Rr(t,e){Cv++,Q3[Cv]=t.current,t.current=e}var jf={},ya=lp(jf),mo=lp(!1),ag=jf;function Ox(t,e){var n=t.type.contextTypes;if(!n)return jf;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function go(t){return t=t.childContextTypes,t!=null}function hA(){Ur(mo),Ur(ya)}function $9(t,e,n){if(ya.current!==jf)throw Error(Qe(168));Rr(ya,e),Rr(mo,n)}function Wne(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Qe(108,z1e(t)||"Unknown",i));return ui({},n,r)}function fA(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jf,ag=ya.current,Rr(ya,t),Rr(mo,mo.current),!0}function L9(t,e,n){var r=t.stateNode;if(!r)throw Error(Qe(169));n?(t=Wne(t,e,ag),r.__reactInternalMemoizedMergedChildContext=t,Ur(mo),Ur(ya),Rr(ya,t)):Ur(mo),Rr(mo,n)}var Ed=null,jk=!1,n$=!1;function Hne(t){Ed===null?Ed=[t]:Ed.push(t)}function r_e(t){jk=!0,Hne(t)}function cp(){if(!n$&&Ed!==null){n$=!0;var t=0,e=pr;try{var n=Ed;for(pr=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ed=null,jk=!1}catch(i){throw Ed!==null&&(Ed=Ed.slice(t+1)),gne(RB,cp),i}finally{pr=e,n$=!1}}return null}var Nv=[],Av=0,pA=null,mA=0,Cl=[],Nl=0,og=null,Pd=1,Od="";function im(t,e){Nv[Av++]=mA,Nv[Av++]=pA,pA=t,mA=e}function Gne(t,e,n){Cl[Nl++]=Pd,Cl[Nl++]=Od,Cl[Nl++]=og,og=t;var r=Pd;t=Od;var i=32-Dc(r)-1;r&=~(1<<i),n+=1;var s=32-Dc(e)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Pd=1<<32-Dc(e)+i|n<<i|r,Od=s+t}else Pd=1<<s|n<<i|r,Od=t}function BB(t){t.return!==null&&(im(t,1),Gne(t,1,0))}function UB(t){for(;t===pA;)pA=Nv[--Av],Nv[Av]=null,mA=Nv[--Av],Nv[Av]=null;for(;t===og;)og=Cl[--Nl],Cl[Nl]=null,Od=Cl[--Nl],Cl[Nl]=null,Pd=Cl[--Nl],Cl[Nl]=null}var qo=null,Ho=null,Xr=!1,bc=null;function qne(t,e){var n=Ml(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function F9(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qo=t,Ho=Tf(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qo=t,Ho=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=og!==null?{id:Pd,overflow:Od}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ml(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,qo=t,Ho=null,!0):!1;default:return!1}}function J3(t){return(t.mode&1)!==0&&(t.flags&128)===0}function eF(t){if(Xr){var e=Ho;if(e){var n=e;if(!F9(t,e)){if(J3(t))throw Error(Qe(418));e=Tf(n.nextSibling);var r=qo;e&&F9(t,e)?qne(r,n):(t.flags=t.flags&-4097|2,Xr=!1,qo=t)}}else{if(J3(t))throw Error(Qe(418));t.flags=t.flags&-4097|2,Xr=!1,qo=t}}}function j9(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qo=t}function FC(t){if(t!==qo)return!1;if(!Xr)return j9(t),Xr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!K3(t.type,t.memoizedProps)),e&&(e=Ho)){if(J3(t))throw Xne(),Error(Qe(418));for(;e;)qne(t,e),e=Tf(e.nextSibling)}if(j9(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Qe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ho=Tf(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ho=null}}else Ho=qo?Tf(t.stateNode.nextSibling):null;return!0}function Xne(){for(var t=Ho;t;)t=Tf(t.nextSibling)}function Dx(){Ho=qo=null,Xr=!1}function VB(t){bc===null?bc=[t]:bc.push(t)}var i_e=ph.ReactCurrentBatchConfig;function nw(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Qe(309));var r=n.stateNode}if(!r)throw Error(Qe(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(Qe(284));if(!n._owner)throw Error(Qe(290,t))}return t}function jC(t,e){throw t=Object.prototype.toString.call(e),Error(Qe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function z9(t){var e=t._init;return e(t._payload)}function Kne(t){function e(y,x){if(t){var b=y.deletions;b===null?(y.deletions=[x],y.flags|=16):b.push(x)}}function n(y,x){if(!t)return null;for(;x!==null;)e(y,x),x=x.sibling;return null}function r(y,x){for(y=new Map;x!==null;)x.key!==null?y.set(x.key,x):y.set(x.index,x),x=x.sibling;return y}function i(y,x){return y=Af(y,x),y.index=0,y.sibling=null,y}function s(y,x,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<x?(y.flags|=2,x):b):(y.flags|=2,x)):(y.flags|=1048576,x)}function a(y){return t&&y.alternate===null&&(y.flags|=2),y}function o(y,x,b,_){return x===null||x.tag!==6?(x=c$(b,y.mode,_),x.return=y,x):(x=i(x,b),x.return=y,x)}function l(y,x,b,_){var T=b.type;return T===wv?u(y,x,b.props.children,_,b.key):x!==null&&(x.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Xh&&z9(T)===x.type)?(_=i(x,b.props),_.ref=nw(y,x,b),_.return=y,_):(_=P2(b.type,b.key,b.props,null,y.mode,_),_.ref=nw(y,x,b),_.return=y,_)}function c(y,x,b,_){return x===null||x.tag!==4||x.stateNode.containerInfo!==b.containerInfo||x.stateNode.implementation!==b.implementation?(x=u$(b,y.mode,_),x.return=y,x):(x=i(x,b.children||[]),x.return=y,x)}function u(y,x,b,_,T){return x===null||x.tag!==7?(x=Xm(b,y.mode,_,T),x.return=y,x):(x=i(x,b),x.return=y,x)}function d(y,x,b){if(typeof x=="string"&&x!==""||typeof x=="number")return x=c$(""+x,y.mode,b),x.return=y,x;if(typeof x=="object"&&x!==null){switch(x.$$typeof){case AC:return b=P2(x.type,x.key,x.props,null,y.mode,b),b.ref=nw(y,null,x),b.return=y,b;case bv:return x=u$(x,y.mode,b),x.return=y,x;case Xh:var _=x._init;return d(y,_(x._payload),b)}if(Fw(x)||Zb(x))return x=Xm(x,y.mode,b,null),x.return=y,x;jC(y,x)}return null}function h(y,x,b,_){var T=x!==null?x.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return T!==null?null:o(y,x,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case AC:return b.key===T?l(y,x,b,_):null;case bv:return b.key===T?c(y,x,b,_):null;case Xh:return T=b._init,h(y,x,T(b._payload),_)}if(Fw(b)||Zb(b))return T!==null?null:u(y,x,b,_,null);jC(y,b)}return null}function f(y,x,b,_,T){if(typeof _=="string"&&_!==""||typeof _=="number")return y=y.get(b)||null,o(x,y,""+_,T);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case AC:return y=y.get(_.key===null?b:_.key)||null,l(x,y,_,T);case bv:return y=y.get(_.key===null?b:_.key)||null,c(x,y,_,T);case Xh:var E=_._init;return f(y,x,b,E(_._payload),T)}if(Fw(_)||Zb(_))return y=y.get(b)||null,u(x,y,_,T,null);jC(x,_)}return null}function p(y,x,b,_){for(var T=null,E=null,C=x,I=x=0,A=null;C!==null&&I<b.length;I++){C.index>I?(A=C,C=null):A=C.sibling;var k=h(y,C,b[I],_);if(k===null){C===null&&(C=A);break}t&&C&&k.alternate===null&&e(y,C),x=s(k,x,I),E===null?T=k:E.sibling=k,E=k,C=A}if(I===b.length)return n(y,C),Xr&&im(y,I),T;if(C===null){for(;I<b.length;I++)C=d(y,b[I],_),C!==null&&(x=s(C,x,I),E===null?T=C:E.sibling=C,E=C);return Xr&&im(y,I),T}for(C=r(y,C);I<b.length;I++)A=f(C,y,I,b[I],_),A!==null&&(t&&A.alternate!==null&&C.delete(A.key===null?I:A.key),x=s(A,x,I),E===null?T=A:E.sibling=A,E=A);return t&&C.forEach(function(R){return e(y,R)}),Xr&&im(y,I),T}function g(y,x,b,_){var T=Zb(b);if(typeof T!="function")throw Error(Qe(150));if(b=T.call(b),b==null)throw Error(Qe(151));for(var E=T=null,C=x,I=x=0,A=null,k=b.next();C!==null&&!k.done;I++,k=b.next()){C.index>I?(A=C,C=null):A=C.sibling;var R=h(y,C,k.value,_);if(R===null){C===null&&(C=A);break}t&&C&&R.alternate===null&&e(y,C),x=s(R,x,I),E===null?T=R:E.sibling=R,E=R,C=A}if(k.done)return n(y,C),Xr&&im(y,I),T;if(C===null){for(;!k.done;I++,k=b.next())k=d(y,k.value,_),k!==null&&(x=s(k,x,I),E===null?T=k:E.sibling=k,E=k);return Xr&&im(y,I),T}for(C=r(y,C);!k.done;I++,k=b.next())k=f(C,y,I,k.value,_),k!==null&&(t&&k.alternate!==null&&C.delete(k.key===null?I:k.key),x=s(k,x,I),E===null?T=k:E.sibling=k,E=k);return t&&C.forEach(function($){return e(y,$)}),Xr&&im(y,I),T}function m(y,x,b,_){if(typeof b=="object"&&b!==null&&b.type===wv&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case AC:e:{for(var T=b.key,E=x;E!==null;){if(E.key===T){if(T=b.type,T===wv){if(E.tag===7){n(y,E.sibling),x=i(E,b.props.children),x.return=y,y=x;break e}}else if(E.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===Xh&&z9(T)===E.type){n(y,E.sibling),x=i(E,b.props),x.ref=nw(y,E,b),x.return=y,y=x;break e}n(y,E);break}else e(y,E);E=E.sibling}b.type===wv?(x=Xm(b.props.children,y.mode,_,b.key),x.return=y,y=x):(_=P2(b.type,b.key,b.props,null,y.mode,_),_.ref=nw(y,x,b),_.return=y,y=_)}return a(y);case bv:e:{for(E=b.key;x!==null;){if(x.key===E)if(x.tag===4&&x.stateNode.containerInfo===b.containerInfo&&x.stateNode.implementation===b.implementation){n(y,x.sibling),x=i(x,b.children||[]),x.return=y,y=x;break e}else{n(y,x);break}else e(y,x);x=x.sibling}x=u$(b,y.mode,_),x.return=y,y=x}return a(y);case Xh:return E=b._init,m(y,x,E(b._payload),_)}if(Fw(b))return p(y,x,b,_);if(Zb(b))return g(y,x,b,_);jC(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,x!==null&&x.tag===6?(n(y,x.sibling),x=i(x,b),x.return=y,y=x):(n(y,x),x=c$(b,y.mode,_),x.return=y,y=x),a(y)):n(y,x)}return m}var $x=Kne(!0),Yne=Kne(!1),gA=lp(null),yA=null,Iv=null,WB=null;function HB(){WB=Iv=yA=null}function GB(t){var e=gA.current;Ur(gA),t._currentValue=e}function tF(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Kv(t,e){yA=t,WB=Iv=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(uo=!0),t.firstContext=null)}function Wl(t){var e=t._currentValue;if(WB!==t)if(t={context:t,memoizedValue:e,next:null},Iv===null){if(yA===null)throw Error(Qe(308));Iv=t,yA.dependencies={lanes:0,firstContext:t}}else Iv=Iv.next=t;return e}var Sm=null;function qB(t){Sm===null?Sm=[t]:Sm.push(t)}function Zne(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,qB(e)):(n.next=i.next,i.next=n),e.interleaved=n,Qd(t,r)}function Qd(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Kh=!1;function XB(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qne(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Bd(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ef(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Zn&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Qd(t,n)}return i=r.interleaved,i===null?(e.next=e,qB(r)):(e.next=i.next,i.next=e),r.interleaved=e,Qd(t,n)}function N2(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,PB(t,n)}}function B9(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function vA(t,e,n,r){var i=t.updateQueue;Kh=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var u=t.alternate;u!==null&&(u=u.updateQueue,o=u.lastBaseUpdate,o!==a&&(o===null?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(s!==null){var d=i.baseState;a=0,u=c=l=null,o=s;do{var h=o.lane,f=o.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=t,g=o;switch(h=e,f=n,g.tag){case 1:if(p=g.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=g.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=ui({},d,h);break e;case 2:Kh=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,h=i.effects,h===null?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,a|=h;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;h=o,o=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do a|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);cg|=a,t.lanes=a,t.memoizedState=d}}function U9(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Qe(191,i));i.call(r)}}}var O_={},Ru=lp(O_),L1=lp(O_),F1=lp(O_);function _m(t){if(t===O_)throw Error(Qe(174));return t}function KB(t,e){switch(Rr(F1,e),Rr(L1,t),Rr(Ru,O_),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:D3(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=D3(e,t)}Ur(Ru),Rr(Ru,e)}function Lx(){Ur(Ru),Ur(L1),Ur(F1)}function Jne(t){_m(F1.current);var e=_m(Ru.current),n=D3(e,t.type);e!==n&&(Rr(L1,t),Rr(Ru,n))}function YB(t){L1.current===t&&(Ur(Ru),Ur(L1))}var ri=lp(0);function xA(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var r$=[];function ZB(){for(var t=0;t<r$.length;t++)r$[t]._workInProgressVersionPrimary=null;r$.length=0}var A2=ph.ReactCurrentDispatcher,i$=ph.ReactCurrentBatchConfig,lg=0,ci=null,ns=null,_s=null,bA=!1,a1=!1,j1=0,s_e=0;function ea(){throw Error(Qe(321))}function QB(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Uc(t[n],e[n]))return!1;return!0}function JB(t,e,n,r,i,s){if(lg=s,ci=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,A2.current=t===null||t.memoizedState===null?c_e:u_e,t=n(r,i),a1){s=0;do{if(a1=!1,j1=0,25<=s)throw Error(Qe(301));s+=1,_s=ns=null,e.updateQueue=null,A2.current=d_e,t=n(r,i)}while(a1)}if(A2.current=wA,e=ns!==null&&ns.next!==null,lg=0,_s=ns=ci=null,bA=!1,e)throw Error(Qe(300));return t}function eU(){var t=j1!==0;return j1=0,t}function gu(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _s===null?ci.memoizedState=_s=t:_s=_s.next=t,_s}function Hl(){if(ns===null){var t=ci.alternate;t=t!==null?t.memoizedState:null}else t=ns.next;var e=_s===null?ci.memoizedState:_s.next;if(e!==null)_s=e,ns=t;else{if(t===null)throw Error(Qe(310));ns=t,t={memoizedState:ns.memoizedState,baseState:ns.baseState,baseQueue:ns.baseQueue,queue:ns.queue,next:null},_s===null?ci.memoizedState=_s=t:_s=_s.next=t}return _s}function z1(t,e){return typeof e=="function"?e(t):e}function s$(t){var e=Hl(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var r=ns,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,c=s;do{var u=c.lane;if((lg&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,a=r):l=l.next=d,ci.lanes|=u,cg|=u}c=c.next}while(c!==null&&c!==s);l===null?a=r:l.next=o,Uc(r,e.memoizedState)||(uo=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ci.lanes|=s,cg|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function a$(t){var e=Hl(),n=e.queue;if(n===null)throw Error(Qe(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=t(s,a.action),a=a.next;while(a!==i);Uc(s,e.memoizedState)||(uo=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function ere(){}function tre(t,e){var n=ci,r=Hl(),i=e(),s=!Uc(r.memoizedState,i);if(s&&(r.memoizedState=i,uo=!0),r=r.queue,tU(ire.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||_s!==null&&_s.memoizedState.tag&1){if(n.flags|=2048,B1(9,rre.bind(null,n,r,i,e),void 0,null),Ns===null)throw Error(Qe(349));lg&30||nre(n,e,i)}return i}function nre(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ci.updateQueue,e===null?(e={lastEffect:null,stores:null},ci.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function rre(t,e,n,r){e.value=n,e.getSnapshot=r,sre(e)&&are(t)}function ire(t,e,n){return n(function(){sre(e)&&are(t)})}function sre(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Uc(t,n)}catch{return!0}}function are(t){var e=Qd(t,1);e!==null&&$c(e,t,1,-1)}function V9(t){var e=gu();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:z1,lastRenderedState:t},e.queue=t,t=t.dispatch=l_e.bind(null,ci,t),[e.memoizedState,t]}function B1(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ci.updateQueue,e===null?(e={lastEffect:null,stores:null},ci.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ore(){return Hl().memoizedState}function I2(t,e,n,r){var i=gu();ci.flags|=t,i.memoizedState=B1(1|e,n,void 0,r===void 0?null:r)}function zk(t,e,n,r){var i=Hl();r=r===void 0?null:r;var s=void 0;if(ns!==null){var a=ns.memoizedState;if(s=a.destroy,r!==null&&QB(r,a.deps)){i.memoizedState=B1(e,n,s,r);return}}ci.flags|=t,i.memoizedState=B1(1|e,n,s,r)}function W9(t,e){return I2(8390656,8,t,e)}function tU(t,e){return zk(2048,8,t,e)}function lre(t,e){return zk(4,2,t,e)}function cre(t,e){return zk(4,4,t,e)}function ure(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function dre(t,e,n){return n=n!=null?n.concat([t]):null,zk(4,4,ure.bind(null,e,t),n)}function nU(){}function hre(t,e){var n=Hl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&QB(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function fre(t,e){var n=Hl();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&QB(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function pre(t,e,n){return lg&21?(Uc(n,e)||(n=xne(),ci.lanes|=n,cg|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,uo=!0),t.memoizedState=n)}function a_e(t,e){var n=pr;pr=n!==0&&4>n?n:4,t(!0);var r=i$.transition;i$.transition={};try{t(!1),e()}finally{pr=n,i$.transition=r}}function mre(){return Hl().memoizedState}function o_e(t,e,n){var r=Nf(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},gre(t))yre(e,n);else if(n=Zne(t,e,n,r),n!==null){var i=Ba();$c(n,t,r,i),vre(n,e,r)}}function l_e(t,e,n){var r=Nf(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(gre(t))yre(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,Uc(o,a)){var l=e.interleaved;l===null?(i.next=i,qB(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=Zne(t,e,i,r),n!==null&&(i=Ba(),$c(n,t,r,i),vre(n,e,r))}}function gre(t){var e=t.alternate;return t===ci||e!==null&&e===ci}function yre(t,e){a1=bA=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function vre(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,PB(t,n)}}var wA={readContext:Wl,useCallback:ea,useContext:ea,useEffect:ea,useImperativeHandle:ea,useInsertionEffect:ea,useLayoutEffect:ea,useMemo:ea,useReducer:ea,useRef:ea,useState:ea,useDebugValue:ea,useDeferredValue:ea,useTransition:ea,useMutableSource:ea,useSyncExternalStore:ea,useId:ea,unstable_isNewReconciler:!1},c_e={readContext:Wl,useCallback:function(t,e){return gu().memoizedState=[t,e===void 0?null:e],t},useContext:Wl,useEffect:W9,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,I2(4194308,4,ure.bind(null,e,t),n)},useLayoutEffect:function(t,e){return I2(4194308,4,t,e)},useInsertionEffect:function(t,e){return I2(4,2,t,e)},useMemo:function(t,e){var n=gu();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=gu();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=o_e.bind(null,ci,t),[r.memoizedState,t]},useRef:function(t){var e=gu();return t={current:t},e.memoizedState=t},useState:V9,useDebugValue:nU,useDeferredValue:function(t){return gu().memoizedState=t},useTransition:function(){var t=V9(!1),e=t[0];return t=a_e.bind(null,t[1]),gu().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ci,i=gu();if(Xr){if(n===void 0)throw Error(Qe(407));n=n()}else{if(n=e(),Ns===null)throw Error(Qe(349));lg&30||nre(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,W9(ire.bind(null,r,s,t),[t]),r.flags|=2048,B1(9,rre.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=gu(),e=Ns.identifierPrefix;if(Xr){var n=Od,r=Pd;n=(r&~(1<<32-Dc(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=j1++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=s_e++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},u_e={readContext:Wl,useCallback:hre,useContext:Wl,useEffect:tU,useImperativeHandle:dre,useInsertionEffect:lre,useLayoutEffect:cre,useMemo:fre,useReducer:s$,useRef:ore,useState:function(){return s$(z1)},useDebugValue:nU,useDeferredValue:function(t){var e=Hl();return pre(e,ns.memoizedState,t)},useTransition:function(){var t=s$(z1)[0],e=Hl().memoizedState;return[t,e]},useMutableSource:ere,useSyncExternalStore:tre,useId:mre,unstable_isNewReconciler:!1},d_e={readContext:Wl,useCallback:hre,useContext:Wl,useEffect:tU,useImperativeHandle:dre,useInsertionEffect:lre,useLayoutEffect:cre,useMemo:fre,useReducer:a$,useRef:ore,useState:function(){return a$(z1)},useDebugValue:nU,useDeferredValue:function(t){var e=Hl();return ns===null?e.memoizedState=t:pre(e,ns.memoizedState,t)},useTransition:function(){var t=a$(z1)[0],e=Hl().memoizedState;return[t,e]},useMutableSource:ere,useSyncExternalStore:tre,useId:mre,unstable_isNewReconciler:!1};function pc(t,e){if(t&&t.defaultProps){e=ui({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function nF(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ui({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Bk={isMounted:function(t){return(t=t._reactInternals)?Hg(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Ba(),i=Nf(t),s=Bd(r,i);s.payload=e,n!=null&&(s.callback=n),e=Ef(t,s,i),e!==null&&($c(e,t,i,r),N2(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Ba(),i=Nf(t),s=Bd(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Ef(t,s,i),e!==null&&($c(e,t,i,r),N2(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Ba(),r=Nf(t),i=Bd(n,r);i.tag=2,e!=null&&(i.callback=e),e=Ef(t,i,r),e!==null&&($c(e,t,r,n),N2(e,t,r))}};function H9(t,e,n,r,i,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,a):e.prototype&&e.prototype.isPureReactComponent?!P1(n,r)||!P1(i,s):!0}function xre(t,e,n){var r=!1,i=jf,s=e.contextType;return typeof s=="object"&&s!==null?s=Wl(s):(i=go(e)?ag:ya.current,r=e.contextTypes,s=(r=r!=null)?Ox(t,i):jf),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Bk,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function G9(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Bk.enqueueReplaceState(e,e.state,null)}function rF(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},XB(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Wl(s):(s=go(e)?ag:ya.current,i.context=Ox(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(nF(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Bk.enqueueReplaceState(i,i.state,null),vA(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Fx(t,e){try{var n="",r=e;do n+=j1e(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function o$(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function iF(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var h_e=typeof WeakMap=="function"?WeakMap:Map;function bre(t,e,n){n=Bd(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){_A||(_A=!0,pF=r),iF(t,e)},n}function wre(t,e,n){n=Bd(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){iF(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){iF(t,e),typeof r!="function"&&(Cf===null?Cf=new Set([this]):Cf.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function q9(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new h_e;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=C_e.bind(null,t,e,n),e.then(t,t))}function X9(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function K9(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Bd(-1,1),e.tag=2,Ef(n,e,1))),n.lanes|=1),t)}var f_e=ph.ReactCurrentOwner,uo=!1;function Ra(t,e,n,r){e.child=t===null?Yne(e,null,n,r):$x(e,t.child,n,r)}function Y9(t,e,n,r,i){n=n.render;var s=e.ref;return Kv(e,i),r=JB(t,e,n,r,s,i),n=eU(),t!==null&&!uo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jd(t,e,i)):(Xr&&n&&BB(e),e.flags|=1,Ra(t,e,r,i),e.child)}function Z9(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!uU(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Sre(t,e,s,r,i)):(t=P2(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:P1,n(a,r)&&t.ref===e.ref)return Jd(t,e,i)}return e.flags|=1,t=Af(s,r),t.ref=e.ref,t.return=e,e.child=t}function Sre(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(P1(s,r)&&t.ref===e.ref)if(uo=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(uo=!0);else return e.lanes=t.lanes,Jd(t,e,i)}return sF(t,e,n,r,i)}function _re(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rr(Mv,Lo),Lo|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Rr(Mv,Lo),Lo|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Rr(Mv,Lo),Lo|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Rr(Mv,Lo),Lo|=r;return Ra(t,e,i,n),e.child}function Tre(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function sF(t,e,n,r,i){var s=go(n)?ag:ya.current;return s=Ox(e,s),Kv(e,i),n=JB(t,e,n,r,s,i),r=eU(),t!==null&&!uo?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,Jd(t,e,i)):(Xr&&r&&BB(e),e.flags|=1,Ra(t,e,n,i),e.child)}function Q9(t,e,n,r,i){if(go(n)){var s=!0;fA(e)}else s=!1;if(Kv(e,i),e.stateNode===null)k2(t,e),xre(e,n,r),rF(e,n,r,i),r=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=Wl(c):(c=go(n)?ag:ya.current,c=Ox(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==c)&&G9(e,a,r,c),Kh=!1;var h=e.memoizedState;a.state=h,vA(e,r,a,i),l=e.memoizedState,o!==r||h!==l||mo.current||Kh?(typeof u=="function"&&(nF(e,n,u,r),l=e.memoizedState),(o=Kh||H9(e,n,o,r,h,l,c))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Qne(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:pc(e.type,o),a.props=c,d=e.pendingProps,h=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Wl(l):(l=go(n)?ag:ya.current,l=Ox(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||h!==l)&&G9(e,a,r,l),Kh=!1,h=e.memoizedState,a.state=h,vA(e,r,a,i);var p=e.memoizedState;o!==d||h!==p||mo.current||Kh?(typeof f=="function"&&(nF(e,n,f,r),p=e.memoizedState),(c=Kh||H9(e,n,c,r,h,p,l)||!1)?(u||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,p,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,p,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),r=!1)}return aF(t,e,n,r,s,i)}function aF(t,e,n,r,i,s){Tre(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return i&&L9(e,n,!1),Jd(t,e,s);r=e.stateNode,f_e.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=$x(e,t.child,null,s),e.child=$x(e,null,o,s)):Ra(t,e,o,s),e.memoizedState=r.state,i&&L9(e,n,!0),e.child}function Ere(t){var e=t.stateNode;e.pendingContext?$9(t,e.pendingContext,e.pendingContext!==e.context):e.context&&$9(t,e.context,!1),KB(t,e.containerInfo)}function J9(t,e,n,r,i){return Dx(),VB(i),e.flags|=256,Ra(t,e,n,r),e.child}var oF={dehydrated:null,treeContext:null,retryLane:0};function lF(t){return{baseLanes:t,cachePool:null,transitions:null}}function Cre(t,e,n){var r=e.pendingProps,i=ri.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(i&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Rr(ri,i&1),t===null)return eF(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=r.children,t=r.fallback,s?(r=e.mode,s=e.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Wk(a,r,0,null),t=Xm(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=lF(n),e.memoizedState=oF,t):rU(e,a));if(i=t.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return p_e(t,e,a,r,o,i,n);if(s){s=r.fallback,a=e.mode,i=t.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Af(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Af(o,s):(s=Xm(s,a,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,a=t.child.memoizedState,a=a===null?lF(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=oF,r}return s=t.child,t=s.sibling,r=Af(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function rU(t,e){return e=Wk({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zC(t,e,n,r){return r!==null&&VB(r),$x(e,t.child,null,n),t=rU(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function p_e(t,e,n,r,i,s,a){if(n)return e.flags&256?(e.flags&=-257,r=o$(Error(Qe(422))),zC(t,e,a,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Wk({mode:"visible",children:r.children},i,0,null),s=Xm(s,i,a,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&$x(e,t.child,null,a),e.child.memoizedState=lF(a),e.memoizedState=oF,s);if(!(e.mode&1))return zC(t,e,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(Qe(419)),r=o$(s,r,void 0),zC(t,e,a,r)}if(o=(a&t.childLanes)!==0,uo||o){if(r=Ns,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Qd(t,i),$c(r,t,i,-1))}return cU(),r=o$(Error(Qe(421))),zC(t,e,a,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=N_e.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Ho=Tf(i.nextSibling),qo=e,Xr=!0,bc=null,t!==null&&(Cl[Nl++]=Pd,Cl[Nl++]=Od,Cl[Nl++]=og,Pd=t.id,Od=t.overflow,og=e),e=rU(e,r.children),e.flags|=4096,e)}function eq(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),tF(t.return,e,n)}function l$(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Nre(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Ra(t,e,r.children,n),r=ri.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&eq(t,n,e);else if(t.tag===19)eq(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Rr(ri,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&xA(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),l$(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&xA(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}l$(e,!0,n,null,s);break;case"together":l$(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function k2(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Jd(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cg|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Qe(153));if(e.child!==null){for(t=e.child,n=Af(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Af(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function m_e(t,e,n){switch(e.tag){case 3:Ere(e),Dx();break;case 5:Jne(e);break;case 1:go(e.type)&&fA(e);break;case 4:KB(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Rr(gA,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Rr(ri,ri.current&1),e.flags|=128,null):n&e.child.childLanes?Cre(t,e,n):(Rr(ri,ri.current&1),t=Jd(t,e,n),t!==null?t.sibling:null);Rr(ri,ri.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Nre(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Rr(ri,ri.current),r)break;return null;case 22:case 23:return e.lanes=0,_re(t,e,n)}return Jd(t,e,n)}var Are,cF,Ire,kre;Are=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cF=function(){};Ire=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,_m(Ru.current);var s=null;switch(n){case"input":i=M3(t,i),r=M3(t,r),s=[];break;case"select":i=ui({},i,{value:void 0}),r=ui({},r,{value:void 0}),s=[];break;case"textarea":i=O3(t,i),r=O3(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=dA)}$3(n,r);var a;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var o=i[c];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(C1.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(o=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(C1.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Fr("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};kre=function(t,e,n,r){n!==r&&(e.flags|=4)};function rw(t,e){if(!Xr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function ta(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function g_e(t,e,n){var r=e.pendingProps;switch(UB(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ta(e),null;case 1:return go(e.type)&&hA(),ta(e),null;case 3:return r=e.stateNode,Lx(),Ur(mo),Ur(ya),ZB(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(FC(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,bc!==null&&(yF(bc),bc=null))),cF(t,e),ta(e),null;case 5:YB(e);var i=_m(F1.current);if(n=e.type,t!==null&&e.stateNode!=null)Ire(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Qe(166));return ta(e),null}if(t=_m(Ru.current),FC(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Tu]=e,r[$1]=s,t=(e.mode&1)!==0,n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<zw.length;i++)Fr(zw[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":c9(r,s),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Fr("invalid",r);break;case"textarea":d9(r,s),Fr("invalid",r)}$3(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&LC(r.textContent,o,t),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&LC(r.textContent,o,t),i=["children",""+o]):C1.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Fr("scroll",r)}switch(n){case"input":IC(r),u9(r,s,!0);break;case"textarea":IC(r),h9(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=dA)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ine(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[Tu]=e,t[$1]=r,Are(t,e,!1,!1),e.stateNode=t;e:{switch(a=L3(n,r),n){case"dialog":Fr("cancel",t),Fr("close",t),i=r;break;case"iframe":case"object":case"embed":Fr("load",t),i=r;break;case"video":case"audio":for(i=0;i<zw.length;i++)Fr(zw[i],t);i=r;break;case"source":Fr("error",t),i=r;break;case"img":case"image":case"link":Fr("error",t),Fr("load",t),i=r;break;case"details":Fr("toggle",t),i=r;break;case"input":c9(t,r),i=M3(t,r),Fr("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ui({},r,{value:void 0}),Fr("invalid",t);break;case"textarea":d9(t,r),i=O3(t,r),Fr("invalid",t);break;default:i=r}$3(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?one(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&sne(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&N1(t,l):typeof l=="number"&&N1(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(C1.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Fr("scroll",t):l!=null&&NB(t,s,l,a))}switch(n){case"input":IC(t),u9(t,r,!1);break;case"textarea":IC(t),h9(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ff(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Hv(t,!!r.multiple,s,!1):r.defaultValue!=null&&Hv(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=dA)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ta(e),null;case 6:if(t&&e.stateNode!=null)kre(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Qe(166));if(n=_m(F1.current),_m(Ru.current),FC(e)){if(r=e.stateNode,n=e.memoizedProps,r[Tu]=e,(s=r.nodeValue!==n)&&(t=qo,t!==null))switch(t.tag){case 3:LC(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&LC(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Tu]=e,e.stateNode=r}return ta(e),null;case 13:if(Ur(ri),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Xr&&Ho!==null&&e.mode&1&&!(e.flags&128))Xne(),Dx(),e.flags|=98560,s=!1;else if(s=FC(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Qe(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Qe(317));s[Tu]=e}else Dx(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ta(e),s=!1}else bc!==null&&(yF(bc),bc=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||ri.current&1?ss===0&&(ss=3):cU())),e.updateQueue!==null&&(e.flags|=4),ta(e),null);case 4:return Lx(),cF(t,e),t===null&&O1(e.stateNode.containerInfo),ta(e),null;case 10:return GB(e.type._context),ta(e),null;case 17:return go(e.type)&&hA(),ta(e),null;case 19:if(Ur(ri),s=e.memoizedState,s===null)return ta(e),null;if(r=(e.flags&128)!==0,a=s.rendering,a===null)if(r)rw(s,!1);else{if(ss!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=xA(t),a!==null){for(e.flags|=128,rw(s,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Rr(ri,ri.current&1|2),e.child}t=t.sibling}s.tail!==null&&ki()>jx&&(e.flags|=128,r=!0,rw(s,!1),e.lanes=4194304)}else{if(!r)if(t=xA(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rw(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!Xr)return ta(e),null}else 2*ki()-s.renderingStartTime>jx&&n!==1073741824&&(e.flags|=128,r=!0,rw(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ki(),e.sibling=null,n=ri.current,Rr(ri,r?n&1|2:n&1),e):(ta(e),null);case 22:case 23:return lU(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Lo&1073741824&&(ta(e),e.subtreeFlags&6&&(e.flags|=8192)):ta(e),null;case 24:return null;case 25:return null}throw Error(Qe(156,e.tag))}function y_e(t,e){switch(UB(e),e.tag){case 1:return go(e.type)&&hA(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Lx(),Ur(mo),Ur(ya),ZB(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return YB(e),null;case 13:if(Ur(ri),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Qe(340));Dx()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ur(ri),null;case 4:return Lx(),null;case 10:return GB(e.type._context),null;case 22:case 23:return lU(),null;case 24:return null;default:return null}}var BC=!1,ca=!1,v_e=typeof WeakSet=="function"?WeakSet:Set,wt=null;function kv(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){gi(t,e,r)}else n.current=null}function uF(t,e,n){try{n()}catch(r){gi(t,e,r)}}var tq=!1;function x_e(t,e){if(q3=lA,t=Dne(),zB(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||i!==0&&d.nodeType!==3||(o=a+i),d!==s||r!==0&&d.nodeType!==3||(l=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===i&&(o=a),h===s&&++u===r&&(l=a),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(X3={focusedElem:t,selectionRange:n},lA=!1,wt=e;wt!==null;)if(e=wt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,wt=t;else for(;wt!==null;){e=wt;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var g=p.memoizedProps,m=p.memoizedState,y=e.stateNode,x=y.getSnapshotBeforeUpdate(e.elementType===e.type?g:pc(e.type,g),m);y.__reactInternalSnapshotBeforeUpdate=x}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Qe(163))}}catch(_){gi(e,e.return,_)}if(t=e.sibling,t!==null){t.return=e.return,wt=t;break}wt=e.return}return p=tq,tq=!1,p}function o1(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&uF(e,n,s)}i=i.next}while(i!==r)}}function Uk(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function dF(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Mre(t){var e=t.alternate;e!==null&&(t.alternate=null,Mre(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Tu],delete e[$1],delete e[Z3],delete e[t_e],delete e[n_e])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Rre(t){return t.tag===5||t.tag===3||t.tag===4}function nq(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Rre(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hF(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=dA));else if(r!==4&&(t=t.child,t!==null))for(hF(t,e,n),t=t.sibling;t!==null;)hF(t,e,n),t=t.sibling}function fF(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(fF(t,e,n),t=t.sibling;t!==null;)fF(t,e,n),t=t.sibling}var Bs=null,vc=!1;function Oh(t,e,n){for(n=n.child;n!==null;)Pre(t,e,n),n=n.sibling}function Pre(t,e,n){if(Mu&&typeof Mu.onCommitFiberUnmount=="function")try{Mu.onCommitFiberUnmount(Ok,n)}catch{}switch(n.tag){case 5:ca||kv(n,e);case 6:var r=Bs,i=vc;Bs=null,Oh(t,e,n),Bs=r,vc=i,Bs!==null&&(vc?(t=Bs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Bs.removeChild(n.stateNode));break;case 18:Bs!==null&&(vc?(t=Bs,n=n.stateNode,t.nodeType===8?t$(t.parentNode,n):t.nodeType===1&&t$(t,n),M1(t)):t$(Bs,n.stateNode));break;case 4:r=Bs,i=vc,Bs=n.stateNode.containerInfo,vc=!0,Oh(t,e,n),Bs=r,vc=i;break;case 0:case 11:case 14:case 15:if(!ca&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&uF(n,e,a),i=i.next}while(i!==r)}Oh(t,e,n);break;case 1:if(!ca&&(kv(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){gi(n,e,o)}Oh(t,e,n);break;case 21:Oh(t,e,n);break;case 22:n.mode&1?(ca=(r=ca)||n.memoizedState!==null,Oh(t,e,n),ca=r):Oh(t,e,n);break;default:Oh(t,e,n)}}function rq(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new v_e),e.forEach(function(r){var i=A_e.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function ic(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:Bs=o.stateNode,vc=!1;break e;case 3:Bs=o.stateNode.containerInfo,vc=!0;break e;case 4:Bs=o.stateNode.containerInfo,vc=!0;break e}o=o.return}if(Bs===null)throw Error(Qe(160));Pre(s,a,i),Bs=null,vc=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){gi(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Ore(e,t),e=e.sibling}function Ore(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ic(e,t),pu(t),r&4){try{o1(3,t,t.return),Uk(3,t)}catch(g){gi(t,t.return,g)}try{o1(5,t,t.return)}catch(g){gi(t,t.return,g)}}break;case 1:ic(e,t),pu(t),r&512&&n!==null&&kv(n,n.return);break;case 5:if(ic(e,t),pu(t),r&512&&n!==null&&kv(n,n.return),t.flags&32){var i=t.stateNode;try{N1(i,"")}catch(g){gi(t,t.return,g)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&nne(i,s),L3(o,a);var c=L3(o,s);for(a=0;a<l.length;a+=2){var u=l[a],d=l[a+1];u==="style"?one(i,d):u==="dangerouslySetInnerHTML"?sne(i,d):u==="children"?N1(i,d):NB(i,u,d,c)}switch(o){case"input":R3(i,s);break;case"textarea":rne(i,s);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var f=s.value;f!=null?Hv(i,!!s.multiple,f,!1):h!==!!s.multiple&&(s.defaultValue!=null?Hv(i,!!s.multiple,s.defaultValue,!0):Hv(i,!!s.multiple,s.multiple?[]:"",!1))}i[$1]=s}catch(g){gi(t,t.return,g)}}break;case 6:if(ic(e,t),pu(t),r&4){if(t.stateNode===null)throw Error(Qe(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(g){gi(t,t.return,g)}}break;case 3:if(ic(e,t),pu(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{M1(e.containerInfo)}catch(g){gi(t,t.return,g)}break;case 4:ic(e,t),pu(t);break;case 13:ic(e,t),pu(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(aU=ki())),r&4&&rq(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(ca=(c=ca)||u,ic(e,t),ca=c):ic(e,t),pu(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(wt=t,u=t.child;u!==null;){for(d=wt=u;wt!==null;){switch(h=wt,f=h.child,h.tag){case 0:case 11:case 14:case 15:o1(4,h,h.return);break;case 1:kv(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,n=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(g){gi(r,n,g)}}break;case 5:kv(h,h.return);break;case 22:if(h.memoizedState!==null){sq(d);continue}}f!==null?(f.return=h,wt=f):sq(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ane("display",a))}catch(g){gi(t,t.return,g)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){gi(t,t.return,g)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:ic(e,t),pu(t),r&4&&rq(t);break;case 21:break;default:ic(e,t),pu(t)}}function pu(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Rre(n)){var r=n;break e}n=n.return}throw Error(Qe(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(N1(i,""),r.flags&=-33);var s=nq(t);fF(t,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=nq(t);hF(t,o,a);break;default:throw Error(Qe(161))}}catch(l){gi(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function b_e(t,e,n){wt=t,Dre(t)}function Dre(t,e,n){for(var r=(t.mode&1)!==0;wt!==null;){var i=wt,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||BC;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||ca;o=BC;var c=ca;if(BC=a,(ca=l)&&!c)for(wt=i;wt!==null;)a=wt,l=a.child,a.tag===22&&a.memoizedState!==null?aq(i):l!==null?(l.return=a,wt=l):aq(i);for(;s!==null;)wt=s,Dre(s),s=s.sibling;wt=i,BC=o,ca=c}iq(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,wt=s):iq(t)}}function iq(t){for(;wt!==null;){var e=wt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ca||Uk(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!ca)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:pc(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&U9(e,s,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}U9(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&M1(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Qe(163))}ca||e.flags&512&&dF(e)}catch(h){gi(e,e.return,h)}}if(e===t){wt=null;break}if(n=e.sibling,n!==null){n.return=e.return,wt=n;break}wt=e.return}}function sq(t){for(;wt!==null;){var e=wt;if(e===t){wt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,wt=n;break}wt=e.return}}function aq(t){for(;wt!==null;){var e=wt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Uk(4,e)}catch(l){gi(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){gi(e,i,l)}}var s=e.return;try{dF(e)}catch(l){gi(e,s,l)}break;case 5:var a=e.return;try{dF(e)}catch(l){gi(e,a,l)}}}catch(l){gi(e,e.return,l)}if(e===t){wt=null;break}var o=e.sibling;if(o!==null){o.return=e.return,wt=o;break}wt=e.return}}var w_e=Math.ceil,SA=ph.ReactCurrentDispatcher,iU=ph.ReactCurrentOwner,jl=ph.ReactCurrentBatchConfig,Zn=0,Ns=null,Ui=null,Ws=0,Lo=0,Mv=lp(0),ss=0,U1=null,cg=0,Vk=0,sU=0,l1=null,ao=null,aU=0,jx=1/0,Td=null,_A=!1,pF=null,Cf=null,UC=!1,pf=null,TA=0,c1=0,mF=null,M2=-1,R2=0;function Ba(){return Zn&6?ki():M2!==-1?M2:M2=ki()}function Nf(t){return t.mode&1?Zn&2&&Ws!==0?Ws&-Ws:i_e.transition!==null?(R2===0&&(R2=xne()),R2):(t=pr,t!==0||(t=window.event,t=t===void 0?16:Cne(t.type)),t):1}function $c(t,e,n,r){if(50<c1)throw c1=0,mF=null,Error(Qe(185));M_(t,n,r),(!(Zn&2)||t!==Ns)&&(t===Ns&&(!(Zn&2)&&(Vk|=n),ss===4&&ef(t,Ws)),yo(t,r),n===1&&Zn===0&&!(e.mode&1)&&(jx=ki()+500,jk&&cp()))}function yo(t,e){var n=t.callbackNode;iSe(t,e);var r=oA(t,t===Ns?Ws:0);if(r===0)n!==null&&m9(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&m9(n),e===1)t.tag===0?r_e(oq.bind(null,t)):Hne(oq.bind(null,t)),JSe(function(){!(Zn&6)&&cp()}),n=null;else{switch(bne(r)){case 1:n=RB;break;case 4:n=yne;break;case 16:n=aA;break;case 536870912:n=vne;break;default:n=aA}n=Vre(n,$re.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function $re(t,e){if(M2=-1,R2=0,Zn&6)throw Error(Qe(327));var n=t.callbackNode;if(Yv()&&t.callbackNode!==n)return null;var r=oA(t,t===Ns?Ws:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=EA(t,r);else{e=r;var i=Zn;Zn|=2;var s=Fre();(Ns!==t||Ws!==e)&&(Td=null,jx=ki()+500,qm(t,e));do try{T_e();break}catch(o){Lre(t,o)}while(!0);HB(),SA.current=s,Zn=i,Ui!==null?e=0:(Ns=null,Ws=0,e=ss)}if(e!==0){if(e===2&&(i=U3(t),i!==0&&(r=i,e=gF(t,i))),e===1)throw n=U1,qm(t,0),ef(t,r),yo(t,ki()),n;if(e===6)ef(t,r);else{if(i=t.current.alternate,!(r&30)&&!S_e(i)&&(e=EA(t,r),e===2&&(s=U3(t),s!==0&&(r=s,e=gF(t,s))),e===1))throw n=U1,qm(t,0),ef(t,r),yo(t,ki()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Qe(345));case 2:sm(t,ao,Td);break;case 3:if(ef(t,r),(r&130023424)===r&&(e=aU+500-ki(),10<e)){if(oA(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Ba(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Y3(sm.bind(null,t,ao,Td),e);break}sm(t,ao,Td);break;case 4:if(ef(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var a=31-Dc(r);s=1<<a,a=e[a],a>i&&(i=a),r&=~s}if(r=i,r=ki()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*w_e(r/1960))-r,10<r){t.timeoutHandle=Y3(sm.bind(null,t,ao,Td),r);break}sm(t,ao,Td);break;case 5:sm(t,ao,Td);break;default:throw Error(Qe(329))}}}return yo(t,ki()),t.callbackNode===n?$re.bind(null,t):null}function gF(t,e){var n=l1;return t.current.memoizedState.isDehydrated&&(qm(t,e).flags|=256),t=EA(t,e),t!==2&&(e=ao,ao=n,e!==null&&yF(e)),t}function yF(t){ao===null?ao=t:ao.push.apply(ao,t)}function S_e(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Uc(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ef(t,e){for(e&=~sU,e&=~Vk,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Dc(e),r=1<<n;t[n]=-1,e&=~r}}function oq(t){if(Zn&6)throw Error(Qe(327));Yv();var e=oA(t,0);if(!(e&1))return yo(t,ki()),null;var n=EA(t,e);if(t.tag!==0&&n===2){var r=U3(t);r!==0&&(e=r,n=gF(t,r))}if(n===1)throw n=U1,qm(t,0),ef(t,e),yo(t,ki()),n;if(n===6)throw Error(Qe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,sm(t,ao,Td),yo(t,ki()),null}function oU(t,e){var n=Zn;Zn|=1;try{return t(e)}finally{Zn=n,Zn===0&&(jx=ki()+500,jk&&cp())}}function ug(t){pf!==null&&pf.tag===0&&!(Zn&6)&&Yv();var e=Zn;Zn|=1;var n=jl.transition,r=pr;try{if(jl.transition=null,pr=1,t)return t()}finally{pr=r,jl.transition=n,Zn=e,!(Zn&6)&&cp()}}function lU(){Lo=Mv.current,Ur(Mv)}function qm(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,QSe(n)),Ui!==null)for(n=Ui.return;n!==null;){var r=n;switch(UB(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&hA();break;case 3:Lx(),Ur(mo),Ur(ya),ZB();break;case 5:YB(r);break;case 4:Lx();break;case 13:Ur(ri);break;case 19:Ur(ri);break;case 10:GB(r.type._context);break;case 22:case 23:lU()}n=n.return}if(Ns=t,Ui=t=Af(t.current,null),Ws=Lo=e,ss=0,U1=null,sU=Vk=cg=0,ao=l1=null,Sm!==null){for(e=0;e<Sm.length;e++)if(n=Sm[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}Sm=null}return t}function Lre(t,e){do{var n=Ui;try{if(HB(),A2.current=wA,bA){for(var r=ci.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}bA=!1}if(lg=0,_s=ns=ci=null,a1=!1,j1=0,iU.current=null,n===null||n.return===null){ss=1,U1=e,Ui=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=Ws,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=o,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=X9(a);if(f!==null){f.flags&=-257,K9(f,a,o,s,e),f.mode&1&&q9(s,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var g=new Set;g.add(l),e.updateQueue=g}else p.add(l);break e}else{if(!(e&1)){q9(s,c,e),cU();break e}l=Error(Qe(426))}}else if(Xr&&o.mode&1){var m=X9(a);if(m!==null){!(m.flags&65536)&&(m.flags|=256),K9(m,a,o,s,e),VB(Fx(l,o));break e}}s=l=Fx(l,o),ss!==4&&(ss=2),l1===null?l1=[s]:l1.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=bre(s,l,e);B9(s,y);break e;case 1:o=l;var x=s.type,b=s.stateNode;if(!(s.flags&128)&&(typeof x.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Cf===null||!Cf.has(b)))){s.flags|=65536,e&=-e,s.lanes|=e;var _=wre(s,o,e);B9(s,_);break e}}s=s.return}while(s!==null)}zre(n)}catch(T){e=T,Ui===n&&n!==null&&(Ui=n=n.return);continue}break}while(!0)}function Fre(){var t=SA.current;return SA.current=wA,t===null?wA:t}function cU(){(ss===0||ss===3||ss===2)&&(ss=4),Ns===null||!(cg&268435455)&&!(Vk&268435455)||ef(Ns,Ws)}function EA(t,e){var n=Zn;Zn|=2;var r=Fre();(Ns!==t||Ws!==e)&&(Td=null,qm(t,e));do try{__e();break}catch(i){Lre(t,i)}while(!0);if(HB(),Zn=n,SA.current=r,Ui!==null)throw Error(Qe(261));return Ns=null,Ws=0,ss}function __e(){for(;Ui!==null;)jre(Ui)}function T_e(){for(;Ui!==null&&!K1e();)jre(Ui)}function jre(t){var e=Ure(t.alternate,t,Lo);t.memoizedProps=t.pendingProps,e===null?zre(t):Ui=e,iU.current=null}function zre(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=y_e(n,e),n!==null){n.flags&=32767,Ui=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ss=6,Ui=null;return}}else if(n=g_e(n,e,Lo),n!==null){Ui=n;return}if(e=e.sibling,e!==null){Ui=e;return}Ui=e=t}while(e!==null);ss===0&&(ss=5)}function sm(t,e,n){var r=pr,i=jl.transition;try{jl.transition=null,pr=1,E_e(t,e,n,r)}finally{jl.transition=i,pr=r}return null}function E_e(t,e,n,r){do Yv();while(pf!==null);if(Zn&6)throw Error(Qe(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Qe(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(sSe(t,s),t===Ns&&(Ui=Ns=null,Ws=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||UC||(UC=!0,Vre(aA,function(){return Yv(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=jl.transition,jl.transition=null;var a=pr;pr=1;var o=Zn;Zn|=4,iU.current=null,x_e(t,n),Ore(n,t),HSe(X3),lA=!!q3,X3=q3=null,t.current=n,b_e(n),Y1e(),Zn=o,pr=a,jl.transition=s}else t.current=n;if(UC&&(UC=!1,pf=t,TA=i),s=t.pendingLanes,s===0&&(Cf=null),J1e(n.stateNode),yo(t,ki()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(_A)throw _A=!1,t=pF,pF=null,t;return TA&1&&t.tag!==0&&Yv(),s=t.pendingLanes,s&1?t===mF?c1++:(c1=0,mF=t):c1=0,cp(),null}function Yv(){if(pf!==null){var t=bne(TA),e=jl.transition,n=pr;try{if(jl.transition=null,pr=16>t?16:t,pf===null)var r=!1;else{if(t=pf,pf=null,TA=0,Zn&6)throw Error(Qe(331));var i=Zn;for(Zn|=4,wt=t.current;wt!==null;){var s=wt,a=s.child;if(wt.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(wt=c;wt!==null;){var u=wt;switch(u.tag){case 0:case 11:case 15:o1(8,u,s)}var d=u.child;if(d!==null)d.return=u,wt=d;else for(;wt!==null;){u=wt;var h=u.sibling,f=u.return;if(Mre(u),u===c){wt=null;break}if(h!==null){h.return=f,wt=h;break}wt=f}}}var p=s.alternate;if(p!==null){var g=p.child;if(g!==null){p.child=null;do{var m=g.sibling;g.sibling=null,g=m}while(g!==null)}}wt=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,wt=a;else e:for(;wt!==null;){if(s=wt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:o1(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,wt=y;break e}wt=s.return}}var x=t.current;for(wt=x;wt!==null;){a=wt;var b=a.child;if(a.subtreeFlags&2064&&b!==null)b.return=a,wt=b;else e:for(a=x;wt!==null;){if(o=wt,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Uk(9,o)}}catch(T){gi(o,o.return,T)}if(o===a){wt=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,wt=_;break e}wt=o.return}}if(Zn=i,cp(),Mu&&typeof Mu.onPostCommitFiberRoot=="function")try{Mu.onPostCommitFiberRoot(Ok,t)}catch{}r=!0}return r}finally{pr=n,jl.transition=e}}return!1}function lq(t,e,n){e=Fx(n,e),e=bre(t,e,1),t=Ef(t,e,1),e=Ba(),t!==null&&(M_(t,1,e),yo(t,e))}function gi(t,e,n){if(t.tag===3)lq(t,t,n);else for(;e!==null;){if(e.tag===3){lq(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cf===null||!Cf.has(r))){t=Fx(n,t),t=wre(e,t,1),e=Ef(e,t,1),t=Ba(),e!==null&&(M_(e,1,t),yo(e,t));break}}e=e.return}}function C_e(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Ba(),t.pingedLanes|=t.suspendedLanes&n,Ns===t&&(Ws&n)===n&&(ss===4||ss===3&&(Ws&130023424)===Ws&&500>ki()-aU?qm(t,0):sU|=n),yo(t,e)}function Bre(t,e){e===0&&(t.mode&1?(e=RC,RC<<=1,!(RC&130023424)&&(RC=4194304)):e=1);var n=Ba();t=Qd(t,e),t!==null&&(M_(t,e,n),yo(t,n))}function N_e(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Bre(t,n)}function A_e(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Qe(314))}r!==null&&r.delete(e),Bre(t,n)}var Ure;Ure=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mo.current)uo=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return uo=!1,m_e(t,e,n);uo=!!(t.flags&131072)}else uo=!1,Xr&&e.flags&1048576&&Gne(e,mA,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;k2(t,e),t=e.pendingProps;var i=Ox(e,ya.current);Kv(e,n),i=JB(null,e,r,t,i,n);var s=eU();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,go(r)?(s=!0,fA(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,XB(e),i.updater=Bk,e.stateNode=i,i._reactInternals=e,rF(e,r,t,n),e=aF(null,e,r,!0,s,n)):(e.tag=0,Xr&&s&&BB(e),Ra(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(k2(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=k_e(r),t=pc(r,t),i){case 0:e=sF(null,e,r,t,n);break e;case 1:e=Q9(null,e,r,t,n);break e;case 11:e=Y9(null,e,r,t,n);break e;case 14:e=Z9(null,e,r,pc(r.type,t),n);break e}throw Error(Qe(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pc(r,i),sF(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pc(r,i),Q9(t,e,r,i,n);case 3:e:{if(Ere(e),t===null)throw Error(Qe(387));r=e.pendingProps,s=e.memoizedState,i=s.element,Qne(t,e),vA(e,r,null,n);var a=e.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Fx(Error(Qe(423)),e),e=J9(t,e,r,n,i);break e}else if(r!==i){i=Fx(Error(Qe(424)),e),e=J9(t,e,r,n,i);break e}else for(Ho=Tf(e.stateNode.containerInfo.firstChild),qo=e,Xr=!0,bc=null,n=Yne(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Dx(),r===i){e=Jd(t,e,n);break e}Ra(t,e,r,n)}e=e.child}return e;case 5:return Jne(e),t===null&&eF(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,a=i.children,K3(r,i)?a=null:s!==null&&K3(r,s)&&(e.flags|=32),Tre(t,e),Ra(t,e,a,n),e.child;case 6:return t===null&&eF(e),null;case 13:return Cre(t,e,n);case 4:return KB(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=$x(e,null,r,n):Ra(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pc(r,i),Y9(t,e,r,i,n);case 7:return Ra(t,e,e.pendingProps,n),e.child;case 8:return Ra(t,e,e.pendingProps.children,n),e.child;case 12:return Ra(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,a=i.value,Rr(gA,r._currentValue),r._currentValue=a,s!==null)if(Uc(s.value,a)){if(s.children===i.children&&!mo.current){e=Jd(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Bd(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),tF(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(Qe(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),tF(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}Ra(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,Kv(e,n),i=Wl(i),r=r(i),e.flags|=1,Ra(t,e,r,n),e.child;case 14:return r=e.type,i=pc(r,e.pendingProps),i=pc(r.type,i),Z9(t,e,r,i,n);case 15:return Sre(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:pc(r,i),k2(t,e),e.tag=1,go(r)?(t=!0,fA(e)):t=!1,Kv(e,n),xre(e,r,i),rF(e,r,i,n),aF(null,e,r,!0,t,n);case 19:return Nre(t,e,n);case 22:return _re(t,e,n)}throw Error(Qe(156,e.tag))};function Vre(t,e){return gne(t,e)}function I_e(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ml(t,e,n,r){return new I_e(t,e,n,r)}function uU(t){return t=t.prototype,!(!t||!t.isReactComponent)}function k_e(t){if(typeof t=="function")return uU(t)?1:0;if(t!=null){if(t=t.$$typeof,t===IB)return 11;if(t===kB)return 14}return 2}function Af(t,e){var n=t.alternate;return n===null?(n=Ml(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function P2(t,e,n,r,i,s){var a=2;if(r=t,typeof t=="function")uU(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case wv:return Xm(n.children,i,s,e);case AB:a=8,i|=8;break;case N3:return t=Ml(12,n,e,i|2),t.elementType=N3,t.lanes=s,t;case A3:return t=Ml(13,n,e,i),t.elementType=A3,t.lanes=s,t;case I3:return t=Ml(19,n,e,i),t.elementType=I3,t.lanes=s,t;case Jte:return Wk(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Zte:a=10;break e;case Qte:a=9;break e;case IB:a=11;break e;case kB:a=14;break e;case Xh:a=16,r=null;break e}throw Error(Qe(130,t==null?t:typeof t,""))}return e=Ml(a,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Xm(t,e,n,r){return t=Ml(7,t,r,e),t.lanes=n,t}function Wk(t,e,n,r){return t=Ml(22,t,r,e),t.elementType=Jte,t.lanes=n,t.stateNode={isHidden:!1},t}function c$(t,e,n){return t=Ml(6,t,null,e),t.lanes=n,t}function u$(t,e,n){return e=Ml(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function M_e(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=WD(0),this.expirationTimes=WD(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=WD(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function dU(t,e,n,r,i,s,a,o,l){return t=new M_e(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Ml(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},XB(s),t}function R_e(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bv,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Wre(t){if(!t)return jf;t=t._reactInternals;e:{if(Hg(t)!==t||t.tag!==1)throw Error(Qe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(go(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Qe(171))}if(t.tag===1){var n=t.type;if(go(n))return Wne(t,n,e)}return e}function Hre(t,e,n,r,i,s,a,o,l){return t=dU(n,r,!0,t,i,s,a,o,l),t.context=Wre(null),n=t.current,r=Ba(),i=Nf(n),s=Bd(r,i),s.callback=e??null,Ef(n,s,i),t.current.lanes=i,M_(t,i,r),yo(t,r),t}function Hk(t,e,n,r){var i=e.current,s=Ba(),a=Nf(i);return n=Wre(n),e.context===null?e.context=n:e.pendingContext=n,e=Bd(s,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Ef(i,e,a),t!==null&&($c(t,i,a,s),N2(t,i,a)),a}function CA(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cq(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function hU(t,e){cq(t,e),(t=t.alternate)&&cq(t,e)}function P_e(){return null}var Gre=typeof reportError=="function"?reportError:function(t){console.error(t)};function fU(t){this._internalRoot=t}Gk.prototype.render=fU.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Qe(409));Hk(t,e,null,null)};Gk.prototype.unmount=fU.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ug(function(){Hk(null,t,null,null)}),e[Zd]=null}};function Gk(t){this._internalRoot=t}Gk.prototype.unstable_scheduleHydration=function(t){if(t){var e=_ne();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Jh.length&&e!==0&&e<Jh[n].priority;n++);Jh.splice(n,0,t),n===0&&Ene(t)}};function pU(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function uq(){}function O_e(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=CA(a);s.call(c)}}var a=Hre(e,r,t,0,null,!1,!1,"",uq);return t._reactRootContainer=a,t[Zd]=a.current,O1(t.nodeType===8?t.parentNode:t),ug(),a}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var c=CA(l);o.call(c)}}var l=dU(t,0,!1,null,null,!1,!1,"",uq);return t._reactRootContainer=l,t[Zd]=l.current,O1(t.nodeType===8?t.parentNode:t),ug(function(){Hk(e,l,n,r)}),l}function Xk(t,e,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=CA(a);o.call(l)}}Hk(e,a,t,i)}else a=O_e(n,e,t,i,r);return CA(a)}wne=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=jw(e.pendingLanes);n!==0&&(PB(e,n|1),yo(e,ki()),!(Zn&6)&&(jx=ki()+500,cp()))}break;case 13:ug(function(){var r=Qd(t,1);if(r!==null){var i=Ba();$c(r,t,1,i)}}),hU(t,1)}};OB=function(t){if(t.tag===13){var e=Qd(t,134217728);if(e!==null){var n=Ba();$c(e,t,134217728,n)}hU(t,134217728)}};Sne=function(t){if(t.tag===13){var e=Nf(t),n=Qd(t,e);if(n!==null){var r=Ba();$c(n,t,e,r)}hU(t,e)}};_ne=function(){return pr};Tne=function(t,e){var n=pr;try{return pr=t,e()}finally{pr=n}};j3=function(t,e,n){switch(e){case"input":if(R3(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Fk(r);if(!i)throw Error(Qe(90));tne(r),R3(r,i)}}}break;case"textarea":rne(t,n);break;case"select":e=n.value,e!=null&&Hv(t,!!n.multiple,e,!1)}};une=oU;dne=ug;var D_e={usingClientEntryPoint:!1,Events:[P_,Ev,Fk,lne,cne,oU]},iw={findFiberByHostInstance:wm,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$_e={bundleType:iw.bundleType,version:iw.version,rendererPackageName:iw.rendererPackageName,rendererConfig:iw.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ph.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=pne(t),t===null?null:t.stateNode},findFiberByHostInstance:iw.findFiberByHostInstance||P_e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var VC=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!VC.isDisabled&&VC.supportsFiber)try{Ok=VC.inject($_e),Mu=VC}catch{}}rl.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D_e;rl.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pU(e))throw Error(Qe(200));return R_e(t,e,null,n)};rl.createRoot=function(t,e){if(!pU(t))throw Error(Qe(299));var n=!1,r="",i=Gre;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=dU(t,1,!1,null,null,n,!1,r,i),t[Zd]=e.current,O1(t.nodeType===8?t.parentNode:t),new fU(e)};rl.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Qe(188)):(t=Object.keys(t).join(","),Error(Qe(268,t)));return t=pne(e),t=t===null?null:t.stateNode,t};rl.flushSync=function(t){return ug(t)};rl.hydrate=function(t,e,n){if(!qk(e))throw Error(Qe(200));return Xk(null,t,e,!0,n)};rl.hydrateRoot=function(t,e,n){if(!pU(t))throw Error(Qe(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=Gre;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=Hre(e,null,t,1,n??null,i,!1,s,a),t[Zd]=e.current,O1(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Gk(e)};rl.render=function(t,e,n){if(!qk(e))throw Error(Qe(200));return Xk(null,t,e,!1,n)};rl.unmountComponentAtNode=function(t){if(!qk(t))throw Error(Qe(40));return t._reactRootContainer?(ug(function(){Xk(null,null,t,!1,function(){t._reactRootContainer=null,t[Zd]=null})}),!0):!1};rl.unstable_batchedUpdates=oU;rl.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!qk(n))throw Error(Qe(200));if(t==null||t._reactInternals===void 0)throw Error(Qe(38));return Xk(t,e,n,!1,r)};rl.version="18.3.1-next-f1338f8080-20240426";function qre(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qre)}catch(t){console.error(t)}}qre(),qte.exports=rl;var Gg=qte.exports;const L_e=lr(Gg);var Xre,dq=Gg;Xre=dq.createRoot,dq.hydrateRoot;function F_e(t,e){if(t instanceof RegExp)return{keys:!1,pattern:t};var n,r,i,s,a=[],o="",l=t.split("/");for(l[0]||l.shift();i=l.shift();)n=i[0],n==="*"?(a.push(n),o+=i[1]==="?"?"(?:/(.*))?":"/(.*)"):n===":"?(r=i.indexOf("?",1),s=i.indexOf(".",1),a.push(i.substring(1,~r?r:~s?s:i.length)),o+=~r&&!~s?"(?:/([^/]+?))?":"/([^/]+?)",~s&&(o+=(~r?"?":"")+"\\"+i.substring(s))):o+="/"+i;return{keys:a,pattern:new RegExp("^"+o+(e?"(?=$|/)":"/?$"),"i")}}var Kre={exports:{}},Yre={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zx=P;function j_e(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var z_e=typeof Object.is=="function"?Object.is:j_e,B_e=zx.useState,U_e=zx.useEffect,V_e=zx.useLayoutEffect,W_e=zx.useDebugValue;function H_e(t,e){var n=e(),r=B_e({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return V_e(function(){i.value=n,i.getSnapshot=e,d$(i)&&s({inst:i})},[t,n,e]),U_e(function(){return d$(i)&&s({inst:i}),t(function(){d$(i)&&s({inst:i})})},[t]),W_e(n),n}function d$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!z_e(t,n)}catch{return!0}}function G_e(t,e){return e()}var q_e=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?G_e:H_e;Yre.useSyncExternalStore=zx.useSyncExternalStore!==void 0?zx.useSyncExternalStore:q_e;Kre.exports=Yre;var Zre=Kre.exports;const X_e=TB.useInsertionEffect,K_e=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Y_e=K_e?P.useLayoutEffect:P.useEffect,Z_e=X_e||Y_e,Qre=t=>{const e=P.useRef([t,(...n)=>e[0](...n)]).current;return Z_e(()=>{e[0]=t}),e[1]},Q_e="popstate",mU="pushState",gU="replaceState",J_e="hashchange",hq=[Q_e,mU,gU,J_e],eTe=t=>{for(const e of hq)addEventListener(e,t);return()=>{for(const e of hq)removeEventListener(e,t)}},Jre=(t,e)=>Zre.useSyncExternalStore(eTe,t,e),tTe=()=>location.search,nTe=({ssrSearch:t=""}={})=>Jre(tTe,()=>t),fq=()=>location.pathname,rTe=({ssrPath:t}={})=>Jre(fq,t?()=>t:fq),iTe=(t,{replace:e=!1,state:n=null}={})=>history[e?gU:mU](n,"",t),sTe=(t={})=>[rTe(t),iTe],pq=Symbol.for("wouter_v3");if(typeof history<"u"&&typeof window[pq]>"u"){for(const t of[mU,gU]){const e=history[t];history[t]=function(){const n=e.apply(this,arguments),r=new Event(t);return r.arguments=arguments,dispatchEvent(r),n}}Object.defineProperty(window,pq,{value:!0})}const aTe=(t,e)=>e.toLowerCase().indexOf(t.toLowerCase())?"~"+e:e.slice(t.length)||"/",eie=(t="")=>t==="/"?"":t,oTe=(t,e)=>t[0]==="~"?t.slice(1):eie(e)+t,lTe=(t="",e)=>aTe(mq(eie(t)),mq(e)),mq=t=>{try{return decodeURI(t)}catch{return t}},tie={hook:sTe,searchHook:nTe,parser:F_e,base:"",ssrPath:void 0,ssrSearch:void 0,ssrContext:void 0,hrefs:t=>t},nie=P.createContext(tie),D_=()=>P.useContext(nie),rie={},iie=P.createContext(rie),cTe=()=>P.useContext(iie),Kk=t=>{const[e,n]=t.hook(t);return[lTe(t.base,e),Qre((r,i)=>n(oTe(r,t.base),i))]},yU=()=>Kk(D_()),sie=(t,e,n,r)=>{const{pattern:i,keys:s}=e instanceof RegExp?{keys:!1,pattern:e}:t(e||"*",r),a=i.exec(n)||[],[o,...l]=a;return o!==void 0?[!0,(()=>{const c=s!==!1?Object.fromEntries(s.map((d,h)=>[d,l[h]])):a.groups;let u={...l};return c&&Object.assign(u,c),u})(),...r?[o]:[]]:[!1,null]},uTe=({children:t,...e})=>{var u,d;const n=D_(),r=e.hook?tie:n;let i=r;const[s,a]=((u=e.ssrPath)==null?void 0:u.split("?"))??[];a&&(e.ssrSearch=a,e.ssrPath=s),e.hrefs=e.hrefs??((d=e.hook)==null?void 0:d.hrefs);let o=P.useRef({}),l=o.current,c=l;for(let h in r){const f=h==="base"?r[h]+(e[h]||""):e[h]||r[h];l===c&&f!==c[h]&&(o.current=c={...c}),c[h]=f,f!==r[h]&&(i=c)}return P.createElement(nie.Provider,{value:i,children:t})},gq=({children:t,component:e},n)=>e?P.createElement(e,{params:n}):typeof t=="function"?t(n):t,dTe=t=>{let e=P.useRef(rie);const n=e.current;return e.current=Object.keys(t).length!==Object.keys(n).length||Object.entries(t).some(([r,i])=>i!==n[r])?t:n},sc=({path:t,nest:e,match:n,...r})=>{const i=D_(),[s]=Kk(i),[a,o,l]=n??sie(i.parser,t,s,e),c=dTe({...cTe(),...o});if(!a)return null;const u=l?P.createElement(uTe,{base:l},gq(r,c)):gq(r,c);return P.createElement(iie.Provider,{value:c,children:u})},Lc=P.forwardRef((t,e)=>{const n=D_(),[r,i]=Kk(n),{to:s="",href:a=s,onClick:o,asChild:l,children:c,className:u,replace:d,state:h,...f}=t,p=Qre(m=>{m.ctrlKey||m.metaKey||m.altKey||m.shiftKey||m.button!==0||(o==null||o(m),m.defaultPrevented||(m.preventDefault(),i(a,t)))}),g=n.hrefs(a[0]==="~"?a.slice(1):n.base+a,n);return l&&P.isValidElement(c)?P.cloneElement(c,{onClick:p,href:g}):P.createElement("a",{...f,onClick:p,href:g,className:u!=null&&u.call?u(r===a):u,children:c,ref:e})}),aie=t=>Array.isArray(t)?t.flatMap(e=>aie(e&&e.type===P.Fragment?e.props.children:e)):[t],hTe=({children:t,location:e})=>{const n=D_(),[r]=Kk(n);for(const i of aie(t)){let s=0;if(P.isValidElement(i)&&(s=sie(n.parser,i.props.path,e||r,i.props.nest))[0])return P.cloneElement(i,{match:s})}return null};var $_=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},dg=typeof window>"u"||"Deno"in globalThis;function so(){}function fTe(t,e){return typeof t=="function"?t(e):t}function vF(t){return typeof t=="number"&&t>=0&&t!==1/0}function oie(t,e){return Math.max(t+(e||0)-Date.now(),0)}function Zv(t,e){return typeof t=="function"?t(e):t}function wc(t,e){return typeof t=="function"?t(e):t}function yq(t,e){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:a,stale:o}=t;if(a){if(r){if(e.queryHash!==vU(a,e.options))return!1}else if(!W1(e.queryKey,a))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||i&&i!==e.state.fetchStatus||s&&!s(e))}function vq(t,e){const{exact:n,status:r,predicate:i,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(V1(e.options.mutationKey)!==V1(s))return!1}else if(!W1(e.options.mutationKey,s))return!1}return!(r&&e.state.status!==r||i&&!i(e))}function vU(t,e){return((e==null?void 0:e.queryKeyHashFn)||V1)(t)}function V1(t){return JSON.stringify(t,(e,n)=>bF(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function W1(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>W1(t[n],e[n])):!1}function lie(t,e){if(t===e)return t;const n=xq(t)&&xq(e);if(n||bF(t)&&bF(e)){const r=n?t:Object.keys(t),i=r.length,s=n?e:Object.keys(e),a=s.length,o=n?[]:{};let l=0;for(let c=0;c<a;c++){const u=n?c:s[c];(!n&&r.includes(u)||n)&&t[u]===void 0&&e[u]===void 0?(o[u]=void 0,l++):(o[u]=lie(t[u],e[u]),o[u]===t[u]&&t[u]!==void 0&&l++)}return i===a&&l===i?t:o}return e}function xF(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const n in t)if(t[n]!==e[n])return!1;return!0}function xq(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function bF(t){if(!bq(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!bq(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function bq(t){return Object.prototype.toString.call(t)==="[object Object]"}function pTe(t){return new Promise(e=>{setTimeout(e,t)})}function wF(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?lie(t,e):e}function mTe(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function gTe(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var xU=Symbol();function cie(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===xU?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function yTe(t,e){return typeof t=="function"?t(...e):!!t}var jm,sf,bx,Ete,vTe=(Ete=class extends $_{constructor(){super();rn(this,jm);rn(this,sf);rn(this,bx);Nt(this,bx,e=>{if(!dg&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ye(this,sf)||this.setEventListener(ye(this,bx))}onUnsubscribe(){var e;this.hasListeners()||((e=ye(this,sf))==null||e.call(this),Nt(this,sf,void 0))}setEventListener(e){var n;Nt(this,bx,e),(n=ye(this,sf))==null||n.call(this),Nt(this,sf,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){ye(this,jm)!==e&&(Nt(this,jm,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof ye(this,jm)=="boolean"?ye(this,jm):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},jm=new WeakMap,sf=new WeakMap,bx=new WeakMap,Ete),bU=new vTe,wx,af,Sx,Cte,xTe=(Cte=class extends $_{constructor(){super();rn(this,wx,!0);rn(this,af);rn(this,Sx);Nt(this,Sx,e=>{if(!dg&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){ye(this,af)||this.setEventListener(ye(this,Sx))}onUnsubscribe(){var e;this.hasListeners()||((e=ye(this,af))==null||e.call(this),Nt(this,af,void 0))}setEventListener(e){var n;Nt(this,Sx,e),(n=ye(this,af))==null||n.call(this),Nt(this,af,e(this.setOnline.bind(this)))}setOnline(e){ye(this,wx)!==e&&(Nt(this,wx,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return ye(this,wx)}},wx=new WeakMap,af=new WeakMap,Sx=new WeakMap,Cte),NA=new xTe;function SF(){let t,e;const n=new Promise((i,s)=>{t=i,e=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),t(i)},n.reject=i=>{r({status:"rejected",reason:i}),e(i)},n}function bTe(t){return Math.min(1e3*2**t,3e4)}function uie(t){return(t??"online")==="online"?NA.isOnline():!0}var die=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function h$(t){return t instanceof die}function hie(t){let e=!1,n=0,r=!1,i;const s=SF(),a=g=>{var m;r||(h(new die(g)),(m=t.abort)==null||m.call(t))},o=()=>{e=!0},l=()=>{e=!1},c=()=>bU.isFocused()&&(t.networkMode==="always"||NA.isOnline())&&t.canRun(),u=()=>uie(t.networkMode)&&t.canRun(),d=g=>{var m;r||(r=!0,(m=t.onSuccess)==null||m.call(t,g),i==null||i(),s.resolve(g))},h=g=>{var m;r||(r=!0,(m=t.onError)==null||m.call(t,g),i==null||i(),s.reject(g))},f=()=>new Promise(g=>{var m;i=y=>{(r||c())&&g(y)},(m=t.onPause)==null||m.call(t)}).then(()=>{var g;i=void 0,r||(g=t.onContinue)==null||g.call(t)}),p=()=>{if(r)return;let g;const m=n===0?t.initialPromise:void 0;try{g=m??t.fn()}catch(y){g=Promise.reject(y)}Promise.resolve(g).then(d).catch(y=>{var E;if(r)return;const x=t.retry??(dg?0:3),b=t.retryDelay??bTe,_=typeof b=="function"?b(n,y):b,T=x===!0||typeof x=="number"&&n<x||typeof x=="function"&&x(n,y);if(e||!T){h(y);return}n++,(E=t.onFail)==null||E.call(t,n,y),pTe(_).then(()=>c()?void 0:f()).then(()=>{e?h(y):p()})})};return{promise:s,cancel:a,continue:()=>(i==null||i(),s),cancelRetry:o,continueRetry:l,canStart:u,start:()=>(u()?p():f().then(p),s)}}var wTe=t=>setTimeout(t,0);function STe(){let t=[],e=0,n=o=>{o()},r=o=>{o()},i=wTe;const s=o=>{e?t.push(o):i(()=>{n(o)})},a=()=>{const o=t;t=[],o.length&&i(()=>{r(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{i=o}}}var Us=STe(),zm,Nte,fie=(Nte=class{constructor(){rn(this,zm)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),vF(this.gcTime)&&Nt(this,zm,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(dg?1/0:5*60*1e3))}clearGcTimeout(){ye(this,zm)&&(clearTimeout(ye(this,zm)),Nt(this,zm,void 0))}},zm=new WeakMap,Nte),_x,Tx,Tl,Bm,aa,C_,Um,gc,Sd,Ate,_Te=(Ate=class extends fie{constructor(e){super();rn(this,gc);rn(this,_x);rn(this,Tx);rn(this,Tl);rn(this,Bm);rn(this,aa);rn(this,C_);rn(this,Um);Nt(this,Um,!1),Nt(this,C_,e.defaultOptions),this.setOptions(e.options),this.observers=[],Nt(this,Bm,e.client),Nt(this,Tl,ye(this,Bm).getQueryCache()),this.queryKey=e.queryKey,this.queryHash=e.queryHash,Nt(this,_x,TTe(this.options)),this.state=e.state??ye(this,_x),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=ye(this,aa))==null?void 0:e.promise}setOptions(e){this.options={...ye(this,C_),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ye(this,Tl).remove(this)}setData(e,n){const r=wF(this.state.data,e,this.options);return zn(this,gc,Sd).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(e,n){zn(this,gc,Sd).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var r,i;const n=(r=ye(this,aa))==null?void 0:r.promise;return(i=ye(this,aa))==null||i.cancel(e),n?n.then(so).catch(so):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ye(this,_x))}isActive(){return this.observers.some(e=>wc(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===xU||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!oie(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(r=>r.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=ye(this,aa))==null||n.continue()}onOnline(){var n;const e=this.observers.find(r=>r.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=ye(this,aa))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),ye(this,Tl).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(ye(this,aa)&&(ye(this,Um)?ye(this,aa).cancel({revert:!0}):ye(this,aa).cancelRetry()),this.scheduleGc()),ye(this,Tl).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||zn(this,gc,Sd).call(this,{type:"invalidate"})}fetch(e,n){var l,c,u;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ye(this,aa))return ye(this,aa).continueRetry(),ye(this,aa).promise}if(e&&this.setOptions(e),!this.options.queryFn){const d=this.observers.find(h=>h.options.queryFn);d&&this.setOptions(d.options)}const r=new AbortController,i=d=>{Object.defineProperty(d,"signal",{enumerable:!0,get:()=>(Nt(this,Um,!0),r.signal)})},s=()=>{const d=cie(this.options,n),h={client:ye(this,Bm),queryKey:this.queryKey,meta:this.meta};return i(h),Nt(this,Um,!1),this.options.persister?this.options.persister(d,h,this):d(h)},a={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ye(this,Bm),state:this.state,fetchFn:s};i(a),(l=this.options.behavior)==null||l.onFetch(a,this),Nt(this,Tx,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=a.fetchOptions)==null?void 0:c.meta))&&zn(this,gc,Sd).call(this,{type:"fetch",meta:(u=a.fetchOptions)==null?void 0:u.meta});const o=d=>{var h,f,p,g;h$(d)&&d.silent||zn(this,gc,Sd).call(this,{type:"error",error:d}),h$(d)||((f=(h=ye(this,Tl).config).onError)==null||f.call(h,d,this),(g=(p=ye(this,Tl).config).onSettled)==null||g.call(p,this.state.data,d,this)),this.scheduleGc()};return Nt(this,aa,hie({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,abort:r.abort.bind(r),onSuccess:d=>{var h,f,p,g;if(d===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(d)}catch(m){o(m);return}(f=(h=ye(this,Tl).config).onSuccess)==null||f.call(h,d,this),(g=(p=ye(this,Tl).config).onSettled)==null||g.call(p,d,this.state.error,this),this.scheduleGc()},onError:o,onFail:(d,h)=>{zn(this,gc,Sd).call(this,{type:"failed",failureCount:d,error:h})},onPause:()=>{zn(this,gc,Sd).call(this,{type:"pause"})},onContinue:()=>{zn(this,gc,Sd).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),ye(this,aa).start()}},_x=new WeakMap,Tx=new WeakMap,Tl=new WeakMap,Bm=new WeakMap,aa=new WeakMap,C_=new WeakMap,Um=new WeakMap,gc=new WeakSet,Sd=function(e){const n=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...pie(r.data,this.options),fetchMeta:e.meta??null};case"success":return{...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const i=e.error;return h$(i)&&i.revert&&ye(this,Tx)?{...ye(this,Tx),fetchStatus:"idle"}:{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=n(this.state),Us.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ye(this,Tl).notify({query:this,type:"updated",action:e})})},Ate);function pie(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:uie(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function TTe(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var vu,Ite,ETe=(Ite=class extends $_{constructor(e={}){super();rn(this,vu);this.config=e,Nt(this,vu,new Map)}build(e,n,r){const i=n.queryKey,s=n.queryHash??vU(i,n);let a=this.get(s);return a||(a=new _Te({client:e,queryKey:i,queryHash:s,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(i)}),this.add(a)),a}add(e){ye(this,vu).has(e.queryHash)||(ye(this,vu).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=ye(this,vu).get(e.queryHash);n&&(e.destroy(),n===e&&ye(this,vu).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Us.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return ye(this,vu).get(e)}getAll(){return[...ye(this,vu).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>yq(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>yq(e,r)):n}notify(e){Us.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Us.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Us.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},vu=new WeakMap,Ite),xu,Ia,Vm,bu,Hh,kte,CTe=(kte=class extends fie{constructor(e){super();rn(this,bu);rn(this,xu);rn(this,Ia);rn(this,Vm);this.mutationId=e.mutationId,Nt(this,Ia,e.mutationCache),Nt(this,xu,[]),this.state=e.state||NTe(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){ye(this,xu).includes(e)||(ye(this,xu).push(e),this.clearGcTimeout(),ye(this,Ia).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){Nt(this,xu,ye(this,xu).filter(n=>n!==e)),this.scheduleGc(),ye(this,Ia).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){ye(this,xu).length||(this.state.status==="pending"?this.scheduleGc():ye(this,Ia).remove(this))}continue(){var e;return((e=ye(this,Vm))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var s,a,o,l,c,u,d,h,f,p,g,m,y,x,b,_,T,E,C,I;const n=()=>{zn(this,bu,Hh).call(this,{type:"continue"})};Nt(this,Vm,hie({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(A,k)=>{zn(this,bu,Hh).call(this,{type:"failed",failureCount:A,error:k})},onPause:()=>{zn(this,bu,Hh).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ye(this,Ia).canRun(this)}));const r=this.state.status==="pending",i=!ye(this,Vm).canStart();try{if(r)n();else{zn(this,bu,Hh).call(this,{type:"pending",variables:e,isPaused:i}),await((a=(s=ye(this,Ia).config).onMutate)==null?void 0:a.call(s,e,this));const k=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,e));k!==this.state.context&&zn(this,bu,Hh).call(this,{type:"pending",context:k,variables:e,isPaused:i})}const A=await ye(this,Vm).start();return await((u=(c=ye(this,Ia).config).onSuccess)==null?void 0:u.call(c,A,e,this.state.context,this)),await((h=(d=this.options).onSuccess)==null?void 0:h.call(d,A,e,this.state.context)),await((p=(f=ye(this,Ia).config).onSettled)==null?void 0:p.call(f,A,null,this.state.variables,this.state.context,this)),await((m=(g=this.options).onSettled)==null?void 0:m.call(g,A,null,e,this.state.context)),zn(this,bu,Hh).call(this,{type:"success",data:A}),A}catch(A){try{throw await((x=(y=ye(this,Ia).config).onError)==null?void 0:x.call(y,A,e,this.state.context,this)),await((_=(b=this.options).onError)==null?void 0:_.call(b,A,e,this.state.context)),await((E=(T=ye(this,Ia).config).onSettled)==null?void 0:E.call(T,void 0,A,this.state.variables,this.state.context,this)),await((I=(C=this.options).onSettled)==null?void 0:I.call(C,void 0,A,e,this.state.context)),A}finally{zn(this,bu,Hh).call(this,{type:"error",error:A})}}finally{ye(this,Ia).runNext(this)}}},xu=new WeakMap,Ia=new WeakMap,Vm=new WeakMap,bu=new WeakSet,Hh=function(e){const n=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Us.batch(()=>{ye(this,xu).forEach(r=>{r.onMutationUpdate(e)}),ye(this,Ia).notify({mutation:this,type:"updated",action:e})})},kte);function NTe(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var kd,yc,N_,Mte,ATe=(Mte=class extends $_{constructor(e={}){super();rn(this,kd);rn(this,yc);rn(this,N_);this.config=e,Nt(this,kd,new Set),Nt(this,yc,new Map),Nt(this,N_,0)}build(e,n,r){const i=new CTe({mutationCache:this,mutationId:++CC(this,N_)._,options:e.defaultMutationOptions(n),state:r});return this.add(i),i}add(e){ye(this,kd).add(e);const n=WC(e);if(typeof n=="string"){const r=ye(this,yc).get(n);r?r.push(e):ye(this,yc).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(ye(this,kd).delete(e)){const n=WC(e);if(typeof n=="string"){const r=ye(this,yc).get(n);if(r)if(r.length>1){const i=r.indexOf(e);i!==-1&&r.splice(i,1)}else r[0]===e&&ye(this,yc).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=WC(e);if(typeof n=="string"){const r=ye(this,yc).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===e}else return!0}runNext(e){var r;const n=WC(e);if(typeof n=="string"){const i=(r=ye(this,yc).get(n))==null?void 0:r.find(s=>s!==e&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Us.batch(()=>{ye(this,kd).forEach(e=>{this.notify({type:"removed",mutation:e})}),ye(this,kd).clear(),ye(this,yc).clear()})}getAll(){return Array.from(ye(this,kd))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>vq(n,r))}findAll(e={}){return this.getAll().filter(n=>vq(e,n))}notify(e){Us.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Us.batch(()=>Promise.all(e.map(n=>n.continue().catch(so))))}},kd=new WeakMap,yc=new WeakMap,N_=new WeakMap,Mte);function WC(t){var e;return(e=t.options.scope)==null?void 0:e.id}function wq(t){return{onFetch:(e,n)=>{var u,d,h,f,p;const r=e.options,i=(h=(d=(u=e.fetchOptions)==null?void 0:u.meta)==null?void 0:d.fetchMore)==null?void 0:h.direction,s=((f=e.state.data)==null?void 0:f.pages)||[],a=((p=e.state.data)==null?void 0:p.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let g=!1;const m=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(e.signal.aborted?g=!0:e.signal.addEventListener("abort",()=>{g=!0}),e.signal)})},y=cie(e.options,e.fetchOptions),x=async(b,_,T)=>{if(g)return Promise.reject();if(_==null&&b.pages.length)return Promise.resolve(b);const E={client:e.client,queryKey:e.queryKey,pageParam:_,direction:T?"backward":"forward",meta:e.options.meta};m(E);const C=await y(E),{maxPages:I}=e.options,A=T?gTe:mTe;return{pages:A(b.pages,C,I),pageParams:A(b.pageParams,_,I)}};if(i&&s.length){const b=i==="backward",_=b?ITe:Sq,T={pages:s,pageParams:a},E=_(r,T);o=await x(T,E,b)}else{const b=t??s.length;do{const _=l===0?a[0]??r.initialPageParam:Sq(r,o);if(l>0&&_==null)break;o=await x(o,_),l++}while(l<b)}return o};e.options.persister?e.fetchFn=()=>{var g,m;return(m=(g=e.options).persister)==null?void 0:m.call(g,c,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function Sq(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function ITe(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var mi,of,lf,Ex,Cx,cf,Nx,Ax,Rte,kTe=(Rte=class{constructor(t={}){rn(this,mi);rn(this,of);rn(this,lf);rn(this,Ex);rn(this,Cx);rn(this,cf);rn(this,Nx);rn(this,Ax);Nt(this,mi,t.queryCache||new ETe),Nt(this,of,t.mutationCache||new ATe),Nt(this,lf,t.defaultOptions||{}),Nt(this,Ex,new Map),Nt(this,Cx,new Map),Nt(this,cf,0)}mount(){CC(this,cf)._++,ye(this,cf)===1&&(Nt(this,Nx,bU.subscribe(async t=>{t&&(await this.resumePausedMutations(),ye(this,mi).onFocus())})),Nt(this,Ax,NA.subscribe(async t=>{t&&(await this.resumePausedMutations(),ye(this,mi).onOnline())})))}unmount(){var t,e;CC(this,cf)._--,ye(this,cf)===0&&((t=ye(this,Nx))==null||t.call(this),Nt(this,Nx,void 0),(e=ye(this,Ax))==null||e.call(this),Nt(this,Ax,void 0))}isFetching(t){return ye(this,mi).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return ye(this,of).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ye(this,mi).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=ye(this,mi).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(Zv(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return ye(this,mi).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),i=ye(this,mi).get(r.queryHash),s=i==null?void 0:i.state.data,a=fTe(e,s);if(a!==void 0)return ye(this,mi).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return Us.batch(()=>ye(this,mi).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=ye(this,mi).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=ye(this,mi);Us.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=ye(this,mi);return Us.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Us.batch(()=>ye(this,mi).findAll(t).map(i=>i.cancel(n)));return Promise.all(r).then(so).catch(so)}invalidateQueries(t,e={}){return Us.batch(()=>(ye(this,mi).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Us.batch(()=>ye(this,mi).findAll(t).filter(i=>!i.isDisabled()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(so)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(so)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=ye(this,mi).build(this,e);return n.isStaleByTime(Zv(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(so).catch(so)}fetchInfiniteQuery(t){return t.behavior=wq(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(so).catch(so)}ensureInfiniteQueryData(t){return t.behavior=wq(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return NA.isOnline()?ye(this,of).resumePausedMutations():Promise.resolve()}getQueryCache(){return ye(this,mi)}getMutationCache(){return ye(this,of)}getDefaultOptions(){return ye(this,lf)}setDefaultOptions(t){Nt(this,lf,t)}setQueryDefaults(t,e){ye(this,Ex).set(V1(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...ye(this,Ex).values()],n={};return e.forEach(r=>{W1(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){ye(this,Cx).set(V1(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...ye(this,Cx).values()],n={};return e.forEach(r=>{W1(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...ye(this,lf).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=vU(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===xU&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...ye(this,lf).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){ye(this,mi).clear(),ye(this,of).clear()}},mi=new WeakMap,of=new WeakMap,lf=new WeakMap,Ex=new WeakMap,Cx=new WeakMap,cf=new WeakMap,Nx=new WeakMap,Ax=new WeakMap,Rte),ro,Bn,A_,ka,Wm,Ix,uf,df,I_,kx,Mx,Hm,Gm,hf,Rx,or,Bw,_F,TF,EF,CF,NF,AF,IF,mie,Pte,MTe=(Pte=class extends $_{constructor(e,n){super();rn(this,or);rn(this,ro);rn(this,Bn);rn(this,A_);rn(this,ka);rn(this,Wm);rn(this,Ix);rn(this,uf);rn(this,df);rn(this,I_);rn(this,kx);rn(this,Mx);rn(this,Hm);rn(this,Gm);rn(this,hf);rn(this,Rx,new Set);this.options=n,Nt(this,ro,e),Nt(this,df,null),Nt(this,uf,SF()),this.options.experimental_prefetchInRender||ye(this,uf).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ye(this,Bn).addObserver(this),_q(ye(this,Bn),this.options)?zn(this,or,Bw).call(this):this.updateResult(),zn(this,or,CF).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return kF(ye(this,Bn),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return kF(ye(this,Bn),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,zn(this,or,NF).call(this),zn(this,or,AF).call(this),ye(this,Bn).removeObserver(this)}setOptions(e){const n=this.options,r=ye(this,Bn);if(this.options=ye(this,ro).defaultQueryOptions(e),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof wc(this.options.enabled,ye(this,Bn))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");zn(this,or,IF).call(this),ye(this,Bn).setOptions(this.options),n._defaulted&&!xF(this.options,n)&&ye(this,ro).getQueryCache().notify({type:"observerOptionsUpdated",query:ye(this,Bn),observer:this});const i=this.hasListeners();i&&Tq(ye(this,Bn),r,this.options,n)&&zn(this,or,Bw).call(this),this.updateResult(),i&&(ye(this,Bn)!==r||wc(this.options.enabled,ye(this,Bn))!==wc(n.enabled,ye(this,Bn))||Zv(this.options.staleTime,ye(this,Bn))!==Zv(n.staleTime,ye(this,Bn)))&&zn(this,or,_F).call(this);const s=zn(this,or,TF).call(this);i&&(ye(this,Bn)!==r||wc(this.options.enabled,ye(this,Bn))!==wc(n.enabled,ye(this,Bn))||s!==ye(this,hf))&&zn(this,or,EF).call(this,s)}getOptimisticResult(e){const n=ye(this,ro).getQueryCache().build(ye(this,ro),e),r=this.createResult(n,e);return PTe(this,r)&&(Nt(this,ka,r),Nt(this,Ix,this.options),Nt(this,Wm,ye(this,Bn).state)),r}getCurrentResult(){return ye(this,ka)}trackResult(e,n){return new Proxy(e,{get:(r,i)=>(this.trackProp(i),n==null||n(i),Reflect.get(r,i))})}trackProp(e){ye(this,Rx).add(e)}getCurrentQuery(){return ye(this,Bn)}refetch({...e}={}){return this.fetch({...e})}fetchOptimistic(e){const n=ye(this,ro).defaultQueryOptions(e),r=ye(this,ro).getQueryCache().build(ye(this,ro),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(e){return zn(this,or,Bw).call(this,{...e,cancelRefetch:e.cancelRefetch??!0}).then(()=>(this.updateResult(),ye(this,ka)))}createResult(e,n){var A;const r=ye(this,Bn),i=this.options,s=ye(this,ka),a=ye(this,Wm),o=ye(this,Ix),c=e!==r?e.state:ye(this,A_),{state:u}=e;let d={...u},h=!1,f;if(n._optimisticResults){const k=this.hasListeners(),R=!k&&_q(e,n),$=k&&Tq(e,r,n,i);(R||$)&&(d={...d,...pie(u.data,e.options)}),n._optimisticResults==="isRestoring"&&(d.fetchStatus="idle")}let{error:p,errorUpdatedAt:g,status:m}=d;f=d.data;let y=!1;if(n.placeholderData!==void 0&&f===void 0&&m==="pending"){let k;s!=null&&s.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(k=s.data,y=!0):k=typeof n.placeholderData=="function"?n.placeholderData((A=ye(this,Mx))==null?void 0:A.state.data,ye(this,Mx)):n.placeholderData,k!==void 0&&(m="success",f=wF(s==null?void 0:s.data,k,n),h=!0)}if(n.select&&f!==void 0&&!y)if(s&&f===(a==null?void 0:a.data)&&n.select===ye(this,I_))f=ye(this,kx);else try{Nt(this,I_,n.select),f=n.select(f),f=wF(s==null?void 0:s.data,f,n),Nt(this,kx,f),Nt(this,df,null)}catch(k){Nt(this,df,k)}ye(this,df)&&(p=ye(this,df),f=ye(this,kx),g=Date.now(),m="error");const x=d.fetchStatus==="fetching",b=m==="pending",_=m==="error",T=b&&x,E=f!==void 0,I={status:m,fetchStatus:d.fetchStatus,isPending:b,isSuccess:m==="success",isError:_,isInitialLoading:T,isLoading:T,data:f,dataUpdatedAt:d.dataUpdatedAt,error:p,errorUpdatedAt:g,failureCount:d.fetchFailureCount,failureReason:d.fetchFailureReason,errorUpdateCount:d.errorUpdateCount,isFetched:d.dataUpdateCount>0||d.errorUpdateCount>0,isFetchedAfterMount:d.dataUpdateCount>c.dataUpdateCount||d.errorUpdateCount>c.errorUpdateCount,isFetching:x,isRefetching:x&&!b,isLoadingError:_&&!E,isPaused:d.fetchStatus==="paused",isPlaceholderData:h,isRefetchError:_&&E,isStale:wU(e,n),refetch:this.refetch,promise:ye(this,uf)};if(this.options.experimental_prefetchInRender){const k=z=>{I.status==="error"?z.reject(I.error):I.data!==void 0&&z.resolve(I.data)},R=()=>{const z=Nt(this,uf,I.promise=SF());k(z)},$=ye(this,uf);switch($.status){case"pending":e.queryHash===r.queryHash&&k($);break;case"fulfilled":(I.status==="error"||I.data!==$.value)&&R();break;case"rejected":(I.status!=="error"||I.error!==$.reason)&&R();break}}return I}updateResult(){const e=ye(this,ka),n=this.createResult(ye(this,Bn),this.options);if(Nt(this,Wm,ye(this,Bn).state),Nt(this,Ix,this.options),ye(this,Wm).data!==void 0&&Nt(this,Mx,ye(this,Bn)),xF(n,e))return;Nt(this,ka,n);const r=()=>{if(!e)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!ye(this,Rx).size)return!0;const a=new Set(s??ye(this,Rx));return this.options.throwOnError&&a.add("error"),Object.keys(ye(this,ka)).some(o=>{const l=o;return ye(this,ka)[l]!==e[l]&&a.has(l)})};zn(this,or,mie).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&zn(this,or,CF).call(this)}},ro=new WeakMap,Bn=new WeakMap,A_=new WeakMap,ka=new WeakMap,Wm=new WeakMap,Ix=new WeakMap,uf=new WeakMap,df=new WeakMap,I_=new WeakMap,kx=new WeakMap,Mx=new WeakMap,Hm=new WeakMap,Gm=new WeakMap,hf=new WeakMap,Rx=new WeakMap,or=new WeakSet,Bw=function(e){zn(this,or,IF).call(this);let n=ye(this,Bn).fetch(this.options,e);return e!=null&&e.throwOnError||(n=n.catch(so)),n},_F=function(){zn(this,or,NF).call(this);const e=Zv(this.options.staleTime,ye(this,Bn));if(dg||ye(this,ka).isStale||!vF(e))return;const r=oie(ye(this,ka).dataUpdatedAt,e)+1;Nt(this,Hm,setTimeout(()=>{ye(this,ka).isStale||this.updateResult()},r))},TF=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ye(this,Bn)):this.options.refetchInterval)??!1},EF=function(e){zn(this,or,AF).call(this),Nt(this,hf,e),!(dg||wc(this.options.enabled,ye(this,Bn))===!1||!vF(ye(this,hf))||ye(this,hf)===0)&&Nt(this,Gm,setInterval(()=>{(this.options.refetchIntervalInBackground||bU.isFocused())&&zn(this,or,Bw).call(this)},ye(this,hf)))},CF=function(){zn(this,or,_F).call(this),zn(this,or,EF).call(this,zn(this,or,TF).call(this))},NF=function(){ye(this,Hm)&&(clearTimeout(ye(this,Hm)),Nt(this,Hm,void 0))},AF=function(){ye(this,Gm)&&(clearInterval(ye(this,Gm)),Nt(this,Gm,void 0))},IF=function(){const e=ye(this,ro).getQueryCache().build(ye(this,ro),this.options);if(e===ye(this,Bn))return;const n=ye(this,Bn);Nt(this,Bn,e),Nt(this,A_,e.state),this.hasListeners()&&(n==null||n.removeObserver(this),e.addObserver(this))},mie=function(e){Us.batch(()=>{e.listeners&&this.listeners.forEach(n=>{n(ye(this,ka))}),ye(this,ro).getQueryCache().notify({query:ye(this,Bn),type:"observerResultsUpdated"})})},Pte);function RTe(t,e){return wc(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function _q(t,e){return RTe(t,e)||t.state.data!==void 0&&kF(t,e,e.refetchOnMount)}function kF(t,e,n){if(wc(e.enabled,t)!==!1){const r=typeof n=="function"?n(t):n;return r==="always"||r!==!1&&wU(t,e)}return!1}function Tq(t,e,n,r){return(t!==e||wc(r.enabled,t)===!1)&&(!n.suspense||t.state.status!=="error")&&wU(t,n)}function wU(t,e){return wc(e.enabled,t)!==!1&&t.isStaleByTime(Zv(e.staleTime,t))}function PTe(t,e){return!xF(t.getCurrentResult(),e)}var gie=P.createContext(void 0),OTe=t=>{const e=P.useContext(gie);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},DTe=({client:t,children:e})=>(P.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),v.jsx(gie.Provider,{value:t,children:e})),yie=P.createContext(!1),$Te=()=>P.useContext(yie);yie.Provider;function LTe(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var FTe=P.createContext(LTe()),jTe=()=>P.useContext(FTe),zTe=(t,e)=>{(t.suspense||t.throwOnError||t.experimental_prefetchInRender)&&(e.isReset()||(t.retryOnMount=!1))},BTe=t=>{P.useEffect(()=>{t.clearReset()},[t])},UTe=({result:t,errorResetBoundary:e,throwOnError:n,query:r,suspense:i})=>t.isError&&!e.isReset()&&!t.isFetching&&r&&(i&&t.data===void 0||yTe(n,[t.error,r])),VTe=t=>{const e=t.staleTime;t.suspense&&(t.staleTime=typeof e=="function"?(...n)=>Math.max(e(...n),1e3):Math.max(e??1e3,1e3),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3)))},WTe=(t,e)=>t.isLoading&&t.isFetching&&!e,HTe=(t,e)=>(t==null?void 0:t.suspense)&&e.isPending,Eq=(t,e,n)=>e.fetchOptimistic(t).catch(()=>{n.clearReset()});function GTe(t,e,n){var d,h,f,p,g;const r=OTe(),i=$Te(),s=jTe(),a=r.defaultQueryOptions(t);(h=(d=r.getDefaultOptions().queries)==null?void 0:d._experimental_beforeQuery)==null||h.call(d,a),a._optimisticResults=i?"isRestoring":"optimistic",VTe(a),zTe(a,s),BTe(s);const o=!r.getQueryCache().get(a.queryHash),[l]=P.useState(()=>new e(r,a)),c=l.getOptimisticResult(a),u=!i&&t.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(m=>{const y=u?l.subscribe(Us.batchCalls(m)):so;return l.updateResult(),y},[l,u]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),P.useEffect(()=>{l.setOptions(a)},[a,l]),HTe(a,c))throw Eq(a,l,s);if(UTe({result:c,errorResetBoundary:s,throwOnError:a.throwOnError,query:r.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw c.error;if((p=(f=r.getDefaultOptions().queries)==null?void 0:f._experimental_afterQuery)==null||p.call(f,a,c),a.experimental_prefetchInRender&&!dg&&WTe(c,i)){const m=o?Eq(a,l,s):(g=r.getQueryCache().get(a.queryHash))==null?void 0:g.promise;m==null||m.catch(so).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?c:l.trackResult(c)}function Kr(t,e){return GTe(t,MTe)}async function qTe(t){if(!t.ok){const e=await t.text()||t.statusText;throw new Error(`${t.status}: ${e}`)}}const XTe=({on401:t})=>async({queryKey:e})=>{const n=await fetch(e[0],{credentials:"include"});return await qTe(n),await n.json()},KTe=new kTe({defaultOptions:{queries:{queryFn:XTe({on401:"throw"}),refetchInterval:!1,refetchOnWindowFocus:!1,staleTime:1/0,retry:!1},mutations:{retry:!1}}}),YTe=1,ZTe=1e6;let f$=0;function QTe(){return f$=(f$+1)%Number.MAX_SAFE_INTEGER,f$.toString()}const p$=new Map,Cq=t=>{if(p$.has(t))return;const e=setTimeout(()=>{p$.delete(t),u1({type:"REMOVE_TOAST",toastId:t})},ZTe);p$.set(t,e)},JTe=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,YTe)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(n=>n.id===e.toast.id?{...n,...e.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=e;return n?Cq(n):t.toasts.forEach(r=>{Cq(r.id)}),{...t,toasts:t.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(n=>n.id!==e.toastId)}}},O2=[];let D2={toasts:[]};function u1(t){D2=JTe(D2,t),O2.forEach(e=>{e(D2)})}function eEe({...t}){const e=QTe(),n=i=>u1({type:"UPDATE_TOAST",toast:{...i,id:e}}),r=()=>u1({type:"DISMISS_TOAST",toastId:e});return u1({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:i=>{i||r()}}}),{id:e,dismiss:r,update:n}}function tEe(){const[t,e]=P.useState(D2);return P.useEffect(()=>(O2.push(e),()=>{const n=O2.indexOf(e);n>-1&&O2.splice(n,1)}),[t]),{...t,toast:eEe,dismiss:n=>u1({type:"DISMISS_TOAST",toastId:n})}}function kt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(i){if(t==null||t(i),n===!1||!i.defaultPrevented)return e==null?void 0:e(i)}}function Nq(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function nEe(...t){return e=>{let n=!1;const r=t.map(i=>{const s=Nq(i,e);return!n&&typeof s=="function"&&(n=!0),s});if(n)return()=>{for(let i=0;i<r.length;i++){const s=r[i];typeof s=="function"?s():Nq(t[i],null)}}}}function Vn(...t){return P.useCallback(nEe(...t),t)}function rEe(t,e){const n=P.createContext(e),r=s=>{const{children:a,...o}=s,l=P.useMemo(()=>o,Object.values(o));return v.jsx(n.Provider,{value:l,children:a})};r.displayName=t+"Provider";function i(s){const a=P.useContext(n);if(a)return a;if(e!==void 0)return e;throw new Error(`\`${s}\` must be used within \`${t}\``)}return[r,i]}function Yl(t,e=[]){let n=[];function r(s,a){const o=P.createContext(a),l=n.length;n=[...n,a];const c=d=>{var y;const{scope:h,children:f,...p}=d,g=((y=h==null?void 0:h[t])==null?void 0:y[l])||o,m=P.useMemo(()=>p,Object.values(p));return v.jsx(g.Provider,{value:m,children:f})};c.displayName=s+"Provider";function u(d,h){var g;const f=((g=h==null?void 0:h[t])==null?void 0:g[l])||o,p=P.useContext(f);if(p)return p;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${s}\``)}return[c,u]}const i=()=>{const s=n.map(a=>P.createContext(a));return function(o){const l=(o==null?void 0:o[t])||s;return P.useMemo(()=>({[`__scope${t}`]:{...o,[t]:l}}),[o,l])}};return i.scopeName=t,[r,iEe(i,...e)]}function iEe(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(s)[`__scope${c}`];return{...o,...d}},{});return P.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function hg(t){const e=sEe(t),n=P.forwardRef((r,i)=>{const{children:s,...a}=r,o=P.Children.toArray(s),l=o.find(oEe);if(l){const c=l.props.children,u=o.map(d=>d===l?P.Children.count(c)>1?P.Children.only(null):P.isValidElement(c)?c.props.children:null:d);return v.jsx(e,{...a,ref:i,children:P.isValidElement(c)?P.cloneElement(c,void 0,u):null})}return v.jsx(e,{...a,ref:i,children:s})});return n.displayName=`${t}.Slot`,n}var vie=hg("Slot");function sEe(t){const e=P.forwardRef((n,r)=>{const{children:i,...s}=n,a=P.isValidElement(i)?cEe(i):void 0,o=Vn(a,r);if(P.isValidElement(i)){const l=lEe(s,i.props);return i.type!==P.Fragment&&(l.ref=o),P.cloneElement(i,l)}return P.Children.count(i)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var xie=Symbol("radix.slottable");function aEe(t){const e=({children:n})=>v.jsx(v.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=xie,e}function oEe(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===xie}function lEe(t,e){const n={...e};for(const r in e){const i=t[r],s=e[r];/^on[A-Z]/.test(r)?i&&s?n[r]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(n[r]=i):r==="style"?n[r]={...i,...s}:r==="className"&&(n[r]=[i,s].filter(Boolean).join(" "))}return{...t,...n}}function cEe(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function Yk(t){const e=t+"CollectionProvider",[n,r]=Yl(e),[i,s]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=g=>{const{scope:m,children:y}=g,x=le.useRef(null),b=le.useRef(new Map).current;return v.jsx(i,{scope:m,itemMap:b,collectionRef:x,children:y})};a.displayName=e;const o=t+"CollectionSlot",l=hg(o),c=le.forwardRef((g,m)=>{const{scope:y,children:x}=g,b=s(o,y),_=Vn(m,b.collectionRef);return v.jsx(l,{ref:_,children:x})});c.displayName=o;const u=t+"CollectionItemSlot",d="data-radix-collection-item",h=hg(u),f=le.forwardRef((g,m)=>{const{scope:y,children:x,...b}=g,_=le.useRef(null),T=Vn(m,_),E=s(u,y);return le.useEffect(()=>(E.itemMap.set(_,{ref:_,...b}),()=>void E.itemMap.delete(_))),v.jsx(h,{[d]:"",ref:T,children:x})});f.displayName=u;function p(g){const m=s(t+"CollectionConsumer",g);return le.useCallback(()=>{const x=m.collectionRef.current;if(!x)return[];const b=Array.from(x.querySelectorAll(`[${d}]`));return Array.from(m.itemMap.values()).sort((E,C)=>b.indexOf(E.ref.current)-b.indexOf(C.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:a,Slot:c,ItemSlot:f},p,r]}var uEe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wt=uEe.reduce((t,e)=>{const n=hg(`Primitive.${e}`),r=P.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),v.jsx(l,{...o,ref:s})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function bie(t,e){t&&Gg.flushSync(()=>t.dispatchEvent(e))}function Jo(t){const e=P.useRef(t);return P.useEffect(()=>{e.current=t}),P.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function dEe(t,e=globalThis==null?void 0:globalThis.document){const n=Jo(t);P.useEffect(()=>{const r=i=>{i.key==="Escape"&&n(i)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var hEe="DismissableLayer",MF="dismissableLayer.update",fEe="dismissableLayer.pointerDownOutside",pEe="dismissableLayer.focusOutside",Aq,wie=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),j0=P.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=t,c=P.useContext(wie),[u,d]=P.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=P.useState({}),p=Vn(e,C=>d(C)),g=Array.from(c.layers),[m]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=g.indexOf(m),x=u?g.indexOf(u):-1,b=c.layersWithOutsidePointerEventsDisabled.size>0,_=x>=y,T=gEe(C=>{const I=C.target,A=[...c.branches].some(k=>k.contains(I));!_||A||(i==null||i(C),a==null||a(C),C.defaultPrevented||o==null||o())},h),E=yEe(C=>{const I=C.target;[...c.branches].some(k=>k.contains(I))||(s==null||s(C),a==null||a(C),C.defaultPrevented||o==null||o())},h);return dEe(C=>{x===c.layers.size-1&&(r==null||r(C),!C.defaultPrevented&&o&&(C.preventDefault(),o()))},h),P.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(Aq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),Iq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=Aq)}},[u,h,n,c]),P.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),Iq())},[u,c]),P.useEffect(()=>{const C=()=>f({});return document.addEventListener(MF,C),()=>document.removeEventListener(MF,C)},[]),v.jsx(Wt.div,{...l,ref:p,style:{pointerEvents:b?_?"auto":"none":void 0,...t.style},onFocusCapture:kt(t.onFocusCapture,E.onFocusCapture),onBlurCapture:kt(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:kt(t.onPointerDownCapture,T.onPointerDownCapture)})});j0.displayName=hEe;var mEe="DismissableLayerBranch",Sie=P.forwardRef((t,e)=>{const n=P.useContext(wie),r=P.useRef(null),i=Vn(e,r);return P.useEffect(()=>{const s=r.current;if(s)return n.branches.add(s),()=>{n.branches.delete(s)}},[n.branches]),v.jsx(Wt.div,{...t,ref:i})});Sie.displayName=mEe;function gEe(t,e=globalThis==null?void 0:globalThis.document){const n=Jo(t),r=P.useRef(!1),i=P.useRef(()=>{});return P.useEffect(()=>{const s=o=>{if(o.target&&!r.current){let l=function(){_ie(fEe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function yEe(t,e=globalThis==null?void 0:globalThis.document){const n=Jo(t),r=P.useRef(!1);return P.useEffect(()=>{const i=s=>{s.target&&!r.current&&_ie(pEe,n,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Iq(){const t=new CustomEvent(MF);document.dispatchEvent(t)}function _ie(t,e,n,{discrete:r}){const i=n.originalEvent.target,s=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?bie(i,s):i.dispatchEvent(s)}var vEe=j0,xEe=Sie,Ki=globalThis!=null&&globalThis.document?P.useLayoutEffect:()=>{},bEe="Portal",L_=P.forwardRef((t,e)=>{var o;const{container:n,...r}=t,[i,s]=P.useState(!1);Ki(()=>s(!0),[]);const a=n||i&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?L_e.createPortal(v.jsx(Wt.div,{...r,ref:e}),a):null});L_.displayName=bEe;function wEe(t,e){return P.useReducer((n,r)=>e[n][r]??n,t)}var mh=t=>{const{present:e,children:n}=t,r=SEe(e),i=typeof n=="function"?n({present:r.isPresent}):P.Children.only(n),s=Vn(r.ref,_Ee(i));return typeof n=="function"||r.isPresent?P.cloneElement(i,{ref:s}):null};mh.displayName="Presence";function SEe(t){const[e,n]=P.useState(),r=P.useRef(null),i=P.useRef(t),s=P.useRef("none"),a=t?"mounted":"unmounted",[o,l]=wEe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const c=HC(r.current);s.current=o==="mounted"?c:"none"},[o]),Ki(()=>{const c=r.current,u=i.current;if(u!==t){const h=s.current,f=HC(c);t?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==f?"ANIMATION_OUT":"UNMOUNT"),i.current=t}},[t,l]),Ki(()=>{if(e){let c;const u=e.ownerDocument.defaultView??window,d=f=>{const g=HC(r.current).includes(f.animationName);if(f.target===e&&g&&(l("ANIMATION_END"),!i.current)){const m=e.style.animationFillMode;e.style.animationFillMode="forwards",c=u.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=m)})}},h=f=>{f.target===e&&(s.current=HC(r.current))};return e.addEventListener("animationstart",h),e.addEventListener("animationcancel",d),e.addEventListener("animationend",d),()=>{u.clearTimeout(c),e.removeEventListener("animationstart",h),e.removeEventListener("animationcancel",d),e.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:P.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function HC(t){return(t==null?void 0:t.animationName)||"none"}function _Ee(t){var r,i;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(i=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:i.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var TEe=TB[" useInsertionEffect ".trim().toString()]||Ki;function zf({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[i,s,a]=EEe({defaultProp:e,onChange:n}),o=t!==void 0,l=o?t:i;{const u=P.useRef(t!==void 0);P.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=P.useCallback(u=>{var d;if(o){const h=CEe(u)?u(t):u;h!==t&&((d=a.current)==null||d.call(a,h))}else s(u)},[o,t,s,a]);return[l,c]}function EEe({defaultProp:t,onChange:e}){const[n,r]=P.useState(t),i=P.useRef(n),s=P.useRef(e);return TEe(()=>{s.current=e},[e]),P.useEffect(()=>{var a;i.current!==n&&((a=s.current)==null||a.call(s,n),i.current=n)},[n,i]),[n,r,s]}function CEe(t){return typeof t=="function"}var Tie=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),NEe="VisuallyHidden",Zk=P.forwardRef((t,e)=>v.jsx(Wt.span,{...t,ref:e,style:{...Tie,...t.style}}));Zk.displayName=NEe;var AEe=Zk,SU="ToastProvider",[_U,IEe,kEe]=Yk("Toast"),[Eie,U3t]=Yl("Toast",[kEe]),[MEe,Qk]=Eie(SU),Cie=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:i="right",swipeThreshold:s=50,children:a}=t,[o,l]=P.useState(null),[c,u]=P.useState(0),d=P.useRef(!1),h=P.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${SU}\`. Expected non-empty \`string\`.`),v.jsx(_U.Provider,{scope:e,children:v.jsx(MEe,{scope:e,label:n,duration:r,swipeDirection:i,swipeThreshold:s,toastCount:c,viewport:o,onViewportChange:l,onToastAdd:P.useCallback(()=>u(f=>f+1),[]),onToastRemove:P.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:d,isClosePausedRef:h,children:a})})};Cie.displayName=SU;var Nie="ToastViewport",REe=["F8"],RF="toast.viewportPause",PF="toast.viewportResume",Aie=P.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=REe,label:i="Notifications ({hotkey})",...s}=t,a=Qk(Nie,n),o=IEe(n),l=P.useRef(null),c=P.useRef(null),u=P.useRef(null),d=P.useRef(null),h=Vn(e,d,a.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),p=a.toastCount>0;P.useEffect(()=>{const m=y=>{var b;r.length!==0&&r.every(_=>y[_]||y.code===_)&&((b=d.current)==null||b.focus())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[r]),P.useEffect(()=>{const m=l.current,y=d.current;if(p&&m&&y){const x=()=>{if(!a.isClosePausedRef.current){const E=new CustomEvent(RF);y.dispatchEvent(E),a.isClosePausedRef.current=!0}},b=()=>{if(a.isClosePausedRef.current){const E=new CustomEvent(PF);y.dispatchEvent(E),a.isClosePausedRef.current=!1}},_=E=>{!m.contains(E.relatedTarget)&&b()},T=()=>{m.contains(document.activeElement)||b()};return m.addEventListener("focusin",x),m.addEventListener("focusout",_),m.addEventListener("pointermove",x),m.addEventListener("pointerleave",T),window.addEventListener("blur",x),window.addEventListener("focus",b),()=>{m.removeEventListener("focusin",x),m.removeEventListener("focusout",_),m.removeEventListener("pointermove",x),m.removeEventListener("pointerleave",T),window.removeEventListener("blur",x),window.removeEventListener("focus",b)}}},[p,a.isClosePausedRef]);const g=P.useCallback(({tabbingDirection:m})=>{const x=o().map(b=>{const _=b.ref.current,T=[_,...HEe(_)];return m==="forwards"?T:T.reverse()});return(m==="forwards"?x.reverse():x).flat()},[o]);return P.useEffect(()=>{const m=d.current;if(m){const y=x=>{var T,E,C;const b=x.altKey||x.ctrlKey||x.metaKey;if(x.key==="Tab"&&!b){const I=document.activeElement,A=x.shiftKey;if(x.target===m&&A){(T=c.current)==null||T.focus();return}const $=g({tabbingDirection:A?"backwards":"forwards"}),z=$.findIndex(O=>O===I);m$($.slice(z+1))?x.preventDefault():A?(E=c.current)==null||E.focus():(C=u.current)==null||C.focus()}};return m.addEventListener("keydown",y),()=>m.removeEventListener("keydown",y)}},[o,g]),v.jsxs(xEe,{ref:l,role:"region","aria-label":i.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:p?void 0:"none"},children:[p&&v.jsx(OF,{ref:c,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"forwards"});m$(m)}}),v.jsx(_U.Slot,{scope:n,children:v.jsx(Wt.ol,{tabIndex:-1,...s,ref:h})}),p&&v.jsx(OF,{ref:u,onFocusFromOutsideViewport:()=>{const m=g({tabbingDirection:"backwards"});m$(m)}})]})});Aie.displayName=Nie;var Iie="ToastFocusProxy",OF=P.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...i}=t,s=Qk(Iie,n);return v.jsx(Zk,{"aria-hidden":!0,tabIndex:0,...i,ref:e,style:{position:"fixed"},onFocus:a=>{var c;const o=a.relatedTarget;!((c=s.viewport)!=null&&c.contains(o))&&r()}})});OF.displayName=Iie;var F_="Toast",PEe="toast.swipeStart",OEe="toast.swipeMove",DEe="toast.swipeCancel",$Ee="toast.swipeEnd",kie=P.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:i,onOpenChange:s,...a}=t,[o,l]=zf({prop:r,defaultProp:i??!0,onChange:s,caller:F_});return v.jsx(mh,{present:n||o,children:v.jsx(jEe,{open:o,...a,ref:e,onClose:()=>l(!1),onPause:Jo(t.onPause),onResume:Jo(t.onResume),onSwipeStart:kt(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:kt(t.onSwipeMove,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${d}px`)}),onSwipeCancel:kt(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:kt(t.onSwipeEnd,c=>{const{x:u,y:d}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${d}px`),l(!1)})})})});kie.displayName=F_;var[LEe,FEe]=Eie(F_,{onClose(){}}),jEe=P.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:i,open:s,onClose:a,onEscapeKeyDown:o,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:d,onSwipeCancel:h,onSwipeEnd:f,...p}=t,g=Qk(F_,n),[m,y]=P.useState(null),x=Vn(e,O=>y(O)),b=P.useRef(null),_=P.useRef(null),T=i||g.duration,E=P.useRef(0),C=P.useRef(T),I=P.useRef(0),{onToastAdd:A,onToastRemove:k}=g,R=Jo(()=>{var j;(m==null?void 0:m.contains(document.activeElement))&&((j=g.viewport)==null||j.focus()),a()}),$=P.useCallback(O=>{!O||O===1/0||(window.clearTimeout(I.current),E.current=new Date().getTime(),I.current=window.setTimeout(R,O))},[R]);P.useEffect(()=>{const O=g.viewport;if(O){const j=()=>{$(C.current),c==null||c()},B=()=>{const W=new Date().getTime()-E.current;C.current=C.current-W,window.clearTimeout(I.current),l==null||l()};return O.addEventListener(RF,B),O.addEventListener(PF,j),()=>{O.removeEventListener(RF,B),O.removeEventListener(PF,j)}}},[g.viewport,T,l,c,$]),P.useEffect(()=>{s&&!g.isClosePausedRef.current&&$(T)},[s,T,g.isClosePausedRef,$]),P.useEffect(()=>(A(),()=>k()),[A,k]);const z=P.useMemo(()=>m?Lie(m):null,[m]);return g.viewport?v.jsxs(v.Fragment,{children:[z&&v.jsx(zEe,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:z}),v.jsx(LEe,{scope:n,onClose:R,children:Gg.createPortal(v.jsx(_U.ItemSlot,{scope:n,children:v.jsx(vEe,{asChild:!0,onEscapeKeyDown:kt(o,()=>{g.isFocusedToastEscapeKeyDownRef.current||R(),g.isFocusedToastEscapeKeyDownRef.current=!1}),children:v.jsx(Wt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":s?"open":"closed","data-swipe-direction":g.swipeDirection,...p,ref:x,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:kt(t.onKeyDown,O=>{O.key==="Escape"&&(o==null||o(O.nativeEvent),O.nativeEvent.defaultPrevented||(g.isFocusedToastEscapeKeyDownRef.current=!0,R()))}),onPointerDown:kt(t.onPointerDown,O=>{O.button===0&&(b.current={x:O.clientX,y:O.clientY})}),onPointerMove:kt(t.onPointerMove,O=>{if(!b.current)return;const j=O.clientX-b.current.x,B=O.clientY-b.current.y,W=!!_.current,L=["left","right"].includes(g.swipeDirection),V=["left","up"].includes(g.swipeDirection)?Math.min:Math.max,H=L?V(0,j):0,K=L?0:V(0,B),te=O.pointerType==="touch"?10:2,J={x:H,y:K},oe={originalEvent:O,delta:J};W?(_.current=J,GC(OEe,d,oe,{discrete:!1})):kq(J,g.swipeDirection,te)?(_.current=J,GC(PEe,u,oe,{discrete:!1}),O.target.setPointerCapture(O.pointerId)):(Math.abs(j)>te||Math.abs(B)>te)&&(b.current=null)}),onPointerUp:kt(t.onPointerUp,O=>{const j=_.current,B=O.target;if(B.hasPointerCapture(O.pointerId)&&B.releasePointerCapture(O.pointerId),_.current=null,b.current=null,j){const W=O.currentTarget,L={originalEvent:O,delta:j};kq(j,g.swipeDirection,g.swipeThreshold)?GC($Ee,f,L,{discrete:!0}):GC(DEe,h,L,{discrete:!0}),W.addEventListener("click",V=>V.preventDefault(),{once:!0})}})})})}),g.viewport)})]}):null}),zEe=t=>{const{__scopeToast:e,children:n,...r}=t,i=Qk(F_,e),[s,a]=P.useState(!1),[o,l]=P.useState(!1);return VEe(()=>a(!0)),P.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),o?null:v.jsx(L_,{asChild:!0,children:v.jsx(Zk,{...r,children:s&&v.jsxs(v.Fragment,{children:[i.label," ",n]})})})},BEe="ToastTitle",Mie=P.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return v.jsx(Wt.div,{...r,ref:e})});Mie.displayName=BEe;var UEe="ToastDescription",Rie=P.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return v.jsx(Wt.div,{...r,ref:e})});Rie.displayName=UEe;var Pie="ToastAction",Oie=P.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?v.jsx($ie,{altText:n,asChild:!0,children:v.jsx(TU,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${Pie}\`. Expected non-empty \`string\`.`),null)});Oie.displayName=Pie;var Die="ToastClose",TU=P.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,i=FEe(Die,n);return v.jsx($ie,{asChild:!0,children:v.jsx(Wt.button,{type:"button",...r,ref:e,onClick:kt(t.onClick,i.onClose)})})});TU.displayName=Die;var $ie=P.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...i}=t;return v.jsx(Wt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...i,ref:e})});function Lie(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),WEe(r)){const i=r.ariaHidden||r.hidden||r.style.display==="none",s=r.dataset.radixToastAnnounceExclude==="";if(!i)if(s){const a=r.dataset.radixToastAnnounceAlt;a&&e.push(a)}else e.push(...Lie(r))}}),e}function GC(t,e,n,{discrete:r}){const i=n.originalEvent.currentTarget,s=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&i.addEventListener(t,e,{once:!0}),r?bie(i,s):i.dispatchEvent(s)}var kq=(t,e,n=0)=>{const r=Math.abs(t.x),i=Math.abs(t.y),s=r>i;return e==="left"||e==="right"?s&&r>n:!s&&i>n};function VEe(t=()=>{}){const e=Jo(t);Ki(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function WEe(t){return t.nodeType===t.ELEMENT_NODE}function HEe(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function m$(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var GEe=Cie,Fie=Aie,jie=kie,zie=Mie,Bie=Rie,Uie=Oie,Vie=TU;function Wie(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var i=t.length;for(e=0;e<i;e++)t[e]&&(n=Wie(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function qn(){for(var t,e,n=0,r="",i=arguments.length;n<i;n++)(t=arguments[n])&&(e=Wie(t))&&(r&&(r+=" "),r+=e);return r}const Mq=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Rq=qn,Jk=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return Rq(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:i,defaultVariants:s}=e,a=Object.keys(i).map(c=>{const u=n==null?void 0:n[c],d=s==null?void 0:s[c];if(u===null)return null;const h=Mq(u)||Mq(d);return i[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...f}=u;return Object.entries(f).every(p=>{let[g,m]=p;return Array.isArray(m)?m.includes({...s,...o}[g]):{...s,...o}[g]===m})?[...c,d,h]:c},[]);return Rq(t,a,l,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qEe=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Hie=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var XEe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KEe=P.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>P.createElement("svg",{ref:l,...XEe,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:Hie("lucide",i),...o},[...a.map(([c,u])=>P.createElement(c,u)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=(t,e)=>{const n=P.forwardRef(({className:r,...i},s)=>P.createElement(KEe,{ref:s,iconNode:e,className:Hie(`lucide-${qEe(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AA=jn("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tm=jn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YEe=jn("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZEe=jn("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g$=jn("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const My=jn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gie=jn("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QEe=jn("ChartNoAxesColumnIncreasing",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qie=jn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xie=jn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kie=jn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JEe=jn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z0=jn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=jn("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IA=jn("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EU=jn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yie=jn("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pq=jn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eCe=jn("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tCe=jn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oq=jn("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nCe=jn("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rCe=jn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zie=jn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qie=jn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iCe=jn("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sCe=jn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aCe=jn("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oCe=jn("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y$=jn("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qC=jn("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lCe=jn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cCe=jn("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dq=jn("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jie=jn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uCe=jn("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),CU="-",dCe=t=>{const e=fCe(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const o=a.split(CU);return o[0]===""&&o.length!==1&&o.shift(),ese(o,e)||hCe(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},ese=(t,e)=>{var a;if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),i=r?ese(t.slice(1),r):void 0;if(i)return i;if(e.validators.length===0)return;const s=t.join(CU);return(a=e.validators.find(({validator:o})=>o(s)))==null?void 0:a.classGroupId},$q=/^\[(.+)\]$/,hCe=t=>{if($q.test(t)){const e=$q.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},fCe=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return mCe(Object.entries(t.classGroups),n).forEach(([s,a])=>{DF(a,r,s,e)}),r},DF=(t,e,n,r)=>{t.forEach(i=>{if(typeof i=="string"){const s=i===""?e:Lq(e,i);s.classGroupId=n;return}if(typeof i=="function"){if(pCe(i)){DF(i(r),e,n,r);return}e.validators.push({validator:i,classGroupId:n});return}Object.entries(i).forEach(([s,a])=>{DF(a,Lq(e,s),n,r)})})},Lq=(t,e)=>{let n=t;return e.split(CU).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},pCe=t=>t.isThemeGetter,mCe=(t,e)=>e?t.map(([n,r])=>{const i=r.map(s=>typeof s=="string"?e+s:typeof s=="object"?Object.fromEntries(Object.entries(s).map(([a,o])=>[e+a,o])):s);return[n,i]}):t,gCe=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const i=(s,a)=>{n.set(s,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(s){let a=n.get(s);if(a!==void 0)return a;if((a=r.get(s))!==void 0)return i(s,a),a},set(s,a){n.has(s)?n.set(s,a):i(s,a)}}},tse="!",yCe=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,i=e[0],s=e.length,a=o=>{const l=[];let c=0,u=0,d;for(let m=0;m<o.length;m++){let y=o[m];if(c===0){if(y===i&&(r||o.slice(m,m+s)===e)){l.push(o.slice(u,m)),u=m+s;continue}if(y==="/"){d=m;continue}}y==="["?c++:y==="]"&&c--}const h=l.length===0?o:o.substring(u),f=h.startsWith(tse),p=f?h.substring(1):h,g=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:f,baseClassName:p,maybePostfixModifierPosition:g}};return n?o=>n({className:o,parseClassName:a}):a},vCe=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},xCe=t=>({cache:gCe(t.cacheSize),parseClassName:yCe(t),...dCe(t)}),bCe=/\s+/,wCe=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:i}=e,s=[],a=t.trim().split(bCe);let o="";for(let l=a.length-1;l>=0;l-=1){const c=a[l],{modifiers:u,hasImportantModifier:d,baseClassName:h,maybePostfixModifierPosition:f}=n(c);let p=!!f,g=r(p?h.substring(0,f):h);if(!g){if(!p){o=c+(o.length>0?" "+o:o);continue}if(g=r(h),!g){o=c+(o.length>0?" "+o:o);continue}p=!1}const m=vCe(u).join(":"),y=d?m+tse:m,x=y+g;if(s.includes(x))continue;s.push(x);const b=i(g,p);for(let _=0;_<b.length;++_){const T=b[_];s.push(y+T)}o=c+(o.length>0?" "+o:o)}return o};function SCe(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=nse(e))&&(r&&(r+=" "),r+=n);return r}const nse=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=nse(t[r]))&&(n&&(n+=" "),n+=e);return n};function _Ce(t,...e){let n,r,i,s=a;function a(l){const c=e.reduce((u,d)=>d(u),t());return n=xCe(c),r=n.cache.get,i=n.cache.set,s=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=wCe(l,n);return i(l,u),u}return function(){return s(SCe.apply(null,arguments))}}const Lr=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},rse=/^\[(?:([a-z-]+):)?(.+)\]$/i,TCe=/^\d+\/\d+$/,ECe=new Set(["px","full","screen"]),CCe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,NCe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ACe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ICe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,kCe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,fd=t=>Qv(t)||ECe.has(t)||TCe.test(t),Dh=t=>B0(t,"length",FCe),Qv=t=>!!t&&!Number.isNaN(Number(t)),v$=t=>B0(t,"number",Qv),sw=t=>!!t&&Number.isInteger(Number(t)),MCe=t=>t.endsWith("%")&&Qv(t.slice(0,-1)),vn=t=>rse.test(t),$h=t=>CCe.test(t),RCe=new Set(["length","size","percentage"]),PCe=t=>B0(t,RCe,ise),OCe=t=>B0(t,"position",ise),DCe=new Set(["image","url"]),$Ce=t=>B0(t,DCe,zCe),LCe=t=>B0(t,"",jCe),aw=()=>!0,B0=(t,e,n)=>{const r=rse.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},FCe=t=>NCe.test(t)&&!ACe.test(t),ise=()=>!1,jCe=t=>ICe.test(t),zCe=t=>kCe.test(t),BCe=()=>{const t=Lr("colors"),e=Lr("spacing"),n=Lr("blur"),r=Lr("brightness"),i=Lr("borderColor"),s=Lr("borderRadius"),a=Lr("borderSpacing"),o=Lr("borderWidth"),l=Lr("contrast"),c=Lr("grayscale"),u=Lr("hueRotate"),d=Lr("invert"),h=Lr("gap"),f=Lr("gradientColorStops"),p=Lr("gradientColorStopPositions"),g=Lr("inset"),m=Lr("margin"),y=Lr("opacity"),x=Lr("padding"),b=Lr("saturate"),_=Lr("scale"),T=Lr("sepia"),E=Lr("skew"),C=Lr("space"),I=Lr("translate"),A=()=>["auto","contain","none"],k=()=>["auto","hidden","clip","visible","scroll"],R=()=>["auto",vn,e],$=()=>[vn,e],z=()=>["",fd,Dh],O=()=>["auto",Qv,vn],j=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],B=()=>["solid","dashed","dotted","double","none"],W=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],L=()=>["start","end","center","between","around","evenly","stretch"],V=()=>["","0",vn],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],K=()=>[Qv,vn];return{cacheSize:500,separator:":",theme:{colors:[aw],spacing:[fd,Dh],blur:["none","",$h,vn],brightness:K(),borderColor:[t],borderRadius:["none","","full",$h,vn],borderSpacing:$(),borderWidth:z(),contrast:K(),grayscale:V(),hueRotate:K(),invert:V(),gap:$(),gradientColorStops:[t],gradientColorStopPositions:[MCe,Dh],inset:R(),margin:R(),opacity:K(),padding:$(),saturate:K(),scale:K(),sepia:V(),skew:K(),space:$(),translate:$()},classGroups:{aspect:[{aspect:["auto","square","video",vn]}],container:["container"],columns:[{columns:[$h]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...j(),vn]}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[g]}],"inset-x":[{"inset-x":[g]}],"inset-y":[{"inset-y":[g]}],start:[{start:[g]}],end:[{end:[g]}],top:[{top:[g]}],right:[{right:[g]}],bottom:[{bottom:[g]}],left:[{left:[g]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sw,vn]}],basis:[{basis:R()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",vn]}],grow:[{grow:V()}],shrink:[{shrink:V()}],order:[{order:["first","last","none",sw,vn]}],"grid-cols":[{"grid-cols":[aw]}],"col-start-end":[{col:["auto",{span:["full",sw,vn]},vn]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[aw]}],"row-start-end":[{row:["auto",{span:[sw,vn]},vn]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",vn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",vn]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal",...L()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...L(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...L(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[x]}],px:[{px:[x]}],py:[{py:[x]}],ps:[{ps:[x]}],pe:[{pe:[x]}],pt:[{pt:[x]}],pr:[{pr:[x]}],pb:[{pb:[x]}],pl:[{pl:[x]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[C]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[C]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",vn,e]}],"min-w":[{"min-w":[vn,e,"min","max","fit"]}],"max-w":[{"max-w":[vn,e,"none","full","min","max","fit","prose",{screen:[$h]},$h]}],h:[{h:[vn,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[vn,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[vn,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[vn,e,"auto","min","max","fit"]}],"font-size":[{text:["base",$h,Dh]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",v$]}],"font-family":[{font:[aw]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",vn]}],"line-clamp":[{"line-clamp":["none",Qv,v$]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",fd,vn]}],"list-image":[{"list-image":["none",vn]}],"list-style-type":[{list:["none","disc","decimal",vn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...B(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",fd,Dh]}],"underline-offset":[{"underline-offset":["auto",fd,vn]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",vn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",vn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...j(),OCe]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",PCe]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},$Ce]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[f]}],"gradient-via":[{via:[f]}],"gradient-to":[{to:[f]}],rounded:[{rounded:[s]}],"rounded-s":[{"rounded-s":[s]}],"rounded-e":[{"rounded-e":[s]}],"rounded-t":[{"rounded-t":[s]}],"rounded-r":[{"rounded-r":[s]}],"rounded-b":[{"rounded-b":[s]}],"rounded-l":[{"rounded-l":[s]}],"rounded-ss":[{"rounded-ss":[s]}],"rounded-se":[{"rounded-se":[s]}],"rounded-ee":[{"rounded-ee":[s]}],"rounded-es":[{"rounded-es":[s]}],"rounded-tl":[{"rounded-tl":[s]}],"rounded-tr":[{"rounded-tr":[s]}],"rounded-br":[{"rounded-br":[s]}],"rounded-bl":[{"rounded-bl":[s]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[y]}],"border-style":[{border:[...B(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[y]}],"divide-style":[{divide:B()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...B()]}],"outline-offset":[{"outline-offset":[fd,vn]}],"outline-w":[{outline:[fd,Dh]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:z()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[y]}],"ring-offset-w":[{"ring-offset":[fd,Dh]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",$h,LCe]}],"shadow-color":[{shadow:[aw]}],opacity:[{opacity:[y]}],"mix-blend":[{"mix-blend":[...W(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":W()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",$h,vn]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[d]}],saturate:[{saturate:[b]}],sepia:[{sepia:[T]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[y]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[T]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",vn]}],duration:[{duration:K()}],ease:[{ease:["linear","in","out","in-out",vn]}],delay:[{delay:K()}],animate:[{animate:["none","spin","ping","pulse","bounce",vn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[sw,vn]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",vn]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",vn]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",vn]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[fd,Dh,v$]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},UCe=_Ce(BCe);function Pt(...t){return UCe(qn(t))}const VCe=GEe,sse=P.forwardRef(({className:t,...e},n)=>v.jsx(Fie,{ref:n,className:Pt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));sse.displayName=Fie.displayName;const WCe=Jk("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),ase=P.forwardRef(({className:t,variant:e,...n},r)=>v.jsx(jie,{ref:r,className:Pt(WCe({variant:e}),t),...n}));ase.displayName=jie.displayName;const HCe=P.forwardRef(({className:t,...e},n)=>v.jsx(Uie,{ref:n,className:Pt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));HCe.displayName=Uie.displayName;const ose=P.forwardRef(({className:t,...e},n)=>v.jsx(Vie,{ref:n,className:Pt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:v.jsx(Jie,{className:"h-4 w-4"})}));ose.displayName=Vie.displayName;const lse=P.forwardRef(({className:t,...e},n)=>v.jsx(zie,{ref:n,className:Pt("text-sm font-semibold",t),...e}));lse.displayName=zie.displayName;const cse=P.forwardRef(({className:t,...e},n)=>v.jsx(Bie,{ref:n,className:Pt("text-sm opacity-90",t),...e}));cse.displayName=Bie.displayName;function GCe(){const{toasts:t}=tEe();return v.jsxs(VCe,{children:[t.map(function({id:e,title:n,description:r,action:i,...s}){return v.jsxs(ase,{...s,children:[v.jsxs("div",{className:"grid gap-1",children:[n&&v.jsx(lse,{children:n}),r&&v.jsx(cse,{children:r})]}),i,v.jsx(ose,{})]},e)}),v.jsx(sse,{})]})}var qCe=TB[" useId ".trim().toString()]||(()=>{}),XCe=0;function Ud(t){const[e,n]=P.useState(qCe());return Ki(()=>{n(r=>r??String(XCe++))},[t]),e?`radix-${e}`:""}const KCe=["top","right","bottom","left"],Bf=Math.min,Bo=Math.max,kA=Math.round,XC=Math.floor,Pu=t=>({x:t,y:t}),YCe={left:"right",right:"left",bottom:"top",top:"bottom"},ZCe={start:"end",end:"start"};function $F(t,e,n){return Bo(t,Bf(e,n))}function eh(t,e){return typeof t=="function"?t(e):t}function th(t){return t.split("-")[0]}function U0(t){return t.split("-")[1]}function NU(t){return t==="x"?"y":"x"}function AU(t){return t==="y"?"height":"width"}function Vd(t){return["top","bottom"].includes(th(t))?"y":"x"}function IU(t){return NU(Vd(t))}function QCe(t,e,n){n===void 0&&(n=!1);const r=U0(t),i=IU(t),s=AU(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=MA(a)),[a,MA(a)]}function JCe(t){const e=MA(t);return[LF(t),e,LF(e)]}function LF(t){return t.replace(/start|end/g,e=>ZCe[e])}function eNe(t,e,n){const r=["left","right"],i=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?s:a;default:return[]}}function tNe(t,e,n,r){const i=U0(t);let s=eNe(th(t),n==="start",r);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(LF)))),s}function MA(t){return t.replace(/left|right|bottom|top/g,e=>YCe[e])}function nNe(t){return{top:0,right:0,bottom:0,left:0,...t}}function use(t){return typeof t!="number"?nNe(t):{top:t,right:t,bottom:t,left:t}}function RA(t){const{x:e,y:n,width:r,height:i}=t;return{width:r,height:i,top:n,left:e,right:e+r,bottom:n+i,x:e,y:n}}function Fq(t,e,n){let{reference:r,floating:i}=t;const s=Vd(e),a=IU(e),o=AU(a),l=th(e),c=s==="y",u=r.x+r.width/2-i.width/2,d=r.y+r.height/2-i.height/2,h=r[o]/2-i[o]/2;let f;switch(l){case"top":f={x:u,y:r.y-i.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:d};break;case"left":f={x:r.x-i.width,y:d};break;default:f={x:r.x,y:r.y}}switch(U0(e)){case"start":f[a]-=h*(n&&c?-1:1);break;case"end":f[a]+=h*(n&&c?-1:1);break}return f}const rNe=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:u,y:d}=Fq(c,r,l),h=r,f={},p=0;for(let g=0;g<o.length;g++){const{name:m,fn:y}=o[g],{x,y:b,data:_,reset:T}=await y({x:u,y:d,initialPlacement:r,placement:h,strategy:i,middlewareData:f,rects:c,platform:a,elements:{reference:t,floating:e}});u=x??u,d=b??d,f={...f,[m]:{...f[m],..._}},T&&p<=50&&(p++,typeof T=="object"&&(T.placement&&(h=T.placement),T.rects&&(c=T.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):T.rects),{x:u,y:d}=Fq(c,h,l)),g=-1)}return{x:u,y:d,placement:h,strategy:i,middlewareData:f}};async function H1(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:f=0}=eh(e,t),p=use(f),m=o[h?d==="floating"?"reference":"floating":d],y=RA(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(m)))==null||n?m:m.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),x=d==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,b=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),_=await(s.isElement==null?void 0:s.isElement(b))?await(s.getScale==null?void 0:s.getScale(b))||{x:1,y:1}:{x:1,y:1},T=RA(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:x,offsetParent:b,strategy:l}):x);return{top:(y.top-T.top+p.top)/_.y,bottom:(T.bottom-y.bottom+p.bottom)/_.y,left:(y.left-T.left+p.left)/_.x,right:(T.right-y.right+p.right)/_.x}}const iNe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:c,padding:u=0}=eh(t,e)||{};if(c==null)return{};const d=use(u),h={x:n,y:r},f=IU(i),p=AU(f),g=await a.getDimensions(c),m=f==="y",y=m?"top":"left",x=m?"bottom":"right",b=m?"clientHeight":"clientWidth",_=s.reference[p]+s.reference[f]-h[f]-s.floating[p],T=h[f]-s.reference[f],E=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let C=E?E[b]:0;(!C||!await(a.isElement==null?void 0:a.isElement(E)))&&(C=o.floating[b]||s.floating[p]);const I=_/2-T/2,A=C/2-g[p]/2-1,k=Bf(d[y],A),R=Bf(d[x],A),$=k,z=C-g[p]-R,O=C/2-g[p]/2+I,j=$F($,O,z),B=!l.arrow&&U0(i)!=null&&O!==j&&s.reference[p]/2-(O<$?k:R)-g[p]/2<0,W=B?O<$?O-$:O-z:0;return{[f]:h[f]+W,data:{[f]:j,centerOffset:O-j-W,...B&&{alignmentOffset:W}},reset:B}}}),sNe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:p="none",flipAlignment:g=!0,...m}=eh(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const y=th(i),x=Vd(o),b=th(o)===o,_=await(l.isRTL==null?void 0:l.isRTL(c.floating)),T=h||(b||!g?[MA(o)]:JCe(o)),E=p!=="none";!h&&E&&T.push(...tNe(o,g,p,_));const C=[o,...T],I=await H1(e,m),A=[];let k=((r=s.flip)==null?void 0:r.overflows)||[];if(u&&A.push(I[y]),d){const j=QCe(i,a,_);A.push(I[j[0]],I[j[1]])}if(k=[...k,{placement:i,overflows:A}],!A.every(j=>j<=0)){var R,$;const j=(((R=s.flip)==null?void 0:R.index)||0)+1,B=C[j];if(B){var z;const L=d==="alignment"?x!==Vd(B):!1,V=((z=k[0])==null?void 0:z.overflows[0])>0;if(!L||V)return{data:{index:j,overflows:k},reset:{placement:B}}}let W=($=k.filter(L=>L.overflows[0]<=0).sort((L,V)=>L.overflows[1]-V.overflows[1])[0])==null?void 0:$.placement;if(!W)switch(f){case"bestFit":{var O;const L=(O=k.filter(V=>{if(E){const H=Vd(V.placement);return H===x||H==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(H=>H>0).reduce((H,K)=>H+K,0)]).sort((V,H)=>V[1]-H[1])[0])==null?void 0:O[0];L&&(W=L);break}case"initialPlacement":W=o;break}if(i!==W)return{reset:{placement:W}}}return{}}}};function jq(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function zq(t){return KCe.some(e=>t[e]>=0)}const aNe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...i}=eh(t,e);switch(r){case"referenceHidden":{const s=await H1(e,{...i,elementContext:"reference"}),a=jq(s,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:zq(a)}}}case"escaped":{const s=await H1(e,{...i,altBoundary:!0}),a=jq(s,n.floating);return{data:{escapedOffsets:a,escaped:zq(a)}}}default:return{}}}}};async function oNe(t,e){const{placement:n,platform:r,elements:i}=t,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=th(n),o=U0(n),l=Vd(n)==="y",c=["left","top"].includes(a)?-1:1,u=s&&l?-1:1,d=eh(e,t);let{mainAxis:h,crossAxis:f,alignmentAxis:p}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof p=="number"&&(f=o==="end"?p*-1:p),l?{x:f*u,y:h*c}:{x:h*c,y:f*u}}const lNe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:i,y:s,placement:a,middlewareData:o}=e,l=await oNe(e,t);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},cNe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:m=>{let{x:y,y:x}=m;return{x:y,y:x}}},...l}=eh(t,e),c={x:n,y:r},u=await H1(e,l),d=Vd(th(i)),h=NU(d);let f=c[h],p=c[d];if(s){const m=h==="y"?"top":"left",y=h==="y"?"bottom":"right",x=f+u[m],b=f-u[y];f=$F(x,f,b)}if(a){const m=d==="y"?"top":"left",y=d==="y"?"bottom":"right",x=p+u[m],b=p-u[y];p=$F(x,p,b)}const g=o.fn({...e,[h]:f,[d]:p});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[h]:s,[d]:a}}}}}},uNe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:i,rects:s,middlewareData:a}=e,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=eh(t,e),u={x:n,y:r},d=Vd(i),h=NU(d);let f=u[h],p=u[d];const g=eh(o,e),m=typeof g=="number"?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(l){const b=h==="y"?"height":"width",_=s.reference[h]-s.floating[b]+m.mainAxis,T=s.reference[h]+s.reference[b]-m.mainAxis;f<_?f=_:f>T&&(f=T)}if(c){var y,x;const b=h==="y"?"width":"height",_=["top","left"].includes(th(i)),T=s.reference[d]-s.floating[b]+(_&&((y=a.offset)==null?void 0:y[d])||0)+(_?0:m.crossAxis),E=s.reference[d]+s.reference[b]+(_?0:((x=a.offset)==null?void 0:x[d])||0)-(_?m.crossAxis:0);p<T?p=T:p>E&&(p=E)}return{[h]:f,[d]:p}}}},dNe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:i,rects:s,platform:a,elements:o}=e,{apply:l=()=>{},...c}=eh(t,e),u=await H1(e,c),d=th(i),h=U0(i),f=Vd(i)==="y",{width:p,height:g}=s.floating;let m,y;d==="top"||d==="bottom"?(m=d,y=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(y=d,m=h==="end"?"top":"bottom");const x=g-u.top-u.bottom,b=p-u.left-u.right,_=Bf(g-u[m],x),T=Bf(p-u[y],b),E=!e.middlewareData.shift;let C=_,I=T;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=b),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(C=x),E&&!h){const k=Bo(u.left,0),R=Bo(u.right,0),$=Bo(u.top,0),z=Bo(u.bottom,0);f?I=p-2*(k!==0||R!==0?k+R:Bo(u.left,u.right)):C=g-2*($!==0||z!==0?$+z:Bo(u.top,u.bottom))}await l({...e,availableWidth:I,availableHeight:C});const A=await a.getDimensions(o.floating);return p!==A.width||g!==A.height?{reset:{rects:!0}}:{}}}};function eM(){return typeof window<"u"}function V0(t){return dse(t)?(t.nodeName||"").toLowerCase():"#document"}function Xo(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function td(t){var e;return(e=(dse(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function dse(t){return eM()?t instanceof Node||t instanceof Xo(t).Node:!1}function Vc(t){return eM()?t instanceof Element||t instanceof Xo(t).Element:!1}function Hu(t){return eM()?t instanceof HTMLElement||t instanceof Xo(t).HTMLElement:!1}function Bq(t){return!eM()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Xo(t).ShadowRoot}function j_(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Wc(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function hNe(t){return["table","td","th"].includes(V0(t))}function tM(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function kU(t){const e=MU(),n=Vc(t)?Wc(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function fNe(t){let e=Uf(t);for(;Hu(e)&&!Bx(e);){if(kU(e))return e;if(tM(e))return null;e=Uf(e)}return null}function MU(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Bx(t){return["html","body","#document"].includes(V0(t))}function Wc(t){return Xo(t).getComputedStyle(t)}function nM(t){return Vc(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Uf(t){if(V0(t)==="html")return t;const e=t.assignedSlot||t.parentNode||Bq(t)&&t.host||td(t);return Bq(e)?e.host:e}function hse(t){const e=Uf(t);return Bx(e)?t.ownerDocument?t.ownerDocument.body:t.body:Hu(e)&&j_(e)?e:hse(e)}function G1(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const i=hse(t),s=i===((r=t.ownerDocument)==null?void 0:r.body),a=Xo(i);if(s){const o=FF(a);return e.concat(a,a.visualViewport||[],j_(i)?i:[],o&&n?G1(o):[])}return e.concat(i,G1(i,[],n))}function FF(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function fse(t){const e=Wc(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const i=Hu(t),s=i?t.offsetWidth:n,a=i?t.offsetHeight:r,o=kA(n)!==s||kA(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function RU(t){return Vc(t)?t:t.contextElement}function Jv(t){const e=RU(t);if(!Hu(e))return Pu(1);const n=e.getBoundingClientRect(),{width:r,height:i,$:s}=fse(e);let a=(s?kA(n.width):n.width)/r,o=(s?kA(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const pNe=Pu(0);function pse(t){const e=Xo(t);return!MU()||!e.visualViewport?pNe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function mNe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Xo(t)?!1:e}function fg(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const i=t.getBoundingClientRect(),s=RU(t);let a=Pu(1);e&&(r?Vc(r)&&(a=Jv(r)):a=Jv(t));const o=mNe(s,n,r)?pse(s):Pu(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,u=i.width/a.x,d=i.height/a.y;if(s){const h=Xo(s),f=r&&Vc(r)?Xo(r):r;let p=h,g=FF(p);for(;g&&r&&f!==p;){const m=Jv(g),y=g.getBoundingClientRect(),x=Wc(g),b=y.left+(g.clientLeft+parseFloat(x.paddingLeft))*m.x,_=y.top+(g.clientTop+parseFloat(x.paddingTop))*m.y;l*=m.x,c*=m.y,u*=m.x,d*=m.y,l+=b,c+=_,p=Xo(g),g=FF(p)}}return RA({width:u,height:d,x:l,y:c})}function PU(t,e){const n=nM(t).scrollLeft;return e?e.left+n:fg(td(t)).left+n}function mse(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),i=r.left+e.scrollLeft-(n?0:PU(t,r)),s=r.top+e.scrollTop;return{x:i,y:s}}function gNe(t){let{elements:e,rect:n,offsetParent:r,strategy:i}=t;const s=i==="fixed",a=td(r),o=e?tM(e.floating):!1;if(r===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},c=Pu(1);const u=Pu(0),d=Hu(r);if((d||!d&&!s)&&((V0(r)!=="body"||j_(a))&&(l=nM(r)),Hu(r))){const f=fg(r);c=Jv(r),u.x=f.x+r.clientLeft,u.y=f.y+r.clientTop}const h=a&&!d&&!s?mse(a,l,!0):Pu(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function yNe(t){return Array.from(t.getClientRects())}function vNe(t){const e=td(t),n=nM(t),r=t.ownerDocument.body,i=Bo(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),s=Bo(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+PU(t);const o=-n.scrollTop;return Wc(r).direction==="rtl"&&(a+=Bo(e.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function xNe(t,e){const n=Xo(t),r=td(t),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const c=MU();(!c||c&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}function bNe(t,e){const n=fg(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,s=Hu(t)?Jv(t):Pu(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,l=i*s.x,c=r*s.y;return{width:a,height:o,x:l,y:c}}function Uq(t,e,n){let r;if(e==="viewport")r=xNe(t,n);else if(e==="document")r=vNe(td(t));else if(Vc(e))r=bNe(e,n);else{const i=pse(t);r={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return RA(r)}function gse(t,e){const n=Uf(t);return n===e||!Vc(n)||Bx(n)?!1:Wc(n).position==="fixed"||gse(n,e)}function wNe(t,e){const n=e.get(t);if(n)return n;let r=G1(t,[],!1).filter(o=>Vc(o)&&V0(o)!=="body"),i=null;const s=Wc(t).position==="fixed";let a=s?Uf(t):t;for(;Vc(a)&&!Bx(a);){const o=Wc(a),l=kU(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&["absolute","fixed"].includes(i.position)||j_(a)&&!l&&gse(t,a))?r=r.filter(u=>u!==a):i=o,a=Uf(a)}return e.set(t,r),r}function SNe(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const a=[...n==="clippingAncestors"?tM(e)?[]:wNe(e,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=Uq(e,u,i);return c.top=Bo(d.top,c.top),c.right=Bf(d.right,c.right),c.bottom=Bf(d.bottom,c.bottom),c.left=Bo(d.left,c.left),c},Uq(e,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function _Ne(t){const{width:e,height:n}=fse(t);return{width:e,height:n}}function TNe(t,e,n){const r=Hu(e),i=td(e),s=n==="fixed",a=fg(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=Pu(0);function c(){l.x=PU(i)}if(r||!r&&!s)if((V0(e)!=="body"||j_(i))&&(o=nM(e)),r){const f=fg(e,!0,s,e);l.x=f.x+e.clientLeft,l.y=f.y+e.clientTop}else i&&c();s&&!r&&i&&c();const u=i&&!r&&!s?mse(i,o):Pu(0),d=a.left+o.scrollLeft-l.x-u.x,h=a.top+o.scrollTop-l.y-u.y;return{x:d,y:h,width:a.width,height:a.height}}function x$(t){return Wc(t).position==="static"}function Vq(t,e){if(!Hu(t)||Wc(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return td(t)===n&&(n=n.ownerDocument.body),n}function yse(t,e){const n=Xo(t);if(tM(t))return n;if(!Hu(t)){let i=Uf(t);for(;i&&!Bx(i);){if(Vc(i)&&!x$(i))return i;i=Uf(i)}return n}let r=Vq(t,e);for(;r&&hNe(r)&&x$(r);)r=Vq(r,e);return r&&Bx(r)&&x$(r)&&!kU(r)?n:r||fNe(t)||n}const ENe=async function(t){const e=this.getOffsetParent||yse,n=this.getDimensions,r=await n(t.floating);return{reference:TNe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function CNe(t){return Wc(t).direction==="rtl"}const NNe={convertOffsetParentRelativeRectToViewportRelativeRect:gNe,getDocumentElement:td,getClippingRect:SNe,getOffsetParent:yse,getElementRects:ENe,getClientRects:yNe,getDimensions:_Ne,getScale:Jv,isElement:Vc,isRTL:CNe};function vse(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function ANe(t,e){let n=null,r;const i=td(t);function s(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=t.getBoundingClientRect(),{left:u,top:d,width:h,height:f}=c;if(o||e(),!h||!f)return;const p=XC(d),g=XC(i.clientWidth-(u+h)),m=XC(i.clientHeight-(d+f)),y=XC(u),b={rootMargin:-p+"px "+-g+"px "+-m+"px "+-y+"px",threshold:Bo(0,Bf(1,l))||1};let _=!0;function T(E){const C=E[0].intersectionRatio;if(C!==l){if(!_)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},1e3)}C===1&&!vse(c,t.getBoundingClientRect())&&a(),_=!1}try{n=new IntersectionObserver(T,{...b,root:i.ownerDocument})}catch{n=new IntersectionObserver(T,b)}n.observe(t)}return a(!0),s}function INe(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=RU(t),u=i||s?[...c?G1(c):[],...G1(e)]:[];u.forEach(y=>{i&&y.addEventListener("scroll",n,{passive:!0}),s&&y.addEventListener("resize",n)});const d=c&&o?ANe(c,n):null;let h=-1,f=null;a&&(f=new ResizeObserver(y=>{let[x]=y;x&&x.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var b;(b=f)==null||b.observe(e)})),n()}),c&&!l&&f.observe(c),f.observe(e));let p,g=l?fg(t):null;l&&m();function m(){const y=fg(t);g&&!vse(g,y)&&n(),g=y,p=requestAnimationFrame(m)}return n(),()=>{var y;u.forEach(x=>{i&&x.removeEventListener("scroll",n),s&&x.removeEventListener("resize",n)}),d==null||d(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(p)}}const kNe=lNe,MNe=cNe,RNe=sNe,PNe=dNe,ONe=aNe,Wq=iNe,DNe=uNe,$Ne=(t,e,n)=>{const r=new Map,i={platform:NNe,...n},s={...i.platform,_c:r};return rNe(t,e,{...i,platform:s})};var $2=typeof document<"u"?P.useLayoutEffect:P.useEffect;function PA(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,i;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!PA(t[r],e[r]))return!1;return!0}if(i=Object.keys(t),n=i.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&t.$$typeof)&&!PA(t[s],e[s]))return!1}return!0}return t!==t&&e!==e}function xse(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function Hq(t,e){const n=xse(t);return Math.round(e*n)/n}function b$(t){const e=P.useRef(t);return $2(()=>{e.current=t}),e}function LNe(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=t,[u,d]=P.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[h,f]=P.useState(r);PA(h,r)||f(r);const[p,g]=P.useState(null),[m,y]=P.useState(null),x=P.useCallback(L=>{L!==E.current&&(E.current=L,g(L))},[]),b=P.useCallback(L=>{L!==C.current&&(C.current=L,y(L))},[]),_=s||p,T=a||m,E=P.useRef(null),C=P.useRef(null),I=P.useRef(u),A=l!=null,k=b$(l),R=b$(i),$=b$(c),z=P.useCallback(()=>{if(!E.current||!C.current)return;const L={placement:e,strategy:n,middleware:h};R.current&&(L.platform=R.current),$Ne(E.current,C.current,L).then(V=>{const H={...V,isPositioned:$.current!==!1};O.current&&!PA(I.current,H)&&(I.current=H,Gg.flushSync(()=>{d(H)}))})},[h,e,n,R,$]);$2(()=>{c===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,d(L=>({...L,isPositioned:!1})))},[c]);const O=P.useRef(!1);$2(()=>(O.current=!0,()=>{O.current=!1}),[]),$2(()=>{if(_&&(E.current=_),T&&(C.current=T),_&&T){if(k.current)return k.current(_,T,z);z()}},[_,T,z,k,A]);const j=P.useMemo(()=>({reference:E,floating:C,setReference:x,setFloating:b}),[x,b]),B=P.useMemo(()=>({reference:_,floating:T}),[_,T]),W=P.useMemo(()=>{const L={position:n,left:0,top:0};if(!B.floating)return L;const V=Hq(B.floating,u.x),H=Hq(B.floating,u.y);return o?{...L,transform:"translate("+V+"px, "+H+"px)",...xse(B.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:V,top:H}},[n,o,B.floating,u.x,u.y]);return P.useMemo(()=>({...u,update:z,refs:j,elements:B,floatingStyles:W}),[u,z,j,B,W])}const FNe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:i}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?Wq({element:r.current,padding:i}).fn(n):{}:r?Wq({element:r,padding:i}).fn(n):{}}}},jNe=(t,e)=>({...kNe(t),options:[t,e]}),zNe=(t,e)=>({...MNe(t),options:[t,e]}),BNe=(t,e)=>({...DNe(t),options:[t,e]}),UNe=(t,e)=>({...RNe(t),options:[t,e]}),VNe=(t,e)=>({...PNe(t),options:[t,e]}),WNe=(t,e)=>({...ONe(t),options:[t,e]}),HNe=(t,e)=>({...FNe(t),options:[t,e]});var GNe="Arrow",bse=P.forwardRef((t,e)=>{const{children:n,width:r=10,height:i=5,...s}=t;return v.jsx(Wt.svg,{...s,ref:e,width:r,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:v.jsx("polygon",{points:"0,0 30,0 15,10"})})});bse.displayName=GNe;var qNe=bse;function wse(t){const[e,n]=P.useState(void 0);return Ki(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=t.offsetWidth,o=t.offsetHeight;n({width:a,height:o})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var OU="Popper",[Sse,W0]=Yl(OU),[XNe,_se]=Sse(OU),Tse=t=>{const{__scopePopper:e,children:n}=t,[r,i]=P.useState(null);return v.jsx(XNe,{scope:e,anchor:r,onAnchorChange:i,children:n})};Tse.displayName=OU;var Ese="PopperAnchor",Cse=P.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...i}=t,s=_se(Ese,n),a=P.useRef(null),o=Vn(e,a);return P.useEffect(()=>{s.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:v.jsx(Wt.div,{...i,ref:o})});Cse.displayName=Ese;var DU="PopperContent",[KNe,YNe]=Sse(DU),Nse=P.forwardRef((t,e)=>{var me,De,ge,_e,Ce,G;const{__scopePopper:n,side:r="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:f="optimized",onPlaced:p,...g}=t,m=_se(DU,n),[y,x]=P.useState(null),b=Vn(e,ke=>x(ke)),[_,T]=P.useState(null),E=wse(_),C=(E==null?void 0:E.width)??0,I=(E==null?void 0:E.height)??0,A=r+(s!=="center"?"-"+s:""),k=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},R=Array.isArray(c)?c:[c],$=R.length>0,z={padding:k,boundary:R.filter(QNe),altBoundary:$},{refs:O,floatingStyles:j,placement:B,isPositioned:W,middlewareData:L}=LNe({strategy:"fixed",placement:A,whileElementsMounted:(...ke)=>INe(...ke,{animationFrame:f==="always"}),elements:{reference:m.anchor},middleware:[jNe({mainAxis:i+I,alignmentAxis:a}),l&&zNe({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?BNe():void 0,...z}),l&&UNe({...z}),VNe({...z,apply:({elements:ke,rects:xe,availableWidth:Pe,availableHeight:Te})=>{const{width:Ye,height:qe}=xe.reference,Q=ke.floating.style;Q.setProperty("--radix-popper-available-width",`${Pe}px`),Q.setProperty("--radix-popper-available-height",`${Te}px`),Q.setProperty("--radix-popper-anchor-width",`${Ye}px`),Q.setProperty("--radix-popper-anchor-height",`${qe}px`)}}),_&&HNe({element:_,padding:o}),JNe({arrowWidth:C,arrowHeight:I}),h&&WNe({strategy:"referenceHidden",...z})]}),[V,H]=kse(B),K=Jo(p);Ki(()=>{W&&(K==null||K())},[W,K]);const te=(me=L.arrow)==null?void 0:me.x,J=(De=L.arrow)==null?void 0:De.y,oe=((ge=L.arrow)==null?void 0:ge.centerOffset)!==0,[fe,Ee]=P.useState();return Ki(()=>{y&&Ee(window.getComputedStyle(y).zIndex)},[y]),v.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...j,transform:W?j.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:fe,"--radix-popper-transform-origin":[(_e=L.transformOrigin)==null?void 0:_e.x,(Ce=L.transformOrigin)==null?void 0:Ce.y].join(" "),...((G=L.hide)==null?void 0:G.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:v.jsx(KNe,{scope:n,placedSide:V,onArrowChange:T,arrowX:te,arrowY:J,shouldHideArrow:oe,children:v.jsx(Wt.div,{"data-side":V,"data-align":H,...g,ref:b,style:{...g.style,animation:W?void 0:"none"}})})})});Nse.displayName=DU;var Ase="PopperArrow",ZNe={top:"bottom",right:"left",bottom:"top",left:"right"},Ise=P.forwardRef(function(e,n){const{__scopePopper:r,...i}=e,s=YNe(Ase,r),a=ZNe[s.placedSide];return v.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:v.jsx(qNe,{...i,ref:n,style:{...i.style,display:"block"}})})});Ise.displayName=Ase;function QNe(t){return t!==null}var JNe=t=>({name:"transformOrigin",options:t,fn(e){var m,y,x;const{placement:n,rects:r,middlewareData:i}=e,a=((m=i.arrow)==null?void 0:m.centerOffset)!==0,o=a?0:t.arrowWidth,l=a?0:t.arrowHeight,[c,u]=kse(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((y=i.arrow)==null?void 0:y.x)??0)+o/2,f=(((x=i.arrow)==null?void 0:x.y)??0)+l/2;let p="",g="";return c==="bottom"?(p=a?d:`${h}px`,g=`${-l}px`):c==="top"?(p=a?d:`${h}px`,g=`${r.floating.height+l}px`):c==="right"?(p=`${-l}px`,g=a?d:`${f}px`):c==="left"&&(p=`${r.floating.width+l}px`,g=a?d:`${f}px`),{data:{x:p,y:g}}}});function kse(t){const[e,n="center"]=t.split("-");return[e,n]}var Mse=Tse,rM=Cse,$U=Nse,LU=Ise,[iM,V3t]=Yl("Tooltip",[W0]),FU=W0(),Rse="TooltipProvider",e2e=700,Gq="tooltip.open",[t2e,Pse]=iM(Rse),Ose=t=>{const{__scopeTooltip:e,delayDuration:n=e2e,skipDelayDuration:r=300,disableHoverableContent:i=!1,children:s}=t,a=P.useRef(!0),o=P.useRef(!1),l=P.useRef(0);return P.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),v.jsx(t2e,{scope:e,isOpenDelayedRef:a,delayDuration:n,onOpen:P.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:P.useCallback(c=>{o.current=c},[]),disableHoverableContent:i,children:s})};Ose.displayName=Rse;var Dse="Tooltip",[W3t,sM]=iM(Dse),jF="TooltipTrigger",n2e=P.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=sM(jF,n),s=Pse(jF,n),a=FU(n),o=P.useRef(null),l=Vn(e,o,i.onTriggerChange),c=P.useRef(!1),u=P.useRef(!1),d=P.useCallback(()=>c.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),v.jsx(rM,{asChild:!0,...a,children:v.jsx(Wt.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...r,ref:l,onPointerMove:kt(t.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),u.current=!0)}),onPointerLeave:kt(t.onPointerLeave,()=>{i.onTriggerLeave(),u.current=!1}),onPointerDown:kt(t.onPointerDown,()=>{i.open&&i.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:kt(t.onFocus,()=>{c.current||i.onOpen()}),onBlur:kt(t.onBlur,i.onClose),onClick:kt(t.onClick,i.onClose)})})});n2e.displayName=jF;var r2e="TooltipPortal",[H3t,i2e]=iM(r2e,{forceMount:void 0}),Ux="TooltipContent",$se=P.forwardRef((t,e)=>{const n=i2e(Ux,t.__scopeTooltip),{forceMount:r=n.forceMount,side:i="top",...s}=t,a=sM(Ux,t.__scopeTooltip);return v.jsx(mh,{present:r||a.open,children:a.disableHoverableContent?v.jsx(Lse,{side:i,...s,ref:e}):v.jsx(s2e,{side:i,...s,ref:e})})}),s2e=P.forwardRef((t,e)=>{const n=sM(Ux,t.__scopeTooltip),r=Pse(Ux,t.__scopeTooltip),i=P.useRef(null),s=Vn(e,i),[a,o]=P.useState(null),{trigger:l,onClose:c}=n,u=i.current,{onPointerInTransitChange:d}=r,h=P.useCallback(()=>{o(null),d(!1)},[d]),f=P.useCallback((p,g)=>{const m=p.currentTarget,y={x:p.clientX,y:p.clientY},x=u2e(y,m.getBoundingClientRect()),b=d2e(y,x),_=h2e(g.getBoundingClientRect()),T=p2e([...b,..._]);o(T),d(!0)},[d]);return P.useEffect(()=>()=>h(),[h]),P.useEffect(()=>{if(l&&u){const p=m=>f(m,u),g=m=>f(m,l);return l.addEventListener("pointerleave",p),u.addEventListener("pointerleave",g),()=>{l.removeEventListener("pointerleave",p),u.removeEventListener("pointerleave",g)}}},[l,u,f,h]),P.useEffect(()=>{if(a){const p=g=>{const m=g.target,y={x:g.clientX,y:g.clientY},x=(l==null?void 0:l.contains(m))||(u==null?void 0:u.contains(m)),b=!f2e(y,a);x?h():b&&(h(),c())};return document.addEventListener("pointermove",p),()=>document.removeEventListener("pointermove",p)}},[l,u,a,c,h]),v.jsx(Lse,{...t,ref:s})}),[a2e,o2e]=iM(Dse,{isInside:!1}),l2e=aEe("TooltipContent"),Lse=P.forwardRef((t,e)=>{const{__scopeTooltip:n,children:r,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=t,l=sM(Ux,n),c=FU(n),{onClose:u}=l;return P.useEffect(()=>(document.addEventListener(Gq,u),()=>document.removeEventListener(Gq,u)),[u]),P.useEffect(()=>{if(l.trigger){const d=h=>{const f=h.target;f!=null&&f.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),v.jsx(j0,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:v.jsxs($U,{"data-state":l.stateAttribute,...c,...o,ref:e,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[v.jsx(l2e,{children:r}),v.jsx(a2e,{scope:n,isInside:!0,children:v.jsx(AEe,{id:l.contentId,role:"tooltip",children:i||r})})]})})});$se.displayName=Ux;var Fse="TooltipArrow",c2e=P.forwardRef((t,e)=>{const{__scopeTooltip:n,...r}=t,i=FU(n);return o2e(Fse,n).isInside?null:v.jsx(LU,{...i,...r,ref:e})});c2e.displayName=Fse;function u2e(t,e){const n=Math.abs(e.top-t.y),r=Math.abs(e.bottom-t.y),i=Math.abs(e.right-t.x),s=Math.abs(e.left-t.x);switch(Math.min(n,r,i,s)){case s:return"left";case i:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function d2e(t,e,n=5){const r=[];switch(e){case"top":r.push({x:t.x-n,y:t.y+n},{x:t.x+n,y:t.y+n});break;case"bottom":r.push({x:t.x-n,y:t.y-n},{x:t.x+n,y:t.y-n});break;case"left":r.push({x:t.x+n,y:t.y-n},{x:t.x+n,y:t.y+n});break;case"right":r.push({x:t.x-n,y:t.y-n},{x:t.x-n,y:t.y+n});break}return r}function h2e(t){const{top:e,right:n,bottom:r,left:i}=t;return[{x:i,y:e},{x:n,y:e},{x:n,y:r},{x:i,y:r}]}function f2e(t,e){const{x:n,y:r}=t;let i=!1;for(let s=0,a=e.length-1;s<e.length;a=s++){const o=e[s],l=e[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(i=!i)}return i}function p2e(t){const e=t.slice();return e.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),m2e(e)}function m2e(t){if(t.length<=1)return t.slice();const e=[];for(let r=0;r<t.length;r++){const i=t[r];for(;e.length>=2;){const s=e[e.length-1],a=e[e.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))e.pop();else break}e.push(i)}e.pop();const n=[];for(let r=t.length-1;r>=0;r--){const i=t[r];for(;n.length>=2;){const s=n[n.length-1],a=n[n.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))n.pop();else break}n.push(i)}return n.pop(),e.length===1&&n.length===1&&e[0].x===n[0].x&&e[0].y===n[0].y?e:e.concat(n)}var g2e=Ose,jse=$se;const y2e=g2e,v2e=P.forwardRef(({className:t,sideOffset:e=4,...n},r)=>v.jsx(jse,{ref:r,sideOffset:e,className:Pt("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...n}));v2e.displayName=jse.displayName;var x2e=(t,e,n,r,i,s,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(f){(Array.isArray(t)?t:[t]).forEach(p=>{let g=p==="class",m=g&&s?i.map(y=>s[y]||y):i;g?(l.classList.remove(...m),l.classList.add(s&&s[f]?s[f]:f)):l.setAttribute(p,f)}),d(f)}function d(f){o&&c.includes(f)&&(l.style.colorScheme=f)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let f=localStorage.getItem(e)||n,p=a&&f==="system"?h():f;u(p)}catch{}},qq=["light","dark"],zse="(prefers-color-scheme: dark)",b2e=typeof window>"u",Bse=P.createContext(void 0),w2e=t=>P.useContext(Bse)?P.createElement(P.Fragment,null,t.children):P.createElement(_2e,{...t}),S2e=["light","dark"],_2e=({forcedTheme:t,disableTransitionOnChange:e=!1,enableSystem:n=!0,enableColorScheme:r=!0,storageKey:i="theme",themes:s=S2e,defaultTheme:a=n?"system":"light",attribute:o="data-theme",value:l,children:c,nonce:u,scriptProps:d})=>{let[h,f]=P.useState(()=>E2e(i,a)),[p,g]=P.useState(()=>h==="system"?w$():h),m=l?Object.values(l):s,y=P.useCallback(T=>{let E=T;if(!E)return;T==="system"&&n&&(E=w$());let C=l?l[E]:E,I=e?C2e(u):null,A=document.documentElement,k=R=>{R==="class"?(A.classList.remove(...m),C&&A.classList.add(C)):R.startsWith("data-")&&(C?A.setAttribute(R,C):A.removeAttribute(R))};if(Array.isArray(o)?o.forEach(k):k(o),r){let R=qq.includes(a)?a:null,$=qq.includes(E)?E:R;A.style.colorScheme=$}I==null||I()},[u]),x=P.useCallback(T=>{let E=typeof T=="function"?T(h):T;f(E);try{localStorage.setItem(i,E)}catch{}},[h]),b=P.useCallback(T=>{let E=w$(T);g(E),h==="system"&&n&&!t&&y("system")},[h,t]);P.useEffect(()=>{let T=window.matchMedia(zse);return T.addListener(b),b(T),()=>T.removeListener(b)},[b]),P.useEffect(()=>{let T=E=>{E.key===i&&(E.newValue?f(E.newValue):x(a))};return window.addEventListener("storage",T),()=>window.removeEventListener("storage",T)},[x]),P.useEffect(()=>{y(t??h)},[t,h]);let _=P.useMemo(()=>({theme:h,setTheme:x,forcedTheme:t,resolvedTheme:h==="system"?p:h,themes:n?[...s,"system"]:s,systemTheme:n?p:void 0}),[h,x,t,p,n,s]);return P.createElement(Bse.Provider,{value:_},P.createElement(T2e,{forcedTheme:t,storageKey:i,attribute:o,enableSystem:n,enableColorScheme:r,defaultTheme:a,value:l,themes:s,nonce:u,scriptProps:d}),c)},T2e=P.memo(({forcedTheme:t,storageKey:e,attribute:n,enableSystem:r,enableColorScheme:i,defaultTheme:s,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,e,s,t,o,a,r,i]).slice(1,-1);return P.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${x2e.toString()})(${u})`}})}),E2e=(t,e)=>{if(b2e)return;let n;try{n=localStorage.getItem(t)||void 0}catch{}return n||e},C2e=t=>{let e=document.createElement("style");return t&&e.setAttribute("nonce",t),e.appendChild(document.createTextNode("*,*::before,*::after{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(e),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(e)},1)}},w$=t=>(t||(t=window.matchMedia(zse)),t.matches?"dark":"light");const mu=({href:t,icon:e,children:n,currentPath:r})=>{const i=r===t;return v.jsx(Lc,{href:t,children:v.jsxs("div",{className:Pt("flex items-center py-2 px-4 rounded-lg mb-1 transition-colors cursor-pointer",i?"bg-primary bg-opacity-10 text-primary border-l-4 border-primary":"text-neutral-700 hover:text-primary hover:bg-gray-100"),children:[v.jsx("span",{className:"mr-3",children:e}),n]})})},N2e=()=>{const[t]=yU();return v.jsxs("aside",{className:"w-full md:w-64 bg-white shadow-md md:min-h-screen",children:[v.jsxs("div",{className:"p-4 border-b",children:[v.jsxs("h1",{className:"text-2xl font-bold font-heading text-primary-dark flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M5.5 17a4.5 4.5 0 01-1.44-8.765 4.5 4.5 0 018.302-3.046 3.5 3.5 0 014.504 4.272A4 4 0 0115 17H5.5z",clipRule:"evenodd"})}),"PhysioTrack"]}),v.jsx("p",{className:"text-neutral-500 text-sm",children:"AI-Powered Rehabilitation"})]}),v.jsxs("nav",{className:"p-2",children:[v.jsx("p",{className:"text-xs font-medium text-neutral-400 uppercase tracking-wider mt-4 mb-2 px-4",children:"Dashboard"}),v.jsx(mu,{href:"/",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{d:"M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"})}),currentPath:t,children:"Home"}),v.jsx(mu,{href:"/profile",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),currentPath:t,children:"My Profile"}),v.jsx("p",{className:"text-xs font-medium text-neutral-400 uppercase tracking-wider mt-4 mb-2 px-4",children:"Therapy"}),v.jsx(mu,{href:"/session",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z",clipRule:"evenodd"})}),currentPath:t,children:"Start Session"}),v.jsx(mu,{href:"/progress",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{d:"M9 4.804A7.968 7.968 0 005.5 4c-1.255 0-2.443.29-3.5.804v10A7.969 7.969 0 015.5 14c1.669 0 3.218.51 4.5 1.385A7.962 7.962 0 0114.5 14c1.255 0 2.443.29 3.5.804v-10A7.968 7.968 0 0014.5 4c-1.255 0-2.443.29-3.5.804V12a1 1 0 11-2 0V4.804z"})}),currentPath:t,children:"Progress Reports"}),v.jsx(mu,{href:"/exercises",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{d:"M5 3a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2V5a2 2 0 00-2-2H5zM5 11a2 2 0 00-2 2v2a2 2 0 002 2h2a2 2 0 002-2v-2a2 2 0 00-2-2H5zM11 5a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V5zM11 13a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"})}),currentPath:t,children:"Exercises"}),v.jsx(mu,{href:"/therapist",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 5v8a2 2 0 01-2 2h-5l-5 4v-4H4a2 2 0 01-2-2V5a2 2 0 012-2h12a2 2 0 012 2zM7 8H5v2h2V8zm2 0h2v2H9V8zm6 0h-2v2h2V8z",clipRule:"evenodd"})}),currentPath:t,children:"Therapist Notes"}),v.jsx("p",{className:"text-xs font-medium text-neutral-400 uppercase tracking-wider mt-4 mb-2 px-4",children:"Immersive Therapy"}),v.jsx(mu,{href:"/vr-therapy",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M3 4a1 1 0 011-1h12a1 1 0 011 1v4a1 1 0 01-1 1h-2a1 1 0 00-.707.293l-2.586 2.586a1 1 0 01-1.414 0L7.707 9.293A1 1 0 007 9H5a1 1 0 01-1-1V4zm5 1a1 1 0 10-2 0v1a1 1 0 102 0V5zm6 0a1 1 0 10-2 0v1a1 1 0 102 0V5z",clipRule:"evenodd"})}),currentPath:t,children:"VR Therapy"}),v.jsx(mu,{href:"/ar-therapy",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M5 2a1 1 0 00-1 1v1h12V3a1 1 0 00-1-1H5zm-1 3a1 1 0 00-1 1v12a1 1 0 001 1h12a1 1 0 001-1V6a1 1 0 00-1-1H4zm5 9a1 1 0 100-2 1 1 0 000 2zm4 0a1 1 0 100-2 1 1 0 000 2zm-7 4h10v-5H6v5z",clipRule:"evenodd"})}),currentPath:t,children:"AR Therapy"}),v.jsx("p",{className:"text-xs font-medium text-neutral-400 uppercase tracking-wider mt-4 mb-2 px-4",children:"More"}),v.jsx(mu,{href:"/payments",icon:v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:[v.jsx("path",{d:"M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"}),v.jsx("path",{fillRule:"evenodd",d:"M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z",clipRule:"evenodd"})]}),currentPath:t,children:"Billing & Payments"}),v.jsx(mu,{href:"/gutrehab",icon:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})}),currentPath:t,children:"GutrehaB"})]}),v.jsx("div",{className:"p-4 mt-auto",children:v.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[v.jsx("h3",{className:"text-primary-dark font-medium",children:"GutrehaB"}),v.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:"Our one-in-all solution for gut health & mental wellbeing."}),v.jsx(Lc,{href:"/gutrehab",children:v.jsx("div",{className:"mt-2 inline-block text-sm font-medium text-primary hover:text-primary-dark cursor-pointer",children:"Learn more"})})]})})]})};var S$=0;function jU(){P.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Xq()),document.body.insertAdjacentElement("beforeend",t[1]??Xq()),S$++,()=>{S$===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),S$--}},[])}function Xq(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var _$="focusScope.autoFocusOnMount",T$="focusScope.autoFocusOnUnmount",Kq={bubbles:!1,cancelable:!0},A2e="FocusScope",aM=P.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:i,onUnmountAutoFocus:s,...a}=t,[o,l]=P.useState(null),c=Jo(i),u=Jo(s),d=P.useRef(null),h=Vn(e,g=>l(g)),f=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(r){let g=function(b){if(f.paused||!o)return;const _=b.target;o.contains(_)?d.current=_:Gh(d.current,{select:!0})},m=function(b){if(f.paused||!o)return;const _=b.relatedTarget;_!==null&&(o.contains(_)||Gh(d.current,{select:!0}))},y=function(b){if(document.activeElement===document.body)for(const T of b)T.removedNodes.length>0&&Gh(o)};document.addEventListener("focusin",g),document.addEventListener("focusout",m);const x=new MutationObserver(y);return o&&x.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",g),document.removeEventListener("focusout",m),x.disconnect()}}},[r,o,f.paused]),P.useEffect(()=>{if(o){Zq.add(f);const g=document.activeElement;if(!o.contains(g)){const y=new CustomEvent(_$,Kq);o.addEventListener(_$,c),o.dispatchEvent(y),y.defaultPrevented||(I2e(O2e(Use(o)),{select:!0}),document.activeElement===g&&Gh(o))}return()=>{o.removeEventListener(_$,c),setTimeout(()=>{const y=new CustomEvent(T$,Kq);o.addEventListener(T$,u),o.dispatchEvent(y),y.defaultPrevented||Gh(g??document.body,{select:!0}),o.removeEventListener(T$,u),Zq.remove(f)},0)}}},[o,c,u,f]);const p=P.useCallback(g=>{if(!n&&!r||f.paused)return;const m=g.key==="Tab"&&!g.altKey&&!g.ctrlKey&&!g.metaKey,y=document.activeElement;if(m&&y){const x=g.currentTarget,[b,_]=k2e(x);b&&_?!g.shiftKey&&y===_?(g.preventDefault(),n&&Gh(b,{select:!0})):g.shiftKey&&y===b&&(g.preventDefault(),n&&Gh(_,{select:!0})):y===x&&g.preventDefault()}},[n,r,f.paused]);return v.jsx(Wt.div,{tabIndex:-1,...a,ref:h,onKeyDown:p})});aM.displayName=A2e;function I2e(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Gh(r,{select:e}),document.activeElement!==n)return}function k2e(t){const e=Use(t),n=Yq(e,t),r=Yq(e.reverse(),t);return[n,r]}function Use(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const i=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||i?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Yq(t,e){for(const n of t)if(!M2e(n,{upTo:e}))return n}function M2e(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function R2e(t){return t instanceof HTMLInputElement&&"select"in t}function Gh(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&R2e(t)&&e&&t.select()}}var Zq=P2e();function P2e(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=Qq(t,e),t.unshift(e)},remove(e){var n;t=Qq(t,e),(n=t[0])==null||n.resume()}}}function Qq(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function O2e(t){return t.filter(e=>e.tagName!=="A")}var D2e=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ry=new WeakMap,KC=new WeakMap,YC={},E$=0,Vse=function(t){return t&&(t.host||Vse(t.parentNode))},$2e=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=Vse(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},L2e=function(t,e,n,r){var i=$2e(e,Array.isArray(t)?t:[t]);YC[n]||(YC[n]=new WeakMap);var s=YC[n],a=[],o=new Set,l=new Set(i),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};i.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var f=h.getAttribute(r),p=f!==null&&f!=="false",g=(Ry.get(h)||0)+1,m=(s.get(h)||0)+1;Ry.set(h,g),s.set(h,m),a.push(h),g===1&&p&&KC.set(h,!0),m===1&&h.setAttribute(n,"true"),p||h.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",h,y)}})};return u(e),o.clear(),E$++,function(){a.forEach(function(d){var h=Ry.get(d)-1,f=s.get(d)-1;Ry.set(d,h),s.set(d,f),h||(KC.has(d)||d.removeAttribute(r),KC.delete(d)),f||d.removeAttribute(n)}),E$--,E$||(Ry=new WeakMap,Ry=new WeakMap,KC=new WeakMap,YC={})}},zU=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),i=D2e(t);return i?(r.push.apply(r,Array.from(i.querySelectorAll("[aria-live]"))),L2e(r,i,n,"aria-hidden")):function(){return null}},Eu=function(){return Eu=Object.assign||function(e){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s])}return e},Eu.apply(this,arguments)};function Wse(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function F2e(t,e,n){if(n||arguments.length===2)for(var r=0,i=e.length,s;r<i;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return t.concat(s||Array.prototype.slice.call(e))}var L2="right-scroll-bar-position",F2="width-before-scroll-bar",j2e="with-scroll-bars-hidden",z2e="--removed-body-scroll-bar-size";function C$(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function B2e(t,e){var n=P.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var i=n.value;i!==r&&(n.value=r,n.callback(r,i))}}}})[0];return n.callback=e,n.facade}var U2e=typeof window<"u"?P.useLayoutEffect:P.useEffect,Jq=new WeakMap;function V2e(t,e){var n=B2e(null,function(r){return t.forEach(function(i){return C$(i,r)})});return U2e(function(){var r=Jq.get(n);if(r){var i=new Set(r),s=new Set(t),a=n.current;i.forEach(function(o){s.has(o)||C$(o,null)}),s.forEach(function(o){i.has(o)||C$(o,a)})}Jq.set(n,t)},[t]),n}function W2e(t){return t}function H2e(t,e){e===void 0&&(e=W2e);var n=[],r=!1,i={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(s){var a=e(s,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(s){for(r=!0;n.length;){var a=n;n=[],a.forEach(s)}n={push:function(o){return s(o)},filter:function(){return n}}},assignMedium:function(s){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(s),a=n}var l=function(){var u=a;a=[],u.forEach(s)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return i}function G2e(t){t===void 0&&(t={});var e=H2e(null);return e.options=Eu({async:!0,ssr:!1},t),e}var Hse=function(t){var e=t.sideCar,n=Wse(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return P.createElement(r,Eu({},n))};Hse.isSideCarExport=!0;function q2e(t,e){return t.useMedium(e),Hse}var Gse=G2e(),N$=function(){},oM=P.forwardRef(function(t,e){var n=P.useRef(null),r=P.useState({onScrollCapture:N$,onWheelCapture:N$,onTouchMoveCapture:N$}),i=r[0],s=r[1],a=t.forwardProps,o=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,d=t.shards,h=t.sideCar,f=t.noIsolation,p=t.inert,g=t.allowPinchZoom,m=t.as,y=m===void 0?"div":m,x=t.gapMode,b=Wse(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),_=h,T=V2e([n,e]),E=Eu(Eu({},b),i);return P.createElement(P.Fragment,null,u&&P.createElement(_,{sideCar:Gse,removeScrollBar:c,shards:d,noIsolation:f,inert:p,setCallbacks:s,allowPinchZoom:!!g,lockRef:n,gapMode:x}),a?P.cloneElement(P.Children.only(o),Eu(Eu({},E),{ref:T})):P.createElement(y,Eu({},E,{className:l,ref:T}),o))});oM.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};oM.classNames={fullWidth:F2,zeroRight:L2};var X2e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function K2e(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=X2e();return e&&t.setAttribute("nonce",e),t}function Y2e(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Z2e(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Q2e=function(){var t=0,e=null;return{add:function(n){t==0&&(e=K2e())&&(Y2e(e,n),Z2e(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},J2e=function(){var t=Q2e();return function(e,n){P.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},qse=function(){var t=J2e(),e=function(n){var r=n.styles,i=n.dynamic;return t(r,i),null};return e},eAe={left:0,top:0,right:0,gap:0},A$=function(t){return parseInt(t||"",10)||0},tAe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],i=e[t==="padding"?"paddingRight":"marginRight"];return[A$(n),A$(r),A$(i)]},nAe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return eAe;var e=tAe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},rAe=qse(),ex="data-scroll-locked",iAe=function(t,e,n,r){var i=t.left,s=t.top,a=t.right,o=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(j2e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(ex,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(s,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(L2,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(F2,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(L2," .").concat(L2,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(F2," .").concat(F2,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(ex,`] {
    `).concat(z2e,": ").concat(o,`px;
  }
`)},e7=function(){var t=parseInt(document.body.getAttribute(ex)||"0",10);return isFinite(t)?t:0},sAe=function(){P.useEffect(function(){return document.body.setAttribute(ex,(e7()+1).toString()),function(){var t=e7()-1;t<=0?document.body.removeAttribute(ex):document.body.setAttribute(ex,t.toString())}},[])},aAe=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,i=r===void 0?"margin":r;sAe();var s=P.useMemo(function(){return nAe(i)},[i]);return P.createElement(rAe,{styles:iAe(s,!e,i,n?"":"!important")})},zF=!1;if(typeof window<"u")try{var ZC=Object.defineProperty({},"passive",{get:function(){return zF=!0,!0}});window.addEventListener("test",ZC,ZC),window.removeEventListener("test",ZC,ZC)}catch{zF=!1}var Py=zF?{passive:!1}:!1,oAe=function(t){return t.tagName==="TEXTAREA"},Xse=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!oAe(t)&&n[e]==="visible")},lAe=function(t){return Xse(t,"overflowY")},cAe=function(t){return Xse(t,"overflowX")},t7=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var i=Kse(t,r);if(i){var s=Yse(t,r),a=s[1],o=s[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},uAe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},dAe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Kse=function(t,e){return t==="v"?lAe(e):cAe(e)},Yse=function(t,e){return t==="v"?uAe(e):dAe(e)},hAe=function(t,e){return t==="h"&&e==="rtl"?-1:1},fAe=function(t,e,n,r,i){var s=hAe(t,window.getComputedStyle(e).direction),a=s*r,o=n.target,l=e.contains(o),c=!1,u=a>0,d=0,h=0;do{var f=Yse(t,o),p=f[0],g=f[1],m=f[2],y=g-m-s*p;(p||y)&&Kse(t,o)&&(d+=y,h+=p),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(e.contains(o)||e===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},QC=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},n7=function(t){return[t.deltaX,t.deltaY]},r7=function(t){return t&&"current"in t?t.current:t},pAe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},mAe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},gAe=0,Oy=[];function yAe(t){var e=P.useRef([]),n=P.useRef([0,0]),r=P.useRef(),i=P.useState(gAe++)[0],s=P.useState(qse)[0],a=P.useRef(t);P.useEffect(function(){a.current=t},[t]),P.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(i));var g=F2e([t.lockRef.current],(t.shards||[]).map(r7),!0).filter(Boolean);return g.forEach(function(m){return m.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),g.forEach(function(m){return m.classList.remove("allow-interactivity-".concat(i))})}}},[t.inert,t.lockRef.current,t.shards]);var o=P.useCallback(function(g,m){if("touches"in g&&g.touches.length===2||g.type==="wheel"&&g.ctrlKey)return!a.current.allowPinchZoom;var y=QC(g),x=n.current,b="deltaX"in g?g.deltaX:x[0]-y[0],_="deltaY"in g?g.deltaY:x[1]-y[1],T,E=g.target,C=Math.abs(b)>Math.abs(_)?"h":"v";if("touches"in g&&C==="h"&&E.type==="range")return!1;var I=t7(C,E);if(!I)return!0;if(I?T=C:(T=C==="v"?"h":"v",I=t7(C,E)),!I)return!1;if(!r.current&&"changedTouches"in g&&(b||_)&&(r.current=T),!T)return!0;var A=r.current||T;return fAe(A,m,g,A==="h"?b:_)},[]),l=P.useCallback(function(g){var m=g;if(!(!Oy.length||Oy[Oy.length-1]!==s)){var y="deltaY"in m?n7(m):QC(m),x=e.current.filter(function(T){return T.name===m.type&&(T.target===m.target||m.target===T.shadowParent)&&pAe(T.delta,y)})[0];if(x&&x.should){m.cancelable&&m.preventDefault();return}if(!x){var b=(a.current.shards||[]).map(r7).filter(Boolean).filter(function(T){return T.contains(m.target)}),_=b.length>0?o(m,b[0]):!a.current.noIsolation;_&&m.cancelable&&m.preventDefault()}}},[]),c=P.useCallback(function(g,m,y,x){var b={name:g,delta:m,target:y,should:x,shadowParent:vAe(y)};e.current.push(b),setTimeout(function(){e.current=e.current.filter(function(_){return _!==b})},1)},[]),u=P.useCallback(function(g){n.current=QC(g),r.current=void 0},[]),d=P.useCallback(function(g){c(g.type,n7(g),g.target,o(g,t.lockRef.current))},[]),h=P.useCallback(function(g){c(g.type,QC(g),g.target,o(g,t.lockRef.current))},[]);P.useEffect(function(){return Oy.push(s),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,Py),document.addEventListener("touchmove",l,Py),document.addEventListener("touchstart",u,Py),function(){Oy=Oy.filter(function(g){return g!==s}),document.removeEventListener("wheel",l,Py),document.removeEventListener("touchmove",l,Py),document.removeEventListener("touchstart",u,Py)}},[]);var f=t.removeScrollBar,p=t.inert;return P.createElement(P.Fragment,null,p?P.createElement(s,{styles:mAe(i)}):null,f?P.createElement(aAe,{gapMode:t.gapMode}):null)}function vAe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const xAe=q2e(Gse,yAe);var lM=P.forwardRef(function(t,e){return P.createElement(oM,Eu({},t,{ref:e,sideCar:xAe}))});lM.classNames=oM.classNames;var cM="Popover",[Zse,G3t]=Yl(cM,[W0]),z_=W0(),[bAe,up]=Zse(cM),Qse=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:a=!1}=t,o=z_(e),l=P.useRef(null),[c,u]=P.useState(!1),[d,h]=zf({prop:r,defaultProp:i??!1,onChange:s,caller:cM});return v.jsx(Mse,{...o,children:v.jsx(bAe,{scope:e,contentId:Ud(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:P.useCallback(()=>h(f=>!f),[h]),hasCustomAnchor:c,onCustomAnchorAdd:P.useCallback(()=>u(!0),[]),onCustomAnchorRemove:P.useCallback(()=>u(!1),[]),modal:a,children:n})})};Qse.displayName=cM;var Jse="PopoverAnchor",wAe=P.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=up(Jse,n),s=z_(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=i;return P.useEffect(()=>(a(),()=>o()),[a,o]),v.jsx(rM,{...s,...r,ref:e})});wAe.displayName=Jse;var eae="PopoverTrigger",tae=P.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=up(eae,n),s=z_(n),a=Vn(e,i.triggerRef),o=v.jsx(Wt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":aae(i.open),...r,ref:a,onClick:kt(t.onClick,i.onOpenToggle)});return i.hasCustomAnchor?o:v.jsx(rM,{asChild:!0,...s,children:o})});tae.displayName=eae;var BU="PopoverPortal",[SAe,_Ae]=Zse(BU,{forceMount:void 0}),nae=t=>{const{__scopePopover:e,forceMount:n,children:r,container:i}=t,s=up(BU,e);return v.jsx(SAe,{scope:e,forceMount:n,children:v.jsx(mh,{present:n||s.open,children:v.jsx(L_,{asChild:!0,container:i,children:r})})})};nae.displayName=BU;var Vx="PopoverContent",rae=P.forwardRef((t,e)=>{const n=_Ae(Vx,t.__scopePopover),{forceMount:r=n.forceMount,...i}=t,s=up(Vx,t.__scopePopover);return v.jsx(mh,{present:r||s.open,children:s.modal?v.jsx(EAe,{...i,ref:e}):v.jsx(CAe,{...i,ref:e})})});rae.displayName=Vx;var TAe=hg("PopoverContent.RemoveScroll"),EAe=P.forwardRef((t,e)=>{const n=up(Vx,t.__scopePopover),r=P.useRef(null),i=Vn(e,r),s=P.useRef(!1);return P.useEffect(()=>{const a=r.current;if(a)return zU(a)},[]),v.jsx(lM,{as:TAe,allowPinchZoom:!0,children:v.jsx(iae,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(t.onCloseAutoFocus,a=>{var o;a.preventDefault(),s.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:kt(t.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;s.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:kt(t.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),CAe=P.forwardRef((t,e)=>{const n=up(Vx,t.__scopePopover),r=P.useRef(!1),i=P.useRef(!1);return v.jsx(iae,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=t.onCloseAutoFocus)==null||a.call(t,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),iae=P.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=t,h=up(Vx,n),f=z_(n);return jU(),v.jsx(aM,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:v.jsx(j0,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:v.jsx($U,{"data-state":aae(h.open),role:"dialog",id:h.contentId,...f,...d,ref:e,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),sae="PopoverClose",NAe=P.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=up(sae,n);return v.jsx(Wt.button,{type:"button",...r,ref:e,onClick:kt(t.onClick,()=>i.onOpenChange(!1))})});NAe.displayName=sae;var AAe="PopoverArrow",IAe=P.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,i=z_(n);return v.jsx(LU,{...i,...r,ref:e})});IAe.displayName=AAe;function aae(t){return t?"open":"closed"}var kAe=Qse,MAe=tae,RAe=nae,oae=rae;const i7=kAe,s7=MAe,BF=P.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},i)=>v.jsx(RAe,{children:v.jsx(oae,{ref:i,align:e,sideOffset:n,className:Pt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",t),...r})}));BF.displayName=oae.displayName;const PAe=({toggleSidebar:t,title:e})=>{const[n]=yU(),[r,i]=P.useState(!1),[s,a]=P.useState(!1),o={name:"John Doe",role:"Patient",initials:"JD"},l=()=>{switch(n){case"/":return"Dashboard";case"/profile":return"My Profile";case"/session":return"Therapy Session";case"/progress":return"Progress Reports";case"/exercises":return"Exercises";case"/therapist":return"Therapist Notes";case"/payments":return"Billing & Payments";case"/gutrehab":return"GutrehaB";default:return e}};return v.jsxs("div",{className:"sticky top-0 z-10 bg-white shadow-sm border-b px-4 md:px-8 py-3 flex justify-between items-center",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("button",{onClick:t,className:"md:hidden mr-4 text-neutral-700",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})}),v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:l()})]}),v.jsxs("div",{className:"flex items-center space-x-4",children:[v.jsxs(i7,{open:r,onOpenChange:i,children:[v.jsx(s7,{asChild:!0,children:v.jsx("button",{className:"text-neutral-700 hover:text-primary p-1 rounded-full hover:bg-gray-100",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})})}),v.jsxs(BF,{className:"w-80",children:[v.jsxs("div",{className:"flex justify-between items-center border-b pb-2",children:[v.jsx("h3",{className:"font-medium",children:"Notifications"}),v.jsx("button",{className:"text-sm text-primary hover:text-primary-dark",children:"Mark all as read"})]}),v.jsxs("div",{className:"py-2 max-h-[300px] overflow-auto",children:[v.jsxs("div",{className:"py-2 border-b",children:[v.jsx("p",{className:"font-medium text-sm",children:"Session reminder"}),v.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"You have a therapy session today at 3:00 PM"}),v.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"10 minutes ago"})]}),v.jsxs("div",{className:"py-2 border-b",children:[v.jsx("p",{className:"font-medium text-sm",children:"New exercise added"}),v.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"Your therapist added a new shoulder exercise"}),v.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"2 hours ago"})]}),v.jsxs("div",{className:"py-2",children:[v.jsx("p",{className:"font-medium text-sm",children:"Progress milestone"}),v.jsx("p",{className:"text-xs text-neutral-600 mt-1",children:"Congratulations! You reached 75% recovery"}),v.jsx("p",{className:"text-xs text-neutral-400 mt-1",children:"Yesterday"})]})]}),v.jsx("div",{className:"pt-2 border-t text-center",children:v.jsx("button",{className:"text-sm text-primary hover:text-primary-dark",children:"View all notifications"})})]})]}),v.jsxs(i7,{open:s,onOpenChange:a,children:[v.jsx(s7,{asChild:!0,children:v.jsxs("div",{className:"flex items-center space-x-3 cursor-pointer",children:[v.jsx("div",{className:"h-9 w-9 rounded-full bg-primary-light flex items-center justify-center text-white font-medium",children:o.initials}),v.jsxs("div",{className:"hidden md:block",children:[v.jsx("p",{className:"text-sm font-medium text-neutral-800",children:o.name}),v.jsx("p",{className:"text-xs text-neutral-500",children:o.role})]})]})}),v.jsx(BF,{className:"w-56",children:v.jsxs("div",{className:"px-1 py-2",children:[v.jsxs("div",{className:"mb-3",children:[v.jsx("p",{className:"font-medium",children:o.name}),v.jsx("p",{className:"text-sm text-neutral-600",children:o.role})]}),v.jsxs("div",{className:"space-y-1",children:[v.jsxs("a",{href:"/profile",className:"flex items-center py-1.5 px-2 rounded-md hover:bg-neutral-100 text-sm",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z",clipRule:"evenodd"})}),"Profile Settings"]}),v.jsxs("a",{href:"/payments",className:"flex items-center py-1.5 px-2 rounded-md hover:bg-neutral-100 text-sm",children:[v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:[v.jsx("path",{d:"M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"}),v.jsx("path",{fillRule:"evenodd",d:"M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z",clipRule:"evenodd"})]}),"Billing"]}),v.jsx("div",{className:"pt-2 mt-2 border-t",children:v.jsxs("button",{className:"flex w-full items-center py-1.5 px-2 rounded-md hover:bg-neutral-100 text-sm text-red-600",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z",clipRule:"evenodd"})}),"Sign Out"]})})]})]})})]})]})]})},nd=({children:t,title:e="Dashboard"})=>{const[n,r]=P.useState(!1),i=()=>{r(!n)};return v.jsxs("div",{className:"min-h-screen flex flex-col md:flex-row",children:[v.jsx("div",{className:Pt("md:w-64 md:flex-shrink-0 md:static fixed inset-y-0 left-0 z-20 transition-transform duration-300 transform md:transform-none bg-white md:border-r",n?"translate-x-0":"-translate-x-full"),children:v.jsx(N2e,{})}),n&&v.jsx("div",{className:"fixed inset-0 z-10 bg-black bg-opacity-50 md:hidden",onClick:i}),v.jsxs("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-gray-50",children:[v.jsx(PAe,{toggleSidebar:i,title:e}),v.jsx("div",{className:"p-4 md:p-8",children:t}),v.jsx("footer",{className:"bg-white border-t py-6 px-6 md:px-8",children:v.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-center",children:[v.jsx("div",{className:"text-center md:text-left",children:v.jsx("p",{className:"text-sm text-neutral-600",children:"© 2023 PhysioTrack AI. All rights reserved."})}),v.jsxs("div",{className:"mt-4 md:mt-0 flex justify-center md:justify-end space-x-4",children:[v.jsx("a",{href:"#",className:"text-sm text-neutral-600 hover:text-primary",children:"Privacy Policy"}),v.jsx("a",{href:"#",className:"text-sm text-neutral-600 hover:text-primary",children:"Terms of Service"}),v.jsx("a",{href:"#",className:"text-sm text-neutral-600 hover:text-primary",children:"Contact Us"})]})]})})]})]})},OAe=Jk("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),et=P.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...i},s)=>{const a=r?vie:"button";return v.jsx(a,{className:Pt(OAe({variant:e,size:n,className:t})),ref:s,...i})});et.displayName="Button";const DAe=({userId:t})=>{var m;const{data:e,isLoading:n}=Kr({queryKey:[`/api/users/${t}`]}),{data:r,isLoading:i}=Kr({queryKey:[`/api/sessions/patient/${t}`]}),{data:s,isLoading:a}=Kr({queryKey:[`/api/progress/${t}`]}),{data:o,isLoading:l}=Kr({queryKey:[`/api/engagement/${t}`]}),c=n||i||a||l,u=r==null?void 0:r.find(y=>{const x=new Date(y.date),b=new Date;return x.toDateString()===b.toDateString()}),d=y=>y?new Date(y).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):"Not scheduled",h=s&&s.length>0?Math.round((s[0].rangeOfMotion||0)/180*100):0,f=o&&o.length>0?o[0].sessionsCompleted:0,p=24,g=Math.round(f/p*100);return v.jsx("div",{className:"mb-8 bg-gradient-to-r from-primary to-primary-dark rounded-xl overflow-hidden shadow-md",children:v.jsxs("div",{className:"p-6 md:p-8 text-white",children:[v.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between",children:[v.jsxs("div",{children:[v.jsxs("h1",{className:"text-2xl md:text-3xl font-bold font-heading",children:["Welcome back, ",n?"...":((m=e==null?void 0:e.fullName)==null?void 0:m.split(" ")[0])||"User","!"]}),v.jsx("p",{className:"mt-2 text-blue-100",children:u?`You have a session scheduled today at ${d(u.startTime)}`:"You have no sessions scheduled for today"})]}),v.jsx("div",{className:"mt-4 md:mt-0",children:v.jsx(Lc,{href:"/session",children:v.jsx(et,{className:"bg-white text-primary hover:bg-blue-50 font-medium transition-colors",children:"Start Session"})})})]}),v.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4",children:[v.jsx("p",{className:"text-blue-100 text-sm",children:"Recovery Progress"}),v.jsxs("div",{className:"flex items-center mt-1",children:[v.jsx("span",{className:"text-2xl font-bold",children:c?"...":`${h}%`}),v.jsxs("span",{className:"ml-2 text-green-300 flex items-center text-sm",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"12%"]})]})]}),v.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4",children:[v.jsx("p",{className:"text-blue-100 text-sm",children:"Sessions Completed"}),v.jsxs("div",{className:"flex items-center mt-1",children:[v.jsx("span",{className:"text-2xl font-bold",children:c?"...":`${f}/${p}`}),v.jsx("span",{className:"ml-2 text-blue-100 text-sm",children:c?"...":`${g}%`})]})]}),v.jsxs("div",{className:"bg-white bg-opacity-10 rounded-lg p-4",children:[v.jsx("p",{className:"text-blue-100 text-sm",children:"Est. Full Recovery"}),v.jsxs("div",{className:"flex items-center mt-1",children:[v.jsx("span",{className:"text-2xl font-bold",children:"4 Weeks"}),v.jsxs("span",{className:"ml-2 text-green-300 flex items-center text-sm",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Early"]})]})]})]})]})})},Dt=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));Dt.displayName="Card";const en=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("flex flex-col space-y-1.5 p-6",t),...e}));en.displayName="CardHeader";const tn=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("text-2xl font-semibold leading-none tracking-tight",t),...e}));tn.displayName="CardTitle";const Nr=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("text-sm text-muted-foreground",t),...e}));Nr.displayName="CardDescription";const Lt=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("p-6 pt-0",t),...e}));Lt.displayName="CardContent";const $Ae=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{ref:n,className:Pt("flex items-center p-6 pt-0",t),...e}));$Ae.displayName="CardFooter";const j2=({exercise:t,isNew:e=!1,onClick:n})=>v.jsx(Dt,{className:"exercise-card p-3 border rounded-lg mb-3 hover:border-primary cursor-pointer transition-transform duration-200 hover:-translate-y-1",onClick:n,children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-neutral-800",children:t.name}),v.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:t.description}),v.jsxs("div",{className:"flex items-center flex-wrap mt-2 gap-2",children:[v.jsxs("span",{className:"text-xs font-medium bg-blue-100 text-primary px-2 py-1 rounded flex items-center",children:[v.jsx(EU,{className:"h-3 w-3 mr-1"}),t.sets," sets"]}),v.jsxs("span",{className:"text-xs font-medium bg-blue-100 text-primary px-2 py-1 rounded flex items-center",children:[v.jsx(QEe,{className:"h-3 w-3 mr-1"}),t.reps," reps"]}),v.jsx("span",{className:Pt("text-xs font-medium px-2 py-1 rounded flex items-center",t.difficulty==="easy"?"bg-green-100 text-green-700":t.difficulty==="medium"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"),children:t.difficulty}),e&&v.jsxs("span",{className:"text-xs font-medium bg-green-100 text-green-700 px-2 py-1 rounded flex items-center",children:[v.jsx(YEe,{className:"h-3 w-3 mr-1"}),"New"]})]})]}),v.jsx(Kie,{className:"h-5 w-5 text-neutral-400"})]})}),lae=t=>{const[e,n]=P.useState(!1),[r,i]=P.useState(null),s=P.useRef(null),[a,o]=P.useState(!0);P.useEffect(()=>{!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia?(o(!1),i("Your browser doesn't support camera access. Please try a different browser."),console.error("getUserMedia is not supported in this browser")):o(!0)},[]);const l=P.useCallback(async()=>{if(i(null),!a){i("Your browser doesn't support camera access. Please try Chrome, Firefox, or Edge.");return}if(!t.current){i("Video element is not initialized");return}try{s.current&&s.current.getTracks().forEach(h=>h.stop());let u;try{u=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user",width:{ideal:640},height:{ideal:480}},audio:!1})}catch{console.log("First camera attempt failed, trying basic settings"),u=await navigator.mediaDevices.getUserMedia({video:!0,audio:!1})}s.current=u,t.current.srcObject=u,t.current.onerror=d=>{console.error("Video element error:",d),i("Error with video playback")},await new Promise((d,h)=>{if(!t.current)return h(new Error("Video element not available"));t.current.onloadedmetadata=async()=>{if(t.current)try{await t.current.play(),n(!0),d()}catch(f){h(f)}},setTimeout(()=>{h(new Error("Video loading timed out"))},1e4)})}catch(u){const d=u,h=d.name==="NotAllowedError"?"Camera access denied. Please allow camera access in your browser settings.":`Camera error: ${d.message}`;i(h),console.error("Camera access error:",d)}},[t,a]),c=P.useCallback(()=>{s.current&&(s.current.getTracks().forEach(d=>d.stop()),s.current=null),t.current&&(t.current.srcObject=null),n(!1)},[t]);return P.useEffect(()=>()=>{c()},[c]),{videoReady:e,videoError:r,startWebcam:l,stopWebcam:c}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LAe=1e-7,FAe=1e-4;class cae{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class UU{refCount(e){return eo("refCount")}incRef(e){return eo("incRef")}timerAvailable(){return!0}time(e){return eo("time")}read(e){return eo("read")}readSync(e){return eo("readSync")}readToGPU(e,n){return eo("readToGPU")}numDataIds(){return eo("numDataIds")}disposeData(e,n){return eo("disposeData")}write(e,n,r){return eo("write")}move(e,n,r,i,s){return eo("move")}createTensorFromGPUData(e,n,r){return eo("createTensorFromGPUData")}memory(){return eo("memory")}floatPrecision(){return eo("floatPrecision")}epsilon(){return this.floatPrecision()===32?LAe:FAe}dispose(){return eo("dispose")}}function eo(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jAe(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,fv(t,e,n)}function pg(t,e,n){return Math.max(t,Math.min(e,n))}function VU(t){return t%2===0?t:t+1}function fv(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function zAe(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function q(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function To(t,e,n=""){q(Pn(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function H0(t){q(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Oe(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function BAe(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function Pn(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Wx(t){return t%1===0}function UF(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function tx(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function a7(t,e=i=>0,n,r){return new Promise((i,s)=>{let a=0;const o=()=>{if(t()){i();return}a++;const l=e(a);if(n!=null&&a>=n){s();return}r!=null?r(o,l):setTimeout(o,l)};o()})}function uae(t,e){let n=1,r=-1;for(let s=0;s<t.length;++s)if(t[s]>=0)n*=t[s];else if(t[s]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${s}`);r=s}else if(t[s]<0)throw Error(`Shapes can not be < 0. Found ${t[s]} at dim ${s}`);if(r===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const i=t.slice();return i[r]=e/n,i}function Nn(t,e){const n=e.length;return t=t==null?e.map((r,i)=>i):[].concat(t),q(t.every(r=>r>=-n&&r<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),q(t.every(r=>Wx(r)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(r=>r<0?n+r:r)}function dp(t,e){const n=[],r=[],i=e!=null&&Array.isArray(e)&&e.length===0,s=e==null||i?null:Nn(e,t).sort();let a=0;for(let o=0;o<t.length;++o){if(s!=null){if(s[a]===o&&t[o]!==1)throw new Error(`Can't squeeze axis ${o} since its dim '${t[o]}' is not 1`);(s[a]==null||s[a]>o)&&t[o]===1&&(n.push(t[o]),r.push(o)),s[a]<=o&&a++}t[o]!==1&&(n.push(t[o]),r.push(o))}return{newShape:n,keptDims:r}}function As(t,e){return xi(t,e)}function xi(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function UAe(t,e){for(let n=0;n<t.length;n++){const r=t[n];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function VAe(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function dae(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function OA(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function WAe(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function B_(t){return typeof t=="string"||t instanceof String}function HAe(t){return typeof t=="boolean"}function VF(t){return typeof t=="number"}function G0(t){return Array.isArray(t)?G0(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":VF(t)?"float32":B_(t)?"string":HAe(t)?"bool":"float32"}function WF(t){return!!(t&&t.constructor&&t.call&&t.apply)}function HF(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ft(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let r=e-3;r>=0;--r)n[r]=n[r+1]*t[r+1];return n}function hae(t,e,n,r=!1){const i=new Array;if(e.length===1){const s=e[0]*(r?2:1);for(let a=0;a<s;a++)i[a]=n[t+a]}else{const s=e[0],a=e.slice(1),o=a.reduce((l,c)=>l*c)*(r?2:1);for(let l=0;l<s;l++)i[l]=hae(t+l*o,a,n,r)}return i}function zl(t,e,n=!1){if(t.length===0)return e[0];const r=t.reduce((i,s)=>i*s)*(n?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return hae(0,t,e,n)}function GAe(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function WU(t,e){const n=qs(t,e);for(let r=0;r<n.length;r++)n[r]=1;return n}function qs(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function fae(t,e){const n=t.reduce((r,i)=>r*i,1);if(e==null||e==="float32")return zl(t,new Float32Array(n));if(e==="int32")return zl(t,new Int32Array(n));if(e==="bool")return zl(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function sl(t){t.forEach(e=>{q(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Ou(t,e,n){if(e===0)return 0;if(e===1)return t[0];let r=t[t.length-1];for(let i=0;i<t.length-1;++i)r+=n[i]*t[i];return r}function q0(t,e,n){if(e===0)return[];if(e===1)return[t];const r=new Array(e);for(let i=0;i<r.length-1;++i)r[i]=Math.floor(t/n[i]),t-=r[i]*n[i];return r[r.length-1]=t,r}function mg(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o7="tfjsflags";class qAe{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=XAe,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,r){if(this.flagRegistry[e]={evaluationFn:n,setHook:r},this.urlFlags[e]!=null){const i=this.urlFlags[e];Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${i}.`),this.set(e,i)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(mg(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);o7 in e&&e[o7].split(",").forEach(r=>{const[i,s]=r.split(":");this.urlFlags[i]=YAe(i,s)})}}function XAe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...r)=>(KAe(e,r[0],r[1]),r.join("="))),e}function KAe(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function YAe(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function Me(){return pae}let pae=null;function ZAe(t){pae=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let I$;function mae(){if(I$==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");I$=t}return I$}function QAe(){const t=mae();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function HU(t,e){const n=QAe();if(n.has(t))return n.get(t);{const r=e();return n.set(t,r),n.get(t)}}const uM="Abs",U_="Acos",V_="Acosh",X0="Add",dM="AddN",GU="All",qU="Any",hM="ArgMax",fM="ArgMin",W_="Asin",H_="Asinh",G_="Atan",q_="Atanh",X_="Atan2",pM="AvgPool",XU="AvgPoolGrad",mM="AvgPool3D",KU="AvgPool3DGrad",gM="BatchMatMul",yM="BatchToSpaceND",YU="Bincount",vM="BitwiseAnd",JAe="BroadcastTo",ZU="BroadcastArgs",K_="Cast",Y_="Ceil",Z_="ClipByValue",QU="Complex",xM="ComplexAbs",bM="Concat",wM="Conv2D",JU="Conv2DBackpropFilter",SM="Conv2DBackpropInput",_M="Conv3D",eV="Conv3DBackpropFilterV2",tV="Conv3DBackpropInputV2",Q_="Cos",J_="Cosh",nV="Cumprod",TM="Cumsum",rV="CropAndResize",iV="DenseBincount",sV="DepthToSpace",EM="DepthwiseConv2dNative",aV="DepthwiseConv2dNativeBackpropFilter",oV="DepthwiseConv2dNativeBackpropInput",lV="Diag",CM="Dilation2D",GF="Dilation2DBackpropInput",qF="Dilation2DBackpropFilter",gae="Draw",eT="RealDiv",cV="Einsum",tT="Elu",uV="EluGrad",nT="Erf",NM="Equal",rT="Exp",AM="ExpandDims",iT="Expm1",dV="FFT",hV="Fill",fV="FlipLeftRight",sT="Floor",aT="FloorDiv",IM="FusedBatchNorm",kM="GatherV2",pV="GatherNd",MM="Greater",oT="GreaterEqual",lT="Identity",mV="IFFT",gV="Imag",cT="IsFinite",uT="IsInf",dT="IsNan",RM="LeakyRelu",PM="Less",OM="LessEqual",yV="LinSpace",hT="Log",fT="Log1p",DM="LogicalAnd",$M="LogicalNot",LM="LogicalOr",eIe="LogSoftmax",FM="LRN",vV="LRNGrad",jM="Max",pT="Maximum",zM="MaxPool",xV="MaxPoolGrad",BM="MaxPool3D",bV="MaxPool3DGrad",wV="MaxPoolWithArgmax",UM="Mean",VM="Min",mT="Minimum",WM="MirrorPad",gT="Mod",SV="Multinomial",yT="Multiply",HM="Neg",GM="NotEqual",_V="NonMaxSuppressionV3",TV="NonMaxSuppressionV4",EV="NonMaxSuppressionV5",qM="OnesLike",XM="OneHot",KM="Pack",YM="PadV2",vT="Pow",ZM="Prelu",QM="Prod",CV="RaggedGather",NV="RaggedRange",AV="RaggedTensorToTensor",IV="Range",kV="Real",xT="Reciprocal",bT="Relu",JM="Reshape",eR="ResizeNearestNeighbor",MV="ResizeNearestNeighborGrad",tR="ResizeBilinear",RV="ResizeBilinearGrad",wT="Relu6",nR="Reverse",ST="Round",_T="Rsqrt",PV="ScatterNd",OV="TensorScatterUpdate",DV="SearchSorted",rR="Select",TT="Selu",iR="Slice",ET="Sin",CT="Sinh",NT="Sign",AT="Sigmoid",IT="Softplus",kT="Sqrt",sR="Sum",aR="SpaceToBatchND",oR="SplitV",lR="Softmax",$V="SparseFillEmptyRows",LV="SparseReshape",FV="SparseSegmentMean",jV="SparseSegmentSum",zV="SparseToDense",MT="SquaredDifference",BV="Square",cR="StaticRegexReplace",UV="StridedSlice",VV="StringNGrams",WV="StringSplit",HV="StringToHashBucketFast",RT="Sub",PT="Tan",OT="Tanh",DT="Tile",GV="TopK",qV="Transform",nx="Transpose",XV="Unique",uR="Unpack",dR="UnsortedSegmentSum",hR="ZerosLike",$T="Step",XF="FromPixels",KV="RotateWithOffset",DA="_FusedMatMul",$A="FusedConv2D",LA="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uo(...t){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.warn(...t)}function tIe(...t){Me().getBool("IS_TEST")||Me().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FA=HU("kernelRegistry",()=>new Map),KF=HU("gradRegistry",()=>new Map);function jA(t,e){const n=vae(t,e);return FA.get(n)}function l7(t){return KF.get(t)}function c7(t){const e=FA.entries(),n=[];for(;;){const{done:r,value:i}=e.next();if(r)break;const[s,a]=i,[o]=s.split("_");o===t&&n.push(a)}return n}function yae(t){const{kernelName:e,backendName:n}=t,r=vae(e,n);FA.has(r)&&Uo(`The kernel '${e}' for backend '${n}' is already registered`),FA.set(r,t)}function nIe(t){const{kernelName:e}=t;KF.has(e)&&Me().getBool("DEBUG")&&Uo(`Overriding the gradient for '${e}'`),KF.set(e,t)}function vae(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xae(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var bae=Pr,Rl=null;try{Rl=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function Pr(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}Pr.prototype.__isLong__;Object.defineProperty(Pr.prototype,"__isLong__",{value:!0});function Eo(t){return(t&&t.__isLong__)===!0}Pr.isLong=Eo;var u7={},d7={};function qg(t,e){var n,r,i;return e?(t>>>=0,(i=0<=t&&t<256)&&(r=d7[t],r)?r:(n=Or(t,(t|0)<0?-1:0,!0),i&&(d7[t]=n),n)):(t|=0,(i=-128<=t&&t<128)&&(r=u7[t],r)?r:(n=Or(t,t<0?-1:0,!1),i&&(u7[t]=n),n))}Pr.fromInt=qg;function Pl(t,e){if(isNaN(t))return e?Em:Ol;if(e){if(t<0)return Em;if(t>=wae)return Tae}else{if(t<=-9223372036854776e3)return ho;if(t+1>=iIe)return _ae}return t<0?Pl(-t,e).neg():Or(t%Hx|0,t/Hx|0,e)}Pr.fromNumber=Pl;function Or(t,e,n){return new Pr(t,e,n)}Pr.fromBits=Or;var zA=Math.pow;function YV(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Ol;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var r;if((r=t.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return YV(t.substring(1),e,n).neg();for(var i=Pl(zA(n,8)),s=Ol,a=0;a<t.length;a+=8){var o=Math.min(8,t.length-a),l=parseInt(t.substring(a,a+o),n);if(o<8){var c=Pl(zA(n,o));s=s.mul(c).add(Pl(l))}else s=s.mul(i),s=s.add(Pl(l))}return s.unsigned=e,s}Pr.fromString=YV;function Qc(t,e){return typeof t=="number"?Pl(t,e):typeof t=="string"?YV(t,e):Or(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}Pr.fromValue=Qc;var h7=65536,rIe=1<<24,Hx=h7*h7,wae=Hx*Hx,iIe=wae/2,f7=qg(rIe),Ol=qg(0);Pr.ZERO=Ol;var Em=qg(0,!0);Pr.UZERO=Em;var Rv=qg(1);Pr.ONE=Rv;var Sae=qg(1,!0);Pr.UONE=Sae;var YF=qg(-1);Pr.NEG_ONE=YF;var _ae=Or(-1,2147483647,!1);Pr.MAX_VALUE=_ae;var Tae=Or(-1,-1,!0);Pr.MAX_UNSIGNED_VALUE=Tae;var ho=Or(0,-2147483648,!1);Pr.MIN_VALUE=ho;var ot=Pr.prototype;ot.toInt=function(){return this.unsigned?this.low>>>0:this.low};ot.toNumber=function(){return this.unsigned?(this.high>>>0)*Hx+(this.low>>>0):this.high*Hx+(this.low>>>0)};ot.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(ho)){var n=Pl(e),r=this.div(n),i=r.mul(n).sub(this);return r.toString(e)+i.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var s=Pl(zA(e,6),this.unsigned),a=this,o="";;){var l=a.div(s),c=a.sub(l.mul(s)).toInt()>>>0,u=c.toString(e);if(a=l,a.isZero())return u+o;for(;u.length<6;)u="0"+u;o=""+u+o}};ot.getHighBits=function(){return this.high};ot.getHighBitsUnsigned=function(){return this.high>>>0};ot.getLowBits=function(){return this.low};ot.getLowBitsUnsigned=function(){return this.low>>>0};ot.getNumBitsAbs=function(){if(this.isNegative())return this.eq(ho)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};ot.isZero=function(){return this.high===0&&this.low===0};ot.eqz=ot.isZero;ot.isNegative=function(){return!this.unsigned&&this.high<0};ot.isPositive=function(){return this.unsigned||this.high>=0};ot.isOdd=function(){return(this.low&1)===1};ot.isEven=function(){return(this.low&1)===0};ot.equals=function(e){return Eo(e)||(e=Qc(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};ot.eq=ot.equals;ot.notEquals=function(e){return!this.eq(e)};ot.neq=ot.notEquals;ot.ne=ot.notEquals;ot.lessThan=function(e){return this.comp(e)<0};ot.lt=ot.lessThan;ot.lessThanOrEqual=function(e){return this.comp(e)<=0};ot.lte=ot.lessThanOrEqual;ot.le=ot.lessThanOrEqual;ot.greaterThan=function(e){return this.comp(e)>0};ot.gt=ot.greaterThan;ot.greaterThanOrEqual=function(e){return this.comp(e)>=0};ot.gte=ot.greaterThanOrEqual;ot.ge=ot.greaterThanOrEqual;ot.compare=function(e){if(Eo(e)||(e=Qc(e)),this.eq(e))return 0;var n=this.isNegative(),r=e.isNegative();return n&&!r?-1:!n&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};ot.comp=ot.compare;ot.negate=function(){return!this.unsigned&&this.eq(ho)?ho:this.not().add(Rv)};ot.neg=ot.negate;ot.add=function(e){Eo(e)||(e=Qc(e));var n=this.high>>>16,r=this.high&65535,i=this.low>>>16,s=this.low&65535,a=e.high>>>16,o=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=s+c,h+=f>>>16,f&=65535,h+=i+l,d+=h>>>16,h&=65535,d+=r+o,u+=d>>>16,d&=65535,u+=n+a,u&=65535,Or(h<<16|f,u<<16|d,this.unsigned)};ot.subtract=function(e){return Eo(e)||(e=Qc(e)),this.add(e.neg())};ot.sub=ot.subtract;ot.multiply=function(e){if(this.isZero())return Ol;if(Eo(e)||(e=Qc(e)),Rl){var n=Rl.mul(this.low,this.high,e.low,e.high);return Or(n,Rl.get_high(),this.unsigned)}if(e.isZero())return Ol;if(this.eq(ho))return e.isOdd()?ho:Ol;if(e.eq(ho))return this.isOdd()?ho:Ol;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(f7)&&e.lt(f7))return Pl(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,i=this.high&65535,s=this.low>>>16,a=this.low&65535,o=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=a*u,f+=p>>>16,p&=65535,f+=s*u,h+=f>>>16,f&=65535,f+=a*c,h+=f>>>16,f&=65535,h+=i*u,d+=h>>>16,h&=65535,h+=s*c,d+=h>>>16,h&=65535,h+=a*l,d+=h>>>16,h&=65535,d+=r*u+i*c+s*l+a*o,d&=65535,Or(f<<16|p,d<<16|h,this.unsigned)};ot.mul=ot.multiply;ot.divide=function(e){if(Eo(e)||(e=Qc(e)),e.isZero())throw Error("division by zero");if(Rl){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?Rl.div_u:Rl.div_s)(this.low,this.high,e.low,e.high);return Or(n,Rl.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Em:Ol;var r,i,s;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Em;if(e.gt(this.shru(1)))return Sae;s=Em}else{if(this.eq(ho)){if(e.eq(Rv)||e.eq(YF))return ho;if(e.eq(ho))return Rv;var a=this.shr(1);return r=a.div(e).shl(1),r.eq(Ol)?e.isNegative()?Rv:YF:(i=this.sub(e.mul(r)),s=r.add(i.div(e)),s)}else if(e.eq(ho))return this.unsigned?Em:Ol;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=Ol}for(i=this;i.gte(e);){r=Math.max(1,Math.floor(i.toNumber()/e.toNumber()));for(var o=Math.ceil(Math.log(r)/Math.LN2),l=o<=48?1:zA(2,o-48),c=Pl(r),u=c.mul(e);u.isNegative()||u.gt(i);)r-=l,c=Pl(r,this.unsigned),u=c.mul(e);c.isZero()&&(c=Rv),s=s.add(c),i=i.sub(u)}return s};ot.div=ot.divide;ot.modulo=function(e){if(Eo(e)||(e=Qc(e)),Rl){var n=(this.unsigned?Rl.rem_u:Rl.rem_s)(this.low,this.high,e.low,e.high);return Or(n,Rl.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};ot.mod=ot.modulo;ot.rem=ot.modulo;ot.not=function(){return Or(~this.low,~this.high,this.unsigned)};ot.and=function(e){return Eo(e)||(e=Qc(e)),Or(this.low&e.low,this.high&e.high,this.unsigned)};ot.or=function(e){return Eo(e)||(e=Qc(e)),Or(this.low|e.low,this.high|e.high,this.unsigned)};ot.xor=function(e){return Eo(e)||(e=Qc(e)),Or(this.low^e.low,this.high^e.high,this.unsigned)};ot.shiftLeft=function(e){return Eo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Or(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Or(0,this.low<<e-32,this.unsigned)};ot.shl=ot.shiftLeft;ot.shiftRight=function(e){return Eo(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Or(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Or(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};ot.shr=ot.shiftRight;ot.shiftRightUnsigned=function(e){if(Eo(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var r=this.low;return Or(r>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Or(n,0,this.unsigned):Or(n>>>e-32,0,this.unsigned)};ot.shru=ot.shiftRightUnsigned;ot.shr_u=ot.shiftRightUnsigned;ot.toSigned=function(){return this.unsigned?Or(this.low,this.high,!1):this};ot.toUnsigned=function(){return this.unsigned?this:Or(this.low,this.high,!0)};ot.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};ot.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};ot.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};Pr.fromBytes=function(e,n,r){return r?Pr.fromBytesLE(e,n):Pr.fromBytesBE(e,n)};Pr.fromBytesLE=function(e,n){return new Pr(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};Pr.fromBytesBE=function(e,n){return new Pr(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const Eae=lr(bae),sIe=Dte({__proto__:null,default:Eae},[bae]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gm=Eae||sIe;function fR(t){return gm.fromString(t,!0,16)}const Cae=fR("c3a5c85c97cb3127"),am=fR("b492b66fbe98f273"),ua=fR("9ae16a3b2f90404f");function ZF(t){return t.xor(t.shru(47))}function Nae(t,e,n){const r=t.slice(e,e+n);return gm.fromBytes(Array.from(r),!0,!0)}function Cr(t,e){return Nae(t,e,8)}function p7(t,e){return Nae(t,e,4)}function is(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function If(t,e,n=fR("9ddfea08eb382d69")){let r=t.xor(e).mul(n);r=r.xor(r.shru(47));let i=e.xor(r).mul(n);return i=i.xor(i.shru(47)),i=i.mul(n),i}function aIe(t,e,n,r,i,s){i=i.add(t),s=is(s.add(i).add(r),21);const a=i;return i=i.add(e),i=i.add(n),s=s.add(is(i,44)),[i.add(r),s.add(a)]}function JC(t,e,n,r){return aIe(Cr(t,e),Cr(t,e+8),Cr(t,e+16),Cr(t,e+24),n,r)}function oIe(t,e=t.length){if(e>=8){const n=ua.add(e*2),r=Cr(t,0).add(ua),i=Cr(t,e-8),s=is(i,37).mul(n).add(r),a=is(r,25).add(i).mul(n);return If(s,a,n)}if(e>=4){const n=ua.add(e*2),r=p7(t,0);return If(r.shl(3).add(e),p7(t,e-4),n)}if(e>0){const n=t[0],r=t[e>>1],i=t[e-1],s=n+(r<<8),a=e+(i<<2);return ZF(ua.mul(s).xor(Cae.mul(a))).mul(ua)}return ua}function lIe(t,e=t.length){const n=ua.add(e*2),r=Cr(t,0).mul(am),i=Cr(t,8),s=Cr(t,e-8).mul(n),a=Cr(t,e-16).mul(ua);return If(is(r.add(i),43).add(is(s,30)).add(a),r.add(is(i.add(ua),18)).add(s),n)}function cIe(t,e=t.length){const n=ua.add(e*2),r=Cr(t,0).mul(ua),i=Cr(t,8),s=Cr(t,e-8).mul(n),a=Cr(t,e-16).mul(ua),o=is(r.add(i),43).add(is(s,30)).add(a),l=If(o,r.add(is(i.add(ua),18)).add(s),n),c=Cr(t,16).mul(n),u=Cr(t,24),d=o.add(Cr(t,e-32)).mul(n),h=l.add(Cr(t,e-24)).mul(n);return If(is(c.add(u),43).add(is(d,30)).add(h),c.add(is(u.add(r),18)).add(d),n)}function uIe(t,e=t.length){const n=gm.fromNumber(81,!0);if(e<=32)return e<=16?oIe(t,e):lIe(t,e);if(e<=64)return cIe(t,e);let r=n,i=n.mul(am).add(113),s=ZF(i.mul(ua).add(113)).mul(ua),a=[gm.UZERO,gm.UZERO],o=[gm.UZERO,gm.UZERO];r=r.mul(ua).add(Cr(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do r=is(r.add(i).add(a[0]).add(Cr(t,l+8)),37).mul(am),i=is(i.add(a[1]).add(Cr(t,l+48)),42).mul(am),r=r.xor(o[1]),i=i.add(a[0]).add(Cr(t,l+40)),s=is(s.add(o[0]),33).mul(am),a=JC(t,l,a[1].mul(am),r.add(o[0])),o=JC(t,l+32,s.add(o[1]),i.add(Cr(t,l+16))),[s,r]=[r,s],l+=64;while(l!==c);const d=am.add(s.and(255).shl(1));return l=u,o[0]=o[0].add(e-1&63),a[0]=a[0].add(o[0]),o[0]=o[0].add(a[0]),r=is(r.add(i).add(a[0]).add(Cr(t,l+8)),37).mul(d),i=is(i.add(a[1]).add(Cr(t,l+48)),42).mul(d),r=r.xor(o[1].mul(9)),i=i.add(a[0].mul(9).add(Cr(t,l+40))),s=is(s.add(o[0]),33).mul(d),a=JC(t,l,a[1].mul(d),r.add(o[0])),o=JC(t,l+32,s.add(o[1]),i.add(Cr(t,l+16))),[s,r]=[r,s],If(If(a[0],o[0],d).add(ZF(i).mul(Cae)).add(s),If(a[1],o[1],d).add(r),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hp(t,e){return e==="string"?kf(t):Xg([t],e)}function dIe(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Xg(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=gg(t)),Me().getBool("DEBUG")&&UAe(t,e),dIe(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let r=0;r<n.length;++r)Math.round(t[r])!==0&&(n[r]=1);return n}else throw new Error(`Unknown data type ${e}`)}function Oa(){return Me().platform.now()}function kf(t,e="utf-8"){return e=e||"utf-8",Me().platform.encode(t,e)}function Vf(t,e="utf-8"){return e=e||"utf-8",Me().platform.decode(t,e)}function Gl(t){return Me().platform.isTypedArray!=null?Me().platform.isTypedArray(t):xae(t)}function gg(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||mg(t)||t==null||Gl(t)&&n)e.push(t);else if(Array.isArray(t)||Gl(t))for(let r=0;r<t.length;++r)gg(t[r],e,n);else{let r=-1;for(const i of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(i)&&(r=Math.max(r,Number(i)));for(let i=0;i<=r;i++)gg(t[i],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hIe{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new pIe)}profileKernel(e,n,r){let i;const s=()=>{i=r()};let a;const o=Oa();if(this.backendTimer.timerAvailable())a=this.backendTimer.time(s);else{s();for(const c of i)c.dataSync();a=Promise.resolve({kernelMs:Oa()-o})}if(Me().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<i.length;c++){const u=i[c];u.data().then(d=>{fIe(d,u.dtype,e)})}return{kernelName:e,outputs:i,inputs:n,timeMs:a.then(c=>c.kernelMs),extraInfo:a.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:r,timeMs:i,inputs:s,extraInfo:a}=e;r.forEach(o=>{Promise.all([o.data(),i,a]).then(l=>{this.logger.logKernelProfile(n,o,l[0],l[1],s,l[2])})})}}function fIe(t,e,n){if(e!=="float32")return!1;for(let r=0;r<t.length;r++){const i=t[r];if(isNaN(i)||!isFinite(i))return console.warn(`Found ${i} in the result of '${n}'`),!0}return!1}class pIe{logKernelProfile(e,n,r,i,s,a){const o=typeof i=="number"?tx(`${i}ms`,9):i.error,l=tx(e,25),c=n.rank,u=n.size,d=tx(n.shape.toString(),14);let h="";for(const f in s){const p=s[f];if(p!=null){const g=p.shape||n.shape,m=g.length;h+=`${f}: ${m}D ${m>0?g:""} `}}console.log(`%c${l}	%c${o}	%c${c}D ${d}	%c${u}	%c${h}	%c${a}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mIe(t,e,n){const r={},i={};for(let l=0;l<e.length;l++)r[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(r[h.id]){c.outputs.forEach(g=>r[g.id]=!0),f=!0,i[c.id]=!0;break}if(f)break}}const s={};s[n.id]=!0;const a={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(s[c.outputs[d].id]){for(const h in u)s[u[h].id]=!0,a[c.id]=!0;break}}const o=[];for(let l=0;l<t.length;l++){const c=t[l];if(i[c.id]&&a[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];r[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,o.push(d)}}return o}function gIe(t,e,n,r){for(let i=e.length-1;i>=0;i--){const s=e[i],a=[];if(s.outputs.forEach(l=>{const c=t[l.id];c!=null?a.push(c):a.push(null)}),s.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${s.kernelName}.`);const o=s.gradient(a);for(const l in s.inputs){if(!(l in o))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(o)}.`);const c=n(()=>o[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=s.inputs[l];if(!Pn(c.shape,u.shape))throw new Error(`Error in gradient for op ${s.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=r(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m7=20,ow=3,k$=7;function yIe(t,e,n,r){const i=Ft(e),s=vIe(t,e,n,i),a=e.length,o=z2(t,e,n,i,s),l=["Tensor"];return r&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${a}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(o.map(c=>"    "+c).join(`
`)),l.join(`
`)}function vIe(t,e,n,r){const i=Oe(e),s=r[r.length-1],a=new Array(s).fill(0),o=e.length,l=n==="complex64"?Vw(t):t;if(o>1)for(let c=0;c<i/s;c++){const u=c*s;for(let d=0;d<s;d++)a[d]=Math.max(a[d],Uw(l[u+d],0,n).length)}return a}function Uw(t,e,n){let r;return Array.isArray(t)?r=`${parseFloat(t[0].toFixed(k$))} + ${parseFloat(t[1].toFixed(k$))}j`:B_(t)?r=`'${t}'`:n==="bool"?r=Aae(t):r=parseFloat(t.toFixed(k$)).toString(),tx(r,e)}function Aae(t){return t===0?"false":"true"}function z2(t,e,n,r,i,s=!0){const a=n==="complex64"?2:1,o=e[0],l=e.length;if(l===0){if(n==="complex64"){const g=Vw(t);return[Uw(g[0],0,n)]}return n==="bool"?[Aae(t[0])]:[t[0].toString()]}if(l===1){if(o>m7){const m=ow*a;let y=Array.from(t.slice(0,m)),x=Array.from(t.slice((o-ow)*a,o*a));return n==="complex64"&&(y=Vw(y),x=Vw(x)),["["+y.map((b,_)=>Uw(b,i[_],n)).join(", ")+", ..., "+x.map((b,_)=>Uw(b,i[o-ow+_],n)).join(", ")+"]"]}return["["+(n==="complex64"?Vw(t):Array.from(t)).map((m,y)=>Uw(m,i[y],n)).join(", ")+"]"]}const c=e.slice(1),u=r.slice(1),d=r[0]*a,h=[];if(o>m7){for(let g=0;g<ow;g++){const m=g*d,y=m+d;h.push(...z2(t.slice(m,y),c,n,u,i,!1))}h.push("...");for(let g=o-ow;g<o;g++){const m=g*d,y=m+d;h.push(...z2(t.slice(m,y),c,n,u,i,g===o-1))}}else for(let g=0;g<o;g++){const m=g*d,y=m+d;h.push(...z2(t.slice(m,y),c,n,u,i,g===o-1))}const f=l===2?",":"";h[0]="["+(o>0?h[0]+f:"");for(let g=1;g<h.length-1;g++)h[g]=" "+h[g]+f;let p=`,
`;for(let g=2;g<l;g++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(s?"":p),h}function Vw(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hi{constructor(e,n,r){if(this.dtype=n,this.shape=e.slice(),this.size=Oe(e),r!=null){const i=r.length;q(i===this.size,()=>`Length of values '${i}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||xi(n,this.size),this.strides=Ft(e)}set(e,...n){n.length===0&&(n=[0]),q(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const r=this.locToIndex(n);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const i of e){if(i<0||i>=this.shape[n]){const s=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(s)}n++}let r=e[e.length-1];for(let i=0;i<e.length-1;++i)r+=this.strides[i]*e[i];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let r=0;r<n.length-1;++r)n[r]=Math.floor(e/this.strides[r]),e-=n[r]*this.strides[r];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Sc().makeTensor(this.values,this.shape,this.dtype)}}let Sc=null,pv=null;function xIe(t){Sc=t}function bIe(t){pv=t}class rr{constructor(e,n,r,i){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Oe(e),this.strides=Ft(e),this.dataId=r,this.id=i,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return pv.buffer(this.shape,this.dtype,e)}bufferSync(){return pv.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return zl(this.shape,e,this.dtype==="complex64")}arraySync(){return zl(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Sc().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(r=>Vf(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Sc().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Sc().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Vf(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Sc().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Sc().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return pv.print(this,e)}clone(){return this.throwIfDisposed(),pv.clone(this)}toString(e=!1){const n=this.dataSync();return yIe(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),pv.cast(this,e)}variable(e=!0,n,r){return this.throwIfDisposed(),Sc().makeVariable(this,e,n,r)}}Object.defineProperty(rr,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function je(){return HU("Tensor",()=>rr)}je();class BA extends rr{constructor(e,n,r,i){super(e.shape,e.dtype,e.dataId,i),this.trainable=n,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Pn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Sc().disposeTensor(this),this.dataId=e.dataId,Sc().incRef(this,null)}dispose(){Sc().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(BA,Symbol.hasInstance,{value:t=>t instanceof rr&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var g7;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(g7||(g7={}));var QF;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(QF||(QF={}));var JF;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(JF||(JF={}));var ej;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(ej||(ej={}));var tj;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(tj||(tj={}));const wIe={float32:ej,int32:QF,bool:JF,complex64:tj};function bo(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return wIe[t][e]}function ZV(t){return bo(t,"int32")}function Iae(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function kae(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(t,e){if(t.dtype===e.dtype)return[t,e];const n=bo(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function SIe(t,e){q(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function Mae(t){const e=[];return Rae(t,e,new Set),e}function Rae(t,e,n){if(t==null)return;if(t instanceof rr){e.push(t);return}if(!_Ie(t))return;const r=t;for(const i in r){const s=r[i];n.has(s)||(n.add(s),Rae(s,e,n))}}function _Ie(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$(t){return t.kernelName!=null}class y7{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Gx{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new y7}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,r=1){return e in this.registryFactory?(Uo(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:r}=this.initializeBackend(e);if(!(r?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new hIe(this.backendInstance),!0}setupRegisteredKernels(){c7(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){c7(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=n.factory();if(r&&!(r instanceof UU)&&typeof r.then=="function"){const i=++this.pendingBackendInitId,s=r.then(a=>i<this.pendingBackendInitId?!1:(this.registry[e]=a,this.pendingBackendInit=null,!0)).catch(a=>(i<this.pendingBackendInitId||(this.pendingBackendInit=null,Uo(`Initialization of backend ${e} failed`),Uo(a.stack||a.message)),!1));return this.pendingBackendInit=s,{success:s,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Uo(`Initialization of backend ${e} failed`),Uo(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const r=e[n],{success:i,asyncInit:s}=this.initializeBackend(r);if(s||i)return{name:r,asyncInit:s}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const r=this.state.tensorInfo.get(n),i=r.backend,s=this.readSync(n),a=i.refCount(n);i.disposeData(n,!0),r.backend=e,e.move(n,s,r.shape,r.dtype,a),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let r=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let i;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(i),()=>(i=n(),i instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),i))}scopedRun(e,n,r){e();try{const i=r();return n(),i}catch(i){throw n(),i}}nextTensorId(){return Gx.nextTensorId++}nextVariableId(){return Gx.nextVariableId++}clone(e){const n=ue.runKernel(lT,{x:e}),r={x:e},i=a=>({x:()=>{const o="float32",l={x:a},c={dtype:o};return ue.runKernel(K_,l,c)}}),s=[];return this.addTapeNode(this.state.activeScope.name,r,[n],i,s,{}),n}runKernel(e,n,r){if(this.backendName==null&&this.backend,!(jA(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,r){const i=this.backend.numDataIds();let s=0;r.forEach(l=>{s+=l.dtype==="complex64"?3:1});const a=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=i-n-s-a;if(o>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${o} data ids) after running '${e}'`)}runKernelFunc(e){let n,r=[];const i=this.isTapeOn(),s=this.state.numBytes,a=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let o;this.backendName==null&&this.backend;let l;const c=M$(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(M$(e)){const{kernelName:p,inputs:g,attrs:m}=e;this.backendName==null&&this.backend;const y=jA(p,this.backendName);q(y!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),o=()=>{const x=this.backend.numDataIds();l=y.kernelFunc({inputs:g,attrs:m,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,x,b);const _=b.map(T=>T.rank!=null?T:this.makeTensorFromTensorInfo(T));if(i){const T=this.getTensorsForGradient(p,g,_);r=this.saveTensorsForBackwardMode(T)}return _}}else{const{forwardFunc:p}=e,g=m=>{i&&(r=m.map(y=>this.keep(this.clone(y))))};o=()=>{const m=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,g));const y=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,m,y),y}}const{inputs:u,attrs:d}=e,h=M$(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=o():(f=this.profiler.profileKernel(c,u,()=>o()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),i&&this.addTapeNode(c,u,n,h,r,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-a,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,n,r){const i=l7(e);if(i!=null){const s=i.inputsToSave||[],a=i.outputsToSave||[];let o;i.saveAllInputs?(q(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),o=Object.keys(n).map(c=>n[c])):o=s.map(c=>n[c]);const l=r.filter((c,u)=>a[u]);return o.concat(l)}return[]}makeTensor(e,n,r,i){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",i=i||this.backend;let s=e;r==="string"&&B_(e[0])&&(s=e.map(l=>kf(l)));const a=i.write(s,n,r),o=new rr(n,r,a,this.nextTensorId());if(this.trackTensor(o,i),r==="string"){const l=this.state.tensorInfo.get(a),c=WAe(s);this.state.numBytes+=c-l.bytes,l.bytes=c}return o}makeTensorFromDataId(e,n,r,i){r=r||"float32";const s={dataId:e,shape:n,dtype:r};return this.makeTensorFromTensorInfo(s,i)}makeTensorFromTensorInfo(e,n){const{dataId:r,shape:i,dtype:s}=e,a=new rr(i,s,r,this.nextTensorId());return this.trackTensor(a,n),a}makeVariable(e,n=!0,r,i){r=r||this.nextVariableId().toString(),i!=null&&i!==e.dtype&&(e=e.cast(i));const s=new BA(e,n,r,this.nextTensorId());if(this.state.registeredVariables[s.name]!=null)throw new Error(`Variable with name ${s.name} was already registered`);return this.state.registeredVariables[s.name]=s,this.incRef(s,this.backend),s}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*OA(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof BA||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*OA(e.dtype);this.state.numBytes-=r}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(i=>i.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const i of this.state.activeProfile.kernels)i.kernelTimeMs=await i.kernelTimeMs,i.extraInfo=await i.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,r,i,s,a){const o={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:r,saved:s},l=l7(e);l!=null&&(i=l.gradFunc),i!=null&&(o.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=r[d],f=qs(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),i(c.length>1?c:c[0],s,a))),this.state.activeTape.push(o)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Mae(e),r=new Set(n.map(s=>s.id));for(let s=0;s<this.state.activeScope.track.length;s++){const a=this.state.activeScope.track[s];!a.kept&&!r.has(a.id)&&a.dispose()}const i=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(s=>{!s.kept&&s.scopeId===i.id&&this.track(s)})}gradients(e,n,r,i=!1){if(q(n.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const s=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));q(s instanceof rr,()=>"The result y returned by f() must be a tensor.");const a=mIe(this.state.activeTape,n,s);if(!i&&a.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const o={};o[s.id]=r??TIe(s.shape),gIe(o,a,c=>this.tidy(c),EIe);const l=n.map(c=>o[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:s,grads:l}})}customGrad(e){return q(WF(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{q(n.every(o=>o instanceof rr),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const i={};n.forEach((o,l)=>{i[l]=o});const s=(o,l)=>(r=e(...n,l),q(r.value instanceof rr,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),q(WF(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),a=(o,l)=>{const c=r.gradFunc(o,l),u=Array.isArray(c)?c:[c];q(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),q(u.every(h=>h instanceof rr),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:s,backwardsFunc:a,inputs:i})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=Oa(),r=await this.backend.time(e);return r.wallMs=Oa()-n,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new y7;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Gx.nextTensorId=0;Gx.nextVariableId=0;function TIe(t){const e=WU(Oe(t),"float32");return ue.makeTensor(e,t,"float32")}function Pae(){const t=mae();if(t._tfengine==null){const e=new qAe(t);t._tfengine=new Gx(e)}return ZAe(t._tfengine.ENV),xIe(()=>t._tfengine),t._tfengine}const ue=Pae();function EIe(t,e){const n={a:t,b:e};return ue.runKernel(X0,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CIe(){return typeof navigator<"u"&&navigator!=null}function Oae(t){if(t||CIe()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function Dae(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wa=Me();Wa.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Wa.registerFlag("IS_BROWSER",()=>Dae());Wa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Wa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Wa.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Wa.registerFlag("PROD",()=>!1);Wa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Wa.getBool("DEBUG"));Wa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Wa.registerFlag("IS_TEST",()=>!1);Wa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Wa.getBool("DEBUG"));Wa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Wa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Wa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fp(t,e){let n=t;if(Gl(t))return e==="string"?[]:[t.length];if(Iae(t)){const i=t.channels||"RGBA";return[t.height,t.width*i.length]}else if(kae(t))return[t.buffer.size/(e==null?4:OA(e))];if(!Array.isArray(t))return[];const r=[];for(;Array.isArray(n)||Gl(n)&&e!=="string";)r.push(n.length),n=n[0];return Array.isArray(t)&&Me().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&$ae(t,r,[]),r}function $ae(t,e,n){if(n=n||[],!Array.isArray(t)&&!Gl(t)){q(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}q(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),q(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const r=e.slice(1);for(let i=0;i<t.length;++i)$ae(t[i],r,n.concat(i))}function v7(t,e,n,r){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${r}' must be ${t} tensor, but got ${e} tensor`)}}function Y(t,e,n,r="numeric"){if(t instanceof je())return v7(r,t.dtype,e,n),t;let i=G0(t);if(i!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(i=r),v7(r,i,e,n),t==null||!Gl(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const s=fp(t,i);!Gl(t)&&!Array.isArray(t)&&(t=[t]);const o=i!=="string"?Xg(t,i):gg(t,[],!0);return ue.makeTensor(o,s,i)}function UA(t,e,n,r="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((s,a)=>Y(s,`${e}[${a}]`,n,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lae="__op";function ce(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const r=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+Lae;const i=(...s)=>{ue.startScope(n);try{const a=r(...s);return mg(a)&&console.error("Cannot return a Promise inside of tidy."),ue.endScope(a),a}catch(a){throw ue.endScope(null),a}};return Object.defineProperty(i,"name",{value:n,configurable:!0}),i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NIe(t,e){const n=Y(t,"real","complex"),r=Y(e,"imag","complex");To(n.shape,r.shape,`real and imag shapes, ${n.shape} and ${r.shape}, must match in call to tf.complex().`);const i={real:n,imag:r};return ue.runKernel(QU,i)}const Wf=ce({complex_:NIe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pp(t,e,n,r){if(r==null)r=G0(t);else if(r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(kae(t)||Iae(t)){if(r!=="float32"&&r!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${r}.`);return ue.backend.createTensorFromGPUData(t,e||n,r)}if(!Gl(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){sl(e);const i=Oe(e),s=Oe(n);q(i===s,()=>`Based on the provided shape, [${e}], the tensor should have ${i} values but has ${s}`);for(let a=0;a<n.length;++a){const o=n[a],l=a===n.length-1?o!==Oe(e.slice(a)):!0;q(n[a]===e[a]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Gl(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=r!=="string"?Xg(t,r):gg(t,[],!0),ue.makeTensor(t,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fc(t,e,n){const r=fp(t,n);return pp(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yg={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class Jc{static join(e){return new Jc(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(r=>Gl(r)?r.buffer:r),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let r=0;r<e.length;r++){const i=e[r];r!==e.length-1&&i.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const s=n+i.byteLength;this.shards.push({buffer:i,start:n,end:s}),n=s}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const r=this.findShardForByte(e);if(r===-1)throw new Error(`Could not find start shard for byte ${e}`);const i=n-e,s=new ArrayBuffer(i),a=new Uint8Array(s);let o=0;for(let l=r;l<this.shards.length;l++){const c=this.shards[l],d=e+o-c.start,h=o,p=Math.min(n,c.end)-c.start,g=new Uint8Array(c.buffer,d,p-d);if(a.set(g,h),o+=g.length,n<c.end)break}return s}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(i){return e<i.start?-1:e>=i.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const r=AIe(this.shards,n);return r===-1?-1:(this.previousShardIndex=r,this.previousShardIndex)}}function AIe(t,e){let n=0,r=t.length;for(;n<=r;){const i=Math.floor((r-n)/2)+n,s=e(t[i]);if(s===0)return i;s<0?r=i:n=i+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fo(){return ue}function x7(){return ue.memory()}function ve(t,e){return ue.tidy(t,e)}function Bt(t){Mae(t).forEach(n=>n.dispose())}function as(t){return ue.keep(t)}function IIe(t){return ue.setBackend(t)}function kIe(){return ue.ready()}function q1(){return ue.backendName}function Fae(t,e,n=1){return ue.registerBackend(t,e,n)}function vg(){return ue.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hf=4;async function nj(t,e){const n=[],r=[],i=Array.isArray(t)?t.map(a=>a.name):Object.keys(t);for(let a=0;a<i.length;++a){const o=i[a],l=Array.isArray(t)?t[a].tensor:t[o];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${o}': ${l.dtype}`);const c={name:o,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((m,y)=>m+y.length,0)+Hf*h.length,p=new Uint8Array(f);let g=0;for(let m=0;m<h.length;m++){const y=h[m],x=new Uint8Array(new Uint32Array([y.length]).buffer);p.set(x,g),g+=Hf,p.set(y,g),g+=y.length}d(p)});r.push(u)}else r.push(l.data());e!=null&&(c.group=e),n.push(c)}const s=await Promise.all(r);return{data:PIe(s),specs:n}}function jae(t,e){const n=new Jc(t),r={};let i=0;for(const s of e){const a=MIe(s,(o,l)=>n.slice(i+o,i+l));r[s.name]=zae(s,n.slice(i,i+a)),i+=a}return r}function MIe(t,e){const n=Oe(t.shape);let r;if("quantization"in t){const i=t.quantization;r=yg[i.dtype]}else if(t.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=Hf+new Uint32Array(e(i,i+Hf))[0];return i}else r=yg[t.dtype];return n*r}async function RIe(t,e){const n=Oe(t.shape);let r;if("quantization"in t){const i=t.quantization;r=yg[i.dtype]}else if(t.dtype==="string"){let i=0;for(let s=0;s<n;s++)i+=Hf+new Uint32Array(await e(i,i+Hf))[0];return i}else r=yg[t.dtype];return n*r}function zae(t,e){const n=t.name,r=t.dtype,i=t.shape,s=Oe(i);let a,o=0;if("quantization"in t){const l=t.quantization;if(l.dtype==="uint8"||l.dtype==="uint16"){if(!("min"in l&&"scale"in l))throw new Error(`Weight ${t.name} with quantization ${l.dtype} doesn't have corresponding metadata min and scale.`)}else if(l.dtype==="float16"){if(r!=="float32")throw new Error(`Weight ${t.name} is quantized with ${l.dtype} which only supports weights of type float32 not ${r}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${l.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const c=yg[l.dtype],u=l.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(r==="float32")if(l.dtype==="uint8"||l.dtype==="uint16"){a=new Float32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];a[d]=h*l.scale+l.min}}else if(l.dtype==="float16")a=jIe()(u);else throw new Error(`Unsupported quantization type ${l.dtype} for weight type float32.`);else if(r==="int32"){if(l.dtype!=="uint8"&&l.dtype!=="uint16")throw new Error(`Unsupported quantization type ${l.dtype} for weight type int32.`);a=new Int32Array(u.length);for(let d=0;d<u.length;d++){const h=u[d];a[d]=Math.round(h*l.scale+l.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=s*c}else if(r==="string"){const l=Oe(t.shape);a=[];for(let c=0;c<l;c++){const u=new Uint32Array(e.slice(o,o+Hf))[0];o+=Hf;const d=new Uint8Array(e.slice(o,o+u));a.push(d),o+=u}}else{const l=yg[r];if(r==="float32")a=new Float32Array(e);else if(r==="int32")a=new Int32Array(e);else if(r==="bool")a=new Uint8Array(e);else if(r==="complex64"){a=new Float32Array(e);const c=new Float32Array(a.length/2),u=new Float32Array(a.length/2);for(let p=0;p<c.length;p++)c[p]=a[p*2],u[p]=a[p*2+1];const d=Fc(c,i,"float32"),h=Fc(u,i,"float32"),f=Wf(d,h);return d.dispose(),h.dispose(),f}else throw new Error(`Unsupported dtype in weight '${n}': ${r}`);o+=s*l}return Fc(a,i,r)}async function b7(t,e,n){let r=new Uint8Array(e);for(;r.byteLength<n;){const{done:i,value:s}=await t.read();if(i&&s==null){const o=n-r.byteLength;throw new Error(`Reader is done but ${o} bytes are still expected`)}const a=new Uint8Array(r.length+s.byteLength);a.set(r,0),a.set(new Uint8Array(s),r.length),r=a}return r.buffer}async function Bae(t,e){const n={},r=t.getReader();let i=new ArrayBuffer(0);for(const s of e){const a=await RIe(s,async(c,u)=>(i=await b7(r,i,u),i.slice(c,u)));i=await b7(r,i,a);const o=i.slice(0,a);i=i.slice(a);const l=zae(s,o);if(n[s.name]=l,q1()==="webgpu"){const c=vg();"uploadToGPU"in c&&Oe(l.shape)>=Me().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&c.uploadToGPU(l.dataId)}}return n}function PIe(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(s=>{if(e+=s.byteLength,n.push(s.byteLength===s.buffer.byteLength?s:new s.constructor(s)),!(s instanceof Float32Array||s instanceof Int32Array||s instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${s.constructor.name}`)});const r=new Uint8Array(e);let i=0;return n.forEach(s=>{r.set(new Uint8Array(s.buffer),i),i+=s.byteLength}),r.buffer}const QV=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function w7(t){return QV?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function OIe(t){if(QV)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);return btoa(n)}function DIe(t){if(QV){const r=Buffer.from(t,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let r=0;r<e.length;++r)n.set([e.charCodeAt(r)],r);return n.buffer}function Uae(t){return Jc.join(t)}function S7(t){const e="/";for(t=t.trim();t.endsWith(e);)t=t.slice(0,t.length-1);const n=t.split(e);return n[n.length-1]}function Vae(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function Wae(t,e,n){const r={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(r.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=n}return t.signature!=null&&(r.signature=t.signature),t.userDefinedMetadata!=null&&(r.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(r.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(r.initializerSignature=t.initializerSignature),r}async function JV(t,e){let n,r;return t.weightsManifest!=null&&([n,r]=await e(t.weightsManifest)),Wae(t,n,r)}function LT(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:w7(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:w7(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new Jc(t.weightData).byteLength}}function rj(t){const e=[];for(const n of t)e.push(...n.weights);return e}function $Ie(){const t=n=>{let r=n<<13,i=0;for(;!(r&8388608);)i-=8388608,r<<=1;return r&=-8388609,i+=947912704,r|i},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function LIe(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function FIe(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function jIe(){const t=$Ie(),e=LIe(),n=FIe();return r=>{const i=new ArrayBuffer(4*r.length),s=new Uint32Array(i);for(let a=0;a<r.length;a++){const o=r[a],l=t[n[o>>10]+(o&1023)]+e[o>>10];s[a]=l}return new Float32Array(i)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gr{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return Gr.instance==null&&(Gr.instance=new Gr),Gr.instance}static registerSaveRouter(e){Gr.getInstance().saveRouters.push(e)}static registerLoadRouter(e){Gr.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return Gr.getHandlers(e,"save")}static getLoadHandlers(e,n){return Gr.getHandlers(e,"load",n)}static getHandlers(e,n,r){const i=[];return(n==="load"?Gr.getInstance().loadRouters:Gr.getInstance().saveRouters).forEach(a=>{const o=a(e,r);o!==null&&i.push(o)}),i}}const zIe=t=>Gr.registerSaveRouter(t),BIe=t=>Gr.registerLoadRouter(t),Hae=t=>Gr.getSaveHandlers(t),UIe=(t,e)=>Gr.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ij="tensorflowjs",sj=1,Cm="models_store",mf="model_info_store";function Gae(){if(!Me().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function aj(t){const e=t.result;e.createObjectStore(Cm,{keyPath:"modelPath"}),e.createObjectStore(mf,{keyPath:"modelPath"})}class xg{constructor(e){if(this.indexedDB=Gae(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((r,i)=>{const s=this.indexedDB.open(ij,sj);s.onupgradeneeded=()=>aj(s),s.onsuccess=()=>{const a=s.result;if(n==null){const o=a.transaction(Cm,"readonly"),c=o.objectStore(Cm).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return a.close(),i(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=u=>(a.close(),i(c.error)),o.oncomplete=()=>a.close()}else{n.weightData=Jc.join(n.weightData);const o=LT(n),l=a.transaction(mf,"readwrite");let c=l.objectStore(mf),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:o})}catch(h){return i(h)}let d;u.onsuccess=()=>{d=a.transaction(Cm,"readwrite");const h=d.objectStore(Cm);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:o})}catch(p){return i(p)}f.onsuccess=()=>r({modelArtifactsInfo:o}),f.onerror=p=>{c=l.objectStore(mf);const g=c.delete(this.modelPath);g.onsuccess=()=>(a.close(),i(f.error)),g.onerror=m=>(a.close(),i(f.error))}},u.onerror=h=>(a.close(),i(u.error)),l.oncomplete=()=>{d==null?a.close():d.oncomplete=()=>a.close()}}},s.onerror=a=>i(s.error)})}}xg.URL_SCHEME="indexeddb://";const qae=t=>Me().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(xg.URL_SCHEME)?VIe(t.slice(xg.URL_SCHEME.length)):null;Gr.registerSaveRouter(qae);Gr.registerLoadRouter(qae);function VIe(t){return new xg(t)}function WIe(t){return t.startsWith(xg.URL_SCHEME)?t.slice(xg.URL_SCHEME.length):t}class HIe{constructor(){this.indexedDB=Gae()}async listModels(){return new Promise((e,n)=>{const r=this.indexedDB.open(ij,sj);r.onupgradeneeded=()=>aj(r),r.onsuccess=()=>{const i=r.result,s=i.transaction(mf,"readonly"),o=s.objectStore(mf).getAll();o.onsuccess=()=>{const l={};for(const c of o.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},o.onerror=l=>(i.close(),n(o.error)),s.oncomplete=()=>i.close()},r.onerror=i=>n(r.error)})}async removeModel(e){return e=WIe(e),new Promise((n,r)=>{const i=this.indexedDB.open(ij,sj);i.onupgradeneeded=()=>aj(i),i.onsuccess=()=>{const s=i.result,a=s.transaction(mf,"readwrite"),o=a.objectStore(mf),l=o.get(e);let c;l.onsuccess=()=>{if(l.result==null)return s.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=o.delete(e),d=()=>{c=s.transaction(Cm,"readwrite");const f=c.objectStore(Cm).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>r(l.error)};u.onsuccess=d,u.onerror=h=>(d(),s.close(),r(l.error))}},l.onerror=u=>(s.close(),r(l.error)),a.oncomplete=()=>{c==null?s.close():c.oncomplete=()=>s.close()}},i.onerror=s=>r(i.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Md="/",mv="tensorflowjs_models",Xae="info",GIe="model_topology",qIe="weight_specs",XIe="weight_data",KIe="model_metadata";function Kae(t){return{info:[mv,t,Xae].join(Md),topology:[mv,t,GIe].join(Md),weightSpecs:[mv,t,qIe].join(Md),weightData:[mv,t,XIe].join(Md),modelMetadata:[mv,t,KIe].join(Md)}}function Yae(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function YIe(t){const e=t.split(Md);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Md)}function ZIe(t){return t.startsWith(bg.URL_SCHEME)?t.slice(bg.URL_SCHEME.length):t}class bg{constructor(e){if(!Me().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=Kae(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),i=LT(e),s=Jc.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(i)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,OIe(s));const a={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(a)),{modelArtifactsInfo:i}}catch{throw Yae(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${i.modelTopologyBytes}, weightSpecsBytes=${i.weightSpecsBytes}, weightDataBytes=${i.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=r;const i=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(i==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=i;const s=this.LS.getItem(this.keys.modelMetadata);if(s!=null){const o=JSON.parse(s);n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,o.signature!=null&&(n.signature=o.signature),o.userDefinedMetadata!=null&&(n.userDefinedMetadata=o.userDefinedMetadata),o.modelInitializer!=null&&(n.modelInitializer=o.modelInitializer),o.initializerSignature!=null&&(n.initializerSignature=o.initializerSignature),o.trainingConfig!=null&&(n.trainingConfig=o.trainingConfig)}const a=this.LS.getItem(this.keys.weightData);if(a==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=DIe(a),n}}bg.URL_SCHEME="localstorage://";const Zae=t=>Me().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(bg.URL_SCHEME)?QIe(t.slice(bg.URL_SCHEME.length)):null;Gr.registerSaveRouter(Zae);Gr.registerLoadRouter(Zae);function QIe(t){return new bg(t)}class JIe{constructor(){q(Me().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),q(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=mv+Md,r=Md+Xae;for(let i=0;i<this.LS.length;++i){const s=this.LS.key(i);if(s.startsWith(n)&&s.endsWith(r)){const a=YIe(s);e[a]=JSON.parse(this.LS.getItem(s))}}return e}async removeModel(e){e=ZIe(e);const n=Kae(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(n.info));return Yae(n),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rx="://";class la{constructor(){this.managers={}}static getInstance(){return la.instance==null&&(la.instance=new la),la.instance}static registerManager(e,n){q(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(rx)&&(e=e.slice(0,e.indexOf(rx))),q(e.length>0,()=>"scheme must not be an empty string.");const r=la.getInstance();q(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=n}static getManager(e){const n=la.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(la.getInstance().managers)}}function B2(t){if(t.indexOf(rx)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${la.getSchemes().join(",")}`);return{scheme:t.split(rx)[0],path:t.split(rx)[1]}}async function Qae(t,e,n=!1){q(t!==e,()=>`Old path and new path are the same: '${t}'`);const r=Gr.getLoadHandlers(t);q(r.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),q(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${t}.`);const i=r[0],s=Gr.getSaveHandlers(e);q(s.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),q(s.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const a=s[0],o=B2(t).scheme,l=B2(t).path,c=o===B2(t).scheme,u=await i.load();n&&c&&await la.getManager(o).removeModel(l);const d=await a.save(u);return n&&!c&&await la.getManager(o).removeModel(l),d.modelArtifactsInfo}async function eke(){const t=la.getSchemes(),e={};for(const n of t){const r=await la.getManager(n).listModels();for(const i in r){const s=n+rx+i;e[s]=r[i]}}return e}async function tke(t){const e=B2(t);return la.getManager(e.scheme).removeModel(e.path)}async function nke(t,e){return Qae(t,e,!1)}async function rke(t,e){return Qae(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ike{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!Me().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const i=this.functionRefs[r.data.index];i(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return xae(e)}}if(Me().get("IS_BROWSER")){Me().setPlatform("browser",new ike);try{la.registerManager(bg.URL_SCHEME,new JIe)}catch{}try{la.registerManager(xg.URL_SCHEME,new HIe)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ske={importFetch:()=>require("node-fetch")};let R$;class ake{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return Me().global.fetch!=null?Me().global.fetch(e,n):(R$==null&&(R$=ske.importFetch()),R$(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}Me().get("IS_NODE")&&!Me().get("IS_BROWSER")&&Me().setPlatform("node",new ake);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yn(t,e="float32",n){return e=e||"float32",sl(t),new Hi(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oke(t,e){const n=Y(t,"x","cast");if(!VAe(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:n},i={dtype:e};return ue.runKernel(K_,r,i)}const nt=ce({cast_:oke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lke(t){const n={x:Y(t,"x","clone","string_or_numeric")};return ue.runKernel(lT,n)}const Wd=ce({clone_:lke});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jae(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Pae();const cke={buffer:yn,cast:nt,clone:Wd,print:Jae};bIe(cke);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(t,e){let n=Y(t,"a","add"),r=Y(e,"b","add");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(X0,i)}const He=ce({add_:uke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dke(t,e){let n=Y(t,"a","floorDiv"),r=Y(e,"b","floorDiv");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(aT,i)}const eW=ce({floorDiv_:dke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t,e){let n=Y(t,"a","div"),r=Y(e,"b","div");if([n,r]=di(n,r),n.dtype==="int32"&&r.dtype==="int32")return eW(n,r);const i={a:n,b:r},s={};return ue.runKernel(eT,i,s)}const ct=ce({div_:hke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t,e){let n=Y(t,"a","mul"),r=Y(e,"b","mul");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(yT,i)}const se=ce({mul_:fke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pke(t){const e=Y(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return ue.runKernel(xM,n)}else{const n={x:e};return ue.runKernel(uM,n)}}const Bi=ce({abs_:pke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t){const n={x:Y(t,"x","acos")};return ue.runKernel(U_,n)}const eoe=ce({acos_:mke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gke(t){const n={x:Y(t,"x","acosh")};return ue.runKernel(V_,n)}const toe=ce({acosh_:gke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(t){q(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),q(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((i,s)=>Y(i,`tensors${s}`,"addN")),n=e[0];e.forEach(i=>{if(i.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(i=>{if(!Pn(i.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return ue.runKernel(dM,r)}const vke=ce({addN_:yke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t,e=null,n=!1){const i={x:Y(t,"x","all","bool")},s={axis:e,keepDims:n};return ue.runKernel(GU,i,s)}const tW=ce({all_:xke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(t,e=null,n=!1){const i={x:Y(t,"x","any","bool")},s={axis:e,keepDims:n};return ue.runKernel(qU,i,s)}const VA=ce({any_:bke});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wke(t,e=0){const r={x:Y(t,"x","argMax")},i={axis:e};return ue.runKernel(hM,r,i)}const wg=ce({argMax_:wke});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ske(t,e=0){const r={x:Y(t,"x","argMin")},i={axis:e};return ue.runKernel(fM,r,i)}const noe=ce({argMin_:Ske});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ke(t){const n={x:Y(t,"x","asin")};return ue.runKernel(W_,n)}const roe=ce({asin_:_ke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tke(t){const n={x:Y(t,"x","asinh")};return ue.runKernel(H_,n)}const ioe=ce({asinh_:Tke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(t){const n={x:Y(t,"x","atan")};return ue.runKernel(G_,n)}const soe=ce({atan_:Eke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t,e){let n=Y(t,"a","atan2"),r=Y(e,"b","atan2");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(X_,i)}const aoe=ce({atan2_:Cke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t){const n={x:Y(t,"x","atanh")};return ue.runKernel(q_,n)}const ooe=ce({atanh_:Nke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FT(t,e,n,r,i="NHWC",s){const a=t[3],o=[...e,a],l=yh(i);return hs(t,o,n,s,r,null,null,l)}function Zl(t,e,n,r,i,s,a="channelsLast"){const[o,l]=X1(e);let c;if(a==="channelsLast")c=[o,l,t[3],t[3]];else if(a==="channelsFirst")c=[o,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${a}`);return hs(t,c,n,r,i,s,!1,a)}function gh(t,e,n,r,i,s,a="NDHWC"){const[o,l,c]=oj(e);let u,d;if(a==="NDHWC")d="channelsLast",u=[o,l,c,t[4],t[4]];else if(a==="NCDHW")d="channelsFirst",u=[o,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${a}`);return mp(t,u,n,r,i,!1,d,s)}function hs(t,e,n,r,i,s,a=!1,o="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(o==="channelsLast")[l,c,u,d]=t;else if(o==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${o}`);const[h,f,,p]=e,[g,m]=X1(n),[y,x]=X1(r),b=ix(h,y),_=ix(f,x),{padInfo:T,outHeight:E,outWidth:C}=kke(i,c,u,g,m,b,_,s,o),I=a?p*d:p;let A;return o==="channelsFirst"?A=[l,I,E,C]:o==="channelsLast"&&(A=[l,E,C,I]),{batchSize:l,dataFormat:o,inHeight:c,inWidth:u,inChannels:d,outHeight:E,outWidth:C,outChannels:I,padInfo:T,strideHeight:g,strideWidth:m,filterHeight:h,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:_,dilationHeight:y,dilationWidth:x,inShape:t,outShape:A,filterShape:e}}function mp(t,e,n,r,i,s=!1,a="channelsLast",o){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d,h]=t;else if(a==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${a}`);const[f,p,g,,m]=e,[y,x,b]=oj(n),[_,T,E]=oj(r),C=ix(f,_),I=ix(p,T),A=ix(g,E),{padInfo:k,outDepth:R,outHeight:$,outWidth:z}=Mke(i,c,u,d,y,x,b,C,I,A,o),O=s?m*h:m;let j;return a==="channelsFirst"?j=[l,O,R,$,z]:a==="channelsLast"&&(j=[l,R,$,z,O]),{batchSize:l,dataFormat:a,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:R,outHeight:$,outWidth:z,outChannels:O,padInfo:k,strideDepth:y,strideHeight:x,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:g,effectiveFilterDepth:C,effectiveFilterHeight:I,effectiveFilterWidth:A,dilationDepth:_,dilationHeight:T,dilationWidth:E,inShape:t,outShape:j,filterShape:e}}function Ake(t,e,n,r,i){r==null&&(r=nW(t,e,n));const s=t[0],a=t[1],o=K1((s-e+2*r)/n+1,i),l=K1((a-e+2*r)/n+1,i);return[o,l]}function Ike(t,e,n,r,i,s){i==null&&(i=nW(t,e[0],r[0]));const a=[0,0,0,n];for(let o=0;o<3;o++)t[o]+2*i>=e[o]&&(a[o]=K1((t[o]-e[o]+2*i)/r[o]+1,s));return a}function nW(t,e,n,r=1){const i=ix(e,r);return Math.floor((t[0]*(n-1)-n+i)/2)}function X1(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function oj(t){return typeof t=="number"?[t,t,t]:t}function ix(t,e){return e<=1?t:t+(t-1)*(e-1)}function kke(t,e,n,r,i,s,a,o,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=Ake([e,n],s,r,t,o);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/r),d=Math.ceil(n/i);const h=Math.max(0,(u-1)*r+s-e),f=Math.max(0,(d-1)*i+a-n),p=Math.floor(h/2),g=h-p,m=Math.floor(f/2),y=f-m;c={top:p,bottom:g,left:m,right:y,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-s+1)/r),d=Math.ceil((n-a+1)/i);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],g=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:g,type:h===0&&f===0&&p===0&&g===0?"VALID":"EXPLICIT"},u=K1((e-s+h+f)/r+1,o),d=K1((n-a+p+g)/i+1,o)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function Mke(t,e,n,r,i,s,a,o,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const m=Ike([e,n,r,1],[o,l,c],1,[i,s,a],t,u);h=m[0],f=m[1],p=m[2]}else if(t==="same"){h=Math.ceil(e/i),f=Math.ceil(n/s),p=Math.ceil(r/a);const g=(h-1)*i+o-e,m=(f-1)*s+l-n,y=(p-1)*a+c-r,x=Math.floor(g/2),b=g-x,_=Math.floor(m/2),T=m-_,E=Math.floor(y/2),C=y-E;d={top:_,bottom:T,left:E,right:C,front:x,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function K1(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Gf(t){const[e,n,r]=X1(t);return e===1&&n===1&&r===1}function ks(t,e){return Gf(t)||Gf(e)}function Sg(t){return X1(t).every(e=>e>0)}function yh(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function wa(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")q(Wx(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(i=>{q(Wx(i),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${i}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(t,e){const r={x:Y(t,"x","reshape","string_or_numeric")},i={shape:e};return ue.runKernel(JM,r,i)}const de=ce({reshape_:Rke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pke(t,e,n,r,i){const s=Y(t,"x","avgPool","float32"),a=1;q(ks(n,a),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);let o=s,l=!1;s.rank===3&&(l=!0,o=de(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(o.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${o.rank}.`),wa("avgPool",r,i);const c={x:o},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i};let d=ue.runKernel(pM,c,u);return d=nt(d,s.dtype),l?de(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const pR=ce({avgPool_:Pke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t,e,n,r,i,s="NDHWC"){const a=Y(t,"x","avgPool3d","float32");let o=a,l=!1;a.rank===4&&(l=!0,o=de(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),q(o.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${o.rank}.`),q(s==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),q(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),wa("avgPool3d",r,i);const c={x:o},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:s};let d=ue.runKernel(mM,c,u);return d=nt(d,o.dtype),l?de(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const loe=ce({avgPool3d_:Oke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dke(t,e=0){q(t.length>=1,()=>"Pass at least one tensor to concat");const n=UA(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(s=>{if(s.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${s.dtype}. `)}),n.length===1)return Wd(n[0]);const r=n,i={axis:e};return ue.runKernel(bM,r,i)}const Qr=ce({concat_:Dke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t,e,n=!1,r=!1){let i=Y(t,"a","matMul"),s=Y(e,"b","matMul");[i,s]=di(i,s);const a={a:i,b:s},o={transposeA:n,transposeB:r};return ue.runKernel(gM,a,o)}const Mn=ce({matMul_:$ke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lke(t){const n={x:Y(t,"x","sigmoid","float32")};return ue.runKernel(AT,n)}const Ko=ce({sigmoid_:Lke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(t,e,n){const r=Y(t,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const i={x:r},s={begin:e,size:n};return ue.runKernel(iR,i,s)}const Kt=ce({slice_:Fke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t){const n={x:Y(t,"x","tanh","float32")};return ue.runKernel(OT,n)}const _g=ce({tanh_:jke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zke(t,e,n,r,i,s){const a=Y(t,"forgetBias","basicLSTMCell"),o=Y(e,"lstmKernel","basicLSTMCell"),l=Y(n,"lstmBias","basicLSTMCell"),c=Y(r,"data","basicLSTMCell"),u=Y(i,"c","basicLSTMCell"),d=Y(s,"h","basicLSTMCell"),h=Qr([c,d],1),f=Mn(h,o),p=He(f,l),g=p.shape[0],m=p.shape[1]/4,y=[g,m],x=Kt(p,[0,0],y),b=Kt(p,[0,m],y),_=Kt(p,[0,m*2],y),T=Kt(p,[0,m*3],y),E=He(se(Ko(x),_g(b)),se(u,Ko(He(a,_)))),C=se(_g(E),Ko(T));return[E,C]}const Bke=ce({basicLSTMCell_:zke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uke(t,e,n){const r=Y(t,"x","batchToSpaceND"),i=e.reduce((o,l)=>o*l);q(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),q(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),q(r.shape[0]%i===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${i}`);const s={x:r},a={blockShape:e,crops:n};return ue.runKernel(yM,s,a)}const mR=ce({batchToSpaceND_:Uke});function Vke(t){let e;return t.rank===0||t.rank===1?e=de(t,[1,1,1,t.size]):t.rank===2?e=de(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=de(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(t,e,n,r,i,s){s==null&&(s=.001);const a=Y(t,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(n,"variance","batchNorm");let c;i!=null&&(c=Y(i,"scale","batchNorm"));let u;r!=null&&(u=Y(r,"offset","batchNorm")),q(o.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),q(u==null||o.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),q(c==null||o.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Vke(a),scale:c,offset:u,mean:o,variance:l},f={varianceEpsilon:s},p=ue.runKernel(IM,h,f);return de(p,a.shape)}const jT=ce({batchNorm_:Wke});function Hke(t,e,n,r,i,s){const a=Y(t,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(n,"variance","batchNorm");let c;i!=null&&(c=Y(i,"scale","batchNorm"));let u;return r!=null&&(u=Y(r,"offset","batchNorm")),q(a.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${a.rank}.`),q(o.rank===2||o.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${o.rank}.`),q(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&q(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&q(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),jT(a,o,l,u,c,s)}const coe=ce({batchNorm2d_:Hke});function Gke(t,e,n,r,i,s){const a=Y(t,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(n,"variance","batchNorm");let c;i!=null&&(c=Y(i,"scale","batchNorm"));let u;return r!=null&&(u=Y(r,"offset","batchNorm")),q(a.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${a.rank}.`),q(o.rank===3||o.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${o.rank}.`),q(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&q(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&q(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),jT(a,o,l,u,c,s)}const uoe=ce({batchNorm3d_:Gke});function qke(t,e,n,r,i,s){const a=Y(t,"x","batchNorm"),o=Y(e,"mean","batchNorm"),l=Y(n,"variance","batchNorm");let c;i!=null&&(c=Y(i,"scale","batchNorm"));let u;return r!=null&&(u=Y(r,"offset","batchNorm")),q(a.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${a.rank}.`),q(o.rank===4||o.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${o.rank}.`),q(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&q(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&q(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),jT(a,o,l,u,c,s)}const doe=ce({batchNorm4d_:qke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(t,e,n){const r=Y(t,"x","bincount"),i=Y(e,"weights","bincount");q(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),q(n>=0,()=>`size must be non-negative, but got ${n}.`),q(i.size===r.size||i.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${i.shape}.`);const s={x:r,weights:i},a={size:n};return ue.runKernel(YU,s,a)}const hoe=ce({bincount_:Xke});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(t,e){const n=Y(t,"x","bitwiseAnd"),r=Y(e,"y","bitwiseAnd");if(!Pn(n.shape,r.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${r.shape}`);if(n.dtype!=="int32"||r.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${r.dtype}`);const i={a:n,b:r};return ue.runKernel(vM,i)}const Yke=ce({bitwiseAnd_:Kke});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zke(t,e){const n=Y(t,"s0","broadcastArgs","int32"),r=Y(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const i={s0:n,s1:r};return ue.runKernel(ZU,i)}const Qke=ce({broadcastArgs_:Zke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(t,e){let n=Y(t,"broadcastTo","x");const r=n.shape;if(sl(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=de(n,c)}const i=n.shape,s=Array.from(e);for(let c=e.length-1;c>=0;c--)if(i[c]===e[c])s[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(s.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return Wd(n);const o={x:n},l={reps:s};return ue.runKernel(DT,o,l)}const sx=ce({broadcastTo_:Jke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eMe(t){const n={x:Y(t,"x","ceil","float32")};return ue.runKernel(Y_,n)}const foe=ce({ceil_:eMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K0(t,e,n){sl(t),n=n||G0(e);const r={shape:t,value:e,dtype:n};return ue.runKernel(hV,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tMe(t,e,n){const r=Y(t,"x","clipByValue");if(q(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return K0(r.shape,e,r.dtype);const i={x:r},s={clipValueMin:e,clipValueMax:n};return ue.runKernel(Z_,i,s)}const Ha=ce({clipByValue_:tMe});function nMe(t){return Qr(t,0)}const poe=ce({concat1d_:nMe});function rMe(t,e){return Qr(t,e)}const moe=ce({concat2d_:rMe});function iMe(t,e){return Qr(t,e)}const goe=ce({concat3d_:iMe});function sMe(t,e){return Qr(t,e)}const yoe=ce({concat4d_:sMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aMe(t,e,n,r,i="NHWC",s=[1,1],a){const o=Y(t,"x","conv2d","float32"),l=Y(e,"filter","conv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=de(o,[1,o.shape[0],o.shape[1],o.shape[2]])),q(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),q(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),wa("conv2d",r,a);const d=i==="NHWC"?c.shape[3]:c.shape[1];q(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),q(ks(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),q(Sg(s),()=>"Error in conv2D: Dilated rates should be larger than 0."),q(Sg(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=ue.runKernel(wM,h,f);return u?de(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const qf=ce({conv2d_:aMe});function oMe(t,e,n,r,i="NWC",s=1,a){const o=Y(t,"x","conv1d"),l=Y(e,"filter","conv1d");let c=o,u=!1;o.rank===2&&(u=!0,c=de(o,[1,o.shape[0],o.shape[1]])),q(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),q(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),wa("conv1d",r,a),q(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),q(ks(n,s),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${s}'`),q(Sg(s),()=>"Error in conv1D: Dilated rates should be larger than 0."),q(Sg(n),()=>"Error in conv1D: Stride should be larger than 0."),q(i==="NWC",()=>`Error in conv1d: got dataFormat of ${i} but only NWC is currently supported.`);const d=de(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=de(c,[c.shape[0],1,c.shape[1],c.shape[2]]),m=qf(h,d,[1,n],r,"NHWC",[1,s],a);return u?de(m,[m.shape[2],m.shape[3]]):de(m,[m.shape[0],m.shape[2],m.shape[3]])}const rW=ce({conv1d_:oMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lMe(t,e,n,r,i,s="NHWC",a){q(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,l=e,c=!1;e.rank===3&&(c=!0,l=de(e,[1,e.shape[0],e.shape[1],e.shape[2]]),o=[1,t[0],t[1],t[2]]),q(o.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${o.length}.`),q(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),q(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=s==="NHWC"?o[3]:o[1],d=s==="NHWC"?l.shape[3]:l.shape[1];q(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),q(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),wa("conv2dDerInput",i,a);const h={dy:l,filter:n},f={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,inputShape:o},p=ue.runKernel(SM,h,f);return c?de(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const iW=ce({conv2DBackpropInput_:lMe});function cMe(t,e,n,r,i,s){const a=Y(t,"x","conv2dTranspose"),o=Y(e,"filter","conv2dTranspose");return iW(n,a,o,r,i,"NHWC",s)}const sW=ce({conv2dTranspose_:cMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(t,e,n,r,i="NDHWC",s=[1,1,1]){const a=Y(t,"x","conv3d"),o=Y(e,"filter","conv3d");let l=a,c=!1;a.rank===4&&(c=!0,l=de(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),q(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),q(o.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${o.rank}.`),q(l.shape[4]===o.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${o.shape[3]}.`),q(ks(n,s),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),q(i==="NDHWC",()=>`Error in conv3d: got dataFormat of ${i} but only NDHWC is currently supported.`),q(Sg(s),()=>"Error in conv3D: Dilated rates should be larger than 0."),q(Sg(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:o},d={strides:n,pad:r,dataFormat:i,dilations:s},h=ue.runKernel(_M,u,d);return c?de(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const voe=ce({conv3d_:uMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dMe(t,e,n,r,i){q(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let s=t,a=e,o=!1;e.rank===4&&(o=!0,a=de(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),s=[1,t[0],t[1],t[2],t[3]]);const l=s[4],c=a.shape[4];q(s.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${s.length}.`),q(a.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${a.rank}`),q(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),q(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),q(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:a,filter:n},d={pad:i,strides:r,inputShape:s},h=ue.runKernel(tV,u,d);return o?de(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const xoe=ce({conv3DBackpropInput_:dMe});function hMe(t,e,n,r,i){const s=Y(t,"x","conv3dTranspose"),a=Y(e,"filter","conv3dTranspose");return xoe(n,s,a,r,i)}const boe=ce({conv3dTranspose_:hMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(t){const n={x:Y(t,"x","cos","float32")};return ue.runKernel(Q_,n)}const gR=ce({cos_:fMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pMe(t){const n={x:Y(t,"x","cosh","float32")};return ue.runKernel(J_,n)}const aW=ce({cosh_:pMe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mMe(t,e=0,n=!1,r=!1){const s={x:Y(t,"x","cumprod")},a={axis:e,exclusive:n,reverse:r};return ue.runKernel(nV,s,a)}const WA=ce({cumprod_:mMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(t,e=0,n=!1,r=!1){const s={x:Y(t,"x","cumsum")},a={axis:e,exclusive:n,reverse:r};return ue.runKernel(TM,s,a)}const oW=ce({cumsum_:gMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(t,e,n,r=!1){const i=Y(t,"x","denseBincount"),s=Y(e,"weights","denseBincount");q(i.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${i.dtype}`),q(i.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${i.rank}.`),q(n>=0,()=>`size must be non-negative, but got ${n}.`),q(s.size===i.size||s.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${i.shape}, weights shape: ${s.shape}.`);const a={x:i,weights:s},o={size:n,binaryOutput:r};return ue.runKernel(iV,a,o)}const lj=ce({denseBincount_:yMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMe(t,e,n="NHWC"){const r=Y(t,"x","depthToSpace","float32"),i=n==="NHWC"?r.shape[1]:r.shape[2],s=n==="NHWC"?r.shape[2]:r.shape[3],a=n==="NHWC"?r.shape[3]:r.shape[1];q(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),q(i*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${i} and ${e}  for depthToSpace with input shape
    ${r.shape}`),q(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e} for depthToSpace with input shape
        ${r.shape}`),q(a%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${a} for depthToSpace with input shape ${r.shape}`);const o={x:r},l={blockSize:e,dataFormat:n};return ue.runKernel(sV,o,l)}const woe=ce({depthToSpace_:vMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xMe(t,e,n,r,i="NHWC",s=[1,1],a){const o=Y(t,"x","depthwiseConv2d","float32"),l=Y(e,"filter","depthwiseConv2d","float32");let c=o,u=!1;o.rank===3&&(u=!0,c=de(o,[1,o.shape[0],o.shape[1],o.shape[2]])),q(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),q(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=i==="NHWC"?c.shape[3]:c.shape[1];q(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),wa("depthwiseConv2d",r,a);const h={x:c,filter:l},f={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a},p=ue.runKernel(EM,h,f);return u?de(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const zT=ce({depthwiseConv2d_:xMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bMe(t){const n={x:Y(t,"x","diag")};return ue.runKernel(lV,n)}const wMe=ce({diag_:bMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SMe(t,e,n,r,i=[1,1],s="NHWC"){const a=Y(t,"x","dilation2d"),o=Y(e,"filter","dilation2d");q(a.rank===3||a.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${a.rank}.`),q(o.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${o.rank}.`),q(s==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${s}`);let l=a,c=!1;a.rank===3&&(l=de(a,[1,a.shape[0],a.shape[1],a.shape[2]]),c=!0),q(l.shape[3]===o.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${o.shape[2]}`);const u={x:l,filter:o},d={strides:n,pad:r,dilations:i},h=ue.runKernel(CM,u,d);return c?de(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const Soe=ce({dilation2d_:SMe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(t,e){const n=t.length,r=[];for(let i=0;i<n;i++){const s=n-1-i,a=t[s]||1;(e[e.length-1-i]||1)>1&&a===1&&r.unshift(s)}return r}function Yi(t,e){const n=[];for(let r=0;r<e.length;r++){const i=t[t.length-r-1],s=e.length-r-1,a=e[s];(i==null||i===1&&a>1)&&n.unshift(s)}return n}function dn(t,e){const n=Math.max(t.length,e.length),r=new Array(n);for(let i=0;i<n;i++){let s=t[t.length-i-1];s==null&&(s=1);let a=e[e.length-i-1];if(a==null&&(a=1),s===1)r[n-i-1]=a;else if(a===1)r[n-i-1]=s;else if(s!==a){const o=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(o)}else r[n-i-1]=s}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Me(t,e){let n=Y(t,"a","equal","string_or_numeric"),r=Y(e,"b","equal","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(NM,i)}const Hc=ce({equal_:_Me});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TMe(t,e,n){const r=Y(e,"a","where"),i=Y(n,"b","where"),s=Y(t,"condition","where","bool"),a=dn(dn(s.shape,r.shape),i.shape),o=sx(s,a),l=sx(r,a),c=sx(i,a),u={condition:o,t:l,e:c};return ue.runKernel(rR,u)}const Hs=ce({where_:TMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EMe(t){const n={x:Y(t,"x","zerosLike")};return ue.runKernel(hR,n)}const Fn=ce({zerosLike_:EMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CMe(t,e){let n=Y(t,"a","div"),r=Y(e,"b","div");[n,r]=di(n,r);const i=ct(n,r),s=Fn(i),a=Hc(r,s);return Hs(a,s,i)}const _oe=ce({divNoNan_:CMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NMe(t,e){const n=Y(t,"t1","dot"),r=Y(e,"t2","dot");q((n.rank===1||n.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${r.rank}.`);const i=n.rank===1?n.size:n.shape[1],s=r.rank===1?r.size:r.shape[0];if(q(i===s,()=>`Error in dot: inner dimensions of inputs must match, but got ${i} and ${s}.`),n.rank===1&&r.rank===1){const a=de(n,[1,-1]),o=de(r,[-1,1]),l=Mn(a,o);return de(l,[])}else if(n.rank===1&&r.rank===2){const a=de(n,[1,-1]),o=de(r,[r.shape[0],r.shape[1]]),l=Mn(a,o);return de(l,[l.size])}else if(n.rank===2&&r.rank===1){const a=de(r,[-1,1]),o=Mn(n,a);return de(o,[o.size])}else{const a=de(r,[r.shape[0],r.shape[1]]);return Mn(n,a)}}const Toe=ce({dot_:NMe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AMe(t,...e){const n=e.map((i,s)=>Y(i,`tensors${s}`,"einsum")),r={equation:t};return ue.runKernel(cV,n,r)}const gv=ce({einsum_:AMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IMe(t){const n={x:Y(t,"x","elu","float32")};return ue.runKernel(tT,n)}const BT=ce({elu_:IMe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kMe(t,e){const n=Y(t,"x","ensureShape","string_or_numeric");if(!BAe(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const MMe=ce({ensureShape_:kMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RMe(t){let e=Y(t,"x","erf");q(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=nt(e,"float32"));const n={x:e};return ue.runKernel(nT,n)}const lW=ce({erf_:RMe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cW(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function Eoe(t,e,n){const r=t.length+e.length,i=[];let s=0,a=0;for(let o=0;o<r;o++)n.indexOf(o)===-1?i.push(t[s++]):i.push(e[a++]);return i}function fs(t,e){const n=[],r=t.length;for(let s=0;s<r;s++)e.indexOf(s)===-1&&n.push(t[s]);const i=e.map(s=>t[s]);return[n,i]}function bi(t,e){const n=e.map(r=>1);return Eoe(t,n,e)}function Ms(t,e,n){q(cW(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Jr(t,e){if(cW(t,e))return null;const n=[];for(let r=0;r<e;++r)t.indexOf(r)===-1&&n.push(r);return t.forEach(r=>n.push(r)),n}function gp(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function wi(t,e){const n=[];for(let r=e-t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PMe(t,e=null,n=!1){const i={x:Y(t,"x","max")},s={reductionIndices:e,keepDims:n};return ue.runKernel(jM,i,s)}const Bl=ce({max_:PMe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OMe(t,e=null,n=!1){const i={x:Y(t,"x","min")},s={axis:e,keepDims:n};return ue.runKernel(VM,i,s)}const Y1=ce({min_:OMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DMe(t,e){let n=Y(t,"base","pow"),r=Y(e,"exp","pow");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(vT,i)}const nh=ce({pow_:DMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function It(t,e){if((Gl(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Gl(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return pp(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(t){const n={x:Y(t,"x","sqrt","float32")};return ue.runKernel(kT,n)}const Is=ce({sqrt_:$Me});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LMe(t){const e=Y(t,"x","square"),n={};return ue.runKernel("Square",{x:e},n)}const fr=ce({square_:LMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FMe(t,e=null,n=!1){let r=Y(t,"x","sum");r.dtype==="bool"&&(r=nt(r,"int32"));const i={x:r},s={axis:e,keepDims:n};return ue.runKernel(sR,i,s)}const Et=ce({sum_:FMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jMe(t,e="euclidean",n=null,r=!1){t=Y(t,"x","norm");const i=Coe(t,e,n);let s=i.shape;if(r){const a=Nn(n,t.shape);s=bi(i.shape,a)}return de(i,s)}function Coe(t,e,n=null){if(t.rank===0)return Bi(t);if(t.rank!==1&&n===null)return Coe(de(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Et(Bi(t),n);if(e===1/0)return Bl(Bi(t),n);if(e===-1/0)return Y1(Bi(t),n);if(e==="euclidean"||e===2)return Is(Et(nh(Bi(t),It(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Bl(Et(Bi(t),n[0]),n[1]-1);if(e===1/0)return Bl(Et(Bi(t),n[1]),n[0]);if(e===-1/0)return Y1(Et(Bi(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Is(Et(fr(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const UT=ce({norm_:jMe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zMe(t,e=null,n=!1){return UT(t,"euclidean",e,n)}const Noe=ce({euclideanNorm_:zMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BMe(t){const n={x:Y(t,"x","exp")};return ue.runKernel(rT,n)}const va=ce({exp_:BMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UMe(t,e=0){const n=Y(t,"x","expandDims","string_or_numeric");q(e<=n.rank,()=>"Axis must be <= rank of the tensor");const r={input:n},i={dim:e};return ue.runKernel(AM,r,i)}const Mi=ce({expandDims_:UMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VMe(t){const n={x:Y(t,"x","expm1")};return ue.runKernel(iT,n)}const Aoe=ce({expm1_:VMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WMe(t,e){const n=Y(t,"x","tile","string_or_numeric");q(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const r={x:n},i={reps:e};return ue.runKernel(DT,r,i)}const Dl=ce({tile_:WMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HMe(t,e,n,r="float32"){e==null&&(e=t);const i=yn([t,e],r),s=t<=e?t:e;for(let o=0;o<s;++o)i.set(1,o,o);const a=de(i.toTensor(),[t,e]);if(n==null)return a;if(n.length===1)return Dl(Mi(a,0),[n[0],1,1]);if(n.length===2)return Dl(Mi(Mi(a,0),0),[n[0],n[1],1,1]);if(n.length===3)return Dl(Mi(Mi(Mi(a,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const uW=ce({eye_:HMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GMe(t){const n={x:Y(t,"x","floor","float32")};return ue.runKernel(sT,n)}const VT=ce({floor_:GMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qMe(t,e,n=0,r=0){const i=Y(t,"x","gather"),s=Y(e,"indices","gather","int32"),a={x:i,indices:s},o={axis:n,batchDims:r};return ue.runKernel(kM,a,o)}const WT=ce({gather_:qMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XMe(t,e){let n=Y(t,"a","greater","string_or_numeric"),r=Y(e,"b","greater","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(MM,i)}const Co=ce({greater_:XMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KMe(t,e){let n=Y(t,"a","greaterEqual","string_or_numeric"),r=Y(e,"b","greaterEqual","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(oT,i)}const yp=ce({greaterEqual_:KMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YMe(t){const n={input:Y(t,"input","imag")};return ue.runKernel(gV,n)}const yR=ce({imag_:YMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZMe(t){const n={x:Y(t,"x","isFinite")};return ue.runKernel(cT,n)}const Ioe=ce({isFinite_:ZMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QMe(t){const n={x:Y(t,"x","isInf")};return ue.runKernel(uT,n)}const koe=ce({isInf_:QMe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JMe(t){const n={x:Y(t,"x","isNaN")};return ue.runKernel(dT,n)}const Moe=ce({isNaN_:JMe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eRe(t,e=.2){const r={x:Y(t,"x","leakyRelu")},i={alpha:e};return ue.runKernel(RM,r,i)}const vR=ce({leakyRelu_:eRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tRe(t,e){let n=Y(t,"a","less","string_or_numeric"),r=Y(e,"b","less","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(PM,i)}const Z1=ce({less_:tRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nRe(t,e){let n=Y(t,"a","lessEqual","string_or_numeric"),r=Y(e,"b","lessEqual","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(OM,i)}const Kg=ce({lessEqual_:nRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rRe(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const r={start:t,stop:e,num:n};return ue.runKernel(yV,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iRe(t,e=5,n=1,r=1,i=.5){const s=Y(t,"x","localResponseNormalization");q(s.rank===4||s.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${s.rank}.`),q(Wx(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let a=s,o=!1;s.rank===3&&(o=!0,a=de(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const l={x:a},c={depthRadius:e,bias:n,alpha:r,beta:i},u=ue.runKernel(FM,l,c);return o?de(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Roe=ce({localResponseNormalization_:iRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sRe(t){const n={x:Y(t,"x","log","float32")};return ue.runKernel(hT,n)}const el=ce({log_:sRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aRe(t){const n={x:Y(t,"x","log1p")};return ue.runKernel(fT,n)}const xR=ce({log1p_:aRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oRe(t,e){q(WF(t),()=>"The f passed in variableGrads(f) must be a function"),q(e==null||Array.isArray(e)&&e.every(c=>c instanceof BA),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in ue.registeredVariables)e.push(ue.registeredVariables[c])}const r=n?e.filter(c=>!c.trainable):null,i=e.length;e=e.filter(c=>c.trainable),q(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${i} variables is trainable.`);const s=!0,{value:a,grads:o}=ue.gradients(t,e,null,s);q(o.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),q(a.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${a.rank} tensor`);const l={};return e.forEach((c,u)=>{o[u]!=null&&(l[c.name]=o[u])}),r!=null&&r.forEach(c=>l[c.name]=null),{value:a,grads:l}}function rh(t){return ue.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lRe(t){const n={x:Y(t,"x","neg")};return ue.runKernel(HM,n)}const Dr=ce({neg_:lRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cRe(t){const n={x:Y(t,"x","softplus")};return ue.runKernel(IT,n)}const Y0=ce({softplus_:cRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uRe(t){const e=Y(t,"x","logSigmoid");return rh(r=>({value:Dr(Y0(Dr(r))),gradFunc:a=>se(a,Ko(Dr(r)))}))(e)}const Poe=ce({logSigmoid_:uRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dRe(t,e){let n=Y(t,"a","sub"),r=Y(e,"b","sub");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(RT,i)}const ut=ce({sub_:dRe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hRe(t,e=-1){const n=Y(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return rh((i,s)=>{const o=Bl(i,e,!0),l=ut(i,o),c=ut(nt(l,"float32"),el(Et(va(l),e,!0)));return s([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,g=va(f);return ut(d,se(Et(d,e,p),g))}}})(n)}const dW=ce({logSoftmax_:hRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fRe(t,e=null,n=!1){const r=Y(t,"x","logSumExp"),i=Nn(e,r.shape),s=Bl(r,i,!0),a=ut(r,s),o=va(a),l=Et(o,i),c=el(l),u=He(de(s,c.shape),c);if(n){const d=bi(u.shape,i);return de(u,d)}return u}const bR=ce({logSumExp_:fRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pRe(t,e){const n=Y(t,"a","logicalAnd","bool"),r=Y(e,"b","logicalAnd","bool");dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(DM,i)}const Gu=ce({logicalAnd_:pRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mRe(t){const n={x:Y(t,"x","logicalNot","bool")};return ue.runKernel($M,n)}const wR=ce({logicalNot_:mRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gRe(t,e){const n=Y(t,"a","logicalOr","bool"),r=Y(e,"b","logicalOr","bool");dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(LM,i)}const hW=ce({logicalOr_:gRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yRe(t,e){const n=Y(t,"a","logicalXor","bool"),r=Y(e,"b","logicalXor","bool");return dn(n.shape,r.shape),Gu(hW(t,e),wR(Gu(t,e)))}const Ooe=ce({logicalXor_:yRe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eN=2147483648;function vRe(t,e,n="left"){const r=Y(t,"sortedSequence","searchSorted"),i=Y(e,"values","searchSorted"),s=r.shape[r.shape.length-1],a=i.shape[i.shape.length-1],o=de(r,[-1,s]),l=de(i,[-1,a]);if(o.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(o.shape[0]!==l.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Oe(l.shape)>=eN)throw new Error(`values tensor size must less than ${eN}`);if(o.shape[1]>=eN)throw new Error(`trailing dim_size must less than ${eN} for int32 output type, was ${o.shape[1]}`);const c={sortedSequence:o,values:l},u={side:n};return ue.runKernel(DV,c,u)}const fW=ce({searchSorted_:vRe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xRe(t,e){return fW(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bRe(t,e,n,r,i){const s=Y(t,"x","maxPool"),a=1;let o=s,l=!1;s.rank===3&&(l=!0,o=de(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(o.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${o.rank}.`),q(ks(n,a),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),wa("maxPool",r,i);const c={x:o},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i},d=ue.runKernel(zM,c,u);return l?de(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const SR=ce({maxPool_:bRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wRe(t,e=[1,1,1],n,r,i,s="NDHWC"){const a=Y(t,"x","maxPool3d");let o=a,l=!1;a.rank===4&&(l=!0,o=de(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),q(o.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${o.rank}.`),q(s==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${s}`),wa("maxPool3d",r,i);const c={x:o},u={filterSize:e,strides:n,pad:r,dimRoundingMode:i,dataFormat:s},d=ue.runKernel(BM,c,u);return l?de(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Doe=ce({maxPool3d_:wRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SRe(t,e,n,r,i=!1){const a={x:Y(t,"x","maxPoolWithArgmax")},o={filterSize:e,strides:n,pad:r,includeBatchInIndex:i},l=ue.runKernel(wV,a,o);return{result:l[0],indexes:l[1]}}const _Re=ce({maxPoolWithArgmax_:SRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TRe(t,e){let n=Y(t,"a","maximum"),r=Y(e,"b","maximum");[n,r]=di(n,r),n.dtype==="bool"&&(n=nt(n,"int32"),r=nt(r,"int32")),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(pT,i)}const vh=ce({maximum_:TRe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ERe(t,e=null,n=!1){const i={x:Y(t,"x","mean")},s={axis:e,keepDims:n};return ue.runKernel(UM,i,s)}const ii=ce({mean_:ERe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pi(t,e="float32"){if(sl(t),e==="complex64"){const r=Pi(t,"float32"),i=Pi(t,"float32");return Wf(r,i)}const n=qs(Oe(t),e);return ue.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fo(t,e="float32"){if(sl(t),e==="complex64"){const r=fo(t,"float32"),i=Pi(t,"float32");return Wf(r,i)}const n=WU(Oe(t),e);return ue.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CRe(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let r=Y(t,"x","meshgrid",t instanceof rr?t.dtype:"float32");if(e===void 0)return[r];let i=Y(e,"y","meshgrid",e instanceof rr?e.dtype:"float32");const s=Oe(r.shape),a=Oe(i.shape);return n==="xy"?(r=de(r,[1,-1]),i=de(i,[-1,1]),[Mn(fo([a,1],r.dtype),r),Mn(i,fo([1,s],i.dtype))]):(r=de(r,[-1,1]),i=de(i,[1,-1]),[Mn(r,fo([1,a],r.dtype)),Mn(fo([s,1],i.dtype),i)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NRe(t,e){let n=Y(t,"a","minimum"),r=Y(e,"b","minimum");[n,r]=di(n,r),n.dtype==="bool"&&(n=nt(n,"int32"),r=nt(r,"int32")),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(mT,i)}const Xf=ce({minimum_:NRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ARe(t,e,n){q(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const r=Y(t,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");q(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const i=n==="reflect"?1:0;for(let o=0;o<r.rank;o++)q(e[o].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),q(e[o][0]>=0&&e[o][0]<=r.shape[o]-i&&e[o][1]>=0&&e[o][1]<=r.shape[o]-i,()=>`Padding in dimension ${o} cannot be greater than or equal to ${r.shape[o]-i} or less than 0 for input of shape ${r.shape}`);const s={paddings:e,mode:n},a={x:r};return ue.runKernel(WM,a,s)}const pW=ce({mirrorPad_:ARe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IRe(t,e){let n=Y(t,"a","mod"),r=Y(e,"b","mod");[n,r]=di(n,r);const i={a:n,b:r};return ue.runKernel(gT,i)}const $oe=ce({mod_:IRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kRe(t,e=null,n=!1){t=Y(t,"x","moments");const r=Nn(e,t.shape),i=ii(t,r,n);let s=i.shape;n||(s=bi(i.shape,r));const a=fr(ut(nt(t,"float32"),de(i,s))),o=ii(a,r,n);return{mean:i,variance:o}}const _R=ce({moments_:kRe});function MRe(t,e,n,r){const i=Y(e,"data","multiRNNCell"),s=UA(n,"c","multiRNNCell"),a=UA(r,"h","multiRNNCell");let o=i;const l=[];for(let d=0;d<t.length;d++){const h=t[d](o,s[d],a[d]);l.push(h[0]),l.push(h[1]),o=h[1]}const c=[],u=[];for(let d=0;d<l.length;d+=2)c.push(l[d]),u.push(l[d+1]);return[c,u]}const RRe=ce({multiRNNCell_:MRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PRe(t,e,n,r=!1){const i=Y(t,"logits","multinomial"),s=i.size,a=i.rank;if(s<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${s}.`);if(a>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${a}`);n=n||Math.random();const l={logits:a===1?de(i,[1,-1]):i},c={numSamples:e,seed:n,normalized:r},u=ue.runKernel(SV,l,c);return a===1?de(u,[u.size]):u}const ORe=ce({multinomial_:PRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DRe(t,e){let n=Y(t,"a","notEqual","string_or_numeric"),r=Y(e,"b","notEqual","string_or_numeric");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r};return ue.runKernel(GM,i)}const Xx=ce({notEqual_:DRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Re(t,e,n=1,r=0,i="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const a={indices:Y(t,"indices","oneHot","int32")},o={dtype:i,depth:e,onValue:n,offValue:r};return ue.runKernel(XM,a,o)}const mW=ce({oneHot_:$Re});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LRe(t){const n={x:Y(t,"x","onesLike")};return ue.runKernel(qM,n)}const tl=ce({onesLike_:LRe});function FRe(t,e){const n=Y(t,"v1","outerProduct"),r=Y(e,"v2","outerProduct");q(n.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${r.rank}.`);const i=de(n,[-1,1]),s=de(r,[1,-1]);return Mn(i,s)}const jRe=ce({outerProduct_:FRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zRe(t,e,n=0){const r=Y(t,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const i={paddings:e,constantValue:n},s={x:r};return ue.runKernel(YM,s,i)}const Gc=ce({pad_:zRe});function BRe(t,e,n=0){return q(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),Gc(t,[e],n)}const URe=ce({pad1d_:BRe});function VRe(t,e,n=0){return q(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gc(t,e,n)}const WRe=ce({pad2d_:VRe});function HRe(t,e,n=0){return q(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gc(t,e,n)}const GRe=ce({pad3d_:HRe});function qRe(t,e,n=0){return q(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Gc(t,e,n)}const XRe=ce({pad4d_:qRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KRe(t,e,n){const r=Y(t,"x","spaceToBatchND");q(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),q(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),q(r.shape.reduce((a,o,l)=>l>0&&l<=e.length?a&&(o+n[l-1][0]+n[l-1][1])%e[l-1]===0:a,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const i={x:r},s={blockShape:e,paddings:n};return ue.runKernel(aR,i,s)}const TR=ce({spaceToBatchND_:KRe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YRe(t,e,n,r,i,s,a){i==null&&(i=[1,1]),s==null&&(s=1),r===0&&(r="valid");const o=Y(t,"x","maxPool");let l=o,c=!1;o.rank===3&&(c=!0,l=de(o,[1,o.shape[0],o.shape[1],o.shape[2]])),q(ks(s,i),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${s} and dilations '${i}'`);const u=Zl(l.shape,e,s,i,r),d=[u.dilationHeight,u.dilationWidth];let h;r==="same"?h=QRe([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,g]=ZRe([u.inHeight,u.inWidth],d,h),m=f?r:"valid",y=f?l:TR(l,d,p),b=(n==="avg"?()=>pR(y,e,s,m,a):()=>SR(y,e,s,m,a))(),_=f?b:mR(b,d,g);return c?de(_,[_.shape[1],_.shape[2],_.shape[3]]):_}function ZRe(t,e,n){const r=n.map(u=>u[0]),i=n.map(u=>u[1]),s=t.concat(r,i),a=e.map((u,d)=>(u-s[d]%u)%u),o=i.map((u,d)=>u+a[d]),l=e.map((u,d)=>[r[d],o[d]]),c=e.map((u,d)=>[0,a[d]]);return[l,c]}function QRe(t,e){const r=t.map((a,o)=>a+(a-1)*(e[o]-1)).map(a=>a-1),i=r.map(a=>Math.floor(a/2)),s=r.map((a,o)=>a-i[o]);return r.map((a,o)=>[i[o],s[o]])}const Loe=ce({pool_:YRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JRe(t,e){const n=Y(t,"x","prelu"),r=Y(e,"alpha","prelu"),i={x:n,alpha:r};return ue.runKernel(ZM,i)}const ER=ce({prelu_:JRe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t,e=null,n=!1){let r=Y(t,"x","prod");r.dtype==="bool"&&(r=nt(r,"int32"));const i={x:r},s={axis:e,keepDims:n};return ue.runKernel(QM,i,s)}const Foe=ce({prod_:ePe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tPe(t,e,n,r){const i=t.map((u,d)=>Y(u,`tensors${d}`,"raggedGather","int32")),s=Y(e,"paramsDenseValues","raggedGather"),a=Y(n,"indices","raggedGather","int32"),o={paramsNestedSplits:i,paramsDenseValues:s,indices:a},l={outputRaggedRank:r},c=ue.runKernel(CV,o,l);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const nPe=ce({raggedGather_:tPe});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rPe(t,e,n){const r=Y(t,"starts","raggedRange"),i=Y(e,"limits","raggedRange",r.dtype),s=Y(n,"deltas","raggedRange",r.dtype),a={starts:r,limits:i,deltas:s},o=ue.runKernel(NV,a);return{rtNestedSplits:o[0],rtDenseValues:o[1]}}const iPe=ce({raggedRange_:rPe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sPe(t,e,n,r,i){const s=Y(t,"shape","raggedTensorToTensor","int32"),a=Y(e,"values","raggedTensorToTensor"),o=Y(n,"defaultValue","raggedTensorToTensor",a.dtype),l=r.map((d,h)=>Y(d,`tensors${h}`,"raggedTensorToTensor","int32")),c={shape:s,values:a,defaultValue:o,rowPartitionTensors:l},u={rowPartitionTypes:i};return ue.runKernel(AV,c,u)}const aPe=ce({raggedTensorToTensor_:sPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oPe(t,e,n){sl(t);const r=Oe(t);let i=null;if(n==null||n==="float32")i=new Float32Array(r);else if(n==="int32")i=new Int32Array(r);else if(n==="bool")i=new Uint8Array(r);else throw new Error(`Unknown data type ${n}`);for(let s=0;s<r;s++)i[s]=e();return ue.makeTensor(i,t,n)}const lPe=ce({rand_:oPe});var gW={exports:{}};gW.exports;(function(t){(function(e,n,r){function i(l){var c=this,u=o();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function s(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function a(l,c){var u=new i(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&s(d,u),h.state=function(){return s(u,{})}),h}function o(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=a:this.alea=a})(kc,t)})(gW);var cPe=gW.exports,yW={exports:{}};yW.exports;(function(t){(function(e,n,r){function i(o){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},o===(o|0)?l.x=o:c+=o;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l}function a(o,l){var c=new i(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=a:this.xor128=a})(kc,t)})(yW);var uPe=yW.exports,vW={exports:{}};vW.exports;(function(t){(function(e,n,r){function i(o){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,o===(o|0)?l.x=o:c+=o;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function s(o,l){return l.x=o.x,l.y=o.y,l.z=o.z,l.w=o.w,l.v=o.v,l.d=o.d,l}function a(o,l){var c=new i(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=a:this.xorwow=a})(kc,t)})(vW);var dPe=vW.exports,xW={exports:{}};xW.exports;(function(t){(function(e,n,r){function i(o){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,o)}function s(o,l){return l.x=o.x.slice(),l.i=o.i,l}function a(o,l){o==null&&(o=+new Date);var c=new i(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=a:this.xorshift7=a})(kc,t)})(xW);var hPe=xW.exports,bW={exports:{}};bW.exports;(function(t){(function(e,n,r){function i(o){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,g,m,y=[],x=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,x=Math.max(x,d.length)),p=0,g=-32;g<x;++g)d&&(f^=d.charCodeAt((g+32)%d.length)),g===0&&(m=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,g>=0&&(m=m+1640531527|0,h=y[g&127]^=f+m,p=h==0?p+1:0);for(p>=128&&(y[(d&&d.length||0)&127]=-1),p=127,g=4*128;g>0;--g)f=y[p+34&127],h=y[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,y[p]=f^h;u.w=m,u.X=y,u.i=p}c(l,o)}function s(o,l){return l.i=o.i,l.w=o.w,l.X=o.X.slice(),l}function a(o,l){o==null&&(o=+new Date);var c=new i(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=a:this.xor4096=a})(kc,t)})(bW);var fPe=bW.exports,wW={exports:{}};wW.exports;(function(t){(function(e,n,r){function i(o){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,o===Math.floor(o)?(l.a=o/4294967296|0,l.b=o|0):c+=o;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function s(o,l){return l.a=o.a,l.b=o.b,l.c=o.c,l.d=o.d,l}function a(o,l){var c=new i(o),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&s(u,c),d.state=function(){return s(c,{})}),d}n&&n.exports?n.exports=a:this.tychei=a})(kc,t)})(wW);var pPe=wW.exports,joe={exports:{}};const mPe={},gPe=Object.freeze(Object.defineProperty({__proto__:null,default:mPe},Symbol.toStringTag,{value:"Module"})),yPe=d1e(gPe);(function(t){(function(e,n,r){var i=256,s=6,a=52,o="random",l=r.pow(i,s),c=r.pow(2,a),u=c*2,d=i-1,h;function f(_,T,E){var C=[];T=T==!0?{entropy:!0}:T||{};var I=y(m(T.entropy?[_,b(n)]:_??x(),3),C),A=new p(C),k=function(){for(var R=A.g(s),$=l,z=0;R<c;)R=(R+z)*i,$*=i,z=A.g(1);for(;R>=u;)R/=2,$/=2,z>>>=1;return(R+z)/$};return k.int32=function(){return A.g(4)|0},k.quick=function(){return A.g(4)/4294967296},k.double=k,y(b(A.S),n),(T.pass||E||function(R,$,z,O){return O&&(O.S&&g(O,A),R.state=function(){return g(A,{})}),z?(r[o]=R,$):R})(k,I,"global"in T?T.global:this==r,T.state)}function p(_){var T,E=_.length,C=this,I=0,A=C.i=C.j=0,k=C.S=[];for(E||(_=[E++]);I<i;)k[I]=I++;for(I=0;I<i;I++)k[I]=k[A=d&A+_[I%E]+(T=k[I])],k[A]=T;(C.g=function(R){for(var $,z=0,O=C.i,j=C.j,B=C.S;R--;)$=B[O=d&O+1],z=z*i+B[d&(B[O]=B[j=d&j+$])+(B[j]=$)];return C.i=O,C.j=j,z})(i)}function g(_,T){return T.i=_.i,T.j=_.j,T.S=_.S.slice(),T}function m(_,T){var E=[],C=typeof _,I;if(T&&C=="object")for(I in _)try{E.push(m(_[I],T-1))}catch{}return E.length?E:C=="string"?_:_+"\0"}function y(_,T){for(var E=_+"",C,I=0;I<E.length;)T[d&I]=d&(C^=T[d&I]*19)+E.charCodeAt(I++);return b(T)}function x(){try{var _;return h&&(_=h.randomBytes)?_=_(i):(_=new Uint8Array(i),(e.crypto||e.msCrypto).getRandomValues(_)),b(_)}catch{var T=e.navigator,E=T&&T.plugins;return[+new Date,e,E,e.screen,b(n)]}}function b(_){return String.fromCharCode.apply(0,_)}if(y(r.random(),n),t.exports){t.exports=f;try{h=yPe}catch{}}else r["seed"+o]=f})(typeof self<"u"?self:kc,[],Math)})(joe);var vPe=joe.exports,xPe=cPe,bPe=uPe,wPe=dPe,SPe=hPe,_Pe=fPe,TPe=pPe,Yg=vPe;Yg.alea=xPe;Yg.xor128=bPe;Yg.xorwow=wPe;Yg.xorshift7=SPe;Yg.xor4096=_Pe;Yg.tychei=TPe;var CR=Yg;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SW{constructor(e,n,r,i,s){this.mean=e,this.stdDev=n,this.dtype=r,this.nextVal=NaN,this.truncated=i,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const a=s||Math.random();this.random=CR.alea(a.toString())}nextValue(){if(!isNaN(this.nextVal)){const i=this.nextVal;return this.nextVal=NaN,i}let e,n,r=!1;for(;!r;){let i,s,a;do i=2*this.random()-1,s=2*this.random()-1,a=i*i+s*s;while(a>=1||a===0);const o=Math.sqrt(-2*Math.log(a)/a);e=this.mean+this.stdDev*i*o,n=this.mean+this.stdDev*s*o,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class EPe{constructor(e,n,r,i){this.alpha=e,this.beta=1/n,this.dtype=r;const s=i||Math.random();this.randu=CR.alea(s.toString()),this.randn=new SW(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,r,i,s,a;for(;;){do i=this.randn.nextValue(),a=1+this.c*i;while(a<=0);if(a*=a*a,e=i*i,n=1-.331*e*e,r=.5*e+this.d*(1-a+Math.log(a)),s=this.randu(),s<n||Math.log(s)<r)break}return a=1/this.beta*this.d*a,this.alpha<1&&(a*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(a)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class CPe{constructor(e=0,n=1,r,i){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=r,i==null&&(i=Math.random()),typeof i=="number"&&(i=i.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=CR.alea(i)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NPe(t,e,n=1,r="float32",i){if(sl(t),n==null&&(n=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const s=new EPe(e,n,r,i),a=yn(t,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const APe=ce({randomGamma_:NPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IPe(t,e=0,n=1,r,i){if(sl(t),r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const s=new SW(e,n,r,!1,i),a=yn(t,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const _W=ce({randomNormal_:IPe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kPe(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return _W(t,0,1,e,n)}const MPe=ce({randomStandardNormal_:kPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RPe(t,e=0,n=1,r="float32",i){sl(t);const s=yn(t,r),a=new CPe(e,n,null,i);for(let o=0;o<s.values.length;o++)s.values[o]=a.nextValue();return s.toTensor()}const Zg=ce({randomUniform_:RPe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PPe(t,e,n,r){return Zg(t,e,n,"int32",r)}const OPe=ce({randomUniformInt_:PPe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kx(t,e,n=1,r="float32"){if(n===0)throw new Error("Cannot have a step of zero");const i={start:t,stop:e,step:n,dtype:r};return ue.runKernel(IV,{},i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPe(t){const n={input:Y(t,"input","real")};return ue.runKernel(kV,n)}const Q1=ce({real_:DPe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Pe(t){const n={x:Y(t,"x","reciprocal")};return ue.runKernel(xT,n)}const zoe=ce({reciprocal_:$Pe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LPe(t){const n={x:Y(t,"x","relu")};return ue.runKernel(bT,n)}const rd=ce({relu_:LPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FPe(t){const n={x:Y(t,"x","relu6")};return ue.runKernel(wT,n)}const TW=ce({relu6_:FPe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jPe(t,e){const r={x:Y(t,"x","reverse")},i={dims:e};return ue.runKernel(nR,r,i)}const ql=ce({reverse_:jPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zPe(t){const e=Y(t,"x","reverse");return q(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),ql(e,0)}const BPe=ce({reverse1d_:zPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UPe(t,e){const n=Y(t,"x","reverse");return q(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),ql(n,e)}const VPe=ce({reverse2d_:UPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WPe(t,e){const n=Y(t,"x","reverse");return q(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),ql(n,e)}const HPe=ce({reverse3d_:WPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GPe(t,e){const n=Y(t,"x","reverse");return q(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),ql(n,e)}const qPe=ce({reverse4d_:GPe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XPe(t){const n={x:Y(t,"x","round")};return ue.runKernel(ST,n)}const EW=ce({round_:XPe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KPe(t){const n={x:Y(t,"x","rsqrt","float32")};return ue.runKernel(_T,n)}const CW=ce({rsqrt_:KPe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YPe(t){const n={x:Y(t,"x","selu")};return ue.runKernel(TT,n)}const NW=ce({selu_:YPe});function ZPe(t,e,n,r,i,s=[1,1],a="NHWC"){const o=Y(t,"x","separableConv2d"),l=Y(e,"depthwiseFilter","separableConv2d"),c=Y(n,"pointwiseFilter","separableConv2d");let u=o,d=!1;if(o.rank===3&&(d=!0,u=de(o,[1,o.shape[0],o.shape[1],o.shape[2]])),a==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");q(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),q(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),q(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),q(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),q(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];q(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=zT(u,l,r,i,a,s),m=qf(p,c,1,"valid",a);return d?de(m,[m.shape[1],m.shape[2],m.shape[3]]):m}const AW=ce({separableConv2d_:ZPe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function QPe(t,e){const n=Y(t,"x","setdiff1d"),r=Y(e,"y","setdiff1d");q(n.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${r.dtype}).`),q(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),q(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const i=await n.data(),s=await r.data(),a=new Set(s);let o=0;for(let u=0;u<i.length;u++)a.has(i[u])||o++;const l=new Hi([o],n.dtype),c=new Hi([o],"int32");for(let u=0,d=0;u<i.length;u++)a.has(i[u])||(l.values[d]=i[u],c.values[d]=u,d++);return[l.toTensor(),c.toTensor()]}const JPe=QPe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eOe(t){const n={x:Y(t,"x","sign")};return ue.runKernel(NT,n)}const Boe=ce({sign_:eOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tOe(t){const n={x:Y(t,"x","sin","float32")};return ue.runKernel(ET,n)}const IW=ce({sin_:tOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nOe(t){const n={x:Y(t,"x","sinh")};return ue.runKernel(CT,n)}const kW=ce({sinh_:nOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rOe(t,e,n){const r=Y(t,"x","slice1d");return q(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Kt(r,[e],[n])}const NR=ce({slice1d_:rOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iOe(t,e,n){const r=Y(t,"x","slice2d");return q(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const MW=ce({slice2d_:iOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sOe(t,e,n){const r=Y(t,"x","slice3d");return q(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const AR=ce({slice3d_:sOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aOe(t,e,n){const r=Y(t,"x","slice4d");return q(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Kt(r,e,n)}const J1=ce({slice4d_:aOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oOe(t,e=-1){const n=Y(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const r={logits:n},i={dim:e};return ue.runKernel(lR,r,i)}const IR=ce({softmax_:oOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lOe(t){q(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return ue.runKernel(dV,e)}const kR=ce({fft_:lOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOe(t){q(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return ue.runKernel(mV,e)}const eS=ce({ifft_:cOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uOe(t){const e=t.shape[t.shape.length-1],n=t.size/e;let r;if(e<=2){const i=de(t,[n,e]);r=eS(i)}else{const i=[n,2*(e-1)],s=de(Q1(t),[n,e]),a=de(yR(t),[n,e]),o=ql(Kt(s,[0,1],[n,e-2]),1),l=se(ql(Kt(a,[0,1],[n,e-2]),1),It(-1)),c=Qr([s,o],1),u=Qr([a,l],1),d=de(Wf(c,u),[i[0],i[1]]);r=eS(d)}if(r=Q1(r),t.rank===3&&t.shape[0]!==0){const i=r,s=t.shape[0];r=de(r,[s,r.shape[0]/s,r.shape[1]]),i.dispose()}return r}const RW=ce({irfft_:uOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOe(t,e,n=0){const i={x:Y(t,"x","split")},s={numOrSizeSplits:e,axis:n};return ue.runKernel(oR,i,s)}const vo=ce({split_:dOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hOe(t,e){q(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const r=t.size/n;let i;if(e!=null&&e<n){const p=t.shape.map(m=>0),g=t.shape.map(m=>m);g[t.shape.length-1]=e,i=Kt(t,p,g),n=e}else if(e!=null&&e>n){const p=t.shape.map(g=>g);p[t.shape.length-1]=e-n,i=Qr([t,Pi(p)],t.shape.length-1),n=e}else i=t;const s=Fn(i),a=de(Wf(i,s),[r,n]),o=kR(a),l=Math.floor(n/2)+1,c=Q1(o),u=yR(o),d=vo(c,[l,n-l],c.shape.length-1),h=vo(u,[l,n-l],u.shape.length-1),f=i.shape.slice();return f[i.shape.length-1]=l,de(Wf(d[0],h[0]),f)}const MR=ce({rfft_:hOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fOe(t,e){let n=Y(t,"a","squaredDifference"),r=Y(e,"b","squaredDifference");[n,r]=di(n,r),dn(n.shape,r.shape);const i={a:n,b:r},s={};return ue.runKernel(MT,i,s)}const PW=ce({squaredDifference_:fOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pOe(t,e){const n=Y(t,"x","squeeze","string_or_numeric");return de(n,dp(n.shape,e).newShape)}const Yn=ce({squeeze_:pOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOe(t,e=0){const n=UA(t,"tensors","stack","string_or_numeric");q(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&q(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const r=n,i={axis:e};return ue.runKernel(KM,r,i)}const wo=ce({stack_:mOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gOe(t,e=0){const r={x:Y(t,"x","step")},i={alpha:e};return ue.runKernel($T,r,i)}const Z0=ce({step_:gOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOe(t,e,n,r,i=0,s=0,a=0,o=0,l=0){const u={x:Y(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:r,beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};return ue.runKernel(UV,u,d)}const Uoe=ce({stridedSlice_:yOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vOe(t){const n={x:Y(t,"x","tan","float32")};return ue.runKernel(PT,n)}const Voe=ce({tan_:vOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oi(t,e){H0(t);const n=fp(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return pp(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ul(t,e,n){if(H0(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=fp(t,n);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return pp(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Woe(t,e,n){if(H0(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=fp(t,n);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return pp(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xOe(t,e,n){if(H0(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=fp(t,n);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return pp(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bOe(t,e,n){if(H0(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=fp(t,n);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return pp(t,e,r,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wOe(t,e,n){if(H0(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=fp(t,n);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,pp(t,e,r,n)}function Hoe(t,e,n){const r=e.rank>1?e.shape[e.rank-1]:1,i=e.rank>1?e.rank-1:1,s=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${r}, and batchDim: ${i}.`;if(n.rank<i)throw new Error(s+` update.rank < ${i}. `);if(t.length<r+(n.rank-i))throw new Error(s+` Output shape length < ${r+(n.rank-i)}`);if(n.rank!==i+t.length-r)throw new Error(s+` update.rank != ${i+t.length-r}`);for(let a=0;a<i;++a)if(n.shape[a]!==e.shape[a])throw new Error(s+` updates.shape[${a}] (${n.shape[a]}) != indices.shape[${a}] (${e.shape[a]}).`);for(let a=0;a<n.rank-i;++a)if(n.shape[a+i]!==t[a+r])throw new Error(s+` updates.shape[${a+i}] (${n.shape[a+i]}) != shape[${a+i}] (${t[a+i]})`)}function OW(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}Hoe(n,e,t)}function Qg(t,e,n){const r=e.shape.length,i=r>1?e.shape[r-1]:1,s=n.length;let a=1;for(let d=i;d<s;++d)a*=n[d];const o=i<1?1:i,l=Oe(e.shape)/o,c=[...Ft(n.slice(0,i)),1],u=Oe(n);return{sliceRank:i,numUpdates:l,sliceSize:a,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SOe(t,e,n){const r=Y(t,"tensor","tensorScatterupdate"),i=Y(e,"indices","tensorScatterupdate","int32"),s=Y(n,"updates","tensorScatterupdate");if(OW(s,i,r.shape),r.dtype!==s.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${r.dtype} and ${s.dtype}.`);const a={tensor:r,indices:i,updates:s},o={};return ue.runKernel(OV,a,o)}const _Oe=ce({tensorScatterUpdate_:SOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TOe(t,e=1,n=!0){const r=Y(t,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const i=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>i)throw new Error(`'k' passed to topk() must be <= the last dimension (${i}) but got ${e}`);const s={x:r},a={k:e,sorted:n},[o,l]=ue.runKernel(GV,s,a);return{values:o,indices:l}}const Goe=ce({topk_:TOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EOe(t,e=0,n=1,r,i){if(sl(t),r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const s=new SW(e,n,r,!0,i),a=yn(t,r);for(let o=0;o<a.values.length;o++)a.values[o]=s.nextValue();return a.toTensor()}const DW=ce({truncatedNormal_:EOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function COe(t,e=0){const n=Y(t,"x","unique","string_or_numeric");q(n.rank>0,()=>"The input tensor must be at least 1D");const r={x:n},i={axis:e},[s,a]=ue.runKernel(XV,r,i);return{values:s,indices:a}}const qoe=ce({unique_:COe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NOe(t,e,n){const r=Y(t,"x","unsortedSegmentSum"),i=Y(e,"segmentIds","unsortedSegmentSum","int32");q(Wx(n),()=>"numSegments must be of dtype int");const s={x:r,segmentIds:i},a={numSegments:n};return ue.runKernel(dR,s,a)}const $W=ce({unsortedSegmentSum_:NOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOe(t,e=0){const n=Y(t,"x","unstack","string_or_numeric");q(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const r={value:n},i={axis:e};return ue.runKernel(uR,r,i)}const Xl=ce({unstack_:AOe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IOe(t,e){return fW(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xoe(t,e=!0,n,r){return ue.makeVariable(t,e,n,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LW(t,e){const n=[];for(let s=0;s<e.length;s++)e[s]&&n.push(s);const r=yn(t,"int32"),i=yn([n.length,t.length],"int32");for(let s=0;s<n.length;s++){const a=r.indexToLoc(n[s]),o=s*t.length;i.values.set(a,o)}return i.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function kOe(t){const e=Y(t,"condition","whereAsync","bool"),n=await e.data(),r=LW(e.shape,n);return t!==e&&e.dispose(),r}const Koe=kOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function MOe(t,e,n){const r=Y(t,"tensor","boolMask"),i=Y(e,"mask","boolMask","bool"),s=n??0,a=i.rank,o=r.shape;q(a>0,()=>"mask cannot be scalar"),To(o.slice(s,s+a),i.shape,"mask's shape must match the first K dimensions of tensor's shape,");let l=1;for(let g=s;g<s+a;g++)l*=o[g];const c=o.slice(0,s).concat([l],o.slice(s+a)),u=de(r,c),d=de(i,[-1]),h=await Koe(d),f=Yn(h,[1]),p=WT(u,f,s);return t!==r&&r.dispose(),e!==i&&i.dispose(),f.dispose(),u.dispose(),d.dispose(),h.dispose(),p}const ROe=MOe;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function POe(t,e,n){const r=Y(t,"x","transpose");if(e==null&&(e=r.shape.map((a,o)=>o).reverse()),q(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(a=>{q(a>=0&&a<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const i={x:r},s={perm:e};return r.dtype==="complex64"?ve(()=>{let a=Q1(r),o=yR(r);return a=ue.runKernel(nx,{x:a},s),o=ue.runKernel(nx,{x:o},s),n&&(o=Dr(o)),Wf(a,o)}):ue.runKernel(nx,i,s)}const Ln=ce({transpose_:POe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OOe(t,e,n,r,i=!0){const s=Y(t,"v","movingAverage"),a=Y(e,"x","movingAverage"),o=Y(n,"decay","movingAverage");SIe(s,a),q(Pn(s.shape,a.shape),()=>"Shape mismatch in v and x");const l=It(1),c=ut(l,o);let u=se(ut(a,s),c);if(i){q(r!=null,()=>"When using zeroDebias: true, step is required.");const d=Y(r,"step","movingAverage");u=ct(u,ut(l,nh(o,d)))}return He(s,u)}const DOe=ce({movingAverage_:OOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Oe(t,e,n){sl(n);const r=Y(t,"indices","scatterND","int32"),i=Y(e,"updates","scatterND");OW(i,r,n);const s={indices:r,updates:i},a={shape:n};return ue.runKernel(PV,s,a)}const LOe=ce({scatterND_:$Oe});function FOe(t,e,n,r){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const i=t.rank>0?t.shape[0]:1,s=t.rank>1?t.shape[1]:1;if(n.length!==s)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${s}.`);const a=e.size;if(!(e.rank===0||e.rank===1&&a===i))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${i}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jOe(t,e,n,r=0){sl(n);const i=Y(t,"sparseIndices","sparseToDense","int32"),s=Y(e,"sparseValues","sparseToDense","string_or_numeric"),a=Y(r,"defaultValue","sparseToDense",s.dtype);FOe(i,s,n,a);const o={sparseIndices:i,sparseValues:s,defaultValue:a},l={outputShape:n};return ue.runKernel(zV,o,l)}const zOe=ce({sparseToDense_:jOe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOe(t,e){const n=Y(e,"indices","gatherND","int32"),i={params:Y(t,"x","gatherND","string_or_numeric"),indices:n};return ue.runKernel(pV,i)}const UOe=ce({gatherND_:BOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VOe(t,e){if(e==null)return t.shape.slice();if(Pn(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let r=0;r<t.shape.length;r++)e[r]==null&&t.shape[r]!=null?n.push(t.shape[r]):n.push(e[r]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WOe(t,e,n,r){const i=Y(t,"x","dropout");if(q(i.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${i.dtype} tensor instead.`),q(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof rr?i.clone():i;const s=VOe(i,n),a=1-e,o=ct(VT(He(Zg(s,0,1,"float32",r),a)),a);return se(i,o)}const Yoe=ce({dropout_:WOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zoe(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function FW(t,e,n){const r=1-t%2,i=new Float32Array(t);for(let s=0;s<t;++s){const a=2*Math.PI*s/(t+r-1);i[s]=e-n*Math.cos(a)}return Oi(i,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function HOe(t,e,n=1){const r=Y(t,"predictions","inTopK"),i=Y(e,"targets","inTopK");q(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),q(r.rank-1===i.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${i.rank}`),To(r.shape.slice(0,r.shape.length-1),i.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const s=r.shape[r.shape.length-1];q(n>0&&n<=s,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${s}), but got ${n}`);const a=await r.data(),o=await i.data(),[l,c]=[a.length/s,s],u=As("bool",l);for(let d=0;d<l;d++){const h=d*c,f=a.subarray(h,h+c),p=[];for(let g=0;g<f.length;g++)p.push({value:f[g],index:g});p.sort((g,m)=>m.value-g.value),u[d]=0;for(let g=0;g<n;g++)if(p[g].index===o[d]){u[d]=1;break}}return t!==r&&r.dispose(),e!==i&&i.dispose(),Fc(u,i.shape,"bool")}const GOe=HOe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qOe(t,e,n,r,i,s="NHWC",a){let o=t;t.rank===3&&(o=de(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=de(e,[1,e.shape[0],e.shape[1],e.shape[2]])),q(o.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${o.shape}.`),q(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),q(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=s==="NHWC"?o.shape[3]:o.shape[1],u=s==="NHWC"?l.shape[3]:l.shape[1];q(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),q(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),wa("conv2dDerFilter",i,a);const d={x:o,dy:l},h={strides:r,pad:i,dataFormat:s,dimRoundingMode:a,filterShape:n};return ue.runKernel(JU,d,h)}const jW=ce({conv2DBackpropFilter_:qOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RR(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return se(t,Z0(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function PR(t,e){let n=e;const r=Yi(t.shape,e.shape);return r.length>0&&(n=Et(n,r)),de(n,t.shape)}function OR(t,e,n,r){if(e==="linear")return t;if(e==="relu")return rd(t);if(e==="elu")return BT(t);if(e==="relu6")return TW(t);if(e==="prelu")return ER(t,n);if(e==="leakyrelu")return vR(t,r);if(e==="sigmoid")return Ko(t);throw new Error(`Unknown fused activation ${e}.`)}const DR=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOe({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",DR(ue.state.gradientDepth,l)===!1){q(i==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${i} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let E=qf(t,e,n,r,i,s,a);return o!=null&&(E=He(E,o)),OR(E,l,c,u)}const d=Y(t,"x","conv2d","float32"),h=Y(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=de(d,[1,d.shape[0],d.shape[1],d.shape[2]])),q(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),q(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),wa("fused conv2d",r,a);const g=i==="NHWC"?f.shape[3]:f.shape[1];q(h.shape[2]===g,()=>`Error in conv2d: depth of input (${g}) must match input depth for filter ${h.shape[2]}.`),q(ks(n,s),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`);const m=hs(f.shape,h.shape,n,s,r,a);let y;o!=null&&(y=Y(o,"bias","fused conv2d"),[y]=di(y,d),i==="NHWC"?dn(m.outShape,y.shape):(q(y.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${y.shape.length}.`),q(y.shape.length===0||y.shape[0]===m.outChannels||y.shape[0]===1,()=>`Error in fused conv2d: bias shape (${y.shape}) is not compatible with the number of output channels (${m.outChannels})`)));let x;if(c!=null){const E=c.shape;if(q(E.length<=1||E.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${E.length}.`),E.length===1)q(E[0]===1||E[0]===m.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the number of output channels (${m.outChannels}).`);else if(E.length===3)try{dn(E,m.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${E}) is not compatible with the output shape of the conv2d (${m.outShape}).`;throw Error(I)}x=Y(c,"prelu weights","fused conv2d")}const b=(E,C)=>{q(i==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${i} but only NHWC is currently supported.`);const[I,A,k,R]=C,$=RR(E,k,l);q(Gf(s),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const z=iW(A.shape,$,I,n,r),O=jW(A,$,I.shape,n,r),j=[z,O];if(R!=null){const B=PR(R,$);j.push(B)}return j},_={x:f,filter:h,bias:y,preluActivationWeights:x},T={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:u};return o==null?rh((C,I,A)=>{let k=ue.runKernel($A,_,T);return A([I,C,k]),p&&(k=de(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:b}})(f,h):rh((C,I,A,k)=>{let R=ue.runKernel($A,_,T);return k([I,C,R,A]),p&&(R=de(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:b}})(f,h,y)}const Qoe=ce({fusedConv2d_:XOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KOe(t,e,n,r,i,s=[1,1],a){let o=t;t.rank===3&&(o=de(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=de(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:o,dy:l},u={strides:r,pad:i,dimRoundingMode:a,dilations:s,filterShape:n};return ue.runKernel(aV,c,u)}const Joe=ce({depthwiseConv2dNativeBackpropFilter_:KOe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOe(t,e,n,r,i,s=[1,1],a){let o=e,l=!1;e.rank===3&&(l=!0,o=de(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:o,filter:n},u={strides:r,pad:i,dimRoundingMode:a,dilations:s,inputShape:t},d=ue.runKernel(oV,c,u);return l?de(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const ele=ce({depthwiseConv2dNativeBackpropInput_:YOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe({x:t,filter:e,strides:n,pad:r,dataFormat:i="NHWC",dilations:s=[1,1],dimRoundingMode:a,bias:o,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(DR(ue.state.gradientDepth,l)===!1){let T=zT(t,e,n,r,i,s,a);return o!=null&&(T=He(T,o)),OR(T,l,c,u)}const d=Y(t,"x","depthwiseConv2d","float32"),h=Y(e,"filter","depthwiseConv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=de(d,[1,d.shape[0],d.shape[1],d.shape[2]])),q(f.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${f.rank}.`),q(h.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${h.rank}.`),q(f.shape[3]===h.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${f.shape[3]}) must match the inChannels dimension in filter ${h.shape[2]}.`),s==null&&(s=[1,1]),q(ks(n,s),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${s}'`),wa("fused depthwiseConv2d",r,a);const g=hs(f.shape,h.shape,n,s,r,a,!0);let m;o!=null&&(m=Y(o,"bias","fused conv2d"),[m]=di(m,d),dn(g.outShape,m.shape));let y;c!=null&&(y=Y(c,"prelu weights","fused depthwiseConv2d"));const x=(T,E)=>{q(Gf(s),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${s}'`);const[C,I,A,k]=E,R=RR(T,A,l),$=ele(I.shape,R,C,n,r,s,a),z=Joe(I,R,C.shape,n,r,s,a);if(k!=null){const O=PR(m,R);return[$,z,O]}return[$,z]},b={x:f,filter:h,bias:m,preluActivationWeights:y},_={strides:n,pad:r,dataFormat:i,dilations:s,dimRoundingMode:a,activation:l,leakyreluAlpha:u};return o==null?rh((E,C,I)=>{let A=ue.runKernel(LA,b,_);return I([C,E,A]),p&&(A=de(A,[A.shape[1],A.shape[2],A.shape[3]])),{value:A,gradFunc:x}})(f,h):rh((E,C,I,A)=>{let k=ue.runKernel(LA,b,_);return A([C,E,k,I]),p&&(k=de(k,[k.shape[1],k.shape[2],k.shape[3]])),{value:k,gradFunc:x}})(f,h,m)}const QOe=ce({fusedDepthwiseConv2d_:ZOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOe({a:t,b:e,transposeA:n=!1,transposeB:r=!1,bias:i,activation:s="linear",preluActivationWeights:a,leakyreluAlpha:o=.2}){if(DR(ue.state.gradientDepth,s)===!1){let R=Mn(t,e,n,r);return i!=null&&(R=He(R,i)),OR(R,s,a,o)}let l=Y(t,"a","fused matMul"),c=Y(e,"b","fused matMul");[l,c]=di(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=r?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=r?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),g=c.shape.slice(0,-2),m=Oe(p),y=Oe(g);q(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${r} must match.`);const b=dn(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),_=n?de(l,[m,u,h]):de(l,[m,h,u]),T=r?de(c,[y,f,d]):de(c,[y,d,f]);let E;i!=null&&(E=Y(i,"bias","fused matMul"),[E]=di(E,l),dn(b,E.shape));let C;a!=null&&(C=Y(a,"prelu weights","fused matMul"));const I=(R,$)=>{const[z,O,j,B]=$,W=RR(de(R,j.shape),j,s);let L,V;if(!n&&!r?(L=Mn(W,O,!1,!0),V=Mn(z,W,!0,!1)):!n&&r?(L=Mn(W,O,!1,!1),V=Mn(W,z,!0,!1)):n&&!r?(L=Mn(O,W,!1,!0),V=Mn(z,W,!1,!1)):(L=Mn(O,W,!0,!0),V=Mn(W,z,!0,!0)),i!=null){const H=PR(B,W);return[L,V,H]}else return[L,V]},A={a:_,b:T,bias:E,preluActivationWeights:C},k={transposeA:n,transposeB:r,activation:s,leakyreluAlpha:o};return i==null?rh(($,z,O)=>{const j=ue.runKernel(DA,A,k);return O([$,z,j]),{value:de(j,b),gradFunc:I}})(_,T):rh(($,z,O,j)=>{const B=ue.runKernel(DA,A,k);return j([$,z,B,O]),{value:de(B,b),gradFunc:I}})(_,T,E)}const cj=ce({fusedMatMul_:JOe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eDe=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Qoe,depthwiseConv2d:QOe,matMul:cj},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDe(t){return FW(t,.54,.46)}const nDe=ce({hammingWindow_:tDe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(t){return FW(t,.5,.5)}const tle=ce({hannWindow_:rDe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iDe(t,e,n,r=!1,i=0){let s=0;const a=[];for(;s+e<=t.size;)a.push(Kt(t,s,e)),s+=n;if(r)for(;s<t.size;){const o=s+e-t.size,l=Qr([Kt(t,s,e-o),K0([o],i)]);a.push(l),s+=n}return a.length===0?Ul([],[0,e]):de(Qr(a),[a.length,e])}const nle=ce({frame_:iDe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sDe(t,e,n,r,i=tle){r==null&&(r=Zoe(e));const s=nle(t,e,n),a=se(s,i(e));return MR(a,r)}const aDe=ce({stft_:sDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oDe(t,e,n,r,i="bilinear",s=0){const a=Y(t,"image","cropAndResize"),o=Y(e,"boxes","cropAndResize","float32"),l=Y(n,"boxInd","cropAndResize","int32"),c=o.shape[0];q(a.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${a.rank}.`),q(o.rank===2&&o.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${o.shape}.`),q(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${o.shape}.`),q(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),q(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),q(i==="bilinear"||i==="nearest",()=>`method must be bilinear or nearest, but was ${i}`);const u={image:a,boxes:o,boxInd:l},d={method:i,extrapolationValue:s,cropSize:r};return ue.runKernel(rV,u,d)}const lDe=ce({cropAndResize_:oDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cDe(t){const e=Y(t,"image","flipLeftRight","float32");q(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return ue.runKernel(fV,n,{})}const uDe=ce({flipLeftRight_:cDe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDe(t){const e=Y(t,"image","grayscaleToRGB"),n=e.rank-1,r=e.shape[n];q(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),q(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const i=new Array(e.rank);return i.fill(1,0,n),i[n]=3,Dl(e,i)}const hDe=ce({grayscaleToRGB_:dDe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fDe(t){const e=Y(t,"image","RGBToGrayscale"),n=e.rank-1,r=e.shape[n];q(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),q(r===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${r}.`);const i=e.dtype,s=nt(e,"float32"),a=Oi([.2989,.587,.114]);let o;switch(e.rank){case 2:o=gv("ij,j->i",s,a);break;case 3:o=gv("ijk,k->ij",s,a);break;case 4:o=gv("ijkl,l->ijk",s,a);break;case 5:o=gv("ijklm,m->ijkl",s,a);break;case 6:o=gv("ijklmn,n->ijklm",s,a);break;default:throw new Error("Not a valid tensor rank.")}return o=Mi(o,-1),nt(o,i)}const pDe=ce({rgbToGrayscale_:fDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mDe(t,e,n=0,r=.5){const i=Y(t,"image","rotateWithOffset","float32");q(i.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${i.rank}.`);const s={image:i},a={radians:e,fillValue:n,center:r};return ue.runKernel(KV,s,a)}const gDe=ce({rotateWithOffset_:mDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q0(t,e,n,r,i,s){r==null&&(r=.5),i==null&&(i=Number.NEGATIVE_INFINITY),s==null&&(s=0);const a=t.shape[0];return n=Math.min(n,a),q(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),q(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),q(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),q(e.rank===1,()=>"scores must be a 1D tensor"),q(e.shape[0]===a,()=>`scores has incompatible shape with boxes. Expected ${a}, but was ${e.shape[0]}`),q(0<=s&&s<=1,()=>`softNmsSigma must be in [0, 1], but was '${s}'`),{maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=Y(t,"boxes","nonMaxSuppression","float32"),a=Y(e,"scores","nonMaxSuppression","float32"),o=Q0(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l={maxOutputSize:n,iouThreshold:r,scoreThreshold:i};return ue.runKernel(_V,{boxes:s,scores:a},l)}const vDe=ce({nonMaxSuppression_:yDe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xDe(t,e,n){const r=bDe(t,e,n),i=r<0?-(r+1):r;t.splice(i,0,e)}function bDe(t,e,n){return SDe(t,e,n||wDe)}function wDe(t,e){return t>e?1:t<e?-1:0}function SDe(t,e,n){let r=0,i=t.length,s=0,a=!1;for(;r<i;){s=r+(i-r>>>1);const o=n(e,t[s]);o>0?r=s+1:(i=s,a=!o)}return a?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zW(t,e,n,r,i){return VW(t,e,n,r,i,0)}function BW(t,e,n,r,i,s){return VW(t,e,n,r,i,0,!1,s,!0)}function UW(t,e,n,r,i,s){return VW(t,e,n,r,i,s,!0)}function VW(t,e,n,r,i,s,a=!1,o=!1,l=!1){const c=[];for(let m=0;m<e.length;m++)e[m]>i&&c.push({score:e[m],boxIndex:m,suppressBeginIndex:0});c.sort(_7);const u=s>0?-.5/s:0,d=[],h=[];for(;d.length<n&&c.length>0;){const m=c.pop(),{score:y,boxIndex:x,suppressBeginIndex:b}=m;if(y<i)break;let _=!1;for(let T=d.length-1;T>=b;--T){const E=_De(t,x,d[T]);if(E>=r){_=!0;break}if(m.score=m.score*TDe(r,u,E),m.score<=i)break}m.suppressBeginIndex=d.length,_||(m.score===y?(d.push(x),h.push(m.score)):m.score>i&&xDe(c,m,_7))}const f=d.length,p=n-f;o&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const g={selectedIndices:d};return a&&(g.selectedScores=h),l&&(g.validOutputs=f),g}function _De(t,e,n){const r=t.subarray(e*4,e*4+4),i=t.subarray(n*4,n*4+4),s=Math.min(r[0],r[2]),a=Math.min(r[1],r[3]),o=Math.max(r[0],r[2]),l=Math.max(r[1],r[3]),c=Math.min(i[0],i[2]),u=Math.min(i[1],i[3]),d=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]),f=(o-s)*(l-a),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const g=Math.max(s,c),m=Math.max(a,u),y=Math.min(o,d),x=Math.min(l,h),b=Math.max(y-g,0)*Math.max(x-m,0);return b/(f+p-b)}function TDe(t,e,n){const r=Math.exp(e*n*n);return n<=t?r:0}function _7(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function EDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY){const s=Y(t,"boxes","nonMaxSuppressionAsync"),a=Y(e,"scores","nonMaxSuppressionAsync"),o=Q0(s,a,n,r,i);n=o.maxOutputSize,r=o.iouThreshold,i=o.scoreThreshold;const l=await Promise.all([s.data(),a.data()]),c=l[0],u=l[1],{selectedIndices:d}=zW(c,u,n,r,i);return s!==t&&s.dispose(),a!==e&&a.dispose(),Oi(d,"int32")}const CDe=EDe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=Y(t,"boxes","nonMaxSuppression"),o=Y(e,"scores","nonMaxSuppression"),l=Q0(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const c={boxes:a,scores:o},u={maxOutputSize:n,iouThreshold:r,scoreThreshold:i,softNmsSigma:s},d=ue.runKernel(EV,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const ADe=ce({nonMaxSuppressionWithScore_:NDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function IDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,s=0){const a=Y(t,"boxes","nonMaxSuppressionAsync"),o=Y(e,"scores","nonMaxSuppressionAsync"),l=Q0(a,o,n,r,i,s);n=l.maxOutputSize,r=l.iouThreshold,i=l.scoreThreshold,s=l.softNmsSigma;const c=await Promise.all([a.data(),o.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=UW(u,d,n,r,i,s);return a!==t&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Oi(h,"int32"),selectedScores:Oi(f)}}const kDe=IDe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=Y(t,"boxes","nonMaxSuppression"),o=Y(e,"scores","nonMaxSuppression"),l=Q0(a,o,n,r,i,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:a,scores:o},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:s},p=ue.runKernel(TV,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const RDe=ce({nonMaxSuppressionPadded_:MDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function PDe(t,e,n,r=.5,i=Number.NEGATIVE_INFINITY,s=!1){const a=Y(t,"boxes","nonMaxSuppressionAsync"),o=Y(e,"scores","nonMaxSuppressionAsync"),l=Q0(a,o,n,r,i,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([a.data(),o.data()]),{selectedIndices:p,validOutputs:g}=BW(h,f,c,u,d,s);return a!==t&&a.dispose(),o!==e&&o.dispose(),{selectedIndices:Oi(p,"int32"),validOutputs:It(g,"int32")}}const ODe=PDe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDe(t,e,n=!1,r=!1){const i=Y(t,"images","resizeBilinear");q(i.rank===3||i.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${i.rank}.`),q(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),q(r===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=de(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},c=ue.runKernel(tR,o,l);return a?de(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const rle=ce({resizeBilinear_:DDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $De(t,e,n=!1,r=!1){const i=Y(t,"images","resizeNearestNeighbor");q(i.rank===3||i.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${i.rank}.`),q(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),q(i.dtype==="float32"||i.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),q(r===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let s=i,a=!1;i.rank===3&&(a=!0,s=de(i,[1,i.shape[0],i.shape[1],i.shape[2]]));const o={images:s},l={alignCorners:n,halfPixelCenters:r,size:e},c=ue.runKernel(eR,o,l);return a?de(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const ile=ce({resizeNearestNeighbor_:$De});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDe(t,e="binary",n=!1,r=.5){const i=Y(t,"image","threshold"),s=.2989,a=.587,o=.114,l=i.shape[0]*i.shape[1];let c=se(Oi([r]),255),u,d,h,f;if(q(i.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${i.rank}.`),q(i.shape[2]===3||i.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${i.shape[2]}.`),q(i.dtype==="int32"||i.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${i.dtype}.`),q(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),i.shape[2]===3){[u,d,h]=vo(i,[1,1,1],-1);const m=se(u,s),y=se(d,a),x=se(h,o);f=He(He(m,y),x)}else f=t;if(e==="otsu"){const m=hoe(nt(EW(f),"int32"),Fc([]),256);c=FDe(m,l)}const p=n?Kg(f,c):Co(f,c);return nt(se(p,255),"int32")}function FDe(t,e){let n=Oi([-1]),r=Oi([0]),i=Oi([0]),s,a,o,l,c,u;for(let d=0;d<t.size-1;d++){s=Kt(t,0,d+1),a=Kt(t,d+1),c=ct(Et(s),e),u=ct(Et(a),e);const h=Et(se(s,Kx(0,s.size)));o=ct(h,Et(s));const f=K0(a.shape,s.size),p=He(Kx(0,a.size),f),g=se(a,p);l=ct(Et(g),Et(a));const m=ut(o,l),y=ut(o,l),x=se(c,u);i=se(se(x,m),y);const b=Co(i,r);r=Hs(b,i,r),n=Hs(b,Oi([d]),n)}return n}const jDe=ce({threshold_:LDe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zDe(t,e,n="nearest",r="constant",i=0,s){const a=Y(t,"image","transform","float32"),o=Y(e,"transforms","transform","float32");q(a.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${a.rank}.`),q(o.rank===2&&(o.shape[0]===a.shape[0]||o.shape[0]===1)&&o.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),q(s==null||s.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${s}.`);const l={image:a,transforms:o},c={interpolation:n,fillMode:r,fillValue:i,outputShape:s};return ue.runKernel(qV,l,c)}const BDe=ce({transform_:zDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UDe(t,e,n){const r=Y(t,"a","bandPart");q(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const i=r.shape,[s,a]=r.shape.slice(-2);let o,l;typeof e=="number"?(q(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),q(e<=s,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${s}).`),o=Y(e<0?s:e,"numLower","bandPart")):(q(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),o=Hs(Z1(e,0),s,Xf(e,s))),typeof n=="number"?(q(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),q(n<=a,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${a}).`),l=Y(n<0?a:n,"numUpper","bandPart")):(q(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=Hs(Z1(n,0),a,Xf(n,a)));const c=de(Kx(0,s,1,"int32"),[-1,1]),u=Kx(0,a,1,"int32"),d=ut(c,u),h=Gu(Kg(d,o),yp(d,Dr(l))),f=Pi([s,a],r.dtype);return de(wo(Xl(de(r,[-1,s,a])).map(p=>Hs(h,p,f))),i)}const VDe=ce({bandPart_:UDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WDe(t){let e;if(Array.isArray(t)){e=!1,q(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const i=t[0].shape[0];for(let s=1;s<t.length;++s)q(t[s].shape[0]===i,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[s].shape[0]} vs. ${i})`)}else e=!0,t=vo(t,t.shape[0],0).map(i=>Yn(i,[0]));q(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],r=t;for(let i=0;i<t.length;++i)n.push(ue.tidy(()=>{let s=r[i];if(i>0)for(let a=0;a<i;++a){const o=se(Et(se(n[a],s)),n[a]);s=ut(s,o)}return ct(s,UT(s,"euclidean"))}));return e?wo(n,0):n}const HDe=ce({gramSchmidt_:WDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GDe(t,e=!1){if(q(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return T7(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),r=Xl(de(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),i=[],s=[];r.forEach(l=>{const[c,u]=T7(l,e);i.push(c),s.push(u)});const a=de(wo(i,0),t.shape),o=de(wo(s,0),t.shape);return[a,o]}}function T7(t,e=!1){return ue.tidy(()=>{q(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],r=t.shape[1];let i=uW(n),s=Wd(t);const a=Ul([[1]],[1,1]);let o=Wd(a);const l=n>=r?r:n;for(let c=0;c<l;++c){const u=s,d=o,h=i;[o,s,i]=ue.tidy(()=>{const f=Kt(s,[c,c],[n-c,1]),p=UT(f),g=Kt(s,[c,c],[1,1]),m=Hs(Co(g,0),Ul([[-1]]),Ul([[1]])),y=ut(g,se(m,p)),x=ct(f,y);x.shape[0]===1?o=Wd(a):o=Qr([a,Kt(x,[1,0],[x.shape[0]-1,x.shape[1]])],0);const b=Dr(ct(Mn(m,y),p)),_=Kt(s,[c,0],[n-c,r]),T=se(b,o),E=Ln(o);if(c===0)s=ut(_,Mn(T,Mn(E,_)));else{const A=ut(_,Mn(T,Mn(E,_)));s=Qr([Kt(s,[0,0],[c,r]),A],0)}const C=Ln(T),I=Kt(i,[0,c],[n,i.shape[1]-c]);if(c===0)i=ut(I,Mn(Mn(I,o),C));else{const A=ut(I,Mn(Mn(I,o),C));i=Qr([Kt(i,[0,0],[n,c]),A],1)}return[o,s,i]}),Bt([u,d,h])}return!e&&n>r&&(i=Kt(i,[0,0],[n,r]),s=Kt(s,[0,0],[r,r])),[i,s]})}const qDe=ce({qr_:GDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var La;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(La||(La={}));function XDe(t,e,n=La.SUM_BY_NONZERO_WEIGHTS){const r=Y(t,"losses","computeWeightedLoss");let i=null;e!=null&&(i=Y(e,"weights","computeWeightedLoss"));const s=i==null?r:se(r,i);if(n===La.NONE)return s;if(n===La.SUM)return Et(s);if(n===La.MEAN){if(i==null)return ii(s);{const a=r.size/i.size,o=ct(Et(s),Et(i));return a>1?ct(o,It(a)):o}}if(n===La.SUM_BY_NONZERO_WEIGHTS){if(i==null)return ct(Et(s),It(r.size));{const a=se(i,fo(r.shape)),o=nt(Et(Xx(a,It(0))),"float32");return ct(Et(s),o)}}throw Error(`Unknown reduction: ${n}`)}const xh=ce({computeWeightedLoss_:XDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDe(t,e,n,r=La.SUM_BY_NONZERO_WEIGHTS){const i=Y(t,"labels","absoluteDifference"),s=Y(e,"predictions","absoluteDifference");let a=null;n!=null&&(a=Y(n,"weights","absoluteDifference")),To(i.shape,s.shape,"Error in absoluteDifference: ");const o=Bi(ut(i,s));return xh(o,a,r)}const YDe=ce({absoluteDifference_:KDe});function ZDe(t,e,n,r,i=La.SUM_BY_NONZERO_WEIGHTS){const s=Y(t,"labels","cosineDistance"),a=Y(e,"predictions","cosineDistance");let o=null;r!=null&&(o=Y(r,"weights","cosineDistance")),To(s.shape,a.shape,"Error in cosineDistance: ");const l=It(1),c=ut(l,Et(se(s,a),n,!0));return xh(c,o,i)}const QDe=ce({cosineDistance_:ZDe});function JDe(t,e,n,r=La.SUM_BY_NONZERO_WEIGHTS){let i=Y(t,"labels","hingeLoss");const s=Y(e,"predictions","hingeLoss");let a=null;n!=null&&(a=Y(n,"weights","hingeLoss")),To(i.shape,s.shape,"Error in hingeLoss: ");const o=It(1);i=ut(se(It(2),i),o);const l=rd(ut(o,se(i,s)));return xh(l,a,r)}const e$e=ce({hingeLoss_:JDe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$e(t,e,n,r=1,i=La.SUM_BY_NONZERO_WEIGHTS){const s=Y(t,"labels","huberLoss"),a=Y(e,"predictions","huberLoss");let o=null;n!=null&&(o=Y(n,"weights","huberLoss")),To(s.shape,a.shape,"Error in huberLoss: ");const l=It(r),c=Bi(ut(a,s)),u=Xf(c,l),d=ut(c,u),h=He(se(It(.5),fr(u)),se(l,d));return xh(h,o,i)}const n$e=ce({huberLoss_:t$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$e(t,e,n,r=1e-7,i=La.SUM_BY_NONZERO_WEIGHTS){const s=Y(t,"labels","logLoss"),a=Y(e,"predictions","logLoss");let o=null;n!=null&&(o=Y(n,"weights","logLoss")),To(s.shape,a.shape,"Error in logLoss: ");const l=It(1),c=It(r),u=Dr(se(s,el(He(a,c)))),d=se(ut(l,s),el(He(ut(l,a),c))),h=ut(u,d);return xh(h,o,i)}const i$e=ce({logLoss_:r$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s$e(t,e,n,r=La.SUM_BY_NONZERO_WEIGHTS){const i=Y(t,"labels","meanSquaredError"),s=Y(e,"predictions","meanSquaredError");let a=null;n!=null&&(a=Y(n,"weights","meanSquaredError")),To(i.shape,s.shape,"Error in meanSquaredError: ");const o=PW(i,s);return xh(o,a,r)}const a$e=ce({meanSquaredError_:s$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$e(t,e){const n=Y(t,"labels","sigmoidCrossEntropyWithLogits"),r=Y(e,"logits","sigmoidCrossEntropyWithLogits");To(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const i=rd(r),s=se(r,n),a=xR(va(Dr(Bi(r))));return He(ut(i,s),a)}function l$e(t,e,n,r=0,i=La.SUM_BY_NONZERO_WEIGHTS){let s=Y(t,"multiClassLabels","sigmoidCrossEntropy");const a=Y(e,"logits","sigmoidCrossEntropy");let o=null;if(n!=null&&(o=Y(n,"weights","sigmoidCrossEntropy")),To(s.shape,a.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=It(r),u=It(1),d=It(.5);s=He(se(s,ut(u,c)),se(d,c))}const l=o$e(s,a);return xh(l,o,i)}const c$e=ce({sigmoidCrossEntropy_:l$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u$e(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return rh((i,s,a)=>{const l=bR(s,[n],!0),c=ut(nt(s,"float32"),l);a([i,c]);const u=Dr(se(c,i));return{value:Et(u,[n]),gradFunc:(f,p)=>{const[g,m]=p,y=bi(f.shape,[n]);return[se(de(f,y),ut(nt(g,"float32"),va(m))),se(de(f,y),ut(va(m),nt(g,"float32")))]}}})(t,e)}function d$e(t,e,n,r=0,i=La.SUM_BY_NONZERO_WEIGHTS){let s=Y(t,"onehotLabels","softmaxCrossEntropy");const a=Y(e,"logits","softmaxCrossEntropy");let o=null;if(n!=null&&(o=Y(n,"weights","softmaxCrossEntropy")),To(s.shape,a.shape,"Error in softmaxCrossEntropy: "),r>0){const c=It(r),u=It(1),d=It(s.shape[1]);s=He(se(s,ut(u,c)),ct(c,d))}const l=u$e(s,a);return xh(l,o,i)}const h$e=ce({softmaxCrossEntropy_:d$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$e(t,e,n,r){const i=Y(t,"indices","sparseFillEmptyRows","int32"),s=Y(e,"values","sparseFillEmptyRows"),a=Y(n,"denseShape","sparseFillEmptyRows","int32"),o=Y(r,"defaultValue","sparseFillEmptyRows",s.dtype);if(i.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${i.shape}`);if(s.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${s.shape}`);if(a.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${a.shape}`);if(o.rank!==0)throw new Error(`Default value should be a scalar but received shape ${o.shape}`);const l={indices:i,values:s,denseShape:a,defaultValue:o},c=ue.runKernel($V,l);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const p$e=ce({sparseFillEmptyRows_:f$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$e(t,e,n){const r=Y(t,"inputIndices","sparseReshape","int32"),i=Y(e,"inputShape","sparseReshape","int32"),s=Y(n,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(i.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${i.shape}`);if(s.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${s.shape}`);const a={inputIndices:r,inputShape:i,newShape:s},o=ue.runKernel(LV,a);return{outputIndices:o[0],outputShape:o[1]}}const g$e=ce({sparseReshape_:m$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y$e(t,e,n){const r=Y(t,"data","sparseSegmentMean"),i=Y(e,"indices","sparseSegmentMean","int32"),s=Y(n,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return ue.runKernel(FV,a)}const v$e=ce({sparseSegmentMean_:y$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x$e(t,e,n){const r=Y(t,"data","sparseSegmentSum"),i=Y(e,"indices","sparseSegmentSum","int32"),s=Y(n,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${i.shape}`);if(s.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${s.shape}`);const a={data:r,indices:i,segmentIds:s};return ue.runKernel(jV,a)}const b$e=ce({sparseSegmentSum_:x$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w$e(t,e,n,r,i,s,a,o){const l=Y(t,"data","stringNGrams","string");if(l.dtype!=="string")throw new Error("Data must be of datatype string");if(l.shape.length!==1)throw new Error(`Data must be a vector, saw: ${l.shape}`);const c=Y(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const u={separator:n,nGramWidths:r,leftPad:i,rightPad:s,padWidth:a,preserveShortSequences:o},d={data:l,dataSplits:c},h=ue.runKernel(VV,d,u);return{nGrams:h[0],nGramsSplits:h[1]}}const S$e=ce({stringNGrams_:w$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$e(t,e,n=!0){const r=Y(t,"input","stringSplit","string"),i=Y(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(i.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${i.shape}`);const s={skipEmpty:n},a={input:r,delimiter:i},o=ue.runKernel(WV,a,s);return{indices:o[0],values:o[1],shape:o[2]}}const T$e=ce({stringSplit_:_$e});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E$e(t,e){const n=Y(t,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const i={input:n};return ue.runKernel(HV,i,r)}const C$e=ce({stringToHashBucketFast_:E$e});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$e(t,e,n,r=!0){const i=Y(t,"input","staticRegexReplace","string"),s={pattern:e,rewrite:n,replaceGlobal:r};return ue.runKernel(cR,{x:i},s)}const A$e=ce({staticRegexReplace_:N$e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I$e={fft:kR,ifft:eS,rfft:MR,irfft:RW},k$e={hammingWindow:nDe,hannWindow:tle,frame:nle,stft:aDe},ma={flipLeftRight:uDe,grayscaleToRGB:hDe,resizeNearestNeighbor:ile,resizeBilinear:rle,rgbToGrayscale:pDe,rotateWithOffset:gDe,cropAndResize:lDe,nonMaxSuppression:vDe,nonMaxSuppressionAsync:CDe,nonMaxSuppressionWithScore:ADe,nonMaxSuppressionWithScoreAsync:kDe,nonMaxSuppressionPadded:RDe,nonMaxSuppressionPaddedAsync:ODe,threshold:jDe,transform:BDe},sle={bandPart:VDe,gramSchmidt:HDe,qr:qDe},M$e={absoluteDifference:YDe,computeWeightedLoss:xh,cosineDistance:QDe,hingeLoss:e$e,huberLoss:n$e,logLoss:i$e,meanSquaredError:a$e,sigmoidCrossEntropy:c$e,softmaxCrossEntropy:h$e},R$e={sparseFillEmptyRows:p$e,sparseReshape:g$e,sparseSegmentMean:v$e,sparseSegmentSum:b$e},P$e={stringNGrams:S$e,stringSplit:T$e,stringToHashBucketFast:C$e,staticRegexReplace:A$e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$e=new Map,D$e=new Map;class J0{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class kl{constructor(){this.classNameMap={}}static getMap(){return kl.instance==null&&(kl.instance=new kl),kl.instance}static register(e){kl.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function Ke(t,e,n){q(t.className!=null,()=>"Class being registered does not have the static className property defined."),q(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),q(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const r=n,i=e+">"+r;return kl.register(t),O$e.set(i,t),D$e.set(t,i),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vp extends J0{minimize(e,n=!1,r){const{value:i,grads:s}=this.computeGradients(e,r);if(r!=null){const a=r.map(o=>({name:o.name,tensor:s[o.name]}));this.applyGradients(a)}else this.applyGradients(s);return Bt(s),n?i:(i.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return oRe(e,n)}dispose(){this.iterations_!=null&&Bt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:It(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(vp,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ale extends vp{static get className(){return"Adadelta"}constructor(e,n,r=null){super(),this.learningRate=e,this.rho=n,this.epsilon=r,this.accumulatedGrads=[],this.accumulatedUpdates=[],r==null&&(this.epsilon=ue.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=ue.registeredVariables[r],a=!1;this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accum_grad`,variable:ve(()=>Fn(s).variable(a))}),this.accumulatedUpdates[i]==null&&(this.accumulatedUpdates[i]={originalName:`${r}/accum_var`,variable:ve(()=>Fn(s).variable(a))});const o=Array.isArray(e)?e[i].tensor:e[r];if(o==null)return;const l=this.accumulatedGrads[i].variable,c=this.accumulatedUpdates[i].variable;ve(()=>{const u=He(se(l,this.rho),se(fr(o),1-this.rho)),d=se(ct(Is(He(c,this.epsilon)),Is(He(l,this.epsilon))),o),h=He(se(c,this.rho),se(fr(d),1-this.rho));l.assign(u),c.assign(h);const f=He(se(d,-this.learningRate),s);s.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Bt(this.accumulatedGrads.map(e=>e.variable)),Bt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,r=!1;this.accumulatedGrads=e.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedUpdates=e.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ole extends vp{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=ue.registeredVariables[r];this.accumulatedGrads[i]==null&&(this.accumulatedGrads[i]={originalName:`${r}/accumulator`,variable:ve(()=>K0(s.shape,this.initialAccumulatorValue).variable(!1))});const a=Array.isArray(e)?e[i].tensor:e[r];if(a==null)return;const o=this.accumulatedGrads[i].variable;ve(()=>{const l=He(o,fr(a));o.assign(l);const c=He(se(ct(a,Is(He(l,ue.backend.epsilon()))),-this.learningRate),s);s.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Bt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lle extends vp{static get className(){return"Adam"}constructor(e,n,r,i=null){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=i,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],ve(()=>{this.accBeta1=It(n).variable(),this.accBeta2=It(r).variable()}),i==null&&(this.epsilon=ue.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ve(()=>{const r=ut(1,this.accBeta1),i=ut(1,this.accBeta2);n.forEach((s,a)=>{const o=ue.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:ve(()=>Fn(o).variable(l))}),this.accumulatedSecondMoment[a]==null&&(this.accumulatedSecondMoment[a]={originalName:`${s}/v`,variable:ve(()=>Fn(o).variable(l))});const c=Array.isArray(e)?e[a].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedSecondMoment[a].variable,h=He(se(u,this.beta1),se(c,1-this.beta1)),f=He(se(d,this.beta2),se(fr(c),1-this.beta2)),p=ct(h,r),g=ct(f,i);u.assign(h),d.assign(f);const m=He(se(ct(p,He(Is(g),this.epsilon)),-this.learningRate),o);o.assign(m)}),this.accBeta1.assign(se(this.accBeta1,this.beta1)),this.accBeta2.assign(se(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Bt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),ve(()=>{this.accBeta1.assign(nh(this.beta1,this.iterations_+1)),this.accBeta2.assign(nh(this.beta2,this.iterations_+1))});const n=e.length/2,r=!1;this.accumulatedFirstMoment=e.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cle extends vp{static get className(){return"Adamax"}constructor(e,n,r,i=null,s=0){super(),this.learningRate=e,this.beta1=n,this.beta2=r,this.epsilon=i,this.decay=s,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],ve(()=>{this.iteration=It(0).variable(),this.accBeta1=It(n).variable()}),i==null&&(this.epsilon=ue.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(r=>r.name):Object.keys(e);ve(()=>{const r=ut(1,this.accBeta1),i=ct(-this.learningRate,He(se(this.iteration,this.decay),1));n.forEach((s,a)=>{const o=ue.registeredVariables[s],l=!1;this.accumulatedFirstMoment[a]==null&&(this.accumulatedFirstMoment[a]={originalName:`${s}/m`,variable:Fn(o).variable(l)}),this.accumulatedWeightedInfNorm[a]==null&&(this.accumulatedWeightedInfNorm[a]={originalName:`${s}/v`,variable:Fn(o).variable(l)});const c=Array.isArray(e)?e[a].tensor:e[s];if(c==null)return;const u=this.accumulatedFirstMoment[a].variable,d=this.accumulatedWeightedInfNorm[a].variable,h=He(se(u,this.beta1),se(c,1-this.beta1)),f=se(d,this.beta2),p=Bi(c),g=vh(f,p);u.assign(h),d.assign(g);const m=He(se(ct(i,r),ct(h,He(g,this.epsilon))),o);o.assign(m)}),this.iteration.assign(He(this.iteration,1)),this.accBeta1.assign(se(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Bt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Bt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WW extends vp{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=Array.isArray(e)?e[i].tensor:e[r];if(s==null)return;const a=ue.registeredVariables[r];ve(()=>{const o=He(se(this.c,s),a);a.assign(o)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=as(It(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ule extends WW{static get className(){return"Momentum"}constructor(e,n,r=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=r,this.accumulations=[],this.m=It(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=ue.registeredVariables[r];this.accumulations[i]==null&&(this.accumulations[i]={originalName:`${r}/momentum`,variable:ve(()=>Fn(s).variable(!1))});const a=this.accumulations[i].variable,o=Array.isArray(e)?e[i].tensor:e[r];o!=null&&ve(()=>{let l;const c=He(se(this.m,a),o);this.useNesterov?l=He(se(this.c,He(o,se(c,this.m))),s):l=He(se(this.c,c),s),a.assign(c),s.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Bt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(r=>({originalName:r.name,variable:r.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dle extends vp{static get className(){return"RMSProp"}constructor(e,n=.9,r=0,i=null,s=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=r,this.epsilon=i,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=s,i==null&&(this.epsilon=ue.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(r=>r.name):Object.keys(e)).forEach((r,i)=>{const s=ue.registeredVariables[r],a=!1;this.accumulatedMeanSquares[i]==null&&(this.accumulatedMeanSquares[i]={originalName:`${r}/rms`,variable:ve(()=>Fn(s).variable(a))}),this.accumulatedMoments[i]==null&&(this.accumulatedMoments[i]={originalName:`${r}/momentum`,variable:ve(()=>Fn(s).variable(a))}),this.accumulatedMeanGrads[i]==null&&this.centered&&(this.accumulatedMeanGrads[i]={originalName:`${r}/mg`,variable:ve(()=>Fn(s).variable(a))});const o=Array.isArray(e)?e[i].tensor:e[r];if(o==null)return;const l=this.accumulatedMeanSquares[i].variable,c=this.accumulatedMoments[i].variable;ve(()=>{const u=He(se(l,this.decay),se(fr(o),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[i].variable,h=He(se(d,this.decay),se(o,1-this.decay)),f=ct(se(o,this.learningRate),Is(ut(u,He(fr(h),this.epsilon)))),p=He(se(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const g=ut(s,p);s.assign(g)}else{const d=He(se(l,this.decay),se(fr(o),1-this.decay)),h=He(se(c,this.momentum),ct(se(o,this.learningRate),Is(He(d,this.epsilon))));l.assign(d),c.assign(h);const f=ut(s,h);s.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Bt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Bt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Bt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,r=!1;this.accumulatedMeanSquares=e.slice(0,n).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.accumulatedMoments=e.slice(n,n*2).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(i=>({originalName:i.name,variable:i.tensor.variable(r)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $$e=[ale,ole,lle,cle,ule,dle,WW];function L$e(){for(const t of $$e)Ke(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F$e="model",j$e=".json",z$e=".weights.bin";function E7(t){return new Promise(e=>setTimeout(e)).then(t)}class Tg{constructor(e){if(!Me().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Tg.URL_SCHEME)&&(e=e.slice(Tg.URL_SCHEME.length)),(e==null||e.length===0)&&(e=F$e),this.modelJsonFileName=e+j$e,this.weightDataFileName=e+z$e}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=Jc.join(e.weightData),r=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const i=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=Vae(e,i),a=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),o=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(o.download=this.modelJsonFileName,o.href=a,await E7(()=>o.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const l=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;l.download=this.weightDataFileName,l.href=r,await E7(()=>l.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:LT(e)}}}}Tg.URL_SCHEME="downloads://";class B$e{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const r=new FileReader;r.onload=i=>{const s=JSON.parse(i.target.result),a=s.modelTopology;if(a==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(s.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:a});return}const l=JV(s,c=>this.loadWeights(c));e(l)},r.onerror=i=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const n=[],r=[];for(const a of e)n.push(...a.weights),r.push(...a.paths);const i=this.checkManifestAndWeightFiles(e),s=r.map(a=>this.loadWeightsFile(a,i[a]));return Promise.all(s).then(a=>[n,a])}loadWeightsFile(e,n){return new Promise((r,i)=>{const s=new FileReader;s.onload=a=>{const o=a.target.result;r(o)},s.onerror=a=>i(`Failed to weights data from file of path '${e}'.`),s.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],r=this.weightsFiles.map(s=>S7(s.name)),i={};for(const s of e)s.paths.forEach(a=>{const o=S7(a);if(n.indexOf(o)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${o}'`);if(n.push(o),r.indexOf(o)===-1)throw new Error(`Weight file with basename '${o}' is not provided.`);i[a]=this.weightsFiles[r.indexOf(o)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return i}}const U$e=t=>Me().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Tg.URL_SCHEME)?V$e(t.slice(Tg.URL_SCHEME.length)):null;Gr.registerSaveRouter(U$e);function V$e(t="model"){return new Tg(t)}function W$e(t){return new B$e(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(t,e,n,r){a(t),n=n??0,r=r??1,o(n,r);let i=0;const s=l=>(l.then(c=>{const u=n+ ++i/t.length*(r-n);return e(u),c}),l);function a(l){q(l!=null&&Array.isArray(l)&&l.length>0,()=>"promises must be a none empty array")}function o(l,c){q(l>=0&&l<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${l}`),q(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),q(c>=l,()=>`startFraction must be no more than endFraction, but got startFraction ${l} and endFraction ${c}`)}return Promise.all(t.map(s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function hle(t,e){e==null&&(e={});const n=e.fetchFunc==null?Me().platform.fetch:e.fetchFunc,r=t.map(d=>n(d,e.requestInit,{isBinary:!0})),o=(e.onProgress==null?await Promise.all(r):await C7(r,e.onProgress,0,.5)).map(d=>d.arrayBuffer());return e.onProgress==null?await Promise.all(o):await C7(o,e.onProgress,.5,1)}function H$e(t,e){var n;const r=e.fetchFunc==null?Me().platform.fetch:e.fetchFunc;let i=0,s;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async a=>{for(var o;i<t.length;){s||(s=(await r(t[i],e.requestInit,{isBinary:!0})).body.getReader());const{done:l,value:c}=await s.read();if(l){i++,s=void 0,(o=e.onProgress)===null||o===void 0||o.call(e,i/t.length);continue}a.enqueue(c);return}a.close()}})}async function G$e(t,e="",n,r){return fle(a=>hle(a,{requestInit:r}))(t,e,n)}function fle(t){return async(e,n="",r)=>{const i=e.map(()=>!1),s={},a=r!=null?r.map(()=>!1):[],o=[];if(e.forEach((f,p)=>{let g=0;f.weights.forEach(m=>{const y="quantization"in m?m.quantization.dtype:m.dtype,x=yg[y]*Oe(m.shape),b=()=>{i[p]=!0,s[p]==null&&(s[p]=[]),s[p].push({manifestEntry:m,groupOffset:g,sizeBytes:x})};r!=null?r.forEach((_,T)=>{_===m.name&&(b(),a[T]=!0)}):b(),o.push(m.name),g+=x})}),!a.every(f=>f)){const f=r.filter((p,g)=>!a[g]);throw new Error(`Could not find weights in manifest with names: ${f.join(", ")}. 
Manifest JSON has weights with names: ${o.join(", ")}.`)}const l=i.reduce((f,p,g)=>(p&&f.push(g),f),[]),c=[];l.forEach(f=>{e[f].paths.forEach(p=>{const g=n+(n.endsWith("/")?"":"/")+p;c.push(g)})});const u=await t(c),d={};let h=0;return l.forEach(f=>{const p=e[f].paths.length,g=new Jc(u.slice(h,h+p));s[f].forEach(y=>{const x=g.slice(y.groupOffset,y.groupOffset+y.sizeBytes),b=jae(x,[y.manifestEntry]);for(const _ in b)d[_]=b[_]}),h+=p}),d}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q$e="application/octet-stream",X$e="application/json";class HW{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(q(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=Me().platform.fetch,q(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&q(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],i=Vae(e,r);if(n.body.append("model.json",new Blob([JSON.stringify(i)],{type:X$e}),"model.json"),e.weightData!=null){const a=Jc.join(e.weightData);n.body.append("model.weights.bin",new Blob([a],{type:q$e}),"model.weights.bin")}const s=await this.fetch(this.path,n);if(s.ok)return{modelArtifactsInfo:LT(e),responses:[s]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${s.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let a=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?a+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":a+=" Please make sure the server is serving valid JSON for this request.",new Error(a)}const r=n.modelTopology,i=n.weightsManifest;if(r==null&&i==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return JV(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),r=rj(e.weightsManifest),i=()=>H$e(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:r,getWeightStream:i})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[r,i]=K$e(n),s=this.weightPathPrefix||r,a=[],o=[];for(const l of e)for(const c of l.paths)this.weightUrlConverter!=null?o.push(this.weightUrlConverter(c)):a.push(s+c+i);return this.weightUrlConverter&&a.push(...await Promise.all(o)),a}async loadWeights(e){const n=await this.getWeightUrls(e),r=rj(e),i=await hle(n,this.loadOptions);return[r,i]}}HW.URL_SCHEME_REGEX=/^https?:\/\//;function K$e(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),r=t.substring(0,e),i=n>e?t.substring(n):"";return[r+"/",i]}function uj(t){return t.match(HW.URL_SCHEME_REGEX)!=null}const ple=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(r=>uj(r)):n=uj(t),n)return GW(t,e)}return null};Gr.registerSaveRouter(ple);Gr.registerLoadRouter(ple);function GW(t,e){return new HW(t,e)}function Y$e(t,e){return GW(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P${constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class mle{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class Z$e{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function Q$e(t,e,n,r){const i=arguments;return new Z$e(gle(...i))}function gle(t,e,n,r){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new P$(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new P$({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new P$({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:r}))}function J$e(t){return new mle(t)}function eLe(t){return new mle(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yle=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:Jc,browserFiles:W$e,browserHTTPRequest:Y$e,concatenateArrayBuffers:Uae,copyModel:nke,decodeWeights:jae,decodeWeightsStream:Bae,encodeWeights:nj,fromMemory:Q$e,fromMemorySync:gle,getLoadHandlers:UIe,getModelArtifactsForJSON:JV,getModelArtifactsForJSONSync:Wae,getModelArtifactsInfoForJSON:LT,getSaveHandlers:Hae,getWeightSpecs:rj,http:GW,isHTTPScheme:uj,listModels:eke,loadWeights:G$e,moveModel:rke,registerLoadRouter:BIe,registerSaveRouter:zIe,removeModel:tke,weightsLoaderFactory:fle,withSaveHandler:J$e,withSaveHandlerSync:eLe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Wp,N7=!1;function tLe(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,r=!1,i=!1,s=!1,a=!1,o=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)i=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)s=!0;else if(t.getContext!=null)a=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)o=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(jA(XF,ue.backendName)!=null){const p={pixels:t},g={numChannels:e};return ue.runKernel(XF,p,g)}const[c,u]=i?[t.videoWidth,t.videoHeight]:[t.width,t.height];let d;if(a)d=t.getContext("2d").getImageData(0,0,c,u).data;else if(r||n)d=t.data;else if(s||i||o){if(Wp==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Wp=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Wp=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Wp.canvas.width=c,Wp.canvas.height=u,Wp.drawImage(t,0,0,c,u),d=Wp.getImageData(0,0,c,u).data}let h;if(e===4)h=new Int32Array(d);else{const p=c*u;h=new Int32Array(p*e);for(let g=0;g<p;g++)for(let m=0;m<e;++m)h[g*e+m]=d[g*4+m]}return Woe(h,[u,c,e],"int32")}function nLe(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}async function qW(t,e){let n=Y(t,"img","toPixels");if(!(t instanceof rr)){const c=n;n=nt(c,"int32"),c.dispose()}nLe(n);const[r,i]=n.shape.slice(0,2),s=n.rank===2?1:n.shape[2],a=await n.data(),o=n.dtype==="float32"?255:1,l=new Uint8ClampedArray(i*r*4);for(let c=0;c<r*i;++c){const u=[0,0,0,255];for(let h=0;h<s;h++){const f=a[c*s+h];if(n.dtype==="float32"){if(f<0||f>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${f}.`)}else if(n.dtype==="int32"&&(f<0||f>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${f}.`);s===1?(u[0]=f*o,u[1]=f*o,u[2]=f*o):u[h]=f*o}const d=c*4;l[d+0]=Math.round(u[0]),l[d+1]=Math.round(u[1]),l[d+2]=Math.round(u[2]),l[d+3]=Math.round(u[3])}if(e!=null){N7||jA(gae,ue.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),N7=!0),e.width=i,e.height=r;const c=e.getContext("2d"),u=new ImageData(l,i,r);c.putImageData(u,0,0)}return n!==t&&n.dispose(),l}const vle=ce({fromPixels_:tLe});function XW(t,e){const n=t.shape.length,r=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${n}`);if(Oe(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const i=e.shape,s=i[i.length-1];let a=1;for(let d=0;d<i.length-1;++d)a*=i[d];const o=t.shape,l=i.slice();l.pop();let c=1;for(let d=s;d<n;++d)c*=o[d],l.push(o[d]);const u=[...Ft(t.shape).map(d=>d/c),1].slice(0,s);return[l,a,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dj=-2,rLe=-1;function KW(t,e,n){const r=t.shape.length;q(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),q(r===n.length,()=>`Error in slice${r}D: Length of size ${n} must match the rank of the array (${r}).`);for(let i=0;i<r;++i)q(e[i]+n[i]<=t.shape[i],()=>`Error in slice${r}D: begin[${i}] + size[${i}] (${e[i]+n[i]}) would overflow input.shape[${i}] (${t.shape[i]})`)}function iLe(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function YW(t,e,n){const r=[];for(let i=0;i<t.length;i++)r[i]=Math.ceil((e[i]-t[i])/n[i]);return r}function xle(t,e,n,r){const i=[...t];for(let s=i.length;s<r.length;s++)i.push(1);for(let s=0;s<n;s++)s===0?i[e]=1:(i.splice(e,0,1),i.pop());return i}function ble(t,e,n){return n<=t?n:n-(e-1)}function wle(t,e){const n=[];for(let r=0;r<t;r++)n.push(e+r);return n}function sLe(t,e,n,r,i,s,a,o,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=Sle(a,f,p,r,t),d=_le(o,f,p,i,t),h=xle(s,f,p,t)}else for(let f=0;f<c;f++)u[f]=Ele(a,r,s,t,f,l),d[f]=Cle(o,i,s,t,f,l),h[f]=Tle(s,f,l);return{begin:u,end:d,strides:h}}function Sle(t,e,n,r,i){const s=[...i],a=wle(n,e);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=0;else{const l=ble(e,n,o);let c=r[l];t&1<<l&&(c=0),s[o]=c}return s}function _le(t,e,n,r,i){const s=[...i],a=wle(n,e);for(let o=0;o<s.length;o++)if(a.indexOf(o)>-1)s[o]=Number.MAX_SAFE_INTEGER;else{const l=ble(e,n,o);let c=r[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),s[o]=c}for(let o=0;o<s.length;o++){const l=i[o];s[o]<0&&(s[o]+=l),s[o]=pg(0,s[o],i[o])}return s}function Tle(t,e,n){let r=t[e];return(n&1<<e||r==null)&&(r=1),r}function Ele(t,e,n,r,i,s){let a=e[i];const o=n[i]||1;(t&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MIN_SAFE_INTEGER:a=Number.MAX_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),a=pg(0,a,l-1),a}function Cle(t,e,n,r,i,s){let a=e[i];const o=n[i]||1;(t&1<<i||s&1<<i||a==null)&&(o>0?a=Number.MAX_SAFE_INTEGER:a=Number.MIN_SAFE_INTEGER);const l=r[i];return a<0&&(a+=l),o>0?a=pg(0,a,l):a=pg(-1,a,l-1),a}function ZW(t,e,n){let r=n.length;for(let i=0;i<n.length;i++)if(n[i]>1){r=i;break}for(let i=r+1;i<n.length;i++)if(e[i]>0||n[i]!==t[i])return!1;return!0}function QW(t,e){let n=t.length>0?t[t.length-1]:1;for(let r=0;r<t.length-1;r++)n+=t[r]*e[r];return n}function $R(t,e,n){let r;const i=t.shape.length;typeof e=="number"?r=[e,...new Array(i-1).fill(0)]:e.length<i?r=e.concat(new Array(i-e.length).fill(0)):r=e.slice(),r.forEach(a=>{q(a!==-1,()=>"slice() does not support negative begin indexing.")});let s;return n==null?s=new Array(i).fill(-1):typeof n=="number"?s=[n,...new Array(i-1).fill(-1)]:n.length<i?s=n.concat(new Array(i-n.length).fill(-1)):s=n,s=s.map((a,o)=>a>=0?a:(q(a===-1,()=>`Negative size values should be exactly -1 but got ${a} for the slice() size at index ${o}.`),t.shape[o]-r[o])),[r,s]}function JW(t,e,n,r,i,s,a,o,l){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,a!=null&&a&a-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:i,endMask:s,ellipsisMask:a,newAxisMask:o,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&o&&d.numAddAxisAfterEllipsis++,1<<b&a&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};aLe(d,h);let f=!0,p=!0,g=!0;const m=[],y=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const _=!!(h.shrinkAxisMask&1<<b),T=t[b];if(T===-1){m.push(_?1:-1);continue}const E=[h.beginMask&1<<b,h.endMask&1<<b],C=[h.strides[b]>0?0:-1,h.strides[b]>0?T:T-1];if(_&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");g=g&&h.strides[b]===1;const I=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(_){const $=h.begin[b]<0?T+h.begin[b]:h.begin[b];if(h.begin[b]=$,h.end[b]=h.begin[b]+1,$<0||$>=T)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=A7(h.begin[b],0,h.strides[b],T,E,C),h.end[b]=A7(h.end[b],1,h.strides[b],T,E,C);const R=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===T;f=f&&R,p=p&&(b===0&&h.strides[b]===1||R)}else f=f&&h.strides[b]===1&&I,p=p&&(b===0&&h.strides[b]===1||I);let A,k=!1;if(h.beginValid&&h.endValid?(A=h.end[b]-h.begin[b],k=!0):_?(A=1,k=!0):I&&T>=0&&(h.strides[b]<0?A=-T:A=T,k=!0),k){let R;A===0||A<0!=h.strides[b]<0?R=0:R=Math.trunc(A/h.strides[b])+(A%h.strides[b]!==0?1:0),m.push(R)}else m.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const _=h.finalShapeGatherIndices[b];_>=0?y.push(m[_]):_===dj&&y.push(1)}return{finalShapeSparse:y.filter((b,_)=>h.finalShapeGatherIndices[_]!==dj),finalShape:y,isIdentity:f,sliceDim0:p,isSimpleSlice:g,begin:h.begin,end:h.end,strides:h.strides}}function aLe(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<t.dims;r++)if(1<<r&t.ellipsisMask){const i=Math.min(e.dims-(t.dims-r)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<i;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=r}else if(1<<r&t.newAxisMask)e.finalShapeGatherIndices.push(dj),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[r]),t.end!=null&&(e.end[n]=t.end[r]),e.strides[n]=t.strides[r],t.beginMask&1<<r&&(e.beginMask|=1<<n),t.endMask&1<<r&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(rLe),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[n]=r,n++}}function A7(t,e,n,r,i,s){if(i[e])return n>0?s[e]:s[e+1&1];{const a=t<0?r+t:t;return a<s[0]?s[0]:a>s[1]?s[1]:a}}const oLe=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:KW,computeFlatOffset:QW,computeOutShape:YW,getNormalizedAxes:sLe,isSliceContinous:ZW,maskToAxes:iLe,parseSliceParams:$R,sliceInfo:JW,startForAxis:Ele,startIndicesWithElidedDims:Sle,stopForAxis:Cle,stopIndicesWithElidedDims:_le,stridesForAxis:Tle,stridesWithElidedDims:xle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lLe{static sgd(e){return new WW(e)}static momentum(e,n,r=!1){return new ule(e,n,r)}static rmsprop(e,n=.9,r=0,i=null,s=!1){return new dle(e,n,r,i,s)}static adam(e=.001,n=.9,r=.999,i=null){return new lle(e,n,r,i)}static adadelta(e=.001,n=.95,r=null){return new ale(e,n,r)}static adamax(e=.002,n=.9,r=.999,i=null,s=0){return new cle(e,n,r,i,s)}static adagrad(e,n=.1){return new ole(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dy=lLe;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cLe=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function Nle(){return new Promise(t=>cLe(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(t,e){const n=t[0].length;t.forEach((i,s)=>{q(i.length===n,()=>`Error in concat${n}D: rank of tensors[${s}] must be the same as the rank of the rest (${n})`)}),q(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const r=t[0];t.forEach((i,s)=>{for(let a=0;a<n;a++)q(a===e||i[a]===r[a],()=>`Error in concat${n}D: Shape of tensors[${s}] (${i}) does not match the shape of the rest (${r}) along the non-concatenated axis ${s}.`)})}function Du(t,e){const n=t[0].slice();for(let r=1;r<t.length;r++)n[e]+=t[r][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var _c;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(_c||(_c={}));function Ale(t,e,n){let r=new Array;if(n==null&&e==null)return r;if(e==null)for(;r.length<t+n.length;)r.push(-1);else r=e.slice();if(n==null)return r;if(t+n.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${r.length}`);for(let i=1;i<n.length;++i){const s=n[i],a=r[r.length-n.length+i],o=r[a];if(s>=0)if(o>=0){if(o!==s)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${i+t}] = ${s} but shape[${i+t}] = ${o}`)}else r[a]=s}return r}function Ile(t){const e={FIRST_DIM_SIZE:_c.FIRST_DIM_SIZE,VALUE_ROWIDS:_c.VALUE_ROWIDS,ROW_LENGTHS:_c.ROW_LENGTHS,ROW_SPLITS:_c.ROW_SPLITS,ROW_LIMITS:_c.ROW_LIMITS,ROW_STARTS:_c.ROW_STARTS},n=[];for(const r of t)if(r in e)n.push(e[r]);else break;return n}function kle(t){return t.length===0?0:t[0]===_c.FIRST_DIM_SIZE?t.length-1:t.length}function Mle(t,e){if(t==null||e==null)return;const n=t.length,r=e.length;if(n>=r)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${r})`);for(let i=0;i<Math.min(n,r-1);++i){const s=t[i],a=e[i+1];if(s>=0&&a>=0&&s!==1&&s!==a)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${i-t.length}] = ${s} but ragged tensor input.flatValues.shape[${i-t.length}] = ${a}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5=30;function LR(t){return t<=t5?t:HF(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n5(t,e,n){const r=n*(typeof t=="number"?t:t[0]),i=e*(typeof t=="number"?t:t[1]);return[r,i]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HT(t,e,n,r=!0){let i=[];if(r)i=i.concat(e.slice(0)),i.push(t[0]/n),i=i.concat(t.slice(1));else{i=i.concat(t[0]);const s=e.length;for(let a=0;a<s;++a)i=i.concat([t[a+1]/e[a],e[a]]);i=i.concat(t.slice(s+1))}return i}function GT(t,e,n=!0){const r=[];if(n){r.push(e);for(let i=e+1;i<t;++i)i<=2*e?(r.push(i),r.push(i-(e+1))):r.push(i)}else{const i=[],s=[];for(let a=1;a<t;++a)a>=e*2+1||a%2===1?s.push(a):i.push(a);r.push(...i),r.push(0),r.push(...s)}return r}function qT(t,e,n,r=!0){const i=[];r?i.push(t[0]/n):i.push(t[0]*n);for(let s=1;s<t.length;++s)s<=e.length?r?i.push(e[s-1]*t[s]):i.push(t[s]/e[s-1]):i.push(t[s]);return i}function r5(t,e){const n=[0];for(let r=0;r<e;++r)n.push(t[r][0]);return n}function i5(t,e,n){const r=t.slice(0,1);for(let i=0;i<n;++i)r.push(t[i+1]-e[i][0]-e[i][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FR=1.7580993408473768,jR=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5=.3275911,a5=.254829592,o5=-.284496736,l5=1.421413741,c5=-1.453152027,u5=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ih(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let r=0;r<n.length;r+=2)n[r]=t[r/2],n[r+1]=e[r/2];return n}function Rle(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let r=0;r<t.length;r+=2)e[r/2]=t[r],n[r/2]=t[r+1];return{real:e,imag:n}}function Ple(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=0;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function Ole(t){const e=Math.floor(t.length/4),n=new Float32Array(e),r=new Float32Array(e);for(let i=2;i<t.length;i+=4)n[Math.floor(i/4)]=t[i],r[Math.floor(i/4)]=t[i+1];return{real:n,imag:r}}function d5(t,e){const n=t[e*2],r=t[e*2+1];return{real:n,imag:r}}function Dle(t,e,n,r){t[r*2]=e,t[r*2+1]=n}function $le(t,e){const n=new Float32Array(t/2),r=new Float32Array(t/2);for(let i=0;i<Math.ceil(t/2);i++){const s=(e?2:-2)*Math.PI*(i/t);n[i]=Math.cos(s),r[i]=Math.sin(s)}return{real:n,imag:r}}function Lle(t,e,n){const r=(n?2:-2)*Math.PI*(t/e),i=Math.cos(r),s=Math.sin(r);return{real:i,imag:s}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$="->",uLe=/->/g,I7=",",k7="...";function h5(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(uLe,"").length)/O$.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${O$}").`);const[r,i]=t.split(O$);q(r.indexOf(k7)===-1,()=>`The ellipsis notation ("${k7}") is not supported yet.`);const s=r.split(I7),a=s.length;if(e!==a)throw new Error(`Expected ${a} input tensors, received ${e}`);if(a>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const o=[];for(let h=0;h<i.length;++h){const f=i[h];if(!s.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);o.indexOf(f)===-1&&o.push(f)}for(let h=0;h<r.length;++h){const f=r[h];o.indexOf(f)===-1&&f!==I7&&o.push(f)}const l=new Array(s.length);for(let h=0;h<a;++h){if(new Set(s[h].split("")).size!==s[h].length)throw new Error(`Found duplicate axes in input component ${s[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<s[h].length;++f)l[h].push(o.indexOf(s[h][f]))}const c=o.length,u=i.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:o,summedDims:d,idDims:l}}function f5(t,e){let n=new Array(t);n.fill(-1);for(let i=0;i<e.length;++i)n[e[i]]=i;const r=[];for(let i=0;i<t;++i)n[i]===-1&&r.push(i);return n=n.filter(i=>i!==-1),{permutationIndices:n,expandDims:r}}function p5(t,e,n){const r=new Array(t);for(let i=0;i<n.length;++i){const s=n[i].shape;for(let a=0;a<e[i].length;++a)r[e[i][a]]===void 0?r[e[i][a]]=s[a]:q(r[e[i][a]]===s[a],()=>`Expected dimension ${r[e[i][a]]} at axis ${a} of input shaped ${JSON.stringify(s)}, but got dimension ${s[a]}`)}}function m5(t,e){const n=t,r=[];let i=0;t.length===0&&n.push(-1),i=t.length+1;for(let a=0;a<i;++a)r.push([]);const s=[];for(let a=0;a<n.length;++a){const o=n[a],l=dLe(e,o);for(const c of l)s.indexOf(c)===-1&&(r[a].push(c),s.push(c))}return{path:n,steps:r}}function g5(t){return t.every((e,n)=>e===n)}function dLe(t,e){const n=[];for(let r=0;r<t.length;++r)(t[r].length===0||t[r].indexOf(e)!==-1||e===-1)&&n.push(r);return n}function y5(t,e,n=0){let r=[];if(typeof e=="number")q(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(t.shape[n]/e);else{const i=e.reduce((a,o)=>(o===-1&&(a+=1),a),0);q(i<=1,()=>"There should be only one negative value in split array.");const s=e.indexOf(-1);if(s!==-1){const a=e.reduce((o,l)=>l>0?o+l:o);e[s]=t.shape[n]-a}q(t.shape[n]===e.reduce((a,o)=>a+o),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fle(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function jle(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function zle(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ble(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function Ule(t,e){return`size ${t} must be non-negative, not ${e}`}function Vle(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Wle(t,e){const n=Oe(t),r=Oe(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${t} outputShape= ${e}`}function Hle(t,e){const n=Oe(t),r=Oe(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${r}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(){return"segment ids must be >= 0"}function Gle(){return"segment ids are not increasing"}function qle(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Xle(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kle(t,e){let n=!1,r;for(t<=t5?(r=t,n=!0):r=HF(t,Math.floor(Math.sqrt(t)));!n;)r>e||r===t?n=!0:r=HF(t,r+1);return r}function Yle(t,e,n){const r=[],i=t.length;for(let s=0;s<i;s++)s!==e?r.push(t[s]):r.push(n);return r}function v5(t,e,n,r){const i=e.shape.length,s=t.shape.length;if(r!==0&&(r<-i||r>i))throw new Error(`Expect batchDims in the range of [-${i}, ${i}], but got ${r}`);if(r<0&&(r+=i),r>s)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${s}).`);if(n<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${n}).`);for(let d=0;d<r;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const a=t.shape[n],o=[];let l=1,c=1,u=1;for(let d=0;d<r;++d)o.push(t.shape[d]),l*=t.shape[d];for(let d=r;d<n;d++)o.push(t.shape[d]),c*=t.shape[d];for(let d=r;d<i;d++)o.push(e.shape[d]);for(let d=n+1;d<s;d++)o.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:a,outputShape:o}}const hLe=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:v5,computeOutShape:Yle,segOpComputeOptimalWindowSize:Kle},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sh(t){try{return t.map(e=>Vf(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Zle(t){return t.map(e=>kf(e))}const fLe=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:a5,ERF_A2:o5,ERF_A3:l5,ERF_A4:c5,ERF_A5:u5,ERF_P:s5,PARALLELIZE_THRESHOLD:t5,get RowPartitionType(){return _c},SELU_SCALE:jR,SELU_SCALEALPHA:FR,applyActivation:OR,assertAndGetBroadcastShape:dn,assertAxesAreInnerMostDims:Ms,assertParamsConsistent:e5,assignToTypedArray:Dle,axesAreInnerMostDims:cW,calculateShapes:Qg,checkEinsumDimSizes:p5,checkPadOnDimRoundingMode:wa,combineLocations:Eoe,combineRaggedTensorToTensorShapes:Ale,complexWithEvenIndex:Ple,complexWithOddIndex:Ole,computeConv2DInfo:hs,computeConv3DInfo:mp,computeDefaultPad:nW,computeDilation2DInfo:FT,computeOptimalWindowSize:LR,computeOutAndReduceShapes:fs,computeOutShape:Du,computePool2DInfo:Zl,computePool3DInfo:gh,convertConv2DDataFormat:yh,decodeEinsumEquation:h5,eitherStridesOrDilationsAreOne:ks,expandShapeToKeepDim:bi,exponent:Lle,exponents:$le,fromStringArrayToUint8:Zle,fromUint8ToStringArray:sh,getAxesPermutation:Jr,getBroadcastDims:qx,getComplexWithIndex:d5,getEinsumComputePath:m5,getEinsumPermutation:f5,getFusedBiasGradient:PR,getFusedDyActivation:RR,getImageCenter:n5,getInnerMostAxes:wi,getPermuted:GT,getRaggedRank:kle,getReductionAxes:Yi,getReshaped:HT,getReshapedPermuted:qT,getRowPartitionTypesHelper:Ile,getSliceBeginCoords:r5,getSliceSize:i5,getSparseFillEmptyRowsIndicesDenseShapeMismatch:Fle,getSparseFillEmptyRowsNegativeIndexErrorMessage:jle,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:zle,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:Vle,getSparseReshapeInputOutputMismatchErrorMessage:Hle,getSparseReshapeInputOutputMultipleErrorMessage:Wle,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Ble,getSparseReshapeNegativeOutputDimErrorMessage:Ule,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Xle,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:hj,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Gle,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:qle,getUndoAxesPermutation:gp,isIdentityPermutation:g5,log:tIe,mergeRealAndImagArrays:ih,prepareAndValidate:XW,prepareSplitSize:y5,segment_util:hLe,shouldFuse:DR,slice_util:oLe,splitRealAndImagArrays:Rle,stridesOrDilationsArePositive:Sg,tupleValuesAreOne:Gf,upcastType:bo,validateDefaultValueShape:Mle,validateInput:OW,validateUpdateShape:Hoe,warn:Uo},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */L$e();/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ym={},tN={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function pLe(t,e){ym[t]=e}function qc(t,e){if(!(t in ym)||e!=null){const r=gLe(t,e);if(r!==null)ym[t]=r;else return console.log("Could not get context for WebGL version",t),null}const n=ym[t];return n==null||n.isContextLost()?(delete ym[t],qc(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),ym[t])}function mLe(t){if(!Me().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function gLe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??mLe(t);return n.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete ym[t]},!1),Me().getBool("SOFTWARE_WEBGL_ENABLED")&&(tN.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",tN)||n.getContext("experimental-webgl",tN):n.getContext("webgl2",tN)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var tS;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(tS||(tS={}));var Go;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Go||(Go={}));var Es;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Es||(Es={}));function XT(t,e){return[e,t]}function yLe(t,e){return t*e}function nN(t){const e=Oe(t),n=Math.ceil(e/4);return UF(n)}function eb(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function vLe(t,e){const[n,r]=eb(t,e);return n*r*4}function x5(t,e){const n=t;let r,i,s,a,o,l,c,u,d,h;return Me().getNumber("WEBGL_VERSION")===2?(r=n.R32F,i=n.R16F,s=n.RGBA16F,a=n.RGBA32F,o=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(r=t.RGBA,i=t.RGBA,s=t.RGBA,a=n.RGBA,o=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:i,internalFormatPackedHalfFloat:s,internalFormatPackedFloat:a,textureFormatFloat:o,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mt(t,e){const n=e();return Me().getBool("DEBUG")&&xLe(t),n}function xLe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+_Le(t,e))}const bLe=596e-10,wLe=65504;function SLe(t){return!!(Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||bLe<Math.abs(t)&&Math.abs(t)<wLe)}function _Le(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function rN(t,e){return bh(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function TLe(t,e){const n=bh(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(mt(t,()=>t.shaderSource(n,e)),mt(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function ELe(t,e){const n=bh(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(mt(t,()=>t.shaderSource(n,e)),mt(t,()=>t.compileShader(n)),Me().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw Qle(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const CLe=/ERROR: [0-9]+:([0-9]+):/g;function Qle(t,e){const n=CLe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const r=+n[1],i=t.split(`
`),s=i.length.toString().length+2,a=i.map((d,h)=>tx((h+1).toString(),s)+d);let o=0;for(let d=0;d<a.length;d++)o=Math.max(a[d].length,o);const l=a.slice(0,r-1),c=a.slice(r-1,r),u=a.slice(r);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${tx(c[0],o)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function NLe(t){return bh(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function ALe(t,e){if(mt(t,()=>t.linkProgram(e)),!Me().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function D$(t,e){if(mt(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function ILe(t,e){const n=bh(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return mt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),mt(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function kLe(t,e){const n=bh(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return mt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),mt(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function MLe(t){return bh(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function RLe(t,e){const n=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const r=`[${t}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(t>n||e>n){const r=`[${t}x${e}]`,i=`[${n}x${n}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+i+".")}}function PLe(t){return bh(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function M7(t,e,n,r,i,s,a){const o=t.getAttribLocation(e,n);return o===-1?!1:(mt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,r)),mt(t,()=>t.vertexAttribPointer(o,i,t.FLOAT,!1,s,a)),mt(t,()=>t.enableVertexAttribArray(o)),!0)}function OLe(t,e,n){jLe(t,n),mt(t,()=>t.activeTexture(t.TEXTURE0+n)),mt(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function DLe(t,e,n){return bh(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function $Le(t,e,n){return t.getUniformLocation(e,n)}function LLe(t,e,n,r){mt(t,()=>OLe(t,e,r)),mt(t,()=>t.uniform1i(n,r))}function $$(t,e,n){mt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),mt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function R7(t,e){mt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),mt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function iN(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+FLe(t,e))}function FLe(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function bh(t,e,n){const r=mt(t,()=>e());if(r==null)throw new Error(n);return r}function jLe(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+t.TEXTURE0;if(r<t.TEXTURE0||r>n){const i=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${i}.`)}}function Yx(t,e=2){return Oe(t.slice(0,t.length-e))}function Zx(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function sN(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Yx(t),...Zx(t)]),e}function zLe(t,e=!1){let n=Me().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=Me().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&Me().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=n/2),e&&(n=n*2,r=r*2,t=t.map((o,l)=>l>=t.length-2?VU(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=dp(t).newShape);let i=Oe(t),s=null;t.length<=1&&i<=n?s=[1,i]:t.length===2&&t[0]<=n&&t[1]<=n?s=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?s=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?s=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?s=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(s=[t[0],t[1]*t[2]*t[3]]);const a=s!=null&&Math.max(...s)>r&&Math.min(...s)<=(e?2:1)&&Math.min(...s)>0;if(s==null||a)if(e){const o=Yx(t);let l=2,c=2;t.length&&([l,c]=Zx(t)),i=o*(l/2)*(c/2),s=UF(i).map(u=>u*2)}else s=UF(i);return s}function aN(t){return t%2===0}function HA(t,e){if(t=t.slice(-2),e=e.slice(-2),Pn(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],r=e[e.length-1];if(n===r||aN(n)&&aN(r)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&aN(t[0])&&aN(e[0])}let L$,F$;function BLe(t){if(L$==null){const e=qc(t);L$=e.getParameter(e.MAX_TEXTURE_SIZE)}return L$}function ULe(t){if(F$==null){const e=qc(t);F$=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,F$)}function VLe(t){if(t===0)return 0;let e;const n=qc(t);return $l(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:$l(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function $l(t,e){return t.getExtension(e)!=null}function P7(t){try{if(qc(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function WLe(t){if(t===0)return!1;const e=qc(t);if(t===1){if(!$l(e,"OES_texture_float"))return!1}else if(!$l(e,"EXT_color_buffer_float"))return!1;return fj(e)}function HLe(t){if(t===0)return!1;const e=qc(t);if(t===1){if(!$l(e,"OES_texture_float")||!$l(e,"WEBGL_color_buffer_float"))return!1}else{if($l(e,"EXT_color_buffer_float"))return fj(e);const r="EXT_color_buffer_half_float";if($l(e,r)){const i=e.getExtension(r);return GLe(e,i)}return!1}return fj(e)}function fj(t){const e=x5(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const s=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,s),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(s),a}function GLe(t,e){const n=x5(t,e),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);const o=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(r),t.deleteFramebuffer(a),o}function qLe(t){return t!==2?!1:qc(t).fenceSync!=null}function KT(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&q(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const At=Me();At.registerFlag("HAS_WEBGL",()=>At.getNumber("WEBGL_VERSION")>0);At.registerFlag("WEBGL_VERSION",()=>P7(2)?2:P7(1)?1:0);At.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);At.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>At.get("WEBGL_VERSION")===2);At.registerFlag("WEBGL_CPU_FORWARD",()=>!0);At.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);At.registerFlag("WEBGL_PACK",()=>At.getBool("HAS_WEBGL"));At.registerFlag("WEBGL_PACK_NORMALIZATION",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_CLIP",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_REDUCE",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_LAZILY_UNPACK",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_CONV_IM2COL",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>At.getBool("WEBGL_PACK"));At.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>BLe(At.getNumber("WEBGL_VERSION")));At.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>ULe(At.getNumber("WEBGL_VERSION")));At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=At.getNumber("WEBGL_VERSION");return t===0?0:VLe(t)});At.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>At.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!Oae());At.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>WLe(At.getNumber("WEBGL_VERSION")));At.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>At.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:At.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));At.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>HLe(At.getNumber("WEBGL_VERSION")));At.registerFlag("WEBGL_FENCE_API_ENABLED",()=>qLe(At.getNumber("WEBGL_VERSION")));At.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>At.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);At.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});At.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>Oae()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});At.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);At.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);At.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);At.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);At.registerFlag("WEBGL_EXP_CONV",()=>!1);At.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>At.getBool("IS_TEST"));At.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);At.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);At.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);At.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sa(){let t,e,n,r,i,s,a,o,l,c;return Me().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",r="in",i="texture",s="outputColor",a="out vec4 outputColor;",o=Me().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",r="varying",i="texture2D",s="gl_FragColor",a="",o=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:r,texture2D:i,output:s,defineOutput:a,defineSpecialNaN:o,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jg(t,e,n="index"){const r=Ft(e);return r.map((i,s)=>{const a=`int ${t[s]} = ${n} / ${i}`,o=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * ${i}`:`index -= ${t[s]} * ${i}`;return`${a}; ${o};`}).join("")}function zR(t,e,n="index"){const r=Ft(e);return r.map((i,s)=>{const a=`int ${t[s]} = ${n} / outShapeStrides[${s}]`,o=s===r.length-1?`int ${t[s+1]} = ${n} - ${t[s]} * outShapeStrides[${s}]`:`index -= ${t[s]} * outShapeStrides[${s}]`;return`${a}; ${o};`}).join("")}function XLe(t,e){const n=t.length,r=t.map(s=>`${e}[${s}]`),i=new Array(n-1);i[n-2]=r[n-1];for(let s=n-3;s>=0;--s)i[s]=`(${i[s+1]} * ${r[s+1]})`;return i}function KLe(t,e,n="index"){const r=t.map((s,a)=>a),i=XLe(r,e);return i.map((s,a)=>{const o=`int ${t[a]} = ${n} / ${i[a]}`,l=a===i.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${i[a]}`:`index -= ${t[a]} * ${i[a]}`;return`${o}; ${l};`}).join("")}function b5(t){const e=Ft(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function w5(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const Jle=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:ece}=fLe;function YLe(t,e,n){const r=[];if(t.forEach(f=>{const p=Oe(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?r.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(r.push(`uniform sampler2D ${f.name};`),r.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:g}=S5(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(g.length){case 1:r.push(`uniform int ${f.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${f.name}Shape;`);break}r.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{r.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const i=r.join(`
`),s=t.map(f=>ZLe(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),a=e.texShape,o=Sa(),l=e3e(o);let c,u,d=r3e(o);return e.isPacked?(c=QLe(e.logicalShape,a,n.enableShapeUniforms),u=n3e(o)):(c=JLe(e.logicalShape,a,n.enableShapeUniforms),u=t3e(o)),n.packedInputs&&(d+=o3e),[d,l,u,i,c,s,n.userCode].join(`
`)}function tb(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return x3e(t,e);case 1:return w3e(t,e);case 2:return _3e(t,e);case 3:return E3e(t,e);case 4:return N3e(t,e);case 5:return A3e(t);case 6:return I3e(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function tce(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return v3e(t);case 1:return b3e(t,e);case 2:return S3e(t,e);case 3:return T3e(t,e);default:return C3e(t,e)}}function ZLe(t,e,n=!1,r){let i="";n?i+=tce(t,r):i+=tb(t,r);const s=t.shapeInfo.logicalShape,a=e.logicalShape;return s.length<=a.length&&(n?i+=k3e(t,e):i+=M3e(t,e)),i}function QLe(t,e,n){switch(t.length){case 0:return nce();case 1:return l3e(t,e,n);case 2:return g3e(t,e,n);case 3:return u3e(t,e,n);default:return h3e(t,e,n)}}function JLe(t,e,n){switch(t.length){case 0:return nce();case 1:return c3e(t,e,n);case 2:return y3e(t,e,n);case 3:return d3e(t,e,n);case 4:return f3e(t,e,n);case 5:return p3e(t,e);case 6:return m3e(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function e3e(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function t3e(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function n3e(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function r3e(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${i3e}
    ${s3e}
    ${a3e}
  `}const i3e=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,s3e=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,a3e=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,o3e=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function nce(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function l3e(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function c3e(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function u3e(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[2]/2),s=i*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec3(b, r, c);
    }
  `}function d3e(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${zR(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const r=Jg(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function h3e(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],i=Math.ceil(t[t.length-1]/2),s=i*Math.ceil(t[t.length-2]/2);let a=s,o="",l="b, r, c";for(let c=2;c<t.length-1;c++)a*=t[t.length-c-1],o=`
      int b${c} = index / ${a};
      index -= b${c} * ${a};
    `+o,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${o}

      int b = index / ${s};
      index -= b * ${s};

      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec${t.length}(${l});
    }
  `}function f3e(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${zR(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Jg(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function p3e(t,e){const n=Jg(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function m3e(t,e){const n=Jg(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function g3e(t,e,n){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Pn(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const i=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${i});
      int c = imod(index, ${i}) * 2;

      return ivec2(r, c);
    }
  `}function y3e(t,e,n){return Pn(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function ey(t){return`offset${t}`}function v3e(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Sa();return`
    vec4 ${n}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function x3e(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${r}() {return ${n};}`;const[i,s]=t.shapeInfo.texShape;if(i===1&&s===1)return`
      float ${r}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=ey(n);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${a});
      return sampleTexture(${n}, uv);
    }
  `;const[o,l]=t.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${o}, ${l}, ${a});
      return sampleTexture(${n}, uv);
    }
  `}function b3e(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=t.shapeInfo.texShape,s=Sa();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${s.texture2D}(${n}, uv);
    }
  `;const a=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${a[0]}, ${a[1]}, index);
      return ${s.texture2D}(${n}, uv);
    }
  `}function w3e(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${nb(t)}
      }
    `;const i=t.shapeInfo.texShape,s=i[0],a=i[1];if(a===1&&s===1)return`
      float ${r}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const o=ey(n);return a===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${o}) + 0.5) / ${s}.0);
        return sampleTexture(${n}, uv);
      }
    `:s===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${o}) + 0.5) / ${a}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${o});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${s}, ${a}, index + ${o});
      return sampleTexture(${n}, uv);
    }
  `}function S3e(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,a=s[0],o=s[1],l=Sa();if(s!=null&&Pn(n,s))return e?`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${l.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${o}.0, ${a}.0);

        return ${l.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${i}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${i}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${r}, uv);
    }
  `}function _3e(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape;if(s!=null&&Pn(n,s)){if(e)return`
      float ${i}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const h=s[0],f=s[1];return`
    float ${i}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:a,keptDims:o}=dp(n),l=a;if(l.length<n.length){const h=rb(t,l),f=["row","col"];return`
      ${tb(h,e)}
      float ${i}(int row, int col) {
        return ${i}(${ib(f,o)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${i}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${nb(t)}
      }
    `;const c=s[0],u=s[1],d=ey(r);return u===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${i}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${i}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${i}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${r}, uv);
  }
`}function T3e(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=t.shapeInfo.texShape,a=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=rb(t,h),g=["b","row","col"];return`
        ${tce(p,e)}
        vec4 ${i}(int b, int row, int col) {
          return ${i}(${ib(g,f)});
        }
      `}const o=Sa();if(e)return`
    vec4 ${i}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `;const l=a[0],c=a[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${i}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${o.texture2D}(${r}, uv);
    }
  `}function E3e(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[1]*n[2],a=n[2],{newShape:o,keptDims:l}=dp(n),c=o;if(c.length<n.length){const g=rb(t,c),m=["row","col","depth"];return`
        ${tb(g,e)}
        float ${i}(int row, int col, int depth) {
          return ${i}(${ib(m,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${s}, ${a}, 1)));
        ${nb(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===s&&f==null)return e?`
      float ${i}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${i}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${a}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(h===a&&f==null)return e?`
      float ${i}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${i}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `;const p=ey(r);return e?`
    float ${i}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${i}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s} + col * ${a} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${r}, uv);
      }
  `}function C3e(t,e){const n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=Sa();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${i.texture2D}(${n}, uv);
    }
  `;const s=t.shapeInfo.logicalShape,a=s.length,o=t.shapeInfo.texShape,l=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],c=l[0],u=l[1],d=Math.ceil(s[a-1]/2);let h=d*Math.ceil(s[a-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let g=2;g<a-1;g++)f=`int b${g}, `+f,h*=s[a-g-1],p=`b${g} * ${h} + `+p;return`
    vec4 ${r}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${i.texture2D}(${n}, uv);
    }
  `}function N3e(t,e){const n=t.shapeInfo.logicalShape,r=t.name,i="get"+r.charAt(0).toUpperCase()+r.slice(1),s=n[3],a=n[2]*s,o=n[1]*a,{newShape:l,keptDims:c}=dp(n);if(l.length<n.length){const x=rb(t,l),b=["row","col","depth","depth2"];return`
      ${tb(x,e)}
      float ${i}(int row, int col, int depth, int depth2) {
        return ${i}(${ib(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${i}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${o}, ${a}, ${s}, 1)));
        ${nb(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${r}Shape[3];`,g=`int stride1 = ${r}Shape[2] * stride2;`,m=`int stride0 = ${r}Shape[1] * stride1;`;if(f===o&&u==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        ${p}
        ${g}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${a}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(f===s&&u==null)return e?`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${i}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${r}, uv);
      }
    `;const y=ey(r);return e?`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${g}
      ${m}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${y});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${i}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} +
          depth * ${s} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${y});
      return sampleTexture(${r}, uv);
    }
  `}function A3e(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),i=e[4],s=e[3]*i,a=e[2]*s,o=e[1]*a,{newShape:l,keptDims:c}=dp(e);if(l.length<e.length){const g=rb(t,l),m=["row","col","depth","depth2","depth3"];return`
      ${tb(g)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${ib(m,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${o}, ${a}, ${s}, ${i})) +
          depth3;
        ${nb(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===o&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${a}, ${s}, ${i}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===i&&u==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=ey(n);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${o} + col * ${a} + depth * ${s} +
          depth2 * ${i} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function I3e(t){const e=t.shapeInfo.logicalShape,n=t.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:i,keptDims:s}=dp(e);if(i.length<e.length){const m=rb(t,i),y=["row","col","depth","depth2","depth3","depth4"];return`
      ${tb(m)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${ib(y,s)});
      }
    `}const a=e[5],o=e[4]*a,l=e[3]*o,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${o})) +
          dot(
            vec2(depth3, depth4),
            vec2(${a}, 1)));
        ${nb(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${o}, ${a})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===a&&d==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const g=ey(n);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${o} + depth3 * ${a} + depth4 + ${g};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function nb(t){const e=t.name,n=Oe(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function k3e(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=t.shapeInfo.logicalShape.length,a=e.logicalShape.length,o=ece(t.shapeInfo.logicalShape,e.logicalShape),l=gr(a),c=a-s;let u;const d=["x","y","z","w","u","v"];s===0?u="":a<2&&o.length>=1?u="coords = 0;":u=o.map(x=>`coords.${d[x+c]} = 0;`).join(`
`);let h="";a<2&&s>0?h="coords":h=t.shapeInfo.logicalShape.map((x,b)=>`coords.${d[b+c]}`).join(", ");let f="return outputValue;";const g=Oe(t.shapeInfo.logicalShape)===1,y=Oe(e.logicalShape)===1;if(s===1&&!g&&!y)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(g&&!y)a===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(o.length){const x=s-2,b=s-1;o.indexOf(x)>-1&&o.indexOf(b)>-1?f="return vec4(outputValue.x);":o.indexOf(x)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":o.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${i}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${r}(${h});
      ${f}
    }
  `}function M3e(t,e){const n=t.name,r=n.charAt(0).toUpperCase()+n.slice(1),i="get"+r+"AtOutCoords",s=e.texShape,a=t.shapeInfo.texShape,o=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&o===l&&t.shapeInfo.flatOffset==null&&Pn(a,s))return`
      float ${i}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=gr(l),u=ece(t.shapeInfo.logicalShape,e.logicalShape),d=l-o;let h;const f=["x","y","z","w","u","v"];o===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(g=>`coords.${f[g+d]} = 0;`).join(`
`);let p="";return l<2&&o>0?p="coords":p=t.shapeInfo.logicalShape.map((g,m)=>`coords.${f[m+d]}`).join(", "),`
    float ${i}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${r}(${p});
    }
  `}function gr(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function S5(t,e,n){const{newShape:r,keptDims:i}=dp(e),s=e.length,a=t&&s===3&&e[0]===1,o=a?e.slice(1):r,l=!t&&s>1&&!Pn(e,n)&&r.length<s||a;return{useSqueezeShape:l,uniformShape:l?o:e,keptDims:i}}function rb(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function ib(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3e(t,e,n,r){const i=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),s=i.map(u=>u.shapeInfo),a={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},o=YLe(i,a,e),l=ELe(t.gl,o),c=t.createProgram(l);return Me().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:a,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:o,webGLProgram:c,inShapeInfos:s,outShapeInfo:a},rce(t,e,c)))}function rce(t,e,n){const r=[],i=[];let s,a,o,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),Me().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),r.push(h)}if(e.enableShapeUniforms&&(s=t.getUniformLocation(n,"outShape",u),o=t.getUniformLocation(n,"outShapeStrides",u),a=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)i.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:r,customUniformLocations:i,infLoc:l,nanLoc:c,outShapeLocation:s,outShapeStridesLocation:o,outTexShapeLocation:a}}function O7(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,r)=>{const i=n.logicalShape,s=e[r],a=s.shape;if(!Pn(i,a))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${i} and ${a} must match`);if(n.isUniform&&s.isUniform)return;const o=n.texShape,l=s.isUniform?null:s.texData.texShape;if(!Pn(o,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${o} and ${l} must match`)})}function P3e(t,e,n,r,i){e.program.enableShapeUniforms||(O7(e.inShapeInfos,n),O7([e.outShapeInfo],[r]));const s=r.texData.texture,a=r.texData.texShape;r.texData.isPacked?t.setOutputPackedMatrixTexture(s.texture,a[0],a[1]):t.setOutputMatrixTexture(s.texture,a[0],a[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),Me().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=S5(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Oe(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const o=e.outShapeLocation;if(o)switch(r.shape.length){case 1:t.gl.uniform1iv(o,new Int32Array(r.shape));break;case 2:t.gl.uniform2iv(o,new Int32Array(r.shape));break;case 3:t.gl.uniform3iv(o,new Int32Array(r.shape));break;case 4:t.gl.uniform4iv(o,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const l=Ft(r.shape);switch(r.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&i)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=i[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function O3e(t,e,n){let r="";e.concat(n).forEach(a=>{const o=a.texData!=null&&a.texData.slice!=null&&a.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!a.isUniform){const l=a.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=S5(t.packedInputs,a.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const T=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${T[0]>1}_${T[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const T=Ft(u);p=`${T[0]===l[1]}_${T[T.length-1]===l[1]}`}const g=a.shape.length,m=u.length===2&&Pn(a.shape,l),y=Oe(a.shape)===1,x=qx(a.shape,n.shape),b=!t.packedInputs&&g===n.shape.length&&Pn(l,n.texData.texShape),_=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;r+=`${g}_${b}_${c?d:""}_${u.length}_${y}_${x}_${m}_${h}_${f}_${p}_${_}_${o}`}else{const l=a.isUniform?"uniform":a.texData.texShape;r+=`${a.shape}_${l}_${o}`}});const i=t.userCode;let s=t.constructor.name;return s+="_"+r+"_"+i+`${Me().getNumber("WEBGL_VERSION")}`,s}function Xs(t){return Me().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D3e{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=tS.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Sa();this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?zR(["r","c","d"],e):Jg(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $3e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=tS.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Sa();this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?zR(["r","c","d"],e):Jg(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class L3e{constructor(e){this.variableNames=["A"],this.outTexUsage=Go.DOWNLOAD;const n=Sa();this.outputShape=e,this.userCode=`
      ${Jle}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F3e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Go.DOWNLOAD;const n=Sa();this.outputShape=e,this.userCode=`
      ${Jle}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j3e={R:0,G:1,B:2,A:3};class D7{constructor(e,n=!1,r="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const i=Sa();this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length);let s="result";n&&(s="floor(result * 255. + 0.5)");let a="";for(let o=0;o<r.length;o++){const l=r[o];a+=`
          if(offset == ${o}) {
            result = values[${j3e[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?w5():b5(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${r.length});

        flatIndex = idiv(flatIndex, ${r.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${i.texture2D}(A, uv);
          ${a}
        }
        ${i.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class z3e{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Sa();this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length);let i="",s="result";n&&(s="floor(result * 255. + 0.5)");for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){const l=a*2+o;i+=`
          localCoords = coords;
          if(localCoords[2] + ${o} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${o};
          if (localCoords[1] + ${a} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${a};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?w5():b5(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${i}

          ${r.output} = ${s};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3e(t){const e=Sa(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return TLe(t,n)}function U3e(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return ILe(t,e)}function V3e(t){const e=new Uint16Array([0,1,2,2,1,3]);return kLe(t,e)}function YT(t,e,n,r,i,s){RLe(e,n);const a=MLe(t),o=t.TEXTURE_2D;return mt(t,()=>t.bindTexture(o,a)),mt(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),mt(t,()=>t.texParameteri(o,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),mt(t,()=>t.texParameteri(o,t.TEXTURE_MIN_FILTER,t.NEAREST)),mt(t,()=>t.texParameteri(o,t.TEXTURE_MAG_FILTER,t.NEAREST)),Me().getNumber("WEBGL_VERSION")===1?mt(t,()=>t.texImage2D(o,0,r,e,n,0,i,s,null)):mt(t,()=>t.texStorage2D(o,1,r,e,n)),mt(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:a,texShape:[n,e]}}function ice(t){return t.internalFormatFloat}function W3e(t,e,n,r){const[i,s]=XT(e,n);return YT(t,i,s,ice(r),r.textureFormatFloat,t.FLOAT)}function sce(t){return t.internalFormatHalfFloat}function H3e(t,e,n,r){const[i,s]=XT(e,n);return YT(t,i,s,sce(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function ace(t){return t.downloadTextureFormat}function G3e(t,e,n,r){const[i,s]=XT(e,n);return YT(t,i,s,ace(r),t.RGBA,t.UNSIGNED_BYTE)}function oce(t){return t.internalFormatPackedFloat}function q3e(t,e,n,r){const[i,s]=eb(e,n);return YT(t,i,s,oce(r),t.RGBA,t.FLOAT)}function lce(t){return t.internalFormatPackedHalfFloat}function X3e(t,e,n,r){const[i,s]=eb(e,n);return YT(t,i,s,lce(r),t.RGBA,r.textureTypeHalfFloat)}function K3e(t,e,n){return mt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),M7(t,e,"clipSpacePos",n,3,20,0)&&M7(t,e,"uv",n,2,20,12)}function Y3e(t,e,n,r,i,s){mt(t,()=>t.bindTexture(t.TEXTURE_2D,e));let a,o,l;i instanceof Uint8Array?(a=new Uint8Array(n*r*4),o=t.UNSIGNED_BYTE,l=t.RGBA):(a=new Float32Array(n*r*4),o=t.FLOAT,l=s.internalFormatPackedFloat),a.set(i),Me().getNumber("WEBGL_VERSION")===2?mt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,r,t.RGBA,o,a)):mt(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,r,0,t.RGBA,o,a)),mt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Z3e(t,e,n){mt(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?Me().getNumber("WEBGL_VERSION")===2?mt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):mt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):Me().getNumber("WEBGL_VERSION")===2?mt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):mt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),mt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Q3e(t,e,n,r){const i=t.createBuffer();mt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,i));const o=4*4*e*n;return mt(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,o,t.STREAM_READ)),mt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),mt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),i}function J3e(t,e,n){const r=t,i=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,i),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),i}function eFe(t,e,n,r){const[i,s]=XT(e,n),a=4,o=new Uint8Array(yLe(e*n,a));return mt(t,()=>t.readPixels(0,0,i,s,r.downloadTextureFormat,t.UNSIGNED_BYTE,o)),new Float32Array(o.buffer)}function tFe(t,e,n,r,i,s,a,o){const l=t,c=new Float32Array(vLe(s,a));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function nFe(t,e,n){const r=new Float32Array(e*n*4);return mt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j${constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=Me().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,pLe(n,e)):this.gl=qc(n),e=this.gl,Me().getNumber("WEBGL_VERSION")===2){const s=e;this.createVertexArray=()=>mt(s,()=>s.createVertexArray()),this.bindVertexArray=a=>mt(s,()=>s.bindVertexArray(a)),this.deleteVertexArray=a=>mt(s,()=>s.deleteVertexArray(a)),this.getVertexArray=()=>mt(s,()=>s.getParameter(s.VERTEX_ARRAY_BINDING))}else if(e!=null){const s=e.getExtension("OES_vertex_array_object");if(s==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>mt(e,()=>s.createVertexArrayOES()),this.bindVertexArray=a=>mt(e,()=>s.bindVertexArrayOES(a)),this.deleteVertexArray=a=>mt(e,()=>s.deleteVertexArrayOES(a)),this.getVertexArray=()=>mt(e,()=>e.getParameter(s.VERTEX_ARRAY_BINDING_OES))}let r="WEBGL_color_buffer_float";const i="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),Me().getNumber("WEBGL_VERSION")===1){const s="OES_texture_float",a="OES_texture_half_float";if(this.textureFloatExtension=rN(this.gl,s),$l(this.gl,a))this.textureHalfFloatExtension=rN(this.gl,a);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),$l(this.gl,i))this.colorBufferHalfFloatExtension=rN(this.gl,i);else if(Me().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",$l(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if($l(this.gl,i))this.colorBufferHalfFloatExtension=this.gl.getExtension(i);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=U3e(this.gl),this.indexBuffer=V3e(this.gl),this.framebuffer=PLe(this.gl),this.textureConfig=x5(this.gl,this.textureHalfFloatExtension)}get debug(){return Me().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;mt(e,()=>e.finish()),mt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),mt(e,()=>e.deleteFramebuffer(this.framebuffer)),mt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),mt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),mt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),W3e(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),H3e(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),G3e(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),Z3e(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,r,i){this.throwIfDisposed(),Y3e(this.gl,e,n,r,i,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),X3e(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),q3e(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(R7(this.gl,this.framebuffer),this.outputTexture=null),mt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,r){return this.downloadMatrixDriver(e,()=>eFe(this.gl,n,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,r,i,s,a){return tFe(this.gl,e,n,r,i,s,a,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return J3e(this.gl,e,n)}createBufferFromTexture(e,n,r){this.bindTextureToFrameBuffer(e);const i=Q3e(this.gl,n,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),i}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,r;if(Me().getBool("WEBGL_FENCE_API_ENABLED")){const i=e,s=i.fenceSync(i.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const a=i.clientWaitSync(s,0,0);return a===i.ALREADY_SIGNALED||a===i.CONDITION_SATISFIED},n=s}else Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(n,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:n,isFencePassed:r}}downloadMatrixFromPackedTexture(e,n,r){return this.downloadMatrixDriver(e,()=>nFe(this.gl,n,r))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=B3e(n));const r=NLe(n);mt(n,()=>n.attachShader(r,this.vertexShader)),mt(n,()=>n.attachShader(r,e)),ALe(n,r);const i=Object.assign(r,{vao:this.createVertexArray()});return this.debug&&D$(n,i),i}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;mt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),K3e(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(mt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&D$(this.gl,this.program),mt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,r=!0){return this.throwIfDisposed(),r?DLe(this.gl,e,n):$Le(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),mt(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,r){this.throwIfDisposed(),this.throwIfNoProgram(),LLe(this.gl,e,n,r)}setOutputMatrixTexture(e,n,r){this.setOutputMatrixTextureDriver(e,r,n)}setOutputPackedMatrixTexture(e,n,r){this.throwIfDisposed();const[i,s]=eb(n,r);this.setOutputMatrixTextureDriver(e,i,s)}setOutputMatrixWriteRegion(e,n,r,i){this.setOutputMatrixWriteRegionDriver(r,e,i,n)}setOutputPackedMatrixWriteRegion(e,n,r,i){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&D$(this.gl,this.program),iN(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}mt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),mt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=rN(this.gl,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.createQuery();return r.beginQuery(i.TIME_ELAPSED_EXT,s),s}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,r=this.getQueryTimerExtensionWebGL2();n.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await a7(()=>this.disposed||this.isQueryAvailable(e,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const r=this.gl,i=this.getQueryTimerExtensionWebGL2(),s=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),s&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),i=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),i&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=rFe(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:r}=this.itemsToPoll[n];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in Me().platform&&(r=Me().platform.setTimeoutCustom.bind(Me().platform)),a7(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),$$(this.gl,e,this.framebuffer),this.debug&&iN(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?($$(this.gl,this.outputTexture,this.framebuffer),this.debug&&iN(this.gl)):R7(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const r=n();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,n,r){this.throwIfDisposed();const i=this.gl;$$(i,e,this.framebuffer),this.debug&&iN(i),this.outputTexture=e,mt(i,()=>i.viewport(0,0,n,r)),mt(i,()=>i.scissor(0,0,n,r))}setOutputMatrixWriteRegionDriver(e,n,r,i){this.throwIfDisposed(),mt(this.gl,()=>this.gl.scissor(e,n,r,i))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function rFe(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ct(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&q(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cce(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const iFe=t=>{const{x:e}=t.inputs,n=t.backend;Ct(e,"abs");let r=new Float32Array(Oe(e.shape));const i=n.data.get(e.dataId).values;return r=cce(i),n.makeOutput(r,e.shape,e.dtype)},sFe={kernelName:uM,backendName:"cpu",kernelFunc:iFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Si(t){return(e,n,r,i,s)=>{const a=dn(e,n),o=a.length,l=Ft(a),c=Oe(a),u=As(s,c),d=e.length,h=n.length,f=Ft(e),p=Ft(n),g=qx(e,a),m=qx(n,a);if(g.length+m.length===0)for(let y=0;y<u.length;++y)u[y]=t(r[y%r.length],i[y%i.length]);else for(let y=0;y<u.length;++y){const x=q0(y,o,l),b=x.slice(-d);g.forEach(C=>b[C]=0);const _=Ou(b,d,f),T=x.slice(-h);m.forEach(C=>T[C]=0);const E=Ou(T,h,p);u[y]=t(r[_],i[E])}return[u,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lo(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=n.makeTensorInfo(r.shape,"complex64"),l=n.data.get(o.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",s),imag:n.makeTensorInfo(i.shape,"float32",a)},o}const aFe={kernelName:QU,backendName:"cpu",kernelFunc:lo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GA(t,e,n="float32"){if(n==="complex64"){const i=GA(t,e,"float32"),s=GA(t,e,"float32");return lo({inputs:{real:i,imag:s},backend:t})}const r=qs(Oe(e),n);return t.makeTensorInfo(e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qu(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const oFe={kernelName:lT,backendName:"cpu",kernelFunc:qu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eg(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.real,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const lFe={kernelName:kV,backendName:"cpu",kernelFunc:Eg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n,r){if(r==="int32"){const i=Int32Array.from(t);return[e,"int32",i]}if(r==="bool"){const i=Xg([0],n),[s,a]=Si((o,l)=>o!==l?1:0)(e,[],t,i,"bool");return[a,"bool",s]}throw new Error(`Error in Cast: failed to cast ${n} to ${r}`)}function Kf(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return qu({inputs:{x:i},backend:n});const u=GA(n,i.shape,i.dtype),d=Kf({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),h=lo({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(i.dtype==="complex64"){const u=Eg({inputs:{input:i},backend:n}),d=Kf({inputs:{x:u},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(u),d}if(!dae(i.dtype,s)){const u=qu({inputs:{x:i},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:s}}const a=n.data.get(i.dataId).values,[o,l,c]=uce(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,c)}const cFe={kernelName:K_,backendName:"cpu",kernelFunc:Kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zi(t,e,n,r){return n==null?({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;Ct([a,o],t);const c=l.data.get(a.dataId).values,u=l.data.get(o.dataId).values,d=a.dtype==="string"?sh(c):c,h=a.dtype==="string"?sh(u):u,f=r||a.dtype,[p,g]=e(a.shape,o.shape,d,h,f);return l.makeTensorInfo(g,f,p)}:({inputs:i,backend:s})=>{const{a,b:o}=i,l=s;if(a.dtype==="complex64"||o.dtype==="complex64"){const c=Kf({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,g=Kf({inputs:{x:o},backend:l,attrs:{dtype:"complex64"}}),m=l.data.get(g.dataId),y=m.complexTensorInfos.real,x=m.complexTensorInfos.imag,b=l.data.get(y.dataId).values,_=l.data.get(x.dataId).values,[T,E,C]=n(a.shape,o.shape,f,p,b,_),I=l.makeTensorInfo(C,"float32",T),A=l.makeTensorInfo(C,"float32",E),k=lo({inputs:{real:I,imag:A},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(g),l.disposeIntermediateTensorInfo(I),l.disposeIntermediateTensorInfo(A),k}else{const c=l.data.get(a.dataId).values,u=l.data.get(o.dataId).values,d=r||a.dtype,[h,f]=e(a.shape,o.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function _5(t){return(e,n,r,i,s,a)=>{const o=dn(e,n),l=Oe(o),c=o.length,u=Ft(o),d=As("float32",l),h=As("float32",l),f=qx(e,o),p=qx(n,o),g=ih(r,i),m=ih(s,a),y=e.length,x=Ft(e),b=n.length,_=Ft(n);if(f.length+p.length===0)for(let T=0;T<d.length;T++){const E=T%g.length,C=T%m.length,I=t(g[E*2],g[E*2+1],m[C*2],m[C*2+1]);d[T]=I.real,h[T]=I.imag}else for(let T=0;T<d.length;T++){const E=q0(T,c,u),C=E.slice(-y);f.forEach($=>C[$]=0);const I=Ou(C,y,x),A=E.slice(-b);p.forEach($=>A[$]=0);const k=Ou(A,b,_),R=t(g[I*2],g[I*2+1],m[k*2],m[k*2+1]);d[T]=R.real,h[T]=R.imag}return[d,h,o]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dce=Si((t,e)=>t+e),uFe=_5((t,e,n,r)=>({real:t+n,imag:e+r})),Qx=Zi(X0,dce,uFe),dFe={kernelName:X0,backendName:"cpu",kernelFunc:Qx};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(t,e,n,r,i){const s=Oe(r),a=qs(i,n);for(let o=0;o<t.length;o++){const l=t[o];if(l<0)throw new Error("Input x must be non-negative!");l>=i||(s>0?a[l]+=e[o]:a[l]+=1)}return a}function hce(t,e,n,r=!1){const i=t.shape[0],s=t.shape[1],a=yn([i,n],e.dtype);for(let o=0;o<i;o++)for(let l=0;l<s;l++){const c=t.get(o,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(r?a.set(1,o,c):e.size>0?a.set(a.get(o,c)+e.get(o,l),o,c):a.set(a.get(o,c)+1,o,c))}return a}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fce=Si((t,e)=>t&e),hFe=Zi(vM,fce),fFe={kernelName:vM,backendName:"cpu",kernelFunc:hFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function id(t){return(e,n,r)=>{const i=xi(n,e.length);for(let s=0;s<e.length;++s)i[s]=t(e[s],r);return i}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cr(t,e,n){const r=id(e);return xp(t,r,n)}function xp(t,e,n){return({inputs:r,attrs:i,backend:s})=>{const{x:a}=r;Ct(a,t);const o=s,l=o.data.get(a.dataId).values;let c;if(a.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=sh(l)}else c=l;const u=n||a.dtype,d=e(c,u,i);return o.makeTensorInfo(a.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pce=id(t=>Math.ceil(t)),pFe=xp(Y_,pce),mFe={kernelName:Y_,backendName:"cpu",kernelFunc:pFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mce(t,e,n,r){const i=xi(n,Oe(e));if(r&&n!=="string"){let s=0;t.forEach(a=>{const o=Oe(a.shape);i.set(a.vals,s),s+=o})}else{let s=0;t.forEach(a=>{const o=n==="string"?sh(a.vals):a.vals;let l=0;for(let c=0;c<a.shape[0];++c){const u=c*e[1]+s;for(let d=0;d<a.shape[1];++d)i[u+d]=o[l++]}s+=a.shape[1]})}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gce=Si((t,e)=>t===e?1:0),yce=Zi(NM,gce,null,"bool"),gFe={kernelName:NM,backendName:"cpu",kernelFunc:yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vce=id(t=>Math.exp(t)),xce=xp(rT,vce,"float32"),yFe={kernelName:rT,backendName:"cpu",kernelFunc:xce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bce=id(t=>Math.expm1(t)),vFe=xp(iT,bce),xFe={kernelName:iT,backendName:"cpu",kernelFunc:vFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wce=id(t=>Math.floor(t)),bFe=xp(sT,wce),wFe={kernelName:sT,backendName:"cpu",kernelFunc:bFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sce=Si((t,e)=>Math.floor(t/e)),SFe=Zi(aT,Sce,null,"int32"),_Fe={kernelName:aT,backendName:"cpu",kernelFunc:SFe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t,e,n,r,i,s,a,o,l){const c=yn([r,s],n);for(let u=0;u<r;u++){const d=[];let h=0;for(let f=0;f<i;f++){const p=t[u*i+f];h+=p*a[f],d.push(p)}if(h<0||h>=l/s)throw new Error(`Invalid indices: ${d} does not index into ${o}`);for(let f=0;f<s;f++)c.values[u*s+f]=e.get(...e.indexToLoc(h*s+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tce(t,e,n){const r=yn(n,t.dtype);for(let i=0;i<r.size;++i){const a=r.indexToLoc(i).slice(),o=a[0],l=a[2],c=e.locToIndex([o,l]);a[2]=e.values[c];const u=t.locToIndex(a);0<=u&&u<t.values.length&&(r.values[i]=t.values[u])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ece=Si((t,e)=>t>e?1:0),TFe=Zi(MM,Ece,null,"bool"),EFe={kernelName:MM,backendName:"cpu",kernelFunc:TFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cce=Si((t,e)=>t>=e?1:0),CFe=Zi(oT,Cce,null,"bool"),NFe={kernelName:oT,backendName:"cpu",kernelFunc:CFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nce=Si((t,e)=>t<e?1:0),AFe=Zi(PM,Nce,null,"bool"),IFe={kernelName:PM,backendName:"cpu",kernelFunc:AFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ace=Si((t,e)=>t<=e?1:0),kFe=Zi(OM,Ace,null,"bool"),MFe={kernelName:OM,backendName:"cpu",kernelFunc:kFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t,e,n){const r=(e-t)/(n-1),i=qs(n,"float32");i[0]=t;for(let s=1;s<i.length;s++)i[s]=i[s-1]+r;return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kce=id(t=>Math.log(t)),RFe=xp(hT,kce),PFe={kernelName:hT,backendName:"cpu",kernelFunc:RFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mce(t,e,n,r){const i=As(r,Oe(n));for(let s=0;s<i.length;++s){const a=s*e;let o=t[a];for(let l=0;l<e;++l){const c=t[a+l];(Number.isNaN(c)||c>o)&&(o=c)}i[s]=o}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rce=Si((t,e)=>Math.max(t,e)),OFe=Zi(pT,Rce),DFe={kernelName:pT,backendName:"cpu",kernelFunc:OFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pce=Si((t,e)=>Math.min(t,e)),$Fe=Zi(mT,Pce),LFe={kernelName:mT,backendName:"cpu",kernelFunc:$Fe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5=Si((t,e)=>t*e),FFe=_5((t,e,n,r)=>({real:t*n-e*r,imag:t*r+e*n})),BR=Zi(yT,E5,FFe),jFe={kernelName:yT,backendName:"cpu",kernelFunc:BR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oce(t,e,n){const r=hp(-1,n);return E5([],e,r,t,n)}function zFe(t){const{inputs:e,backend:n}=t,{x:r}=e;Ct(r,"neg");const i=n.data.get(r.dataId).values,[s,a]=Oce(i,r.shape,r.dtype);return n.makeTensorInfo(a,r.dtype,s)}const BFe={kernelName:HM,backendName:"cpu",kernelFunc:zFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dce=Si((t,e)=>t!==e?1:0),UFe=Zi(GM,Dce,null,"bool"),VFe={kernelName:GM,backendName:"cpu",kernelFunc:UFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e,n,r,i){const s=e.length,a=Oe(e),o=Ft(e),l=Ft(i),c=As(n,Oe(i));for(let u=0;u<a;++u){const d=q0(u,s,o),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[r[p]];const f=Ou(h,s,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ga(t){const{inputs:e,attrs:n,backend:r}=t,{x:i}=e,{perm:s}=n;Ct(i,"transpose");const a=i.shape.length,o=new Array(a);for(let d=0;d<o.length;d++)o[d]=i.shape[s[d]];const l=r.data.get(i.dataId).values,c=C5(l,i.shape,i.dtype,s,o);return{dataId:r.write(c,o,i.dtype),shape:o,dtype:i.dtype}}const WFe={kernelName:nx,backendName:"cpu",kernelFunc:Ga};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ce(t,e,n,r){const[i,s]=fs(t,r),a=bo(e,"int32"),o=qs(Oe(i),a),l=Oe(s);for(let c=0;c<o.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];o[c]=d}return{outVals:o,outShape:i,outDtype:a}}function HFe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;Ct(i,"prod");const o=i.shape.length,l=Nn(s,i.shape),c=Jr(l,o);let u=l,d=i;const h=[];c!=null&&(d=Ga({inputs:{x:i},backend:n,attrs:{perm:c}}),h.push(d),u=wi(u.length,o));const f=n.data.get(d.dataId).values,{outVals:p,outShape:g,outDtype:m}=$ce(d.shape,d.dtype,f,u);let y=g;return a&&(y=bi(g,l)),h.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(y,m,p)}const GFe={kernelName:QM,backendName:"cpu",kernelFunc:HFe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qFe(t,e,n){t.forEach((r,i)=>{if(r<0||r>=n){const s=q0(i,e.length,Ft(e)).join(",");throw new Error(`indices[${s}] = ${r} is not in [0, ${n})`)}})}function XFe(t,e){for(let n=0;n<t.length;++n){const r=t[n],i=n===t.length-1?e:t[n+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>i)throw new Error("Ragged splits must not point past values");for(let s=1;s<r.length;++s)if(r[s-1]>r[s])throw new Error("Ragged splits must be sorted in ascending order")}}function KFe(t,e,n,r){const i=[];let s=0;const a=e.length-1+n.length,o=new Array(a).fill(null).map(()=>[0]);XFe(n,r);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)o[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const g=o[p],m=g[g.length-1]-f[u];for(let y=u;y<d;++y)o[p].push(f[y+1]+m)}u=f[u],d=f[d]}d!==u&&(i.push([u,d]),s+=d-u)}return{outSplits:o,valueSlices:i,numValues:s}}function YFe(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n].length,i=xi("int32",r);e.push(i),t[n].forEach((s,a)=>i[a]=s)}return e}function $7(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let r=e;r<t.length;r++)n[e-1]*=t[r];return n}function ZFe(t,e,n,r,i,s){const a=$7(e,2)[1],o=$7(s,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<r;++d)i[l*o+d]=t[u*a+d];++l}}function QFe(t,e,n,r,i){const s=e.slice();s[0]=i;const a=xi(n,Oe(s)),o=t.length,l=o===0?0:o/e[0];return ZFe(t,e,r,l,a,s),[a,s]}function Lce(t,e,n,r,i,s,a,o){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(qFe(s,a,l),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:u,valueSlices:d,numValues:h}=KFe(s,a,t,c),f=YFe(u),p=QFe(n,r,i,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L7=2147483647;function Fce(t,e,n,r,i,s,a){if(e.length>1)throw new Error("starts must be a scalar or vector");if(i.length>1)throw new Error("limits must be a scalar or vector");if(a.length>1)throw new Error("deltas must be a scalar or vector");const o=e.length===0,l=i.length===0,c=a.length===0,u=[];o||u.push(e[0]),l||u.push(i[0]),c||u.push(a[0]);for(let m=1;m<u.length;++m)if(u[m]!==u[m-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=xi("int32",d+1);h[0]=0;for(let m=0;m<d;++m){const y=o?t[0]:t[m],x=l?r[0]:r[m],b=c?s[0]:s[m];if(b===0)throw new Error("Requires delta != 0");let _;if(b>0&&x<y||b<0&&x>y)_=0;else if(_=Math.ceil(Math.abs((x-y)/b)),_>L7)throw new Error(`Requires ((limit - start) / delta) <= ${L7}`);h[m+1]=h[m]+_}const f=h[d],p=xi(n,f);let g=0;for(let m=0;m<d;++m){const y=h[m+1]-h[m];let x=o?t[0]:t[m];const b=c?s[0]:s[m];for(let _=0;_<y;++_)p[g++]=x,x+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var vl=_c;class qA{constructor(e,n,r,i,s,a,o,l,c,u){this.shape=e,this.shapeShape=n,this.values=r,this.valuesShape=i,this.valuesDType=s,this.defaultValue=a,this.defaultValueShape=o,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=Ile(u),this.raggedRank=kle(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===vl.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===vl.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case vl.VALUE_ROWIDS:return qA.getMaxWidthValueRowID(n);case vl.ROW_SPLITS:return qA.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${vl[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let r=0;for(let i=0;i<n-1;++i){const s=e[i+1]-e[i];s>r&&(r=s)}return r}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let r=0,i=e[0],s=0;for(let a=1;a<n;++a){const o=e[a];o!==i&&(i=o,s=Math.max(a-r,s),r=a)}return Math.max(n-r,s)}tensorShapeFromTensor(e,n,r=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return j7(e,r)}calculateOutputSize(e){const n=this.valuesShape,r=this.defaultValueShape;Mle(r,n);const i=this.tensorShapeFromTensor(this.shape,this.shapeShape),a=Ale(this.raggedRank,i,n);a[0]<0&&(a[0]=e);for(let o=1;o<=this.raggedRank;++o)a[o]<0&&(a[o]=this.getMaxWidth(o));return a}calculateFirstParentOutputIndex(e,n,r){const i=Math.min(e,r),s=[];let a=0;for(let o=0;o<i;++o,a+=n)s.push(a);for(let o=i;o<e;++o)s.push(-1);return q(s.length===e,()=>"Final length of result must be equal to firstDimension."),s}calculateOutputIndexRowSplit(e,n,r,i){const s=e.length,a=[];for(let o=0;o<s-1;++o){const l=e[o+1]-e[o];let c=Math.min(i,l),u=n[o];u===-1&&(c=0);for(let d=0;d<c;++d)a.push(u),u+=r;for(let d=0;d<l-c;++d)a.push(-1)}if(s>0&&a.length!==e[s-1])throw new Error("Invalid row split size.");return a}calculateOutputIndexValueRowID(e,n,r,i){const s=e.length,a=[];if(s===0)return[];let o=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];a.push(c);for(let u=1;u<s;++u){const d=e[u];if(d===l)c>=0&&(++o,o<i?c+=r:c=-1);else{if(o=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}a.push(c)}if(a.length!==e.length)throw new Error("Invalid row ids.");return a}calculateOutputIndex(e,n,r,i){const s=this.getRowPartitionTensor(e),a=this.getRowPartitionTypeByDimension(e);switch(a){case vl.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(s,n,r,i);case vl.ROW_SPLITS:if(s.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${s.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(s,n,r,i);default:throw new Error(`Unsupported partition type: ${vl[a]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case vl.FIRST_DIM_SIZE:return e[0];case vl.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case vl.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${vl[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),r=this.calculateOutputSize(n),i=new Array(this.raggedRank+1);i[i.length-1]=1;for(let l=i.length-2;l>=0;--l)i[l]=i[l+1]*r[l+1];const s=j7(r,!1),a=xi(this.valuesDType,Oe(s));if(i[0]*r[0]>0){let l=this.calculateFirstParentOutputIndex(n,i[0],r[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,i[c],r[c]);this.setOutput(this.raggedRank,l,a,s)}return[s,a]}setOutput(e,n,r,i){if(r.length===0)return;const s=this.values,a=r;let o=i.slice();o=o.slice(e+1);const l=Oe(o),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;ve(()=>{const g=de(u,p);u=sx(g,o).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let g=p<c?n[p]:-1;if(g===f){++f;continue}if(h<f){const m=s.subarray(d*l),y=a.subarray(h*l),x=(f-h)*l;F7(y,m,x)}if(p>=c){const m=r.length;g=Math.floor(m/l)}if(g>f)if(this.defaultValue.length===1)a.subarray(f*l,g*l).fill(this.defaultValue[0]),f=g;else for(;g>f;){const m=a.slice(f*l);F7(m,u,l),++f}g<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function F7(t,e,n){for(let r=0;r<n;r++)t[r]=e[r]}function j7(t,e){const n=[];for(let r of t){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}n.push(r)}return n}function jce(t,e,n,r,i,s,a,o,l,c){return new qA(t,e,n,r,i,s,a,o,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zce(t,e,n,r){const i=t===e,s=t<e&&n<0,a=e<t&&n>1;if(i||s||a)return qs(0,r);const o=Math.abs(Math.ceil((e-t)/n)),l=qs(o,r);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=id(t=>1/Math.sqrt(t)),JFe=xp(_T,Bce),eje={kernelName:_T,backendName:"cpu",kernelFunc:JFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nm(t,e,n,r,i,s,a,o,l,c){const u=[r/i,i],d=t.values,h=e.values;if(r===0)return yn(n,e.dtype);const f=l instanceof Hi?l:yn(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<s;p++){const g=[];let m=0;for(let y=0;y<a;y++){const x=d[p*a+y];g.push(x),m+=x*o[y]}if(m<0||m>=r/i)throw new Error(`Invalid indices: ${g} does not index into ${n}`);for(let y=0;y<i;y++)c?f.values[m*i+y]+=h[p*i+y]:f.values[m*i+y]=e.rank===0?h[0]:h[p*i+y]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tje=id(t=>1/(1+Math.exp(-t))),Uce=cr(AT,t=>1/(1+Math.exp(-t))),nje={kernelName:AT,backendName:"cpu",kernelFunc:Uce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vce(t,e,n,r,i){const s=ZW(r,e,n),a=Oe(n),o=Ft(r);if(s){const d=QW(e,o);return i==="string"?t.slice(d,d+a):t.subarray(d,d+a)}const l=i==="string"?sh(t):t,c=yn(r,i,l),u=yn(n,i);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,g)=>p+e[g]);u.set(c.get(...f),...h)}return i==="string"?Zle(u.values):u.values}function Cg(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:s,size:a}=r;Ct(i,"slice");const[o,l]=$R(i,s,a);KW(i,o,l);const c=n.data.get(i.dataId).values,u=Vce(c,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,u)}const rje={kernelName:iR,backendName:"cpu",kernelFunc:Cg};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wce(t,e,n,r,i,s,a){const o=e[0],l=s[0],c=new Array(l),u=new Array(o),d=e[1];if(l===0){if(o!==0)throw new Error(Fle(o));const m=xi(n,0),y=xi(i,0);return[m,[0,d],y,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let m=0;m<o;++m){const y=t[m*d];if(y<0)throw new Error(jle(m,y));if(y>=l)throw new Error(zle(m,y,l));++p[y],h=h&&y>=f,f=y}let g=!0;for(let m=0;m<l;++m){const y=p[m]===0;c[m]=y,g=g&&!y,p[m]=Math.max(p[m],1),m>0&&(p[m]+=p[m-1])}if(g&&h){const m=t,y=r;for(let x=0;x<o;++x)u[x]=x;return[m,[o,d],y,c,u]}else{const m=p[l-1],y=xi(n,m*d),x=xi(i,m),b=new Array(l).fill(0);for(let _=0;_<o;++_){const T=t[_*d],E=b[T],C=(T===0?0:p[T-1])+E;b[T]++;for(let I=0;I<d;++I)y[C*d+I]=t[_*d+I];x[C]=r[_],u[_]=C}for(let _=0;_<l;++_)if(b[_]===0){const E=_===0?0:p[_-1];y[E*d+0]=_;for(let C=1;C<d;++C)y[E*d+C]=0;x[E]=a}return[y,[m,d],x,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hce(t,e,n,r,i){const s=Oe(r),a=e[0],o=i.length,l=[];let c=1,u=-1;for(let m=0;m<o;++m){const y=i[m];if(y===-1){if(u!==-1)throw new Error(Ble(u,m));u=m,l.push(1)}else{if(y<0)throw new Error(Ule(m,y));c*=y,l.push(y)}}if(u!==-1){if(c<=0)throw new Error(Vle());const m=Math.trunc(s/c);if(c*m!==s)throw new Error(Wle(r,l));l[u]=m}if(Oe(l)!==s)throw new Error(Hle(r,l));const h=r.length,f=[];if(h>0){f[h-1]=1;for(let m=h-2;m>=0;--m)f[m]=f[m+1]*r[m+1]}const p=[];if(o>0){p[o-1]=1;for(let m=o-2;m>=0;--m)p[m]=p[m+1]*l[m+1]}const g=xi(n,a*o);for(let m=0;m<a;++m){let y=0;for(let x=0;x<h;++x)y+=t[m*h+x]*f[x];for(let x=0;x<o;++x)g[m*o+x]=Math.trunc(y/p[x]),y%=p[x]}return[g,[a,o],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N5(t,e,n,r,i,s=!1,a=0){const o=r.length,l=[e[0],t.length/e[0]],c=l[1],d=o>0?i[o-1]+1:0;if(d<0)throw new Error(hj());const h=e.slice();h[0]=d;const f=h.reduce((b,_)=>b*_,1),p=xi(n,f);if(o===0)return d>0&&p.fill(a),[p,h];if(d<=0)throw new Error(hj());let g=0,m=1,y=0,x=i[g];for(;;){let b=0;if(m<o){if(b=i[m],x===b){++m;continue}if(x>=b)throw new Error(Gle())}if(x<0||x>=d)throw new Error(qle(x,d));x>y&&p.fill(a,y*c,x*c);for(let _=g;_<m;++_){const T=r[_];if(T<0||T>=l[0])throw new Error(Xle(_,r[_],l[0]));for(let E=0;E<c;E++)p[x*c+E]+=t[T*c+E]}if(s)for(let _=0;_<c;_++)p[x*c+_]/=m-g;if(g=m,++m,y=x+1,x=b,m>o)break}return y<d&&p.fill(a,y*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ije=id(t=>Math.sqrt(t)),sje=cr(kT,t=>Math.sqrt(t)),aje={kernelName:kT,backendName:"cpu",kernelFunc:sje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=Si((t,e)=>{const n=t-e;return n*n}),oje=Zi(MT,Gce),lje={kernelName:MT,backendName:"cpu",kernelFunc:oje};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qce=id((t,e)=>{const{pattern:n,replaceGlobal:r,rewrite:i}=e;return t.replace(new RegExp(n,r?"g":""),i)}),cje=xp(cR,qce),uje={kernelName:cR,backendName:"cpu",kernelFunc:cje};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xce(t,e,n,r){const i=yn(t,e.dtype);for(let s=0;s<i.size;s++){const a=i.indexToLoc(s),o=new Array(a.length);for(let l=0;l<o.length;l++)o[l]=a[l]*n[l]+r[l];i.set(e.get(...o),...a)}return i}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dje{constructor(e,n,r,i,s,a){this.separator=kf(e),this.nGramWidths=n,this.leftPad=kf(r),this.rightPad=kf(i),this.padWidth=s,this.preserveShort=a}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const r=this.getPadWidth(n);return Math.max(0,e+2*r-n+1)}createNGrams(e,n,r,i,s,a){for(let o=0;o<s;++o){const l=this.getPadWidth(a),c=Math.max(0,l-o),u=Math.max(0,l-(s-(o+1))),d=a-(c+u),h=n+(c>0?0:o-l);let f=0;f+=c*this.leftPad.length;for(let x=0;x<d;++x)f+=e[h+x].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,r[i+o]=new Uint8Array(f);const g=r[i+o];let m=0;const y=x=>x.forEach(b=>g[m++]=b);for(let x=0;x<c;++x)y(this.leftPad),y(this.separator);for(let x=0;x<d-1;++x)y(e[h+x]),y(this.separator);if(d>0){y(e[h+d-1]);for(let x=0;x<u;++x)y(this.separator),y(this.rightPad)}else{for(let x=0;x<u-1;++x)y(this.rightPad),y(this.separator);y(this.rightPad)}}}compute(e,n){const r=e.length,i=n.length;if(i>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<i;++c){let u=n[c]>=l;if(u=u&&n[c]<=r,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${r}]`);l=n[c]}if(l!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${l}`)}const s=i-1,a=xi("int32",i);if(r===0||i===0){const l=new Array(r);for(let c=0;c<=s;++c)a[c]=0;return[l,a]}a[0]=0;for(let l=1;l<=s;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),a[l]=a[l-1]+u}const o=new Array(a[s]);for(let l=0;l<s;++l){const c=n[l];let u=a[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,o,u,f,d),u+=f}),this.preserveShort&&u===a[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth;this.createNGrams(e,c,o,u,1,h)}}return[o,a]}}function Kce(t,e,n,r,i,s,a,o){return new dje(n,r,i,s,a,o).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hje(t,e,n,r){if(!t.length)return;if(e.length===0){for(let s=0;s<t.length;++s)r.push(t.subarray(s,s+1));return}if(e.length===1){const s=e[0];let a=t.indexOf(s);for(;a!==-1;){const o=t.subarray(0,a);(!n||o.length!==0)&&r.push(o),t=t.subarray(a+1),a=t.indexOf(s)}(!n||t.length!==0)&&r.push(t);return}let i=0;for(let s=0;s<t.length+1;s++)if(s===t.length||e.indexOf(t[s])!==-1){const a=t.subarray(i,s);(!n||a.length!==0)&&r.push(a),i=s+1}}function Yce(t,e,n){const r=t.length,i=[];let s=0,a=0;const o=new Array(r);for(let h=0;h<r;++h){const f=i.length;hje(t[h],e,n,i);const p=i.length-f;o[h]=p,s+=p,a=Math.max(a,p)}const l=xi("int32",s*2),c=new Array(s),u=[r,a];let d=0;for(let h=0;h<r;++h)for(let f=0;f<o[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=i[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zce(t,e){const n=xi("int32",t.length);for(let r=0;r<t.length;++r)n[r]=uIe(t[r]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qce=Si((t,e)=>t-e),fje=_5((t,e,n,r)=>({real:t-n,imag:e-r})),A5=Zi(RT,Qce,fje),pje={kernelName:RT,backendName:"cpu",kernelFunc:A5};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jce(t,e){const n=new Array(t.rank);for(let i=0;i<n.length;i++)n[i]=t.shape[i]*e[i];const r=yn(n,t.dtype);for(let i=0;i<r.values.length;++i){const s=r.indexToLoc(i),a=new Array(t.rank);for(let l=0;l<a.length;l++)a[l]=s[l]%t.shape[l];const o=t.locToIndex(a);r.values[i]=t.values[o]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ww=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function eue(t,e,n=0,r=t.length-1){for(;r>n;){if(r-n>600){const o=r-n+1,l=e-n+1,c=Math.log(o),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(o-u)/o)*Math.sign(l-o/2),h=Math.max(n,Math.floor(e-l*u/o+d)),f=Math.min(r,Math.floor(e+(o-l)*u/o+d));eue(t,e,h,f)}const i=t[e];let s=n,a=r;for(fv(t,n,e),Ww(t[r],i)>0&&fv(t,n,r);s<a;){for(fv(t,s,a),s++,a--;Ww(t[s],i)<0;)s=s+1;for(;Ww(t[a],i)>0;)a=a-1}Ww(t[n],i)===0?fv(t,n,a):(a=a+1,fv(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}}function tue(t,e,n,r,i){const s=e[e.length-1],[a,o]=[t.length/s,s],l=As(n,a*r),c=As("int32",a*r);for(let d=0;d<a;d++){const h=d*o,f=t.subarray(h,h+o);let p=new Array(f.length);f.forEach((x,b)=>p[b]={value:x,index:b}),r<p.length&&(eue(p,r),p=p.slice(0,r)),i&&p.sort(Ww);const g=d*r,m=l.subarray(g,g+r),y=c.subarray(g,g+r);for(let x=0;x<r;x++)m[x]=p[x].value,y[x]=p[x].index}const u=e.slice();return u[u.length-1]=r,[yn(u,n,l),yn(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nue(t,e,n,r){const i=Nn(e,n)[0],s=[1,n[0],1];for(let p=0;p<i;p++)s[0]*=n[p];s[1]=n[i];for(let p=i+1;p<n.length;p++)s[2]*=n[p];const a=new Map,o=new Int32Array(n[i]),l=new Hi(s,r,t),c=[],u=s[0]===1&&s[2]===1;for(let p=0;p<n[i];p++){let g;if(u)g=t[p].toString();else{const y=[];for(let x=0;x<s[0];x++)for(let b=0;b<s[2];b++)y.push(l.get(x,p,b));g=y.join(",")}const m=a.get(g);if(m!=null)o[p]=m;else{const y=a.size;a.set(g,y),o[p]=y,c.push(p)}}const d=s.slice();d[1]=a.size;const h=new Hi(d,r);c.forEach((p,g)=>{for(let m=0;m<s[0];m++)for(let y=0;y<s[2];y++)h.set(l.get(m,p,y),m,g,y)});const f=n.slice();return f[i]=d[1],{outputValues:h.values,outputShape:f,indices:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mje=Object.freeze(Object.defineProperty({__proto__:null,addImpl:dce,bincountImpl:T5,bincountReduceImpl:hce,bitwiseAndImpl:fce,castImpl:uce,ceilImpl:pce,concatImpl:mce,equalImpl:gce,expImpl:vce,expm1Impl:bce,floorDivImpl:Sce,floorImpl:wce,gatherNdImpl:_ce,gatherV2Impl:Tce,greaterEqualImpl:Cce,greaterImpl:Ece,lessEqualImpl:Ace,lessImpl:Nce,linSpaceImpl:Ice,logImpl:kce,maxImpl:Mce,maximumImpl:Rce,minimumImpl:Pce,multiplyImpl:E5,negImpl:Oce,notEqualImpl:Dce,prodImpl:$ce,raggedGatherImpl:Lce,raggedRangeImpl:Fce,raggedTensorToTensorImpl:jce,rangeImpl:zce,rsqrtImpl:Bce,scatterImpl:Nm,sigmoidImpl:tje,simpleAbsImpl:cce,sliceImpl:Vce,sparseFillEmptyRowsImpl:Wce,sparseReshapeImpl:Hce,sparseSegmentReductionImpl:N5,sqrtImpl:ije,squaredDifferenceImpl:Gce,staticRegexReplaceImpl:qce,stridedSliceImpl:Xce,stringNGramsImpl:Kce,stringSplitImpl:Yce,stringToHashBucketFastImpl:Zce,subImpl:Qce,tileImpl:Jce,topKImpl:tue,transposeImpl:C5,uniqueImpl:nue},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:gje,bincountImpl:rue,bincountReduceImpl:yje,bitwiseAndImpl:vje,castImpl:xje,ceilImpl:bje,concatImpl:wje,equalImpl:Sje,expImpl:_je,expm1Impl:Tje,floorImpl:Eje,gatherNdImpl:Cje,gatherV2Impl:Nje,greaterImpl:Aje,greaterEqualImpl:Ije,lessImpl:kje,lessEqualImpl:Mje,linSpaceImpl:Rje,logImpl:Pje,maxImpl:Oje,maximumImpl:Dje,minimumImpl:$je,multiplyImpl:Lje,negImpl:Fje,notEqualImpl:jje,prodImpl:zje,raggedGatherImpl:Bje,raggedRangeImpl:Uje,raggedTensorToTensorImpl:Vje,rangeImpl:Wje,rsqrtImpl:Hje,scatterImpl:Gje,sigmoidImpl:qje,simpleAbsImpl:iue,sliceImpl:Xje,sparseFillEmptyRowsImpl:Kje,sparseReshapeImpl:Yje,sparseSegmentReductionImpl:sue,sqrtImpl:Zje,staticRegexReplaceImpl:Qje,stridedSliceImpl:Jje,stringNGramsImpl:eze,stringSplitImpl:tze,stringToHashBucketFastImpl:nze,subImpl:rze,tileImpl:ize,topKImpl:sze,transposeImpl:I5,uniqueImpl:aze}=mje;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aue(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function fa(t,e){return e===1?[t]:aue(t,e)}function oze(t,e){if(t===1)return"rc";let n="";for(let r=0;r<t;r++)n+=e[r],r<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lze{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Xs(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=fa("rc",this.rank),r=gr(this.rank),i=this.getOutOfBoundsCondition(n),s=this.getSetup(n),a=this.getOutput(n);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${i}) {
            setOutput(vec4(0));
          } else {
            ${s}

            setOutput(vec4(${a}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let r=0;r<=1;r++)for(let i=0;i<=1;i++){let s=`${r===0?"r":"rp1"}, ${i===0?"c":"cp1"}`;for(let a=2;a<this.rank;a++)s=`${e[e.length-1-a]},`+s;n.push(s)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let r=this.rank-2;r<this.rank;r++)n+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],i=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${i};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oue{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length);let r="";for(let i=0;i<4;i++){let s="thisRC = rc;";i%2===1&&(s+="thisRC.z += 1;"),i>1&&(s+="thisRC.y += 1;"),r+=`
        ${s}
        ${i>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${i}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${i>0?"}":""}
      `}this.userCode=`
      ${cze(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?w5():b5(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function cze(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?KLe(["r","c","d"],"inputShape"):Jg(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uze{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,r){const i=B7(n,r),s=U7(e,i,r);s in this.freeTextures||(this.freeTextures[s]=[]),s in this.usedTextures||(this.usedTextures[s]=[]);const a=z7(e,i,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[s].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=a,this.log();const l=this.freeTextures[s].pop();return this.usedTextures[s].push(l),l}let o;return i===Es.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):i===Es.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):i===Es.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):i===Es.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):i===Es.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[s].push(o),this.numUsedTextures++,this._numBytesAllocated+=a,this.log(),o}releaseTexture(e,n,r,i){if(this.freeTextures==null)return;const s=B7(r,i),a=U7(n,s,i);a in this.freeTextures||(this.freeTextures[a]=[]);const o=z7(n,s,this.gpgpu.gl,this.gpgpu.textureConfig,i),l=Me().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=o):(this.freeTextures[a].push(e),this.numFreeTextures++,this._numBytesFree+=o),this.numUsedTextures--;const c=this.usedTextures[a],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function dze(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function z7(t,e,n,r,i){const s=hze(e,r);let a;if(i){const[l,c]=eb(t[0],t[1]);a=l*c}else{const[l,c]=XT(t[0],t[1]);a=l*c}const o=dze(n,s);return a*o}function hze(t,e){switch(t){case Es.PACKED_2X2_FLOAT32:return oce(e);case Es.PACKED_2X2_FLOAT16:return lce(e);case Es.UNPACKED_FLOAT32:return ice(e);case Es.UNPACKED_FLOAT16:return sce(e);case Es.PACKED_4X1_UNSIGNED_BYTE:return ace(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function fze(t){return Me().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Es.PACKED_2X2_FLOAT32:Es.UNPACKED_FLOAT32:t?Es.PACKED_2X2_FLOAT16:Es.UNPACKED_FLOAT16}function B7(t,e){if(t===Go.UPLOAD)return Es.PACKED_2X2_FLOAT32;if(t===Go.RENDER||t==null)return fze(e);if(t===Go.DOWNLOAD||t===Go.PIXELS)return Es.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function U7(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nu{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Ql="if (isnan(x)) return x;",pze="return x;",V7="return abs(x);",mze="return (x >= 0.0) ? x : (exp(x) - 1.0);",gze=Ql+`
  return (x < 0.0) ? 0.0 : x;
`,yze=Ql+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Yh="return x;",vze="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xze="return x;",bze=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,wze=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Sze=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,_ze="return 1.0 / (1.0 + exp(-1.0 * x));";class gf{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tze{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length);const n=e.length,r=fa("rc",n),i=gr(n),s=oze(n,r),a=r.slice(-2),o=n<=1?"rc":`vec2(${a.join(",")})`;this.userCode=`
      void main() {
        ${i} rc = getOutputCoords();
        vec4 packedInput = getA(${s});

        setOutput(getChannel(packedInput, ${o}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eze=LW,Cze=1e-7,Nze=1e-4,oN={};function Aze(t){return t in oN||(oN[t]={}),oN[t]}const Ize=Me().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),kze=600;function Mze(){return Me().global.screen==null?1024:Me().global.screen.height*Me().global.screen.width*window.devicePixelRatio*kze/1024/1024}class UR extends UU{nextDataId(){return UR.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!Me().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof j$)n=e;else{const r=qc(Me().getNumber("WEBGL_VERSION"),e);n=new j$(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=qc(Me().getNumber("WEBGL_VERSION"));n=new j$(r),this.binaryCache=Aze(Me().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new uze(this.gpgpu),this.numMBBeforeWarning=Mze(),this.texData=new cae(this,Fo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,r,i,s,a){const o=this.makeTensorInfo(n,r),l=this.texData.get(o.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[i,s]},l.texShape=[i,s];const c=sN(n),u=new D7(c,!1,a),d=this.runWebGLProgram(u,[o],r,[[i,s]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(o),d.dataId}write(e,n,r){if((Me().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Me().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const i={id:this.nextDataId()};return this.texData.set(i,{shape:n,dtype:r,values:e,usage:Go.UPLOAD,refCount:1}),i}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,r,i,s){if(Me().getBool("DEBUG")&&this.checkNumericalProblems(n),i==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:i,values:n,usage:Go.UPLOAD,refCount:s})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:r,dtype:i,complexTensorInfos:s,slice:a,shape:o,isPacked:l}=n;if(a!=null){let h;l?h=new gf(o,Yh):h=new Nu(o,Yh);const f=this.runWebGLProgram(h,[{dataId:e,shape:o,dtype:i}],i),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(r!=null)return this.convertAndCacheOnCPU(e);if(i==="string")return r;const c=this.activeTimers!=null;let u;c&&(u=Oa());let d;if(i==="complex64"){const h=this.readSync(s.real.dataId),f=this.readSync(s.imag.dataId);d=ih(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Oa()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(g=>p.push(g))}const n=this.texData.get(e),{values:r,shape:i,slice:s,dtype:a,complexTensorInfos:o,isPacked:l}=n;if(s!=null){let p;l?p=new gf(i,Yh):p=new Nu(i,Yh);const g=this.runWebGLProgram(p,[{dataId:e,shape:i,dtype:a}],a),m=this.read(g.dataId);return this.disposeIntermediateTensorInfo(g),m}if(r!=null)return this.convertAndCacheOnCPU(e);if(Me().getBool("DEBUG")&&!Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&Me().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(a!=="complex64"&&Me().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...nN(i))}this.pendingRead.set(e,[]),a!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(a==="complex64"){const p=await Promise.all([this.read(o.real.dataId),this.read(o.imag.dataId)]),g=p[0],m=p[1];d=ih(g,m)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=Oe(i);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;mt(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Fo().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const r=this.texData.get(e),{values:i,shape:s,slice:a,dtype:o,isPacked:l,texture:c}=r;if(o==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(a!=null){let f;l?f=new gf(s,Yh):f=new Nu(s,Yh);const p=this.runWebGLProgram(f,[{dataId:e,shape:s,dtype:o}],o),g=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),g}if(c==null)throw i!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=Fo().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(i=>Vf(i));return yn(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return yn(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const r=e[n];if(!SLe(r))throw Me().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:r,isPacked:i}=this.texData.get(e),s=Oe(n);if(Me().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...nN(n)).subarray(0,s);return this.disposeIntermediateTensorInfo(h),p}const a=Me().getBool("WEBGL_PACK")&&i===!0,o=a?sN(n):n,l=a?new F3e(o):new L3e(o),c=this.runWebGLProgram(l,[{shape:o,dtype:r,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,s);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,r=[];let i=!1;this.programTimersStack==null?(this.programTimersStack=r,i=!0):this.activeTimers.push(r),this.activeTimers=r,e();const s=gg(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),a=gg(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,i&&(this.programTimersStack=null);const o={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(s);o.kernelMs=zAe(l),o.getExtraProfileInfo=()=>l.map((c,u)=>({name:a[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else o.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,o})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Oa(),endMs:null}}endTimer(e){return Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Oa(),e)}async getQueryTime(e){if(Me().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,n),this.disposeData(r.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:r,texShape:i,usage:s,isPacked:a,slice:o}=this.texData.get(e),l=o&&o.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(i,r),this.textureManager.releaseTexture(n,i,s,a)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=Ize){return Me().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Oe(r.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Uo("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return Eze(e.shape,n)}packedUnaryOp(e,n,r){const i=new gf(e.shape,n),s=this.compileAndRun(i,[e],r);return Fo().makeTensorFromTensorInfo(s)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const i=iue(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,i)}if(Me().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,V7,e.dtype);const n=new Nu(e.shape,V7),r=this.compileAndRun(n,[e]);return Fo().makeTensorFromTensorInfo(r)}makeTensorInfo(e,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&B_(r[0])){const s=r.map(a=>kf(a));i=this.write(s,e,n)}else i=this.write(r,e,n);return this.texData.get(i).usage=null,{dataId:i,shape:e,dtype:n}}makeOutput(e,n,r){return Fo().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,r),this)}unpackTensor(e){const n=new Tze(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new lze(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const r=[Yx(e.shape),...Zx(e.shape)],i={dtype:e.dtype,shape:r,dataId:e.dataId},s=[Yx(n),...Zx(n)],a=new oue(s,r),o=!0,l=[r],c=this.runWebGLProgram(a,[i],e.dtype,l,o);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const r=this.texData.get(e),{isPacked:i,shape:s,dtype:a}=r;if(n!=null){const h=Oe(s),f=n[0]*n[1]*4;q(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const o=sN(s);let l;i?l=new $3e(o):l=new D3e(o);const c=!0,u=[n??nN(o)],d=this.runWebGLProgram(l,[{shape:o,dtype:a,dataId:e}],a,u,c,n);return{dtype:a,shape:s,dataId:d.dataId}}runWebGLProgram(e,n,r,i,s=!1,a){const o=this.makeTensorInfo(e.outputShape,r),l=this.texData.get(o.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===tS.DENSE){const y=a??nN(e.outputShape);l.texShape=y.map(x=>x*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Oe(o.shape)===0)return l.values=As(o.dtype,0),o;const c=[],u=n.map(y=>{if(y.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let x=this.texData.get(y.dataId);if(x.texture==null){if(!e.packedInputs&&Oe(y.shape)<=Me().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:y.shape,texData:null,isUniform:!0,uniformValues:x.values};e.packedInputs&&(x.isPacked=!0,x.shape=y.shape)}if(this.uploadToGPU(y.dataId),!!x.isPacked!=!!e.packedInputs)y=x.isPacked?this.unpackTensor(y):this.packTensor(y),c.push(y),x=this.texData.get(y.dataId);else if(x.isPacked&&!HA(x.shape,y.shape)){const b=y,_=y.shape;y.shape=x.shape,y=this.packedReshape(y,_),c.push(y),x=this.texData.get(y.dataId),b.shape=_}return{shape:y.shape,texData:x,isUniform:!1}});this.uploadToGPU(o.dataId);const d={shape:o.shape,texData:l,isUniform:!1},h=O3e(e,u,d),f=this.getAndSaveBinary(h,()=>R3e(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let g;p&&(g=this.startTimer()),Me().get("ENGINE_COMPILE_ONLY")||P3e(this.gpgpu,f,u,d,i),c.forEach(y=>this.disposeIntermediateTensorInfo(y)),p&&(g=this.endTimer(g),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(g)}));const m=Me().getNumber("WEBGL_FLUSH_THRESHOLD");if(m>0){const y=Oa();y-this.lastGlFlushTime>m&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!Me().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&s===!1){const y=this.unpackTensor(o);return this.disposeIntermediateTensorInfo(o),y}return o}compileAndRun(e,n,r,i,s=!1){return r=r||n[0].dtype,this.runWebGLProgram(e,n,r,i,s)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(Me().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=ve(()=>{if(!Me().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=Me().getBool("DEBUG");Me().set("DEBUG",!1);const n=this.abs(It(1e-8)).dataSync()[0];if(Me().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?Cze:Nze}uploadToGPU(e){const n=this.texData.get(e),{shape:r,dtype:i,values:s,texture:a,usage:o,isPacked:l}=n;if(a!=null)return;const c=this.activeTimers!=null;let u;c&&(u=Oa());let d=n.texShape;if(d==null&&(d=zLe(r,l),n.texShape=d),s!=null){const h=sN(r);let f,p=d[1],g=d[0];const m=s instanceof Uint8Array||s instanceof Uint8ClampedArray;(l||!m)&&([p,g]=eb(d[0],d[1])),l?f=new z3e(h,m):f=new D7(h,m);const y=m?[g,p]:d,x=this.makeTensorInfo(y,i),b=this.texData.get(x.dataId);m?b.usage=Go.PIXELS:b.usage=Go.UPLOAD,b.texShape=y,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(x.dataId),p,g,s);const _=[[g,p]],E=this.runWebGLProgram(f,[x],i,_,!0),C=this.texData.get(E.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,Me().get("ENGINE_COMPILE_ONLY")?this.disposeData(E.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(E.dataId)),this.disposeIntermediateTensorInfo(x),c&&(this.uploadWaitMs+=Oa()-u)}else{const h=this.acquireTexture(d,o,i,l);n.texture=h}}convertAndCacheOnCPU(e,n){const r=this.texData.get(e),{dtype:i}=r;return n!=null&&(r.values=Rze(n,i)),r.values}acquireTexture(e,n,r,i){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const s=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${s} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,i)}computeBytes(e,n){return e[0]*e[1]*OA(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const r=new Promise(i=>{try{this.checkCompletion_(n),i(!0)}catch(s){throw s}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await Nle(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(Qle(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:r,infLoc:i,nanLoc:s,outShapeLocation:a,outShapeStridesLocation:o,outTexShapeLocation:l}=rce(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=r,e.infLoc=i,e.nanLoc=s,e.outShapeLocation=a,e.outShapeStridesLocation=o,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,r){e.channels=e.channels||"RGBA";const{texture:i,height:s,width:a,channels:o}=e,l=Fo().backend;if(!l.gpgpu.gl.isTexture(i))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(i,n,r,s,a,o);return Fo().makeTensorFromDataId(c,n,r,l)}}UR.nextDataId=0;function Rze(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let r=0;r<n.length;++r)n[r]=Math.round(t[r]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Dae()&&Fae("webgl",()=>new UR,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Ng{constructor(e,n,r){this.variableNames=["A","B"],this.outputShape=dn(n,r),this.enableShapeUniforms=Xs(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ty=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class sb{constructor(e,n,r,i=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=dn(n,r);const s=this.outputShape.length;this.enableShapeUniforms=Xs(s);let a="";if(i)if(s===0||Oe(this.outputShape)===1)a=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(a=`
          ${gr(s)} coords = getOutputCoords();
        `,s===1)this.enableShapeUniforms?a+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:a+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=fa("coords",s);this.enableShapeUniforms?a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= outShape[${s} - 2];
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= outShape[${s} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:a+=`
            bool nextRowOutOfBounds =
              (${l[s-2]} + 1) >= ${this.outputShape[s-2]};
            bool nextColOutOfBounds =
              (${l[s-1]} + 1) >= ${this.outputShape[s-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${a}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function So(t){const{inputs:e,backend:n}=t,{x:r}=e;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const Pze={kernelName:lT,backendName:"webgl",kernelFunc:So};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bp(t){const{inputs:e,backend:n}=t,{real:r,imag:i}=e,s=n.makeTensorInfo(r.shape,"complex64"),a=n.texData.get(s.dataId),o=So({inputs:{x:r},backend:n}),l=So({inputs:{x:i},backend:n});return a.complexTensorInfos={real:o,imag:l},s}const Oze={kernelName:QU,backendName:"webgl",kernelFunc:bp};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue="return (a < 0.) ? b * a : a;",cue=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Dze(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:s}=r,a=n.makeTensorInfo([],"float32",hp(s,"float32")),o=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sb(cue,i.shape,a.shape):new Ng(lue,i.shape,a.shape),l=n.runWebGLProgram(o,[i,a],"float32");return n.disposeIntermediateTensorInfo(a),l}const $ze={kernelName:RM,backendName:"webgl",kernelFunc:Dze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uue="return (a < 0.) ? b * a : a;",due=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function Lze(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sb(due,r.shape,i.shape):new Ng(uue,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],"float32")}const Fze={kernelName:ZM,backendName:"webgl",kernelFunc:Lze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ab="if (isnan(x)) return x;";function Wn({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:r}){return({inputs:i,backend:s})=>{const{x:a}=i,o=s,l=r||a.dtype;if(o.shouldExecuteOnCPU([a])&&n!=null){const d=o.texData.get(a.dataId),h=n(d.values,l);return o.makeTensorInfo(a.shape,l,h)}const c=Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new gf(a.shape,e):u=new Nu(a.shape,t),o.runWebGLProgram(u,[a],l)}}function Rs({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:r=!1,cpuKernelImpl:i,dtype:s}){return({inputs:a,backend:o})=>{const{a:l,b:c}=a,u=o;if(r&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),g=u.texData.get(c.dataId),[m,y]=[[p.complexTensorInfos.real,g.complexTensorInfos.real],[p.complexTensorInfos.imag,g.complexTensorInfos.imag]].map(b=>{const[_,T]=b,E={dataId:_.dataId,dtype:_.dtype,shape:l.shape},C={dataId:T.dataId,dtype:T.dtype,shape:c.shape},I=new Ng(t,l.shape,c.shape);return u.runWebGLProgram(I,[E,C],bo(_.dtype,T.dtype))}),x=bp({inputs:{real:m,imag:y},backend:u});return u.disposeIntermediateTensorInfo(m),u.disposeIntermediateTensorInfo(y),x}const d=s||bo(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&i!=null){const p=u.texData.get(l.dataId).values,g=u.texData.get(c.dataId).values,m=l.dtype==="string"?sh(p):p,y=l.dtype==="string"?sh(g):g,[x,b]=i(l.shape,c.shape,m,y,d),_=u.makeTensorInfo(b,d),T=u.texData.get(_.dataId);return T.values=x,_}const h=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new sb(e,l.shape,c.shape,n):f=new Ng(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function nS(t,e=!1){if(t==="linear")return e?xze:pze;if(t==="relu")return e?wze:gze;if(t==="elu")return e?bze:mze;if(t==="relu6")return e?Sze:yze;if(t==="prelu")return e?due:uue;if(t==="leakyrelu")return e?cue:lue;if(t==="sigmoid")return e?_ze:vze;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hue{constructor(e,n,r,i=!1,s=!1,a=!1,o=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Xs(this.outputShape.length);const u=i?e[1]:e[2],d=Math.ceil(u/2),h=i?"i * 2, rc.y":"rc.y, i * 2",f=s?"rc.z, i * 2":"i * 2, rc.z",p=i?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],g=s?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let m="",y="";o&&(l?m=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${o}
        }`:c?m=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${o}
        }`:m=`vec4 activation(vec4 x) {
          ${o}
        }`,y="result = activation(result);");const x=a?"result += getBiasAtOutCoords();":"";a&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",_="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(_=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${m}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${_};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${g[0]});
          result += (${p[1]} * ${g[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${x}

        ${y}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W7={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class H7{constructor(e,n,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=dn(n,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G7="return a * b;";function M5(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,s=bo(r.dtype,i.dtype);if(r.dtype==="complex64"){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),c=new H7(W7.REAL,r.shape,i.shape),u=new H7(W7.IMAG,r.shape,i.shape),d=[{dataId:o.complexTensorInfos.real.dataId,dtype:o.complexTensorInfos.real.dtype,shape:r.shape},{dataId:o.complexTensorInfos.imag.dataId,dtype:o.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=bp({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([r,i])){const o=n.texData.get(r.dataId),l=n.texData.get(i.dataId),[c,u]=Lje(r.shape,i.shape,o.values,l.values,s),d=n.makeTensorInfo(u,s),h=n.texData.get(d.dataId);return h.values=c,d}let a;return Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?a=new sb(G7,r.shape,i.shape):a=new Ng(G7,r.shape,i.shape),n.runWebGLProgram(a,[r,i],s)}const jze={kernelName:yT,backendName:"webgl",kernelFunc:M5};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zze(t,e,n){const r=[Yx(t.shape),...Zx(t.shape)],i={dtype:t.dtype,shape:r,dataId:t.dataId},s=[Yx(e),...Zx(e)],a=new oue(s,r),o=!0,l=[r],c=n.runWebGLProgram(a,[i],t.dtype,l,o);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function st(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:s}=r,a=n,o=Oe(i.shape),l=uae(s,o),c=Oe(l);q(o===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${i.shape}) has ${o} elements. The new shape and old shape must have the same number of elements.`);const u=a.texData.get(i.dataId);return u.isPacked&&!HA(i.shape,l)&&!(u.texture!==null&&HA(u.shape,l))?zze(i,l,a):(a.incRef(i.dataId),{dataId:i.dataId,shape:l,dtype:i.dtype})}const Bze={kernelName:JM,backendName:"webgl",kernelFunc:st};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q7{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=e;this.outputShape=[i,a];const o=Math.floor(r/4)*4,l=r%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${Wx(d)?d.toPrecision(2):d}, ones);`}let u="";s%r>0&&(u=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${o}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${o};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uze{constructor(e,n){this.variableNames=["x"];const{windowSize:r,batchSize:i,inSize:s,outSize:a}=e;this.outputShape=[i,a];let o="0.0",l="";n==="prod"?o="1.0":n==="min"?(o="1.0 / 1e-20",l="min"):n==="max"&&(o="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(r/4)*4,d=r%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(o="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(o="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${o};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${o});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vze(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],r=LR(n);e.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return e}function ny(t,e,n,r){const i=Vze(t.shape);let s=t;for(let a=0;a<i.length;a++){const{inSize:o,windowSize:l,outSize:c}=i[a];let u,d;n==="mean"?u=a===0?new q7({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c},o):new q7({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c}):u=new Uze({windowSize:l,inSize:o,batchSize:t.shape[0],outSize:c},n),d=s,s=r.runWebGLProgram(u,[s],e),d.dataId!==t.dataId&&r.disposeIntermediateTensorInfo(d)}return s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wze{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[n[a]];this.outputShape=r,this.rank=r.length;const i=gr(this.rank),s=Hze(n);this.userCode=`
    void main() {
      ${i} resRC = getOutputCoords();
      setOutput(getA(${s}));
    }
    `}}function Hze(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let i=0;i<t.length;i++)r[t[i]]=n[i];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gze{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let u=0;u<r.length;u++)r[u]=e[n[u]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const i=gr(this.rank),s=aue("rc",this.rank),a=new Array(this.rank);for(let u=0;u<n.length;u++)a[n[u]]=s[u];const o=`vec2(${a.slice(-2).join()})`,l=`++${s[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${a.join()}), ${o})`;this.userCode=`
    void main() {
      ${i} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${s[this.rank-1]};
      if(++${s[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VR(t,e,n){const r=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Gze(t.shape,e):new Wze(t.shape,e);return n.runWebGLProgram(r,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qze(t,e,n,r){const i=e,s=t.shape.length,a=Nn(i,t.shape);let o=a;const l=Jr(o,s),c=l!=null;let u=t;c&&(u=VR(t,l,r),o=wi(o.length,s)),Ms("sum",o,s);const[d,h]=fs(u.shape,o);let f=d;n&&(f=bi(d,a));const p=Oe(h),m=Oe(t.shape)/p,y=st({inputs:{x:u},attrs:{shape:[m,p]},backend:r}),x=ZV(t.dtype),b=ny(y,x,"sum",r),_=st({inputs:{x:b},attrs:{shape:f},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),c&&r.disposeIntermediateTensorInfo(u),_}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WR(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;return qze(i,s,a,n)}const Xze={kernelName:sR,backendName:"webgl",kernelFunc:WR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xa(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{perm:s}=r,a=n,o=i.shape.length,l=new Array(o);for(let u=0;u<l.length;u++)l[u]=i.shape[s[u]];let c;if(a.shouldExecuteOnCPU([i])){const d=a.texData.get(i.dataId).values,h=I5(d,i.shape,i.dtype,s,l);c=a.makeTensorInfo(l,i.dtype);const f=a.texData.get(c.dataId);f.values=h}else c=VR(i,s,a);return c}const Kze={kernelName:nx,backendName:"webgl",kernelFunc:xa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fue=1e3;function XA({a:t,b:e,transposeA:n,transposeB:r,backend:i,bias:s=null,preluActivationWeights:a=null,leakyreluAlpha:o=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=r?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=r?e.shape[u-2]:e.shape[u-1],g=t.shape.slice(0,-2),m=e.shape.slice(0,-2),y=Oe(g),x=Oe(m),_=dn(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);q(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${r} must match.`);const T=n?[y,d,f]:[y,f,d],E=r?[x,p,h]:[x,h,p],C=st({inputs:{x:t},backend:i,attrs:{shape:T}}),I=st({inputs:{x:e},backend:i,attrs:{shape:E}}),A=[C,I],k=Math.max(y,x),R=n?C.shape[1]:C.shape[2],$=s!=null,z=a!=null,O=l==="leakyrelu",j=l!=null?nS(l,!0):null,B=$||z||O||j!=null;let W;if((f===1||p===1)&&R>fue&&B===!1){let V=C,H=I;n&&(V=xa({inputs:{x:C},backend:i,attrs:{perm:[0,2,1]}}),A.push(V)),r&&(H=xa({inputs:{x:I},backend:i,attrs:{perm:[0,2,1]}}),A.push(H));const K=p!==1,te=p===1;let J=V;K&&(J=st({inputs:{x:V},backend:i,attrs:{shape:[k,R,1]}}),A.push(J));const oe=p===1?2:1;let fe=H;te&&(fe=st({inputs:{x:H},backend:i,attrs:{shape:[k,1,R]}}),A.push(fe));const Ee=M5({inputs:{a:J,b:fe},backend:i});W=WR({inputs:{x:Ee},backend:i,attrs:{axis:oe,keepDims:!0}}),A.push(Ee)}else{const V=bo(t.dtype,e.dtype),H=new hue(T,E,[k,f,p],n,r,$,j,z,O),K=[C,I];if(s!=null&&K.push(s),z&&K.push(a),O){const te=i.makeTensorInfo([],"float32",hp(o,"float32"));K.push(te),A.push(te)}W=i.runWebGLProgram(H,K,V)}const L=st({inputs:{x:W},backend:i,attrs:{shape:_}});A.push(W);for(const V of A)i.disposeIntermediateTensorInfo(V);return L}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yze(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:s,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;return XA({a:i,b:s,transposeA:l,transposeB:c,backend:n,bias:a,preluActivationWeights:o,leakyreluAlpha:d,activation:u})}const Zze={kernelName:DA,backendName:"webgl",kernelFunc:Yze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X7="return abs(x);";function Qze(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const s=n.texData.get(r.dataId),a=iue(s.values);return n.makeTensorInfo(r.shape,r.dtype,a)}let i;return Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new gf(r.shape,X7):i=new Nu(r.shape,X7),n.runWebGLProgram(i,[r],r.dtype)}const Jze={kernelName:uM,backendName:"webgl",kernelFunc:Qze};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e4e=Ql+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,t4e=Wn({opSnippet:e4e}),n4e={kernelName:U_,backendName:"webgl",kernelFunc:t4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r4e=Ql+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,i4e=Wn({opSnippet:r4e}),s4e={kernelName:V_,backendName:"webgl",kernelFunc:i4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K7="return a + b;",a4e=Rs({opSnippet:K7,packedOpSnippet:K7,supportsComplex:!0,cpuKernelImpl:gje}),o4e={kernelName:X0,backendName:"webgl",kernelFunc:a4e};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l4e{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`float v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class c4e{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((s,a)=>`T${a}`);const r=[];this.variableNames.forEach(s=>{r.push(`vec4 v${s} = get${s}AtOutCoords();`)});const i=this.variableNames.map(s=>`v${s}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${i};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2(t){const{inputs:e,backend:n}=t,r=e;if(r.length===1)return So({inputs:{x:r[0]},backend:n});if(r.length>Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(r.length/2),c=U2({inputs:r.slice(0,l),backend:n}),u=U2({inputs:r.slice(l),backend:n});return U2({inputs:[c,u],backend:n})}const i=r.map(l=>l.dtype).reduce((l,c)=>bo(l,c)),s=r.map(l=>l.shape),o=Me().getBool("WEBGL_PACK")?new c4e(r[0].shape,s):new l4e(r[0].shape,s);return n.runWebGLProgram(o,r,i)}const u4e={kernelName:dM,backendName:"webgl",kernelFunc:U2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r,o=i.shape.length,l=Nn(s,i.shape);let c=l;const u=Jr(c,o);let d=i;u!=null&&(d=xa({inputs:{x:i},backend:n,attrs:{perm:u}}),c=wi(c.length,o)),Ms("all",c,o);const[h,f]=fs(d.shape,c),p=Oe(f),g=st({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),m=ny(g,g.dtype,"all",n);let y;if(a){const x=bi(h,l);y=st({inputs:{x:m},backend:n,attrs:{shape:x}})}else y=st({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(d),y}const h4e={kernelName:GU,backendName:"webgl",kernelFunc:d4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r,o=i.shape.length,l=Nn(s,i.shape);let c=l;const u=Jr(c,o);let d=i;u!=null&&(d=xa({inputs:{x:i},backend:n,attrs:{perm:u}}),c=wi(c.length,o)),Ms("any",c,o);const[h,f]=fs(d.shape,c),p=Oe(f),g=st({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),m=ny(g,g.dtype,"any",n);let y;if(a){const x=bi(h,l);y=st({inputs:{x:m},backend:n,attrs:{shape:x}})}else y=st({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(d),y}const p4e={kernelName:qU,backendName:"webgl",kernelFunc:f4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class m4e{constructor(e,n,r){this.variableNames=["A"];const{windowSize:i,batchSize:s,outSize:a}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[s,a];const o=n==="max"?">":"<",l=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${i};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${i}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${o} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g4e{constructor(e,n,r,i){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,q(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const s=e[e.length-1],a=Math.ceil(s/n);this.outputShape=e.slice(0,-1),a>1&&this.outputShape.push(a),i||this.variableNames.push("bestIndicesA");const o=this.outputShape,l=o.length,c=gr(l),u=fa("coords",l);let d,h;if(a===1){h=l+1;const I=gr(h);d=`
        ${I} sourceLocR = ${I}(${u.join()}, 0);
        ++${u[l-1]};
        ${I} sourceLocG = ${I}(${u.join()}, 0);
        ++${u[l-2]};
        ${I} sourceLocA = ${I}(${u.join()}, 0);
        --${u[l-1]};
        ${I} sourceLocB = ${I}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],g=f.map(I=>"int "+I),m=fa("sourceLocR",h-1).concat("inIdx.r"),y=fa("sourceLocG",h-1).concat("inIdx.g"),x=fa("sourceLocB",h-1).concat("inIdx.b"),b=fa("sourceLocA",h-1).concat("inIdx.a"),_=r==="max"?"greaterThan":"lessThan",T=i?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${m.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${b.join()})));`,E=`vec4(
            getAChannel(${m.join()}),
            hasNextCol ? getAChannel(${y.join()}) : 0.,
            hasNextRow ? getAChannel(${x.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,C=i?"":`
      float getBestIndicesAChannel(${g.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${g.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${o[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${o[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${E};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${T}
          vec4 candidate = ${E};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${_}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pue(t,e,n,r=null){let i=e.shape[0],s=e.shape[1];r!=null&&(i=r.shape[0],s=r.shape[1]);const a=LR(s),o={windowSize:a,inSize:s,batchSize:i,outSize:Math.ceil(s/a)},l=new m4e(o,n,r==null),c=[e];r!=null&&c.push(r);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=pue(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function mue(t,e,n,r=null){const i=r!=null?r.shape:e.shape,s=i[i.length-1],a=LR(s),o=new g4e(i,a,n,r==null),l=r==null?[e]:[e,r],c=t.runWebGLProgram(o,l,"int32");if(c.shape.length===e.shape.length){const u=mue(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function gue(t,e,n,r){const i=[n];if(Ms("arg"+r.charAt(0).toUpperCase()+r.slice(1),i,e.shape.length),!Me().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const s=[],a=t.texData.get(e.dataId),o=a!==null&&a.isPacked;let l=e;o&&(l=t.unpackTensor(e),s.push(l));const[c,u]=fs(l.shape,i),d=Oe(u),h=st({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});s.push(h);const f=pue(t,h,r);s.push(f);const p=st({inputs:{x:f},backend:t,attrs:{shape:c}});return s.forEach(g=>t.disposeIntermediateTensorInfo(g)),p}return mue(t,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s}=r;let a=Nn(s,i.shape);const o=Jr(a,i.shape.length);let l=i;const c=[];o!=null&&(l=xa({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),a=wi(a.length,l.shape.length)),Ms("argMax",[a[0]],l.shape.length);const u=gue(n,l,a[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const v4e={kernelName:hM,backendName:"webgl",kernelFunc:y4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s}=r;let a=Nn(s,i.shape);const o=Jr(a,i.shape.length);let l=i;const c=[];o!=null&&(l=xa({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),a=wi(a.length,l.shape.length)),Ms("argMin",[a[0]],l.shape.length);const u=gue(n,l,a[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const b4e={kernelName:fM,backendName:"webgl",kernelFunc:x4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w4e=Ql+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,S4e=Wn({opSnippet:w4e}),_4e={kernelName:W_,backendName:"webgl",kernelFunc:S4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T4e=Ql+"return log(x + sqrt(x * x + 1.0));",E4e=Wn({opSnippet:T4e}),C4e={kernelName:H_,backendName:"webgl",kernelFunc:E4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N4e=Ql+`
  return atan(x);
`,A4e=Wn({opSnippet:N4e}),I4e={kernelName:G_,backendName:"webgl",kernelFunc:A4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k4e=k5+`
  return atan(a, b);
`,M4e=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ty+`
  return result;
`,R4e=Rs({opSnippet:k4e,packedOpSnippet:M4e}),P4e={kernelName:X_,backendName:"webgl",kernelFunc:R4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O4e=Ql+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,D4e=Wn({opSnippet:O4e}),$4e={kernelName:q_,backendName:"webgl",kernelFunc:D4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rS{constructor(e,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const g=n==="avg",m=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,y=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let x="0.0";if(g||(x="-1.0 / 1e-20"),r){const I=">=";this.userCode=`
        const ivec2 strides = ivec2(${o}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${I} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${i?s?m:y:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let _=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(_="avgValue / max(count, 1.0)");const T=Math.floor(a/4)*4,E=a%4,C=`
      if (${g}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${x};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${x});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${T}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${T};
          if (${E===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${E===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${E===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${_});
      }
    `}}class R5{constructor(e,n,r,i=!1,s=!1){if(this.variableNames=["x"],n==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const a=e.filterWidth,o=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,g=e.effectiveFilterWidth,m=e.padInfo.front,y=e.padInfo.top,x=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let _="0.0";if(b||(_="-1.0 / 1e-20"),r){const k=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${o}, ${l}, ${c});
        const ivec3 pads = ivec3(${m}, ${y}, ${x});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${g};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${k} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${i?s?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${g} +
                      wR * ${g} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const T="max";let E=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(E="avgValue / max(count, 1.0)");const C=Math.floor(a/4)*4,I=a%4,A=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${T}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${o}, ${l}, ${c});
      const ivec3 pads = ivec3(${m}, ${y}, ${x});
      const float initializationValue = ${_};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${_});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${A}
            }

            int xC = xCCorner + ${C};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${A}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${A}
            }
          }
        }
        setOutput(${E});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;KT(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,c=1;q(ks(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Zl(i.shape,s,a,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&Pn(u.inShape,u.outShape))return So({inputs:{x:i},backend:n});const d=new rS(u,"avg",!1);return n.runWebGLProgram(d,[i],"float32")}const F4e={kernelName:pM,backendName:"webgl",kernelFunc:L4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j4e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r,u=[1,1,1],d=gh(i.shape,s,a,u,o,l,c),h=new R5(d,"avg",!1);return n.runWebGLProgram(h,[i],"float32")}const z4e={kernelName:mM,backendName:"webgl",kernelFunc:j4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class B4e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,i=e.strideHeight,s=e.strideWidth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*r);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${a}) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${o}) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class U4e{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,i=e.filterWidth,s=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,g=h-1-e.padInfo.top,m=f-1-e.padInfo.left,y=1/(n*r*i);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${g}, ${m});
      const float avgMultiplier = float(${y});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${s}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,a=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=gh(a.shape,o,l,d,c,u),f=new U4e(h);return n.runWebGLProgram(f,[i],a.dtype)}const W4e={kernelName:KU,backendName:"webgl",kernelFunc:V4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H4e(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,a=s;KT([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,u=Zl(a.shape,o,l,1,c),d=new B4e(u);return n.runWebGLProgram(d,[i],a.dtype)}const G4e={kernelName:XU,backendName:"webgl",kernelFunc:H4e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q4e(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:s}=e,{transposeA:a,transposeB:o}=r;return XA({a:i,b:s,transposeA:a,transposeB:o,backend:n})}const X4e={kernelName:gM,backendName:"webgl",kernelFunc:q4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K4e{constructor(e,n,r,i,s,a){this.outputShape=[],this.variableNames=["x","mean","variance"],dn(e,n),dn(e,r);let o="0.0";i!=null&&(dn(e,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="1.0";s!=null&&(dn(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${o};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${a}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Y4e{constructor(e,n,r,i,s,a){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],dn(e,n),dn(e,r);let o="vec4(0.0)";i!=null&&(dn(e,i),this.variableNames.push("offset"),o="getOffsetAtOutCoords()");let l="vec4(1.0)";s!=null&&(dn(e,s),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${o};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${a}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z4e=({inputs:t,backend:e,attrs:n})=>{const{x:r,mean:i,variance:s,offset:a,scale:o}=t;q(i.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),q(a==null||i.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),q(o==null||i.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[r,i,s];let u=null;a!=null&&(u=a.shape,c.push(a));let d=null;o!=null&&(d=o.shape,c.push(o));const h=Me().getBool("WEBGL_PACK_NORMALIZATION")?new Y4e(r.shape,i.shape,s.shape,u,d,l):new K4e(r.shape,i.shape,s.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},Q4e={kernelName:IM,backendName:"webgl",kernelFunc:Z4e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class J4e{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=gr(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=eBe(this.rank);let i;const s=e.map((a,o)=>`sourceLoc.${pj[o]} = start[${o}] + coords.${pj[o]};`);i=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${s.join(`
`)}
      `,this.userCode=`
      void main() {
        ${i}
        setOutput(getSource(${r}));
      }
    `}}const pj=["x","y","z","w","u","v"];function eBe(t){if(t===1)return"sourceLoc";if(t<=6)return pj.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tBe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=gr(this.rank),r=fa("coords",this.rank),i=fa("sourceLoc",this.rank),s=this.rank===1?"sourceLoc":`vec2(${i.slice(-2).join()})`,a=`getChannel(getSource(${i.join()}), ${s})`,o=`
      result.x = ${a};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${i[this.rank-1]};
        result.y = ${a};
        --${i[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${i[this.rank-2]};
        result.z = ${a};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${i[this.rank-1]};
          result.w = ${a};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${i[d]} = ${r[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${o}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nBe(t,e,n,r){const i=r.texData.get(t.dataId),s=r.makeTensorInfo(n,t.dtype),a=r.texData.get(s.dataId);Object.assign(a,i),a.refCount=1,a.shape=n,a.dtype=t.dtype;let o=QW(e,Ft(t.shape));i.slice&&(o+=i.slice.flatOffset),a.slice={flatOffset:o,origDataId:i.slice&&i.slice.origDataId||t.dataId};const l=r.dataRefCount.get(a.slice.origDataId)||1;return r.dataRefCount.set(a.slice.origDataId,l+1),s}function ob(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:s,size:a}=r,[o,l]=$R(i,s,a);if(KW(i,o,l),Oe(l)===0)return n.makeTensorInfo(l,i.dtype,[]);if(n.shouldExecuteOnCPU([i])||i.dtype==="string"){const d=n.texData.get(i.dataId),h=Xje(d.values,o,l,i.shape,i.dtype);return n.makeTensorInfo(l,i.dtype,h)}const{isPacked:c}=n.texData.get(i.dataId),u=ZW(i.shape,o,l);if(c||!u){const d=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tBe(l):new J4e(l),h=[o];return n.runWebGLProgram(d,[i],i.dtype,h)}return n.uploadToGPU(i.dataId),nBe(i,o,l,n)}const rBe={kernelName:iR,backendName:"webgl",kernelFunc:ob};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iBe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:s,crops:a}=r;q(i.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((x,b)=>x*b),l=HT(i.shape,s,o),c=GT(l.length,s.length),u=qT(i.shape,s,o),d=r5(a,s.length),h=i5(u,a,s.length),f=[],p=st({inputs:{x:i},backend:n,attrs:{shape:l}}),g=xa({inputs:{x:p},backend:n,attrs:{perm:c}}),m=st({inputs:{x:g},backend:n,attrs:{shape:u}}),y=ob({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(g),f.push(m),f.forEach(x=>n.disposeIntermediateTensorInfo(x)),y},sBe={kernelName:yM,backendName:"webgl",kernelFunc:iBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:s}=e,{size:a}=r,o=n.readSync(i.dataId),l=n.readSync(s.dataId),c=rue(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}const oBe={kernelName:YU,backendName:"webgl",kernelFunc:aBe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lBe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,cBe=`
  return float(int(a.r) & int(b.r));
`;function uBe(t){const{inputs:e,backend:n}=t,{a:r,b:i}=e,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS"),a=Me().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([r,i])||a===1){const l=n.texData.get(r.dataId).values,c=n.texData.get(i.dataId).values,[u,d]=vje(r.shape,i.shape,l,c,r.dtype),h=n.makeTensorInfo(d,r.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let o;return s?o=new sb(lBe,r.shape,i.shape,!1):o=new Ng(cBe,r.shape,i.shape),n.runWebGLProgram(o,[r,i],r.dtype)}const dBe={kernelName:vM,backendName:"webgl",kernelFunc:uBe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hBe(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,s=n.readSync(r.dataId),a=n.readSync(i.dataId),o=dn(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const fBe={kernelName:ZU,backendName:"webgl",kernelFunc:hBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pBe="return float(a != b);",yue=Rs({opSnippet:pBe,cpuKernelImpl:jje,dtype:"bool"}),mBe={kernelName:GM,backendName:"webgl",kernelFunc:yue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZT(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.texData.get(r.dataId);return So({inputs:{x:i.complexTensorInfos.real},backend:n})}const gBe={kernelName:kV,backendName:"webgl",kernelFunc:ZT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yBe="return float(int(x));";function vBe(t,e){const n=new Nu(t.shape,yBe),r=e.runWebGLProgram(n,[t],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dtype:s}=r;if(s==="complex64"){if(i.dtype==="complex64")return So({inputs:{x:i},backend:n});const a=Pi(i.shape),o=mj({inputs:{x:i},backend:n,attrs:{dtype:"float32"}}),l=bp({inputs:{real:o,imag:a},backend:n});return a.dispose(),n.disposeIntermediateTensorInfo(o),l}if(i.dtype==="complex64"){const a=ZT({inputs:{input:i},backend:n}),o=mj({inputs:{x:a},backend:n,attrs:{dtype:s}});return n.disposeIntermediateTensorInfo(a),o}if(!dae(i.dtype,s)){const a=So({inputs:{x:i},backend:n});return{dataId:a.dataId,shape:a.shape,dtype:s}}if(n.shouldExecuteOnCPU([i])){const a=n.texData.get(i.dataId).values,[o,l,c]=xje(a,i.shape,i.dtype,s);return n.makeTensorInfo(o,l,c)}if(s==="int32")return vBe(i,n);if(s==="bool"){const a=n.makeTensorInfo([],"bool",As("bool",1)),l=yue({inputs:{a:i,b:a},backend:n});return n.disposeIntermediateTensorInfo(a),l}throw new Error(`Error in Cast: failed to cast ${i.dtype} to ${s}`)}const xBe={kernelName:K_,backendName:"webgl",kernelFunc:mj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7="return ceil(x);",bBe=Wn({opSnippet:Y7,packedOpSnippet:Y7,cpuKernelImpl:bje}),wBe={kernelName:Y_,backendName:"webgl",kernelFunc:bBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SBe{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _Be{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{clipValueMin:s,clipValueMax:a}=r;let o;Me().getBool("WEBGL_PACK_CLIP")?o=new _Be(i.shape):o=new SBe(i.shape);const l=[[s],[a]];return n.runWebGLProgram(o,[i],i.dtype,l)}const EBe={kernelName:Z_,backendName:"webgl",kernelFunc:TBe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CBe{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function NBe(t){const{inputs:e,backend:n}=t,{x:r}=e,i=n.texData.get(r.dataId),s=new CBe(r.shape),a=[Z7(r,i.complexTensorInfos.real),Z7(r,i.complexTensorInfos.imag)];return n.runWebGLProgram(s,a,a[0].dtype)}const ABe={kernelName:xM,backendName:"webgl",kernelFunc:NBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IBe{constructor(e){this.outputShape=[],this.outputShape=Du(e,1),this.variableNames=e.map((a,o)=>`T${o}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let a=1;a<n.length;a++)n[a]=n[a-1]+e[a][1];const r=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let a=1;a<n.length;a++){const o=n[a-1];r.push(`else if (yC < ${n[a]}) setOutput(getT${a}(yR, yC-${o}));`)}const i=n.length,s=n[n.length-1];r.push(`else setOutput(getT${i}(yR, yC-${s}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kBe{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Du(e,n);const r=this.outputShape,i=r.length,s=gr(i),a=fa("coords",i),o=["x","y","z","w","u","v"].slice(0,i);this.variableNames=e.map((g,m)=>`T${m}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let g=1;g<l.length;g++)l[g]=l[g-1]+e[g][n];const c=o[n],u=o.slice(-2),d=o.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let g=1;g<l.length;g++){const m=l[g-1];h+=`
        if (${c} < ${l[g]}  && ${c} >= ${l[g-1]}) {
          return getChannel(
            getT${g}(${lN(o,c,m)}),
            vec2(${lN(u,c,m)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${lN(o,c,p)}),
          vec2(${lN(u,c,p)}));`,this.userCode=`
      float getValue(${o.map(g=>"int "+g)}) {
        ${h}
      }

      void main() {
        ${s} coords = getOutputCoords();
        vec4 result = vec4(getValue(${a}), 0., 0., 0.);

        ${a[i-1]} = ${a[i-1]} + 1;
        if (${a[i-1]} < ${r[i-1]}) {
          result.g = getValue(${a});
        }

        ${a[i-2]} = ${a[i-2]} + 1;
        if (${a[i-2]} < ${r[i-2]}) {
          result.a = getValue(${a});
        }

        ${a[i-1]} = ${a[i-1]} - 1;
        if (${a[i-2]} < ${r[i-2]} &&
            ${a[i-1]} < ${r[i-1]}) {
          result.b = getValue(${a});
        }
        setOutput(result);
      }
    `}}function lN(t,e,n){const r=t.indexOf(e);return t.map((s,a)=>a===r?`${s} - ${n}`:s).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HR(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.texData.get(r.dataId);return So({inputs:{x:i.complexTensorInfos.imag},backend:n})}const MBe={kernelName:gV,backendName:"webgl",kernelFunc:HR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hw(t,e,n){const r=t[0].dtype;if(r==="complex64"){const f=t.map(x=>ZT({inputs:{input:x},backend:n})),p=t.map(x=>HR({inputs:{input:x},backend:n})),g=Hw(f,e,n),m=Hw(p,e,n),y=bp({inputs:{real:g,imag:m},backend:n});return f.forEach(x=>n.disposeIntermediateTensorInfo(x)),p.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}let i=n.shouldExecuteOnCPU(t);if(r==="string"&&(i=!0),i){const f=t.map(_=>{const E=[-1,Oe(_.shape.slice(e))];return st({inputs:{x:_},backend:n,attrs:{shape:E}})}),p=f.map(_=>({vals:n.readSync(_.dataId),shape:_.shape})),g=Du(f.map(_=>_.shape),1),m=f[0].shape[0]===1,y=wje(p,g,r,m),x=Du(t.map(_=>_.shape),e),b=n.makeTensorInfo(x,r,y);return f.forEach(_=>n.disposeIntermediateTensorInfo(_)),b}const s=t.filter(f=>Oe(f.shape)>0),a=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&s[0].shape.length>1;if(s.length===1){const f=a?new Nu(t[0].shape,Yh):new gf(t[0].shape,Yh);return n.runWebGLProgram(f,t,r)}const o=Me().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(s.length>o){const f=[];for(let g=0;g<s.length;g+=o){const m=s.slice(g,g+o);f.push(Hw(m,e,n))}const p=Hw(f,e,n);for(const g of f)n.disposeIntermediateTensorInfo(g);return p}if(a){const f=new kBe(s.map(p=>p.shape),e);return n.runWebGLProgram(f,s,r)}const{tensors2D:l,outShape:c}=RBe(s,e,n),u=new IBe(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,r);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=st({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function RBe(t,e,n){const r=Du(t.map(s=>s.shape),e);return{tensors2D:t.map(s=>st({inputs:{x:s},attrs:{shape:[-1,Oe(s.shape.slice(e))]},backend:n})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vue(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,s=Nn(i,e[0].shape)[0],a=e.map(c=>c.shape);e5(a,s);const o=Du(e.map(c=>c.shape),s);if(Oe(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(c=>Oe(c.shape)>0);return l.length===1?So({inputs:{x:l[0]},backend:n}):Hw(l,s,n)}const PBe={kernelName:bM,backendName:"webgl",kernelFunc:vue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xue{constructor(e,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const a=e.padInfo.top,o=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4,m=e.dataFormat==="channelsLast",y=m?1:2,x=m?2:3,b=m?3:1;let _="",T="";r&&(i?_=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?_=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:_=`
          float activation(float x) {
            ${r}
          }
        `,T="result = activation(result);");const E=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${_}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${y}], coords[${x}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${m}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${g===1}) {

              if (${m}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${g===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${m}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${g===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${m}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${E}
        ${T}
        setOutput(result);
      }
    `}}class OBe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,r=e.padInfo.top,i=e.padInfo.left,s=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,g=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${s}, ${a}, ${o});
      const ivec3 pads = ivec3(${n}, ${r}, ${i});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${g===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${g===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${g===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=e.padInfo.left,o=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let m=0;m<u;m++)h+=`
           vec4 xTexelC${m*2};
           int xTexelC${m*2}Ready;
           vec4 xTexelC${m*2+1};
           int xTexelC${m*2+1}Ready;
           vec4 xC${m};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let m=0;m<u;m++)h+=`
           xTexelC${m*2} = vec4(0.0);
           xTexelC${m*2}Ready = 0;
           xTexelC${m*2+1} = vec4(0.0);
           xTexelC${m*2+1}Ready = 0;
           xC${m} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let m=0;m<(d+1)/2;m++){const y=m*2;if(h+=`
           xC = xCCorner + ${y*l};
           `,o===1){if(y<u&&(a%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }
               `,l===1&&y>0?h+=`
                 xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                   } else {
                     xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xC${y} = xTexelC${y};
                 `,y+1<u)){const x=a%2===0?VU(l):l;l%2===0&&a%2===1||l%2!==0&&a%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${x};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                     xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${y+1}.zw = vec2(0.0);
                     }
                     xTexelC${y+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                     } else {
                      xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                     }
                     `:h+=`
                     xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                     `):x===1?h+=`
                     xC${y+1} = xTexelC${y};
                     `:h+=`
                     xCOffset = xC + ${x};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                       xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${y+1}.zw = vec2(0.0);
                       }
                       xTexelC${y+1}Ready = 1;
                     }

                     xC${y+1} = xTexelC${y+1};
                     `}}else y<u&&(a%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.0);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
               `,y+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                   xTexelC${y} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${y}.zw = vec2(0.0);
                   }
                   xTexelC${y}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                   xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${y+1}.zw = vec2(0.);
                   }
                   xTexelC${y+1}Ready = 1;
                 }

                 xC${y} = vec4(
                   xTexelC${y}.xy, xTexelC${y+1}.xy);
               `,y+1<u&&(h+=`
                   xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                 `)));y<u&&(h+=`
             wTexel = getW(r, ${y}, d1, d2);
             dotProd += xC${y}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${y}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,y+1<u&&(h+=`
               wTexel = getW(r, ${y+1}, d1, d2);
               dotProd += xC${y+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${y+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";r&&(i?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:s?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:f=`vec4 activation(vec4 x) {
           ${r}
         }`,p="result = activation(result);");const g=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${g}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DBe{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Xs(this.outputShape.length);const{dataFormat:r}=n,i=Sa(),s=r==="channelsLast",a=s?1:2,o=s?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${a}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${o}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${s}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${i.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KA(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function wue({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const l=t.shape,c=r.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,g=!1;let m;const y=[];if(s!=null){const _=KA(s.shape,f);_!=null&&(s=st({inputs:{x:s},backend:r,attrs:{shape:_}}),y.push(s))}if(i!=null){const _=KA(i.shape,f);_!=null&&(i=st({inputs:{x:i},backend:r,attrs:{shape:_}}),y.push(i))}if(!((d===1||h===1)&&u>fue)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&Pn(c.shape.slice(-3),l.slice(-3))){const _=l[0]*l[1]*(l[2]+1),T={dataId:t.dataId,shape:[1,_,n.inChannels],dtype:t.dtype},E=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,q(HA(c.shape,T.shape),()=>`packed reshape ${c.shape} to ${T.shape} isn't free`);const C=st({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}});y.push(C);const I=XA({a:T,b:C,backend:r,transposeA:p,transposeB:g,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a}),A=r.texData.get(I.dataId);q(A.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=E,A.shape=n.outShape,m=So({inputs:{x:I},backend:r}),m.shape=n.outShape,y.push(I)}else{const _=n.outHeight*n.outWidth,T=st({inputs:{x:t},backend:r,attrs:{shape:f?[n.batchSize,_,n.inChannels]:[n.batchSize,n.inChannels,_]}}),E=st({inputs:{x:e},backend:r,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=XA({a:f?T:E,b:f?E:T,transposeA:!f,transposeB:g,backend:r,bias:i,activation:o,preluActivationWeights:s,leakyreluAlpha:a});m=st({inputs:{x:C},backend:r,attrs:{shape:n.outShape}}),y.push(T),y.push(E),y.push(C)}for(const _ of y)r.disposeIntermediateTensorInfo(_);return m}function Sue({x:t,filter:e,convInfo:n,backend:r,bias:i=null,preluActivationWeights:s=null,leakyreluAlpha:a=0,activation:o=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",g=l*c*u,m=h*d,y=[n.batchSize,g,m],x=!0,b=!1,_=[];if(s!=null){const L=KA(s.shape,p);L!=null&&(s=st({inputs:{x:s},backend:r,attrs:{shape:L}}),_.push(s))}if(i!=null){const L=KA(i.shape,p);L!=null&&(i=st({inputs:{x:i},backend:r,attrs:{shape:L}}),_.push(i))}const T=st({inputs:{x:e},backend:r,attrs:{shape:[1,g,Oe(e.shape)/g]}});_.push(T);const E=new DBe(y,n),C=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=r.runWebGLProgram(E,[t],"float32",C),A=st({inputs:{x:I},backend:r,attrs:{shape:y}});_.push(I),_.push(A);const k=i!=null,R=s!=null,$=o==="leakyrelu",z=o?nS(o,!0):null,O=new hue(p?A.shape:T.shape,p?T.shape:A.shape,p?[n.batchSize,m,n.outChannels]:[n.batchSize,n.outChannels,m],x,b,k,z,R,$),j=p?[A,T]:[T,A];if(i&&j.push(i),R&&j.push(s),$){const L=r.makeTensorInfo([],"float32",hp(a,"float32"));j.push(L),_.push(L)}const B=r.runWebGLProgram(O,j,"float32"),W=st({inputs:{x:B},backend:r,attrs:{shape:n.outShape}});_.push(B);for(const L of _)r.disposeIntermediateTensorInfo(L);return W}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Be(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r,d=yh(l),h=hs(i.shape,s.shape,a,c,o,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=wue({x:i,filter:s,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&Me().getBool("WEBGL_EXP_CONV")){const g=new bue(h),m=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(g,[i,s],"float32",m)}else if(Me().getBool("WEBGL_CONV_IM2COL"))f=Sue({x:i,filter:s,convInfo:h,backend:n});else{const g=new xue(h);f=n.runWebGLProgram(g,[i,s],"float32")}const p=st({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const LBe={kernelName:wM,backendName:"webgl",kernelFunc:$Be};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class FBe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,i=e.padInfo.top,s=e.padInfo.left,a=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${a?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class jBe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,i=e.strideHeight,s=e.strideWidth,a=e.dataFormat==="channelsLast",o=n-1-e.padInfo.top,l=r-1-e.padInfo.left,c=a?1:2,u=a?2:3,d=a?3:1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${a}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class zBe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,r=e.strideHeight,i=e.strideWidth,s=e.padInfo.front,a=e.padInfo.top,o=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${s};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${a};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${i} - ${o};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class BBe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,r=e.filterHeight,i=e.filterWidth,s=e.strideDepth,a=e.strideHeight,o=e.strideWidth,l=n-1-e.padInfo.front,c=r-1-e.padInfo.top,u=i-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${s}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${a}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${i}; wC++) {
              float dyC = float(dyCCorner + wC) / ${o}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${i} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r,d=yh(l),h=hs(i.shape,u,a,1,o,c,!1,d),f=new FBe(h);return n.runWebGLProgram(f,[i,s],"float32")}const VBe={kernelName:JU,backendName:"webgl",kernelFunc:UBe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WBe{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Xs(this.outputShape.length);const n=e.filterHeight,r=e.filterWidth,i=n-1-e.padInfo.top,s=r-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${s});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            int wCPerm = ${r} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HBe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r,d=yh(c),h=hs(a,s.shape,o,1,l,u,!1,d);if(Me().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new WBe(h);return n.runWebGLProgram(p,[i,s],"float32",f)}else{const f=new jBe(h);return n.runWebGLProgram(f,[i,s],"float32")}}const GBe={kernelName:SM,backendName:"webgl",kernelFunc:HBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dilations:l}=r,c=mp(i.shape,s.shape,a,l,o),u=new OBe(c);return n.runWebGLProgram(u,[i,s],"float32")}const XBe={kernelName:_M,backendName:"webgl",kernelFunc:qBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KBe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,pad:o,filterShape:l}=r,c=mp(i.shape,l,a,1,o),u=new zBe(c);return n.runWebGLProgram(u,[i,s],"float32")}const YBe={kernelName:eV,backendName:"webgl",kernelFunc:KBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZBe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{pad:a,strides:o,inputShape:l}=r,c=mp(l,s.shape,o,1,a),u=new BBe(c);return n.runWebGLProgram(u,[i,s],"float32")}const QBe={kernelName:tV,backendName:"webgl",kernelFunc:ZBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JBe=ab+`
  return cos(x);
`,eUe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${ty}
  return result;
`,tUe=Wn({opSnippet:JBe,packedOpSnippet:eUe}),nUe={kernelName:Q_,backendName:"webgl",kernelFunc:tUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rUe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,iUe=Wn({opSnippet:rUe}),sUe={kernelName:J_,backendName:"webgl",kernelFunc:iUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aUe{constructor(e,n,r,i,s){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[a,o,l,c]=e,[u]=n,[d,h]=r;this.outputShape=[u,d,h,c];const f=i==="bilinear"?1:0,[p,g]=[`${o-1}.0`,`${l-1}.0`],[m,y,x]=d>1?[`${(o-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,_,T]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${g} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${g}`];this.userCode=`
      const float height_ratio = float(${m});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${a}) {
          return;
        }

        float height_scale = ${y};
        float width_scale = ${_};

        float in_y = ${x};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${s}));
          return;
        }
        float in_x = ${T};
        if( in_x < 0.0 || in_x > ${g} ) {
          setOutput(float(${s}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oUe=t=>{const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:s,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=r,u=new aUe(i.shape,s.shape,o,l,c);return n.runWebGLProgram(u,[i,s,a],"float32")},lUe={kernelName:rV,backendName:"webgl",kernelFunc:oUe};var iS;(function(t){t.Prod="*",t.Sum="+"})(iS||(iS={}));class Q7{constructor(e,n,r,i){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const s=this.outputShape.length,a=this.op===iS.Prod?"1.0":"0.0",o=r?a:`getX(${J7(s,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";r?(c=i?`end != ${l-1}`:"end != 0",u=i?"end + 1":"end - 1"):(c=i?`end + pow2 < ${l}`:"end >= pow2",u=i?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${gr(s)} coords = getOutputCoords();
        int end = ${eX(s,"coords",this.op)};
        float val = ${o};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${eX(s,"coords",this.op)} = idx;
          val ${this.op}= getX(${J7(s,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function J7(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function eX(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ue(t,e,n,r,i,s){const a=e.shape.length,o=Jr([r],a);let l=e;o!=null&&(l=xa({inputs:{x:e},backend:n,attrs:{perm:o}}));const c=wi(1,a)[0];if(c!==a-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const u=l.shape[c];let d=So({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new Q7(t,l.shape,!1,s),p=[[h]],g=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(g)}if(i){const h=new Q7(t,l.shape,i,s),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(o!=null){const h=gp(o),f=xa({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,exclusive:a,reverse:o}=r;return _ue(iS.Prod,i,n,s,a,o)}const uUe={kernelName:nV,backendName:"webgl",kernelFunc:cUe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,exclusive:a,reverse:o}=r;return _ue(iS.Sum,i,n,s,a,o)}const hUe={kernelName:TM,backendName:"webgl",kernelFunc:dUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:s}=e,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.readSync(i.dataId),c=n.readSync(s.dataId),u=rue(l,c,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(s),u=yje(l,c,a,o);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const pUe={kernelName:iV,backendName:"webgl",kernelFunc:fUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mUe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:s,dataFormat:a}=r,o=i.shape[0],l=a==="NHWC"?i.shape[1]:i.shape[2],c=a==="NHWC"?i.shape[2]:i.shape[3],u=a==="NHWC"?i.shape[3]:i.shape[1],d=l*s,h=c*s,f=u/(s*s),p=a==="NHWC"?[o,d,h,f]:[o,f,d,h],g=new mUe(p,s,a);return n.runWebGLProgram(g,[i],i.dtype)}const yUe={kernelName:sV,backendName:"webgl",kernelFunc:gUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tue{constructor(e,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=e.filterHeight,o=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";r&&(i?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${a}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${o}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Eue{constructor(e,n=!1,r=null,i=!1,s=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Xs(this.outputShape.length);const a=e.outChannels/e.inChannels,o=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let y=0;y<d;y++)f+=`
          vec4 xTexelC${y*2};
          int xTexelC${y*2}Ready;
          vec4 xTexelC${y*2+1};
          int xTexelC${y*2+1}Ready;
          vec4 xC${y};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let y=0;y<d;y++)f+=`
          xTexelC${y*2} = vec4(0.0);
          xTexelC${y*2}Ready = 0;
          xTexelC${y*2+1} = vec4(0.0);
          xTexelC${y*2+1}Ready = 0;
          xC${y} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let y=0;y<(h+1)/2;y++){const x=y*2;if(f+=`
          xC = xCCorner + ${x*c};
          `,l===1){if(x<d&&(o%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }
              `,c===1&&x>0?f+=`
                xC${x} = vec4(xTexelC${x-2}.zw, xTexelC${x}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${x} = vec4(previous.zw, xTexelC${x}.xy);
                  } else {
                    xC${x} = vec4(0.0, 0.0, xTexelC${x}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xC${x} = xTexelC${x};
                `,x+1<d)){const b=o%2===0?VU(c):c;c%2===0&&o%2===1||c%2!==0&&o%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                    xTexelC${x+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${x+1}.zw = vec2(0.0);
                    }
                    xTexelC${x+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${x+1} = vec4(previous.zw, xTexelC${x+1}.xy);
                    } else {
                     xC${x+1} = vec4(0.0, 0.0, xTexelC${x+1}.xy);
                    }
                    `:f+=`
                    xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.xy);
                    `):b===1?f+=`
                    xC${x+1} = xTexelC${x};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                      xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${x+1}.zw = vec2(0.0);
                      }
                      xTexelC${x+1}Ready = 1;
                    }

                    xC${x+1} = xTexelC${x+1};
                    `}}else x<d&&(o%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.0);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
              `,x+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${x+1} = vec4(xTexelC${x+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${x}Ready == 0) {
                  xTexelC${x} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${x}.zw = vec2(0.0);
                  }
                  xTexelC${x}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${x+1}Ready == 0) {
                  xTexelC${x+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${x+1}.zw = vec2(0.);
                  }
                  xTexelC${x+1}Ready = 1;
                }

                xC${x} = vec4(
                  xTexelC${x}.xy, xTexelC${x+1}.xy);
              `,x+1<d&&(f+=`
                  xC${x+1} = vec4(xTexelC${x}.zw, xTexelC${x+1}.zw);
                `)));x<d&&(f+=`
            wTexel = getW(r, ${x}, d1, q);
            dotProd += xC${x} * vec4(wTexel.xz, wTexel.xz);
          `,x+1<d&&(f+=`
              wTexel = getW(r, ${x+1}, d1, q);
              dotProd += xC${x+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",g="";r&&(i?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:s?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:p=`vec4 activation(vec4 x) {
          ${r}
        }`,g="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),i&&this.variableNames.push("preluActivationWeights"),s&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${a};
        int q = d2 - d1 * ${a};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${m}
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=r;let u=l;u==null&&(u=[1,1]),q(ks(a,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const d=hs(i.shape,s.shape,a,u,o,c,!0);let h;Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new Eue(d):h=new Tue(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[i,s],"float32",f)}const xUe={kernelName:EM,backendName:"webgl",kernelFunc:vUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bUe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,r=e.strideWidth,i=e.padInfo.top,s=e.padInfo.left,a=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${a} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${i};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${s};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class wUe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,r=e.filterWidth,i=e.strideHeight,s=e.strideWidth,a=n-1-e.padInfo.top,o=r-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${i}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r,d=hs(i.shape,u,a,o,l,c,!0),h=new bUe(d);return n.runWebGLProgram(h,[i,s],"float32")}const _Ue={kernelName:aV,backendName:"webgl",kernelFunc:SUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TUe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r,d=hs(u,s.shape,a,o,l,c,!0),h=new wUe(d);return n.runWebGLProgram(h,[i,s],"float32")}const EUe={kernelName:oV,backendName:"webgl",kernelFunc:TUe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CUe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NUe(t){const{inputs:e,backend:n}=t,{x:r}=e,i=[...r.shape,...r.shape],s=Oe(r.shape),a=st({inputs:{x:r},backend:n,attrs:{shape:[s]}}),o=new CUe(s),l=n.runWebGLProgram(o,[a],a.dtype),c=st({inputs:{x:l},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const AUe={kernelName:lV,backendName:"webgl",kernelFunc:NUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IUe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:r,padInfo:i,strideHeight:s,strideWidth:a,filterHeight:o,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=i;this.userCode=`
      const ivec2 strides = ivec2(${s}, ${a});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${o}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kUe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dilations:l}=r,c=FT(i.shape,s.shape,a,o,"NHWC",l);let u;const d=new IUe(c);u=n.runWebGLProgram(d,[i,s],"float32");const h=st({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const MUe={kernelName:CM,backendName:"webgl",kernelFunc:kUe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RUe(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,s=e,{allDims:a,summedDims:o,idDims:l}=h5(i,s.length);p5(a.length,l,s);const{path:c,steps:u}=m5(o,l),d=u.length;let h=null,f=a.length;const p=[];for(let g=0;g<d;++g){for(const m of u[g]){const{permutationIndices:y,expandDims:x}=f5(f,l[m]);let b;g5(y)?b=s[m]:(b=xa({inputs:{x:s[m]},backend:n,attrs:{perm:y}}),p.push(b));const _=b.shape.slice();for(let T=0;T<x.length;++T)_.splice(x[T],0,1);Pn(b.shape,_)||(b=st({inputs:{x:b},backend:n,attrs:{shape:_}}),p.push(b)),h===null?h=b:(h=M5({inputs:{a:b,b:h},backend:n}),p.push(h))}g<d-1&&(c[g]>=0&&(h=WR({inputs:{x:h},backend:n,attrs:{axis:c[g]-(a.length-f),keepDims:!1}}),p.push(h)),f--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const PUe={kernelName:cV,backendName:"webgl",kernelFunc:RUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OUe="return (x >= 0.0) ? x : (exp(x) - 1.0);",DUe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,$Ue=Wn({opSnippet:OUe,packedOpSnippet:DUe}),LUe={kernelName:tT,backendName:"webgl",kernelFunc:$Ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FUe="return (b >= 0.0) ? a : a * (b + 1.0);",jUe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,zUe=t=>{const{inputs:e,backend:n}=t,{dy:r,y:i}=e,s=Me().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new sb(jUe,r.shape,i.shape):new Ng(FUe,r.shape,i.shape);return n.runWebGLProgram(s,[r,i],r.dtype)},BUe={kernelName:uV,backendName:"webgl",kernelFunc:zUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UUe=`
  return vec4(equal(a, b));
`,VUe="return float(a == b);",WUe=Rs({opSnippet:VUe,packedOpSnippet:UUe,dtype:"bool",cpuKernelImpl:Sje}),HUe={kernelName:NM,backendName:"webgl",kernelFunc:WUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GUe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${s5};
  float a1 = ${a5};
  float a2 = ${o5};
  float a3 = ${l5};
  float a4 = ${c5};
  float a5 = ${u5};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,qUe=Wn({opSnippet:GUe}),XUe={kernelName:nT,backendName:"webgl",kernelFunc:qUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KUe=ab+`
  return exp(x);
`,YUe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Cue=Wn({opSnippet:KUe,packedOpSnippet:YUe,cpuKernelImpl:_je,dtype:"float32"}),ZUe={kernelName:rT,backendName:"webgl",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(t){const{inputs:e,attrs:n,backend:r}=t,{dim:i}=n,{input:s}=e,a=s.shape.length,o=s.shape.slice();let l=i;return i<0&&(q(-(a+1)<=i,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+i+1),o.splice(l,0,1),st({inputs:{x:s},backend:r,attrs:{shape:o}})}const QUe={kernelName:AM,backendName:"webgl",kernelFunc:gj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tX="return exp(x) - 1.0;",JUe=Wn({opSnippet:tX,packedOpSnippet:tX,cpuKernelImpl:Tje}),eVe={kernelName:iT,backendName:"webgl",kernelFunc:JUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nX{constructor(e,n,r){this.variableNames=["real","imag"];const i=n[1];this.outputShape=n;const s=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,a=r?`${i}.0`:"1.0";let o;if(e==="real")o="return real * expR - imag * expI;";else if(e==="imag")o="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${s};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${o}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${i});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${i}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${a};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t,e,n){const r=n.texData.get(t.dataId),i=Oe(t.shape),s=t.shape[t.shape.length-1],a=i/s,o=st({inputs:{x:t},backend:n,attrs:{shape:[a,s]}}),l=o.shape,c=new nX("real",l,e),u=new nX("imag",l,e),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:l},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=bp({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const g=st({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(p),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tVe(t){const{inputs:e,backend:n}=t,{input:r}=e;return Nue(r,!1,n)}const nVe={kernelName:dV,backendName:"webgl",kernelFunc:tVe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rVe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QT(t){const{backend:e,attrs:n}=t,{shape:r,value:i}=n;let{dtype:s}=n;if(s=s||G0(i),s==="string"){const a=xi(s,Oe(r));return a.fill(i),e.makeTensorInfo(r,s,a)}else{const a=new rVe(r,i),o=[[i]];return e.runWebGLProgram(a,[],s,o)}}const iVe={kernelName:hV,backendName:"webgl",kernelFunc:QT};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sVe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aVe={kernelName:fV,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,r=e,i=new sVe(n.shape);return r.runWebGLProgram(i,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX="return floor(x);",oVe=Wn({opSnippet:rX,packedOpSnippet:rX,cpuKernelImpl:Eje}),lVe={kernelName:sT,backendName:"webgl",kernelFunc:oVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cVe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,uVe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,dVe=Rs({opSnippet:cVe,packedOpSnippet:uVe,dtype:"int32"}),hVe={kernelName:aT,backendName:"webgl",kernelFunc:dVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fVe{constructor(e){this.variableNames=["A"];const n=Sa(),[r,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${i}.0, ${r}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pVe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Sa(),[r,i]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${i}.0, ${r}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mVe={kernelName:XF,backendName:"webgl",kernelFunc:gVe};let $y,z$=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function gVe(t){const{inputs:e,backend:n,attrs:r}=t;let{pixels:i}=e;const{numChannels:s}=r,a=typeof HTMLVideoElement<"u"&&i instanceof HTMLVideoElement,o=typeof HTMLImageElement<"u"&&i instanceof HTMLImageElement,[l,c]=a?[i.videoWidth,i.videoHeight]:[i.width,i.height],u=[c,l],d=[c,l,s];if(o||a){const g=Me().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");($y==null||g!==z$)&&(z$=g,$y=document.createElement("canvas").getContext("2d",{willReadFrequently:z$})),$y.canvas.width=l,$y.canvas.height=c,$y.drawImage(i,0,0,l,c),i=$y.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Go.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),i);const f=Me().getBool("WEBGL_PACK")?new pVe(d):new fVe(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r,g=yh(u),m=hs(i.shape,s.shape,l,d,c,h,!1,g);let y;const x=[],b=a!=null,_=o!=null,T=f==="leakyrelu",E=()=>{const I=[i,s],A=(k,R)=>{if(R==="NCHW"&&k.shape.length===1&&k.shape[0]!==1){const $=st({inputs:{x:k},backend:n,attrs:{shape:[k.shape[0],1,1]}});return x.push($),$}return k};if(b&&I.push(A(a,u)),_&&I.push(A(o,u)),T){const k=n.makeTensorInfo([],"float32",hp(p,"float32"));I.push(k),x.push(k)}return I};if(m.filterHeight===1&&m.filterWidth===1&&m.dilationHeight===1&&m.dilationWidth===1&&m.strideHeight===1&&m.strideWidth===1&&(m.padInfo.type==="SAME"||m.padInfo.type==="VALID"))y=wue({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:f,preluActivationWeights:o,leakyreluAlpha:p});else if(m.strideWidth<=2&&g==="channelsLast"&&Me().getBool("WEBGL_EXP_CONV")){const I=f?nS(f,!0):null,A=new bue(m,b,I,_,T),k=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],R=E();y=n.runWebGLProgram(A,R,"float32",k)}else if(Me().getBool("WEBGL_CONV_IM2COL"))y=Sue({x:i,filter:s,convInfo:m,backend:n,bias:a,activation:f,preluActivationWeights:o,leakyreluAlpha:p});else{const I=f?nS(f,!1):null,A=new xue(m,b,I,_,T),k=E();y=n.runWebGLProgram(A,k,"float32")}const C=st({inputs:{x:y},backend:n,attrs:{shape:m.outShape}});return x.push(y),x.forEach(I=>n.disposeIntermediateTensorInfo(I)),C}const vVe={kernelName:$A,backendName:"webgl",kernelFunc:yVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xVe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=r,p=[];let g=u;g==null&&(g=[1,1]),q(ks(l,g),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${g}'`);const m=hs(i.shape,s.shape,l,g,c,d,!0),y=Me().getBool("WEBGL_PACK_DEPTHWISECONV")&&m.strideWidth<=2&&m.outChannels/m.inChannels===1,x=h?nS(h,y):null,b=[i,s],_=a!=null,T=o!=null,E=h==="leakyrelu";if(_&&b.push(a),T&&b.push(o),E){const k=n.makeTensorInfo([],"float32",hp(f,"float32"));b.push(k),p.push(k)}let C;y?C=new Eue(m,_,x,T,E):C=new Tue(m,_,x,T,E);const I=[[m.padInfo.top,m.padInfo.left],[m.strideHeight,m.strideWidth],[m.dilationHeight,m.dilationWidth],[m.inHeight,m.inWidth]],A=n.runWebGLProgram(C,b,"float32",I);return p.forEach(k=>n.disposeIntermediateTensorInfo(k)),A}const bVe={kernelName:LA,backendName:"webgl",kernelFunc:xVe};class wVe{constructor(e,n,r,i){this.sliceDim=e,this.strides=n,this.paramsShape=i,this.variableNames=["x","indices"],this.outputShape=r;const s=gr(r.length);let a=`
    int index;`;for(let o=0;o<this.sliceDim;o++)a+=`
          index = round(getIndices(coords[0], ${o}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[o]};
          flattenIndex += index * ${this.strides[o]};`;this.userCode=`
         void main() {
          ${s} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${a}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SVe(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,s=i.shape,a=s[s.length-1],o=Oe(r.shape),[l,c,u,d]=XW(r,i),h=st({inputs:{x:i},backend:n,attrs:{shape:[c,a]}}),f=st({inputs:{x:r},backend:n,attrs:{shape:[Oe(r.shape)/u,u]}});if(n.shouldExecuteOnCPU([r,i])||r.dtype==="string"){const y=n.readSync(i.dataId),x=n.bufferSync(r),b=Cje(y,x,r.dtype,c,a,u,d,r.shape,o);return n.makeTensorInfo(l,r.dtype,b.values)}const p=new wVe(a,d,[c,u],r.shape),g=n.runWebGLProgram(p,[f,h],f.dtype),m=st({inputs:{x:g},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(g),m}const _Ve={kernelName:pV,backendName:"webgl",kernelFunc:SVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TVe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const r=gr(this.rank),i=EVe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${i}));
      }
    `}}function EVe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let i=0;i<t.length;i++)i===2?r.push("index"):r.push(`${n[i]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aue(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:s}=e,{axis:a,batchDims:o}=r,l=Nn(a,i.shape)[0];if(Me().get("DEBUG")){const x=n.readSync(s.dataId),b=i.shape[l];for(let _=0;_<x.length;++_){const T=x[_];q(T<=b-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${b-1}]`)}}const c=v5(i,s,l,o),u=Oe(s.shape),d=[],h=st({inputs:{x:i},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=st({inputs:{x:s},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([i,s])||i.dtype==="string"){const x=n.bufferSync(f),b=n.bufferSync(h),_=Nje(b,x,p);return d.forEach(T=>n.disposeIntermediateTensorInfo(T)),n.makeTensorInfo(c.outputShape,_.dtype,_.values)}const g=new TVe(h.shape,p),m=n.runWebGLProgram(g,[h,f],h.dtype);d.push(m);const y=st({inputs:{x:m},backend:n,attrs:{shape:c.outputShape}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),y}const CVe={kernelName:kM,backendName:"webgl",kernelFunc:Aue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NVe="return float(a > b);",AVe=`
  return vec4(greaterThan(a, b));
`,IVe=Rs({opSnippet:NVe,packedOpSnippet:AVe,cpuKernelImpl:Aje,dtype:"bool"}),kVe={kernelName:MM,backendName:"webgl",kernelFunc:IVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MVe="return float(a >= b);",RVe=`
  return vec4(greaterThanEqual(a, b));
`,PVe=Rs({opSnippet:MVe,packedOpSnippet:RVe,dtype:"bool",cpuKernelImpl:Ije}),OVe={kernelName:oT,backendName:"webgl",kernelFunc:PVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DVe(t){const{inputs:e,backend:n}=t,{input:r}=e;return Nue(r,!0,n)}const $Ve={kernelName:mV,backendName:"webgl",kernelFunc:DVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LVe="return float(!isnan(x) && !isinf(x));",FVe=Wn({opSnippet:LVe,dtype:"bool"}),jVe={kernelName:cT,backendName:"webgl",kernelFunc:FVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zVe="return float(isinf(x));",BVe=Wn({opSnippet:zVe,dtype:"bool"}),UVe={kernelName:uT,backendName:"webgl",kernelFunc:BVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VVe="return float(isnan(x));",WVe=Wn({opSnippet:VVe,dtype:"bool"}),HVe={kernelName:dT,backendName:"webgl",kernelFunc:WVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GVe="return float(a < b);",qVe=`
  return vec4(lessThan(a, b));
`,XVe=Rs({opSnippet:GVe,packedOpSnippet:qVe,cpuKernelImpl:kje,dtype:"bool"}),KVe={kernelName:PM,backendName:"webgl",kernelFunc:XVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YVe="return float(a <= b);",ZVe=`
  return vec4(lessThanEqual(a, b));
`,QVe=Rs({opSnippet:YVe,packedOpSnippet:ZVe,cpuKernelImpl:Mje,dtype:"bool"}),JVe={kernelName:OM,backendName:"webgl",kernelFunc:QVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eWe(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:s}=n,a=Rje(r,i,s);return e.makeTensorInfo([a.length],"float32",a)}const tWe={kernelName:yV,backendName:"webgl",kernelFunc:eWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nWe=ab+`
  return x < 0.0 ? 0./0. : log(x);
`,rWe=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,iWe=Wn({opSnippet:nWe,packedOpSnippet:rWe,cpuKernelImpl:Pje}),sWe={kernelName:hT,backendName:"webgl",kernelFunc:iWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aWe=ab+`
  return log(1.0 + x);
`,oWe=Wn({opSnippet:aWe}),lWe={kernelName:fT,backendName:"webgl",kernelFunc:oWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cWe="return float(a >= 1.0 && b >= 1.0);",uWe=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,dWe=Rs({opSnippet:cWe,packedOpSnippet:uWe,dtype:"bool"}),hWe={kernelName:DM,backendName:"webgl",kernelFunc:dWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fWe="return float(!(x >= 1.0));",pWe=Wn({opSnippet:fWe}),mWe={kernelName:$M,backendName:"webgl",kernelFunc:pWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gWe="return float(a >= 1.0 || b >= 1.0);",yWe=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,vWe=Rs({opSnippet:gWe,packedOpSnippet:yWe,dtype:"bool"}),xWe={kernelName:LM,backendName:"webgl",kernelFunc:vWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bWe{constructor(e,n,r,i,s){this.variableNames=["x"],this.outputShape=[];const a=n,o=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${a}; j <= ${a}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${o}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wWe{constructor(e,n,r,i,s){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const a=n,o=e[3]-1;this.outputShape=e;let l;const c=`float(${r}) + float(${i}) * sum`;s===.5?l=`inversesqrt(${c})`:s===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${s}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${a};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${a}; j <= ${a}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${o}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SWe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:s,bias:a,alpha:o,beta:l}=r,c=Me().getBool("WEBGL_PACK_NORMALIZATION")?new wWe(i.shape,s,a,o,l):new bWe(i.shape,s,a,o,l);return n.runWebGLProgram(c,[i],i.dtype)},_We={kernelName:FM,backendName:"webgl",kernelFunc:SWe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TWe{constructor(e,n,r,i,s){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=r,this.alpha=i,this.beta=s,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${i}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${i})
                * float(${s})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${s});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EWe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i,y:s,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:u}=r,d=new TWe(i.shape,o,l,c,u);return n.runWebGLProgram(d,[i,s,a],i.dtype)},CWe={kernelName:vV,backendName:"webgl",kernelFunc:EWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NWe(t,e,n,r){const i=Oe(e),a=Oe(t.shape)/i,o=st({inputs:{x:t},attrs:{shape:[a,i]},backend:r}),l=ny(o,t.dtype,"max",r),c=st({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iue(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:s,keepDims:a}=r,o=i.shape.length,l=Nn(s,i.shape);let c=l;const u=Jr(c,o),d=u!=null,h=n.shouldExecuteOnCPU([i]);let f=i;if(d){if(h){const b=n.texData.get(f.dataId).values,_=new Array(o);for(let C=0;C<_.length;C++)_[C]=i.shape[u[C]];const T=I5(b,i.shape,i.dtype,u,_);f=n.makeTensorInfo(_,i.dtype);const E=n.texData.get(f.dataId);E.values=T}else f=VR(i,u,n);c=wi(c.length,o)}Ms("max",c,o);const[p,g]=fs(f.shape,c);let m=p;a&&(m=bi(p,l));let y;if(h){const b=n.texData.get(f.dataId).values,_=Oje(b,Oe(g),m,i.dtype);y=n.makeTensorInfo(m,i.dtype);const T=n.texData.get(y.dataId);T.values=_}else y=NWe(f,g,m,n);return d&&n.disposeIntermediateTensorInfo(f),y}const AWe={kernelName:jM,backendName:"webgl",kernelFunc:Iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IWe=k5+`
  return max(a, b);
`,kWe=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ty+`
  return result;
`,MWe=Rs({opSnippet:IWe,packedOpSnippet:kWe,cpuKernelImpl:Dje}),RWe={kernelName:pT,backendName:"webgl",kernelFunc:MWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;KT(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,c=1;q(ks(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Zl(i.shape,s,a,c,o,l);if(u.filterWidth===1&&u.filterHeight===1&&Pn(u.inShape,u.outShape))return So({inputs:{x:i},backend:n});const d=new rS(u,"max",!1);return n.runWebGLProgram(d,[i],i.dtype)}const OWe={kernelName:zM,backendName:"webgl",kernelFunc:PWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:s,strides:a,pad:o,dataFormat:l,dimRoundingMode:c}=r,u=[1,1,1],d=gh(i.shape,s,a,u,o,c,l),h=new R5(d,"max",!1);return n.runWebGLProgram(h,[i],i.dtype)}const $We={kernelName:BM,backendName:"webgl",kernelFunc:DWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LWe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,r=e.strideWidth,i=e.dilationHeight,s=e.effectiveFilterHeight,a=e.effectiveFilterWidth,o=s-1-e.padInfo.top,l=a-1-e.padInfo.left,c=s*a-1;this.userCode=`
      const ivec2 pads = ivec2(${o}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${s};
          wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${a}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${a} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class FWe{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,r=e.strideHeight,i=e.strideWidth,s=e.dilationDepth,a=e.dilationHeight,o=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${s}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${a}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${o}) {
              float dyC = float(dyCCorner + wC) / ${i}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jWe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,a=s,{filterSize:o,strides:l,pad:c,dimRoundingMode:u}=r,d=[1,1,1],h=gh(a.shape,o,l,d,c,u),f=new R5(h,"max",!0),p=n.runWebGLProgram(f,[a],a.dtype),g=new FWe(h),m=n.runWebGLProgram(g,[i,p],a.dtype);return n.disposeIntermediateTensorInfo(p),m}const zWe={kernelName:bV,backendName:"webgl",kernelFunc:jWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BWe(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s,output:a}=e,o=s;KT([s,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=Zl(o.shape,l,c,1,u,d),f=!0,p=new rS(h,"max",f),g=n.runWebGLProgram(p,[o],o.dtype),m=new LWe(h),y=n.runWebGLProgram(m,[i,g],o.dtype);return n.disposeIntermediateTensorInfo(g),y}const UWe={kernelName:xV,backendName:"webgl",kernelFunc:BWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VWe(t,e,n,r){let i=new rS(n,"max",!1);const s=r.runWebGLProgram(i,[t],"float32");i=new rS(n,"max",!0,!0,e);const a=r.runWebGLProgram(i,[t],"float32");return[s,a]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WWe={kernelName:wV,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=e,l=n;q(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];q(ks(s,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${s} and dilations '${c}'`);const u=Zl(r.shape,i,s,c,a),[d,h]=VWe(r,o,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HWe(t,e,n,r){const i=Oe(e),a=Oe(t.shape)/i,o=st({inputs:{x:t},attrs:{shape:[a,i]},backend:r}),l=ny(o,"float32","mean",r),c=st({inputs:{x:l},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GWe={kernelName:UM,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{keepDims:i,axis:s}=e,a=n,o=r.shape.length,l=Nn(s,r.shape);let c=l;const u=Jr(c,o),d=u!=null,h=a.shouldExecuteOnCPU([r]),f=[];let p=r;if(d){if(h){const _=a.texData.get(p.dataId).values,T=new Array(o);for(let I=0;I<T.length;I++)T[I]=r.shape[u[I]];const E=I5(_,r.shape,r.dtype,u,T);p=a.makeTensorInfo(T,r.dtype);const C=a.texData.get(p.dataId);C.values=E}else p=VR(r,u,a);f.push(p),c=wi(c.length,o)}Ms("sum",c,o);const[g,m]=fs(p.shape,c);let y=g;i&&(y=bi(g,l));const x=HWe(p,m,y,a);for(const b of f)a.disposeIntermediateTensorInfo(b);return x}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qWe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r,o=i.shape.length,l=Nn(s,i.shape);let c=l;const u=Jr(c,o);let d=i;u!=null&&(d=xa({inputs:{x:i},backend:n,attrs:{perm:u}}),c=wi(c.length,i.shape.length)),Ms("min",c,o);const[h,f]=fs(d.shape,c),p=Oe(f),g=st({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),m=ny(g,g.dtype,"min",n);let y;if(a){const x=bi(h,l);y=st({inputs:{x:m},backend:n,attrs:{shape:x}})}else y=st({inputs:{x:m},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),u!=null&&n.disposeIntermediateTensorInfo(d),y}const XWe={kernelName:VM,backendName:"webgl",kernelFunc:qWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KWe=k5+`
  return min(a, b);
`,YWe=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+ty+`
  return result;
`,ZWe=Rs({opSnippet:KWe,packedOpSnippet:YWe,cpuKernelImpl:$je}),QWe={kernelName:mT,backendName:"webgl",kernelFunc:ZWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class JWe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const i=e.length,s=gr(i),a=n.map(u=>u[0]).join(","),o=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i),c=r==="reflect"?0:1;if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        for (int i = 0; i < ${i}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${s} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e5e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,g)=>p[0]+e[g]+p[1]);const i=e.length,s=gr(i),a=n.map(p=>p[0]).join(","),o=n.map((p,g)=>p[0]+e[g]).join(","),l=fa("rc",i),c=fa("source",i),u=`${l[i-1]} < ${this.outputShape[i-1]}`,d=i===1?"source":`vec2(${c.slice(-2).join()})`,h=r==="reflect"?0:1;let f="";if(i===1){const p=`
        ${s} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[i-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${s} source = rc;
        ${s} lt = ${s}(lessThan(source, start));
        ${s} gte = ${s}(greaterThanEqual(source, end));
        ${s} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${s} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[i-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[i-2]} += 1;
        if(${l[i-2]} < ${this.outputShape[i-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[i-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5e=({inputs:t,backend:e,attrs:n})=>{const{x:r}=t,{paddings:i,mode:s}=n,a=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new e5e(r.shape,i,s):new JWe(r.shape,i,s);return e.runWebGLProgram(a,[r],r.dtype)},n5e={kernelName:WM,backendName:"webgl",kernelFunc:t5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r5e=`if (b == 0.0) return NAN;
  return mod(a, b);`,i5e=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+ty+`
  return result;
`,s5e=Rs({opSnippet:r5e,packedOpSnippet:i5e}),a5e={kernelName:gT,backendName:"webgl",kernelFunc:s5e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o5e{constructor(e,n,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l5e=`
if (a == b) {
  return 1.0;
};
return a / b;`,c5e=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,kue=Rs({opSnippet:l5e,packedOpSnippet:c5e,checkOutOfBounds:!0}),u5e={kernelName:eT,backendName:"webgl",kernelFunc:kue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX="return a - b;",Mue=Rs({opSnippet:iX,packedOpSnippet:iX,supportsComplex:!0,cpuKernelImpl:rze}),d5e={kernelName:RT,backendName:"webgl",kernelFunc:Mue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:s}=r,a=Nn([s],i.shape),o=Iue({inputs:{x:i},backend:n,attrs:{reductionIndices:a,keepDims:!1}}),l=bi(o.shape,a),c=st({inputs:{x:o},backend:n,attrs:{shape:l}}),u=Mue({inputs:{a:i,b:c},backend:n}),d=Cue({inputs:{x:u},backend:n}),h=WR({inputs:{x:d},backend:n,attrs:{axis:a,keepDims:!1}}),f=st({inputs:{x:h},backend:n,attrs:{shape:l}}),p=kue({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const h5e={kernelName:lR,backendName:"webgl",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5e(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:s,seed:a,normalized:o}=r,l=o?i:Rue({inputs:{logits:i},backend:n,attrs:{dim:i.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new o5e(c,u,s),h=[[a]],f=n.runWebGLProgram(d,[l],"int32",h);return o||n.disposeIntermediateTensorInfo(l),f}const p5e={kernelName:SV,backendName:"webgl",kernelFunc:f5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m5e=Ql+`
  return -x;
`,g5e=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function y5e(t){const{inputs:e,backend:n}=t,{x:r}=e;if(n.shouldExecuteOnCPU([r])){const s=n.texData.get(r.dataId),[a,o]=Fje(s.values,r.shape,r.dtype);return n.makeTensorInfo(o,r.dtype,a)}let i;return Me().getBool("WEBGL_PACK_UNARY_OPERATIONS")?i=new gf(r.shape,g5e):i=new Nu(r.shape,m5e),n.runWebGLProgram(i,[r],r.dtype)}const v5e={kernelName:HM,backendName:"webgl",kernelFunc:y5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x5e=zW;function b5e(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r,c=n.readSync(i.dataId),u=n.readSync(s.dataId),{selectedIndices:d}=x5e(c,u,a,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const w5e={kernelName:_V,backendName:"webgl",kernelFunc:b5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5e=BW;function _5e(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r,u=n.readSync(i.dataId),d=n.readSync(s.dataId),{selectedIndices:h,validOutputs:f}=S5e(u,d,a,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const T5e={kernelName:TV,backendName:"webgl",kernelFunc:_5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5e=UW;function C5e(t){Uo("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r,u=n.readSync(i.dataId),d=n.readSync(s.dataId),h=a,f=o,p=l,g=c,{selectedIndices:m,selectedScores:y}=E5e(u,d,h,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const N5e={kernelName:EV,backendName:"webgl",kernelFunc:C5e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A5e{constructor(e,n,r,i){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${i}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I5e=t=>{const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:s,depth:a,onValue:o,offValue:l}=r,c=Oe(i.shape),u=new A5e(c,a,o,l),d=st({inputs:{x:i},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],s);n.disposeIntermediateTensorInfo(d);const f=[...i.shape,a],p=st({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},k5e={kernelName:XM,backendName:"webgl",kernelFunc:I5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YA(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="complex64"){const i=ZT({inputs:{input:r},backend:n}),s=YA({inputs:{x:i},backend:n}),a=HR({inputs:{input:r},backend:n}),o=YA({inputs:{x:a},backend:n}),l=bp({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return QT({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:n})}const M5e={kernelName:hR,backendName:"webgl",kernelFunc:YA};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pue(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const i=ZT({inputs:{input:r},backend:n}),s=Pue({inputs:{x:i},backend:n}),a=HR({inputs:{input:r},backend:n}),o=YA({inputs:{x:a},backend:n}),l=bp({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return QT({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:n})}const R5e={kernelName:qM,backendName:"webgl",kernelFunc:Pue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P5e(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(e.length===1)return gj({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const s=e[0].shape,a=e[0].dtype;e.forEach(u=>{To(s,u.shape,"All tensors passed to stack must have matching shapes"),q(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(u=>{const d=gj({inputs:{input:u},backend:n,attrs:{dim:i}});return o.push(d),d}),c=vue({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const O5e={kernelName:KM,backendName:"webgl",kernelFunc:P5e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D5e{constructor(e,n,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const i=e.length,s=gr(i),a=n.map(c=>c[0]).join(","),o=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,i);if(i===1){this.userCode=`
        int start = ${a};
        int end = ${o};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${s} start = ${s}(${a});
      ${s} end = ${s}(${o});

      void main() {
        ${s} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${s} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $5e{constructor(e,n,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((g,m)=>g[0]+e[m]+g[1]);const i=e.length,s=gr(i),a=n.map(g=>g[0]).join(","),o=n.map((g,m)=>g[0]+e[m]).join(","),l=fa("rc",i),c=fa("source",i),u=`${l[i-1]} < ${this.outputShape[i-1]}`,d=i===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${s} rc = outputLoc;`,`${l[i-1]} += 1;
       if(${u}) {
      `,i===1?"":`}
       rc = outputLoc;
       ${l[i-2]} += 1;
       if(${l[i-2]} < ${this.outputShape[i-2]}) {`,i===1?"":`  ${l[i-1]} += 1;
         if(${u}) {`],f=i===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let g=0,m=i===1?2:4;g<m;g++)p+=`
        ${h[g]}
        if (${f}) {
          result[${g}] = float(value);
        } else {
          ${s} source = rc - start;
          result[${g}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=i===1?"} ":"}}",this.userCode=`
      const ${s} start = ${s}(${a});
      const ${s} end = ${s}(${o});

      void main() {
        ${s} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Oue=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:s,constantValue:a}=r;if(Oe(i.shape)===0){const c=s.map((u,d)=>u[0]+i.shape[d]+u[1]);return QT({backend:n,attrs:{shape:c,value:a,dtype:i.dtype}})}const o=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new $5e(i.shape,s,a):new D5e(i.shape,s,a),l=[[a]];return n.runWebGLProgram(o,[i],i.dtype,l)},L5e={kernelName:YM,backendName:"webgl",kernelFunc:Oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5e=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,j5e=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+ty+`
  return result;
`,z5e=Rs({opSnippet:F5e,packedOpSnippet:j5e}),B5e={kernelName:vT,backendName:"webgl",kernelFunc:z5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U5e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r,o=i.shape.length,l=[],c=Nn(s,i.shape);let u=c;const d=Jr(u,o);let h=i;d!=null&&(h=xa({inputs:{x:i},backend:n,attrs:{perm:d}}),u=wi(u.length,o),l.push(h)),Ms("prod",u,o);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:g,outShape:m,outDtype:y}=zje(h.shape,h.dtype,p,u);f=n.makeTensorInfo(m,y,g)}else{const[p,g]=fs(h.shape,u),m=Oe(g),y=st({inputs:{x:h},backend:n,attrs:{shape:[-1,m]}}),x=ZV(i.dtype),b=ny(y,x,"prod",n);f=st({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(y),l.push(b)}if(a){l.push(f);const p=bi(f.shape,c);f=st({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const V5e={kernelName:QM,backendName:"webgl",kernelFunc:U5e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5e(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=e,{outputRaggedRank:o}=r,l=i.map(y=>n.readSync(y.dataId)),c=i.map(y=>y.shape),u=n.readSync(s.dataId),d=n.readSync(a.dataId),[h,f,p]=Bje(l,c,u,s.shape,s.dtype,d,a.shape,o),g=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),m=n.makeTensorInfo(p,s.dtype,f);return g.concat([m])}const H5e={kernelName:CV,backendName:"webgl",kernelFunc:W5e};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5e(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:s}=e,a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[c,u]=Uje(a,r.shape,r.dtype,o,i.shape,l,s.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const q5e={kernelName:NV,backendName:"webgl",kernelFunc:G5e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5e(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=r,c=n.readSync(i.dataId),u=n.readSync(s.dataId),d=n.readSync(a.dataId),h=o.map(m=>n.readSync(m.dataId)),f=o.map(m=>m.shape),[p,g]=Vje(c,i.shape,u,s.shape,s.dtype,d,a.shape,h,f,l);return n.makeTensorInfo(p,s.dtype,g)}const K5e={kernelName:AV,backendName:"webgl",kernelFunc:X5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Due=t=>{const{backend:e,attrs:n}=t,{start:r,stop:i,step:s,dtype:a}=n,o=Wje(r,i,s,a);return e.makeTensorInfo([o.length],a,o)},Y5e={kernelName:IV,backendName:"webgl",kernelFunc:Due};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z5e="return 1.0 / x;",Q5e=Wn({opSnippet:Z5e}),J5e={kernelName:xT,backendName:"webgl",kernelFunc:Q5e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eHe=Ql+`
  return (x < 0.0) ? 0.0 : x;
`,tHe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,nHe=Wn({opSnippet:eHe,packedOpSnippet:tHe}),rHe={kernelName:bT,backendName:"webgl",kernelFunc:nHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iHe=Ql+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,sHe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,aHe=Wn({opSnippet:iHe,packedOpSnippet:sHe}),oHe={kernelName:wT,backendName:"webgl",kernelFunc:aHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lHe{constructor(e,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,n,r,c];const u=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cHe{constructor(e,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,n,r,c];const u=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r];let h;s?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uHe(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,c]=o,u=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new cHe(i.shape,l,c,s,a):new lHe(i.shape,l,c,s,a);return n.runWebGLProgram(u,[i],"float32")}const dHe={kernelName:tR,backendName:"webgl",kernelFunc:uHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hHe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=e,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],c=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${i-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${s-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fHe(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:s}=e,{alignCorners:a}=r,o=new hHe(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const pHe={kernelName:RV,backendName:"webgl",kernelFunc:fHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mHe{constructor(e,n,r,i,s){this.variableNames=["A"],this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,n,r,c];const u=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let f;s?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${o}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gHe{constructor(e,n,r,i,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[a,o,l,c]=e;this.outputShape=[a,n,r,c];const u=[i&&n>1?o-1:o,i&&r>1?l-1:l],d=[i&&n>1?n-1:n,i&&r>1?r-1:r],h=i?"0.5":"0.0";let f;s?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${o}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yHe(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:s,halfPixelCenters:a,size:o}=r,[l,c]=o,u=Me().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new gHe(i.shape,l,c,s,a):new mHe(i.shape,l,c,s,a);return n.runWebGLProgram(u,[i],i.dtype)}const vHe={kernelName:eR,backendName:"webgl",kernelFunc:yHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xHe{constructor(e,n,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,i,s]=n,[,a,o]=e,l=[r&&a>1?i-1:i,r&&o>1?s-1:s],c=[r&&a>1?a-1:a,r&&o>1?o-1:o],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,g=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${g});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${a}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${o}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${i}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bHe(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:s}=e,{alignCorners:a}=r,o=new xHe(s.shape,i.shape,a);return n.runWebGLProgram(o,[s],s.dtype)}const wHe={kernelName:MV,backendName:"webgl",kernelFunc:bHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SHe{constructor(e,n){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const i=o=>n.indexOf(o)!==-1&&e[o]!==1?`${e[o]} - coords[${o}] - 1`:`coords[${o}]`,s=e.map((o,l)=>i(l)).join(","),a=gr(r);this.userCode=`
      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${s}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _He{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const i=fa("rc",r),s=`${i[r-1]} + 1 < ${this.outputShape[r-1]}`,a=`${i[r-2]} + 1 < ${this.outputShape[r-2]}`,o=gr(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${s}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${o} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(i.slice())};
          if(${s}){
            result.g = ${c(i.slice())};
          }
          if(${a}) {
            result.b = ${u(i.slice())};
            if(${s}) {
              result.a = ${d(i.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[r-1]="("+p[r-1]+" + 1)",h(p)}function u(p){return p[r-2]="("+p[r-2]+" + 1)",h(p)}function d(p){return p[r-1]="("+p[r-1]+" + 1)",p[r-2]="("+p[r-2]+" + 1)",h(p)}function h(p){const g=e.map((x,b)=>f(b,p)),m=g.join(","),y=g.slice(-2).join(",");return`getChannel(getX(${m}), vec2(${y}))`}function f(p,g){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${g[p]} - 1`:`${g[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function THe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:s}=r,a=i.shape.length,o=Nn(s,i.shape);if(a===0)return So({inputs:{x:i},backend:n});const l=Me().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new _He(i.shape,o):new SHe(i.shape,o);return n.runWebGLProgram(l,[i],i.dtype)}const EHe={kernelName:nR,backendName:"webgl",kernelFunc:THe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CHe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],i=e[2];this.outputShape=e;let s="";typeof n=="number"?s=`float outputValue = ${n.toFixed(2)};`:s=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${s}
          if(coordX >= 0 && coordX < ${i} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NHe={kernelName:KV,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:s,center:a}=e,o=n,l=new CHe(r.shape,s),[c,u]=n5(a,r.shape[1],r.shape[2]),d=[[c,u,Math.sin(i),Math.cos(i)]];return o.runWebGLProgram(l,[r],r.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AHe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,IHe=Wn({opSnippet:AHe}),kHe={kernelName:ST,backendName:"webgl",kernelFunc:IHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MHe="return inversesqrt(x);",RHe=Wn({opSnippet:MHe,cpuKernelImpl:Hje}),PHe={kernelName:_T,backendName:"webgl",kernelFunc:RHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P5{constructor(e,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=a;const c=gr(s.length),u=gr(a.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";i===1?f="i":i===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,y=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${y};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${m}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OHe{constructor(e,n,r,i,s,a,o=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=a;const c=gr(s.length),u=gr(a.length);let d="";r===1?d="i":r===2&&(d="i, j");const h=`getIndices(${d})`;let f="";i===1?f="i":i===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let g="";l&&(g="coords[0], coords[1]");const m=`getDefaultValue(${g})`,y=n>1?"strides[j]":"strides",x=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${s});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${y};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${x};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${m}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DHe(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:s}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Qg(s,i,a),h=[d/c,c];if(d===0)return n.makeTensorInfo(a,i.dtype);const f=st({inputs:{x:i},backend:n,attrs:{shape:[l,o]}}),p=st({inputs:{x:s},backend:n,attrs:{shape:[l,c]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0]));let m;Me().getBool("WEBGL_PACK")?m=new OHe(l,o,f.shape.length,p.shape.length,u,h):m=new P5(l,o,f.shape.length,p.shape.length,u,h);const y=n.runWebGLProgram(m,[p,f,g],p.dtype),x=st({inputs:{x:y},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),x}const $He={kernelName:PV,backendName:"webgl",kernelFunc:DHe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LHe{constructor(e,n,r,i){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const s="while (left < right) {",a=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,o=Me().getNumber("WEBGL_VERSION")===2?s:a,l=i==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${o}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FHe(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:s}=e,{side:a}=r,o=new LHe(i.shape[0],i.shape[1],s.shape[1],a),l=[[i.shape[1]]];return n.runWebGLProgram(o,[i,s],"int32",l)}const jHe={kernelName:DV,backendName:"webgl",kernelFunc:FHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zHe{constructor(e,n,r){this.variableNames=["c","a","b"],this.outputShape=n;let i,s;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)s="resRC",i="resRC";else{const o=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${o[u]}`),u<e&&l.push(`${o[u]}`);i=l.join(),s=c.join()}const a=gr(r);this.userCode=`
      void main() {
        ${a} resRC = getOutputCoords();
        float cVal = getC(${i});
        if (cVal >= 1.0) {
          setOutput(getA(${s}));
        } else {
          setOutput(getB(${s}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BHe(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:s}=e,a=new zHe(r.shape.length,i.shape,i.shape.length);return n.runWebGLProgram(a,[r,i,s],bo(i.dtype,s.dtype))}const UHe={kernelName:rR,backendName:"webgl",kernelFunc:BHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VHe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${FR};
  float scale = ${jR};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,WHe=Wn({opSnippet:VHe}),HHe={kernelName:TT,backendName:"webgl",kernelFunc:WHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GHe=ab+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,qHe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XHe=Wn({opSnippet:GHe,packedOpSnippet:qHe,cpuKernelImpl:qje}),KHe={kernelName:AT,backendName:"webgl",kernelFunc:XHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YHe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ZHe=Wn({opSnippet:YHe}),QHe={kernelName:NT,backendName:"webgl",kernelFunc:ZHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JHe=ab+`
  return sin(x);
`,eGe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${ty}
  return result;
`,tGe=Wn({opSnippet:JHe,packedOpSnippet:eGe}),nGe={kernelName:ET,backendName:"webgl",kernelFunc:tGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rGe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,iGe=Wn({opSnippet:rGe}),sGe={kernelName:CT,backendName:"webgl",kernelFunc:iGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aGe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,oGe=Wn({opSnippet:aGe}),lGe={kernelName:IT,backendName:"webgl",kernelFunc:oGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cGe=t=>{const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:s,paddings:a}=r;q(i.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const o=s.reduce((y,x)=>y*x),l=[[0,0]];l.push(...a);for(let y=1+s.length;y<i.shape.length;++y)l.push([0,0]);const c=[],u=Oue({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),d=HT(u.shape,s,o,!1),h=GT(d.length,s.length,!1),f=qT(u.shape,s,o,!1),p=st({inputs:{x:u},backend:n,attrs:{shape:d}}),g=xa({inputs:{x:p},backend:n,attrs:{perm:h}}),m=st({inputs:{x:g},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(g),c.forEach(y=>n.disposeIntermediateTensorInfo(y)),m},uGe={kernelName:aR,backendName:"webgl",kernelFunc:cGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dGe(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:s,defaultValue:a}=e;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.readSync(r.dataId),l=n.readSync(i.dataId),c=n.readSync(s.dataId),u=n.readSync(a.dataId)[0],[d,h,f,p,g]=Kje(o,r.shape,r.dtype,l,i.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const hGe={kernelName:$V,backendName:"webgl",kernelFunc:dGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fGe(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:s}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.readSync(i.dataId)),o=n.readSync(r.dataId),l=Array.from(n.readSync(s.dataId)),[c,u,d]=Yje(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}const pGe={kernelName:LV,backendName:"webgl",kernelFunc:fGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mGe(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[c,u]=sue(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const gGe={kernelName:FV,backendName:"webgl",kernelFunc:mGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yGe(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${s.shape}`);const a=n.readSync(r.dataId),o=n.readSync(i.dataId),l=n.readSync(s.dataId),[c,u]=sue(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}const vGe={kernelName:jV,backendName:"webgl",kernelFunc:yGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xGe(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:s,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Qg(s,i,o),f=!1;if(s.dtype==="string"){const y=n.bufferSync(i),x=n.bufferSync(s),b=Vf(n.readSync(a.dataId)[0]),_=Gje(y,x,o,h,u,c,l,d,b,f);return n.makeTensorInfo(o,_.dtype,_.values)}const p=new P5(c,l,i.shape.length,s.shape.length,d,[h,1],f),g=n.runWebGLProgram(p,[s,i,a],s.dtype),m=st({inputs:{x:g},backend:n,attrs:{shape:o}});return n.disposeIntermediateTensorInfo(g),m}const bGe={kernelName:zV,backendName:"webgl",kernelFunc:xGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:s,axis:a}=r,o=Nn(a,i.shape)[0],l=y5(i,s,o),c=i.shape.length,u=new Array(c).fill(0),d=i.shape.slice();return l.map(h=>{const f=[...d];f[o]=h;const p=ob({inputs:{x:i},backend:n,attrs:{begin:u,size:f}});return u[o]+=h,p})}const SGe={kernelName:oR,backendName:"webgl",kernelFunc:wGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX="return sqrt(x);",_Ge=Wn({opSnippet:sX,packedOpSnippet:sX,cpuKernelImpl:Zje}),TGe={kernelName:kT,backendName:"webgl",kernelFunc:_Ge};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EGe="return x * x;",CGe=Wn({opSnippet:EGe}),NGe={kernelName:BV,backendName:"webgl",kernelFunc:CGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX="return (a - b) * (a - b);",AGe=Rs({opSnippet:aX,packedOpSnippet:aX}),IGe={kernelName:MT,backendName:"webgl",kernelFunc:AGe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;if(i.dtype!=="string")throw new Error("Input must be of datatype string");const s=n.readSync(i.dataId),a=sh(s),o=Qje(a,"string",r);return n.makeTensorInfo(i.shape,"string",o)}const MGe={kernelName:cR,backendName:"webgl",kernelFunc:kGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RGe({inputs:t,attrs:e,backend:n}){const{x:r}=t,i=Ql+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,s=new Nu(r.shape,i);return n.runWebGLProgram(s,[r],r.dtype)}const PGe={kernelName:$T,backendName:"webgl",kernelFunc:RGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OGe{constructor(e,n,r){this.variableNames=["x"],this.outputShape=r;const i=r.length,s=gr(r.length),a=gr(r.length);let o="";if(i===1)o="coords * strides + begin";else{let l=0;o=r.map((c,u)=>(l++,r.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${s} begin = ${s}(${e});
      ${s} strides = ${s}(${n});

      void main() {
        ${a} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DGe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:s,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r,{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:x,end:b,strides:_}=JW(i.shape,s,a,o,l,c,u,d,h);let T;if(g)T=st({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||y){q(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const C=YW(x,b,_),I=ob({inputs:{x:i},backend:n,attrs:{begin:x,size:C}});T=st({inputs:{x:I},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([i])){const I=n.readSync(i.dataId),A=yn(i.shape,i.dtype,I),k=Jje(f,A,_,x);T=n.makeTensorInfo(p,i.dtype,k.values)}else{const I=new OGe(x,_,f);T=n.runWebGLProgram(I,[i],i.dtype)}const E=st({inputs:{x:T},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(T),E}const $Ge={kernelName:UV,backendName:"webgl",kernelFunc:DGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LGe(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,g]=eze(h,f,i,s,a,o,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const FGe={kernelName:VV,backendName:"webgl",kernelFunc:LGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jGe(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:s,delimiter:a}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.readSync(s.dataId),l=n.readSync(a.dataId)[0],[c,u,d]=tze(o,l,i),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const zGe={kernelName:WV,backendName:"webgl",kernelFunc:jGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BGe(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.readSync(s.dataId),o=nze(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const UGe={kernelName:HV,backendName:"webgl",kernelFunc:BGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VGe="return tan(x);",WGe=Wn({opSnippet:VGe}),HGe={kernelName:PT,backendName:"webgl",kernelFunc:WGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GGe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,qGe=Wn({opSnippet:GGe}),XGe={kernelName:OT,backendName:"webgl",kernelFunc:qGe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KGe(t){const{inputs:e,backend:n,attrs:r}=t,{tensor:i,indices:s,updates:a}=e,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Qg(a,s,i.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(i.shape,s.dtype);const f=st({inputs:{x:s},backend:n,attrs:{shape:[l,o]}}),p=st({inputs:{x:a},backend:n,attrs:{shape:[l,c]}}),g=st({inputs:{x:i},backend:n,attrs:{shape:h}}),m=new P5(l,o,f.shape.length,p.shape.length,u,h,!1,!0),y=n.runWebGLProgram(m,[p,f,g],g.dtype),x=st({inputs:{x:y},backend:n,attrs:{shape:i.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),x}const YGe={kernelName:OV,backendName:"webgl",kernelFunc:KGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZGe{constructor(e,n){this.variableNames=["A"];const r=new Array(e.length);for(let a=0;a<r.length;a++)r[a]=e[a]*n[a];this.outputShape=r,this.rank=r.length;const i=gr(this.rank),s=QGe(e);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        setOutput(getA(${s}));
      }
    `}}function QGe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let i=0;i<t.length;i++)r.push(`imod(${n[i]}, ${t[i]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:s}=r;if(i.dtype==="string"||i.shape.length>5){const l=n.readSync(i.dataId),c=i.dtype==="string"?l.map(h=>Vf(h)):l,u=yn(i.shape,i.dtype,c),d=ize(u,s);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const a=new ZGe(i.shape,s);return n.runWebGLProgram(a,[i],i.dtype)}const JGe={kernelName:DT,backendName:"webgl",kernelFunc:$ue};class e6e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class t6e{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function oX(t){let e=1;for(;e<t;)e*=2;return e}function n6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:s,sorted:a}=r,o=Me().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=Me().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=i.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([i])||u<o||s>l){const k=n.readSync(i.dataId),[R,$]=sze(k,c,i.dtype,s,a);return[n.makeTensorInfo(R.shape,R.dtype,R.values),n.makeTensorInfo($.shape,$.dtype,$.values)]}if(s===0)return c[c.length-1]=0,[n.makeTensorInfo(c,i.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[i,QT({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(i.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(i):i,g=Oe(c)/u,m=st({inputs:{x:f},attrs:{shape:[g,u]},backend:n});h&&Hp(n,f);const y=oX(s),x=oX(u);let b=null;const _=()=>b===null?[m,m]:[m,b],T=(k,R,$)=>{const z=_(),O=new e6e($),B=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[k],[R]],W=b;b=n.runWebGLProgram(O,z,"int32",B),Hp(n,W)};for(let k=1;k<y;k*=2){const R=k*2;for(let $=k;$>=1;$/=2)T(R,$,[g,x])}for(let k=x;k>y;k/=2){const R=_(),$=new t6e([g,k/2]),O=[[u],[b===null?1:0],[y]],j=b;b=n.runWebGLProgram($,R,"int32",O),Hp(n,j);const B=y/2,W=B*2;for(let L=B;L>=1;L/=2)T(W,L,b.shape)}let E=b;b=ob({inputs:{x:b},backend:n,attrs:{begin:0,size:[g,s]}}),Hp(n,E);let C=Aue({inputs:{x:m,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Hp(n,m);const I=c.slice(0,-1);I.push(s),E=b,b=st({inputs:{x:b},attrs:{shape:I},backend:n}),Hp(n,E);const A=C;return C=st({inputs:{x:C},attrs:{shape:I},backend:n}),Hp(n,A),[C,b]}const r6e={kernelName:GV,backendName:"webgl",kernelFunc:n6e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i6e{constructor(e,n,r,i,s,a){this.variableNames=["Image","Transforms"],this.outputShape=a;const o=r==="nearest"?1:2;let l;switch(i){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${s});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${s});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${o} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6e(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,transforms:s}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=r,[u,d,h,f]=i.shape,[p,g]=c??[d,h],m=[u,p,g,f],y=new i6e(d,h,a,o,l,m);return n.runWebGLProgram(y,[i,s],"float32")}const a6e={kernelName:qV,backendName:"webgl",kernelFunc:s6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6e(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:s}=e;KT(s,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const a=r.readSync(s.dataId),{outputValues:o,outputShape:l,indices:c}=aze(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const l6e={kernelName:XV,backendName:"webgl",kernelFunc:o6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6e(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i,o=a.shape.length,l=i.shape[s],c=new Array(o-1);let u=0;for(let g=0;g<o;g++)g!==s&&(c[u++]=a.shape[g]);const d=[],h=new Array(o).fill(0),f=a.shape.slice();f[s]=1;const p=new Array(l);for(let g=0;g<p.length;g++){h[s]=g;const m=ob({inputs:{x:a},backend:n,attrs:{begin:h,size:f}}),y=st({inputs:{x:m},backend:n,attrs:{shape:c}});p[g]=y,d.push(m)}return d.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const u6e={kernelName:uR,backendName:"webgl",kernelFunc:c6e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d6e{constructor(e,n){this.variableNames=["x","segmentIds"];const r=e.windowSize,i=e.batchSize,s=e.inSize,a=e.numSegments,o=a*Math.ceil(s/r);this.outputShape=[i,o];const l="0.0",c="sumValue",u=Math.floor(r/4)*4,d=r%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";s%r>0&&(f=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return initializationValue;
        }
      `);let p="";s%r>0&&(p=`
        if (inIdx < 0 || inIdx >= ${s}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${a})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${a})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6e(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:s}=e,{numSegments:a}=r,o=i.shape.length,l=[];let c=0;const u=Jr([c],o);let d=i;u!=null&&(d=xa({inputs:{x:i},backend:n,attrs:{perm:u}}),l.push(d),c=wi(1,o)[0]);const h=Yle(d.shape,c,a),f=Oe([d.shape[c]]),p=st({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const g=ZV(i.dtype),m=(_,T,E,C,I)=>{const A=_.shape[0],k=_.shape[1],R=Kle(k,I),$={windowSize:R,inSize:k,batchSize:A,numSegments:I},z=new d6e($,T),O=n.compileAndRun(z,[_,E],C);if(l.push(O),O.shape[1]===I)return O;const j=Due({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),B=$ue({inputs:{x:j},backend:n,attrs:{reps:[k/R]}});return l.push(j),l.push(B),m(O,T,B,C,I)},y=m(p,"unsortedSegmentSum",s,g,a),x=st({inputs:{x:y},backend:n,attrs:{shape:h}});let b=x;if(u!=null){l.push(x);const _=gp(u);b=xa({inputs:{x:b},backend:n,attrs:{perm:_}})}return l.forEach(_=>n.disposeIntermediateTensorInfo(_)),b}const f6e={kernelName:dR,backendName:"webgl",kernelFunc:h6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p6e=[Zze,Jze,n4e,s4e,o4e,u4e,h4e,p4e,v4e,b4e,_4e,C4e,I4e,P4e,$4e,F4e,z4e,W4e,G4e,X4e,Q4e,sBe,oBe,dBe,fBe,xBe,wBe,EBe,Oze,ABe,PBe,LBe,VBe,GBe,XBe,YBe,QBe,nUe,sUe,lUe,uUe,hUe,pUe,yUe,xUe,_Ue,EUe,AUe,MUe,PUe,LUe,BUe,HUe,XUe,ZUe,QUe,eVe,nVe,iVe,aVe,lVe,hVe,mVe,vVe,bVe,_Ve,CVe,kVe,OVe,Pze,$Ve,MBe,jVe,UVe,HVe,$ze,KVe,JVe,tWe,sWe,lWe,hWe,mWe,xWe,_We,CWe,AWe,RWe,OWe,$We,zWe,UWe,WWe,GWe,XWe,QWe,n5e,a5e,p5e,jze,v5e,w5e,T5e,N5e,mBe,k5e,R5e,O5e,L5e,B5e,Fze,V5e,H5e,q5e,K5e,Y5e,gBe,u5e,J5e,rHe,oHe,Bze,dHe,pHe,vHe,wHe,EHe,NHe,kHe,PHe,$He,jHe,UHe,HHe,KHe,QHe,nGe,sGe,rBe,h5e,lGe,uGe,hGe,pGe,gGe,vGe,bGe,SGe,TGe,NGe,IGe,MGe,PGe,$Ge,FGe,zGe,UGe,d5e,Xze,HGe,XGe,YGe,JGe,r6e,a6e,Kze,l6e,u6e,f6e,M5e];for(const t of p6e)yae(t);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m6e=Me();m6e.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var no;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(no||(no={}));var lX;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(lX||(lX={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g6e={};function Lue(t){return g6e[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F(t,e,n,r,i){const s=e.inputParams[t];if(s&&s.inputIndexStart!==void 0){const o=s.inputIndexStart,l=s.inputIndexEnd===0?void 0:s.inputIndexEnd===void 0?o+1:s.inputIndexEnd,c=o<0?e.inputNames.length+o:o;if(s.type==="tensor")return Cs(e.inputNames[c],n,r,i);if(s.type==="tensors"){const h=e.inputs.slice(o,l);return e.inputNames.slice(o,l).filter((p,g)=>{var m;return((m=h[g])===null||m===void 0?void 0:m.op)!=="NoOp"}).map(p=>Cs(p,n,r,i))}const u=Cs(e.inputNames[c],n,r,i),d=u.dataSync();return s.type==="number"?d[0]:zl(u.shape,d)}const a=e.attrParams[t];return a&&a.value}function Cs(t,e,n,r){const[i,s]=io(t,n);if(r!=null){const o=r.getHashTableHandleByName(i);if(o!=null)return o}const a=n.currentContextIds.find(o=>!!e[ZA(i,o)]);return a!==void 0?e[ZA(i,a)][s]:void 0}function cX(t,e,n){return e[ZA(t,n.currentContextId)]}function Cd(t,e){const[n,r,i]=io(t,e);return[ZA(n,e&&e.currentContextId),r,i]}function ZA(t,e){return e?`${t}-${e}`:t}function io(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const s=e.parseNodeNameCache.get(t);if(s!=null)return s}const r=t.split(":");let i;if(r.length===1)i=[t,0,void 0];else{const s=r[0],a=r.length===3?r[1]:void 0,o=Number(r[r.length-1]);i=[s,o,a]}return n&&e.parseNodeNameCache.set(t,i),i}function V2(t,e,n){let r=F("pad",t,e,n);if(r==="explicit"){r=F("explicitPaddings",t,e,n);const i=[[0,0],[0,0],[0,0],[0,0]];for(let s=0;s<4;s++)i[s][0]=r[s*2],i[s][1]=r[s*2+1];return i}return r}function Nd(t){return t.kept?t:Wd(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y6e=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],v6e=Object.freeze(Object.defineProperty({__proto__:null,json:y6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x6e=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],b6e=Object.freeze(Object.defineProperty({__proto__:null,json:x6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w6e=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],S6e=Object.freeze(Object.defineProperty({__proto__:null,json:w6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _6e=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],T6e=Object.freeze(Object.defineProperty({__proto__:null,json:_6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E6e=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],C6e=Object.freeze(Object.defineProperty({__proto__:null,json:E6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N6e=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],A6e=Object.freeze(Object.defineProperty({__proto__:null,json:N6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I6e=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],k6e=Object.freeze(Object.defineProperty({__proto__:null,json:I6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M6e=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],R6e=Object.freeze(Object.defineProperty({__proto__:null,json:M6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6e=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],O6e=Object.freeze(Object.defineProperty({__proto__:null,json:P6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D6e=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],$6e=Object.freeze(Object.defineProperty({__proto__:null,json:D6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L6e=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],F6e=Object.freeze(Object.defineProperty({__proto__:null,json:L6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j6e=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],z6e=Object.freeze(Object.defineProperty({__proto__:null,json:j6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B6e=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],U6e=Object.freeze(Object.defineProperty({__proto__:null,json:B6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V6e=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],W6e=Object.freeze(Object.defineProperty({__proto__:null,json:V6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H6e=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],G6e=Object.freeze(Object.defineProperty({__proto__:null,json:H6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q6e=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],X6e=Object.freeze(Object.defineProperty({__proto__:null,json:q6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K6e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],Y6e=Object.freeze(Object.defineProperty({__proto__:null,json:K6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z6e=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],Q6e=Object.freeze(Object.defineProperty({__proto__:null,json:Z6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],e8e=Object.freeze(Object.defineProperty({__proto__:null,json:J6e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uX{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[v6e,b6e,S6e,T6e,C6e,A6e,k6e,R6e,O6e,$6e,F6e,z6e,U6e,W6e,G6e,X6e,Y6e,Q6e,e8e],n=[].concat(...e.map(r=>r.json));this.opMappers=n.reduce((r,i)=>(r[i.tfOpName]=i,r),{})}transformGraph(e,n={}){const r=e.node,i=[],s=[],a=[],o=r.reduce((g,m)=>(g[m.name]=this.mapNode(m),m.op.startsWith("Placeholder")?i.push(g[m.name]):m.op==="Const"?s.push(g[m.name]):(m.input==null||m.input.length===0)&&a.push(g[m.name]),g),{});let l=[];const c=[];let u={},d={};n!=null&&(u=this.mapSignatureEntries(n.inputs),d=this.mapSignatureEntries(n.outputs));const h=Object.keys(o);h.forEach(g=>{const m=o[g];m.inputNames.forEach((y,x)=>{const[b,,_]=Cd(y),T=o[b];if(T.outputs!=null){const E=T.outputs.indexOf(_);if(E!==-1){const C=`${b}:${E}`;m.inputNames[x]=C}}m.inputs.push(T),T.children.push(m)})}),Object.keys(d).length===0?h.forEach(g=>{const m=o[g];m.children.length===0&&c.push(m)}):Object.keys(d).forEach(g=>{const[m]=Cd(g),y=o[m];y!=null&&(y.signatureKey=d[g],c.push(y))}),Object.keys(u).length>0?Object.keys(u).forEach(g=>{const[m]=Cd(g),y=o[m];y&&(y.signatureKey=u[g],l.push(y))}):l=i;let f={};e.library!=null&&e.library.function!=null&&(f=e.library.function.reduce((g,m)=>(g[m.signature.name]=this.mapFunction(m),g),{}));const p={nodes:o,inputs:l,outputs:c,weights:s,placeholders:i,signature:n,functions:f};return a.length>0&&(p.initNodes=a),p}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,r)=>(n[e[r].name]=r,n),{})}mapNode(e){const n=Lue(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(i=>i.startsWith("^")?i.slice(1):i),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(r.inputParams=n.inputs.reduce((i,s)=>(i[s.name]={type:s.type,inputIndexStart:s.start,inputIndexEnd:s.end},i),{})),n.attrs!=null&&(r.attrParams=n.attrs.reduce((i,s)=>{const a=s.type;let o;switch(s.type){case"string":o=yj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=yj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"string[]":o=Tj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=Tj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number":o=xj(e.attr,s.tfName,s.defaultValue||0),o===void 0&&s.tfDeprecatedName&&(o=xj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"number[]":o=_j(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=_j(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool":o=vj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=vj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"bool[]":o=Cj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=Cj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape":o=Sj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=Sj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"shape[]":o=Ej(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=Ej(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype":o=bj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=bj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"dtype[]":o=wj(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=wj(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"func":o=dX(e.attr,s.tfName,s.defaultValue),o===void 0&&s.tfDeprecatedName&&(o=dX(e.attr,s.tfDeprecatedName,s.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${s.type} for op: ${e.op}`)}return i[s.name]={value:o,type:a},i},{})),r}mapFunction(e){const n=e.nodeDef,r=[],i=[];let s={};n!=null&&(s=n.reduce((d,h)=>(d[h.name]=this.mapNode(h),h.op==="Const"&&i.push(d[h.name]),d),{}));const a=[],o=[];e.signature.inputArg.forEach(d=>{const[h]=Cd(d.name),f={name:h,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:O5(d.type),type:"dtype"}},children:[]};f.signatureKey=d.name,a.push(f),s[h]=f}),Object.keys(s).forEach(d=>{const h=s[d];h.inputNames.forEach((f,p)=>{const[g,,m]=Cd(f),y=s[g];if(y.outputs!=null){const x=y.outputs.indexOf(m);if(x!==-1){const b=`${g}:${x}`;h.inputNames[p]=b}}h.inputs.push(y),y.children.push(h)})});const c=e.ret;e.signature.outputArg.forEach(d=>{const[h,f]=Cd(c[d.name]),p=s[h];p!=null&&(p.defaultOutput=f,o.push(p))});const u=this.mapArgsToSignature(e);return{nodes:s,inputs:a,outputs:o,weights:i,placeholders:r,signature:u}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r),n),{}),outputs:e.signature.outputArg.reduce((n,r)=>(n[r.name]=this.mapArgToTensorInfo(r,e.ret),n),{})}}mapArgToTensorInfo(e,n){let r=e.name;return n!=null&&(r=n[r]),{name:r,dtype:e.type}}}function t8e(t){const e=Me().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Fue(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):t8e(t);return e?n:n.toLowerCase()}function yj(t,e,n,r=!1){const i=t[e];return i!=null?Fue(i.s,r):n}function vj(t,e,n){const r=t[e];return r?r.b:n}function xj(t,e,n){const r=t[e]||{},i=r.i!=null?r.i:r.f!=null?r.f:n;return typeof i=="number"?i:parseInt(i,10)}function O5(t){switch(typeof t=="string"&&(t=no[t]),t){case no.DT_FLOAT:case no.DT_HALF:return"float32";case no.DT_INT32:case no.DT_INT64:case no.DT_INT8:case no.DT_UINT8:return"int32";case no.DT_BOOL:return"bool";case no.DT_DOUBLE:return"float32";case no.DT_STRING:return"string";case no.DT_COMPLEX64:case no.DT_COMPLEX128:return"complex64";default:return null}}function dX(t,e,n){const r=t[e];return r&&r.func?r.func.name:n}function bj(t,e,n){const r=t[e];return r&&r.type?O5(r.type):n}function wj(t,e,n){const r=t[e];return r&&r.list&&r.list.type?r.list.type.map(i=>O5(i)):n}function jue(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Sj(t,e,n){const r=t[e];return r&&r.shape?jue(r.shape):n}function _j(t,e,n){const r=t[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(i=>typeof i=="number"?i:parseInt(i,10)):n}function Tj(t,e,n,r=!1){const i=t[e];return i&&i.list&&i.list.s?i.list.s.map(s=>Fue(s,r)):n}function Ej(t,e,n){const r=t[e];return r&&r.list&&r.list.shape?r.list.shape.map(i=>jue(i)):n}function Cj(t,e,n){const r=t[e];return r&&r.list&&r.list.b?r.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n8e{constructor(e,n,r){this.node=e,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(i=>this.getInput(i)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((i,s)=>(i[s]=this.getAttr(s),i),{}))}getInput(e){return Cs(e,this.tensorMap,this.context)}getAttr(e,n){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Cs(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return xj(this.node.rawAttrs,e,n);if(r.s!=null)return yj(this.node.rawAttrs,e,n);if(r.b!=null)return vj(this.node.rawAttrs,e,n);if(r.shape!=null)return Sj(this.node.rawAttrs,e,n);if(r.type!=null)return bj(this.node.rawAttrs,e,n);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return _j(this.node.rawAttrs,e,n);if(r.list.s!=null)return Tj(this.node.rawAttrs,e,n);if(r.list.shape!=null)return Ej(this.node.rawAttrs,e,n);if(r.list.b!=null)return Cj(this.node.rawAttrs,e,n);if(r.list.type!=null)return wj(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ps=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:Lae,abs:Bi,acos:eoe,acosh:toe,add:He,addN:vke,all:tW,any:VA,argMax:wg,argMin:noe,asin:roe,asinh:ioe,atan:soe,atan2:aoe,atanh:ooe,avgPool:pR,avgPool3d:loe,basicLSTMCell:Bke,batchNorm:jT,batchNorm2d:coe,batchNorm3d:uoe,batchNorm4d:doe,batchToSpaceND:mR,bincount:hoe,bitwiseAnd:Yke,booleanMaskAsync:ROe,broadcastArgs:Qke,broadcastTo:sx,buffer:yn,cast:nt,ceil:foe,clipByValue:Ha,clone:Wd,complex:Wf,concat:Qr,concat1d:poe,concat2d:moe,concat3d:goe,concat4d:yoe,conv1d:rW,conv2d:qf,conv2dTranspose:sW,conv3d:voe,conv3dTranspose:boe,cos:gR,cosh:aW,cosineWindow:FW,cumprod:WA,cumsum:oW,denseBincount:lj,depthToSpace:woe,depthwiseConv2d:zT,diag:wMe,dilation2d:Soe,div:ct,divNoNan:_oe,dot:Toe,dropout:Yoe,einsum:gv,elu:BT,enclosingPowerOfTwo:Zoe,ensureShape:MMe,equal:Hc,erf:lW,euclideanNorm:Noe,exp:va,expandDims:Mi,expm1:Aoe,eye:uW,fft:kR,fill:K0,floor:VT,floorDiv:eW,fused:eDe,gather:WT,gatherND:UOe,greater:Co,greaterEqual:yp,ifft:eS,imag:yR,image:ma,inTopKAsync:GOe,irfft:RW,isFinite:Ioe,isInf:koe,isNaN:Moe,leakyRelu:vR,less:Z1,lessEqual:Kg,linalg:sle,linspace:rRe,localResponseNormalization:Roe,log:el,log1p:xR,logSigmoid:Poe,logSoftmax:dW,logSumExp:bR,logicalAnd:Gu,logicalNot:wR,logicalOr:hW,logicalXor:Ooe,losses:M$e,lowerBound:xRe,matMul:Mn,max:Bl,maxPool:SR,maxPool3d:Doe,maxPoolWithArgmax:_Re,maximum:vh,mean:ii,meshgrid:CRe,min:Y1,minimum:Xf,mirrorPad:pW,mod:$oe,moments:_R,movingAverage:DOe,mul:se,multiRNNCell:RRe,multinomial:ORe,neg:Dr,norm:UT,notEqual:Xx,oneHot:mW,ones:fo,onesLike:tl,op:ce,outerProduct:jRe,pad:Gc,pad1d:URe,pad2d:WRe,pad3d:GRe,pad4d:XRe,pool:Loe,pow:nh,prelu:ER,print:Jae,prod:Foe,raggedGather:nPe,raggedRange:iPe,raggedTensorToTensor:aPe,rand:lPe,randomGamma:APe,randomNormal:_W,randomStandardNormal:MPe,randomUniform:Zg,randomUniformInt:OPe,range:Kx,real:Q1,reciprocal:zoe,relu:rd,relu6:TW,reshape:de,reverse:ql,reverse1d:BPe,reverse2d:VPe,reverse3d:HPe,reverse4d:qPe,rfft:MR,round:EW,rsqrt:CW,scalar:It,scatterND:LOe,searchSorted:fW,selu:NW,separableConv2d:AW,setdiff1dAsync:JPe,sigmoid:Ko,sign:Boe,signal:k$e,sin:IW,sinh:kW,slice:Kt,slice1d:NR,slice2d:MW,slice3d:AR,slice4d:J1,softmax:IR,softplus:Y0,spaceToBatchND:TR,sparse:R$e,sparseToDense:zOe,spectral:I$e,split:vo,sqrt:Is,square:fr,squaredDifference:PW,squeeze:Yn,stack:wo,step:Z0,stridedSlice:Uoe,string:P$e,sub:ut,sum:Et,tan:Voe,tanh:_g,tensor:Fc,tensor1d:Oi,tensor2d:Ul,tensor3d:Woe,tensor4d:xOe,tensor5d:bOe,tensor6d:wOe,tensorScatterUpdate:_Oe,tile:Dl,topk:Goe,transpose:Ln,truncatedNormal:DW,unique:qoe,unsortedSegmentSum:$W,unstack:Xl,upperBound:IOe,variable:Xoe,where:Hs,whereAsync:Koe,zeros:Pi,zerosLike:Fn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r8e=(t,e,n,r=Ps)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(F("a",t,e,n),F("b",t,e,n))];case"AddN":return[r.addN(F("tensors",t,e,n))];case"FloorMod":case"Mod":return[r.mod(F("a",t,e,n),F("b",t,e,n))];case"Mul":return[r.mul(F("a",t,e,n),F("b",t,e,n))];case"RealDiv":case"Div":return[r.div(F("a",t,e,n),F("b",t,e,n))];case"DivNoNan":return[r.divNoNan(F("a",t,e,n),F("b",t,e,n))];case"FloorDiv":return[r.floorDiv(F("a",t,e,n),F("b",t,e,n))];case"Sub":return[r.sub(F("a",t,e,n),F("b",t,e,n))];case"Minimum":return[r.minimum(F("a",t,e,n),F("b",t,e,n))];case"Maximum":return[r.maximum(F("a",t,e,n),F("b",t,e,n))];case"Pow":return[r.pow(F("a",t,e,n),F("b",t,e,n))];case"SquaredDifference":return[r.squaredDifference(F("a",t,e,n),F("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8e=(t,e,n,r=Ps)=>{switch(t.op){case"Abs":case"ComplexAbs":return[r.abs(F("x",t,e,n))];case"Acos":return[r.acos(F("x",t,e,n))];case"Acosh":return[r.acosh(F("x",t,e,n))];case"Asin":return[r.asin(F("x",t,e,n))];case"Asinh":return[r.asinh(F("x",t,e,n))];case"Atan":return[r.atan(F("x",t,e,n))];case"Atan2":return[r.atan2(F("x",t,e,n),F("y",t,e,n))];case"Atanh":return[r.atanh(F("x",t,e,n))];case"Ceil":return[r.ceil(F("x",t,e,n))];case"Complex":return[r.complex(F("real",t,e,n),F("imag",t,e,n))];case"Cos":return[r.cos(F("x",t,e,n))];case"Cosh":return[r.cosh(F("x",t,e,n))];case"Elu":return[r.elu(F("x",t,e,n))];case"Erf":return[r.erf(F("x",t,e,n))];case"Exp":return[r.exp(F("x",t,e,n))];case"Expm1":return[r.expm1(F("x",t,e,n))];case"Floor":return[r.floor(F("x",t,e,n))];case"Log":return[r.log(F("x",t,e,n))];case"Log1p":return[r.log1p(F("x",t,e,n))];case"Imag":return[r.imag(F("x",t,e,n))];case"Neg":return[r.neg(F("x",t,e,n))];case"Reciprocal":return[r.reciprocal(F("x",t,e,n))];case"Real":return[r.real(F("x",t,e,n))];case"Relu":return[r.relu(F("x",t,e,n))];case"Round":return[r.round(F("x",t,e,n))];case"Selu":return[r.selu(F("x",t,e,n))];case"Sigmoid":return[r.sigmoid(F("x",t,e,n))];case"Sin":return[r.sin(F("x",t,e,n))];case"Sign":return[r.sign(F("x",t,e,n))];case"Sinh":return[r.sinh(F("x",t,e,n))];case"Softplus":return[r.softplus(F("x",t,e,n))];case"Sqrt":return[r.sqrt(F("x",t,e,n))];case"Square":return[r.square(F("x",t,e,n))];case"Tanh":return[r.tanh(F("x",t,e,n))];case"Tan":return[r.tan(F("x",t,e,n))];case"ClipByValue":return[r.clipByValue(F("x",t,e,n),F("clipValueMin",t,e,n),F("clipValueMax",t,e,n))];case"Relu6":return[r.relu6(F("x",t,e,n))];case"Rsqrt":return[r.rsqrt(Cs(t.inputNames[0],e,n))];case"LeakyRelu":return[r.leakyRelu(F("x",t,e,n),F("alpha",t,e,n))];case"Prelu":return[r.prelu(F("x",t,e,n),F("alpha",t,e,n))];case"IsNan":return[r.isNaN(Cs(t.inputNames[0],e,n))];case"IsInf":return[r.isInf(Cs(t.inputNames[0],e,n))];case"IsFinite":return[r.isFinite(Cs(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function El(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){q(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let r=0;r<t.length;r++){const i=t[r],s=e[r];q(i<0||s<0||i===s,()=>n+` Shapes ${t} and ${e} must match`)}}}function hX(t){return!(typeof t=="number"||t.some(e=>e<0))}function lw(t,e,n){let r=Nj(t,n);const i=!hX(r);if(i&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(i&&e.forEach(s=>{r=Nj(s.shape,r)}),!hX(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function Nj(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let r=0;r<t.length;++r){const i=t[r],s=e[r];if(i>=0&&s>=0&&i!==s)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[r]=i>=0?i:s}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class s8e{constructor(e,n,r,i,s,a,o){this.name=e,this.dtype=n,this.maxSize=r,this.elementShape=i,this.identicalElementShapes=s,this.dynamicSize=a,this.clearAfterRead=o,this.tensors=[],this.closed_=!1,this.idTensor=It(0),as(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),El(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=n,as(n),r.written=!0,this.tensors[e]=r}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((r,i)=>this.write(r,n[i]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let i=0;i<this.size();i++)e.push(i)}if(e.length===0)return Fc([],[0].concat(this.elementShape));const r=this.readMany(e);return El(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),wo(r,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return Fc([],[0].concat(this.elementShape));const n=[];for(let i=0;i<this.size();i++)n.push(i);const r=this.readMany(n);return El(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),Qr(r,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Xl(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let r=0;const i=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const s=r===0?0:n.size/r,a=[];ve(()=>{n=de(n,[1,r,s]);for(let l=0;l<e.length;++l){const u=[0,l===0?0:i[l-1],0],d=[1,e[l],s];a[l]=de(Kt(n,u,d),this.elementShape)}return a});const o=[];for(let l=0;l<e.length;l++)o[l]=l;this.writeMany(o,a)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ag{get id(){return this.idTensor.id}constructor(e,n,r,i=-1){this.tensors=e,this.elementShape=n,this.elementDtype=r,e!=null&&e.forEach(s=>{if(r!==s.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${s.dtype}`);El(n,s.shape,"TensorList shape mismatch: "),as(s)}),this.idTensor=It(0),this.maxNumElements=i,as(this.idTensor)}copy(){return new Ag([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,r=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);El(e,this.elementShape,"TensorList shape mismatch: ");const i=lw(this.elementShape,this.tensors,e);return ve(()=>{const s=this.tensors.map(a=>de(a,i));return wo(s,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=lw(this.elementShape,this.tensors,e),i=this.tensors.pop();return i.kept=!1,El(i.shape,e,"TensorList shape mismatch: "),de(i,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(El(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");as(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Ag([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)n.tensors[r]=this.tensors[r];return n}getItem(e,n,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);El(this.tensors[e].shape,n,"TensorList shape mismatch: ");const i=lw(this.elementShape,this.tensors,n);return de(this.tensors[e],i)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);El(this.elementShape,n.shape,"TensorList shape mismatch: "),as(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,r){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);El(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const i=lw(this.elementShape,this.tensors,r);return e.length===0?Fc([],[0].concat(i)):ve(()=>{const s=e.map(a=>de(this.tensors[a],i));return wo(s,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);El(this.elementShape,n,"TensorList shape mismatch: ");const r=lw(this.elementShape,this.tensors,n);return this.size()===0?Fc([],[0].concat(r)):ve(()=>{const i=this.tensors.map(s=>de(s,r));return Qr(i,0)})}}function a8e(t,e,n){const r=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const i=t.shape.slice(1);El(i,e,"TensorList shape mismatch: ");const s=Xl(t);return new Ag(s,e,r)}function o8e(t,e,n,r){return new Ag([],t,e,r)}function l8e(t,e,n,r){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const i=Math.max(...e);if(r!=null&&r!==-1&&i>=r)throw new Error(`Max index must be < array size (${i}  vs. ${r})`);const s=new Ag([],n,t.dtype,r),a=Xl(t,0);return e.forEach((o,l)=>{s.setItem(o,a[l])}),s}function c8e(t,e,n){let r=0;const i=e.map(u=>(r+=u,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);const s=t.shape.slice(1),a=Nj(s,n),o=r===0?0:t.size/r,l=ve(()=>{const u=[];t=de(t,[1,r,o]);for(let d=0;d<e.length;++d){const f=[0,d===0?0:i[d-1],0],p=[1,e[d],o];u[d]=de(Kt(t,f,p),a)}return t.dispose(),u}),c=new Ag([],n,t.dtype,e.length);for(let u=0;u<l.length;u++)c.setItem(u,l[u]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u8e=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const r=F("thenBranch",t,e,n),i=F("elseBranch",t,e,n),s=F("cond",t,e,n),a=F("args",t,e,n);return(await s.data())[0]?n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap):n.functionMap[i].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const r=F("body",t,e,n),i=F("cond",t,e,n),s=F("args",t,e,n),a=await n.functionMap[i].executeFunctionAsync(s,n.tensorArrayMap,n.tensorListMap),o=s.map(u=>u.id);let l=await a[0].data();a.forEach(u=>{!u.kept&&o.indexOf(u.id)===-1&&u.dispose()});let c=s;for(;l[0];){const u=c;c=await n.functionMap[r].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);const d=c.map(f=>f.id);u.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()});const h=await n.functionMap[i].executeFunctionAsync(c,n.tensorArrayMap,n.tensorListMap);l=await h[0].data(),h.forEach(f=>{!f.kept&&o.indexOf(f.id)===-1&&d.indexOf(f.id)===-1&&f.dispose()})}return c}case"LoopCond":{const r=F("pred",t,e,n);return[Nd(r)]}case"Switch":{const r=F("pred",t,e,n);let i=F("data",t,e,n);return i.kept||(i=Nd(i)),(await r.data())[0]?[void 0,i]:[i,void 0]}case"Merge":{const r=t.inputNames.find(i=>Cs(i,e,n)!==void 0);if(r){const i=Cs(r,e,n);return[Nd(i)]}return}case"Enter":{const r=F("frameName",t,e,n),i=F("tensor",t,e,n);return n.enterFrame(r),[Nd(i)]}case"Exit":{const r=F("tensor",t,e,n);return n.exitFrame(),[Nd(r)]}case"NextIteration":{const r=F("tensor",t,e,n);return n.nextIteration(),[Nd(r)]}case"TensorArrayV3":{const r=F("size",t,e,n),i=F("dtype",t,e,n),s=F("elementShape",t,e,n),a=F("dynamicSize",t,e,n),o=F("clearAfterRead",t,e,n),l=F("identicalElementShapes",t,e,n),c=F("name",t,e,n),u=new s8e(c,i,r,s,l,a,o);return n.addTensorArray(u),[u.idTensor,It(1)]}case"TensorArrayWriteV3":{const r=F("tensorArrayId",t,e,n),i=F("index",t,e,n),s=F("tensor",t,e,n),a=n.getTensorArray(r.id);return a.write(i,s),[a.idTensor]}case"TensorArrayReadV3":{const r=F("tensorArrayId",t,e,n),i=F("index",t,e,n);return[n.getTensorArray(r.id).read(i)]}case"TensorArrayGatherV3":{const r=F("tensorArrayId",t,e,n),i=F("indices",t,e,n),s=F("dtype",t,e,n);return[n.getTensorArray(r.id).gather(i,s)]}case"TensorArrayScatterV3":{const r=F("tensorArrayId",t,e,n),i=F("indices",t,e,n),s=F("tensor",t,e,n),a=n.getTensorArray(r.id);return a.scatter(i,s),[a.idTensor]}case"TensorArrayConcatV3":{const r=F("tensorArrayId",t,e,n),i=n.getTensorArray(r.id),s=F("dtype",t,e,n);return[i.concat(s)]}case"TensorArraySplitV3":{const r=F("tensorArrayId",t,e,n),i=F("tensor",t,e,n),s=F("lengths",t,e,n),a=n.getTensorArray(r.id);return a.split(s,i),[a.idTensor]}case"TensorArraySizeV3":{const r=F("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return[It(i.size(),"int32")]}case"TensorArrayCloseV3":{const r=F("tensorArrayId",t,e,n),i=n.getTensorArray(r.id);return i.clearAndClose(),[i.idTensor]}case"TensorListSetItem":{const r=F("tensorListId",t,e,n),i=F("index",t,e,n),s=F("tensor",t,e,n),a=n.getTensorList(r.id);return a.setItem(i,s),[a.idTensor]}case"TensorListGetItem":{const r=F("tensorListId",t,e,n),i=F("index",t,e,n),s=F("elementShape",t,e,n),a=F("elementDType",t,e,n);return[n.getTensorList(r.id).getItem(i,s,a)]}case"TensorListScatterV2":case"TensorListScatter":{const r=F("indices",t,e,n),i=F("tensor",t,e,n),s=F("elementShape",t,e,n),a=F("numElements",t,e,n),o=l8e(i,r,s,a);return n.addTensorList(o),[o.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=F("elementShape",t,e,n),i=F("elementDType",t,e,n);let s;t.op==="TensorListReserve"?s="numElements":s="maxNumElements";const a=F(s,t,e,n),o=t.op==="TensorListReserve"?-1:a,l=o8e(r,i,a,o);return n.addTensorList(l),[l.idTensor]}case"TensorListGather":{const r=F("tensorListId",t,e,n),i=F("indices",t,e,n),s=F("elementShape",t,e,n),a=F("elementDType",t,e,n);return[n.getTensorList(r.id).gather(i,a,s)]}case"TensorListStack":{const r=F("tensorListId",t,e,n),i=F("elementShape",t,e,n),s=F("elementDType",t,e,n),a=F("numElements",t,e,n);return[n.getTensorList(r.id).stack(i,s,a)]}case"TensorListFromTensor":{const r=F("tensor",t,e,n),i=F("elementShape",t,e,n),s=F("elementDType",t,e,n),a=a8e(r,i,s);return n.addTensorList(a),[a.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=F("tensorListId",t,e,n),i=n.getTensorList(r.id),s=F("dtype",t,e,n),a=F("elementShape",t,e,n);return[i.concat(s,a)]}case"TensorListPushBack":{const r=F("tensorListId",t,e,n),i=F("tensor",t,e,n),s=n.getTensorList(r.id);return s.pushBack(i),[s.idTensor]}case"TensorListPopBack":{const r=F("tensorListId",t,e,n),i=F("elementShape",t,e,n),s=F("elementDType",t,e,n);return[n.getTensorList(r.id).popBack(i,s)]}case"TensorListSplit":{const r=F("tensor",t,e,n),i=F("elementShape",t,e,n),s=F("lengths",t,e,n),a=c8e(r,s,i);return n.addTensorList(a),[a.idTensor]}case"TensorListLength":{const r=F("tensorListId",t,e,n),i=n.getTensorList(r.id);return[It(i.size(),"int32")]}case"TensorListResize":{const r=F("tensorListId",t,e,n),i=F("size",t,e,n),a=n.getTensorList(r.id).resize(i);return n.addTensorList(a),[a.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fX(t,e,n){const[r,i]=F("fusedOps",t,e,n),s=r==="biasadd",a=!s,o=i==="prelu",l=r==="fusedbatchnorm",c=F("numArgs",t,e,n);if(s){if(o&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&s&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(l)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const u=F("strides",t,e,n),d=V2(t,e,n),h=F("dataFormat",t,e,n).toUpperCase(),f=F("dilations",t,e,n);let[p,g]=F("args",t,e,n);a&&(g=p,p=void 0);const m=F("leakyreluAlpha",t,e,n);return{stride:u,pad:d,dataFormat:h,dilations:f,biasArg:p,preluArg:g,activationFunc:i,leakyreluAlpha:m}}const d8e=(t,e,n,r=Ps)=>{switch(t.op){case"Conv1D":{const i=F("stride",t,e,n),s=F("pad",t,e,n),a=F("dataFormat",t,e,n).toUpperCase(),o=F("dilation",t,e,n);return[r.conv1d(F("x",t,e,n),F("filter",t,e,n),i,s,a,o)]}case"Conv2D":{const i=F("strides",t,e,n),s=V2(t,e,n),a=F("dataFormat",t,e,n).toUpperCase(),o=F("dilations",t,e,n);return[r.conv2d(F("x",t,e,n),F("filter",t,e,n),[i[1],i[2]],s,a,[o[1],o[2]])]}case"_FusedConv2D":{const{stride:i,pad:s,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=fX(t,e,n);return[r.fused.conv2d({x:F("x",t,e,n),filter:F("filter",t,e,n),strides:[i[1],i[2]],pad:s,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"FusedDepthwiseConv2dNative":{const{stride:i,pad:s,dataFormat:a,dilations:o,biasArg:l,preluArg:c,activationFunc:u,leakyreluAlpha:d}=fX(t,e,n);return[r.fused.depthwiseConv2d({x:F("x",t,e,n),filter:F("filter",t,e,n),strides:[i[1],i[2]],pad:s,dataFormat:a,dilations:[o[1],o[2]],bias:l,activation:u,preluActivationWeights:c,leakyreluAlpha:d})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const i=F("outputShape",t,e,n),s=F("strides",t,e,n),a=V2(t,e,n);return[r.conv2dTranspose(F("x",t,e,n),F("filter",t,e,n),i,[s[1],s[2]],a)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const i=F("strides",t,e,n),s=V2(t,e,n),a=F("dilations",t,e,n),o=F("dataFormat",t,e,n).toUpperCase();return[r.depthwiseConv2d(F("input",t,e,n),F("filter",t,e,n),[i[1],i[2]],s,o,[a[1],a[2]])]}case"Conv3D":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("dataFormat",t,e,n).toUpperCase(),o=F("dilations",t,e,n);return[r.conv3d(F("x",t,e,n),F("filter",t,e,n),[i[1],i[2],i[3]],s,a,[o[1],o[2],o[3]])]}case"AvgPool":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("kernelSize",t,e,n);return[r.avgPool(F("x",t,e,n),[a[1],a[2]],[i[1],i[2]],s)]}case"MaxPool":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("kernelSize",t,e,n);return[r.maxPool(F("x",t,e,n),[a[1],a[2]],[i[1],i[2]],s)]}case"MaxPoolWithArgmax":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("kernelSize",t,e,n),o=F("includeBatchInIndex",t,e,n),{result:l,indexes:c}=r.maxPoolWithArgmax(F("x",t,e,n),[a[1],a[2]],[i[1],i[2]],s,o);return[l,c]}case"AvgPool3D":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("kernelSize",t,e,n);return[r.avgPool3d(F("x",t,e,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],s)]}case"MaxPool3D":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("kernelSize",t,e,n);return[r.maxPool3d(F("x",t,e,n),[a[1],a[2],a[3]],[i[1],i[2],i[3]],s)]}case"Dilation2D":{const i=F("strides",t,e,n),s=F("pad",t,e,n),a=F("dilations",t,e,n),o=i[1],l=i[2],c=a[1],u=a[2];return[r.dilation2d(F("x",t,e,n),F("filter",t,e,n),[o,l],s,[c,u],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h8e=(t,e,n,r=Ps)=>{switch(t.op){case"Fill":{const i=F("shape",t,e,n),s=F("dtype",t,e,n),a=F("value",t,e,n);return[r.fill(i,a,s)]}case"LinSpace":{const i=F("start",t,e,n),s=F("stop",t,e,n),a=F("num",t,e,n);return[r.linspace(i,s,a)]}case"Multinomial":{const i=F("logits",t,e,n),s=F("numSamples",t,e,n),a=F("seed",t,e,n);return[r.multinomial(i,s,a)]}case"OneHot":{const i=F("indices",t,e,n),s=F("depth",t,e,n),a=F("onValue",t,e,n),o=F("offValue",t,e,n),l=F("dtype",t,e,n);return[r.oneHot(i,s,a,o,l)]}case"Ones":return[r.ones(F("shape",t,e,n),F("dtype",t,e,n))];case"OnesLike":return[r.onesLike(F("x",t,e,n))];case"RandomStandardNormal":return[r.randomStandardNormal(F("shape",t,e,n),F("dtype",t,e,n),F("seed",t,e,n))];case"RandomUniform":return[r.randomUniform(F("shape",t,e,n),F("minval",t,e,n),F("maxval",t,e,n),F("dtype",t,e,n))];case"RandomUniformInt":return[r.randomUniformInt(F("shape",t,e,n),F("minval",t,e,n),F("maxval",t,e,n),F("seed",t,e,n))];case"Range":{const i=F("start",t,e,n),s=F("stop",t,e,n),a=F("step",t,e,n);return[r.range(i,s,a,F("dtype",t,e,n))]}case"TruncatedNormal":{const i=F("shape",t,e,n),s=F("mean",t,e,n),a=F("stdDev",t,e,n),o=F("seed",t,e,n);return[r.truncatedNormal(i,s,a,F("dtype",t,e,n),o)]}case"Zeros":return[r.zeros(F("shape",t,e,n),F("dtype",t,e,n))];case"ZerosLike":return[r.zerosLike(F("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B$(t,e,n){const r=F("boxes",t,e,n),i=F("scores",t,e,n),s=F("maxOutputSize",t,e,n),a=F("iouThreshold",t,e,n),o=F("scoreThreshold",t,e,n),l=F("softNmsSigma",t,e,n);return{boxes:r,scores:i,maxOutputSize:s,iouThreshold:a,scoreThreshold:o,softNmsSigma:l}}const f8e=async(t,e,n,r,i=Ps)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:s,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=B$(t,e,n),d=await i.image.nonMaxSuppressionWithScoreAsync(s,a,o,l,c,u);return[d.selectedIndices,d.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:s,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=B$(t,e,n),u=F("padToMaxOutputSize",t,e,n),d=await i.image.nonMaxSuppressionPaddedAsync(s,a,o,l,c,u);return[d.selectedIndices,d.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:s,scores:a,maxOutputSize:o,iouThreshold:l,scoreThreshold:c}=B$(t,e,n);return[await i.image.nonMaxSuppressionAsync(s,a,o,l,c)]}case"Where":{const s=i.cast(F("condition",t,e,n),"bool"),a=[await i.whereAsync(s)];return s.dispose(),a}case"ListDiff":return i.setdiff1dAsync(F("x",t,e,n),F("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p8e=(t,e,n,r=Ps)=>{switch(t.op){case"LowerBound":{const i=F("sortedSequence",t,e,n),s=F("values",t,e,n);return[r.lowerBound(i,s)]}case"TopKV2":{const i=F("x",t,e,n),s=F("k",t,e,n),a=F("sorted",t,e,n),o=r.topk(i,s,a);return[o.values,o.indices]}case"UpperBound":{const i=F("sortedSequence",t,e,n),s=F("values",t,e,n);return[r.upperBound(i,s)]}case"Unique":{const i=F("x",t,e,n),s=r.unique(i);return[s.values,s.indices]}case"UniqueV2":{const i=F("x",t,e,n),s=F("axis",t,e,n),a=r.unique(i,s);return[a.values,a.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m8e=(t,e,n,r=Ps)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const i=F("default",t,e,n);return[Cs(t.name,e,n)||i];case"Placeholder":return[Cs(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const u=F("x",t,e,n);return[Nd(u)]}case"IdentityN":return F("x",t,e,n).map(u=>Nd(u));case"Snapshot":const s=F("x",t,e,n);return[Nd(s)];case"Shape":return[r.tensor1d(F("x",t,e,n).shape,"int32")];case"ShapeN":return F("x",t,e,n).map(u=>r.tensor1d(u.shape));case"Size":return[r.scalar(F("x",t,e,n).size,"int32")];case"Rank":return[r.scalar(F("x",t,e,n).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const a=F("x",t,e,n),o=F("data",t,e,n),l=F("message",t,e,n),c=F("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(l);for(let u=0;u<o.length;u++)console.log(Array.prototype.slice.call(o[u].dataSync()).slice(0,c));return[a];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g8e{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=It(0),this.tensorMap=new Map,as(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return It(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return this.tensorMap.forEach(i=>i.dispose()),this.tensorMap.clear(),ve(()=>{const i=Xl(n),s=r.length,a=i.length;q(s===a,()=>`The number of elements doesn't match, keys has ${s} elements, the values has ${a} elements.`);for(let o=0;o<s;o++){const l=r[o],c=i[o];as(c),this.tensorMap.set(l,c)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const r=await e.data();return ve(()=>{const i=[];for(let s=0;s<r.length;s++){const a=r[s],o=this.findWithDefault(a,n);i.push(o)}return wo(i)})}findWithDefault(e,n){const r=this.tensorMap.get(e);return r??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8e=async(t,e,n,r)=>{switch(t.op){case"HashTable":case"HashTableV2":{const i=r.getHashTableHandleByName(t.name);if(i!=null)return[i];{const s=F("keyDType",t,e,n),a=F("valueDType",t,e,n),o=new g8e(s,a);return r.addHashTable(t.name,o),[o.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const i=F("tableHandle",t,e,n,r),s=F("keys",t,e,n),a=F("values",t,e,n);return[await r.getHashTableById(i.id).import(s,a)]}case"LookupTableFind":case"LookupTableFindV2":{const i=F("tableHandle",t,e,n,r),s=F("keys",t,e,n),a=F("defaultValue",t,e,n);return[await r.getHashTableById(i.id).find(s,a)]}case"LookupTableSize":case"LookupTableSizeV2":{const i=F("tableHandle",t,e,n,r);return[r.getHashTableById(i.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8e=(t,e,n,r=Ps)=>{switch(t.op){case"ResizeBilinear":{const i=F("images",t,e,n),s=F("size",t,e,n),a=F("alignCorners",t,e,n),o=F("halfPixelCenters",t,e,n);return[r.image.resizeBilinear(i,[s[0],s[1]],a,o)]}case"ResizeNearestNeighbor":{const i=F("images",t,e,n),s=F("size",t,e,n),a=F("alignCorners",t,e,n),o=F("halfPixelCenters",t,e,n);return[r.image.resizeNearestNeighbor(i,[s[0],s[1]],a,o)]}case"CropAndResize":{const i=F("image",t,e,n),s=F("boxes",t,e,n),a=F("boxInd",t,e,n),o=F("cropSize",t,e,n),l=F("method",t,e,n),c=F("extrapolationValue",t,e,n);return[r.image.cropAndResize(i,s,a,o,l,c)]}case"ImageProjectiveTransformV3":{const i=F("images",t,e,n),s=F("transforms",t,e,n),a=F("outputShape",t,e,n),o=F("fillValue",t,e,n),l=F("interpolation",t,e,n),c=F("fillMode",t,e,n);return[r.image.transform(i,s,l.toLowerCase(),c.toLowerCase(),o,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x8e=(t,e,n,r=Ps)=>{switch(t.op){case"Equal":return[r.equal(F("a",t,e,n),F("b",t,e,n))];case"NotEqual":return[r.notEqual(F("a",t,e,n),F("b",t,e,n))];case"Greater":return[r.greater(F("a",t,e,n),F("b",t,e,n))];case"GreaterEqual":return[r.greaterEqual(F("a",t,e,n),F("b",t,e,n))];case"Less":return[r.less(F("a",t,e,n),F("b",t,e,n))];case"LessEqual":return[r.lessEqual(F("a",t,e,n),F("b",t,e,n))];case"LogicalAnd":return[r.logicalAnd(F("a",t,e,n),F("b",t,e,n))];case"LogicalNot":return[r.logicalNot(F("a",t,e,n))];case"LogicalOr":return[r.logicalOr(F("a",t,e,n),F("b",t,e,n))];case"Select":case"SelectV2":return[r.where(F("condition",t,e,n),F("a",t,e,n),F("b",t,e,n))];case"BitwiseAnd":return[r.bitwiseAnd(F("a",t,e,n),F("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8e=(t,e,n,r=Ps)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(F("a",t,e,n),F("b",t,e,n),F("transposeA",t,e,n),F("transposeB",t,e,n))];case"Einsum":return[r.einsum(F("equation",t,e,n),...F("tensors",t,e,n))];case"Transpose":return[r.transpose(F("x",t,e,n),F("perm",t,e,n))];case"_FusedMatMul":const[i,s]=F("fusedOps",t,e,n),a=i==="biasadd",o=s==="prelu",l=F("numArgs",t,e,n),c=F("leakyreluAlpha",t,e,n);if(a){if(o&&l!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!o&&l!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[u,d]=F("args",t,e,n);return[r.fused.matMul({a:F("a",t,e,n),b:F("b",t,e,n),transposeA:F("transposeA",t,e,n),transposeB:F("transposeB",t,e,n),bias:u,activation:s,preluActivationWeights:d,leakyreluAlpha:c})];case"MatrixBandPart":return[r.linalg.bandPart(F("a",t,e,n),F("numLower",t,e,n),F("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w8e=(t,e,n,r=Ps)=>{switch(t.op){case"EuclideanNorm":return[r.euclideanNorm(F("x",t,e,n),F("axis",t,e,n),F("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(F("x",t,e,n),F("mean",t,e,n),F("variance",t,e,n),F("offset",t,e,n),F("scale",t,e,n),F("epsilon",t,e,n))];case"FusedBatchNormV3":return[r.batchNorm(F("x",t,e,n),F("mean",t,e,n),F("variance",t,e,n),F("offset",t,e,n),F("scale",t,e,n),F("epsilon",t,e,n))];case"LRN":return[r.localResponseNormalization(F("x",t,e,n),F("radius",t,e,n),F("bias",t,e,n),F("alpha",t,e,n),F("beta",t,e,n))];case"Softmax":return[r.softmax(F("x",t,e,n))];case"LogSoftmax":return[r.logSoftmax(F("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S8e=(t,e,n,r=Ps)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:i,outputDenseValues:s}=r.raggedGather(F("paramsNestedSplits",t,e,n),F("paramsDenseValues",t,e,n),F("indices",t,e,n),F("outputRaggedRank",t,e,n));return i.concat(s)}case"RaggedRange":{const{rtNestedSplits:i,rtDenseValues:s}=r.raggedRange(F("starts",t,e,n),F("limits",t,e,n),F("splits",t,e,n));return[i,s]}case"RaggedTensorToTensor":return[r.raggedTensorToTensor(F("shape",t,e,n),F("values",t,e,n),F("defaultValue",t,e,n),F("rowPartitionTensors",t,e,n),F("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _8e=(t,e,n,r=Ps)=>{switch(t.op){case"Max":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.max(F("x",t,e,n),o,l)]}case"Mean":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.mean(F("x",t,e,n),o,l)]}case"Min":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.min(F("x",t,e,n),o,l)]}case"Sum":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.sum(F("x",t,e,n),o,l)]}case"All":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.all(F("x",t,e,n),o,l)]}case"Any":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.any(F("x",t,e,n),o,l)]}case"ArgMax":{const o=F("axis",t,e,n);return[r.argMax(F("x",t,e,n),o)]}case"ArgMin":{const o=F("axis",t,e,n);return[r.argMin(F("x",t,e,n),o)]}case"Prod":{const o=F("axis",t,e,n),l=F("keepDims",t,e,n);return[r.prod(F("x",t,e,n),o,l)]}case"Cumprod":{const o=F("axis",t,e,n),l=F("exclusive",t,e,n),c=F("reverse",t,e,n);return[r.cumprod(F("x",t,e,n),o,l,c)]}case"Cumsum":{const o=F("axis",t,e,n),l=F("exclusive",t,e,n),c=F("reverse",t,e,n);return[r.cumsum(F("x",t,e,n),o,l,c)]}case"Bincount":const i=F("x",t,e,n),s=F("weights",t,e,n),a=F("size",t,e,n);return[r.bincount(i,s,a)];case"DenseBincount":{const o=F("x",t,e,n),l=F("weights",t,e,n),c=F("size",t,e,n),u=F("binaryOutput",t,e,n);return[r.denseBincount(o,l,c,u)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8e=(t,e,n,r=Ps)=>{switch(t.op){case"ConcatV2":case"Concat":{const i=F("n",t,e,n),s=F("axis",t,e,n);let a=F("tensors",t,e,n);return a=a.slice(0,i),[r.concat(a,s)]}case"Gather":{const i=F("x",t,e,n),s=F("indices",t,e,n);return[r.gather(i,r.cast(s,"int32"),0)]}case"GatherV2":{const i=F("axis",t,e,n),s=F("batchDims",t,e,n),a=F("x",t,e,n),o=F("indices",t,e,n);return[r.gather(a,r.cast(o,"int32"),i,s)]}case"Reverse":{const i=F("dims",t,e,n),s=[];for(let o=0;o<i.length;o++)i[o]&&s.push(o);const a=F("x",t,e,n);return[r.reverse(a,s)]}case"ReverseV2":{const i=F("axis",t,e,n),s=F("x",t,e,n);return[r.reverse(s,i)]}case"Slice":{const i=F("begin",t,e,n),s=F("size",t,e,n);return[r.slice(F("x",t,e,n),i,s)]}case"StridedSlice":{const i=F("begin",t,e,n),s=F("end",t,e,n),a=F("strides",t,e,n),o=F("beginMask",t,e,n),l=F("endMask",t,e,n),c=F("ellipsisMask",t,e,n),u=F("newAxisMask",t,e,n),d=F("shrinkAxisMask",t,e,n),h=F("x",t,e,n);return[r.stridedSlice(h,i,s,a,o,l,c,u,d)]}case"Pack":return ve(()=>{const i=F("axis",t,e,n),s=F("tensors",t,e,n),a=s[0].shape,o=r.squeeze(s[0]).shape,l=s.map(c=>{const u=Pn(c.shape,a);if(!u&&!Pn(r.squeeze(c).shape,o))throw new Error("the input tensors shape does not match");return u?c:r.reshape(c,a)});return[r.stack(l,i)]});case"Unpack":{const i=F("axis",t,e,n),s=F("tensor",t,e,n);return r.unstack(s,i)}case"Tile":{const i=F("reps",t,e,n);return[r.tile(F("x",t,e,n),i)]}case"Split":case"SplitV":{const i=F("axis",t,e,n),s=F("numOrSizeSplits",t,e,n),a=F("x",t,e,n);return r.split(a,s,i)}case"ScatterNd":{const i=F("indices",t,e,n),s=F("values",t,e,n),a=F("shape",t,e,n);return[r.scatterND(i,s,a)]}case"GatherNd":{const i=F("x",t,e,n),s=F("indices",t,e,n);return[r.gatherND(i,s)]}case"SparseToDense":{const i=F("sparseIndices",t,e,n),s=F("outputShape",t,e,n),a=F("sparseValues",t,e,n),o=F("defaultValue",t,e,n);return[r.sparseToDense(i,a,s,a.dtype===o.dtype?o:r.cast(o,a.dtype))]}case"TensorScatterUpdate":{const i=F("indices",t,e,n),s=F("values",t,e,n),a=F("tensor",t,e,n);return[r.tensorScatterUpdate(a,i,s)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8e=(t,e,n,r=Ps)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:i,outputValues:s,emptyRowIndicator:a,reverseIndexMap:o}=r.sparse.sparseFillEmptyRows(F("indices",t,e,n),F("values",t,e,n),F("denseShape",t,e,n),F("defaultValue",t,e,n));return[i,s,a,o]}case"SparseReshape":{const{outputIndices:i,outputShape:s}=r.sparse.sparseReshape(F("inputIndices",t,e,n),F("inputShape",t,e,n),F("newShape",t,e,n));return[i,s]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(F("data",t,e,n),F("indices",t,e,n),F("segmentIds",t,e,n))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(F("data",t,e,n),F("indices",t,e,n),F("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C8e=(t,e,n,r=Ps)=>{switch(t.op){case"FFT":return[r.fft(F("x",t,e,n))];case"IFFT":return[r.ifft(F("x",t,e,n))];case"RFFT":return[r.rfft(F("x",t,e,n))];case"IRFFT":return[r.irfft(F("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N8e=(t,e,n,r=Ps)=>{switch(t.op){case"StaticRegexReplace":return[r.string.staticRegexReplace(F("input",t,e,n),F("pattern",t,e,n),F("rewrite",t,e,n),F("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:i,nGramsSplits:s}=r.string.stringNGrams(F("data",t,e,n),F("dataSplits",t,e,n),F("separator",t,e,n),F("nGramWidths",t,e,n),F("leftPad",t,e,n),F("rightPad",t,e,n),F("padWidth",t,e,n),F("preserveShortSequences",t,e,n));return[i,s]}case"StringSplit":{const{indices:i,values:s,shape:a}=r.string.stringSplit(F("input",t,e,n),F("delimiter",t,e,n),F("skipEmpty",t,e,n));return[i,s,a]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(F("input",t,e,n),F("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A8e=(t,e,n,r=Ps)=>{switch(t.op){case"Cast":return[r.cast(F("x",t,e,n),F("dtype",t,e,n))];case"ExpandDims":{const i=F("axis",t,e,n);return[r.expandDims(F("x",t,e,n),i)]}case"Squeeze":{const i=F("axis",t,e,n);return[r.squeeze(F("x",t,e,n),i)]}case"Reshape":return[r.reshape(F("x",t,e,n),F("shape",t,e,n))];case"EnsureShape":return[r.ensureShape(F("x",t,e,n),F("shape",t,e,n))];case"MirrorPad":return[r.mirrorPad(F("x",t,e,n),F("padding",t,e,n),F("mode",t,e,n))];case"PadV2":case"Pad":return[r.pad(F("x",t,e,n),F("padding",t,e,n),F("constantValue",t,e,n))];case"SpaceToBatchND":{const i=F("blockShape",t,e,n),s=F("paddings",t,e,n);return[r.spaceToBatchND(F("x",t,e,n),i,s)]}case"BatchToSpaceND":{const i=F("blockShape",t,e,n),s=F("crops",t,e,n);return[r.batchToSpaceND(F("x",t,e,n),i,s)]}case"DepthToSpace":{const i=F("blockSize",t,e,n),s=F("dataFormat",t,e,n).toUpperCase();return[r.depthToSpace(F("x",t,e,n),i,s)]}case"BroadcastTo":return[r.broadcastTo(F("x",t,e,n),F("shape",t,e,n))];case"BroadcastArgs":return[r.broadcastArgs(F("s0",t,e,n),F("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pX(t,e,n,r,i=ve){const s=((a,o,l)=>{switch(a.category){case"arithmetic":return i(()=>r8e(a,o,l));case"basic_math":return i(()=>i8e(a,o,l));case"control":return u8e(a,o,l);case"convolution":return i(()=>d8e(a,o,l));case"creation":return i(()=>h8e(a,o,l));case"dynamic":return f8e(a,o,l);case"evaluation":return i(()=>p8e(a,o,l));case"image":return i(()=>v8e(a,o,l));case"graph":return i(()=>m8e(a,o,l));case"logical":return i(()=>x8e(a,o,l));case"matrices":return i(()=>b8e(a,o,l));case"normalization":return i(()=>w8e(a,o,l));case"ragged":return i(()=>S8e(a,o,l));case"reduction":return i(()=>_8e(a,o,l));case"slice_join":return i(()=>T8e(a,o,l));case"sparse":return i(()=>E8e(a,o,l));case"spectral":return i(()=>C8e(a,o,l));case"string":return i(()=>N8e(a,o,l));case"transformation":return i(()=>A8e(a,o,l));case"hash_table":return y8e(a,o,l,r);case"custom":const c=Lue(a.op);if(c&&c.customExecutor)return c.customExecutor(new n8e(a,o,l));throw TypeError(`Custom op ${a.op} is not registered.`);default:throw TypeError(`Unknown op '${a.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return mg(s)?s.then(a=>[].concat(a)):[].concat(s)}class mX{constructor(e={},n={},r={},i={},s){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=i,this.parseNodeNameCache=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const r=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gX(t,e,n,r){const i=new Set,s=[];let a=null,o=null;const l=new Set,c=new Set(Object.keys(t).map(h=>io(h)[0]));r=r||[];const u=new Set(r.map(h=>io(h.name)[0])),d=[...e];for(;d.length>0;){const h=d.pop();if((vm(h)||$8e(h)||L8e(h))&&a==null&&(a=h,o=a.children.map(f=>f.name).filter(f=>i.has(f))),i.add(h.name),n[h.name]==null&&!c.has(h.name)&&!u.has(h.name)){if(h.inputs.length===0){s.push(h.name);continue}h.inputs.forEach(f=>{l.has(f.name)||(l.add(f.name),d.push(f))})}}return{inputs:t,outputs:e,usedNodes:i,missingInputs:s,dynamicNode:a,syncInputs:o}}function I8e(t,e){const{usedNodes:n,inputs:r}=e,i=Object.keys(r).map(m=>io(m)[0]).map(m=>t.nodes[m]),s=t.initNodes||[],a=m=>n.has(typeof m=="string"?m:m.name);function o(m){return[...new Map(m.map(y=>[y.name,y])).values()]}const l=o([...i,...t.weights,...s]).filter(a),c=o([...l,...Object.values(t.nodes)]).filter(a),u=new Map(c.map(m=>[m.name,m])),d={};for(const m of c){d[m.name]=d[m.name]||0;for(const y of m.children)a(y)||(d[y.name]=Number.POSITIVE_INFINITY),d[y.name]=(d[y.name]||0)+1}const h=Object.entries(d).filter(([,m])=>m===0).map(([m])=>m),f=[...h];for(;h.length>0;){const m=h.pop(),y=u.get(m);for(const x of y.children.filter(a))--d[x.name]===0&&(f.push(x.name),h.push(x.name))}const p=f.map(m=>u.get(m)),g=k8e(p,l);return M8e(g,l),g}function k8e(t,e){const n=new Map(t.map(a=>[a.name,a])),r=e.map(a=>a.name),i=new Set(r);for(;r.length>0;){const a=r.pop(),o=n.get(a);for(const l of o.children)!n.has(l.name)||i.has(l.name)||(i.add(l.name),r.push(l.name))}return t.filter(a=>i.has(a.name))}class cN extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function M8e(t,e){const n=new Map(t.map((o,l)=>[o.name,l])),r=new Set(e.map(o=>o.name)),i=o=>r.has(typeof o=="string"?o:o.name),s=new Set(t.map(o=>o.name)),a=o=>s.has(typeof o=="string"?o:o.name);for(const o of t){for(const l of o.children.filter(a)){if(!n.has(l.name))throw new cN(`Child ${l.name} of node ${o.name} is unreachable.`);if(n.get(o.name)>n.get(l.name))throw new cN(`Node ${o.name} is scheduled to run after its child ${l.name}.`)}if(!i(o))for(const l of o.inputs){if(!n.has(l.name))throw new cN(`Input ${l.name} of node ${o.name} is unreachable.`);if(n.get(l.name)>n.get(o.name))throw new cN(`Node ${o.name} is scheduled to run before its input ${l.name}.`)}}}function R8e(t){const e=new Map(t.map((o,l)=>[o.name,l])),n=Number.MAX_SAFE_INTEGER,r=t.map((o,l)=>vm(o)?n:l),i=o=>{const l=r[e.get(o.name)];return l??-1},s=t.map((o,l)=>o.children.map(i).reduce((c,u)=>Math.max(c,u),r[l])),a=new Map;for(let o=0;o<t.length;++o){const l=s[o];if(l===n)continue;const c=t[o],u=t[l];a.has(u.name)||a.set(u.name,[]),a.get(u.name).push(c)}return a}const P8e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),O8e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),D8e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function vm(t){return P8e.has(t.op)}function $8e(t){return O8e.has(t.op)}function L8e(t){return D8e.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QA{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(r=>e[r].map(i=>i.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new QA(e.functions[r],this)})}getCompilationKey(e,n){const r=e.map(s=>s.name).sort(),i=n.map(s=>s.name).sort();return r.join(this.SEPARATOR)+"--"+i.join(this.SEPARATOR)}compile(e,n){const r=gX(e,n,this.weightMap,this._initNodes),{missingInputs:i,dynamicNode:s,syncInputs:a}=r;if(s!=null)throw new Error(`This execution contains the node '${s.name}', which has the dynamic op '${s.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${a}]`);if(i.length>0){const c=n.map(d=>d.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${c}] from the provided inputs [${u}]. Missing the following inputs: [${i}]`)}const o=I8e(this.graph,r),l=R8e(o);return{orderedNodes:o,nodeLiveUntilMap:l}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return as(n),n}cloneTensorList(e){return e?e.map(r=>this.cloneAndKeepTensor(r)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,r])=>[n,this.cloneTensorList(r)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const i=r.map(h=>this.graph.nodes[io(h)[0]]),s=n.map(h=>io(h)[0]),a=new Set(s);let o=s.map(h=>this.graph.nodes[h]);o.length===0&&(o=this._outputs);const l=this.getCompilationKey(i,o);let c=this.compiledMap.get(l);c==null&&(c=this.compile(e,o),this.compiledMap.set(l,c));try{this.keepIntermediateTensors=Me().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const u={},d={};return ve(()=>{const h=new mX(this.weightMap,u,d,this.functionExecutorMap,this.parseNodeNameCache),f=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(y=>{const[x,b]=io(y,h),_=[];_[b]=e[y],f[x]=_,this.keepIntermediateTensors&&(this.clonedTensorsMap[x]=this.cloneTensorList(_))});const p=this.getFrozenTensorIds(f),{orderedNodes:g,nodeLiveUntilMap:m}=c;for(const y of g){if(f[y.name])continue;const x=pX(y,f,h,this._resourceManager);if(mg(x))throw new Error(`The execution of the op '${y.op}' returned a promise. Please use model.executeAsync() instead.`);f[y.name]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[y.name]=this.cloneTensorList(x)),this.checkTensorForDisposalWithNodeLiveUntilInfo(y,f,h,p,a,m.get(y.name))}return this.parent==null&&h.dispose(p),n.map(y=>Cs(y,f,h))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(i=>i.id)));return new Set(n)}checkTensorForDisposal(e,n,r,i,s,a,o){if(!(vm(n)||a.has(e))){for(const l of r[e])l!=null&&(o[l.id]=(o[l.id]||0)+n.children.length);for(const l of n.inputs){if(vm(l))continue;const c=cX(l.name,r,i);if(c!=null)for(const u of c){if(!u||u.kept||s.has(u.id))continue;const d=o[u.id];d===1?(u.dispose(),delete o[u.id]):d!=null&&o[u.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,r,i,s,a){function o(l){return vm(l)||s.has(l.name)}if(!(vm(e)||a==null))for(const l of a){if(o(l))continue;const c=cX(l.name,n,r);for(const u of c)!u||u.kept||i.has(u.id)||u.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,r=!1,i={},s={}){this.disposeIntermediateTensors(),r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=Me().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(h){this.keepIntermediateTensors=!1,console.warn(h.message)}const a=new mX(this.weightMap,i,s,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const o=await this.executeWithControlFlow(e,a,n,r),l=n.map(h=>Cs(h,o,a)),c=l.map(h=>h.id),u=Object.keys(e).map(h=>e[h].id),d=new Set([...c,...u,...this.weightIds]);return Object.values(o).forEach(h=>{h.forEach(f=>{f&&!f.isDisposed&&!d.has(f.id)&&f.dispose()})}),this.parent==null&&a.dispose(d),l}async executeFunctionAsync(e,n,r){const i=e.reduce((s,a,o)=>(s[this.inputs[o].name]=a,s),{});return this._executeAsync(i,this.outputNodes,!0,n,r)}async executeWithControlFlow(e,n,r,i){const s=Object.keys(e),a=s.map(_=>this.graph.nodes[io(_)[0]]),o=r.map(_=>io(_)[0]),l=new Set(o);let c=o.map(_=>this.graph.nodes[_]);c.length===0&&(c=this._outputs);const{usedNodes:u,missingInputs:d,dynamicNode:h,syncInputs:f}=gX(e,c,this.weightMap,this._initNodes),p=[...a,...this.graph.weights,...this._initNodes||[]].map(_=>({node:_,contexts:n.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(_=>{const[T,E]=io(_),C=[];C[E]=e[_],g[T]=C});const m={},y=this.getFrozenTensorIds(g),x={};for(;p.length>0;){const _=this.processStack(a,p,n,g,x,y,l,m,u);await Promise.all(_)}h==null&&!i&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const b=c.filter(_=>!vm(_)&&!Cs(_.name,g,n)).map(_=>_.name);if(b.length>0){let _="";throw h!=null&&(_=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${f}]`),new Error(`Cannot compute the outputs [${b}] from the provided inputs [${s}]. Consider providing the following inputs: [${d}]. ${_}`)}return g}processStack(e,n,r,i,s,a,o,l,c){const u=[];for(;n.length>0;){const d=n.pop();r.currentContext=d.contexts;let h="";if(d.node.op==="Enter"&&F("isConstant",d.node,i,r)&&([h]=Cd(d.node.name,r)),i[d.node.name]==null){const f=pX(d.node,i,r,this._resourceManager);h||([h]=Cd(d.node.name,r));const p=r.currentContext;mg(f)?u.push(f.then(g=>(i[h]=g,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(g)),r.currentContext=p,this.checkTensorForDisposal(h,d.node,i,r,a,o,l),this.processChildNodes(d.node,n,r,i,s,c),g))):(i[h]=f,this.keepIntermediateTensors&&(this.clonedTensorsMap[h]=this.cloneTensorList(f)),this.checkTensorForDisposal(h,d.node,i,r,a,o,l),this.processChildNodes(d.node,n,r,i,s,c))}else this.processChildNodes(d.node,n,r,i,s,c)}return u}processChildNodes(e,n,r,i,s,a){e.children.forEach(o=>{const[l]=Cd(o.name,r);s[l]||!a.has(o.name)||(o.op==="Merge"?o.inputNames.some(c=>!!Cs(c,i,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:o})):o.inputNames.every(c=>!!Cs(c,i,r))&&(s[l]=!0,n.push({contexts:r.currentContext,node:o})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const r=e[n],[i]=io(n),s=this.graph.nodes[i];if(s.attrParams.shape&&s.attrParams.shape.value){const a=s.attrParams.shape.value,o=a.length===r.shape.length&&r.shape.every((l,c)=>a[c]===-1||a[c]===l);q(o,()=>`The shape of dict['${s.name}'] provided in model.execute(dict) must be [${a}], but was [${r.shape}]`)}s.attrParams.dtype&&s.attrParams.dtype.value&&q(r.dtype===s.attrParams.dtype.value,()=>`The dtype of dict['${s.name}'] provided in model.execute(dict) must be ${s.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){var n,r;const i={};for(const s in e){const a=(r=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||r===void 0?void 0:r[s];a!=null?i[a.name]=e[s]:i[s]=e[s]}return i}checkInputs(e){const n=Object.keys(e).filter(r=>{const[i]=io(r);return this.graph.nodes[i]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var r,i;const s=(i=(r=this._signature)===null||r===void 0?void 0:r.outputs)===null||i===void 0?void 0:i[n];return s!=null?s.name:n},{})}checkOutputs(e){e.forEach(n=>{const[r]=io(n);if(!this.graph.nodes[r])throw new Error(`The output '${n}' is not found in the graph`)})}}class F8e{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j8e="?tfjs-format=file",z8e="model.json";class B8e{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},r=yle){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=r,n==null&&(this.loadOptions={}),this.resourceManager=new F8e}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return mg(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await Bae(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const r=this.artifacts.modelTopology;let i=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const s=this.artifacts.userDefinedMetadata;s.signature!=null&&(i=s.signature),s.structuredOutputKeys!=null&&(this.structuredOutputKeys=s.structuredOutputKeys)}if(this.signature=i,this.version=`${r.versions.producer}.${r.versions.minConsumer}`,this.executor=new QA(uX.Instance.transformGraph(r,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const s=uX.Instance.transformGraph(e.modelInitializer);this.initializer=new QA(s),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof rr?[e]:e,r={};return n.forEach((i,s)=>r[this.structuredOutputKeys[s]]=i),r}return e}predict(e,n){const r=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(r)}async predictAsync(e,n){const r=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(r)}normalizeInputs(e){var n;if(!(e instanceof rr)&&!Array.isArray(e)){const s=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(s!=null)for(const a in s){const o=s[a];o.resourceId!=null&&(e[a]=this.resourceIdToCapturedInput[o.resourceId])}return e}e=Array.isArray(e)?e:[e];const r=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+r!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-r} non-resource placeholders, while there are ${e.length} input tensors provided.`);let i=0;return this.inputNodes.reduce((s,a)=>{var o,l,c;const u=(c=(l=(o=this.signature)===null||o===void 0?void 0:o.inputs)===null||l===void 0?void 0:l[a])===null||c===void 0?void 0:c.resourceId;return u!=null?s[a]=this.resourceIdToCapturedInput[u]:s[a]=e[i++],s},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,r=Object.keys(n);for(let i=0;i<r.length;i++){const s=r[i],a=n[s];this.resourceIdToCapturedInput[a.resourceId]=e[i]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=this.executor.execute(e,n);return r.length>1?r:r[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const r=await this.executor.executeAsync(e,n);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,r)=>(n[r]=[e[r]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Bt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function Jx(t,e={},n=yle){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=U8e(t));const r=new B8e(t,e,n);return await r.load(),r}function U8e(t){return t.endsWith("/")||(t=t+"/"),`${t}${z8e}${j8e}`}/**
    * @license
    * Copyright 2023 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var zue=function(t,e){return(zue=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])})(t,e)};function Bue(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}zue(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var Sr=function(){return(Sr=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function Dn(t,e,n,r){return new(n||(n=Promise))(function(i,s){function a(c){try{l(r.next(c))}catch(u){s(u)}}function o(c){try{l(r.throw(c))}catch(u){s(u)}}function l(c){var u;c.done?i(c.value):(u=c.value,u instanceof n?u:new n(function(d){d(u)})).then(a,o)}l((r=r.apply(t,[])).next())})}function $n(t,e){var n,r,i,s,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(l){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&u[0]?r.return:u[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,u[1])).done)return i;switch(r=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(i=a.trys,!((i=i.length>0&&i[i.length-1])||u[0]!==6&&u[0]!==2)){a=0;continue}if(u[0]===3&&(!i||u[1]>i[0]&&u[1]<i[3])){a.label=u[1];break}if(u[0]===6&&a.label<i[1]){a.label=i[1],i=u;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(u);break}i[2]&&a.ops.pop(),a.trys.pop();continue}u=e.call(t,a)}catch(d){u=[6,d],r=0}finally{n=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([l,c])}}}function Am(t,e,n){if(n||arguments.length===2)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}var Xu=["nose","left_eye","right_eye","left_ear","right_ear","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle"],sS=["nose","left_eye_inner","left_eye","left_eye_outer","right_eye_inner","right_eye","right_eye_outer","left_ear","right_ear","mouth_left","mouth_right","left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_pinky","right_pinky","left_index","right_index","left_thumb","right_thumb","left_hip","right_hip","left_knee","right_knee","left_ankle","right_ankle","left_heel","right_heel","left_foot_index","right_foot_index"];function JA(t){return t instanceof SVGAnimatedLength?t.baseVal.value:t}function Uue(t){return Dn(this,void 0,void 0,function(){var e,n;return $n(this,function(r){switch(r.label){case 0:return e=document.createElement("canvas"),t instanceof rr?[4,qW(t,e)]:[3,2];case 1:return r.sent(),[3,3];case 2:e.width=JA(t.width),e.height=JA(t.height),n=e.getContext("2d"),t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0),r.label=3;case 3:return[2,e]}})})}function Vue(t){return Dn(this,void 0,void 0,function(){var e,n,r,i,s,a;return $n(this,function(o){switch(o.label){case 0:return t instanceof rr?(e=t.shape.slice(0,2),n=e[0],r=e[1],i=ImageData.bind,[4,qW(t)]):[3,2];case 1:return[2,new(i.apply(ImageData,[void 0,o.sent(),r,n]))];case 2:return s=document.createElement("canvas"),a=s.getContext("2d"),s.width=JA(t.width),s.height=JA(t.height),a.drawImage(t,0,0),[2,a.getImageData(0,0,s.width,s.height)]}})})}function V8e(t){return Dn(this,void 0,void 0,function(){var e,n;return $n(this,function(r){switch(r.label){case 0:return t instanceof SVGImageElement||t instanceof OffscreenCanvas?[4,Uue(t)]:[3,2];case 1:return n=r.sent(),[3,3];case 2:n=t,r.label=3;case 3:return e=n,[2,vle(e,4)]}})})}function Wue(t){if(t<0||t>=256)throw new Error("Mask value must be in range [0, 255] but got ".concat(t));if(!Number.isInteger(t))throw new Error("Mask value must be an integer but got ".concat(t))}var cw={runtime:"mediapipe",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,modelType:"full"},W8e=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,this.mask]})})},t.prototype.toImageData=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,Vue(this.mask)]})})},t.prototype.toTensor=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,V8e(this.mask)]})})},t.prototype.getUnderlyingType=function(){return"canvasimagesource"},t}();function H8e(t){return Wue(t),"person"}var G8e=function(){function t(e){var n,r=this;switch(this.width=0,this.height=0,this.selfieMode=!1,this.poseSolution=new u1e({locateFile:function(i,s){if(e.solutionPath){var a=e.solutionPath.replace(/\/+$/,"");return"".concat(a,"/").concat(i)}return"".concat(s,"/").concat(i)}}),e.modelType){case"lite":n=0;break;case"heavy":n=2;break;case"full":default:n=1}this.poseSolution.setOptions({modelComplexity:n,smoothLandmarks:e.enableSmoothing,enableSegmentation:e.enableSegmentation,smoothSegmentation:e.smoothSegmentation,selfieMode:this.selfieMode}),this.poseSolution.onResults(function(i){if(r.height=i.image.height,r.width=i.image.width,i.poseLandmarks==null)r.poses=[];else{var s=r.translateOutput(i.poseLandmarks,i.poseWorldLandmarks);i.segmentationMask&&(s.segmentation={maskValueToLabel:H8e,mask:new W8e(i.segmentationMask)}),r.poses=[s]}})}return t.prototype.translateOutput=function(e,n){var r=this,i={keypoints:e.map(function(s,a){return{x:s.x*r.width,y:s.y*r.height,z:s.z,score:s.visibility,name:sS[a]}})};return n!=null&&(i.keypoints3D=n.map(function(s,a){return{x:s.x,y:s.y,z:s.z,score:s.visibility,name:sS[a]}})),i},t.prototype.estimatePoses=function(e,n,r){return Dn(this,void 0,void 0,function(){var i,s;return $n(this,function(a){switch(a.label){case 0:return n&&n.flipHorizontal&&n.flipHorizontal!==this.selfieMode&&(this.selfieMode=n.flipHorizontal,this.poseSolution.setOptions({selfieMode:this.selfieMode})),e instanceof rr?(s=ImageData.bind,[4,qW(e)]):[3,2];case 1:return i=new(s.apply(ImageData,[void 0,a.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:i=e,a.label=3;case 3:return e=i,[4,this.poseSolution.send({image:e},r)];case 4:return a.sent(),[2,this.poses]}})})},t.prototype.dispose=function(){this.poseSolution.close()},t.prototype.reset=function(){this.poseSolution.reset()},t.prototype.initialize=function(){return this.poseSolution.initialize()},t}();function q8e(t){return Dn(this,void 0,void 0,function(){var e,n;return $n(this,function(r){switch(r.label){case 0:return e=function(i){if(i==null)return Sr({},cw);var s=Sr({},i);return s.runtime="mediapipe",s.enableSegmentation==null&&(s.enableSegmentation=cw.enableSegmentation),s.enableSmoothing==null&&(s.enableSmoothing=cw.enableSmoothing),s.smoothSegmentation==null&&(s.smoothSegmentation=cw.smoothSegmentation),s.modelType==null&&(s.modelType=cw.modelType),s}(t),[4,(n=new G8e(e)).initialize()];case 1:return r.sent(),[2,n]}})})}function e0(t){return t instanceof rr?{height:t.shape[0],width:t.shape[1]}:{height:t.height,width:t.width}}function Hue(t){return t-2*Math.PI*Math.floor((t+Math.PI)/(2*Math.PI))}function D5(t){return t instanceof rr?t:vle(t)}function Gue(t,e,n){return Aj(n,"inputResolution"),[1/n.width*t[0][0]*e.width,1/n.height*t[0][1]*e.width,t[0][3]*e.width,1/n.width*t[1][0]*e.height,1/n.height*t[1][1]*e.height,t[1][3]*e.height,0,0]}function Aj(t,e){q(t.width!==0,function(){return"".concat(e," width cannot be 0.")}),q(t.height!==0,function(){return"".concat(e," height cannot be 0.")})}function U$(t,e,n){var r=n.rotationVectorStartKeypointIndex,i=n.rotationVectorEndKeypointIndex,s=t.locationData,a=s.relativeKeypoints[r].x*e.width,o=s.relativeKeypoints[r].y*e.height,l=s.relativeKeypoints[i].x*e.width,c=s.relativeKeypoints[i].y*e.height,u=2*Math.sqrt((l-a)*(l-a)+(c-o)*(c-o)),d=function(h,f,p){var g,m=h.locationData,y=p.rotationVectorStartKeypointIndex,x=p.rotationVectorEndKeypointIndex;g=p.rotationVectorTargetAngle?p.rotationVectorTargetAngle:Math.PI*p.rotationVectorTargetAngleDegree/180;var b=m.relativeKeypoints[y].x*f.width,_=m.relativeKeypoints[y].y*f.height,T=m.relativeKeypoints[x].x*f.width,E=m.relativeKeypoints[x].y*f.height;return Hue(g-Math.atan2(-(E-_),T-b))}(t,e,n);return{xCenter:a/e.width,yCenter:o/e.height,width:u/e.width,height:u/e.height,rotation:d}}function que(t){if(t.length!==16)throw new Error("Array length must be 16 but got ".concat(t.length));return[[t[0],t[1],t[2],t[3]],[t[4],t[5],t[6],t[7]],[t[8],t[9],t[10],t[11]],[t[12],t[13],t[14],t[15]]]}function V$(t,e,n,r,i,s,a){return t[e][i]*(t[n][s]*t[r][a]-t[n][a]*t[r][s])}function na(t,e,n){var r=(e+1)%4,i=(e+2)%4,s=(e+3)%4,a=(n+1)%4,o=(n+2)%4,l=(n+3)%4;return V$(t,r,i,s,a,o,l)+V$(t,i,s,r,a,o,l)+V$(t,s,r,i,a,o,l)}function yX(t,e,n){n===void 0&&(n={ignoreRotation:!1});for(var r=[],i=0,s=t;i<s.length;i++){var a=s[i],o=a.x-.5,l=a.y-.5,c=n.ignoreRotation?0:e.rotation,u=Math.cos(c)*o-Math.sin(c)*l,d=Math.sin(c)*o+Math.cos(c)*l;u=u*e.width+e.xCenter,d=d*e.height+e.yCenter;var h=a.z*e.width,f=Sr({},a);f.x=u,f.y=d,f.z=h,r.push(f)}return r}function Xue(t,e){var n=function(r,i,s,a){var o=i-r,l=a-s,c=l/o;return{scale:c,offset:s-r*c}}(0,255,e[0],e[1]);return ve(function(){return He(se(t,n.scale),n.offset)})}function Ij(t,e,n){var r,i,s,a,o,l,c,u,d,h,f,p,g,m,y=e.outputTensorSize,x=e.keepAspectRatio,b=e.borderMode,_=e.outputTensorFloatRange,T=e0(t),E=function(A,k){return k?{xCenter:k.xCenter*A.width,yCenter:k.yCenter*A.height,width:k.width*A.width,height:k.height*A.height,rotation:k.rotation}:{xCenter:.5*A.width,yCenter:.5*A.height,width:A.width,height:A.height,rotation:0}}(T,n),C=function(A,k,R){if(R===void 0&&(R=!1),!R)return{top:0,left:0,right:0,bottom:0};var $=k.height,z=k.width;Aj(k,"targetSize"),Aj(A,"roi");var O,j,B=$/z,W=A.height/A.width,L=0,V=0;return B>W?(O=A.width,j=A.width*B,V=(1-W/B)/2):(O=A.height/B,j=A.height,L=(1-B/W)/2),A.width=O,A.height=j,{top:V,left:L,right:L,bottom:V}}(E,y,x),I=(r=E,i=T.width,s=T.height,a=!1,o=r.width,l=r.height,c=a?-1:1,u=Math.cos(r.rotation),d=Math.sin(r.rotation),h=r.xCenter,f=r.yCenter,p=1/i,g=1/s,(m=new Array(16))[0]=o*u*c*p,m[1]=-l*d*p,m[2]=0,m[3]=(-.5*o*u*c+.5*l*d+h)*p,m[4]=o*d*c*g,m[5]=l*u*g,m[6]=0,m[7]=(-.5*l*u-.5*o*d*c+f)*g,m[8]=0,m[9]=0,m[10]=o*p,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,que(m));return{imageTensor:ve(function(){var A=D5(t),k=Ul(Gue(I,T,y),[1,8]),R=b==="zero"?"constant":"nearest",$=ma.transform(Mi(nt(A,"float32")),k,"bilinear",R,0,[y.height,y.width]);return _!=null?Xue($,_):$}),padding:C,transformationMatrix:I}}function vX(t,e,n,r){return r===1?.5*(t+e):t+(e-t)*n/(r-1)}function X8e(t){return ve(function(){var e=function(i){return ve(function(){return[Kt(i,[0,0,0],[1,-1,1]),Kt(i,[0,0,1],[1,-1,-1])]})}(t),n=e[0],r=e[1];return{boxes:Yn(r),logits:Yn(n)}})}function Kue(t){return t!=null&&t.currentTime!=null}function xX(t){for(var e={locationData:{relativeKeypoints:[]}},n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,s=Number.MIN_SAFE_INTEGER,a=0;a<t.length;++a){var o=t[a];n=Math.min(n,o.x),r=Math.max(r,o.x),i=Math.min(i,o.y),s=Math.max(s,o.y),e.locationData.relativeKeypoints.push({x:o.x,y:o.y})}return e.locationData.relativeBoundingBox={xMin:n,yMin:i,xMax:r,yMax:s,width:r-n,height:s-i},e}function K8e(t,e,n,r){return Dn(this,void 0,void 0,function(){var i,s,a,o,l;return $n(this,function(c){switch(c.label){case 0:return t.sort(function(u,d){return Math.max.apply(Math,d.score)-Math.max.apply(Math,u.score)}),i=Ul(t.map(function(u){return[u.locationData.relativeBoundingBox.yMin,u.locationData.relativeBoundingBox.xMin,u.locationData.relativeBoundingBox.yMax,u.locationData.relativeBoundingBox.xMax]})),s=Oi(t.map(function(u){return u.score[0]})),[4,ma.nonMaxSuppressionAsync(i,s,e,n)];case 1:return[4,(a=c.sent()).array()];case 2:return o=c.sent(),l=t.filter(function(u,d){return o.indexOf(d)>-1}),Bt([i,s,a]),[2,l]}})})}function Yue(t,e){return t.map(function(n){var r=Sr(Sr({},n),{x:n.x*e.width,y:n.y*e.height});return n.z!=null&&(r.z=n.z*e.width),r})}function Y8e(t,e,n){return Dn(this,void 0,void 0,function(){var r,i,s,a,o,l,c,u,d,h,f,p,g,m,y,x,b,_,T,E,C,I,A,k;return $n(this,function(R){switch(R.label){case 0:if(r=Yn(e,[0]),i=r.shape,s=i[0],a=i[1],o=i[2],t.length!==o)throw new Error("Expected heatmap to have same number of channels as the number of landmarks. But got landmarks length: "+"".concat(t.length,", heatmap length: ").concat(o));return l=[],[4,r.buffer()];case 1:for(c=R.sent(),u=0;u<t.length;u++)if(d=t[u],h=Sr({},d),l.push(h),f=Math.trunc(h.x*a),p=Math.trunc(h.y*s),!(f<0||f>=a||p<0||f>=s)){for(g=Math.trunc((n.kernelSize-1)/2),m=Math.max(0,f-g),y=Math.min(a,f+g+1),x=Math.max(0,p-g),b=Math.min(s,p+g+1),_=0,T=0,E=0,C=0,I=x;I<b;++I)for(A=m;A<y;++A)k=c.get(I,A,u),_+=k,C=Math.max(C,k),T+=A*k,E+=I*k;C>=n.minConfidenceToRefine&&_>0&&(h.x=T/a/_,h.y=E/s/_)}return r.dispose(),[2,l]}})})}function bX(t,e){var n=e.left,r=e.top,i=e.left+e.right,s=e.top+e.bottom;return t.map(function(a){return Sr(Sr({},a),{x:(a.x-n)/(1-i),y:(a.y-r)/(1-s),z:a.z/(1-i)})})}function Z8e(t,e,n){return q1()==="webgl"?function(r,i,s){var a=s.combineWithPreviousRatio.toFixed(2),o={variableNames:["prevMask","newMask"],outputShape:r.shape,userCode:`
  void main() {
      ivec2 coords = getOutputCoords();
      int height = coords[0];
      int width = coords[1];

      float prevMaskValue = getPrevMask(height, width);
      float newMaskValue = getNewMask(height, width);

      /*
      * Assume p := newMaskValue
      * H(p) := 1 + (p * log(p) + (1-p) * log(1-p)) / log(2)
      * uncertainty alpha(p) =
      *   Clamp(1 - (1 - H(p)) * (1 - H(p)), 0, 1) [squaring the
      * uncertainty]
      *
      * The following polynomial approximates uncertainty alpha as a
      * function of (p + 0.5):
      */
      const float c1 = 5.68842;
      const float c2 = -0.748699;
      const float c3 = -57.8051;
      const float c4 = 291.309;
      const float c5 = -624.717;
      float t = newMaskValue - 0.5;
      float x = t * t;

      float uncertainty =
        1.0 - min(1.0, x * (c1 + x * (c2 + x * (c3 + x * (c4 + x * c5)))));

      float outputValue = newMaskValue + (prevMaskValue - newMaskValue) *
                             (uncertainty * `.concat(a,`);

      setOutput(outputValue);
    }
`)},l=vg();return ve(function(){var c=l.compileAndRun(o,[r,i]);return Fo().makeTensorFromDataId(c.dataId,c.shape,c.dtype)})}(t,e,n):ve(function(){var r=ut(e,.5),i=fr(r),s=ut(1,Xf(1,se(i,He(5.68842,se(i,He(-.748699,se(i,He(-57.8051,se(i,He(291.309,se(i,-624.717)))))))))));return He(e,se(ut(t,e),se(s,n.combineWithPreviousRatio)))})}function Q8e(t,e,n){return Dn(this,void 0,void 0,function(){var r,i,s,a,o;return $n(this,function(l){switch(l.label){case 0:return r=t[0],i=t[1],s=function(c,u,d){return ve(function(){var h,f,p,g;d.reverseOutputOrder?(f=Yn(Kt(c,[0,d.boxCoordOffset+0],[-1,1])),h=Yn(Kt(c,[0,d.boxCoordOffset+1],[-1,1])),g=Yn(Kt(c,[0,d.boxCoordOffset+2],[-1,1])),p=Yn(Kt(c,[0,d.boxCoordOffset+3],[-1,1]))):(h=Yn(Kt(c,[0,d.boxCoordOffset+0],[-1,1])),f=Yn(Kt(c,[0,d.boxCoordOffset+1],[-1,1])),p=Yn(Kt(c,[0,d.boxCoordOffset+2],[-1,1])),g=Yn(Kt(c,[0,d.boxCoordOffset+3],[-1,1]))),f=He(se(ct(f,d.xScale),u.w),u.x),h=He(se(ct(h,d.yScale),u.h),u.y),d.applyExponentialOnBoxSize?(p=se(va(ct(p,d.hScale)),u.h),g=se(va(ct(g,d.wScale)),u.w)):(p=se(ct(p,d.hScale),u.h),g=se(ct(g,d.wScale),u.h));var m=ut(h,ct(p,2)),y=ut(f,ct(g,2)),x=He(h,ct(p,2)),b=He(f,ct(g,2)),_=Qr([de(m,[d.numBoxes,1]),de(y,[d.numBoxes,1]),de(x,[d.numBoxes,1]),de(b,[d.numBoxes,1])],1);if(d.numKeypoints)for(var T=0;T<d.numKeypoints;++T){var E=d.keypointCoordOffset+T*d.numValuesPerKeypoint,C=void 0,I=void 0;d.reverseOutputOrder?(C=Yn(Kt(c,[0,E],[-1,1])),I=Yn(Kt(c,[0,E+1],[-1,1]))):(I=Yn(Kt(c,[0,E],[-1,1])),C=Yn(Kt(c,[0,E+1],[-1,1])));var A=He(se(ct(C,d.xScale),u.w),u.x),k=He(se(ct(I,d.yScale),u.h),u.y);_=Qr([_,de(A,[d.numBoxes,1]),de(k,[d.numBoxes,1])],1)}return _})}(i,e,n),a=ve(function(){var c=r;return n.sigmoidScore?(n.scoreClippingThresh!=null&&(c=Ha(r,-n.scoreClippingThresh,n.scoreClippingThresh)),c=Ko(c)):c}),[4,J8e(s,a,n)];case 1:return o=l.sent(),Bt([s,a]),[2,o]}})})}function J8e(t,e,n){return Dn(this,void 0,void 0,function(){var r,i,s,a,o,l,c,u,d,h,f,p;return $n(this,function(g){switch(g.label){case 0:return r=[],[4,t.data()];case 1:return i=g.sent(),[4,e.data()];case 2:for(s=g.sent(),a=0;a<n.numBoxes;++a)if(!(n.minScoreThresh!=null&&s[a]<n.minScoreThresh||(o=a*n.numCoords,l=e9e(i[o+0],i[o+1],i[o+2],i[o+3],s[a],n.flipVertically,a),(c=l.locationData.relativeBoundingBox).width<0||c.height<0))){if(n.numKeypoints>0)for((u=l.locationData).relativeKeypoints=[],d=n.numKeypoints*n.numValuesPerKeypoint,h=0;h<d;h+=n.numValuesPerKeypoint)f=o+n.keypointCoordOffset+h,p={x:i[f+0],y:n.flipVertically?1-i[f+1]:i[f+1]},u.relativeKeypoints.push(p);r.push(l)}return[2,r]}})})}function e9e(t,e,n,r,i,s,a){return{score:[i],ind:a,locationData:{relativeBoundingBox:{xMin:e,yMin:s?1-n:t,xMax:r,yMax:s?1-t:n,width:r-e,height:n-t}}}}function t9e(t,e){return t==="none"?e:function(n){return 1/(1+Math.exp(-n))}(e)}function wX(t,e,n,r){return Dn(this,void 0,void 0,function(){var i,s,a,o,l,c,u,d;return $n(this,function(h){switch(h.label){case 0:return n=n||e.flipHorizontally||!1,r=r||e.flipVertically||!1,i=t.size,s=i/e.numLandmarks,[4,t.data()];case 1:for(a=h.sent(),o=[],l=0;l<e.numLandmarks;++l)c=l*s,(d={x:0,y:0}).x=n?e.inputImageWidth-a[c]:a[c],s>1&&(d.y=r?e.inputImageHeight-a[c+1]:a[c+1]),s>2&&(d.z=a[c+2]),s>3&&(d.score=t9e(e.visibilityActivation,a[c+3])),o.push(d);for(u=0;u<o.length;++u)(d=o[u]).x=d.x/e.inputImageWidth,d.y=d.y/e.inputImageHeight,d.z=d.z/e.inputImageWidth/(e.normalizeZ||1);return[2,o]}})})}function SX(t,e,n){var r=t.width,i=t.height,s=t.rotation;if(n.rotation==null&&n.rotationDegree==null||(s=function(c,u){return u.rotation!=null?c+=u.rotation:u.rotationDegree!=null&&(c+=Math.PI*u.rotationDegree/180),Hue(c)}(s,n)),s===0)t.xCenter=t.xCenter+r*n.shiftX,t.yCenter=t.yCenter+i*n.shiftY;else{var a=(e.width*r*n.shiftX*Math.cos(s)-e.height*i*n.shiftY*Math.sin(s))/e.width,o=(e.width*r*n.shiftX*Math.sin(s)+e.height*i*n.shiftY*Math.cos(s))/e.height;t.xCenter=t.xCenter+a,t.yCenter=t.yCenter+o}{var l=Math.max(r*e.width,i*e.height);r=l/e.width,i=l/e.height}return t.width=r*n.scaleX,t.height=i*n.scaleY,t}function n9e(t,e){return t.map(function(n){var r=Sr(Sr({},n),{x:n.x/e.width,y:n.y/e.height});return n.z!=null&&(n.z=n.z/e.width),r})}var yf=function(){function t(e){this.alpha=e,this.initialized=!1}return t.prototype.apply=function(e,n){var r;return this.initialized?r=n==null?this.storedValue+this.alpha*(e-this.storedValue):this.storedValue+this.alpha*n*Math.asinh((e-this.storedValue)/n):(r=e,this.initialized=!0),this.rawValue=e,this.storedValue=r,r},t.prototype.applyWithAlpha=function(e,n,r){return this.alpha=n,this.apply(e,r)},t.prototype.hasLastRawValue=function(){return this.initialized},t.prototype.lastRawValue=function(){return this.rawValue},t.prototype.reset=function(){this.initialized=!1},t}(),W$=function(){function t(e){this.frequency=e.frequency,this.minCutOff=e.minCutOff,this.beta=e.beta,this.thresholdCutOff=e.thresholdCutOff,this.thresholdBeta=e.thresholdBeta,this.derivateCutOff=e.derivateCutOff,this.x=new yf(this.getAlpha(this.minCutOff)),this.dx=new yf(this.getAlpha(this.derivateCutOff)),this.lastTimestamp=0}return t.prototype.apply=function(e,n,r){if(e==null)return e;var i=Math.trunc(n);if(this.lastTimestamp>=i)return e;this.lastTimestamp!==0&&i!==0&&(this.frequency=1/(1e-6*(i-this.lastTimestamp))),this.lastTimestamp=i;var s=this.x.hasLastRawValue()?(e-this.x.lastRawValue())*r*this.frequency:0,a=this.dx.applyWithAlpha(s,this.getAlpha(this.derivateCutOff)),o=this.minCutOff+this.beta*Math.abs(a),l=this.thresholdCutOff!=null?this.thresholdCutOff+this.thresholdBeta*Math.abs(a):null;return this.x.applyWithAlpha(e,this.getAlpha(o),l)},t.prototype.getAlpha=function(e){return 1/(1+this.frequency/(2*Math.PI*e))},t}(),kj=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var i=this;if(e==null)return this.reset(),null;this.initializeFiltersIfEmpty(e);var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Am([],e,!0);s=1/r}return e.map(function(a,o){var l=Sr(Sr({},a),{x:i.xFilters[o].apply(a.x,n,s),y:i.yFilters[o].apply(a.y,n,s)});return a.z!=null&&(l.z=i.zFilters[o].apply(a.z,n,s)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new W$(n.config)}),this.yFilters=e.map(function(r){return new W$(n.config)}),this.zFilters=e.map(function(r){return new W$(n.config)}))},t}(),H$=function(){function t(e){this.config=e,this.window=[],this.lowPassFilter=new yf(1),this.lastValue=0,this.lastValueScale=1,this.lastTimestamp=-1}return t.prototype.apply=function(e,n,r){if(e==null)return e;var i,s=Math.trunc(n);if(this.lastTimestamp>=s)return e;if(this.lastTimestamp===-1)i=1;else{for(var a=e*r-this.lastValue*this.lastValueScale,o=s-this.lastTimestamp,l=a,c=o,u=(1+this.window.length)*(1e6/30),d=0,h=this.window;d<h.length;d++){var f=h[d];if(c+f.duration>u)break;l+=f.distance,c+=f.duration}var p=l/(1e-6*c);i=1-1/(1+this.config.velocityScale*Math.abs(p)),this.window.unshift({distance:a,duration:o}),this.window.length>this.config.windowSize&&this.window.pop()}return this.lastValue=e,this.lastValueScale=r,this.lastTimestamp=s,this.lowPassFilter.applyWithAlpha(e,i)},t}(),r9e=function(){function t(e){this.config=e}return t.prototype.apply=function(e,n,r){var i=this;if(e==null)return this.reset(),null;var s=1;if(!this.config.disableValueScaling){if(r<this.config.minAllowedObjectScale)return Am([],e,!0);s=1/r}return this.initializeFiltersIfEmpty(e),e.map(function(a,o){var l=Sr(Sr({},a),{x:i.xFilters[o].apply(a.x,n,s),y:i.yFilters[o].apply(a.y,n,s)});return a.z!=null&&(l.z=i.zFilters[o].apply(a.z,n,s)),l})},t.prototype.reset=function(){this.xFilters=null,this.yFilters=null,this.zFilters=null},t.prototype.initializeFiltersIfEmpty=function(e){var n=this;this.xFilters!=null&&this.xFilters.length===e.length||(this.xFilters=e.map(function(r){return new H$(n.config)}),this.yFilters=e.map(function(r){return new H$(n.config)}),this.zFilters=e.map(function(r){return new H$(n.config)}))},t}(),G$=function(){function t(e){if(e.velocityFilter!=null)this.keypointsFilter=new r9e(e.velocityFilter);else{if(e.oneEuroFilter==null)throw new Error("Either configure velocityFilter or oneEuroFilter, but got "+"".concat(e,"."));this.keypointsFilter=new kj(e.oneEuroFilter)}}return t.prototype.apply=function(e,n,r,i,s){if(i===void 0&&(i=!1),e==null)return this.keypointsFilter.reset(),null;var a=s!=null?function(c,u){return(c.width*u.width+c.height*u.height)/2}(s,r):1,o=i?Yue(e,r):e,l=this.keypointsFilter.apply(o,n,a);return i?n9e(l,r):l},t}(),_X=function(){function t(e){this.alpha=e.alpha}return t.prototype.apply=function(e){var n=this;if(e==null)return this.visibilityFilters=null,null;this.visibilityFilters!=null&&this.visibilityFilters.length===e.length||(this.visibilityFilters=e.map(function(o){return new yf(n.alpha)}));for(var r=[],i=0;i<e.length;++i){var s=e[i],a=Sr({},s);a.score=this.visibilityFilters[i].apply(s.score),r.push(a)}return r},t}(),i9e={interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:5,minScale:.1484375,maxScale:.75,inputSizeHeight:224,inputSizeWidth:224,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,32,32,32],aspectRatios:[1],fixedAnchorSize:!0},Ly={runtime:"tfjs",modelType:"full",enableSmoothing:!0,enableSegmentation:!1,smoothSegmentation:!0,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/detector/1",landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"},s9e={maxPoses:1,flipHorizontal:!1},a9e={applyExponentialOnBoxSize:!1,flipVertically:!1,numBoxes:2254,numCoords:12,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:4,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:224,yScale:224,hScale:224,wScale:224,minScoreThresh:.5},o9e=.3,TX={shiftX:0,shiftY:0,scaleX:1.25,scaleY:1.25},l9e={outputTensorSize:{width:224,height:224},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},c9e={outputTensorSize:{width:256,height:256},keepAspectRatio:!0,outputTensorFloatRange:[0,1],borderMode:"zero"},u9e={numLandmarks:39,inputImageWidth:256,inputImageHeight:256,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},d9e={numLandmarks:39,inputImageWidth:1,inputImageHeight:1,visibilityActivation:"sigmoid",flipHorizontally:!1,flipVertically:!1},h9e={kernelSize:7,minConfidenceToRefine:.5},EX={alpha:.1},f9e={oneEuroFilter:{frequency:30,minCutOff:.05,beta:80,derivateCutOff:1,minAllowedObjectScale:1e-6}},p9e={oneEuroFilter:{frequency:30,minCutOff:.01,beta:10,derivateCutOff:1,minAllowedObjectScale:1e-6}},m9e={oneEuroFilter:{frequency:30,minCutOff:.1,beta:40,derivateCutOff:1,minAllowedObjectScale:1e-6,disableValueScaling:!0}},g9e={activation:"none"},y9e={combineWithPreviousRatio:.7},v9e=function(){function t(e){this.mask=e}return t.prototype.toCanvasImageSource=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,Uue(this.mask)]})})},t.prototype.toImageData=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,Vue(this.mask)]})})},t.prototype.toTensor=function(){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,this.mask]})})},t.prototype.getUnderlyingType=function(){return"tensor"},t}();function x9e(t){return Wue(t),"person"}var b9e=function(){function t(e,n,r,i,s,a){this.detectorModel=e,this.landmarkModel=n,this.enableSmoothing=r,this.enableSegmentation=i,this.smoothSegmentation=s,this.modelType=a,this.regionOfInterest=null,this.prevFilteredSegmentationMask=null,this.anchors=function(d){d.reduceBoxesInLowestLayer==null&&(d.reduceBoxesInLowestLayer=!1),d.interpolatedScaleAspectRatio==null&&(d.interpolatedScaleAspectRatio=1),d.fixedAnchorSize==null&&(d.fixedAnchorSize=!1);for(var h=[],f=0;f<d.numLayers;){for(var p=[],g=[],m=[],y=[],x=f;x<d.strides.length&&d.strides[x]===d.strides[f];){var b=vX(d.minScale,d.maxScale,x,d.strides.length);if(x===0&&d.reduceBoxesInLowestLayer)m.push(1),m.push(2),m.push(.5),y.push(.1),y.push(b),y.push(b);else{for(var _=0;_<d.aspectRatios.length;++_)m.push(d.aspectRatios[_]),y.push(b);if(d.interpolatedScaleAspectRatio>0){var T=x===d.strides.length-1?1:vX(d.minScale,d.maxScale,x+1,d.strides.length);y.push(Math.sqrt(b*T)),m.push(d.interpolatedScaleAspectRatio)}}x++}for(var E=0;E<m.length;++E){var C=Math.sqrt(m[E]);p.push(y[E]/C),g.push(y[E]*C)}var I=0,A=0;if(d.featureMapHeight.length>0)I=d.featureMapHeight[f],A=d.featureMapWidth[f];else{var k=d.strides[f];I=Math.ceil(d.inputSizeHeight/k),A=Math.ceil(d.inputSizeWidth/k)}for(var R=0;R<I;++R)for(var $=0;$<A;++$)for(var z=0;z<p.length;++z){var O={xCenter:($+d.anchorOffsetX)/A,yCenter:(R+d.anchorOffsetY)/I,width:0,height:0};d.fixedAnchorSize?(O.width=1,O.height=1):(O.width=g[z],O.height=p[z]),h.push(O)}f=x}return h}(i9e);var o=Oi(this.anchors.map(function(d){return d.width})),l=Oi(this.anchors.map(function(d){return d.height})),c=Oi(this.anchors.map(function(d){return d.xCenter})),u=Oi(this.anchors.map(function(d){return d.yCenter}));this.anchorTensor={x:c,y:u,w:o,h:l},this.prevFilteredSegmentationMask=this.enableSegmentation?Ul([],[0,0]):null}return t.prototype.estimatePoses=function(e,n,r){return Dn(this,void 0,void 0,function(){var i,s,a,o,l,c,u,d,h,f,p,g,m,y,x,b,_,T,E,C,I,A,k;return $n(this,function(R){switch(R.label){case 0:return i=function($){var z;if((z=$==null?s9e:Sr({},$)).maxPoses==null&&(z.maxPoses=1),z.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(z.maxPoses,". Should be > 0."));if(z.maxPoses>1)throw new Error("Multi-pose detection is not implemented yet. Please set maxPoses to 1.");return z}(n),e==null?(this.reset(),[2,[]]):(this.maxPoses=i.maxPoses,this.timestamp=r!=null?1e3*r:Kue(e)?1e6*e.currentTime:null,s=e0(e),a=ve(function(){return nt(D5(e),"float32")}),(o=this.regionOfInterest)!=null?[3,2]:[4,this.detectPose(a)]);case 1:if((l=R.sent()).length===0)return this.reset(),a.dispose(),[2,[]];c=l[0],o=this.poseDetectionToRoi(c,s),R.label=2;case 2:return[4,this.poseLandmarksByRoi(o,a)];case 3:return u=R.sent(),a.dispose(),u==null?(this.reset(),[2,[]]):(d=u.landmarks,h=u.auxiliaryLandmarks,f=u.poseScore,p=u.worldLandmarks,g=u.segmentationMask,m=this.poseLandmarkFiltering(d,h,p,s),y=m.actualLandmarksFiltered,x=m.auxiliaryLandmarksFiltered,b=m.actualWorldLandmarksFiltered,_=this.poseLandmarksToRoi(x,s),this.regionOfInterest=_,T=this.smoothSegmentation&&g!=null?this.poseSegmentationFiltering(g):g,(E=y!=null?Yue(y,s):null)!=null&&E.forEach(function($,z){$.name=sS[z]}),(C=b)!=null&&C.forEach(function($,z){$.name=sS[z]}),I={score:f,keypoints:E,keypoints3D:C},T!==null&&(A=ve(function(){var $=Mi(T,2),z=Gc($,[[0,0],[0,0],[0,1]]);return pW(z,[[0,0],[0,0],[0,2]],"symmetric")}),this.smoothSegmentation||Bt(T),k={maskValueToLabel:x9e,mask:new v9e(A)},I.segmentation=k),[2,[I]])}})})},t.prototype.poseSegmentationFiltering=function(e){var n=this.prevFilteredSegmentationMask;return n.size===0?this.prevFilteredSegmentationMask=e:(this.prevFilteredSegmentationMask=Z8e(n,e,y9e),Bt(e)),Bt(n),this.prevFilteredSegmentationMask},t.prototype.dispose=function(){this.detectorModel.dispose(),this.landmarkModel.dispose(),Bt([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h,this.prevFilteredSegmentationMask])},t.prototype.reset=function(){this.regionOfInterest=null,this.enableSegmentation&&(Bt(this.prevFilteredSegmentationMask),this.prevFilteredSegmentationMask=Ul([],[0,0])),this.visibilitySmoothingFilterActual=null,this.visibilitySmoothingFilterAuxiliary=null,this.landmarksSmoothingFilterActual=null,this.landmarksSmoothingFilterAuxiliary=null},t.prototype.detectPose=function(e){return Dn(this,void 0,void 0,function(){var n,r,i,s,a,o,l,c,u,d;return $n(this,function(h){switch(h.label){case 0:return n=Ij(e,l9e),r=n.imageTensor,i=n.padding,s=this.detectorModel.predict(r),a=X8e(s),o=a.boxes,[4,Q8e([l=a.logits,o],this.anchorTensor,a9e)];case 1:return(c=h.sent()).length===0?(Bt([r,s,l,o]),[2,c]):[4,K8e(c,this.maxPoses,o9e)];case 2:return u=h.sent(),d=function(f,p){f===void 0&&(f=[]);for(var g=p.left,m=p.top,y=p.left+p.right,x=p.top+p.bottom,b=0;b<f.length;b++){var _=f[b],T=_.locationData.relativeBoundingBox,E=(T.xMin-g)/(1-y),C=(T.yMin-m)/(1-x),I=T.width/(1-y),A=T.height/(1-x);T.xMin=E,T.yMin=C,T.width=I,T.height=A,T.xMax=E+I,T.yMax=C+A;var k=_.locationData.relativeKeypoints;k&&k.forEach(function(R){var $=(R.x-g)/(1-y),z=(R.y-m)/(1-x);R.x=$,R.y=z})}return f}(u,i),Bt([r,s,l,o]),[2,d]}})})},t.prototype.poseDetectionToRoi=function(e,n){return SX(U$(e,n,{rotationVectorEndKeypointIndex:1,rotationVectorStartKeypointIndex:0,rotationVectorTargetAngleDegree:90}),n,TX)},t.prototype.poseLandmarksByRoi=function(e,n){return Dn(this,void 0,void 0,function(){var r,i,s,a,o,l,c,u,d,h,f,p,g,m;return $n(this,function(y){switch(y.label){case 0:if(r=e0(n),i=Ij(n,c9e,e),s=i.imageTensor,a=i.padding,o=i.transformationMatrix,this.modelType!=="lite"&&this.modelType!=="full"&&this.modelType!=="heavy")throw new Error("Model type must be one of lite, full or heavy,"+"but got ".concat(this.modelType));return l=["ld_3d","output_poseflag","activation_heatmap","world_3d"],this.enableSegmentation&&l.push("activation_segmentation"),c=this.landmarkModel.execute(s,l),[4,this.tensorsToPoseLandmarksAndSegmentation(c)];case 1:return(u=y.sent())==null?(Bt(c),Bt(s),[2,null]):(d=u.landmarks,h=u.auxiliaryLandmarks,f=u.poseScore,p=u.worldLandmarks,g=u.segmentationMask,[4,this.poseLandmarksAndSegmentationInverseProjection(r,e,a,o,d,h,p,g)]);case 2:return m=y.sent(),Bt(c),Bt(s),[2,Sr({poseScore:f},m)]}})})},t.prototype.poseLandmarksAndSegmentationInverseProjection=function(e,n,r,i,s,a,o,l){return Dn(this,void 0,void 0,function(){var c,u,d,h,f,p;return $n(this,function(g){return c=bX(s,r),u=bX(a,r),d=yX(c,n),h=yX(u,n),f=function(m,y){for(var x=[],b=0,_=m;b<_.length;b++){var T=_[b],E=T.x,C=T.y,I=y.rotation,A=Math.cos(I)*E-Math.sin(I)*C,k=Math.sin(I)*E+Math.cos(I)*C,R=Sr({},T);R.x=A,R.y=k,x.push(R)}return x}(o,n),p=null,this.enableSegmentation&&(p=ve(function(){var m=l.shape,y=m[0],x=m[1],b=function(E){var C=que(new Array(16).fill(0));C[0][0]=na(E,0,0),C[1][0]=-na(E,0,1),C[2][0]=na(E,0,2),C[3][0]=-na(E,0,3),C[0][2]=na(E,2,0),C[1][2]=-na(E,2,1),C[2][2]=na(E,2,2),C[3][2]=-na(E,2,3),C[0][1]=-na(E,1,0),C[1][1]=na(E,1,1),C[2][1]=-na(E,1,2),C[3][1]=na(E,1,3),C[0][3]=-na(E,3,0),C[1][3]=na(E,3,1),C[2][3]=-na(E,3,2),C[3][3]=na(E,3,3);for(var I=E[0][0]*C[0][0]+E[1][0]*C[0][1]+E[2][0]*C[0][2]+E[3][0]*C[0][3],A=0;A<C.length;A++)for(var k=0;k<C.length;k++)C[A][k]/=I;return C}(i),_=Ul(Gue(b,{width:x,height:y},e),[1,8]),T=[1,y,x,1];return Yn(ma.transform(de(l,T),_,"bilinear","constant",0,[e.height,e.width]),[0,3])}),Bt(l)),[2,{landmarks:d,auxiliaryLandmarks:h,worldLandmarks:f,segmentationMask:p}]})})},t.prototype.tensorsToPoseLandmarksAndSegmentation=function(e){return Dn(this,void 0,void 0,function(){var n,r,i,s,a,o,l,c,u,d,h,f,p;return $n(this,function(g){switch(g.label){case 0:return n=e[0],r=e[1],i=e[2],s=e[3],a=this.enableSegmentation?e[4]:null,[4,r.data()];case 1:return(o=g.sent()[0])<.5?[2,null]:[4,wX(n,u9e)];case 2:return[4,Y8e(g.sent(),i,h9e)];case 3:return l=g.sent(),c=l.slice(0,33),u=l.slice(33,35),[4,wX(s,d9e)];case 4:return d=g.sent(),h=d.slice(0,33),f=function(m,y,x){for(var b=[],_=0;_<m.length;_++){var T=Sr({},y[_]);T.score=m[_].score,b.push(T)}return b}(c,h),p=this.enableSegmentation?function(m,y,x){return ve(function(){var b=Yn(m,[0]),_=b.shape[2];if(_===1){var T=b;switch(y.activation){case"none":break;case"sigmoid":T=Ko(T);break;case"softmax":throw new Error("Softmax activation requires two channels.");default:throw new Error("Activation not supported (".concat(y.activation,")"))}var E=T;return Yn(E,[2])}throw new Error("Unsupported number of tensor channels ".concat(_))})}(a,g9e):null,[2,{landmarks:c,auxiliaryLandmarks:u,poseScore:o,worldLandmarks:f,segmentationMask:p}]}})})},t.prototype.poseLandmarksToRoi=function(e,n){return SX(U$(xX(e),n,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:90}),n,TX)},t.prototype.poseLandmarkFiltering=function(e,n,r,i){var s,a,o;if(this.timestamp!=null&&this.enableSmoothing){var l=U$(xX(n),i,{rotationVectorEndKeypointIndex:0,rotationVectorStartKeypointIndex:1,rotationVectorTargetAngleDegree:90});this.visibilitySmoothingFilterActual==null&&(this.visibilitySmoothingFilterActual=new _X(EX)),s=this.visibilitySmoothingFilterActual.apply(e),this.visibilitySmoothingFilterAuxiliary==null&&(this.visibilitySmoothingFilterAuxiliary=new _X(EX)),a=this.visibilitySmoothingFilterAuxiliary.apply(n),o=this.visibilitySmoothingFilterActual.apply(r),this.landmarksSmoothingFilterActual==null&&(this.landmarksSmoothingFilterActual=new G$(f9e)),s=this.landmarksSmoothingFilterActual.apply(s,this.timestamp,i,!0,l),this.landmarksSmoothingFilterAuxiliary==null&&(this.landmarksSmoothingFilterAuxiliary=new G$(p9e)),a=this.landmarksSmoothingFilterAuxiliary.apply(a,this.timestamp,i,!0,l),this.worldLandmarksSmoothingFilterActual==null&&(this.worldLandmarksSmoothingFilterActual=new G$(m9e)),o=this.worldLandmarksSmoothingFilterActual.apply(r,this.timestamp)}else s=e,a=n,o=r;return{actualLandmarksFiltered:s,auxiliaryLandmarksFiltered:a,actualWorldLandmarksFiltered:o}},t}();function w9e(t){return Dn(this,void 0,void 0,function(){var e,n,r,i,s,a;return $n(this,function(o){switch(o.label){case 0:return e=function(l){var c=Sr({},l??Ly);if(c.enableSmoothing==null&&(c.enableSmoothing=Ly.enableSmoothing),c.enableSegmentation==null&&(c.enableSegmentation=Ly.enableSegmentation),c.smoothSegmentation==null&&(c.smoothSegmentation=Ly.smoothSegmentation),c.modelType==null&&(c.modelType=Ly.modelType),c.detectorModelUrl==null&&(c.detectorModelUrl=Ly.detectorModelUrl),c.landmarkModelUrl==null)switch(c.modelType){case"lite":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/lite/2";break;case"heavy":c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/heavy/2";break;case"full":default:c.landmarkModelUrl="https://tfhub.dev/mediapipe/tfjs-model/blazepose_3d/landmark/full/2"}return c}(t),n=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,r=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Promise.all([Jx(e.detectorModelUrl,{fromTFHub:n}),Jx(e.landmarkModelUrl,{fromTFHub:r})])];case 1:return i=o.sent(),s=i[0],a=i[1],[2,new b9e(s,a,e.enableSmoothing,e.enableSegmentation,e.smoothSegmentation,e.modelType)]}})})}var Km,$u,Zue=function(){function t(e){(function(n){if(n.maxTracks<1)throw new Error("Must specify 'maxTracks' to be at least 1, but "+"encountered ".concat(n.maxTracks));if(n.maxAge<=0)throw new Error("Must specify 'maxAge' to be positive, but "+"encountered ".concat(n.maxAge));if(n.keypointTrackerParams!==void 0){if(n.keypointTrackerParams.keypointConfidenceThreshold<0||n.keypointTrackerParams.keypointConfidenceThreshold>1)throw new Error("Must specify 'keypointConfidenceThreshold' to be in the range [0, 1], but encountered "+"".concat(n.keypointTrackerParams.keypointConfidenceThreshold));if(n.keypointTrackerParams.minNumberOfKeypoints<1)throw new Error("Must specify 'minNumberOfKeypoints' to be at least 1, but "+"encountered ".concat(n.keypointTrackerParams.minNumberOfKeypoints));for(var r=0,i=n.keypointTrackerParams.keypointFalloff;r<i.length;r++){var s=i[r];if(s<=0)throw new Error("Must specify each keypoint falloff parameterto be positive "+"but encountered ".concat(s))}}})(e),this.tracks=[],this.maxTracks=e.maxTracks,this.maxAge=1e3*e.maxAge,this.minSimilarity=e.minSimilarity,this.nextID=1}return t.prototype.apply=function(e,n){this.filterOldTracks(n);var r=this.computeSimilarity(e);return this.assignTracks(e,r,n),this.updateTracks(n),e},t.prototype.getTracks=function(){return this.tracks.slice()},t.prototype.getTrackIDs=function(){return new Set(this.tracks.map(function(e){return e.id}))},t.prototype.filterOldTracks=function(e){var n=this;this.tracks=this.tracks.filter(function(r){return e-r.lastTimestamp<=n.maxAge})},t.prototype.assignTracks=function(e,n,r){for(var i=Array.from(Array(n[0].length).keys()),s=[],a=0,o=Array.from(Array(e.length).keys());a<o.length;a++){var l=o[a];if(i.length!==0){for(var c=-1,u=-1,d=0,h=i;d<h.length;d++){var f=h[d],p=n[l][f];p>=this.minSimilarity&&p>u&&(c=f,u=p)}if(c>=0){var g=this.tracks[c];g=Object.assign(g,this.createTrack(e[l],r,g.id)),e[l].id=g.id;var m=i.indexOf(c);i.splice(m,1)}else s.push(l)}else s.push(l)}for(var y=0,x=s;y<x.length;y++){l=x[y];var b=this.createTrack(e[l],r);this.tracks.push(b),e[l].id=b.id}},t.prototype.updateTracks=function(e){this.tracks.sort(function(n,r){return r.lastTimestamp-n.lastTimestamp}),this.tracks=this.tracks.slice(0,this.maxTracks)},t.prototype.createTrack=function(e,n,r){var i={id:r||this.nextTrackID(),lastTimestamp:n,keypoints:Am([],e.keypoints,!0).map(function(s){return Sr({},s)})};return e.box!==void 0&&(i.box=Sr({},e.box)),i},t.prototype.nextTrackID=function(){var e=this.nextID;return this.nextID+=1,e},t.prototype.remove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this.tracks=this.tracks.filter(function(r){return!e.includes(r.id)})},t.prototype.reset=function(){this.tracks=[]},t}(),S9e=function(t){function e(n){return t.call(this,n)||this}return Bue(e,t),e.prototype.computeSimilarity=function(n){var r=this;return n.length===0||this.tracks.length===0?[[]]:n.map(function(i){return r.tracks.map(function(s){return r.iou(i,s)})})},e.prototype.iou=function(n,r){var i=Math.max(n.box.xMin,r.box.xMin),s=Math.max(n.box.yMin,r.box.yMin),a=Math.min(n.box.xMax,r.box.xMax),o=Math.min(n.box.yMax,r.box.yMax);if(i>=a||s>=o)return 0;var l=(a-i)*(o-s);return l/(n.box.width*n.box.height+r.box.width*r.box.height-l)},e}(Zue),_9e=function(t){function e(n){var r=t.call(this,n)||this;return r.keypointThreshold=n.keypointTrackerParams.keypointConfidenceThreshold,r.keypointFalloff=n.keypointTrackerParams.keypointFalloff,r.minNumKeyoints=n.keypointTrackerParams.minNumberOfKeypoints,r}return Bue(e,t),e.prototype.computeSimilarity=function(n){if(n.length===0||this.tracks.length===0)return[[]];for(var r=[],i=0,s=n;i<s.length;i++){for(var a=s[i],o=[],l=0,c=this.tracks;l<c.length;l++){var u=c[l];o.push(this.oks(a,u))}r.push(o)}return r},e.prototype.oks=function(n,r){for(var i=this.area(r.keypoints)+1e-6,s=0,a=0,o=0;o<n.keypoints.length;++o){var l=n.keypoints[o],c=r.keypoints[o];if(!(l.score<this.keypointThreshold||c.score<this.keypointThreshold)){a+=1;var u=Math.pow(l.x-c.x,2)+Math.pow(l.y-c.y,2),d=2*this.keypointFalloff[o];s+=Math.exp(-1*u/(2*i*Math.pow(d,2)))}}return a<this.minNumKeyoints?0:s/a},e.prototype.area=function(n){var r=this,i=n.filter(function(l){return l.score>r.keypointThreshold}),s=Math.min.apply(Math,Am([1],i.map(function(l){return l.x}),!1)),a=Math.max.apply(Math,Am([0],i.map(function(l){return l.x}),!1)),o=Math.min.apply(Math,Am([1],i.map(function(l){return l.y}),!1));return(a-s)*(Math.max.apply(Math,Am([0],i.map(function(l){return l.y}),!1))-o)},e}(Zue);function T9e(t){switch(t){case $u.BlazePose:return sS.reduce(function(e,n,r){return e[n]=r,e},{});case $u.PoseNet:case $u.MoveNet:return Xu.reduce(function(e,n,r){return e[n]=r,e},{});default:throw new Error("Model ".concat(t," is not supported."))}}(function(t){t.Keypoint="keypoint",t.BoundingBox="boundingBox"})(Km||(Km={})),function(t){t.MoveNet="MoveNet",t.BlazePose="BlazePose",t.PoseNet="PoseNet"}($u||($u={}));var CX=["SinglePose.Lightning","SinglePose.Thunder","MultiPose.Lightning"],Que={modelType:"SinglePose.Lightning",enableSmoothing:!0},NX={},AX={frequency:30,minCutOff:2.5,beta:300,derivateCutOff:2.5,thresholdCutOff:.5,thresholdBeta:5,disableValueScaling:!0},q$={maxTracks:18,maxAge:1e3,minSimilarity:.2,keypointTrackerParams:{keypointConfidenceThreshold:.3,keypointFalloff:[.026,.025,.025,.035,.035,.079,.079,.072,.072,.062,.062,.107,.107,.087,.087,.089,.089],minNumberOfKeypoints:4}},IX={maxTracks:18,maxAge:1e3,minSimilarity:.15,trackerParams:{}};function E9e(t,e,n,r){for(var i={},s=0,a=Xu;s<a.length;s++){var o=a[s];i[o]=[e[n[o]].y*r.height,e[n[o]].x*r.width]}if(function(x,b){return(x[b.left_hip].score>.2||x[b.right_hip].score>.2)&&(x[b.left_shoulder].score>.2||x[b.right_shoulder].score>.2)}(e,n)){var l=(i.left_hip[0]+i.right_hip[0])/2,c=(i.left_hip[1]+i.right_hip[1])/2,u=function(x,b,_,T,E){for(var C=["left_shoulder","right_shoulder","left_hip","right_hip"],I=0,A=0,k=0;k<C.length;k++)(j=Math.abs(T-_[C[k]][0]))>I&&(I=j),(B=Math.abs(E-_[C[k]][1]))>A&&(A=B);for(var R=0,$=0,z=0,O=Object.keys(_);z<O.length;z++){var j,B,W=O[z];x[b[W]].score<.2||((j=Math.abs(T-_[W][0]))>R&&(R=j),(B=Math.abs(E-_[W][1]))>$&&($=B))}return[I,A,R,$]}(e,n,i,l,c),d=u[0],h=u[1],f=u[2],p=u[3],g=Math.max(1.9*h,1.9*d,1.2*f,1.2*p),m=[l-(g=Math.min(g,Math.max(c,r.width-c,l,r.height-l))),c-g];if(g>Math.max(r.width,r.height)/2)return Mj(t==null,r);var y=2*g;return{yMin:m[0]/r.height,xMin:m[1]/r.width,yMax:(m[0]+y)/r.height,xMax:(m[1]+y)/r.width,height:(m[0]+y)/r.height-m[0]/r.height,width:(m[1]+y)/r.width-m[1]/r.width}}return Mj(t==null,r)}function Mj(t,e){var n,r,i,s;return t?e.width>e.height?(n=1,r=e.height/e.width,i=0,s=(e.width/2-e.height/2)/e.width):(n=e.width/e.height,r=1,i=(e.height/2-e.width/2)/e.height,s=0):e.width>e.height?(n=e.width/e.height,r=1,i=(e.height/2-e.width/2)/e.height,s=0):(n=1,r=e.height/e.width,i=0,s=(e.width/2-e.height/2)/e.width),{yMin:i,xMin:s,yMax:i+n,xMax:s+r,height:n,width:r}}function C9e(t){var e,n=t==null?Que:Sr({},t);if(n.modelType==null)n.modelType="SinglePose.Lightning";else if(CX.indexOf(n.modelType)<0)throw new Error("Invalid architecture ".concat(n.modelType,". ")+"Should be one of ".concat(CX));if(n.enableSmoothing==null&&(n.enableSmoothing=!0),n.minPoseScore!=null&&(n.minPoseScore<0||n.minPoseScore>1))throw new Error("minPoseScore should be between 0.0 and 1.0");if(n.multiPoseMaxDimension!=null&&(n.multiPoseMaxDimension%32!=0||n.multiPoseMaxDimension<32))throw new Error("multiPoseMaxDimension must be a multiple of 32 and higher than 0");if(n.modelType==="MultiPose.Lightning"&&n.enableTracking==null&&(n.enableTracking=!0),n.modelType==="MultiPose.Lightning"&&n.enableTracking===!0)if(n.trackerType==null&&(n.trackerType=Km.BoundingBox),n.trackerType===Km.Keypoint)n.trackerConfig!=null?n.trackerConfig=function(r){var i=kX(q$,r);return i.keypointTrackerParams=Sr({},q$.keypointTrackerParams),r.keypointTrackerParams!=null&&(r.keypointTrackerParams.keypointConfidenceThreshold!=null&&(i.keypointTrackerParams.keypointConfidenceThreshold=r.keypointTrackerParams.keypointConfidenceThreshold),r.keypointTrackerParams.keypointFalloff!=null&&(i.keypointTrackerParams.keypointFalloff=r.keypointTrackerParams.keypointFalloff),r.keypointTrackerParams.minNumberOfKeypoints!=null&&(i.keypointTrackerParams.minNumberOfKeypoints=r.keypointTrackerParams.minNumberOfKeypoints)),i}(n.trackerConfig):n.trackerConfig=q$;else{if(n.trackerType!==Km.BoundingBox)throw new Error("Tracker type not supported by MoveNet");n.trackerConfig!=null?n.trackerConfig=(e=n.trackerConfig,kX(IX,e)):n.trackerConfig=IX}return n}function kX(t,e){var n={maxTracks:t.maxTracks,maxAge:t.maxAge,minSimilarity:t.minSimilarity};return e.maxTracks!=null&&(n.maxTracks=e.maxTracks),e.maxAge!=null&&(n.maxAge=e.maxAge),e.minSimilarity!=null&&(n.minSimilarity=e.minSimilarity),n}var N9e=function(){function t(e,n){this.moveNetModel=e,this.modelInputResolution={height:0,width:0},this.keypointIndexByName=T9e($u.MoveNet),n.modelType==="SinglePose.Lightning"?(this.modelInputResolution.width=192,this.modelInputResolution.height=192):n.modelType==="SinglePose.Thunder"&&(this.modelInputResolution.width=256,this.modelInputResolution.height=256),this.multiPoseModel=n.modelType==="MultiPose.Lightning",this.multiPoseModel||(this.keypointFilter=new kj(AX),this.cropRegionFilterYMin=new yf(.9),this.cropRegionFilterXMin=new yf(.9),this.cropRegionFilterYMax=new yf(.9),this.cropRegionFilterXMax=new yf(.9)),this.enableSmoothing=n.enableSmoothing,n.minPoseScore?this.minPoseScore=n.minPoseScore:this.minPoseScore=.25,n.multiPoseMaxDimension?this.multiPoseMaxDimension=n.multiPoseMaxDimension:this.multiPoseMaxDimension=256,this.enableTracking=n.enableTracking,this.multiPoseModel&&this.enableTracking&&(n.trackerType===Km.Keypoint?this.tracker=new _9e(n.trackerConfig):n.trackerType===Km.BoundingBox&&(this.tracker=new S9e(n.trackerConfig)),this.enableSmoothing&&(this.keypointFilterMap=new Map))}return t.prototype.runSinglePersonPoseModel=function(e){return Dn(this,void 0,void 0,function(){var n,r,i,s,a;return $n(this,function(o){switch(o.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==4||n.shape[0]!==1||n.shape[1]!==1||n.shape[2]!==17||n.shape[3]!==3)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return q1()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=o.sent(),o.label=3;case 3:for(n.dispose(),i={keypoints:[],score:0},s=0,a=0;a<17;++a)i.keypoints[a]={y:r[3*a],x:r[3*a+1],score:r[3*a+2]},i.keypoints[a].score>.2&&(++s,i.score+=i.keypoints[a].score);return s>0&&(i.score/=s),[2,i]}})})},t.prototype.runMultiPersonPoseModel=function(e){return Dn(this,void 0,void 0,function(){var n,r,i,s,a,o,l,c;return $n(this,function(u){switch(u.label){case 0:if((n=this.moveNetModel.execute(e)).shape.length!==3||n.shape[0]!==1||n.shape[2]!==56)throw n.dispose(),new Error("Unexpected output shape from model: [".concat(n.shape,"]"));return q1()==="webgpu"?[3,1]:(r=n.dataSync(),[3,3]);case 1:return[4,n.data()];case 2:r=u.sent(),u.label=3;case 3:for(n.dispose(),i=[],s=r.length/56,a=0;a<s;++a)for(i[a]={keypoints:[]},o=56*a+51,i[a].box={yMin:r[o],xMin:r[o+1],yMax:r[o+2],xMax:r[o+3],width:r[o+3]-r[o+1],height:r[o+2]-r[o]},l=56*a+55,i[a].score=r[l],i[a].keypoints=[],c=0;c<17;++c)i[a].keypoints[c]={y:r[56*a+3*c],x:r[56*a+3*c+1],score:r[56*a+3*c+2]};return[2,i]}})})},t.prototype.estimatePoses=function(e,n,r){return n===void 0&&(n=NX),Dn(this,void 0,void 0,function(){var i,s,a,o,l,c;return $n(this,function(u){switch(u.label){case 0:return n=function(d){return d==null?NX:Sr({},d)}(n),e==null?(this.reset(),[2,[]]):(r==null?Kue(e)&&(r=1e6*e.currentTime):r*=1e3,i=D5(e),s=e0(i),a=Mi(i,0),e instanceof rr||i.dispose(),o=[],this.multiPoseModel?[3,2]:[4,this.estimateSinglePose(a,s,r)]);case 1:return o=u.sent(),[3,4];case 2:return[4,this.estimateMultiplePoses(a,s,r)];case 3:o=u.sent(),u.label=4;case 4:for(l=0;l<o.length;++l)for(c=0;c<o[l].keypoints.length;++c)o[l].keypoints[c].name=Xu[c],o[l].keypoints[c].y*=s.height,o[l].keypoints[c].x*=s.width;return[2,o]}})})},t.prototype.estimateSinglePose=function(e,n,r){return Dn(this,void 0,void 0,function(){var i,s,a,o,l=this;return $n(this,function(c){switch(c.label){case 0:return this.cropRegion||(this.cropRegion=Mj(this.cropRegion==null,n)),i=ve(function(){var u=Ul([[l.cropRegion.yMin,l.cropRegion.xMin,l.cropRegion.yMax,l.cropRegion.xMax]]),d=Pi([1],"int32"),h=[l.modelInputResolution.height,l.modelInputResolution.width];return nt(ma.cropAndResize(e,u,d,h,"bilinear",0),"int32")}),e.dispose(),[4,this.runSinglePersonPoseModel(i)];case 1:if(s=c.sent(),i.dispose(),s.score<this.minPoseScore)return this.reset(),[2,[]];for(a=0;a<s.keypoints.length;++a)s.keypoints[a].y=this.cropRegion.yMin+s.keypoints[a].y*this.cropRegion.height,s.keypoints[a].x=this.cropRegion.xMin+s.keypoints[a].x*this.cropRegion.width;return r!=null&&this.enableSmoothing&&(s.keypoints=this.keypointFilter.apply(s.keypoints,r,1)),o=E9e(this.cropRegion,s.keypoints,this.keypointIndexByName,n),this.cropRegion=this.filterCropRegion(o),[2,[s]]}})})},t.prototype.estimateMultiplePoses=function(e,n,r){return Dn(this,void 0,void 0,function(){var i,s,a,o,l,c,u,d,h,f,p,g=this;return $n(this,function(m){switch(m.label){case 0:return n.width>n.height?(s=this.multiPoseMaxDimension,a=Math.round(this.multiPoseMaxDimension*n.height/n.width),i=ma.resizeBilinear(e,[a,s]),l=s,c=32*Math.ceil(a/32),o=Gc(i,[[0,0],[0,c-a],[0,0],[0,0]])):(s=Math.round(this.multiPoseMaxDimension*n.width/n.height),a=this.multiPoseMaxDimension,i=ma.resizeBilinear(e,[a,s]),l=32*Math.ceil(s/32),c=a,o=Gc(i,[[0,0],[0,0],[0,l-s],[0,0]])),i.dispose(),e.dispose(),u=nt(o,"int32"),o.dispose(),[4,this.runMultiPersonPoseModel(u)];case 1:for(d=m.sent(),u.dispose(),d=d.filter(function(y){return y.score>=g.minPoseScore}),f=0;f<d.length;++f)for(h=0;h<d[f].keypoints.length;++h)d[f].keypoints[h].y*=c/a,d[f].keypoints[h].x*=l/s;if(this.enableTracking&&(this.tracker.apply(d,r),this.enableSmoothing)){for(f=0;f<d.length;++f)this.keypointFilterMap.has(d[f].id)||this.keypointFilterMap.set(d[f].id,new kj(AX)),d[f].keypoints=this.keypointFilterMap.get(d[f].id).apply(d[f].keypoints,r,1);p=this.tracker.getTrackIDs(),this.keypointFilterMap.forEach(function(y,x){p.has(x)||g.keypointFilterMap.delete(x)})}return[2,d]}})})},t.prototype.filterCropRegion=function(e){if(e){var n=this.cropRegionFilterYMin.apply(e.yMin),r=this.cropRegionFilterXMin.apply(e.xMin),i=this.cropRegionFilterYMax.apply(e.yMax),s=this.cropRegionFilterXMax.apply(e.xMax);return{yMin:n,xMin:r,yMax:i,xMax:s,height:i-n,width:s-r}}return this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset(),null},t.prototype.dispose=function(){this.moveNetModel.dispose()},t.prototype.reset=function(){this.cropRegion=null,this.resetFilters()},t.prototype.resetFilters=function(){this.keypointFilter.reset(),this.cropRegionFilterYMin.reset(),this.cropRegionFilterXMin.reset(),this.cropRegionFilterYMax.reset(),this.cropRegionFilterXMax.reset()},t}();function A9e(t){return t===void 0&&(t=Que),Dn(this,void 0,void 0,function(){var e,n,r,i;return $n(this,function(s){switch(s.label){case 0:return e=C9e(t),r=!0,e.modelUrl?(r=typeof e.modelUrl=="string"&&e.modelUrl.indexOf("https://tfhub.dev")>-1,[4,Jx(e.modelUrl,{fromTFHub:r})]):[3,2];case 1:return n=s.sent(),[3,4];case 2:return i=void 0,e.modelType==="SinglePose.Lightning"?i="https://tfhub.dev/google/tfjs-model/movenet/singlepose/lightning/4":e.modelType==="SinglePose.Thunder"?i="https://tfhub.dev/google/tfjs-model/movenet/singlepose/thunder/4":e.modelType==="MultiPose.Lightning"&&(i="https://tfhub.dev/google/tfjs-model/movenet/multipose/lightning/1"),[4,Jx(i,{fromTFHub:r})];case 3:n=s.sent(),s.label=4;case 4:return q1()==="webgl"&&Me().set("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",0),[2,new N9e(n,e)]}})})}var MX={architecture:"MobileNetV1",outputStride:16,multiplier:.75,inputResolution:{height:257,width:257}},RX=["MobileNetV1","ResNet50"],PX={MobileNetV1:[8,16],ResNet50:[16]},I9e=[8,16,32],OX={MobileNetV1:[.5,.75,1],ResNet50:[1]},DX=[1,2,4],$X={maxPoses:1,flipHorizontal:!1},k9e={maxPoses:5,flipHorizontal:!1,scoreThreshold:.5,nmsRadius:20},M9e=[-123.15,-115.9,-103.06];function X$(t){return Math.floor(t/2)}var R9e=function(){function t(e,n){this.priorityQueue=new Array(e),this.numberOfElements=-1,this.getElementValue=n}return t.prototype.enqueue=function(e){this.priorityQueue[++this.numberOfElements]=e,this.swim(this.numberOfElements)},t.prototype.dequeue=function(){var e=this.priorityQueue[0];return this.exchange(0,this.numberOfElements--),this.sink(0),this.priorityQueue[this.numberOfElements+1]=null,e},t.prototype.empty=function(){return this.numberOfElements===-1},t.prototype.size=function(){return this.numberOfElements+1},t.prototype.all=function(){return this.priorityQueue.slice(0,this.numberOfElements+1)},t.prototype.max=function(){return this.priorityQueue[0]},t.prototype.swim=function(e){for(;e>0&&this.less(X$(e),e);)this.exchange(e,X$(e)),e=X$(e)},t.prototype.sink=function(e){for(;2*e<=this.numberOfElements;){var n=2*e;if(n<this.numberOfElements&&this.less(n,n+1)&&n++,!this.less(e,n))break;this.exchange(e,n),e=n}},t.prototype.getValueAt=function(e){return this.getElementValue(this.priorityQueue[e])},t.prototype.less=function(e,n){return this.getValueAt(e)<this.getValueAt(n)},t.prototype.exchange=function(e,n){var r=this.priorityQueue[e];this.priorityQueue[e]=this.priorityQueue[n],this.priorityQueue[n]=r},t}();function P9e(t,e,n,r,i,s){for(var a=s.shape,o=a[0],l=a[1],c=!0,u=Math.max(n-i,0),d=Math.min(n+i+1,o),h=u;h<d;++h){for(var f=Math.max(r-i,0),p=Math.min(r+i+1,l),g=f;g<p;++g)if(s.get(h,g,t)>e){c=!1;break}if(!c)break}return c}function O9e(t){return Dn(this,void 0,void 0,function(){return $n(this,function(e){return[2,Promise.all(t.map(function(n){return n.buffer()}))]})})}function Jue(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+17)}}function ede(t,e,n){var r=Jue(t.heatmapY,t.heatmapX,t.id,n),i=r.y,s=r.x;return{x:t.heatmapX*e+s,y:t.heatmapY*e+i}}function tde(t,e,n,r){var i=n.x,s=n.y;return t.some(function(a){var o,l,c,u,d,h,f=a.keypoints;return o=s,l=i,c=f[r].y,u=f[r].x,(d=c-o)*d+(h=u-l)*h<=e})}var LX=Xu.reduce(function(t,e,n){return t[e]=n,t},{}),nde=[["nose","left_eye"],["left_eye","left_ear"],["nose","right_eye"],["right_eye","right_ear"],["nose","left_shoulder"],["left_shoulder","left_elbow"],["left_elbow","left_wrist"],["left_shoulder","left_hip"],["left_hip","left_knee"],["left_knee","left_ankle"],["nose","right_shoulder"],["right_shoulder","right_elbow"],["right_elbow","right_wrist"],["right_shoulder","right_hip"],["right_hip","right_knee"],["right_knee","right_ankle"]].map(function(t){var e=t[0],n=t[1];return[LX[e],LX[n]]}),K$=nde.map(function(t){return t[1]}),FX=nde.map(function(t){return t[0]});function jX(t,e,n){return t<e?e:t>n?n:t}function Y$(t,e,n,r){return{y:jX(Math.round(t.y/e),0,n-1),x:jX(Math.round(t.x/e),0,r-1)}}function zX(t,e){return{x:t.x+e.x,y:t.y+e.y}}function BX(t,e,n,r,i,s,a,o){o===void 0&&(o=2);for(var l=r.shape,c=l[0],u=l[1],d={y:e.y,x:e.x},h=zX(d,function(x,b,_){var T=_.shape[2]/2;return{y:_.get(b.y,b.x,x),x:_.get(b.y,b.x,T+x)}}(t,Y$(d,s,c,u),a)),f=0;f<o;f++){var p=Y$(h,s,c,u),g=Jue(p.y,p.x,n,i);h=zX({x:p.x*s,y:p.y*s},{x:g.x,y:g.y})}var m=Y$(h,s,c,u),y=r.get(m.y,m.x,n);return{y:h.y,x:h.x,name:Xu[n],score:y}}function D9e(t,e,n,r,i,s){var a=e.shape[2],o=K$.length,l=new Array(a),c=t.part,u=t.score,d=ede(c,r,n);l[c.id]={score:u,name:Xu[c.id],y:d.y,x:d.x};for(var h=o-1;h>=0;--h){var f=K$[h],p=FX[h];l[f]&&!l[p]&&(l[p]=BX(h,l[f],p,e,n,r,s))}for(h=0;h<o;++h)f=FX[h],p=K$[h],l[f]&&!l[p]&&(l[p]=BX(h,l[f],p,e,n,r,i));return l}function $9e(t,e,n){return n.reduce(function(r,i,s){var a=i.y,o=i.x,l=i.score;return tde(t,e,{y:a,x:o},s)||(r+=l),r},0)/n.length}function L9e(t,e,n,r,i,s,a,o){return a===void 0&&(a=.5),o===void 0&&(o=20),Dn(this,void 0,void 0,function(){var l,c,u,d,h,f,p,g,m,y,x,b;return $n(this,function(_){switch(_.label){case 0:return[4,O9e([t,e,n,r])];case 1:for(l=_.sent(),c=l[0],u=l[1],d=l[2],h=l[3],f=[],p=function(T,E,C){for(var I=C.shape,A=I[0],k=I[1],R=I[2],$=new R9e(A*k*R,function(W){return W.score}),z=0;z<A;++z)for(var O=0;O<k;++O)for(var j=0;j<R;++j){var B=C.get(z,O,j);B<T||P9e(j,B,z,O,E,C)&&$.enqueue({score:B,part:{heatmapY:z,heatmapX:O,id:j}})}return $}(a,1,c),g=o*o;f.length<s&&!p.empty();)m=p.dequeue(),y=ede(m.part,i,u),tde(f,g,y,m.part.id)||(x=D9e(m,c,u,i,d,h),b=$9e(f,g,x),f.push({keypoints:x,score:b}));return[2,f]}})})}function rde(){for(var t,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];switch(e.length){case 0:t="fn main() ";break;case 1:t="fn main(".concat(e[0]," : i32)");break;default:throw Error("Unreachable")}return t}var F9e=function(){function t(e){this.variableNames=["A","B"],this.size=!0,this.workgroupSize=[32,1,1],this.outputShape=[e[0],1],this.dispatchLayout=nA.flatDispatchLayout(this.outputShape),this.dispatch=nA.computeDispatch(this.dispatchLayout,this.outputShape,this.workgroupSize),this.shaderKey="getpointsConfidenceOp"}return t.prototype.getUserCode=function(){return`
        `.concat(rde("index"),` {
          if (index < uniforms.size) {
            let y = B[index * 2];
            let x = B[index * 2 + 1];
            let outIndex = y * uniforms.aShape.x * uniforms.aShape.z + x * uniforms.aShape.z + index;
            result[index] = A[outIndex];
          }
        }
        `)},t}();function j9e(t,e){if(vg()instanceof Ote)return function(n,r){var i=vg(),s=new F9e(r.shape),a=i.runWebGPUProgram(s,[n,r],"float32");return Fo().makeTensorFromTensorInfo(a)}(t,e);throw new Error("getPointsConfidenceWebGPU is not supported in this backend!")}var z9e=function(){function t(e){if(this.variableNames=["A","B"],this.size=!0,this.supportedLastDimension=2,e.length!==2||e[1]!==this.supportedLastDimension)throw new Error("GetOffsetVectorsProgram only supports shape of [x, ".concat(this.supportedLastDimension,"], but current shape is ").concat(e));this.workgroupSize=[32,1,1],this.outputShape=e;var n=[e[0],1];this.dispatchLayout=nA.flatDispatchLayout(n),this.dispatch=nA.computeDispatch(this.dispatchLayout,n,this.workgroupSize),this.shaderKey="GetOffsetVectors"}return t.prototype.getUserCode=function(){return`
    fn getOffsetPoint(y: i32, x: i32, index: i32) -> vec2<i32> {
      let outIndexY = y * uniforms.bShape.x * uniforms.bShape.y + x * uniforms.bShape.y + index;
      let outIndexX = outIndexY + uniforms.bShape.z;
      let outY = i32(B[outIndexY]);
      let outX = i32(B[outIndexX]);
      return vec2<i32>(outY, outX);
    }

    `.concat(rde("index"),` {
      if (index < uniforms.size) {
        let indexY = index * `).concat(this.supportedLastDimension,`;
        let indexX = indexY + 1;
        let heatmapY = A[indexY];
        let heatmapX = A[indexX];
        let out = getOffsetPoint(i32(heatmapY), i32(heatmapX), index);
        result[indexY] = f32(out[0]);
        result[indexX] = f32(out[1]);
      }
    }
    `)},t}();function B9e(t,e){if(vg()instanceof Ote)return function(n,r){var i=vg(),s=new z9e(n.shape),a=i.runWebGPUProgram(s,[n,r],"float32");return Fo().makeTensorFromTensorInfo(a)}(t,e);throw new Error("getOffsetVectorsGPU is not supported in this backend!")}function ide(t){var e=t.shape,n=e[0],r=e[1],i=e[2];return ve(function(){var s,a,o=de(t,[n*r,i]),l=wg(o,0),c=Mi(ct(l,It(r,"int32")),1),u=Mi((s=l,a=r,ve(function(){var d=ct(s,It(a,"int32"));return ut(s,se(d,It(a,"int32")))})),1);return Qr([c,u],1)})}function U9e(t,e,n){return ve(function(){var r=function(i,s){for(var a=[],o=0;o<Xu.length;o++){var l=i.get(o,0).valueOf(),c=i.get(o,1).valueOf(),u=V9e(l,c,o,s),d=u.x,h=u.y;a.push(h),a.push(d)}return Ul(a,[Xu.length,2])}(t,n);return He(nt(se(t.toTensor(),It(e,"int32")),"float32"),r)})}function V9e(t,e,n,r){return{y:r.get(t,e,n),x:r.get(t,e,n+Xu.length)}}function W9e(t,e,n){return Dn(this,void 0,void 0,function(){var r,i,s,a,o,l,c,u,d,h;return $n(this,function(f){switch(f.label){case 0:return r=0,i=ide(t),[4,Promise.all([t.buffer(),e.buffer(),i.buffer()])];case 1:return s=f.sent(),a=s[0],o=s[1],l=s[2],[4,(c=U9e(l,n,o)).buffer()];case 2:return u=f.sent(),d=Array.from(function(p,g){for(var m=g.shape[0],y=new Float32Array(m),x=0;x<m;x++){var b=g.get(x,0),_=g.get(x,1);y[x]=p.get(b,_,x)}return y}(a,l)),h=d.map(function(p,g){return r+=p,{y:u.get(g,0),x:u.get(g,1),score:p,name:Xu[g]}}),i.dispose(),c.dispose(),[2,{keypoints:h,score:r/h.length}]}})})}function H9e(t,e,n){return Dn(this,void 0,void 0,function(){var r,i,s;return $n(this,function(a){return r=ide(t),i=function(o,l,c){return ve(function(){var u=B9e(o,c);return He(nt(se(o,It(l,"int32")),"float32"),u)})}(r,n,e),s=j9e(t,r),[2,[i,s]]})})}function UX(t,e){return(t-1)%e==0}var VX="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/mobilenet/",WX="https://storage.googleapis.com/tfjs-models/savedmodel/posenet/resnet50/";function HX(t,e){return function(n,r){return(n-1)%r==0}(t,e)?t:Math.floor(t/e)*e+1}var GX=function(){function t(e,n){this.posenetModel=e;var r=this.posenetModel.inputs[0].shape;q(r[1]===-1&&r[2]===-1,function(){return"Input shape [".concat(r[1],", ").concat(r[2],"] ")+"must both be equal to or -1"});var i,s,a=(i=n.inputResolution,s=n.outputStride,{height:HX(i.height,s),width:HX(i.width,s)});(function(o){q(I9e.indexOf(o)>=0,function(){return"outputStride of ".concat(o," is invalid. ")+"It must be either 8 or 16."})})(n.outputStride),function(o,l){q(UX(o.height,l),function(){return"height of ".concat(o.height," is invalid for output stride ")+"".concat(l,".")}),q(UX(o.width,l),function(){return"width of ".concat(o.width," is invalid for output stride ")+"".concat(l,".")})}(a,n.outputStride),this.inputResolution=a,this.outputStride=n.outputStride,this.architecture=n.architecture}return t.prototype.estimatePoses=function(e,n){return n===void 0&&(n=$X),Dn(this,void 0,void 0,function(){return $n(this,function(r){return[2,this.estimatePosesGPU(e,n,!1)]})})},t.prototype.estimatePosesGPU=function(e,n,r){return n===void 0&&(n=$X),r===void 0&&(r=!1),Dn(this,void 0,void 0,function(){var i,s,a,o,l,c,u,d,h,f,p,g,m,y,x,b,_,T;return $n(this,function(E){switch(E.label){case 0:return i=function(C){var I=C;if(I.maxPoses==null&&(I.maxPoses=1),I.maxPoses<=0)throw new Error("Invalid maxPoses ".concat(I.maxPoses,". Should be > 0."));if(I.maxPoses>1){if((I=Sr(Sr({},k9e),I)).scoreThreshold<0||I.scoreThreshold>1)throw new Error("Invalid scoreThreshold ".concat(I.scoreThreshold,". ")+"Should be in range [0.0, 1.0]");if(I.nmsRadius<=0)throw new Error("Invalid nmsRadius ".concat(I.nmsRadius,"."))}return I}(n),e==null?[2,r?[[],[]]:[]]:(this.maxPoses=i.maxPoses,s=Ij(e,{outputTensorSize:this.inputResolution,keepAspectRatio:!0,borderMode:"replicate"}),a=s.imageTensor,o=s.padding,l=this.architecture==="ResNet50"?He(a,M9e):Xue(a,[-1,1]),c=this.posenetModel.predict(l),this.architecture==="ResNet50"?(u=Yn(c[2],[0]),d=Yn(c[3],[0]),h=Yn(c[0],[0]),f=Yn(c[1],[0])):(u=Yn(c[0],[0]),d=Yn(c[1],[0]),h=Yn(c[2],[0]),f=Yn(c[3],[0])),p=Ko(d),this.maxPoses!==1?[3,5]:r?[4,H9e(p,u,this.outputStride)]:[3,2]);case 1:return m=E.sent(),x=m[0],y=m[1],g=[x,y],[3,4];case 2:return[4,W9e(p,u,this.outputStride)];case 3:x=E.sent(),g=[x],E.label=4;case 4:return[3,7];case 5:if(r)throw new Error("GPU renderer only supports single pose!");return[4,L9e(p,u,h,f,this.outputStride,this.maxPoses,i.scoreThreshold,i.nmsRadius)];case 6:g=E.sent(),E.label=7;case 7:if(r){if(i.flipHorizontal===!0)throw new Error("flipHorizontal is not supported!");b=this.getCanvasInfo(e0(e),this.inputResolution,o)}else T=e0(e),_=function(C,I,A,k){var R=I.height,$=I.width,z=R/(A.height*(1-k.top-k.bottom)),O=$/(A.width*(1-k.left-k.right)),j=-k.top*A.height,B=-k.left*A.width;if(O===1&&z===1&&j===0&&B===0)return C;for(var W=0,L=C;W<L.length;W++)for(var V=0,H=L[W].keypoints;V<H.length;V++){var K=H[V];K.x=(K.x+B)*O,K.y=(K.y+j)*z}return C}(g,T,this.inputResolution,o),i.flipHorizontal&&(_=function(C,I){for(var A=0,k=C;A<k.length;A++)for(var R=0,$=k[A].keypoints;R<$.length;R++){var z=$[R];z.x=I.width-1-z.x}return C}(_,T));return a.dispose(),l.dispose(),Bt(c),u.dispose(),d.dispose(),h.dispose(),f.dispose(),p.dispose(),[2,r?[g,b]:_]}})})},t.prototype.getCanvasInfo=function(e,n,r){var i=e.height,s=e.width,a=i/(n.height*(1-r.top-r.bottom)),o=s/(n.width*(1-r.left-r.right)),l=-r.top*n.height;return[-r.left*n.width,l,o,a,e.width,e.height]},t.prototype.dispose=function(){this.posenetModel.dispose()},t.prototype.reset=function(){},t}();function G9e(t){return t===void 0&&(t=MX),Dn(this,void 0,void 0,function(){var e,n,r,i,s;return $n(this,function(a){switch(a.label){case 0:return(e=function(u){var d=u||MX;if(d.architecture==null&&(d.architecture="MobileNetV1"),RX.indexOf(d.architecture)<0)throw new Error("Invalid architecture ".concat(d.architecture,". ")+"Should be one of ".concat(RX));if(d.inputResolution==null&&(d.inputResolution={height:257,width:257}),d.outputStride==null&&(d.outputStride=16),PX[d.architecture].indexOf(d.outputStride)<0)throw new Error("Invalid outputStride ".concat(d.outputStride,". ")+"Should be one of ".concat(PX[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.multiplier==null&&(d.multiplier=1),OX[d.architecture].indexOf(d.multiplier)<0)throw new Error("Invalid multiplier ".concat(d.multiplier,". ")+"Should be one of ".concat(OX[d.architecture]," ")+"for architecture ".concat(d.architecture,"."));if(d.quantBytes==null&&(d.quantBytes=4),DX.indexOf(d.quantBytes)<0)throw new Error("Invalid quantBytes ".concat(d.quantBytes,". ")+"Should be one of ".concat(DX," ")+"for architecture ".concat(d.architecture,"."));if(d.architecture==="MobileNetV1"&&d.outputStride===32&&d.multiplier!==1)throw new Error("When using an output stride of 32, you must select 1 as the multiplier.");return d}(t)).architecture!=="ResNet50"?[3,2]:(o=e.outputStride,l=e.quantBytes,c="model-stride".concat(o,".json"),n=l===4?WX+"float/"+c:WX+"quant".concat(l,"/")+c,[4,Jx(e.modelUrl||n)]);case 1:return r=a.sent(),[2,new GX(r,e)];case 2:return i=function(u,d,h){var f={1:"100",.75:"075",.5:"050"},p="model-stride".concat(u,".json");return h===4?VX+"float/".concat(f[d],"/")+p:VX+"quant".concat(h,"/").concat(f[d],"/")+p}(e.outputStride,e.multiplier,e.quantBytes),[4,Jx(e.modelUrl||i)];case 3:return s=a.sent(),[2,new GX(s,e)]}var o,l,c})})}function q9e(t,e){return Dn(this,void 0,void 0,function(){var n,r;return $n(this,function(i){switch(t){case $u.PoseNet:return[2,G9e(e)];case $u.BlazePose:if(r=void 0,(n=e)!=null){if(n.runtime==="tfjs")return[2,w9e(e)];if(n.runtime==="mediapipe")return[2,q8e(e)];r=n.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' "+"or 'mediapipe', but got ".concat(r));case $u.MoveNet:return[2,A9e(e)];default:throw new Error("".concat(t," is not a supported model name."))}})})}var X9e={modelType:{SINGLEPOSE_LIGHTNING:"SinglePose.Lightning"}};const K9e=[["nose","left_eye"],["nose","right_eye"],["left_eye","left_ear"],["right_eye","right_ear"],["left_shoulder","right_shoulder"],["left_shoulder","left_elbow"],["right_shoulder","right_elbow"],["left_elbow","left_wrist"],["right_elbow","right_wrist"],["left_shoulder","left_hip"],["right_shoulder","right_hip"],["left_hip","right_hip"],["left_hip","left_knee"],["right_hip","right_knee"],["left_knee","left_ankle"],["right_knee","right_ankle"]],Y9e=[{name:"Right Elbow Angle",points:["right_shoulder","right_elbow","right_wrist"],normal:[150,180]},{name:"Left Elbow Angle",points:["left_shoulder","left_elbow","left_wrist"],normal:[150,180]},{name:"Right Shoulder Angle",points:["right_elbow","right_shoulder","right_hip"],normal:[0,180]},{name:"Left Shoulder Angle",points:["left_elbow","left_shoulder","left_hip"],normal:[0,180]},{name:"Right Knee Angle",points:["right_hip","right_knee","right_ankle"],normal:[160,180]},{name:"Left Knee Angle",points:["left_hip","left_knee","left_ankle"],normal:[160,180]},{name:"Neck Angle",points:["left_shoulder","nose","right_shoulder"],normal:[70,110]}],Z9e={nose:"Nose",left_eye:"Left Eye",right_eye:"Right Eye",left_ear:"Left Ear",right_ear:"Right Ear",left_shoulder:"Left Shoulder",right_shoulder:"Right Shoulder",left_elbow:"Left Elbow",right_elbow:"Right Elbow",left_wrist:"Left Wrist",right_wrist:"Right Wrist",left_hip:"Left Hip",right_hip:"Right Hip",left_knee:"Left Knee",right_knee:"Right Knee",left_ankle:"Left Ankle",right_ankle:"Right Ankle"},Z$=new Map;async function Q9e(){await IIe("webgl"),await kIe();const t={modelType:X9e.modelType.SINGLEPOSE_LIGHTNING,enableSmoothing:!0,minPoseScore:.2};return q9e($u.MoveNet,t)}function J9e(t,e){const n=Date.now();Z$.has(t)||Z$.set(t,[]);const r=Z$.get(t);if(r.push({...e,timestamp:n}),r.length>10&&r.shift(),r.length<2)return 0;const i=r[r.length-1],s=r[r.length-2],a=i.x-s.x,o=i.y-s.y,l=(i.timestamp-s.timestamp)/1e3;if(l===0)return 0;const c=Math.sqrt(a*a+o*o)/l;return parseFloat(c.toFixed(1))}function eqe(t,e,n,r,i=!0){if(!e||!e.keypoints)return;t.fillStyle="#1976D2",t.strokeStyle="#1976D2",t.lineWidth=2;const s=new Map;e.keypoints.forEach(o=>{o.score&&o.score>.3&&(s.set(o.name,{x:o.x,y:o.y}),t.beginPath(),t.arc(o.x,o.y,5,0,2*Math.PI),t.fill())}),t.beginPath(),K9e.forEach(([o,l])=>{const c=s.get(o),u=s.get(l);c&&u&&(t.moveTo(c.x,c.y),t.lineTo(u.x,u.y))}),t.stroke(),["left_shoulder","right_shoulder","left_elbow","right_elbow","left_wrist","right_wrist","left_knee","right_knee","left_hip","right_hip","left_ankle","right_ankle","nose"].forEach(o=>{const l=s.get(o);if(l&&(t.fillStyle="#FF5722",t.beginPath(),t.arc(l.x,l.y,8,0,2*Math.PI),t.fill(),t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.arc(l.x,l.y,8,0,2*Math.PI),t.stroke(),i)){const c=J9e(o,l);t.font="12px Arial",t.fillStyle="white",t.textAlign="center",t.fillText(Z9e[o],l.x,l.y-15),c>5&&(t.fillStyle="#4CAF50",t.fillText(`${c} px/s`,l.x,l.y+20))}}),i&&Y9e.forEach(o=>{const[l,c,u]=o.points,d=s.get(l),h=s.get(c),f=s.get(u);if(d&&h&&f){const p=t0(d,h,f),g=p>=o.normal[0]&&p<=o.normal[1],m=(d.x+h.x+f.x)/3,y=(d.y+h.y+f.y)/3;t.font="bold 14px Arial",t.fillStyle=g?"#4CAF50":"#FF5722",t.textAlign="center",t.fillText(`${Math.round(p)}°`,m,y),t.font="12px Arial",t.fillStyle="white",t.fillText(o.name,m,y-18)}})}function t0(t,e,n){const r={x:e.x-t.x,y:e.y-t.y},i={x:e.x-n.x,y:e.y-n.y},s=r.x*i.x+r.y*i.y,a=Math.sqrt(r.x*r.x+r.y*r.y),o=Math.sqrt(i.x*i.x+i.y*i.y),l=s/(a*o);return Math.acos(Math.max(-1,Math.min(1,l)))*180/Math.PI}function Fa(t,e){if(!t||!t.keypoints)return null;const n=t.keypoints.find(r=>r.name===e);return!n||n.score&&n.score<.3?null:{x:n.x,y:n.y}}const sde=(t,e)=>{const[n,r]=P.useState(null),[i,s]=P.useState(!1),[a,o]=P.useState(!0),l=P.useRef(null),c=P.useRef(null),u=P.useCallback(()=>{o(g=>!g)},[]),d=P.useCallback(async()=>{if(!l.current)try{l.current=await Q9e()}catch(g){console.error("Error initializing pose detector:",g)}return l.current},[]),h=P.useCallback(async()=>{if(!(!i||!l.current||!t.current||!e.current)){if(t.current.readyState<2){c.current=requestAnimationFrame(h);return}try{const g=t.current,y=await l.current.estimatePoses(g,{flipHorizontal:!1,maxPoses:1});if(y&&y.length>0){r(y);const x=e.current.getContext("2d");if(x){const{videoWidth:b,videoHeight:_}=g;(e.current.width!==b||e.current.height!==_)&&(e.current.width=b,e.current.height=_),x.clearRect(0,0,b,_),eqe(x,y[0],b,_,a)}}}catch(g){console.error("Error during pose detection:",g)}i&&(c.current=requestAnimationFrame(h))}},[i,t,e,a]),f=P.useCallback(async()=>{if(!i)try{await d(),s(!0)}catch(g){console.error("Error starting pose detection:",g)}},[i,d]),p=P.useCallback(()=>{s(!1),c.current&&(cancelAnimationFrame(c.current),c.current=null),r(null)},[]);return P.useEffect(()=>(i&&h(),()=>{c.current&&cancelAnimationFrame(c.current)}),[i,h,a]),P.useEffect(()=>()=>{c.current&&cancelAnimationFrame(c.current),l.current&&l.current.dispose()},[]),{poses:n,isDetecting:i,showDetails:a,toggleDetails:u,startPoseDetection:f,stopPoseDetection:p}},tqe=({userId:t})=>{var _;const[e,n]=P.useState(!1),r=P.useRef(null),i=P.useRef(null),{videoReady:s,startWebcam:a,stopWebcam:o}=lae(r),{startPoseDetection:l,stopPoseDetection:c}=sde(r,i),{data:u=[]}=Kr({queryKey:[`/api/sessions/patient/${t}`]}),d=u.find(T=>{const E=new Date(T.date),C=new Date;return E.toDateString()===C.toDateString()}),{data:h=[],isLoading:f}=Kr({queryKey:[`/api/session-exercises/${d==null?void 0:d.id}`],enabled:!!(d!=null&&d.id)}),p=(_=h[0])==null?void 0:_.exerciseId,{data:g}=Kr({queryKey:[`/api/exercises/${p}`],enabled:!!p}),{data:m=[]}=Kr({queryKey:["/api/exercises"]}),y=(m==null?void 0:m.slice(0,3))||[];P.useEffect(()=>(e&&s&&l(),()=>{e&&c()}),[e,s,l,c]);const x=()=>{e?(o(),c(),n(!1)):(a(),n(!0))},b=["Keep your shoulders level during the movement","Extend your arm fully at the top of the motion"];return v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 mb-8",children:[v.jsxs("div",{className:"lg:col-span-2 bg-white rounded-xl shadow overflow-hidden",children:[v.jsxs("div",{className:"p-6 border-b",children:[v.jsx("h2",{className:"text-lg font-heading font-semibold text-neutral-800",children:"Real-time Motion Tracking"}),v.jsx("p",{className:"text-neutral-500 text-sm mt-1",children:"Analyze and correct your posture with AI assistance"})]}),v.jsxs("div",{className:"p-6",children:[v.jsxs("div",{className:"webcam-container mb-4 relative aspect-video bg-black rounded-lg overflow-hidden",children:[e?v.jsxs(v.Fragment,{children:[v.jsx("video",{ref:r,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0}),v.jsx("canvas",{ref:i,className:"absolute top-0 left-0 w-full h-full"})]}):v.jsx("div",{className:"flex items-center justify-center h-full",children:v.jsxs("div",{className:"text-center text-white",children:[v.jsx("p",{className:"mb-4",children:"Enable your camera to start motion tracking"}),v.jsx(et,{onClick:x,children:"Enable Camera"})]})}),v.jsx("div",{className:"absolute bottom-4 right-4",children:v.jsx(et,{variant:"outline",size:"icon",className:"bg-white hover:bg-gray-100 rounded-full",onClick:x,children:e?v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{d:"M13.414 10l3.293-3.293a1 1 0 00-1.414-1.414L12 8.586 8.707 5.293a1 1 0 00-1.414 1.414L10.586 10l-3.293 3.293a1 1 0 101.414 1.414L12 11.414l3.293 3.293a1 1 0 001.414-1.414L13.414 10z"})}):v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M4 5a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2V7a2 2 0 00-2-2h-1.586a1 1 0 01-.707-.293l-1.121-1.121A2 2 0 0011.172 3H8.828a2 2 0 00-1.414.586L6.293 4.707A1 1 0 015.586 5H4zm6 9a3 3 0 100-6 3 3 0 000 6z",clipRule:"evenodd"})})})})]}),v.jsxs("div",{className:"flex flex-wrap -mx-2",children:[v.jsx("div",{className:"w-full md:w-1/2 px-2 mb-4 md:mb-0",children:v.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[v.jsx("h3",{className:"text-neutral-800 font-medium mb-2",children:"Current Exercise"}),v.jsxs("p",{className:"text-primary font-semibold",children:[(g==null?void 0:g.name)||"No exercise selected"," - Set 2/3"]}),v.jsxs("div",{className:"mt-3",children:[v.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[v.jsx("span",{className:"text-neutral-600",children:"Progress"}),v.jsx("span",{className:"text-neutral-800 font-medium",children:"8/12 reps"})]}),v.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:"66%"}})})]})]})}),v.jsx("div",{className:"w-full md:w-1/2 px-2",children:v.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg",children:[v.jsx("h3",{className:"text-neutral-800 font-medium mb-1",children:"Posture Analysis"}),v.jsx("p",{className:"text-warning font-medium",children:"Minor corrections needed"}),v.jsx("ul",{className:"mt-2 text-sm text-neutral-700",children:b.map((T,E)=>v.jsxs("li",{className:"flex items-start mb-1",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 text-warning flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),T]},E))})]})})]})]})]}),v.jsxs("div",{className:"bg-white rounded-xl shadow overflow-hidden",children:[v.jsxs("div",{className:"p-6 border-b",children:[v.jsx("h2",{className:"text-lg font-heading font-semibold text-neutral-800",children:"Next Exercises"}),v.jsx("p",{className:"text-neutral-500 text-sm mt-1",children:"AI-recommended for today's session"})]}),v.jsxs("div",{className:"p-4",children:[y.map(T=>v.jsx(j2,{exercise:T},T.id)),v.jsx(Lc,{href:"/exercises",children:v.jsx(et,{variant:"ghost",className:"w-full mt-2",children:"View all exercises"})})]})]})]})};var nqe=Array.isArray,No=nqe,rqe=typeof kc=="object"&&kc&&kc.Object===Object&&kc,ade=rqe,iqe=ade,sqe=typeof self=="object"&&self&&self.Object===Object&&self,aqe=iqe||sqe||Function("return this")(),sd=aqe,oqe=sd,lqe=oqe.Symbol,JT=lqe,qX=JT,ode=Object.prototype,cqe=ode.hasOwnProperty,uqe=ode.toString,uw=qX?qX.toStringTag:void 0;function dqe(t){var e=cqe.call(t,uw),n=t[uw];try{t[uw]=void 0;var r=!0}catch{}var i=uqe.call(t);return r&&(e?t[uw]=n:delete t[uw]),i}var hqe=dqe,fqe=Object.prototype,pqe=fqe.toString;function mqe(t){return pqe.call(t)}var gqe=mqe,XX=JT,yqe=hqe,vqe=gqe,xqe="[object Null]",bqe="[object Undefined]",KX=XX?XX.toStringTag:void 0;function wqe(t){return t==null?t===void 0?bqe:xqe:KX&&KX in Object(t)?yqe(t):vqe(t)}var wh=wqe;function Sqe(t){return t!=null&&typeof t=="object"}var Sh=Sqe,_qe=wh,Tqe=Sh,Eqe="[object Symbol]";function Cqe(t){return typeof t=="symbol"||Tqe(t)&&_qe(t)==Eqe}var lb=Cqe,Nqe=No,Aqe=lb,Iqe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,kqe=/^\w*$/;function Mqe(t,e){if(Nqe(t))return!1;var n=typeof t;return n=="number"||n=="symbol"||n=="boolean"||t==null||Aqe(t)?!0:kqe.test(t)||!Iqe.test(t)||e!=null&&t in Object(e)}var $5=Mqe;function Rqe(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var wp=Rqe;const cb=lr(wp);var Pqe=wh,Oqe=wp,Dqe="[object AsyncFunction]",$qe="[object Function]",Lqe="[object GeneratorFunction]",Fqe="[object Proxy]";function jqe(t){if(!Oqe(t))return!1;var e=Pqe(t);return e==$qe||e==Lqe||e==Dqe||e==Fqe}var L5=jqe;const wn=lr(L5);var zqe=sd,Bqe=zqe["__core-js_shared__"],Uqe=Bqe,Q$=Uqe,YX=function(){var t=/[^.]+$/.exec(Q$&&Q$.keys&&Q$.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Vqe(t){return!!YX&&YX in t}var Wqe=Vqe,Hqe=Function.prototype,Gqe=Hqe.toString;function qqe(t){if(t!=null){try{return Gqe.call(t)}catch{}try{return t+""}catch{}}return""}var lde=qqe,Xqe=L5,Kqe=Wqe,Yqe=wp,Zqe=lde,Qqe=/[\\^$.*+?()[\]{}|]/g,Jqe=/^\[object .+?Constructor\]$/,e7e=Function.prototype,t7e=Object.prototype,n7e=e7e.toString,r7e=t7e.hasOwnProperty,i7e=RegExp("^"+n7e.call(r7e).replace(Qqe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function s7e(t){if(!Yqe(t)||Kqe(t))return!1;var e=Xqe(t)?i7e:Jqe;return e.test(Zqe(t))}var a7e=s7e;function o7e(t,e){return t==null?void 0:t[e]}var l7e=o7e,c7e=a7e,u7e=l7e;function d7e(t,e){var n=u7e(t,e);return c7e(n)?n:void 0}var ry=d7e,h7e=ry,f7e=h7e(Object,"create"),GR=f7e,ZX=GR;function p7e(){this.__data__=ZX?ZX(null):{},this.size=0}var m7e=p7e;function g7e(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var y7e=g7e,v7e=GR,x7e="__lodash_hash_undefined__",b7e=Object.prototype,w7e=b7e.hasOwnProperty;function S7e(t){var e=this.__data__;if(v7e){var n=e[t];return n===x7e?void 0:n}return w7e.call(e,t)?e[t]:void 0}var _7e=S7e,T7e=GR,E7e=Object.prototype,C7e=E7e.hasOwnProperty;function N7e(t){var e=this.__data__;return T7e?e[t]!==void 0:C7e.call(e,t)}var A7e=N7e,I7e=GR,k7e="__lodash_hash_undefined__";function M7e(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=I7e&&e===void 0?k7e:e,this}var R7e=M7e,P7e=m7e,O7e=y7e,D7e=_7e,$7e=A7e,L7e=R7e;function ub(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ub.prototype.clear=P7e;ub.prototype.delete=O7e;ub.prototype.get=D7e;ub.prototype.has=$7e;ub.prototype.set=L7e;var F7e=ub;function j7e(){this.__data__=[],this.size=0}var z7e=j7e;function B7e(t,e){return t===e||t!==t&&e!==e}var F5=B7e,U7e=F5;function V7e(t,e){for(var n=t.length;n--;)if(U7e(t[n][0],e))return n;return-1}var qR=V7e,W7e=qR,H7e=Array.prototype,G7e=H7e.splice;function q7e(t){var e=this.__data__,n=W7e(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():G7e.call(e,n,1),--this.size,!0}var X7e=q7e,K7e=qR;function Y7e(t){var e=this.__data__,n=K7e(e,t);return n<0?void 0:e[n][1]}var Z7e=Y7e,Q7e=qR;function J7e(t){return Q7e(this.__data__,t)>-1}var eXe=J7e,tXe=qR;function nXe(t,e){var n=this.__data__,r=tXe(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this}var rXe=nXe,iXe=z7e,sXe=X7e,aXe=Z7e,oXe=eXe,lXe=rXe;function db(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}db.prototype.clear=iXe;db.prototype.delete=sXe;db.prototype.get=aXe;db.prototype.has=oXe;db.prototype.set=lXe;var XR=db,cXe=ry,uXe=sd,dXe=cXe(uXe,"Map"),j5=dXe,QX=F7e,hXe=XR,fXe=j5;function pXe(){this.size=0,this.__data__={hash:new QX,map:new(fXe||hXe),string:new QX}}var mXe=pXe;function gXe(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var yXe=gXe,vXe=yXe;function xXe(t,e){var n=t.__data__;return vXe(e)?n[typeof e=="string"?"string":"hash"]:n.map}var KR=xXe,bXe=KR;function wXe(t){var e=bXe(this,t).delete(t);return this.size-=e?1:0,e}var SXe=wXe,_Xe=KR;function TXe(t){return _Xe(this,t).get(t)}var EXe=TXe,CXe=KR;function NXe(t){return CXe(this,t).has(t)}var AXe=NXe,IXe=KR;function kXe(t,e){var n=IXe(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this}var MXe=kXe,RXe=mXe,PXe=SXe,OXe=EXe,DXe=AXe,$Xe=MXe;function hb(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}hb.prototype.clear=RXe;hb.prototype.delete=PXe;hb.prototype.get=OXe;hb.prototype.has=DXe;hb.prototype.set=$Xe;var z5=hb,cde=z5,LXe="Expected a function";function B5(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(LXe);var n=function(){var r=arguments,i=e?e.apply(this,r):r[0],s=n.cache;if(s.has(i))return s.get(i);var a=t.apply(this,r);return n.cache=s.set(i,a)||s,a};return n.cache=new(B5.Cache||cde),n}B5.Cache=cde;var ude=B5;const FXe=lr(ude);var jXe=ude,zXe=500;function BXe(t){var e=jXe(t,function(r){return n.size===zXe&&n.clear(),r}),n=e.cache;return e}var UXe=BXe,VXe=UXe,WXe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,HXe=/\\(\\)?/g,GXe=VXe(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(WXe,function(n,r,i,s){e.push(i?s.replace(HXe,"$1"):r||n)}),e}),qXe=GXe;function XXe(t,e){for(var n=-1,r=t==null?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}var U5=XXe,JX=JT,KXe=U5,YXe=No,ZXe=lb,eK=JX?JX.prototype:void 0,tK=eK?eK.toString:void 0;function dde(t){if(typeof t=="string")return t;if(YXe(t))return KXe(t,dde)+"";if(ZXe(t))return tK?tK.call(t):"";var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var QXe=dde,JXe=QXe;function eKe(t){return t==null?"":JXe(t)}var hde=eKe,tKe=No,nKe=$5,rKe=qXe,iKe=hde;function sKe(t,e){return tKe(t)?t:nKe(t,e)?[t]:rKe(iKe(t))}var fde=sKe,aKe=lb;function oKe(t){if(typeof t=="string"||aKe(t))return t;var e=t+"";return e=="0"&&1/t==-1/0?"-0":e}var YR=oKe,lKe=fde,cKe=YR;function uKe(t,e){e=lKe(e,t);for(var n=0,r=e.length;t!=null&&n<r;)t=t[cKe(e[n++])];return n&&n==r?t:void 0}var V5=uKe,dKe=V5;function hKe(t,e,n){var r=t==null?void 0:dKe(t,e);return r===void 0?n:r}var pde=hKe;const Vl=lr(pde);function fKe(t){return t==null}var pKe=fKe;const Un=lr(pKe);var mKe=wh,gKe=No,yKe=Sh,vKe="[object String]";function xKe(t){return typeof t=="string"||!gKe(t)&&yKe(t)&&mKe(t)==vKe}var bKe=xKe;const Ig=lr(bKe);var mde={exports:{}},yr={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W5=Symbol.for("react.element"),H5=Symbol.for("react.portal"),ZR=Symbol.for("react.fragment"),QR=Symbol.for("react.strict_mode"),JR=Symbol.for("react.profiler"),eP=Symbol.for("react.provider"),tP=Symbol.for("react.context"),wKe=Symbol.for("react.server_context"),nP=Symbol.for("react.forward_ref"),rP=Symbol.for("react.suspense"),iP=Symbol.for("react.suspense_list"),sP=Symbol.for("react.memo"),aP=Symbol.for("react.lazy"),SKe=Symbol.for("react.offscreen"),gde;gde=Symbol.for("react.module.reference");function Jl(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case W5:switch(t=t.type,t){case ZR:case JR:case QR:case rP:case iP:return t;default:switch(t=t&&t.$$typeof,t){case wKe:case tP:case nP:case aP:case sP:case eP:return t;default:return e}}case H5:return e}}}yr.ContextConsumer=tP;yr.ContextProvider=eP;yr.Element=W5;yr.ForwardRef=nP;yr.Fragment=ZR;yr.Lazy=aP;yr.Memo=sP;yr.Portal=H5;yr.Profiler=JR;yr.StrictMode=QR;yr.Suspense=rP;yr.SuspenseList=iP;yr.isAsyncMode=function(){return!1};yr.isConcurrentMode=function(){return!1};yr.isContextConsumer=function(t){return Jl(t)===tP};yr.isContextProvider=function(t){return Jl(t)===eP};yr.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===W5};yr.isForwardRef=function(t){return Jl(t)===nP};yr.isFragment=function(t){return Jl(t)===ZR};yr.isLazy=function(t){return Jl(t)===aP};yr.isMemo=function(t){return Jl(t)===sP};yr.isPortal=function(t){return Jl(t)===H5};yr.isProfiler=function(t){return Jl(t)===JR};yr.isStrictMode=function(t){return Jl(t)===QR};yr.isSuspense=function(t){return Jl(t)===rP};yr.isSuspenseList=function(t){return Jl(t)===iP};yr.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===ZR||t===JR||t===QR||t===rP||t===iP||t===SKe||typeof t=="object"&&t!==null&&(t.$$typeof===aP||t.$$typeof===sP||t.$$typeof===eP||t.$$typeof===tP||t.$$typeof===nP||t.$$typeof===gde||t.getModuleId!==void 0)};yr.typeOf=Jl;mde.exports=yr;var _Ke=mde.exports,TKe=wh,EKe=Sh,CKe="[object Number]";function NKe(t){return typeof t=="number"||EKe(t)&&TKe(t)==CKe}var yde=NKe;const AKe=lr(yde);var IKe=yde;function kKe(t){return IKe(t)&&t!=+t}var MKe=kKe;const fb=lr(MKe);var Mc=function(e){return e===0?0:e>0?1:-1},Im=function(e){return Ig(e)&&e.indexOf("%")===e.length-1},tt=function(e){return AKe(e)&&!fb(e)},os=function(e){return tt(e)||Ig(e)},RKe=0,eE=function(e){var n=++RKe;return"".concat(e||"").concat(n)},kg=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!tt(e)&&!Ig(e))return r;var s;if(Im(e)){var a=e.indexOf("%");s=n*parseFloat(e.slice(0,a))/100}else s=+e;return fb(s)&&(s=r),i&&s>n&&(s=n),s},tf=function(e){if(!e)return null;var n=Object.keys(e);return n&&n.length?e[n[0]]:null},PKe=function(e){if(!Array.isArray(e))return!1;for(var n=e.length,r={},i=0;i<n;i++)if(!r[e[i]])r[e[i]]=!0;else return!0;return!1},Al=function(e,n){return tt(e)&&tt(n)?function(r){return e+r*(n-e)}:function(){return n}};function eI(t,e,n){return!t||!t.length?null:t.find(function(r){return r&&(typeof e=="function"?e(r):Vl(r,e))===n})}var OKe=function(e,n){return tt(e)&&tt(n)?e-n:Ig(e)&&Ig(n)?e.localeCompare(n):e instanceof Date&&n instanceof Date?e.getTime()-n.getTime():String(e).localeCompare(String(n))};function ax(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var r in e)if({}.hasOwnProperty.call(e,r)&&!{}.hasOwnProperty.call(t,r))return!1;return!0}function Rj(t){"@babel/helpers - typeof";return Rj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Rj(t)}var DKe=["viewBox","children"],$Ke=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],nK=["points","pathLength"],J$={svg:DKe,polygon:nK,polyline:nK},G5=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],tI=function(e,n){if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(P.isValidElement(e)&&(r=e.props),!cb(r))return null;var i={};return Object.keys(r).forEach(function(s){G5.includes(s)&&(i[s]=n||function(a){return r[s](r,a)})}),i},LKe=function(e,n,r){return function(i){return e(n,r,i),null}},nI=function(e,n,r){if(!cb(e)||Rj(e)!=="object")return null;var i=null;return Object.keys(e).forEach(function(s){var a=e[s];G5.includes(s)&&typeof a=="function"&&(i||(i={}),i[s]=LKe(a,n,r))}),i},FKe=["children"],jKe=["children"];function rK(t,e){if(t==null)return{};var n=zKe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function zKe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Pj(t){"@babel/helpers - typeof";return Pj=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pj(t)}var iK={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},Hd=function(e){return typeof e=="string"?e:e?e.displayName||e.name||"Component":""},sK=null,eL=null,q5=function t(e){if(e===sK&&Array.isArray(eL))return eL;var n=[];return P.Children.forEach(e,function(r){Un(r)||(_Ke.isFragment(r)?n=n.concat(t(r.props.children)):n.push(r))}),eL=n,sK=e,n};function jc(t,e){var n=[],r=[];return Array.isArray(e)?r=e.map(function(i){return Hd(i)}):r=[Hd(e)],q5(t).forEach(function(i){var s=Vl(i,"type.displayName")||Vl(i,"type.name");r.indexOf(s)!==-1&&n.push(i)}),n}function jo(t,e){var n=jc(t,e);return n&&n[0]}var aK=function(e){if(!e||!e.props)return!1;var n=e.props,r=n.width,i=n.height;return!(!tt(r)||r<=0||!tt(i)||i<=0)},BKe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],UKe=function(e){return e&&e.type&&Ig(e.type)&&BKe.indexOf(e.type)>=0},VKe=function(e){return e&&Pj(e)==="object"&&"clipDot"in e},WKe=function(e,n,r,i){var s,a=(s=J$==null?void 0:J$[i])!==null&&s!==void 0?s:[];return n.startsWith("data-")||!wn(e)&&(i&&a.includes(n)||$Ke.includes(n))||r&&G5.includes(n)},Rn=function(e,n,r){if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(P.isValidElement(e)&&(i=e.props),!cb(i))return null;var s={};return Object.keys(i).forEach(function(a){var o;WKe((o=i)===null||o===void 0?void 0:o[a],a,n,r)&&(s[a]=i[a])}),s},Oj=function t(e,n){if(e===n)return!0;var r=P.Children.count(e);if(r!==P.Children.count(n))return!1;if(r===0)return!0;if(r===1)return oK(Array.isArray(e)?e[0]:e,Array.isArray(n)?n[0]:n);for(var i=0;i<r;i++){var s=e[i],a=n[i];if(Array.isArray(s)||Array.isArray(a)){if(!t(s,a))return!1}else if(!oK(s,a))return!1}return!0},oK=function(e,n){if(Un(e)&&Un(n))return!0;if(!Un(e)&&!Un(n)){var r=e.props||{},i=r.children,s=rK(r,FKe),a=n.props||{},o=a.children,l=rK(a,jKe);return i&&o?ax(s,l)&&Oj(i,o):!i&&!o?ax(s,l):!1}return!1},lK=function(e,n){var r=[],i={};return q5(e).forEach(function(s,a){if(UKe(s))r.push(s);else if(s){var o=Hd(s.type),l=n[o]||{},c=l.handler,u=l.once;if(c&&(!u||!i[o])){var d=c(s,o,a);r.push(d),i[o]=!0}}}),r},HKe=function(e){var n=e&&e.type;return n&&iK[n]?iK[n]:null},GKe=function(e,n){return q5(n).indexOf(e)},qKe=["children","width","height","viewBox","className","style","title","desc"];function Dj(){return Dj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dj.apply(this,arguments)}function XKe(t,e){if(t==null)return{};var n=KKe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function KKe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function $j(t){var e=t.children,n=t.width,r=t.height,i=t.viewBox,s=t.className,a=t.style,o=t.title,l=t.desc,c=XKe(t,qKe),u=i||{width:n,height:r,x:0,y:0},d=qn("recharts-surface",s);return le.createElement("svg",Dj({},Rn(c,!0,"svg"),{className:d,width:n,height:r,style:a,viewBox:"".concat(u.x," ").concat(u.y," ").concat(u.width," ").concat(u.height)}),le.createElement("title",null,o),le.createElement("desc",null,l),e)}var YKe=["children","className"];function Lj(){return Lj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Lj.apply(this,arguments)}function ZKe(t,e){if(t==null)return{};var n=QKe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function QKe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var si=le.forwardRef(function(t,e){var n=t.children,r=t.className,i=ZKe(t,YKe),s=qn("recharts-layer",r);return le.createElement("g",Lj({className:s},Rn(i,!0),{ref:e}),n)}),Gd=function(e,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s]};function JKe(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),n=n>i?i:n,n<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var s=Array(i);++r<i;)s[r]=t[r+e];return s}var eYe=JKe,tYe=eYe;function nYe(t,e,n){var r=t.length;return n=n===void 0?r:n,!e&&n>=r?t:tYe(t,e,n)}var rYe=nYe,iYe="\\ud800-\\udfff",sYe="\\u0300-\\u036f",aYe="\\ufe20-\\ufe2f",oYe="\\u20d0-\\u20ff",lYe=sYe+aYe+oYe,cYe="\\ufe0e\\ufe0f",uYe="\\u200d",dYe=RegExp("["+uYe+iYe+lYe+cYe+"]");function hYe(t){return dYe.test(t)}var vde=hYe;function fYe(t){return t.split("")}var pYe=fYe,xde="\\ud800-\\udfff",mYe="\\u0300-\\u036f",gYe="\\ufe20-\\ufe2f",yYe="\\u20d0-\\u20ff",vYe=mYe+gYe+yYe,xYe="\\ufe0e\\ufe0f",bYe="["+xde+"]",Fj="["+vYe+"]",jj="\\ud83c[\\udffb-\\udfff]",wYe="(?:"+Fj+"|"+jj+")",bde="[^"+xde+"]",wde="(?:\\ud83c[\\udde6-\\uddff]){2}",Sde="[\\ud800-\\udbff][\\udc00-\\udfff]",SYe="\\u200d",_de=wYe+"?",Tde="["+xYe+"]?",_Ye="(?:"+SYe+"(?:"+[bde,wde,Sde].join("|")+")"+Tde+_de+")*",TYe=Tde+_de+_Ye,EYe="(?:"+[bde+Fj+"?",Fj,wde,Sde,bYe].join("|")+")",CYe=RegExp(jj+"(?="+jj+")|"+EYe+TYe,"g");function NYe(t){return t.match(CYe)||[]}var AYe=NYe,IYe=pYe,kYe=vde,MYe=AYe;function RYe(t){return kYe(t)?MYe(t):IYe(t)}var PYe=RYe,OYe=rYe,DYe=vde,$Ye=PYe,LYe=hde;function FYe(t){return function(e){e=LYe(e);var n=DYe(e)?$Ye(e):void 0,r=n?n[0]:e.charAt(0),i=n?OYe(n,1).join(""):e.slice(1);return r[t]()+i}}var jYe=FYe,zYe=jYe,BYe=zYe("toUpperCase"),UYe=BYe;const oP=lr(UYe);function Mr(t){return function(){return t}}const Ede=Math.cos,rI=Math.sin,eu=Math.sqrt,iI=Math.PI,lP=2*iI,zj=Math.PI,Bj=2*zj,om=1e-6,VYe=Bj-om;function Cde(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function WYe(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Cde;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let HYe=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Cde:WYe(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,a){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+a}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let a=this._x1,o=this._y1,l=r-e,c=i-n,u=a-e,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>om)if(!(Math.abs(d*l-c*u)>om)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let f=r-a,p=i-o,g=l*l+c*c,m=f*f+p*p,y=Math.sqrt(g),x=Math.sqrt(h),b=s*Math.tan((zj-Math.acos((g+h-m)/(2*y*x)))/2),_=b/x,T=b/y;Math.abs(_-1)>om&&this._append`L${e+_*u},${n+_*d}`,this._append`A${s},${s},0,0,${+(d*f>u*p)},${this._x1=e+T*l},${this._y1=n+T*c}`}}arc(e,n,r,i,s,a){if(e=+e,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(i),l=r*Math.sin(i),c=e+o,u=n+l,d=1^a,h=a?i-s:s-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>om||Math.abs(this._y1-u)>om)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%Bj+Bj),h>VYe?this._append`A${r},${r},0,1,${d},${e-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>om&&this._append`A${r},${r},0,${+(h>=zj)},${d},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function X5(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new HYe(e)}function K5(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Nde(t){this._context=t}Nde.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function cP(t){return new Nde(t)}function Ade(t){return t[0]}function Ide(t){return t[1]}function kde(t,e){var n=Mr(!0),r=null,i=cP,s=null,a=X5(o);t=typeof t=="function"?t:t===void 0?Ade:Mr(t),e=typeof e=="function"?e:e===void 0?Ide:Mr(e);function o(l){var c,u=(l=K5(l)).length,d,h=!1,f;for(r==null&&(s=i(f=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+t(d,c,l),+e(d,c,l));if(f)return s=null,f+""||null}return o.x=function(l){return arguments.length?(t=typeof l=="function"?l:Mr(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:Mr(+l),o):e},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:Mr(!!l),o):n},o.curve=function(l){return arguments.length?(i=l,r!=null&&(s=i(r)),o):i},o.context=function(l){return arguments.length?(l==null?r=s=null:s=i(r=l),o):r},o}function uN(t,e,n){var r=null,i=Mr(!0),s=null,a=cP,o=null,l=X5(c);t=typeof t=="function"?t:t===void 0?Ade:Mr(+t),e=typeof e=="function"?e:Mr(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Ide:Mr(+n);function c(d){var h,f,p,g=(d=K5(d)).length,m,y=!1,x,b=new Array(g),_=new Array(g);for(s==null&&(o=a(x=l())),h=0;h<=g;++h){if(!(h<g&&i(m=d[h],h,d))===y)if(y=!y)f=h,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),p=h-1;p>=f;--p)o.point(b[p],_[p]);o.lineEnd(),o.areaEnd()}y&&(b[h]=+t(m,h,d),_[h]=+e(m,h,d),o.point(r?+r(m,h,d):b[h],n?+n(m,h,d):_[h]))}if(x)return o=null,x+""||null}function u(){return kde().defined(i).curve(a).context(s)}return c.x=function(d){return arguments.length?(t=typeof d=="function"?d:Mr(+d),r=null,c):t},c.x0=function(d){return arguments.length?(t=typeof d=="function"?d:Mr(+d),c):t},c.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Mr(+d),c):r},c.y=function(d){return arguments.length?(e=typeof d=="function"?d:Mr(+d),n=null,c):e},c.y0=function(d){return arguments.length?(e=typeof d=="function"?d:Mr(+d),c):e},c.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Mr(+d),c):n},c.lineX0=c.lineY0=function(){return u().x(t).y(e)},c.lineY1=function(){return u().x(t).y(n)},c.lineX1=function(){return u().x(r).y(e)},c.defined=function(d){return arguments.length?(i=typeof d=="function"?d:Mr(!!d),c):i},c.curve=function(d){return arguments.length?(a=d,s!=null&&(o=a(s)),c):a},c.context=function(d){return arguments.length?(d==null?s=o=null:o=a(s=d),c):s},c}class Mde{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function GYe(t){return new Mde(t,!0)}function qYe(t){return new Mde(t,!1)}const Y5={draw(t,e){const n=eu(e/iI);t.moveTo(n,0),t.arc(0,0,n,0,lP)}},XYe={draw(t,e){const n=eu(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Rde=eu(1/3),KYe=Rde*2,YYe={draw(t,e){const n=eu(e/KYe),r=n*Rde;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},ZYe={draw(t,e){const n=eu(e),r=-n/2;t.rect(r,r,n,n)}},QYe=.8908130915292852,Pde=rI(iI/10)/rI(7*iI/10),JYe=rI(lP/10)*Pde,eZe=-Ede(lP/10)*Pde,tZe={draw(t,e){const n=eu(e*QYe),r=JYe*n,i=eZe*n;t.moveTo(0,-n),t.lineTo(r,i);for(let s=1;s<5;++s){const a=lP*s/5,o=Ede(a),l=rI(a);t.lineTo(l*n,-o*n),t.lineTo(o*r-l*i,l*r+o*i)}t.closePath()}},tL=eu(3),nZe={draw(t,e){const n=-eu(e/(tL*3));t.moveTo(0,n*2),t.lineTo(-tL*n,-n),t.lineTo(tL*n,-n),t.closePath()}},xl=-.5,bl=eu(3)/2,Uj=1/eu(12),rZe=(Uj/2+1)*3,iZe={draw(t,e){const n=eu(e/rZe),r=n/2,i=n*Uj,s=r,a=n*Uj+n,o=-s,l=a;t.moveTo(r,i),t.lineTo(s,a),t.lineTo(o,l),t.lineTo(xl*r-bl*i,bl*r+xl*i),t.lineTo(xl*s-bl*a,bl*s+xl*a),t.lineTo(xl*o-bl*l,bl*o+xl*l),t.lineTo(xl*r+bl*i,xl*i-bl*r),t.lineTo(xl*s+bl*a,xl*a-bl*s),t.lineTo(xl*o+bl*l,xl*l-bl*o),t.closePath()}};function sZe(t,e){let n=null,r=X5(i);t=typeof t=="function"?t:Mr(t||Y5),e=typeof e=="function"?e:Mr(e===void 0?64:+e);function i(){let s;if(n||(n=s=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(t=typeof s=="function"?s:Mr(s),i):t},i.size=function(s){return arguments.length?(e=typeof s=="function"?s:Mr(+s),i):e},i.context=function(s){return arguments.length?(n=s??null,i):n},i}function sI(){}function aI(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Ode(t){this._context=t}Ode.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:aI(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:aI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function aZe(t){return new Ode(t)}function Dde(t){this._context=t}Dde.prototype={areaStart:sI,areaEnd:sI,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:aI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function oZe(t){return new Dde(t)}function $de(t){this._context=t}$de.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:aI(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function lZe(t){return new $de(t)}function Lde(t){this._context=t}Lde.prototype={areaStart:sI,areaEnd:sI,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function cZe(t){return new Lde(t)}function cK(t){return t<0?-1:1}function uK(t,e,n){var r=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),o=(s*i+a*r)/(r+i);return(cK(s)+cK(a))*Math.min(Math.abs(s),Math.abs(a),.5*Math.abs(o))||0}function dK(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function nL(t,e,n){var r=t._x0,i=t._y0,s=t._x1,a=t._y1,o=(s-r)/3;t._context.bezierCurveTo(r+o,i+o*e,s-o,a-o*n,s,a)}function oI(t){this._context=t}oI.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nL(this,this._t0,dK(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,nL(this,dK(this,n=uK(this,t,e)),n);break;default:nL(this,this._t0,n=uK(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function Fde(t){this._context=new jde(t)}(Fde.prototype=Object.create(oI.prototype)).point=function(t,e){oI.prototype.point.call(this,e,t)};function jde(t){this._context=t}jde.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,s){this._context.bezierCurveTo(e,t,r,n,s,i)}};function uZe(t){return new oI(t)}function dZe(t){return new Fde(t)}function zde(t){this._context=t}zde.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=hK(t),i=hK(e),s=0,a=1;a<n;++s,++a)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],t[a],e[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function hK(t){var e,n=t.length-1,r,i=new Array(n),s=new Array(n),a=new Array(n);for(i[0]=0,s[0]=2,a[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,s[e]=4,a[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,s[n-1]=7,a[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/s[e-1],s[e]-=r,a[e]-=r*a[e-1];for(i[n-1]=a[n-1]/s[n-1],e=n-2;e>=0;--e)i[e]=(a[e]-i[e+1])/s[e];for(s[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-i[e+1];return[i,s]}function hZe(t){return new zde(t)}function uP(t,e){this._context=t,this._t=e}uP.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function fZe(t){return new uP(t,.5)}function pZe(t){return new uP(t,0)}function mZe(t){return new uP(t,1)}function n0(t,e){if((a=t.length)>1)for(var n=1,r,i,s=t[e[0]],a,o=s.length;n<a;++n)for(i=s,s=t[e[n]],r=0;r<o;++r)s[r][1]+=s[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function Vj(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function gZe(t,e){return t[e]}function yZe(t){const e=[];return e.key=t,e}function vZe(){var t=Mr([]),e=Vj,n=n0,r=gZe;function i(s){var a=Array.from(t.apply(this,arguments),yZe),o,l=a.length,c=-1,u;for(const d of s)for(o=0,++c;o<l;++o)(a[o][c]=[0,+r(d,a[o].key,c,s)]).data=d;for(o=0,u=K5(e(a));o<l;++o)a[u[o]].index=o;return n(a,u),a}return i.keys=function(s){return arguments.length?(t=typeof s=="function"?s:Mr(Array.from(s)),i):t},i.value=function(s){return arguments.length?(r=typeof s=="function"?s:Mr(+s),i):r},i.order=function(s){return arguments.length?(e=s==null?Vj:typeof s=="function"?s:Mr(Array.from(s)),i):e},i.offset=function(s){return arguments.length?(n=s??n0,i):n},i}function xZe(t,e){if((r=t.length)>0){for(var n,r,i=0,s=t[0].length,a;i<s;++i){for(a=n=0;n<r;++n)a+=t[n][i][1]||0;if(a)for(n=0;n<r;++n)t[n][i][1]/=a}n0(t,e)}}function bZe(t,e){if((i=t.length)>0){for(var n=0,r=t[e[0]],i,s=r.length;n<s;++n){for(var a=0,o=0;a<i;++a)o+=t[a][n][1]||0;r[n][1]+=r[n][0]=-o/2}n0(t,e)}}function wZe(t,e){if(!(!((a=t.length)>0)||!((s=(i=t[e[0]]).length)>0))){for(var n=0,r=1,i,s,a;r<s;++r){for(var o=0,l=0,c=0;o<a;++o){for(var u=t[e[o]],d=u[r][1]||0,h=u[r-1][1]||0,f=(d-h)/2,p=0;p<o;++p){var g=t[e[p]],m=g[r][1]||0,y=g[r-1][1]||0;f+=m-y}l+=d,c+=f*d}i[r-1][1]+=i[r-1][0]=n,l&&(n-=c/l)}i[r-1][1]+=i[r-1][0]=n,n0(t,e)}}function aS(t){"@babel/helpers - typeof";return aS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},aS(t)}var SZe=["type","size","sizeType"];function Wj(){return Wj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Wj.apply(this,arguments)}function fK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function pK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?fK(Object(n),!0).forEach(function(r){_Ze(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):fK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _Ze(t,e,n){return e=TZe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function TZe(t){var e=EZe(t,"string");return aS(e)=="symbol"?e:e+""}function EZe(t,e){if(aS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(aS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function CZe(t,e){if(t==null)return{};var n=NZe(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function NZe(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var Bde={symbolCircle:Y5,symbolCross:XYe,symbolDiamond:YYe,symbolSquare:ZYe,symbolStar:tZe,symbolTriangle:nZe,symbolWye:iZe},AZe=Math.PI/180,IZe=function(e){var n="symbol".concat(oP(e));return Bde[n]||Y5},kZe=function(e,n,r){if(n==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*AZe;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.pow(Math.tan(i),2))}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},MZe=function(e,n){Bde["symbol".concat(oP(e))]=n},Z5=function(e){var n=e.type,r=n===void 0?"circle":n,i=e.size,s=i===void 0?64:i,a=e.sizeType,o=a===void 0?"area":a,l=CZe(e,SZe),c=pK(pK({},l),{},{type:r,size:s,sizeType:o}),u=function(){var m=IZe(r),y=sZe().type(m).size(kZe(s,o,r));return y()},d=c.className,h=c.cx,f=c.cy,p=Rn(c,!0);return h===+h&&f===+f&&s===+s?le.createElement("path",Wj({},p,{className:qn("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(f,")"),d:u()})):null};Z5.registerSymbol=MZe;function r0(t){"@babel/helpers - typeof";return r0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r0(t)}function Hj(){return Hj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Hj.apply(this,arguments)}function mK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function RZe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?mK(Object(n),!0).forEach(function(r){oS(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):mK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function PZe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function OZe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Vde(r.key),r)}}function DZe(t,e,n){return e&&OZe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function $Ze(t,e,n){return e=lI(e),LZe(t,Ude()?Reflect.construct(e,n||[],lI(t).constructor):e.apply(t,n))}function LZe(t,e){if(e&&(r0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return FZe(t)}function FZe(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Ude(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Ude=function(){return!!t})()}function lI(t){return lI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},lI(t)}function jZe(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gj(t,e)}function Gj(t,e){return Gj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Gj(t,e)}function oS(t,e,n){return e=Vde(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vde(t){var e=zZe(t,"string");return r0(e)=="symbol"?e:e+""}function zZe(t,e){if(r0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(r0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ac=32,Q5=function(t){function e(){return PZe(this,e),$Ze(this,e,arguments)}return jZe(e,t),DZe(e,[{key:"renderIcon",value:function(r){var i=this.props.inactiveColor,s=ac/2,a=ac/6,o=ac/3,l=r.inactive?i:r.color;if(r.type==="plainline")return le.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:s,x2:ac,y2:s,className:"recharts-legend-icon"});if(r.type==="line")return le.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(s,"h").concat(o,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*o,",").concat(s,`
            H`).concat(ac,"M").concat(2*o,",").concat(s,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(o,",").concat(s),className:"recharts-legend-icon"});if(r.type==="rect")return le.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(ac/8,"h").concat(ac,"v").concat(ac*3/4,"h").concat(-32,"z"),className:"recharts-legend-icon"});if(le.isValidElement(r.legendIcon)){var c=RZe({},r);return delete c.legendIcon,le.cloneElement(r.legendIcon,c)}return le.createElement(Z5,{fill:l,cx:s,cy:s,size:ac,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,i=this.props,s=i.payload,a=i.iconSize,o=i.layout,l=i.formatter,c=i.inactiveColor,u={x:0,y:0,width:ac,height:ac},d={display:o==="horizontal"?"inline-block":"block",marginRight:10},h={display:"inline-block",verticalAlign:"middle",marginRight:4};return s.map(function(f,p){var g=f.formatter||l,m=qn(oS(oS({"recharts-legend-item":!0},"legend-item-".concat(p),!0),"inactive",f.inactive));if(f.type==="none")return null;var y=wn(f.value)?null:f.value;Gd(!wn(f.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var x=f.inactive?c:f.color;return le.createElement("li",Hj({className:m,style:d,key:"legend-item-".concat(p)},nI(r.props,f,p)),le.createElement($j,{width:a,height:a,viewBox:u,style:h},r.renderIcon(f)),le.createElement("span",{className:"recharts-legend-item-text",style:{color:x}},g?g(y,f,p):y))})}},{key:"render",value:function(){var r=this.props,i=r.payload,s=r.layout,a=r.align;if(!i||!i.length)return null;var o={padding:0,margin:0,textAlign:s==="horizontal"?a:"left"};return le.createElement("ul",{className:"recharts-default-legend",style:o},this.renderItems())}}])}(P.PureComponent);oS(Q5,"displayName","Legend");oS(Q5,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var BZe=XR;function UZe(){this.__data__=new BZe,this.size=0}var VZe=UZe;function WZe(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}var HZe=WZe;function GZe(t){return this.__data__.get(t)}var qZe=GZe;function XZe(t){return this.__data__.has(t)}var KZe=XZe,YZe=XR,ZZe=j5,QZe=z5,JZe=200;function eQe(t,e){var n=this.__data__;if(n instanceof YZe){var r=n.__data__;if(!ZZe||r.length<JZe-1)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new QZe(r)}return n.set(t,e),this.size=n.size,this}var tQe=eQe,nQe=XR,rQe=VZe,iQe=HZe,sQe=qZe,aQe=KZe,oQe=tQe;function pb(t){var e=this.__data__=new nQe(t);this.size=e.size}pb.prototype.clear=rQe;pb.prototype.delete=iQe;pb.prototype.get=sQe;pb.prototype.has=aQe;pb.prototype.set=oQe;var Wde=pb,lQe="__lodash_hash_undefined__";function cQe(t){return this.__data__.set(t,lQe),this}var uQe=cQe;function dQe(t){return this.__data__.has(t)}var hQe=dQe,fQe=z5,pQe=uQe,mQe=hQe;function cI(t){var e=-1,n=t==null?0:t.length;for(this.__data__=new fQe;++e<n;)this.add(t[e])}cI.prototype.add=cI.prototype.push=pQe;cI.prototype.has=mQe;var Hde=cI;function gQe(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(e(t[n],n,t))return!0;return!1}var Gde=gQe;function yQe(t,e){return t.has(e)}var qde=yQe,vQe=Hde,xQe=Gde,bQe=qde,wQe=1,SQe=2;function _Qe(t,e,n,r,i,s){var a=n&wQe,o=t.length,l=e.length;if(o!=l&&!(a&&l>o))return!1;var c=s.get(t),u=s.get(e);if(c&&u)return c==e&&u==t;var d=-1,h=!0,f=n&SQe?new vQe:void 0;for(s.set(t,e),s.set(e,t);++d<o;){var p=t[d],g=e[d];if(r)var m=a?r(g,p,d,e,t,s):r(p,g,d,t,e,s);if(m!==void 0){if(m)continue;h=!1;break}if(f){if(!xQe(e,function(y,x){if(!bQe(f,x)&&(p===y||i(p,y,n,r,s)))return f.push(x)})){h=!1;break}}else if(!(p===g||i(p,g,n,r,s))){h=!1;break}}return s.delete(t),s.delete(e),h}var Xde=_Qe,TQe=sd,EQe=TQe.Uint8Array,CQe=EQe;function NQe(t){var e=-1,n=Array(t.size);return t.forEach(function(r,i){n[++e]=[i,r]}),n}var AQe=NQe;function IQe(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var J5=IQe,gK=JT,yK=CQe,kQe=F5,MQe=Xde,RQe=AQe,PQe=J5,OQe=1,DQe=2,$Qe="[object Boolean]",LQe="[object Date]",FQe="[object Error]",jQe="[object Map]",zQe="[object Number]",BQe="[object RegExp]",UQe="[object Set]",VQe="[object String]",WQe="[object Symbol]",HQe="[object ArrayBuffer]",GQe="[object DataView]",vK=gK?gK.prototype:void 0,rL=vK?vK.valueOf:void 0;function qQe(t,e,n,r,i,s,a){switch(n){case GQe:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case HQe:return!(t.byteLength!=e.byteLength||!s(new yK(t),new yK(e)));case $Qe:case LQe:case zQe:return kQe(+t,+e);case FQe:return t.name==e.name&&t.message==e.message;case BQe:case VQe:return t==e+"";case jQe:var o=RQe;case UQe:var l=r&OQe;if(o||(o=PQe),t.size!=e.size&&!l)return!1;var c=a.get(t);if(c)return c==e;r|=DQe,a.set(t,e);var u=MQe(o(t),o(e),r,i,s,a);return a.delete(t),u;case WQe:if(rL)return rL.call(t)==rL.call(e)}return!1}var XQe=qQe;function KQe(t,e){for(var n=-1,r=e.length,i=t.length;++n<r;)t[i+n]=e[n];return t}var Kde=KQe,YQe=Kde,ZQe=No;function QQe(t,e,n){var r=e(t);return ZQe(t)?r:YQe(r,n(t))}var JQe=QQe;function eJe(t,e){for(var n=-1,r=t==null?0:t.length,i=0,s=[];++n<r;){var a=t[n];e(a,n,t)&&(s[i++]=a)}return s}var tJe=eJe;function nJe(){return[]}var rJe=nJe,iJe=tJe,sJe=rJe,aJe=Object.prototype,oJe=aJe.propertyIsEnumerable,xK=Object.getOwnPropertySymbols,lJe=xK?function(t){return t==null?[]:(t=Object(t),iJe(xK(t),function(e){return oJe.call(t,e)}))}:sJe,cJe=lJe;function uJe(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}var dJe=uJe,hJe=wh,fJe=Sh,pJe="[object Arguments]";function mJe(t){return fJe(t)&&hJe(t)==pJe}var gJe=mJe,bK=gJe,yJe=Sh,Yde=Object.prototype,vJe=Yde.hasOwnProperty,xJe=Yde.propertyIsEnumerable,bJe=bK(function(){return arguments}())?bK:function(t){return yJe(t)&&vJe.call(t,"callee")&&!xJe.call(t,"callee")},eH=bJe,uI={exports:{}};function wJe(){return!1}var SJe=wJe;uI.exports;(function(t,e){var n=sd,r=SJe,i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,a=s&&s.exports===i,o=a?n.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||r;t.exports=c})(uI,uI.exports);var Zde=uI.exports,_Je=9007199254740991,TJe=/^(?:0|[1-9]\d*)$/;function EJe(t,e){var n=typeof t;return e=e??_Je,!!e&&(n=="number"||n!="symbol"&&TJe.test(t))&&t>-1&&t%1==0&&t<e}var tH=EJe,CJe=9007199254740991;function NJe(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=CJe}var nH=NJe,AJe=wh,IJe=nH,kJe=Sh,MJe="[object Arguments]",RJe="[object Array]",PJe="[object Boolean]",OJe="[object Date]",DJe="[object Error]",$Je="[object Function]",LJe="[object Map]",FJe="[object Number]",jJe="[object Object]",zJe="[object RegExp]",BJe="[object Set]",UJe="[object String]",VJe="[object WeakMap]",WJe="[object ArrayBuffer]",HJe="[object DataView]",GJe="[object Float32Array]",qJe="[object Float64Array]",XJe="[object Int8Array]",KJe="[object Int16Array]",YJe="[object Int32Array]",ZJe="[object Uint8Array]",QJe="[object Uint8ClampedArray]",JJe="[object Uint16Array]",eet="[object Uint32Array]",jr={};jr[GJe]=jr[qJe]=jr[XJe]=jr[KJe]=jr[YJe]=jr[ZJe]=jr[QJe]=jr[JJe]=jr[eet]=!0;jr[MJe]=jr[RJe]=jr[WJe]=jr[PJe]=jr[HJe]=jr[OJe]=jr[DJe]=jr[$Je]=jr[LJe]=jr[FJe]=jr[jJe]=jr[zJe]=jr[BJe]=jr[UJe]=jr[VJe]=!1;function tet(t){return kJe(t)&&IJe(t.length)&&!!jr[AJe(t)]}var net=tet;function ret(t){return function(e){return t(e)}}var Qde=ret,dI={exports:{}};dI.exports;(function(t,e){var n=ade,r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,a=s&&n.process,o=function(){try{var l=i&&i.require&&i.require("util").types;return l||a&&a.binding&&a.binding("util")}catch{}}();t.exports=o})(dI,dI.exports);var iet=dI.exports,set=net,aet=Qde,wK=iet,SK=wK&&wK.isTypedArray,oet=SK?aet(SK):set,Jde=oet,cet=dJe,uet=eH,det=No,het=Zde,fet=tH,pet=Jde,met=Object.prototype,get=met.hasOwnProperty;function yet(t,e){var n=det(t),r=!n&&uet(t),i=!n&&!r&&het(t),s=!n&&!r&&!i&&pet(t),a=n||r||i||s,o=a?cet(t.length,String):[],l=o.length;for(var c in t)(e||get.call(t,c))&&!(a&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||fet(c,l)))&&o.push(c);return o}var vet=yet,xet=Object.prototype;function bet(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||xet;return t===n}var wet=bet;function _et(t,e){return function(n){return t(e(n))}}var ehe=_et,Tet=ehe,Eet=Tet(Object.keys,Object),Cet=Eet,Net=wet,Aet=Cet,Iet=Object.prototype,ket=Iet.hasOwnProperty;function Met(t){if(!Net(t))return Aet(t);var e=[];for(var n in Object(t))ket.call(t,n)&&n!="constructor"&&e.push(n);return e}var Ret=Met,Pet=L5,Oet=nH;function Det(t){return t!=null&&Oet(t.length)&&!Pet(t)}var tE=Det,$et=vet,Let=Ret,Fet=tE;function jet(t){return Fet(t)?$et(t):Let(t)}var dP=jet,zet=JQe,Bet=cJe,Uet=dP;function Vet(t){return zet(t,Uet,Bet)}var Wet=Vet,_K=Wet,Het=1,Get=Object.prototype,qet=Get.hasOwnProperty;function Xet(t,e,n,r,i,s){var a=n&Het,o=_K(t),l=o.length,c=_K(e),u=c.length;if(l!=u&&!a)return!1;for(var d=l;d--;){var h=o[d];if(!(a?h in e:qet.call(e,h)))return!1}var f=s.get(t),p=s.get(e);if(f&&p)return f==e&&p==t;var g=!0;s.set(t,e),s.set(e,t);for(var m=a;++d<l;){h=o[d];var y=t[h],x=e[h];if(r)var b=a?r(x,y,h,e,t,s):r(y,x,h,t,e,s);if(!(b===void 0?y===x||i(y,x,n,r,s):b)){g=!1;break}m||(m=h=="constructor")}if(g&&!m){var _=t.constructor,T=e.constructor;_!=T&&"constructor"in t&&"constructor"in e&&!(typeof _=="function"&&_ instanceof _&&typeof T=="function"&&T instanceof T)&&(g=!1)}return s.delete(t),s.delete(e),g}var Ket=Xet,Yet=ry,Zet=sd,Qet=Yet(Zet,"DataView"),Jet=Qet,ett=ry,ttt=sd,ntt=ett(ttt,"Promise"),rtt=ntt,itt=ry,stt=sd,att=itt(stt,"Set"),the=att,ott=ry,ltt=sd,ctt=ott(ltt,"WeakMap"),utt=ctt,qj=Jet,Xj=j5,Kj=rtt,Yj=the,Zj=utt,nhe=wh,mb=lde,TK="[object Map]",dtt="[object Object]",EK="[object Promise]",CK="[object Set]",NK="[object WeakMap]",AK="[object DataView]",htt=mb(qj),ftt=mb(Xj),ptt=mb(Kj),mtt=mb(Yj),gtt=mb(Zj),lm=nhe;(qj&&lm(new qj(new ArrayBuffer(1)))!=AK||Xj&&lm(new Xj)!=TK||Kj&&lm(Kj.resolve())!=EK||Yj&&lm(new Yj)!=CK||Zj&&lm(new Zj)!=NK)&&(lm=function(t){var e=nhe(t),n=e==dtt?t.constructor:void 0,r=n?mb(n):"";if(r)switch(r){case htt:return AK;case ftt:return TK;case ptt:return EK;case mtt:return CK;case gtt:return NK}return e});var ytt=lm,iL=Wde,vtt=Xde,xtt=XQe,btt=Ket,IK=ytt,kK=No,MK=Zde,wtt=Jde,Stt=1,RK="[object Arguments]",PK="[object Array]",dN="[object Object]",_tt=Object.prototype,OK=_tt.hasOwnProperty;function Ttt(t,e,n,r,i,s){var a=kK(t),o=kK(e),l=a?PK:IK(t),c=o?PK:IK(e);l=l==RK?dN:l,c=c==RK?dN:c;var u=l==dN,d=c==dN,h=l==c;if(h&&MK(t)){if(!MK(e))return!1;a=!0,u=!1}if(h&&!u)return s||(s=new iL),a||wtt(t)?vtt(t,e,n,r,i,s):xtt(t,e,l,n,r,i,s);if(!(n&Stt)){var f=u&&OK.call(t,"__wrapped__"),p=d&&OK.call(e,"__wrapped__");if(f||p){var g=f?t.value():t,m=p?e.value():e;return s||(s=new iL),i(g,m,n,r,s)}}return h?(s||(s=new iL),btt(t,e,n,r,i,s)):!1}var Ett=Ttt,Ctt=Ett,DK=Sh;function rhe(t,e,n,r,i){return t===e?!0:t==null||e==null||!DK(t)&&!DK(e)?t!==t&&e!==e:Ctt(t,e,n,r,rhe,i)}var rH=rhe,Ntt=Wde,Att=rH,Itt=1,ktt=2;function Mtt(t,e,n,r){var i=n.length,s=i,a=!r;if(t==null)return!s;for(t=Object(t);i--;){var o=n[i];if(a&&o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++i<s;){o=n[i];var l=o[0],c=t[l],u=o[1];if(a&&o[2]){if(c===void 0&&!(l in t))return!1}else{var d=new Ntt;if(r)var h=r(c,u,l,t,e,d);if(!(h===void 0?Att(u,c,Itt|ktt,r,d):h))return!1}}return!0}var Rtt=Mtt,Ptt=wp;function Ott(t){return t===t&&!Ptt(t)}var ihe=Ott,Dtt=ihe,$tt=dP;function Ltt(t){for(var e=$tt(t),n=e.length;n--;){var r=e[n],i=t[r];e[n]=[r,i,Dtt(i)]}return e}var Ftt=Ltt;function jtt(t,e){return function(n){return n==null?!1:n[t]===e&&(e!==void 0||t in Object(n))}}var she=jtt,ztt=Rtt,Btt=Ftt,Utt=she;function Vtt(t){var e=Btt(t);return e.length==1&&e[0][2]?Utt(e[0][0],e[0][1]):function(n){return n===t||ztt(n,t,e)}}var Wtt=Vtt;function Htt(t,e){return t!=null&&e in Object(t)}var Gtt=Htt,qtt=fde,Xtt=eH,Ktt=No,Ytt=tH,Ztt=nH,Qtt=YR;function Jtt(t,e,n){e=qtt(e,t);for(var r=-1,i=e.length,s=!1;++r<i;){var a=Qtt(e[r]);if(!(s=t!=null&&n(t,a)))break;t=t[a]}return s||++r!=i?s:(i=t==null?0:t.length,!!i&&Ztt(i)&&Ytt(a,i)&&(Ktt(t)||Xtt(t)))}var ent=Jtt,tnt=Gtt,nnt=ent;function rnt(t,e){return t!=null&&nnt(t,e,tnt)}var int=rnt,snt=rH,ant=pde,ont=int,lnt=$5,cnt=ihe,unt=she,dnt=YR,hnt=1,fnt=2;function pnt(t,e){return lnt(t)&&cnt(e)?unt(dnt(t),e):function(n){var r=ant(n,t);return r===void 0&&r===e?ont(n,t):snt(e,r,hnt|fnt)}}var mnt=pnt;function gnt(t){return t}var gb=gnt;function ynt(t){return function(e){return e==null?void 0:e[t]}}var vnt=ynt,xnt=V5;function bnt(t){return function(e){return xnt(e,t)}}var wnt=bnt,Snt=vnt,_nt=wnt,Tnt=$5,Ent=YR;function Cnt(t){return Tnt(t)?Snt(Ent(t)):_nt(t)}var Nnt=Cnt,Ant=Wtt,Int=mnt,knt=gb,Mnt=No,Rnt=Nnt;function Pnt(t){return typeof t=="function"?t:t==null?knt:typeof t=="object"?Mnt(t)?Int(t[0],t[1]):Ant(t):Rnt(t)}var Sp=Pnt;function Ont(t,e,n,r){for(var i=t.length,s=n+(r?1:-1);r?s--:++s<i;)if(e(t[s],s,t))return s;return-1}var ahe=Ont;function Dnt(t){return t!==t}var $nt=Dnt;function Lnt(t,e,n){for(var r=n-1,i=t.length;++r<i;)if(t[r]===e)return r;return-1}var Fnt=Lnt,jnt=ahe,znt=$nt,Bnt=Fnt;function Unt(t,e,n){return e===e?Bnt(t,e,n):jnt(t,znt,n)}var Vnt=Unt,Wnt=Vnt;function Hnt(t,e){var n=t==null?0:t.length;return!!n&&Wnt(t,e,0)>-1}var Gnt=Hnt;function qnt(t,e,n){for(var r=-1,i=t==null?0:t.length;++r<i;)if(n(e,t[r]))return!0;return!1}var Xnt=qnt;function Knt(){}var Ynt=Knt,sL=the,Znt=Ynt,Qnt=J5,Jnt=1/0,ert=sL&&1/Qnt(new sL([,-0]))[1]==Jnt?function(t){return new sL(t)}:Znt,trt=ert,nrt=Hde,rrt=Gnt,irt=Xnt,srt=qde,art=trt,ort=J5,lrt=200;function crt(t,e,n){var r=-1,i=rrt,s=t.length,a=!0,o=[],l=o;if(n)a=!1,i=irt;else if(s>=lrt){var c=e?null:art(t);if(c)return ort(c);a=!1,i=srt,l=new nrt}else l=e?[]:o;e:for(;++r<s;){var u=t[r],d=e?e(u):u;if(u=n||u!==0?u:0,a&&d===d){for(var h=l.length;h--;)if(l[h]===d)continue e;e&&l.push(d),o.push(u)}else i(l,d,n)||(l!==o&&l.push(d),o.push(u))}return o}var urt=crt,drt=Sp,hrt=urt;function frt(t,e){return t&&t.length?hrt(t,drt(e)):[]}var prt=frt;const $K=lr(prt);function ohe(t,e,n){return e===!0?$K(t,n):wn(e)?$K(t,e):t}function i0(t){"@babel/helpers - typeof";return i0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i0(t)}var mrt=["ref"];function LK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function pd(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LK(Object(n),!0).forEach(function(r){hP(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function grt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function FK(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,che(r.key),r)}}function yrt(t,e,n){return e&&FK(t.prototype,e),n&&FK(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function vrt(t,e,n){return e=hI(e),xrt(t,lhe()?Reflect.construct(e,n||[],hI(t).constructor):e.apply(t,n))}function xrt(t,e){if(e&&(i0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return brt(t)}function brt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lhe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lhe=function(){return!!t})()}function hI(t){return hI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},hI(t)}function wrt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qj(t,e)}function Qj(t,e){return Qj=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Qj(t,e)}function hP(t,e,n){return e=che(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function che(t){var e=Srt(t,"string");return i0(e)=="symbol"?e:e+""}function Srt(t,e){if(i0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(i0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function _rt(t,e){if(t==null)return{};var n=Trt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Trt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Ert(t){return t.value}function Crt(t,e){if(le.isValidElement(t))return le.cloneElement(t,e);if(typeof t=="function")return le.createElement(t,e);e.ref;var n=_rt(e,mrt);return le.createElement(Q5,n)}var jK=1,ox=function(t){function e(){var n;grt(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=vrt(this,e,[].concat(i)),hP(n,"lastBoundingBox",{width:-1,height:-1}),n}return wrt(e,t),yrt(e,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,i=this.getBBox();i?(Math.abs(i.width-this.lastBoundingBox.width)>jK||Math.abs(i.height-this.lastBoundingBox.height)>jK)&&(this.lastBoundingBox.width=i.width,this.lastBoundingBox.height=i.height,r&&r(i)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?pd({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var i=this.props,s=i.layout,a=i.align,o=i.verticalAlign,l=i.margin,c=i.chartWidth,u=i.chartHeight,d,h;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(a==="center"&&s==="vertical"){var f=this.getBBoxSnapshot();d={left:((c||0)-f.width)/2}}else d=a==="right"?{right:l&&l.right||0}:{left:l&&l.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(o==="middle"){var p=this.getBBoxSnapshot();h={top:((u||0)-p.height)/2}}else h=o==="bottom"?{bottom:l&&l.bottom||0}:{top:l&&l.top||0};return pd(pd({},d),h)}},{key:"render",value:function(){var r=this,i=this.props,s=i.content,a=i.width,o=i.height,l=i.wrapperStyle,c=i.payloadUniqBy,u=i.payload,d=pd(pd({position:"absolute",width:a||"auto",height:o||"auto"},this.getDefaultPosition(l)),l);return le.createElement("div",{className:"recharts-legend-wrapper",style:d,ref:function(f){r.wrapperNode=f}},Crt(s,pd(pd({},this.props),{},{payload:ohe(u,c,Ert)})))}}],[{key:"getWithHeight",value:function(r,i){var s=pd(pd({},this.defaultProps),r.props),a=s.layout;return a==="vertical"&&tt(r.props.height)?{height:r.props.height}:a==="horizontal"?{width:r.props.width||i}:null}}])}(P.PureComponent);hP(ox,"displayName","Legend");hP(ox,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var zK=JT,Nrt=eH,Art=No,BK=zK?zK.isConcatSpreadable:void 0;function Irt(t){return Art(t)||Nrt(t)||!!(BK&&t&&t[BK])}var krt=Irt,Mrt=Kde,Rrt=krt;function uhe(t,e,n,r,i){var s=-1,a=t.length;for(n||(n=Rrt),i||(i=[]);++s<a;){var o=t[s];e>0&&n(o)?e>1?uhe(o,e-1,n,r,i):Mrt(i,o):r||(i[i.length]=o)}return i}var dhe=uhe;function Prt(t){return function(e,n,r){for(var i=-1,s=Object(e),a=r(e),o=a.length;o--;){var l=a[t?o:++i];if(n(s[l],l,s)===!1)break}return e}}var Ort=Prt,Drt=Ort,$rt=Drt(),Lrt=$rt,Frt=Lrt,jrt=dP;function zrt(t,e){return t&&Frt(t,e,jrt)}var hhe=zrt,Brt=tE;function Urt(t,e){return function(n,r){if(n==null)return n;if(!Brt(n))return t(n,r);for(var i=n.length,s=e?i:-1,a=Object(n);(e?s--:++s<i)&&r(a[s],s,a)!==!1;);return n}}var Vrt=Urt,Wrt=hhe,Hrt=Vrt,Grt=Hrt(Wrt),iH=Grt,qrt=iH,Xrt=tE;function Krt(t,e){var n=-1,r=Xrt(t)?Array(t.length):[];return qrt(t,function(i,s,a){r[++n]=e(i,s,a)}),r}var fhe=Krt;function Yrt(t,e){var n=t.length;for(t.sort(e);n--;)t[n]=t[n].value;return t}var Zrt=Yrt,UK=lb;function Qrt(t,e){if(t!==e){var n=t!==void 0,r=t===null,i=t===t,s=UK(t),a=e!==void 0,o=e===null,l=e===e,c=UK(e);if(!o&&!c&&!s&&t>e||s&&a&&l&&!o&&!c||r&&a&&l||!n&&l||!i)return 1;if(!r&&!s&&!c&&t<e||c&&n&&i&&!r&&!s||o&&n&&i||!a&&i||!l)return-1}return 0}var Jrt=Qrt,eit=Jrt;function tit(t,e,n){for(var r=-1,i=t.criteria,s=e.criteria,a=i.length,o=n.length;++r<a;){var l=eit(i[r],s[r]);if(l){if(r>=o)return l;var c=n[r];return l*(c=="desc"?-1:1)}}return t.index-e.index}var nit=tit,aL=U5,rit=V5,iit=Sp,sit=fhe,ait=Zrt,oit=Qde,lit=nit,cit=gb,uit=No;function dit(t,e,n){e.length?e=aL(e,function(s){return uit(s)?function(a){return rit(a,s.length===1?s[0]:s)}:s}):e=[cit];var r=-1;e=aL(e,oit(iit));var i=sit(t,function(s,a,o){var l=aL(e,function(c){return c(s)});return{criteria:l,index:++r,value:s}});return ait(i,function(s,a){return lit(s,a,n)})}var hit=dit;function fit(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}var pit=fit,mit=pit,VK=Math.max;function git(t,e,n){return e=VK(e===void 0?t.length-1:e,0),function(){for(var r=arguments,i=-1,s=VK(r.length-e,0),a=Array(s);++i<s;)a[i]=r[e+i];i=-1;for(var o=Array(e+1);++i<e;)o[i]=r[i];return o[e]=n(a),mit(t,this,o)}}var yit=git;function vit(t){return function(){return t}}var xit=vit,bit=ry,wit=function(){try{var t=bit(Object,"defineProperty");return t({},"",{}),t}catch{}}(),phe=wit,Sit=xit,WK=phe,_it=gb,Tit=WK?function(t,e){return WK(t,"toString",{configurable:!0,enumerable:!1,value:Sit(e),writable:!0})}:_it,Eit=Tit,Cit=800,Nit=16,Ait=Date.now;function Iit(t){var e=0,n=0;return function(){var r=Ait(),i=Nit-(r-n);if(n=r,i>0){if(++e>=Cit)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var kit=Iit,Mit=Eit,Rit=kit,Pit=Rit(Mit),Oit=Pit,Dit=gb,$it=yit,Lit=Oit;function Fit(t,e){return Lit($it(t,e,Dit),t+"")}var jit=Fit,zit=F5,Bit=tE,Uit=tH,Vit=wp;function Wit(t,e,n){if(!Vit(n))return!1;var r=typeof e;return(r=="number"?Bit(n)&&Uit(e,n.length):r=="string"&&e in n)?zit(n[e],t):!1}var fP=Wit,Hit=dhe,Git=hit,qit=jit,HK=fP,Xit=qit(function(t,e){if(t==null)return[];var n=e.length;return n>1&&HK(t,e[0],e[1])?e=[]:n>2&&HK(e[0],e[1],e[2])&&(e=[e[0]]),Git(t,Hit(e,1),[])}),Kit=Xit;const sH=lr(Kit);function lS(t){"@babel/helpers - typeof";return lS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},lS(t)}function Jj(){return Jj=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Jj.apply(this,arguments)}function Yit(t,e){return est(t)||Jit(t,e)||Qit(t,e)||Zit()}function Zit(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Qit(t,e){if(t){if(typeof t=="string")return GK(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GK(t,e)}}function GK(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Jit(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function est(t){if(Array.isArray(t))return t}function qK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function oL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?qK(Object(n),!0).forEach(function(r){tst(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):qK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function tst(t,e,n){return e=nst(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nst(t){var e=rst(t,"string");return lS(e)=="symbol"?e:e+""}function rst(t,e){if(lS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(lS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ist(t){return Array.isArray(t)&&os(t[0])&&os(t[1])?t.join(" ~ "):t}var sst=function(e){var n=e.separator,r=n===void 0?" : ":n,i=e.contentStyle,s=i===void 0?{}:i,a=e.itemStyle,o=a===void 0?{}:a,l=e.labelStyle,c=l===void 0?{}:l,u=e.payload,d=e.formatter,h=e.itemSorter,f=e.wrapperClassName,p=e.labelClassName,g=e.label,m=e.labelFormatter,y=e.accessibilityLayer,x=y===void 0?!1:y,b=function(){if(u&&u.length){var $={padding:0,margin:0},z=(h?sH(u,h):u).map(function(O,j){if(O.type==="none")return null;var B=oL({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},o),W=O.formatter||d||ist,L=O.value,V=O.name,H=L,K=V;if(W&&H!=null&&K!=null){var te=W(L,V,O,j,u);if(Array.isArray(te)){var J=Yit(te,2);H=J[0],K=J[1]}else H=te}return le.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(j),style:B},os(K)?le.createElement("span",{className:"recharts-tooltip-item-name"},K):null,os(K)?le.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,le.createElement("span",{className:"recharts-tooltip-item-value"},H),le.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return le.createElement("ul",{className:"recharts-tooltip-item-list",style:$},z)}return null},_=oL({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},s),T=oL({margin:0},c),E=!Un(g),C=E?g:"",I=qn("recharts-default-tooltip",f),A=qn("recharts-tooltip-label",p);E&&m&&u!==void 0&&u!==null&&(C=m(g,u));var k=x?{role:"status","aria-live":"assertive"}:{};return le.createElement("div",Jj({className:I,style:_},k),le.createElement("p",{className:A,style:T},le.isValidElement(C)?C:"".concat(C)),b())};function cS(t){"@babel/helpers - typeof";return cS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cS(t)}function hN(t,e,n){return e=ast(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ast(t){var e=ost(t,"string");return cS(e)=="symbol"?e:e+""}function ost(t,e){if(cS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(cS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var dw="recharts-tooltip-wrapper",lst={visibility:"hidden"};function cst(t){var e=t.coordinate,n=t.translateX,r=t.translateY;return qn(dw,hN(hN(hN(hN({},"".concat(dw,"-right"),tt(n)&&e&&tt(e.x)&&n>=e.x),"".concat(dw,"-left"),tt(n)&&e&&tt(e.x)&&n<e.x),"".concat(dw,"-bottom"),tt(r)&&e&&tt(e.y)&&r>=e.y),"".concat(dw,"-top"),tt(r)&&e&&tt(e.y)&&r<e.y))}function XK(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.key,i=t.offsetTopLeft,s=t.position,a=t.reverseDirection,o=t.tooltipDimension,l=t.viewBox,c=t.viewBoxDimension;if(s&&tt(s[r]))return s[r];var u=n[r]-o-i,d=n[r]+i;if(e[r])return a[r]?u:d;if(a[r]){var h=u,f=l[r];return h<f?Math.max(d,l[r]):Math.max(u,l[r])}var p=d+o,g=l[r]+c;return p>g?Math.max(u,l[r]):Math.max(d,l[r])}function ust(t){var e=t.translateX,n=t.translateY,r=t.useTranslate3d;return{transform:r?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function dst(t){var e=t.allowEscapeViewBox,n=t.coordinate,r=t.offsetTopLeft,i=t.position,s=t.reverseDirection,a=t.tooltipBox,o=t.useTranslate3d,l=t.viewBox,c,u,d;return a.height>0&&a.width>0&&n?(u=XK({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:r,position:i,reverseDirection:s,tooltipDimension:a.width,viewBox:l,viewBoxDimension:l.width}),d=XK({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:r,position:i,reverseDirection:s,tooltipDimension:a.height,viewBox:l,viewBoxDimension:l.height}),c=ust({translateX:u,translateY:d,useTranslate3d:o})):c=lst,{cssProperties:c,cssClasses:cst({translateX:u,translateY:d,coordinate:n})}}function s0(t){"@babel/helpers - typeof";return s0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s0(t)}function KK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function YK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KK(Object(n),!0).forEach(function(r){tz(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function fst(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ghe(r.key),r)}}function pst(t,e,n){return e&&fst(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function mst(t,e,n){return e=fI(e),gst(t,mhe()?Reflect.construct(e,n||[],fI(t).constructor):e.apply(t,n))}function gst(t,e){if(e&&(s0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return yst(t)}function yst(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function mhe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(mhe=function(){return!!t})()}function fI(t){return fI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},fI(t)}function vst(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ez(t,e)}function ez(t,e){return ez=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},ez(t,e)}function tz(t,e,n){return e=ghe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ghe(t){var e=xst(t,"string");return s0(e)=="symbol"?e:e+""}function xst(t,e){if(s0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(s0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ZK=1,bst=function(t){function e(){var n;hst(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=mst(this,e,[].concat(i)),tz(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),tz(n,"handleKeyDown",function(a){if(a.key==="Escape"){var o,l,c,u;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(o=(l=n.props.coordinate)===null||l===void 0?void 0:l.x)!==null&&o!==void 0?o:0,y:(c=(u=n.props.coordinate)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0}})}}),n}return vst(e,t),pst(e,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>ZK||Math.abs(r.height-this.state.lastBoundingBox.height)>ZK)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,i;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,i=this.props,s=i.active,a=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,c=i.children,u=i.coordinate,d=i.hasPayload,h=i.isAnimationActive,f=i.offset,p=i.position,g=i.reverseDirection,m=i.useTranslate3d,y=i.viewBox,x=i.wrapperStyle,b=dst({allowEscapeViewBox:a,coordinate:u,offsetTopLeft:f,position:p,reverseDirection:g,tooltipBox:this.state.lastBoundingBox,useTranslate3d:m,viewBox:y}),_=b.cssClasses,T=b.cssProperties,E=YK(YK({transition:h&&s?"transform ".concat(o,"ms ").concat(l):void 0},T),{},{pointerEvents:"none",visibility:!this.state.dismissed&&s&&d?"visible":"hidden",position:"absolute",top:0,left:0},x);return le.createElement("div",{tabIndex:-1,className:_,style:E,ref:function(I){r.wrapperNode=I}},c)}}])}(P.PureComponent),wst=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},yb={isSsr:wst()};function a0(t){"@babel/helpers - typeof";return a0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a0(t)}function QK(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function JK(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?QK(Object(n),!0).forEach(function(r){aH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):QK(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Sst(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _st(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,vhe(r.key),r)}}function Tst(t,e,n){return e&&_st(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Est(t,e,n){return e=pI(e),Cst(t,yhe()?Reflect.construct(e,n||[],pI(t).constructor):e.apply(t,n))}function Cst(t,e){if(e&&(a0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nst(t)}function Nst(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function yhe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yhe=function(){return!!t})()}function pI(t){return pI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},pI(t)}function Ast(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&nz(t,e)}function nz(t,e){return nz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},nz(t,e)}function aH(t,e,n){return e=vhe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vhe(t){var e=Ist(t,"string");return a0(e)=="symbol"?e:e+""}function Ist(t,e){if(a0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(a0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function kst(t){return t.dataKey}function Mst(t,e){return le.isValidElement(t)?le.cloneElement(t,e):typeof t=="function"?le.createElement(t,e):le.createElement(sst,e)}var yu=function(t){function e(){return Sst(this,e),Est(this,e,arguments)}return Ast(e,t),Tst(e,[{key:"render",value:function(){var r=this,i=this.props,s=i.active,a=i.allowEscapeViewBox,o=i.animationDuration,l=i.animationEasing,c=i.content,u=i.coordinate,d=i.filterNull,h=i.isAnimationActive,f=i.offset,p=i.payload,g=i.payloadUniqBy,m=i.position,y=i.reverseDirection,x=i.useTranslate3d,b=i.viewBox,_=i.wrapperStyle,T=p??[];d&&T.length&&(T=ohe(p.filter(function(C){return C.value!=null&&(C.hide!==!0||r.props.includeHidden)}),g,kst));var E=T.length>0;return le.createElement(bst,{allowEscapeViewBox:a,animationDuration:o,animationEasing:l,isAnimationActive:h,active:s,coordinate:u,hasPayload:E,offset:f,position:m,reverseDirection:y,useTranslate3d:x,viewBox:b,wrapperStyle:_},Mst(c,JK(JK({},this.props),{},{payload:T})))}}])}(P.PureComponent);aH(yu,"displayName","Tooltip");aH(yu,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!yb.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var Rst=sd,Pst=function(){return Rst.Date.now()},Ost=Pst,Dst=/\s/;function $st(t){for(var e=t.length;e--&&Dst.test(t.charAt(e)););return e}var Lst=$st,Fst=Lst,jst=/^\s+/;function zst(t){return t&&t.slice(0,Fst(t)+1).replace(jst,"")}var Bst=zst,Ust=Bst,eY=wp,Vst=lb,tY=NaN,Wst=/^[-+]0x[0-9a-f]+$/i,Hst=/^0b[01]+$/i,Gst=/^0o[0-7]+$/i,qst=parseInt;function Xst(t){if(typeof t=="number")return t;if(Vst(t))return tY;if(eY(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=eY(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=Ust(t);var n=Hst.test(t);return n||Gst.test(t)?qst(t.slice(2),n?2:8):Wst.test(t)?tY:+t}var xhe=Xst,Kst=wp,lL=Ost,nY=xhe,Yst="Expected a function",Zst=Math.max,Qst=Math.min;function Jst(t,e,n){var r,i,s,a,o,l,c=0,u=!1,d=!1,h=!0;if(typeof t!="function")throw new TypeError(Yst);e=nY(e)||0,Kst(n)&&(u=!!n.leading,d="maxWait"in n,s=d?Zst(nY(n.maxWait)||0,e):s,h="trailing"in n?!!n.trailing:h);function f(E){var C=r,I=i;return r=i=void 0,c=E,a=t.apply(I,C),a}function p(E){return c=E,o=setTimeout(y,e),u?f(E):a}function g(E){var C=E-l,I=E-c,A=e-C;return d?Qst(A,s-I):A}function m(E){var C=E-l,I=E-c;return l===void 0||C>=e||C<0||d&&I>=s}function y(){var E=lL();if(m(E))return x(E);o=setTimeout(y,g(E))}function x(E){return o=void 0,h&&r?f(E):(r=i=void 0,a)}function b(){o!==void 0&&clearTimeout(o),c=0,r=l=i=o=void 0}function _(){return o===void 0?a:x(lL())}function T(){var E=lL(),C=m(E);if(r=arguments,i=this,l=E,C){if(o===void 0)return p(l);if(d)return clearTimeout(o),o=setTimeout(y,e),f(l)}return o===void 0&&(o=setTimeout(y,e)),a}return T.cancel=b,T.flush=_,T}var eat=Jst,tat=eat,nat=wp,rat="Expected a function";function iat(t,e,n){var r=!0,i=!0;if(typeof t!="function")throw new TypeError(rat);return nat(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),tat(t,e,{leading:r,maxWait:e,trailing:i})}var sat=iat;const bhe=lr(sat);function uS(t){"@babel/helpers - typeof";return uS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},uS(t)}function rY(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function fN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rY(Object(n),!0).forEach(function(r){aat(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rY(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function aat(t,e,n){return e=oat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oat(t){var e=lat(t,"string");return uS(e)=="symbol"?e:e+""}function lat(t,e){if(uS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(uS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function cat(t,e){return fat(t)||hat(t,e)||dat(t,e)||uat()}function uat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dat(t,e){if(t){if(typeof t=="string")return iY(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iY(t,e)}}function iY(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function hat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function fat(t){if(Array.isArray(t))return t}var pat=P.forwardRef(function(t,e){var n=t.aspect,r=t.initialDimension,i=r===void 0?{width:-1,height:-1}:r,s=t.width,a=s===void 0?"100%":s,o=t.height,l=o===void 0?"100%":o,c=t.minWidth,u=c===void 0?0:c,d=t.minHeight,h=t.maxHeight,f=t.children,p=t.debounce,g=p===void 0?0:p,m=t.id,y=t.className,x=t.onResize,b=t.style,_=b===void 0?{}:b,T=P.useRef(null),E=P.useRef();E.current=x,P.useImperativeHandle(e,function(){return Object.defineProperty(T.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),T.current},configurable:!0})});var C=P.useState({containerWidth:i.width,containerHeight:i.height}),I=cat(C,2),A=I[0],k=I[1],R=P.useCallback(function(z,O){k(function(j){var B=Math.round(z),W=Math.round(O);return j.containerWidth===B&&j.containerHeight===W?j:{containerWidth:B,containerHeight:W}})},[]);P.useEffect(function(){var z=function(V){var H,K=V[0].contentRect,te=K.width,J=K.height;R(te,J),(H=E.current)===null||H===void 0||H.call(E,te,J)};g>0&&(z=bhe(z,g,{trailing:!0,leading:!1}));var O=new ResizeObserver(z),j=T.current.getBoundingClientRect(),B=j.width,W=j.height;return R(B,W),O.observe(T.current),function(){O.disconnect()}},[R,g]);var $=P.useMemo(function(){var z=A.containerWidth,O=A.containerHeight;if(z<0||O<0)return null;Gd(Im(a)||Im(l),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,l),Gd(!n||n>0,"The aspect(%s) must be greater than zero.",n);var j=Im(a)?z:a,B=Im(l)?O:l;n&&n>0&&(j?B=j/n:B&&(j=B*n),h&&B>h&&(B=h)),Gd(j>0||B>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,j,B,a,l,u,d,n);var W=!Array.isArray(f)&&Hd(f.type).endsWith("Chart");return le.Children.map(f,function(L){return le.isValidElement(L)?P.cloneElement(L,fN({width:j,height:B},W?{style:fN({height:"100%",width:"100%",maxHeight:B,maxWidth:j},L.props.style)}:{})):L})},[n,f,l,h,d,u,A,a]);return le.createElement("div",{id:m?"".concat(m):void 0,className:qn("recharts-responsive-container",y),style:fN(fN({},_),{},{width:a,height:l,minWidth:u,minHeight:d,maxHeight:h}),ref:T},$)}),whe=function(e){return null};whe.displayName="Cell";function dS(t){"@babel/helpers - typeof";return dS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dS(t)}function sY(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function rz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sY(Object(n),!0).forEach(function(r){mat(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sY(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function mat(t,e,n){return e=gat(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gat(t){var e=yat(t,"string");return dS(e)=="symbol"?e:e+""}function yat(t,e){if(dS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(dS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fy={widthCache:{},cacheCount:0},vat=2e3,xat={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},aY="recharts_measurement_span";function bat(t){var e=rz({},t);return Object.keys(e).forEach(function(n){e[n]||delete e[n]}),e}var d1=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||yb.isSsr)return{width:0,height:0};var r=bat(n),i=JSON.stringify({text:e,copyStyle:r});if(Fy.widthCache[i])return Fy.widthCache[i];try{var s=document.getElementById(aY);s||(s=document.createElement("span"),s.setAttribute("id",aY),s.setAttribute("aria-hidden","true"),document.body.appendChild(s));var a=rz(rz({},xat),r);Object.assign(s.style,a),s.textContent="".concat(e);var o=s.getBoundingClientRect(),l={width:o.width,height:o.height};return Fy.widthCache[i]=l,++Fy.cacheCount>vat&&(Fy.cacheCount=0,Fy.widthCache={}),l}catch{return{width:0,height:0}}},wat=function(e){return{top:e.top+window.scrollY-document.documentElement.clientTop,left:e.left+window.scrollX-document.documentElement.clientLeft}};function hS(t){"@babel/helpers - typeof";return hS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},hS(t)}function mI(t,e){return Eat(t)||Tat(t,e)||_at(t,e)||Sat()}function Sat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _at(t,e){if(t){if(typeof t=="string")return oY(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return oY(t,e)}}function oY(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Tat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Eat(t){if(Array.isArray(t))return t}function Cat(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lY(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Aat(r.key),r)}}function Nat(t,e,n){return e&&lY(t.prototype,e),n&&lY(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Aat(t){var e=Iat(t,"string");return hS(e)=="symbol"?e:e+""}function Iat(t,e){if(hS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(hS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var cY=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,uY=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,kat=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,Mat=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,She={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},Rat=Object.keys(She),Pv="NaN";function Pat(t,e){return t*She[e]}var pN=function(){function t(e,n){Cat(this,t),this.num=e,this.unit=n,this.num=e,this.unit=n,Number.isNaN(e)&&(this.unit=""),n!==""&&!kat.test(n)&&(this.num=NaN,this.unit=""),Rat.includes(n)&&(this.num=Pat(e,n),this.unit="px")}return Nat(t,[{key:"add",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new t(NaN,""):new t(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new t(NaN,""):new t(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,i=(r=Mat.exec(n))!==null&&r!==void 0?r:[],s=mI(i,3),a=s[1],o=s[2];return new t(parseFloat(a),o??"")}}])}();function _he(t){if(t.includes(Pv))return Pv;for(var e=t;e.includes("*")||e.includes("/");){var n,r=(n=cY.exec(e))!==null&&n!==void 0?n:[],i=mI(r,4),s=i[1],a=i[2],o=i[3],l=pN.parse(s??""),c=pN.parse(o??""),u=a==="*"?l.multiply(c):l.divide(c);if(u.isNaN())return Pv;e=e.replace(cY,u.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var d,h=(d=uY.exec(e))!==null&&d!==void 0?d:[],f=mI(h,4),p=f[1],g=f[2],m=f[3],y=pN.parse(p??""),x=pN.parse(m??""),b=g==="+"?y.add(x):y.subtract(x);if(b.isNaN())return Pv;e=e.replace(uY,b.toString())}return e}var dY=/\(([^()]*)\)/;function Oat(t){for(var e=t;e.includes("(");){var n=dY.exec(e),r=mI(n,2),i=r[1];e=e.replace(dY,_he(i))}return e}function Dat(t){var e=t.replace(/\s+/g,"");return e=Oat(e),e=_he(e),e}function $at(t){try{return Dat(t)}catch{return Pv}}function cL(t){var e=$at(t.slice(5,-1));return e===Pv?"":e}var Lat=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],Fat=["dx","dy","angle","className","breakAll"];function iz(){return iz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},iz.apply(this,arguments)}function hY(t,e){if(t==null)return{};var n=jat(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function jat(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function fY(t,e){return Vat(t)||Uat(t,e)||Bat(t,e)||zat()}function zat(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bat(t,e){if(t){if(typeof t=="string")return pY(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pY(t,e)}}function pY(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Uat(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Vat(t){if(Array.isArray(t))return t}var The=/[ \f\n\r\t\v\u2028\u2029]+/,Ehe=function(e){var n=e.children,r=e.breakAll,i=e.style;try{var s=[];Un(n)||(r?s=n.toString().split(""):s=n.toString().split(The));var a=s.map(function(l){return{word:l,width:d1(l,i).width}}),o=r?0:d1(" ",i).width;return{wordsWithComputedWidth:a,spaceWidth:o}}catch{return null}},Wat=function(e,n,r,i,s){var a=e.maxLines,o=e.children,l=e.style,c=e.breakAll,u=tt(a),d=o,h=function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return j.reduce(function(B,W){var L=W.word,V=W.width,H=B[B.length-1];if(H&&(i==null||s||H.width+V+r<Number(i)))H.words.push(L),H.width+=V+r;else{var K={words:[L],width:V};B.push(K)}return B},[])},f=h(n),p=function(j){return j.reduce(function(B,W){return B.width>W.width?B:W})};if(!u)return f;for(var g="…",m=function(j){var B=d.slice(0,j),W=Ehe({breakAll:c,style:l,children:B+g}).wordsWithComputedWidth,L=h(W),V=L.length>a||p(L).width>Number(i);return[V,L]},y=0,x=d.length-1,b=0,_;y<=x&&b<=d.length-1;){var T=Math.floor((y+x)/2),E=T-1,C=m(E),I=fY(C,2),A=I[0],k=I[1],R=m(T),$=fY(R,1),z=$[0];if(!A&&!z&&(y=T+1),A&&z&&(x=T-1),!A&&z){_=k;break}b++}return _||f},mY=function(e){var n=Un(e)?[]:e.toString().split(The);return[{words:n}]},Hat=function(e){var n=e.width,r=e.scaleToFit,i=e.children,s=e.style,a=e.breakAll,o=e.maxLines;if((n||r)&&!yb.isSsr){var l,c,u=Ehe({breakAll:a,children:i,style:s});if(u){var d=u.wordsWithComputedWidth,h=u.spaceWidth;l=d,c=h}else return mY(i);return Wat({breakAll:a,children:i,maxLines:o,style:s},l,c,n,r)}return mY(i)},gY="#808080",gI=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i,a=e.lineHeight,o=a===void 0?"1em":a,l=e.capHeight,c=l===void 0?"0.71em":l,u=e.scaleToFit,d=u===void 0?!1:u,h=e.textAnchor,f=h===void 0?"start":h,p=e.verticalAnchor,g=p===void 0?"end":p,m=e.fill,y=m===void 0?gY:m,x=hY(e,Lat),b=P.useMemo(function(){return Hat({breakAll:x.breakAll,children:x.children,maxLines:x.maxLines,scaleToFit:d,style:x.style,width:x.width})},[x.breakAll,x.children,x.maxLines,d,x.style,x.width]),_=x.dx,T=x.dy,E=x.angle,C=x.className,I=x.breakAll,A=hY(x,Fat);if(!os(r)||!os(s))return null;var k=r+(tt(_)?_:0),R=s+(tt(T)?T:0),$;switch(g){case"start":$=cL("calc(".concat(c,")"));break;case"middle":$=cL("calc(".concat((b.length-1)/2," * -").concat(o," + (").concat(c," / 2))"));break;default:$=cL("calc(".concat(b.length-1," * -").concat(o,")"));break}var z=[];if(d){var O=b[0].width,j=x.width;z.push("scale(".concat((tt(j)?j/O:1)/O,")"))}return E&&z.push("rotate(".concat(E,", ").concat(k,", ").concat(R,")")),z.length&&(A.transform=z.join(" ")),le.createElement("text",iz({},Rn(A,!0),{x:k,y:R,className:qn("recharts-text",C),textAnchor:f,fill:y.includes("url")?gY:y}),b.map(function(B,W){var L=B.words.join(I?"":" ");return le.createElement("tspan",{x:k,dy:W===0?$:o,key:"".concat(L,"-").concat(W)},L)}))};function Mf(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Gat(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function oH(t){let e,n,r;t.length!==2?(e=Mf,n=(o,l)=>Mf(t(o),l),r=(o,l)=>t(o)-l):(e=t===Mf||t===Gat?t:qat,n=t,r=t);function i(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(o[d],l)<0?c=d+1:u=d}while(c<u)}return c}function s(o,l,c=0,u=o.length){if(c<u){if(e(l,l)!==0)return u;do{const d=c+u>>>1;n(o[d],l)<=0?c=d+1:u=d}while(c<u)}return c}function a(o,l,c=0,u=o.length){const d=i(o,l,c,u-1);return d>c&&r(o[d-1],l)>-r(o[d],l)?d-1:d}return{left:i,center:a,right:s}}function qat(){return 0}function Che(t){return t===null?NaN:+t}function*Xat(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const Kat=oH(Mf),nE=Kat.right;oH(Che).center;class yY extends Map{constructor(e,n=Qat){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(vY(this,e))}has(e){return super.has(vY(this,e))}set(e,n){return super.set(Yat(this,e),n)}delete(e){return super.delete(Zat(this,e))}}function vY({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function Yat({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function Zat({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function Qat(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Jat(t=Mf){if(t===Mf)return Nhe;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Nhe(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const eot=Math.sqrt(50),tot=Math.sqrt(10),not=Math.sqrt(2);function yI(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),a=s>=eot?10:s>=tot?5:s>=not?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/a,o=Math.round(t*c),l=Math.round(e*c),o/c<t&&++o,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*a,o=Math.round(t/c),l=Math.round(e/c),o*c<t&&++o,l*c>e&&--l),l<o&&.5<=n&&n<2?yI(t,e,n*2):[o,l,c]}function sz(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,a]=r?yI(e,t,n):yI(t,e,n);if(!(s>=i))return[];const o=s-i+1,l=new Array(o);if(r)if(a<0)for(let c=0;c<o;++c)l[c]=(s-c)/-a;else for(let c=0;c<o;++c)l[c]=(s-c)*a;else if(a<0)for(let c=0;c<o;++c)l[c]=(i+c)/-a;else for(let c=0;c<o;++c)l[c]=(i+c)*a;return l}function az(t,e,n){return e=+e,t=+t,n=+n,yI(t,e,n)[2]}function oz(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?az(e,t,n):az(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function xY(t,e){let n;for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function bY(t,e){let n;for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function Ahe(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?Nhe:Jat(i);r>n;){if(r-n>600){const l=r-n+1,c=e-n+1,u=Math.log(l),d=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*d*(l-d)/l)*(c-l/2<0?-1:1),f=Math.max(n,Math.floor(e-c*d/l+h)),p=Math.min(r,Math.floor(e+(l-c)*d/l+h));Ahe(t,e,f,p,i)}const s=t[e];let a=n,o=r;for(hw(t,n,e),i(t[r],s)>0&&hw(t,n,r);a<o;){for(hw(t,a,o),++a,--o;i(t[a],s)<0;)++a;for(;i(t[o],s)>0;)--o}i(t[n],s)===0?hw(t,n,o):(++o,hw(t,o,r)),o<=e&&(n=o+1),e<=o&&(r=o-1)}return t}function hw(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function rot(t,e,n){if(t=Float64Array.from(Xat(t)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return bY(t);if(e>=1)return xY(t);var r,i=(r-1)*e,s=Math.floor(i),a=xY(Ahe(t,s).subarray(0,s+1)),o=bY(t.subarray(s+1));return a+(o-a)*(i-s)}}function iot(t,e,n=Che){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,s=Math.floor(i),a=+n(t[s],s,t),o=+n(t[s+1],s+1,t);return a+(o-a)*(i-s)}}function sot(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function ec(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function _h(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const lz=Symbol("implicit");function lH(){var t=new yY,e=[],n=[],r=lz;function i(s){let a=t.get(s);if(a===void 0){if(r!==lz)return r;t.set(s,a=e.push(s)-1)}return n[a%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new yY;for(const a of s)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return lH(e,n).unknown(r)},ec.apply(i,arguments),i}function fS(){var t=lH().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,a,o=!1,l=0,c=0,u=.5;delete t.unknown;function d(){var h=e().length,f=i<r,p=f?i:r,g=f?r:i;s=(g-p)/Math.max(1,h-l+c*2),o&&(s=Math.floor(s)),p+=(g-p-s*(h-l))*u,a=s*(1-l),o&&(p=Math.round(p),a=Math.round(a));var m=sot(h).map(function(y){return p+s*y});return n(f?m.reverse():m)}return t.domain=function(h){return arguments.length?(e(h),d()):e()},t.range=function(h){return arguments.length?([r,i]=h,r=+r,i=+i,d()):[r,i]},t.rangeRound=function(h){return[r,i]=h,r=+r,i=+i,o=!0,d()},t.bandwidth=function(){return a},t.step=function(){return s},t.round=function(h){return arguments.length?(o=!!h,d()):o},t.padding=function(h){return arguments.length?(l=Math.min(1,c=+h),d()):l},t.paddingInner=function(h){return arguments.length?(l=Math.min(1,h),d()):l},t.paddingOuter=function(h){return arguments.length?(c=+h,d()):c},t.align=function(h){return arguments.length?(u=Math.max(0,Math.min(1,h)),d()):u},t.copy=function(){return fS(e(),[r,i]).round(o).paddingInner(l).paddingOuter(c).align(u)},ec.apply(d(),arguments)}function Ihe(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Ihe(e())},t}function h1(){return Ihe(fS.apply(null,arguments).paddingInner(1))}function cH(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function khe(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function rE(){}var pS=.7,vI=1/pS,lx="\\s*([+-]?\\d+)\\s*",mS="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",aot=/^#([0-9a-f]{3,8})$/,oot=new RegExp(`^rgb\\(${lx},${lx},${lx}\\)$`),lot=new RegExp(`^rgb\\(${Lu},${Lu},${Lu}\\)$`),cot=new RegExp(`^rgba\\(${lx},${lx},${lx},${mS}\\)$`),uot=new RegExp(`^rgba\\(${Lu},${Lu},${Lu},${mS}\\)$`),dot=new RegExp(`^hsl\\(${mS},${Lu},${Lu}\\)$`),hot=new RegExp(`^hsla\\(${mS},${Lu},${Lu},${mS}\\)$`),wY={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};cH(rE,gS,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:SY,formatHex:SY,formatHex8:fot,formatHsl:pot,formatRgb:_Y,toString:_Y});function SY(){return this.rgb().formatHex()}function fot(){return this.rgb().formatHex8()}function pot(){return Mhe(this).formatHsl()}function _Y(){return this.rgb().formatRgb()}function gS(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=aot.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?TY(e):n===3?new po(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?mN(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?mN(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=oot.exec(t))?new po(e[1],e[2],e[3],1):(e=lot.exec(t))?new po(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=cot.exec(t))?mN(e[1],e[2],e[3],e[4]):(e=uot.exec(t))?mN(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=dot.exec(t))?NY(e[1],e[2]/100,e[3]/100,1):(e=hot.exec(t))?NY(e[1],e[2]/100,e[3]/100,e[4]):wY.hasOwnProperty(t)?TY(wY[t]):t==="transparent"?new po(NaN,NaN,NaN,0):null}function TY(t){return new po(t>>16&255,t>>8&255,t&255,1)}function mN(t,e,n,r){return r<=0&&(t=e=n=NaN),new po(t,e,n,r)}function mot(t){return t instanceof rE||(t=gS(t)),t?(t=t.rgb(),new po(t.r,t.g,t.b,t.opacity)):new po}function cz(t,e,n,r){return arguments.length===1?mot(t):new po(t,e,n,r??1)}function po(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}cH(po,cz,khe(rE,{brighter(t){return t=t==null?vI:Math.pow(vI,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?pS:Math.pow(pS,t),new po(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new po(Ym(this.r),Ym(this.g),Ym(this.b),xI(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:EY,formatHex:EY,formatHex8:got,formatRgb:CY,toString:CY}));function EY(){return`#${km(this.r)}${km(this.g)}${km(this.b)}`}function got(){return`#${km(this.r)}${km(this.g)}${km(this.b)}${km((isNaN(this.opacity)?1:this.opacity)*255)}`}function CY(){const t=xI(this.opacity);return`${t===1?"rgb(":"rgba("}${Ym(this.r)}, ${Ym(this.g)}, ${Ym(this.b)}${t===1?")":`, ${t})`}`}function xI(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ym(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function km(t){return t=Ym(t),(t<16?"0":"")+t.toString(16)}function NY(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Ec(t,e,n,r)}function Mhe(t){if(t instanceof Ec)return new Ec(t.h,t.s,t.l,t.opacity);if(t instanceof rE||(t=gS(t)),!t)return new Ec;if(t instanceof Ec)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),a=NaN,o=s-i,l=(s+i)/2;return o?(e===s?a=(n-r)/o+(n<r)*6:n===s?a=(r-e)/o+2:a=(e-n)/o+4,o/=l<.5?s+i:2-s-i,a*=60):o=l>0&&l<1?0:a,new Ec(a,o,l,t.opacity)}function yot(t,e,n,r){return arguments.length===1?Mhe(t):new Ec(t,e,n,r??1)}function Ec(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}cH(Ec,yot,khe(rE,{brighter(t){return t=t==null?vI:Math.pow(vI,t),new Ec(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?pS:Math.pow(pS,t),new Ec(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new po(uL(t>=240?t-240:t+120,i,r),uL(t,i,r),uL(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Ec(AY(this.h),gN(this.s),gN(this.l),xI(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=xI(this.opacity);return`${t===1?"hsl(":"hsla("}${AY(this.h)}, ${gN(this.s)*100}%, ${gN(this.l)*100}%${t===1?")":`, ${t})`}`}}));function AY(t){return t=(t||0)%360,t<0?t+360:t}function gN(t){return Math.max(0,Math.min(1,t||0))}function uL(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const uH=t=>()=>t;function vot(t,e){return function(n){return t+n*e}}function xot(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function bot(t){return(t=+t)==1?Rhe:function(e,n){return n-e?xot(e,n,t):uH(isNaN(e)?n:e)}}function Rhe(t,e){var n=e-t;return n?vot(t,n):uH(isNaN(t)?e:t)}const IY=function t(e){var n=bot(e);function r(i,s){var a=n((i=cz(i)).r,(s=cz(s)).r),o=n(i.g,s.g),l=n(i.b,s.b),c=Rhe(i.opacity,s.opacity);return function(u){return i.r=a(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=t,r}(1);function wot(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Sot(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function _ot(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),a;for(a=0;a<r;++a)i[a]=vb(t[a],e[a]);for(;a<n;++a)s[a]=e[a];return function(o){for(a=0;a<r;++a)s[a]=i[a](o);return s}}function Tot(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function bI(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Eot(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=vb(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var uz=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dL=new RegExp(uz.source,"g");function Cot(t){return function(){return t}}function Not(t){return function(e){return t(e)+""}}function Aot(t,e){var n=uz.lastIndex=dL.lastIndex=0,r,i,s,a=-1,o=[],l=[];for(t=t+"",e=e+"";(r=uz.exec(t))&&(i=dL.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),o[a]?o[a]+=s:o[++a]=s),(r=r[0])===(i=i[0])?o[a]?o[a]+=i:o[++a]=i:(o[++a]=null,l.push({i:a,x:bI(r,i)})),n=dL.lastIndex;return n<e.length&&(s=e.slice(n),o[a]?o[a]+=s:o[++a]=s),o.length<2?l[0]?Not(l[0].x):Cot(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}function vb(t,e){var n=typeof e,r;return e==null||n==="boolean"?uH(e):(n==="number"?bI:n==="string"?(r=gS(e))?(e=r,IY):Aot:e instanceof gS?IY:e instanceof Date?Tot:Sot(e)?wot:Array.isArray(e)?_ot:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Eot:bI)(t,e)}function dH(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Iot(t,e){e===void 0&&(e=t,t=vb);for(var n=0,r=e.length-1,i=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(i,i=e[++n]);return function(a){var o=Math.max(0,Math.min(r-1,Math.floor(a*=r)));return s[o](a-o)}}function kot(t){return function(){return t}}function wI(t){return+t}var kY=[0,1];function za(t){return t}function dz(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:kot(isNaN(e)?NaN:.5)}function Mot(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function Rot(t,e,n){var r=t[0],i=t[1],s=e[0],a=e[1];return i<r?(r=dz(i,r),s=n(a,s)):(r=dz(r,i),s=n(s,a)),function(o){return s(r(o))}}function Pot(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=dz(t[a],t[a+1]),s[a]=n(e[a],e[a+1]);return function(o){var l=nE(t,o,1,r)-1;return s[l](i[l](o))}}function iE(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function pP(){var t=kY,e=kY,n=vb,r,i,s,a=za,o,l,c;function u(){var h=Math.min(t.length,e.length);return a!==za&&(a=Mot(t[0],t[h-1])),o=h>2?Pot:Rot,l=c=null,d}function d(h){return h==null||isNaN(h=+h)?s:(l||(l=o(t.map(r),e,n)))(r(a(h)))}return d.invert=function(h){return a(i((c||(c=o(e,t.map(r),bI)))(h)))},d.domain=function(h){return arguments.length?(t=Array.from(h,wI),u()):t.slice()},d.range=function(h){return arguments.length?(e=Array.from(h),u()):e.slice()},d.rangeRound=function(h){return e=Array.from(h),n=dH,u()},d.clamp=function(h){return arguments.length?(a=h?!0:za,u()):a!==za},d.interpolate=function(h){return arguments.length?(n=h,u()):n},d.unknown=function(h){return arguments.length?(s=h,d):s},function(h,f){return r=h,i=f,u()}}function hH(){return pP()(za,za)}function Oot(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function SI(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function o0(t){return t=SI(Math.abs(t)),t?t[1]:NaN}function Dot(t,e){return function(n,r){for(var i=n.length,s=[],a=0,o=t[0],l=0;i>0&&o>0&&(l+o+1>r&&(o=Math.max(1,r-l)),s.push(n.substring(i-=o,i+o)),!((l+=o+1)>r));)o=t[a=(a+1)%t.length];return s.reverse().join(e)}}function $ot(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var Lot=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yS(t){if(!(e=Lot.exec(t)))throw new Error("invalid format: "+t);var e;return new fH({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}yS.prototype=fH.prototype;function fH(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}fH.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Fot(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var Phe;function jot(t,e){var n=SI(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(Phe=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return s===a?r:s>a?r+new Array(s-a+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+SI(t,Math.max(0,e+s-1))[0]}function MY(t,e){var n=SI(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const RY={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Oot,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>MY(t*100,e),r:MY,s:jot,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function PY(t){return t}var OY=Array.prototype.map,DY=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function zot(t){var e=t.grouping===void 0||t.thousands===void 0?PY:Dot(OY.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?PY:$ot(OY.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",o=t.minus===void 0?"−":t.minus+"",l=t.nan===void 0?"NaN":t.nan+"";function c(d){d=yS(d);var h=d.fill,f=d.align,p=d.sign,g=d.symbol,m=d.zero,y=d.width,x=d.comma,b=d.precision,_=d.trim,T=d.type;T==="n"?(x=!0,T="g"):RY[T]||(b===void 0&&(b=12),_=!0,T="g"),(m||h==="0"&&f==="=")&&(m=!0,h="0",f="=");var E=g==="$"?n:g==="#"&&/[boxX]/.test(T)?"0"+T.toLowerCase():"",C=g==="$"?r:/[%p]/.test(T)?a:"",I=RY[T],A=/[defgprs%]/.test(T);b=b===void 0?6:/[gprs]/.test(T)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function k(R){var $=E,z=C,O,j,B;if(T==="c")z=I(R)+z,R="";else{R=+R;var W=R<0||1/R<0;if(R=isNaN(R)?l:I(Math.abs(R),b),_&&(R=Fot(R)),W&&+R==0&&p!=="+"&&(W=!1),$=(W?p==="("?p:o:p==="-"||p==="("?"":p)+$,z=(T==="s"?DY[8+Phe/3]:"")+z+(W&&p==="("?")":""),A){for(O=-1,j=R.length;++O<j;)if(B=R.charCodeAt(O),48>B||B>57){z=(B===46?i+R.slice(O+1):R.slice(O))+z,R=R.slice(0,O);break}}}x&&!m&&(R=e(R,1/0));var L=$.length+R.length+z.length,V=L<y?new Array(y-L+1).join(h):"";switch(x&&m&&(R=e(V+R,V.length?y-z.length:1/0),V=""),f){case"<":R=$+R+z+V;break;case"=":R=$+V+R+z;break;case"^":R=V.slice(0,L=V.length>>1)+$+R+z+V.slice(L);break;default:R=V+$+R+z;break}return s(R)}return k.toString=function(){return d+""},k}function u(d,h){var f=c((d=yS(d),d.type="f",d)),p=Math.max(-8,Math.min(8,Math.floor(o0(h)/3)))*3,g=Math.pow(10,-p),m=DY[8+p/3];return function(y){return f(g*y)+m}}return{format:c,formatPrefix:u}}var yN,pH,Ohe;Bot({thousands:",",grouping:[3],currency:["$",""]});function Bot(t){return yN=zot(t),pH=yN.format,Ohe=yN.formatPrefix,yN}function Uot(t){return Math.max(0,-o0(Math.abs(t)))}function Vot(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(o0(e)/3)))*3-o0(Math.abs(t)))}function Wot(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,o0(e)-o0(t))+1}function Dhe(t,e,n,r){var i=oz(t,e,n),s;switch(r=yS(r??",f"),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=Vot(i,a))&&(r.precision=s),Ohe(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=Wot(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=Uot(i))&&(r.precision=s-(r.type==="%")*2);break}}return pH(r)}function _p(t){var e=t.domain;return t.ticks=function(n){var r=e();return sz(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return Dhe(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,a=r[i],o=r[s],l,c,u=10;for(o<a&&(c=a,a=o,o=c,c=i,i=s,s=c);u-- >0;){if(c=az(a,o,n),c===l)return r[i]=a,r[s]=o,e(r);if(c>0)a=Math.floor(a/c)*c,o=Math.ceil(o/c)*c;else if(c<0)a=Math.ceil(a*c)/c,o=Math.floor(o*c)/c;else break;l=c}return t},t}function _I(){var t=hH();return t.copy=function(){return iE(t,_I())},ec.apply(t,arguments),_p(t)}function $he(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,wI),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return $he(t).unknown(e)},t=arguments.length?Array.from(t,wI):[0,1],_p(n)}function Lhe(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],a;return s<i&&(a=n,n=r,r=a,a=i,i=s,s=a),t[n]=e.floor(i),t[r]=e.ceil(s),t}function $Y(t){return Math.log(t)}function LY(t){return Math.exp(t)}function Hot(t){return-Math.log(-t)}function Got(t){return-Math.exp(-t)}function qot(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Xot(t){return t===10?qot:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Kot(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function FY(t){return(e,n)=>-t(-e,n)}function mH(t){const e=t($Y,LY),n=e.domain;let r=10,i,s;function a(){return i=Kot(r),s=Xot(r),n()[0]<0?(i=FY(i),s=FY(s),t(Hot,Got)):t($Y,LY),e}return e.base=function(o){return arguments.length?(r=+o,a()):r},e.domain=function(o){return arguments.length?(n(o),a()):n()},e.ticks=o=>{const l=n();let c=l[0],u=l[l.length-1];const d=u<c;d&&([c,u]=[u,c]);let h=i(c),f=i(u),p,g;const m=o==null?10:+o;let y=[];if(!(r%1)&&f-h<m){if(h=Math.floor(h),f=Math.ceil(f),c>0){for(;h<=f;++h)for(p=1;p<r;++p)if(g=h<0?p/s(-h):p*s(h),!(g<c)){if(g>u)break;y.push(g)}}else for(;h<=f;++h)for(p=r-1;p>=1;--p)if(g=h>0?p/s(-h):p*s(h),!(g<c)){if(g>u)break;y.push(g)}y.length*2<m&&(y=sz(c,u,m))}else y=sz(h,f,Math.min(f-h,m)).map(s);return d?y.reverse():y},e.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=r===10?"s":","),typeof l!="function"&&(!(r%1)&&(l=yS(l)).precision==null&&(l.trim=!0),l=pH(l)),o===1/0)return l;const c=Math.max(1,r*o/e.ticks().length);return u=>{let d=u/s(Math.round(i(u)));return d*r<r-.5&&(d*=r),d<=c?l(u):""}},e.nice=()=>n(Lhe(n(),{floor:o=>s(Math.floor(i(o))),ceil:o=>s(Math.ceil(i(o)))})),e}function Fhe(){const t=mH(pP()).domain([1,10]);return t.copy=()=>iE(t,Fhe()).base(t.base()),ec.apply(t,arguments),t}function jY(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function zY(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function gH(t){var e=1,n=t(jY(e),zY(e));return n.constant=function(r){return arguments.length?t(jY(e=+r),zY(e)):e},_p(n)}function jhe(){var t=gH(pP());return t.copy=function(){return iE(t,jhe()).constant(t.constant())},ec.apply(t,arguments)}function BY(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Yot(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Zot(t){return t<0?-t*t:t*t}function yH(t){var e=t(za,za),n=1;function r(){return n===1?t(za,za):n===.5?t(Yot,Zot):t(BY(n),BY(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},_p(e)}function vH(){var t=yH(pP());return t.copy=function(){return iE(t,vH()).exponent(t.exponent())},ec.apply(t,arguments),t}function Qot(){return vH.apply(null,arguments).exponent(.5)}function UY(t){return Math.sign(t)*t*t}function Jot(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function zhe(){var t=hH(),e=[0,1],n=!1,r;function i(s){var a=Jot(t(s));return isNaN(a)?r:n?Math.round(a):a}return i.invert=function(s){return t.invert(UY(s))},i.domain=function(s){return arguments.length?(t.domain(s),i):t.domain()},i.range=function(s){return arguments.length?(t.range((e=Array.from(s,wI)).map(UY)),i):e.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(n=!!s,i):n},i.clamp=function(s){return arguments.length?(t.clamp(s),i):t.clamp()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return zhe(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},ec.apply(i,arguments),_p(i)}function Bhe(){var t=[],e=[],n=[],r;function i(){var a=0,o=Math.max(1,e.length);for(n=new Array(o-1);++a<o;)n[a-1]=iot(t,a/o);return s}function s(a){return a==null||isNaN(a=+a)?r:e[nE(n,a)]}return s.invertExtent=function(a){var o=e.indexOf(a);return o<0?[NaN,NaN]:[o>0?n[o-1]:t[0],o<n.length?n[o]:t[t.length-1]]},s.domain=function(a){if(!arguments.length)return t.slice();t=[];for(let o of a)o!=null&&!isNaN(o=+o)&&t.push(o);return t.sort(Mf),i()},s.range=function(a){return arguments.length?(e=Array.from(a),i()):e.slice()},s.unknown=function(a){return arguments.length?(r=a,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return Bhe().domain(t).range(e).unknown(r)},ec.apply(s,arguments)}function Uhe(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function a(l){return l!=null&&l<=l?i[nE(r,l,0,n)]:s}function o(){var l=-1;for(r=new Array(n);++l<n;)r[l]=((l+1)*e-(l-n)*t)/(n+1);return a}return a.domain=function(l){return arguments.length?([t,e]=l,t=+t,e=+e,o()):[t,e]},a.range=function(l){return arguments.length?(n=(i=Array.from(l)).length-1,o()):i.slice()},a.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[t,r[0]]:c>=n?[r[n-1],e]:[r[c-1],r[c]]},a.unknown=function(l){return arguments.length&&(s=l),a},a.thresholds=function(){return r.slice()},a.copy=function(){return Uhe().domain([t,e]).range(i).unknown(s)},ec.apply(_p(a),arguments)}function Vhe(){var t=[.5],e=[0,1],n,r=1;function i(s){return s!=null&&s<=s?e[nE(t,s,0,r)]:n}return i.domain=function(s){return arguments.length?(t=Array.from(s),r=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),r=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var a=e.indexOf(s);return[t[a-1],t[a]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Vhe().domain(t).range(e).unknown(n)},ec.apply(i,arguments)}const hL=new Date,fL=new Date;function ps(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const a=i(s),o=i.ceil(s);return s-a<o-s?a:o},i.offset=(s,a)=>(e(s=new Date(+s),a==null?1:Math.floor(a)),s),i.range=(s,a,o)=>{const l=[];if(s=i.ceil(s),o=o==null?1:Math.floor(o),!(s<a)||!(o>0))return l;let c;do l.push(c=new Date(+s)),e(s,o),t(s);while(c<s&&s<a);return l},i.filter=s=>ps(a=>{if(a>=a)for(;t(a),!s(a);)a.setTime(a-1)},(a,o)=>{if(a>=a)if(o<0)for(;++o<=0;)for(;e(a,-1),!s(a););else for(;--o>=0;)for(;e(a,1),!s(a););}),n&&(i.count=(s,a)=>(hL.setTime(+s),fL.setTime(+a),t(hL),t(fL),Math.floor(n(hL,fL))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?a=>r(a)%s===0:a=>i.count(0,a)%s===0):i)),i}const TI=ps(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);TI.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ps(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):TI);TI.range;const Dd=1e3,Ll=Dd*60,$d=Ll*60,ah=$d*24,xH=ah*7,VY=ah*30,pL=ah*365,Mm=ps(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Dd)},(t,e)=>(e-t)/Dd,t=>t.getUTCSeconds());Mm.range;const bH=ps(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dd)},(t,e)=>{t.setTime(+t+e*Ll)},(t,e)=>(e-t)/Ll,t=>t.getMinutes());bH.range;const wH=ps(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ll)},(t,e)=>(e-t)/Ll,t=>t.getUTCMinutes());wH.range;const SH=ps(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dd-t.getMinutes()*Ll)},(t,e)=>{t.setTime(+t+e*$d)},(t,e)=>(e-t)/$d,t=>t.getHours());SH.range;const _H=ps(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*$d)},(t,e)=>(e-t)/$d,t=>t.getUTCHours());_H.range;const sE=ps(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ll)/ah,t=>t.getDate()-1);sE.range;const mP=ps(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ah,t=>t.getUTCDate()-1);mP.range;const Whe=ps(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/ah,t=>Math.floor(t/ah));Whe.range;function iy(t){return ps(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ll)/xH)}const gP=iy(0),EI=iy(1),elt=iy(2),tlt=iy(3),l0=iy(4),nlt=iy(5),rlt=iy(6);gP.range;EI.range;elt.range;tlt.range;l0.range;nlt.range;rlt.range;function sy(t){return ps(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/xH)}const yP=sy(0),CI=sy(1),ilt=sy(2),slt=sy(3),c0=sy(4),alt=sy(5),olt=sy(6);yP.range;CI.range;ilt.range;slt.range;c0.range;alt.range;olt.range;const TH=ps(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());TH.range;const EH=ps(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());EH.range;const oh=ps(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());oh.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ps(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});oh.range;const lh=ps(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());lh.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ps(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});lh.range;function Hhe(t,e,n,r,i,s){const a=[[Mm,1,Dd],[Mm,5,5*Dd],[Mm,15,15*Dd],[Mm,30,30*Dd],[s,1,Ll],[s,5,5*Ll],[s,15,15*Ll],[s,30,30*Ll],[i,1,$d],[i,3,3*$d],[i,6,6*$d],[i,12,12*$d],[r,1,ah],[r,2,2*ah],[n,1,xH],[e,1,VY],[e,3,3*VY],[t,1,pL]];function o(c,u,d){const h=u<c;h&&([c,u]=[u,c]);const f=d&&typeof d.range=="function"?d:l(c,u,d),p=f?f.range(c,+u+1):[];return h?p.reverse():p}function l(c,u,d){const h=Math.abs(u-c)/d,f=oH(([,,m])=>m).right(a,h);if(f===a.length)return t.every(oz(c/pL,u/pL,d));if(f===0)return TI.every(Math.max(oz(c,u,d),1));const[p,g]=a[h/a[f-1][2]<a[f][2]/h?f-1:f];return p.every(g)}return[o,l]}const[llt,clt]=Hhe(lh,EH,yP,Whe,_H,wH),[ult,dlt]=Hhe(oh,TH,gP,sE,SH,bH);function mL(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function gL(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function fw(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function hlt(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,a=t.shortDays,o=t.months,l=t.shortMonths,c=pw(i),u=mw(i),d=pw(s),h=mw(s),f=pw(a),p=mw(a),g=pw(o),m=mw(o),y=pw(l),x=mw(l),b={a:W,A:L,b:V,B:H,c:null,d:KY,e:KY,f:Dlt,g:Hlt,G:qlt,H:Rlt,I:Plt,j:Olt,L:Ghe,m:$lt,M:Llt,p:K,q:te,Q:QY,s:JY,S:Flt,u:jlt,U:zlt,V:Blt,w:Ult,W:Vlt,x:null,X:null,y:Wlt,Y:Glt,Z:Xlt,"%":ZY},_={a:J,A:oe,b:fe,B:Ee,c:null,d:YY,e:YY,f:Qlt,g:lct,G:uct,H:Klt,I:Ylt,j:Zlt,L:Xhe,m:Jlt,M:ect,p:me,q:De,Q:QY,s:JY,S:tct,u:nct,U:rct,V:ict,w:sct,W:act,x:null,X:null,y:oct,Y:cct,Z:dct,"%":ZY},T={a:k,A:R,b:$,B:z,c:O,d:qY,e:qY,f:Alt,g:GY,G:HY,H:XY,I:XY,j:Tlt,L:Nlt,m:_lt,M:Elt,p:A,q:Slt,Q:klt,s:Mlt,S:Clt,u:ylt,U:vlt,V:xlt,w:glt,W:blt,x:j,X:B,y:GY,Y:HY,Z:wlt,"%":Ilt};b.x=E(n,b),b.X=E(r,b),b.c=E(e,b),_.x=E(n,_),_.X=E(r,_),_.c=E(e,_);function E(ge,_e){return function(Ce){var G=[],ke=-1,xe=0,Pe=ge.length,Te,Ye,qe;for(Ce instanceof Date||(Ce=new Date(+Ce));++ke<Pe;)ge.charCodeAt(ke)===37&&(G.push(ge.slice(xe,ke)),(Ye=WY[Te=ge.charAt(++ke)])!=null?Te=ge.charAt(++ke):Ye=Te==="e"?" ":"0",(qe=_e[Te])&&(Te=qe(Ce,Ye)),G.push(Te),xe=ke+1);return G.push(ge.slice(xe,ke)),G.join("")}}function C(ge,_e){return function(Ce){var G=fw(1900,void 0,1),ke=I(G,ge,Ce+="",0),xe,Pe;if(ke!=Ce.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(_e&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(xe=gL(fw(G.y,0,1)),Pe=xe.getUTCDay(),xe=Pe>4||Pe===0?CI.ceil(xe):CI(xe),xe=mP.offset(xe,(G.V-1)*7),G.y=xe.getUTCFullYear(),G.m=xe.getUTCMonth(),G.d=xe.getUTCDate()+(G.w+6)%7):(xe=mL(fw(G.y,0,1)),Pe=xe.getDay(),xe=Pe>4||Pe===0?EI.ceil(xe):EI(xe),xe=sE.offset(xe,(G.V-1)*7),G.y=xe.getFullYear(),G.m=xe.getMonth(),G.d=xe.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),Pe="Z"in G?gL(fw(G.y,0,1)).getUTCDay():mL(fw(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(Pe+5)%7:G.w+G.U*7-(Pe+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,gL(G)):mL(G)}}function I(ge,_e,Ce,G){for(var ke=0,xe=_e.length,Pe=Ce.length,Te,Ye;ke<xe;){if(G>=Pe)return-1;if(Te=_e.charCodeAt(ke++),Te===37){if(Te=_e.charAt(ke++),Ye=T[Te in WY?_e.charAt(ke++):Te],!Ye||(G=Ye(ge,Ce,G))<0)return-1}else if(Te!=Ce.charCodeAt(G++))return-1}return G}function A(ge,_e,Ce){var G=c.exec(_e.slice(Ce));return G?(ge.p=u.get(G[0].toLowerCase()),Ce+G[0].length):-1}function k(ge,_e,Ce){var G=f.exec(_e.slice(Ce));return G?(ge.w=p.get(G[0].toLowerCase()),Ce+G[0].length):-1}function R(ge,_e,Ce){var G=d.exec(_e.slice(Ce));return G?(ge.w=h.get(G[0].toLowerCase()),Ce+G[0].length):-1}function $(ge,_e,Ce){var G=y.exec(_e.slice(Ce));return G?(ge.m=x.get(G[0].toLowerCase()),Ce+G[0].length):-1}function z(ge,_e,Ce){var G=g.exec(_e.slice(Ce));return G?(ge.m=m.get(G[0].toLowerCase()),Ce+G[0].length):-1}function O(ge,_e,Ce){return I(ge,e,_e,Ce)}function j(ge,_e,Ce){return I(ge,n,_e,Ce)}function B(ge,_e,Ce){return I(ge,r,_e,Ce)}function W(ge){return a[ge.getDay()]}function L(ge){return s[ge.getDay()]}function V(ge){return l[ge.getMonth()]}function H(ge){return o[ge.getMonth()]}function K(ge){return i[+(ge.getHours()>=12)]}function te(ge){return 1+~~(ge.getMonth()/3)}function J(ge){return a[ge.getUTCDay()]}function oe(ge){return s[ge.getUTCDay()]}function fe(ge){return l[ge.getUTCMonth()]}function Ee(ge){return o[ge.getUTCMonth()]}function me(ge){return i[+(ge.getUTCHours()>=12)]}function De(ge){return 1+~~(ge.getUTCMonth()/3)}return{format:function(ge){var _e=E(ge+="",b);return _e.toString=function(){return ge},_e},parse:function(ge){var _e=C(ge+="",!1);return _e.toString=function(){return ge},_e},utcFormat:function(ge){var _e=E(ge+="",_);return _e.toString=function(){return ge},_e},utcParse:function(ge){var _e=C(ge+="",!0);return _e.toString=function(){return ge},_e}}}var WY={"-":"",_:" ",0:"0"},Os=/^\s*\d+/,flt=/^%/,plt=/[\\^$*+?|[\]().{}]/g;function nr(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function mlt(t){return t.replace(plt,"\\$&")}function pw(t){return new RegExp("^(?:"+t.map(mlt).join("|")+")","i")}function mw(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function glt(t,e,n){var r=Os.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function ylt(t,e,n){var r=Os.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function vlt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function xlt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function blt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function HY(t,e,n){var r=Os.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function GY(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function wlt(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Slt(t,e,n){var r=Os.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function _lt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function qY(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Tlt(t,e,n){var r=Os.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function XY(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Elt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Clt(t,e,n){var r=Os.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Nlt(t,e,n){var r=Os.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Alt(t,e,n){var r=Os.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Ilt(t,e,n){var r=flt.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function klt(t,e,n){var r=Os.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Mlt(t,e,n){var r=Os.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function KY(t,e){return nr(t.getDate(),e,2)}function Rlt(t,e){return nr(t.getHours(),e,2)}function Plt(t,e){return nr(t.getHours()%12||12,e,2)}function Olt(t,e){return nr(1+sE.count(oh(t),t),e,3)}function Ghe(t,e){return nr(t.getMilliseconds(),e,3)}function Dlt(t,e){return Ghe(t,e)+"000"}function $lt(t,e){return nr(t.getMonth()+1,e,2)}function Llt(t,e){return nr(t.getMinutes(),e,2)}function Flt(t,e){return nr(t.getSeconds(),e,2)}function jlt(t){var e=t.getDay();return e===0?7:e}function zlt(t,e){return nr(gP.count(oh(t)-1,t),e,2)}function qhe(t){var e=t.getDay();return e>=4||e===0?l0(t):l0.ceil(t)}function Blt(t,e){return t=qhe(t),nr(l0.count(oh(t),t)+(oh(t).getDay()===4),e,2)}function Ult(t){return t.getDay()}function Vlt(t,e){return nr(EI.count(oh(t)-1,t),e,2)}function Wlt(t,e){return nr(t.getFullYear()%100,e,2)}function Hlt(t,e){return t=qhe(t),nr(t.getFullYear()%100,e,2)}function Glt(t,e){return nr(t.getFullYear()%1e4,e,4)}function qlt(t,e){var n=t.getDay();return t=n>=4||n===0?l0(t):l0.ceil(t),nr(t.getFullYear()%1e4,e,4)}function Xlt(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+nr(e/60|0,"0",2)+nr(e%60,"0",2)}function YY(t,e){return nr(t.getUTCDate(),e,2)}function Klt(t,e){return nr(t.getUTCHours(),e,2)}function Ylt(t,e){return nr(t.getUTCHours()%12||12,e,2)}function Zlt(t,e){return nr(1+mP.count(lh(t),t),e,3)}function Xhe(t,e){return nr(t.getUTCMilliseconds(),e,3)}function Qlt(t,e){return Xhe(t,e)+"000"}function Jlt(t,e){return nr(t.getUTCMonth()+1,e,2)}function ect(t,e){return nr(t.getUTCMinutes(),e,2)}function tct(t,e){return nr(t.getUTCSeconds(),e,2)}function nct(t){var e=t.getUTCDay();return e===0?7:e}function rct(t,e){return nr(yP.count(lh(t)-1,t),e,2)}function Khe(t){var e=t.getUTCDay();return e>=4||e===0?c0(t):c0.ceil(t)}function ict(t,e){return t=Khe(t),nr(c0.count(lh(t),t)+(lh(t).getUTCDay()===4),e,2)}function sct(t){return t.getUTCDay()}function act(t,e){return nr(CI.count(lh(t)-1,t),e,2)}function oct(t,e){return nr(t.getUTCFullYear()%100,e,2)}function lct(t,e){return t=Khe(t),nr(t.getUTCFullYear()%100,e,2)}function cct(t,e){return nr(t.getUTCFullYear()%1e4,e,4)}function uct(t,e){var n=t.getUTCDay();return t=n>=4||n===0?c0(t):c0.ceil(t),nr(t.getUTCFullYear()%1e4,e,4)}function dct(){return"+0000"}function ZY(){return"%"}function QY(t){return+t}function JY(t){return Math.floor(+t/1e3)}var jy,Yhe,Zhe;hct({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function hct(t){return jy=hlt(t),Yhe=jy.format,jy.parse,Zhe=jy.utcFormat,jy.utcParse,jy}function fct(t){return new Date(t)}function pct(t){return t instanceof Date?+t:+new Date(+t)}function CH(t,e,n,r,i,s,a,o,l,c){var u=hH(),d=u.invert,h=u.domain,f=c(".%L"),p=c(":%S"),g=c("%I:%M"),m=c("%I %p"),y=c("%a %d"),x=c("%b %d"),b=c("%B"),_=c("%Y");function T(E){return(l(E)<E?f:o(E)<E?p:a(E)<E?g:s(E)<E?m:r(E)<E?i(E)<E?y:x:n(E)<E?b:_)(E)}return u.invert=function(E){return new Date(d(E))},u.domain=function(E){return arguments.length?h(Array.from(E,pct)):h().map(fct)},u.ticks=function(E){var C=h();return t(C[0],C[C.length-1],E??10)},u.tickFormat=function(E,C){return C==null?T:c(C)},u.nice=function(E){var C=h();return(!E||typeof E.range!="function")&&(E=e(C[0],C[C.length-1],E??10)),E?h(Lhe(C,E)):u},u.copy=function(){return iE(u,CH(t,e,n,r,i,s,a,o,l,c))},u}function mct(){return ec.apply(CH(ult,dlt,oh,TH,gP,sE,SH,bH,Mm,Yhe).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function gct(){return ec.apply(CH(llt,clt,lh,EH,yP,mP,_H,wH,Mm,Zhe).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function vP(){var t=0,e=1,n,r,i,s,a=za,o=!1,l;function c(d){return d==null||isNaN(d=+d)?l:a(i===0?.5:(d=(s(d)-n)*i,o?Math.max(0,Math.min(1,d)):d))}c.domain=function(d){return arguments.length?([t,e]=d,n=s(t=+t),r=s(e=+e),i=n===r?0:1/(r-n),c):[t,e]},c.clamp=function(d){return arguments.length?(o=!!d,c):o},c.interpolator=function(d){return arguments.length?(a=d,c):a};function u(d){return function(h){var f,p;return arguments.length?([f,p]=h,a=d(f,p),c):[a(0),a(1)]}}return c.range=u(vb),c.rangeRound=u(dH),c.unknown=function(d){return arguments.length?(l=d,c):l},function(d){return s=d,n=d(t),r=d(e),i=n===r?0:1/(r-n),c}}function Tp(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Qhe(){var t=_p(vP()(za));return t.copy=function(){return Tp(t,Qhe())},_h.apply(t,arguments)}function Jhe(){var t=mH(vP()).domain([1,10]);return t.copy=function(){return Tp(t,Jhe()).base(t.base())},_h.apply(t,arguments)}function efe(){var t=gH(vP());return t.copy=function(){return Tp(t,efe()).constant(t.constant())},_h.apply(t,arguments)}function NH(){var t=yH(vP());return t.copy=function(){return Tp(t,NH()).exponent(t.exponent())},_h.apply(t,arguments)}function yct(){return NH.apply(null,arguments).exponent(.5)}function tfe(){var t=[],e=za;function n(r){if(r!=null&&!isNaN(r=+r))return e((nE(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let i of r)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Mf),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,i)=>e(i/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(i,s)=>rot(t,s/r))},n.copy=function(){return tfe(e).domain(t)},_h.apply(n,arguments)}function xP(){var t=0,e=.5,n=1,r=1,i,s,a,o,l,c=za,u,d=!1,h;function f(g){return isNaN(g=+g)?h:(g=.5+((g=+u(g))-s)*(r*g<r*s?o:l),c(d?Math.max(0,Math.min(1,g)):g))}f.domain=function(g){return arguments.length?([t,e,n]=g,i=u(t=+t),s=u(e=+e),a=u(n=+n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,f):[t,e,n]},f.clamp=function(g){return arguments.length?(d=!!g,f):d},f.interpolator=function(g){return arguments.length?(c=g,f):c};function p(g){return function(m){var y,x,b;return arguments.length?([y,x,b]=m,c=Iot(g,[y,x,b]),f):[c(0),c(.5),c(1)]}}return f.range=p(vb),f.rangeRound=p(dH),f.unknown=function(g){return arguments.length?(h=g,f):h},function(g){return u=g,i=g(t),s=g(e),a=g(n),o=i===s?0:.5/(s-i),l=s===a?0:.5/(a-s),r=s<i?-1:1,f}}function nfe(){var t=_p(xP()(za));return t.copy=function(){return Tp(t,nfe())},_h.apply(t,arguments)}function rfe(){var t=mH(xP()).domain([.1,1,10]);return t.copy=function(){return Tp(t,rfe()).base(t.base())},_h.apply(t,arguments)}function ife(){var t=gH(xP());return t.copy=function(){return Tp(t,ife()).constant(t.constant())},_h.apply(t,arguments)}function AH(){var t=yH(xP());return t.copy=function(){return Tp(t,AH()).exponent(t.exponent())},_h.apply(t,arguments)}function vct(){return AH.apply(null,arguments).exponent(.5)}const eZ=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:fS,scaleDiverging:nfe,scaleDivergingLog:rfe,scaleDivergingPow:AH,scaleDivergingSqrt:vct,scaleDivergingSymlog:ife,scaleIdentity:$he,scaleImplicit:lz,scaleLinear:_I,scaleLog:Fhe,scaleOrdinal:lH,scalePoint:h1,scalePow:vH,scaleQuantile:Bhe,scaleQuantize:Uhe,scaleRadial:zhe,scaleSequential:Qhe,scaleSequentialLog:Jhe,scaleSequentialPow:NH,scaleSequentialQuantile:tfe,scaleSequentialSqrt:yct,scaleSequentialSymlog:efe,scaleSqrt:Qot,scaleSymlog:jhe,scaleThreshold:Vhe,scaleTime:mct,scaleUtc:gct,tickFormat:Dhe},Symbol.toStringTag,{value:"Module"}));var xct=lb;function bct(t,e,n){for(var r=-1,i=t.length;++r<i;){var s=t[r],a=e(s);if(a!=null&&(o===void 0?a===a&&!xct(a):n(a,o)))var o=a,l=s}return l}var sfe=bct;function wct(t,e){return t>e}var Sct=wct,_ct=sfe,Tct=Sct,Ect=gb;function Cct(t){return t&&t.length?_ct(t,Ect,Tct):void 0}var Nct=Cct;const vf=lr(Nct);function Act(t,e){return t<e}var Ict=Act,kct=sfe,Mct=Ict,Rct=gb;function Pct(t){return t&&t.length?kct(t,Rct,Mct):void 0}var Oct=Pct;const bP=lr(Oct);var Dct=U5,$ct=Sp,Lct=fhe,Fct=No;function jct(t,e){var n=Fct(t)?Dct:Lct;return n(t,$ct(e))}var zct=jct,Bct=dhe,Uct=zct;function Vct(t,e){return Bct(Uct(t,e),1)}var Wct=Vct;const Hct=lr(Wct);var Gct=rH;function qct(t,e){return Gct(t,e)}var Xct=qct;const vS=lr(Xct);var xb=1e9,Kct={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},kH,Yr=!0,Kl="[DecimalError] ",Zm=Kl+"Invalid argument: ",IH=Kl+"Exponent out of range: ",bb=Math.floor,cm=Math.pow,Yct=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Vo,Ss=1e7,Br=7,afe=9007199254740991,NI=bb(afe/Br),St={};St.absoluteValue=St.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};St.comparedTo=St.cmp=function(t){var e,n,r,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};St.decimalPlaces=St.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Br;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};St.dividedBy=St.div=function(t){return qd(this,new this.constructor(t))};St.dividedToIntegerBy=St.idiv=function(t){var e=this,n=e.constructor;return Ar(qd(e,new n(t),0,1),n.precision)};St.equals=St.eq=function(t){return!this.cmp(t)};St.exponent=function(){return Gi(this)};St.greaterThan=St.gt=function(t){return this.cmp(t)>0};St.greaterThanOrEqualTo=St.gte=function(t){return this.cmp(t)>=0};St.isInteger=St.isint=function(){return this.e>this.d.length-2};St.isNegative=St.isneg=function(){return this.s<0};St.isPositive=St.ispos=function(){return this.s>0};St.isZero=function(){return this.s===0};St.lessThan=St.lt=function(t){return this.cmp(t)<0};St.lessThanOrEqualTo=St.lte=function(t){return this.cmp(t)<1};St.logarithm=St.log=function(t){var e,n=this,r=n.constructor,i=r.precision,s=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(Vo))throw Error(Kl+"NaN");if(n.s<1)throw Error(Kl+(n.s?"NaN":"-Infinity"));return n.eq(Vo)?new r(0):(Yr=!1,e=qd(xS(n,s),xS(t,s),s),Yr=!0,Ar(e,i))};St.minus=St.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?cfe(e,t):ofe(e,(t.s=-t.s,t))};St.modulo=St.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(Kl+"NaN");return n.s?(Yr=!1,e=qd(n,t,0,1).times(t),Yr=!0,n.minus(e)):Ar(new r(n),i)};St.naturalExponential=St.exp=function(){return lfe(this)};St.naturalLogarithm=St.ln=function(){return xS(this)};St.negated=St.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};St.plus=St.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?ofe(e,t):cfe(e,(t.s=-t.s,t))};St.precision=St.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Zm+t);if(e=Gi(i)+1,r=i.d.length-1,n=r*Br+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};St.squareRoot=St.sqrt=function(){var t,e,n,r,i,s,a,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(Kl+"NaN")}for(t=Gi(o),Yr=!1,i=Math.sqrt(+o),i==0||i==1/0?(e=Au(o.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=bb((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new l(e)):r=new l(i.toString()),n=l.precision,i=a=n+3;;)if(s=r,r=s.plus(qd(o,s,a+2)).times(.5),Au(s.d).slice(0,a)===(e=Au(r.d)).slice(0,a)){if(e=e.slice(a-3,a+1),i==a&&e=="4999"){if(Ar(s,n+1,0),s.times(s).eq(o)){r=s;break}}else if(e!="9999")break;a+=4}return Yr=!0,Ar(r,n)};St.times=St.mul=function(t){var e,n,r,i,s,a,o,l,c,u=this,d=u.constructor,h=u.d,f=(t=new d(t)).d;if(!u.s||!t.s)return new d(0);for(t.s*=u.s,n=u.e+t.e,l=h.length,c=f.length,l<c&&(s=h,h=f,f=s,a=l,l=c,c=a),s=[],a=l+c,r=a;r--;)s.push(0);for(r=c;--r>=0;){for(e=0,i=l+r;i>r;)o=s[i]+f[r]*h[i-r-1]+e,s[i--]=o%Ss|0,e=o/Ss|0;s[i]=(s[i]+e)%Ss|0}for(;!s[--a];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,Yr?Ar(t,d.precision):t};St.toDecimalPlaces=St.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(Ku(t,0,xb),e===void 0?e=r.rounding:Ku(e,0,8),Ar(n,t+Gi(n)+1,e))};St.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Mg(r,!0):(Ku(t,0,xb),e===void 0?e=i.rounding:Ku(e,0,8),r=Ar(new i(r),t+1,e),n=Mg(r,!0,t+1)),n};St.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?Mg(i):(Ku(t,0,xb),e===void 0?e=s.rounding:Ku(e,0,8),r=Ar(new s(i),t+Gi(i)+1,e),n=Mg(r.abs(),!1,t+Gi(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};St.toInteger=St.toint=function(){var t=this,e=t.constructor;return Ar(new e(t),Gi(t)+1,e.rounding)};St.toNumber=function(){return+this};St.toPower=St.pow=function(t){var e,n,r,i,s,a,o=this,l=o.constructor,c=12,u=+(t=new l(t));if(!t.s)return new l(Vo);if(o=new l(o),!o.s){if(t.s<1)throw Error(Kl+"Infinity");return o}if(o.eq(Vo))return o;if(r=l.precision,t.eq(Vo))return Ar(o,r);if(e=t.e,n=t.d.length-1,a=e>=n,s=o.s,a){if((n=u<0?-u:u)<=afe){for(i=new l(Vo),e=Math.ceil(r/Br+4),Yr=!1;n%2&&(i=i.times(o),nZ(i.d,e)),n=bb(n/2),n!==0;)o=o.times(o),nZ(o.d,e);return Yr=!0,t.s<0?new l(Vo).div(i):Ar(i,r)}}else if(s<0)throw Error(Kl+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,o.s=1,Yr=!1,i=t.times(xS(o,r+c)),Yr=!0,i=lfe(i),i.s=s,i};St.toPrecision=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?(n=Gi(i),r=Mg(i,n<=s.toExpNeg||n>=s.toExpPos)):(Ku(t,1,xb),e===void 0?e=s.rounding:Ku(e,0,8),i=Ar(new s(i),t,e),n=Gi(i),r=Mg(i,t<=n||n<=s.toExpNeg,t)),r};St.toSignificantDigits=St.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(Ku(t,1,xb),e===void 0?e=r.rounding:Ku(e,0,8)),Ar(new r(n),t,e)};St.toString=St.valueOf=St.val=St.toJSON=St[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=Gi(t),n=t.constructor;return Mg(t,e<=n.toExpNeg||e>=n.toExpPos)};function ofe(t,e){var n,r,i,s,a,o,l,c,u=t.constructor,d=u.precision;if(!t.s||!e.s)return e.s||(e=new u(t)),Yr?Ar(e,d):e;if(l=t.d,c=e.d,a=t.e,i=e.e,l=l.slice(),s=a-i,s){for(s<0?(r=l,s=-s,o=c.length):(r=c,i=a,o=l.length),a=Math.ceil(d/Br),o=a>o?a+1:o+1,s>o&&(s=o,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(o=l.length,s=c.length,o-s<0&&(s=o,r=c,c=l,l=r),n=0;s;)n=(l[--s]=l[s]+c[s]+n)/Ss|0,l[s]%=Ss;for(n&&(l.unshift(n),++i),o=l.length;l[--o]==0;)l.pop();return e.d=l,e.e=i,Yr?Ar(e,d):e}function Ku(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Zm+t)}function Au(t){var e,n,r,i=t.length-1,s="",a=t[0];if(i>0){for(s+=a,e=1;e<i;e++)r=t[e]+"",n=Br-r.length,n&&(s+=Zh(n)),s+=r;a=t[e],r=a+"",n=Br-r.length,n&&(s+=Zh(n))}else if(a===0)return"0";for(;a%10===0;)a/=10;return s+a}var qd=function(){function t(r,i){var s,a=0,o=r.length;for(r=r.slice();o--;)s=r[o]*i+a,r[o]=s%Ss|0,a=s/Ss|0;return a&&r.unshift(a),r}function e(r,i,s,a){var o,l;if(s!=a)l=s>a?1:-1;else for(o=l=0;o<s;o++)if(r[o]!=i[o]){l=r[o]>i[o]?1:-1;break}return l}function n(r,i,s){for(var a=0;s--;)r[s]-=a,a=r[s]<i[s]?1:0,r[s]=a*Ss+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,a){var o,l,c,u,d,h,f,p,g,m,y,x,b,_,T,E,C,I,A=r.constructor,k=r.s==i.s?1:-1,R=r.d,$=i.d;if(!r.s)return new A(r);if(!i.s)throw Error(Kl+"Division by zero");for(l=r.e-i.e,C=$.length,T=R.length,f=new A(k),p=f.d=[],c=0;$[c]==(R[c]||0);)++c;if($[c]>(R[c]||0)&&--l,s==null?x=s=A.precision:a?x=s+(Gi(r)-Gi(i))+1:x=s,x<0)return new A(0);if(x=x/Br+2|0,c=0,C==1)for(u=0,$=$[0],x++;(c<T||u)&&x--;c++)b=u*Ss+(R[c]||0),p[c]=b/$|0,u=b%$|0;else{for(u=Ss/($[0]+1)|0,u>1&&($=t($,u),R=t(R,u),C=$.length,T=R.length),_=C,g=R.slice(0,C),m=g.length;m<C;)g[m++]=0;I=$.slice(),I.unshift(0),E=$[0],$[1]>=Ss/2&&++E;do u=0,o=e($,g,C,m),o<0?(y=g[0],C!=m&&(y=y*Ss+(g[1]||0)),u=y/E|0,u>1?(u>=Ss&&(u=Ss-1),d=t($,u),h=d.length,m=g.length,o=e(d,g,h,m),o==1&&(u--,n(d,C<h?I:$,h))):(u==0&&(o=u=1),d=$.slice()),h=d.length,h<m&&d.unshift(0),n(g,d,m),o==-1&&(m=g.length,o=e($,g,C,m),o<1&&(u++,n(g,C<m?I:$,m))),m=g.length):o===0&&(u++,g=[0]),p[c++]=u,o&&g[0]?g[m++]=R[_]||0:(g=[R[_]],m=1);while((_++<T||g[0]!==void 0)&&x--)}return p[0]||p.shift(),f.e=l,Ar(f,a?s+Gi(f)+1:s)}}();function lfe(t,e){var n,r,i,s,a,o,l=0,c=0,u=t.constructor,d=u.precision;if(Gi(t)>16)throw Error(IH+Gi(t));if(!t.s)return new u(Vo);for(Yr=!1,o=d,a=new u(.03125);t.abs().gte(.1);)t=t.times(a),c+=5;for(r=Math.log(cm(2,c))/Math.LN10*2+5|0,o+=r,n=i=s=new u(Vo),u.precision=o;;){if(i=Ar(i.times(t),o),n=n.times(++l),a=s.plus(qd(i,n,o)),Au(a.d).slice(0,o)===Au(s.d).slice(0,o)){for(;c--;)s=Ar(s.times(s),o);return u.precision=d,e==null?(Yr=!0,Ar(s,d)):s}s=a}}function Gi(t){for(var e=t.e*Br,n=t.d[0];n>=10;n/=10)e++;return e}function yL(t,e,n){if(e>t.LN10.sd())throw Yr=!0,n&&(t.precision=n),Error(Kl+"LN10 precision limit exceeded");return Ar(new t(t.LN10),e)}function Zh(t){for(var e="";t--;)e+="0";return e}function xS(t,e){var n,r,i,s,a,o,l,c,u,d=1,h=10,f=t,p=f.d,g=f.constructor,m=g.precision;if(f.s<1)throw Error(Kl+(f.s?"NaN":"-Infinity"));if(f.eq(Vo))return new g(0);if(e==null?(Yr=!1,c=m):c=e,f.eq(10))return e==null&&(Yr=!0),yL(g,c);if(c+=h,g.precision=c,n=Au(p),r=n.charAt(0),s=Gi(f),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)f=f.times(t),n=Au(f.d),r=n.charAt(0),d++;s=Gi(f),r>1?(f=new g("0."+n),s++):f=new g(r+"."+n.slice(1))}else return l=yL(g,c+2,m).times(s+""),f=xS(new g(r+"."+n.slice(1)),c-h).plus(l),g.precision=m,e==null?(Yr=!0,Ar(f,m)):f;for(o=a=f=qd(f.minus(Vo),f.plus(Vo),c),u=Ar(f.times(f),c),i=3;;){if(a=Ar(a.times(u),c),l=o.plus(qd(a,new g(i),c)),Au(l.d).slice(0,c)===Au(o.d).slice(0,c))return o=o.times(2),s!==0&&(o=o.plus(yL(g,c+2,m).times(s+""))),o=qd(o,new g(d),c),g.precision=m,e==null?(Yr=!0,Ar(o,m)):o;o=l,i+=2}}function tZ(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=bb(n/Br),t.d=[],r=(n+1)%Br,n<0&&(r+=Br),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Br;r<i;)t.d.push(+e.slice(r,r+=Br));e=e.slice(r),r=Br-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),Yr&&(t.e>NI||t.e<-NI))throw Error(IH+n)}else t.s=0,t.e=0,t.d=[0];return t}function Ar(t,e,n){var r,i,s,a,o,l,c,u,d=t.d;for(a=1,s=d[0];s>=10;s/=10)a++;if(r=e-a,r<0)r+=Br,i=e,c=d[u=0];else{if(u=Math.ceil((r+1)/Br),s=d.length,u>=s)return t;for(c=s=d[u],a=1;s>=10;s/=10)a++;r%=Br,i=r-Br+a}if(n!==void 0&&(s=cm(10,a-i-1),o=c/s%10|0,l=e<0||d[u+1]!==void 0||c%s,l=n<4?(o||l)&&(n==0||n==(t.s<0?3:2)):o>5||o==5&&(n==4||l||n==6&&(r>0?i>0?c/cm(10,a-i):0:d[u-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return l?(s=Gi(t),d.length=1,e=e-s-1,d[0]=cm(10,(Br-e%Br)%Br),t.e=bb(-e/Br)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=u,s=1,u--):(d.length=u+1,s=cm(10,Br-r),d[u]=i>0?(c/cm(10,a-i)%cm(10,i)|0)*s:0),l)for(;;)if(u==0){(d[0]+=s)==Ss&&(d[0]=1,++t.e);break}else{if(d[u]+=s,d[u]!=Ss)break;d[u--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(Yr&&(t.e>NI||t.e<-NI))throw Error(IH+Gi(t));return t}function cfe(t,e){var n,r,i,s,a,o,l,c,u,d,h=t.constructor,f=h.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new h(t),Yr?Ar(e,f):e;if(l=t.d,d=e.d,r=e.e,c=t.e,l=l.slice(),a=c-r,a){for(u=a<0,u?(n=l,a=-a,o=d.length):(n=d,r=c,o=l.length),i=Math.max(Math.ceil(f/Br),o)+2,a>i&&(a=i,n.length=1),n.reverse(),i=a;i--;)n.push(0);n.reverse()}else{for(i=l.length,o=d.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=d[i]){u=l[i]<d[i];break}a=0}for(u&&(n=l,l=d,d=n,e.s=-e.s),o=l.length,i=d.length-o;i>0;--i)l[o++]=0;for(i=d.length;i>a;){if(l[--i]<d[i]){for(s=i;s&&l[--s]===0;)l[s]=Ss-1;--l[s],l[i]+=Ss}l[i]-=d[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(e.d=l,e.e=r,Yr?Ar(e,f):e):new h(0)}function Mg(t,e,n){var r,i=Gi(t),s=Au(t.d),a=s.length;return e?(n&&(r=n-a)>0?s=s.charAt(0)+"."+s.slice(1)+Zh(r):a>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Zh(-i-1)+s,n&&(r=n-a)>0&&(s+=Zh(r))):i>=a?(s+=Zh(i+1-a),n&&(r=n-i-1)>0&&(s=s+"."+Zh(r))):((r=i+1)<a&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-a)>0&&(i+1===a&&(s+="."),s+=Zh(r))),t.s<0?"-"+s:s}function nZ(t,e){if(t.length>e)return t.length=e,!0}function ufe(t){var e,n,r;function i(s){var a=this;if(!(a instanceof i))return new i(s);if(a.constructor=i,s instanceof i){a.s=s.s,a.e=s.e,a.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Zm+s);if(s>0)a.s=1;else if(s<0)s=-s,a.s=-1;else{a.s=0,a.e=0,a.d=[0];return}if(s===~~s&&s<1e7){a.e=0,a.d=[s];return}return tZ(a,s.toString())}else if(typeof s!="string")throw Error(Zm+s);if(s.charCodeAt(0)===45?(s=s.slice(1),a.s=-1):a.s=1,Yct.test(s))tZ(a,s);else throw Error(Zm+s)}if(i.prototype=St,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=ufe,i.config=i.set=Zct,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function Zct(t){if(!t||typeof t!="object")throw Error(Kl+"Object expected");var e,n,r,i=["precision",1,xb,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(bb(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(Zm+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Zm+n+": "+r);return this}var kH=ufe(Kct);Vo=new kH(1);const wr=kH;function Qct(t){return nut(t)||tut(t)||eut(t)||Jct()}function Jct(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function eut(t,e){if(t){if(typeof t=="string")return hz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hz(t,e)}}function tut(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function nut(t){if(Array.isArray(t))return hz(t)}function hz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var rut=function(e){return e},dfe={},hfe=function(e){return e===dfe},rZ=function(e){return function n(){return arguments.length===0||arguments.length===1&&hfe(arguments.length<=0?void 0:arguments[0])?n:e.apply(void 0,arguments)}},iut=function t(e,n){return e===1?n:rZ(function(){for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];var a=i.filter(function(o){return o!==dfe}).length;return a>=e?n.apply(void 0,i):t(e-a,rZ(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var u=i.map(function(d){return hfe(d)?l.shift():d});return n.apply(void 0,Qct(u).concat(l))}))})},wP=function(e){return iut(e.length,e)},fz=function(e,n){for(var r=[],i=e;i<n;++i)r[i-e]=i;return r},sut=wP(function(t,e){return Array.isArray(e)?e.map(t):Object.keys(e).map(function(n){return e[n]}).map(t)}),aut=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if(!n.length)return rut;var i=n.reverse(),s=i[0],a=i.slice(1);return function(){return a.reduce(function(o,l){return l(o)},s.apply(void 0,arguments))}},pz=function(e){return Array.isArray(e)?e.reverse():e.split("").reverse.join("")},ffe=function(e){var n=null,r=null;return function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];return n&&s.every(function(o,l){return o===n[l]})||(n=s,r=e.apply(void 0,s)),r}};function out(t){var e;return t===0?e=1:e=Math.floor(new wr(t).abs().log(10).toNumber())+1,e}function lut(t,e,n){for(var r=new wr(t),i=0,s=[];r.lt(e)&&i<1e5;)s.push(r.toNumber()),r=r.add(n),i++;return s}var cut=wP(function(t,e,n){var r=+t,i=+e;return r+n*(i-r)}),uut=wP(function(t,e,n){var r=e-+t;return r=r||1/0,(n-t)/r}),dut=wP(function(t,e,n){var r=e-+t;return r=r||1/0,Math.max(0,Math.min(1,(n-t)/r))});const SP={rangeStep:lut,getDigitCount:out,interpolateNumber:cut,uninterpolateNumber:uut,uninterpolateTruncation:dut};function mz(t){return put(t)||fut(t)||pfe(t)||hut()}function hut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function fut(t){if(typeof Symbol<"u"&&Symbol.iterator in Object(t))return Array.from(t)}function put(t){if(Array.isArray(t))return gz(t)}function bS(t,e){return yut(t)||gut(t,e)||pfe(t,e)||mut()}function mut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pfe(t,e){if(t){if(typeof t=="string")return gz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gz(t,e)}}function gz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function gut(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],r=!0,i=!1,s=void 0;try{for(var a=t[Symbol.iterator](),o;!(r=(o=a.next()).done)&&(n.push(o.value),!(e&&n.length===e));r=!0);}catch(l){i=!0,s=l}finally{try{!r&&a.return!=null&&a.return()}finally{if(i)throw s}}return n}}function yut(t){if(Array.isArray(t))return t}function mfe(t){var e=bS(t,2),n=e[0],r=e[1],i=n,s=r;return n>r&&(i=r,s=n),[i,s]}function gfe(t,e,n){if(t.lte(0))return new wr(0);var r=SP.getDigitCount(t.toNumber()),i=new wr(10).pow(r),s=t.div(i),a=r!==1?.05:.1,o=new wr(Math.ceil(s.div(a).toNumber())).add(n).mul(a),l=o.mul(i);return e?l:new wr(Math.ceil(l))}function vut(t,e,n){var r=1,i=new wr(t);if(!i.isint()&&n){var s=Math.abs(t);s<1?(r=new wr(10).pow(SP.getDigitCount(t)-1),i=new wr(Math.floor(i.div(r).toNumber())).mul(r)):s>1&&(i=new wr(Math.floor(t)))}else t===0?i=new wr(Math.floor((e-1)/2)):n||(i=new wr(Math.floor(t)));var a=Math.floor((e-1)/2),o=aut(sut(function(l){return i.add(new wr(l-a).mul(r)).toNumber()}),fz);return o(0,e)}function yfe(t,e,n,r){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((e-t)/(n-1)))return{step:new wr(0),tickMin:new wr(0),tickMax:new wr(0)};var s=gfe(new wr(e).sub(t).div(n-1),r,i),a;t<=0&&e>=0?a=new wr(0):(a=new wr(t).add(e).div(2),a=a.sub(new wr(a).mod(s)));var o=Math.ceil(a.sub(t).div(s).toNumber()),l=Math.ceil(new wr(e).sub(a).div(s).toNumber()),c=o+l+1;return c>n?yfe(t,e,n,r,i+1):(c<n&&(l=e>0?l+(n-c):l,o=e>0?o:o+(n-c)),{step:s,tickMin:a.sub(new wr(o).mul(s)),tickMax:a.add(new wr(l).mul(s))})}function xut(t){var e=bS(t,2),n=e[0],r=e[1],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(i,2),o=mfe([n,r]),l=bS(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0){var d=u===1/0?[c].concat(mz(fz(0,i-1).map(function(){return 1/0}))):[].concat(mz(fz(0,i-1).map(function(){return-1/0})),[u]);return n>r?pz(d):d}if(c===u)return vut(c,i,s);var h=yfe(c,u,a,s),f=h.step,p=h.tickMin,g=h.tickMax,m=SP.rangeStep(p,g.add(new wr(.1).mul(f)),f);return n>r?pz(m):m}function but(t,e){var n=bS(t,2),r=n[0],i=n[1],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=mfe([r,i]),o=bS(a,2),l=o[0],c=o[1];if(l===-1/0||c===1/0)return[r,i];if(l===c)return[l];var u=Math.max(e,2),d=gfe(new wr(c).sub(l).div(u-1),s,0),h=[].concat(mz(SP.rangeStep(new wr(l),new wr(c).sub(new wr(.99).mul(d)),d)),[c]);return r>i?pz(h):h}var wut=ffe(xut),Sut=ffe(but),_ut="Invariant failed";function Rg(t,e){throw new Error(_ut)}var Tut=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function u0(t){"@babel/helpers - typeof";return u0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u0(t)}function AI(){return AI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},AI.apply(this,arguments)}function Eut(t,e){return Iut(t)||Aut(t,e)||Nut(t,e)||Cut()}function Cut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nut(t,e){if(t){if(typeof t=="string")return iZ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iZ(t,e)}}function iZ(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Aut(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Iut(t){if(Array.isArray(t))return t}function kut(t,e){if(t==null)return{};var n=Mut(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Mut(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Rut(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Put(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bfe(r.key),r)}}function Out(t,e,n){return e&&Put(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dut(t,e,n){return e=II(e),$ut(t,vfe()?Reflect.construct(e,n||[],II(t).constructor):e.apply(t,n))}function $ut(t,e){if(e&&(u0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lut(t)}function Lut(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function vfe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(vfe=function(){return!!t})()}function II(t){return II=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},II(t)}function Fut(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&yz(t,e)}function yz(t,e){return yz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},yz(t,e)}function xfe(t,e,n){return e=bfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bfe(t){var e=jut(t,"string");return u0(e)=="symbol"?e:e+""}function jut(t,e){if(u0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(u0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var _P=function(t){function e(){return Rut(this,e),Dut(this,e,arguments)}return Fut(e,t),Out(e,[{key:"render",value:function(){var r=this.props,i=r.offset,s=r.layout,a=r.width,o=r.dataKey,l=r.data,c=r.dataPointFormatter,u=r.xAxis,d=r.yAxis,h=kut(r,Tut),f=Rn(h,!1);this.props.direction==="x"&&u.type!=="number"&&Rg();var p=l.map(function(g){var m=c(g,o),y=m.x,x=m.y,b=m.value,_=m.errorVal;if(!_)return null;var T=[],E,C;if(Array.isArray(_)){var I=Eut(_,2);E=I[0],C=I[1]}else E=C=_;if(s==="vertical"){var A=u.scale,k=x+i,R=k+a,$=k-a,z=A(b-E),O=A(b+C);T.push({x1:O,y1:R,x2:O,y2:$}),T.push({x1:z,y1:k,x2:O,y2:k}),T.push({x1:z,y1:R,x2:z,y2:$})}else if(s==="horizontal"){var j=d.scale,B=y+i,W=B-a,L=B+a,V=j(b-E),H=j(b+C);T.push({x1:W,y1:H,x2:L,y2:H}),T.push({x1:B,y1:V,x2:B,y2:H}),T.push({x1:W,y1:V,x2:L,y2:V})}return le.createElement(si,AI({className:"recharts-errorBar",key:"bar-".concat(T.map(function(K){return"".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))},f),T.map(function(K){return le.createElement("line",AI({},K,{key:"line-".concat(K.x1,"-").concat(K.x2,"-").concat(K.y1,"-").concat(K.y2)}))}))});return le.createElement(si,{className:"recharts-errorBars"},p)}}])}(le.Component);xfe(_P,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});xfe(_P,"displayName","ErrorBar");function wS(t){"@babel/helpers - typeof";return wS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wS(t)}function sZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Gp(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sZ(Object(n),!0).forEach(function(r){zut(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function zut(t,e,n){return e=But(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function But(t){var e=Uut(t,"string");return wS(e)=="symbol"?e:e+""}function Uut(t,e){if(wS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(wS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wfe=function(e){var n=e.children,r=e.formattedGraphicalItems,i=e.legendWidth,s=e.legendContent,a=jo(n,ox);if(!a)return null;var o=ox.defaultProps,l=o!==void 0?Gp(Gp({},o),a.props):{},c;return a.props&&a.props.payload?c=a.props&&a.props.payload:s==="children"?c=(r||[]).reduce(function(u,d){var h=d.item,f=d.props,p=f.sectors||f.data||[];return u.concat(p.map(function(g){return{type:a.props.iconType||h.props.legendType,value:g.name,color:g.fill,payload:g}}))},[]):c=(r||[]).map(function(u){var d=u.item,h=d.type.defaultProps,f=h!==void 0?Gp(Gp({},h),d.props):{},p=f.dataKey,g=f.name,m=f.legendType,y=f.hide;return{inactive:y,dataKey:p,type:l.iconType||m||"square",color:MH(d),value:g||p,payload:f}}),Gp(Gp(Gp({},l),ox.getWithHeight(a,i)),{},{payload:c,item:a})};function SS(t){"@babel/helpers - typeof";return SS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},SS(t)}function aZ(t){return Gut(t)||Hut(t)||Wut(t)||Vut()}function Vut(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Wut(t,e){if(t){if(typeof t=="string")return vz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vz(t,e)}}function Hut(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Gut(t){if(Array.isArray(t))return vz(t)}function vz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function oZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function yi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oZ(Object(n),!0).forEach(function(r){cx(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function cx(t,e,n){return e=qut(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qut(t){var e=Xut(t,"string");return SS(e)=="symbol"?e:e+""}function Xut(t,e){if(SS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(SS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nl(t,e,n){return Un(t)||Un(e)?n:os(e)?Vl(t,e,n):wn(e)?e(t):n}function f1(t,e,n,r){var i=Hct(t,function(o){return nl(o,e)});if(n==="number"){var s=i.filter(function(o){return tt(o)||parseFloat(o)});return s.length?[bP(s),vf(s)]:[1/0,-1/0]}var a=r?i.filter(function(o){return!Un(o)}):i;return a.map(function(o){return os(o)||o instanceof Date?o:""})}var Kut=function(e){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,a=-1,o=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(o<=1)return 0;if(s&&s.axisType==="angleAxis"&&Math.abs(Math.abs(s.range[1]-s.range[0])-360)<=1e-6)for(var l=s.range,c=0;c<o;c++){var u=c>0?i[c-1].coordinate:i[o-1].coordinate,d=i[c].coordinate,h=c>=o-1?i[0].coordinate:i[c+1].coordinate,f=void 0;if(Mc(d-u)!==Mc(h-d)){var p=[];if(Mc(h-d)===Mc(l[1]-l[0])){f=h;var g=d+l[1]-l[0];p[0]=Math.min(g,(g+u)/2),p[1]=Math.max(g,(g+u)/2)}else{f=u;var m=h+l[1]-l[0];p[0]=Math.min(d,(m+d)/2),p[1]=Math.max(d,(m+d)/2)}var y=[Math.min(d,(f+d)/2),Math.max(d,(f+d)/2)];if(e>y[0]&&e<=y[1]||e>=p[0]&&e<=p[1]){a=i[c].index;break}}else{var x=Math.min(u,h),b=Math.max(u,h);if(e>(x+d)/2&&e<=(b+d)/2){a=i[c].index;break}}}else for(var _=0;_<o;_++)if(_===0&&e<=(r[_].coordinate+r[_+1].coordinate)/2||_>0&&_<o-1&&e>(r[_].coordinate+r[_-1].coordinate)/2&&e<=(r[_].coordinate+r[_+1].coordinate)/2||_===o-1&&e>(r[_].coordinate+r[_-1].coordinate)/2){a=r[_].index;break}return a},MH=function(e){var n,r=e,i=r.type.displayName,s=(n=e.type)!==null&&n!==void 0&&n.defaultProps?yi(yi({},e.type.defaultProps),e.props):e.props,a=s.stroke,o=s.fill,l;switch(i){case"Line":l=a;break;case"Area":case"Radar":l=a&&a!=="none"?a:o;break;default:l=o;break}return l},Yut=function(e){var n=e.barSize,r=e.totalSize,i=e.stackGroups,s=i===void 0?{}:i;if(!s)return{};for(var a={},o=Object.keys(s),l=0,c=o.length;l<c;l++)for(var u=s[o[l]].stackGroups,d=Object.keys(u),h=0,f=d.length;h<f;h++){var p=u[d[h]],g=p.items,m=p.cateAxisId,y=g.filter(function(C){return Hd(C.type).indexOf("Bar")>=0});if(y&&y.length){var x=y[0].type.defaultProps,b=x!==void 0?yi(yi({},x),y[0].props):y[0].props,_=b.barSize,T=b[m];a[T]||(a[T]=[]);var E=Un(_)?n:_;a[T].push({item:y[0],stackList:y.slice(1),barSize:Un(E)?void 0:kg(E,r,0)})}}return a},Zut=function(e){var n=e.barGap,r=e.barCategoryGap,i=e.bandSize,s=e.sizeList,a=s===void 0?[]:s,o=e.maxBarSize,l=a.length;if(l<1)return null;var c=kg(n,i,0,!0),u,d=[];if(a[0].barSize===+a[0].barSize){var h=!1,f=i/l,p=a.reduce(function(_,T){return _+T.barSize||0},0);p+=(l-1)*c,p>=i&&(p-=(l-1)*c,c=0),p>=i&&f>0&&(h=!0,f*=.9,p=l*f);var g=(i-p)/2>>0,m={offset:g-c,size:0};u=a.reduce(function(_,T){var E={item:T.item,position:{offset:m.offset+m.size+c,size:h?f:T.barSize}},C=[].concat(aZ(_),[E]);return m=C[C.length-1].position,T.stackList&&T.stackList.length&&T.stackList.forEach(function(I){C.push({item:I,position:m})}),C},d)}else{var y=kg(r,i,0,!0);i-2*y-(l-1)*c<=0&&(c=0);var x=(i-2*y-(l-1)*c)/l;x>1&&(x>>=0);var b=o===+o?Math.min(x,o):x;u=a.reduce(function(_,T,E){var C=[].concat(aZ(_),[{item:T.item,position:{offset:y+(x+c)*E+(x-b)/2,size:b}}]);return T.stackList&&T.stackList.length&&T.stackList.forEach(function(I){C.push({item:I,position:C[C.length-1].position})}),C},d)}return u},Qut=function(e,n,r,i){var s=r.children,a=r.width,o=r.margin,l=a-(o.left||0)-(o.right||0),c=wfe({children:s,legendWidth:l});if(c){var u=i||{},d=u.width,h=u.height,f=c.align,p=c.verticalAlign,g=c.layout;if((g==="vertical"||g==="horizontal"&&p==="middle")&&f!=="center"&&tt(e[f]))return yi(yi({},e),{},cx({},f,e[f]+(d||0)));if((g==="horizontal"||g==="vertical"&&f==="center")&&p!=="middle"&&tt(e[p]))return yi(yi({},e),{},cx({},p,e[p]+(h||0)))}return e},Jut=function(e,n,r){return Un(n)?!0:e==="horizontal"?n==="yAxis":e==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},Sfe=function(e,n,r,i,s){var a=n.props.children,o=jc(a,_P).filter(function(c){return Jut(i,s,c.props.direction)});if(o&&o.length){var l=o.map(function(c){return c.props.dataKey});return e.reduce(function(c,u){var d=nl(u,r);if(Un(d))return c;var h=Array.isArray(d)?[bP(d),vf(d)]:[d,d],f=l.reduce(function(p,g){var m=nl(u,g,0),y=h[0]-Math.abs(Array.isArray(m)?m[0]:m),x=h[1]+Math.abs(Array.isArray(m)?m[1]:m);return[Math.min(y,p[0]),Math.max(x,p[1])]},[1/0,-1/0]);return[Math.min(f[0],c[0]),Math.max(f[1],c[1])]},[1/0,-1/0])}return null},edt=function(e,n,r,i,s){var a=n.map(function(o){return Sfe(e,o,r,s,i)}).filter(function(o){return!Un(o)});return a&&a.length?a.reduce(function(o,l){return[Math.min(o[0],l[0]),Math.max(o[1],l[1])]},[1/0,-1/0]):null},_fe=function(e,n,r,i,s){var a=n.map(function(l){var c=l.props.dataKey;return r==="number"&&c&&Sfe(e,l,c,i)||f1(e,c,r,s)});if(r==="number")return a.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]);var o={};return a.reduce(function(l,c){for(var u=0,d=c.length;u<d;u++)o[c[u]]||(o[c[u]]=!0,l.push(c[u]));return l},[])},Tfe=function(e,n){return e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis"},Efe=function(e,n,r,i){if(i)return e.map(function(l){return l.coordinate});var s,a,o=e.map(function(l){return l.coordinate===n&&(s=!0),l.coordinate===r&&(a=!0),l.coordinate});return s||o.push(n),a||o.push(r),o},Ld=function(e,n,r){if(!e)return null;var i=e.scale,s=e.duplicateDomain,a=e.type,o=e.range,l=e.realScaleType==="scaleBand"?i.bandwidth()/2:2,c=(n||r)&&a==="category"&&i.bandwidth?i.bandwidth()/l:0;if(c=e.axisType==="angleAxis"&&(o==null?void 0:o.length)>=2?Mc(o[0]-o[1])*2*c:c,n&&(e.ticks||e.niceTicks)){var u=(e.ticks||e.niceTicks).map(function(d){var h=s?s.indexOf(d):d;return{coordinate:i(h)+c,value:d,offset:c}});return u.filter(function(d){return!fb(d.coordinate)})}return e.isCategorical&&e.categoricalDomain?e.categoricalDomain.map(function(d,h){return{coordinate:i(d)+c,value:d,index:h,offset:c}}):i.ticks&&!r?i.ticks(e.tickCount).map(function(d){return{coordinate:i(d)+c,value:d,offset:c}}):i.domain().map(function(d,h){return{coordinate:i(d)+c,value:s?s[d]:d,index:h,offset:c}})},vL=new WeakMap,vN=function(e,n){if(typeof n!="function")return e;vL.has(e)||vL.set(e,new WeakMap);var r=vL.get(e);if(r.has(n))return r.get(n);var i=function(){e.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,i),i},tdt=function(e,n,r){var i=e.scale,s=e.type,a=e.layout,o=e.axisType;if(i==="auto")return a==="radial"&&o==="radiusAxis"?{scale:fS(),realScaleType:"band"}:a==="radial"&&o==="angleAxis"?{scale:_I(),realScaleType:"linear"}:s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:h1(),realScaleType:"point"}:s==="category"?{scale:fS(),realScaleType:"band"}:{scale:_I(),realScaleType:"linear"};if(Ig(i)){var l="scale".concat(oP(i));return{scale:(eZ[l]||h1)(),realScaleType:eZ[l]?l:"point"}}return wn(i)?{scale:i}:{scale:h1(),realScaleType:"point"}},lZ=1e-4,ndt=function(e){var n=e.domain();if(!(!n||n.length<=2)){var r=n.length,i=e.range(),s=Math.min(i[0],i[1])-lZ,a=Math.max(i[0],i[1])+lZ,o=e(n[0]),l=e(n[r-1]);(o<s||o>a||l<s||l>a)&&e.domain([n[0],n[r-1]])}},rdt=function(e,n){if(!e)return null;for(var r=0,i=e.length;r<i;r++)if(e[r].item===n)return e[r].position;return null},idt=function(e,n){if(!n||n.length!==2||!tt(n[0])||!tt(n[1]))return e;var r=Math.min(n[0],n[1]),i=Math.max(n[0],n[1]),s=[e[0],e[1]];return(!tt(e[0])||e[0]<r)&&(s[0]=r),(!tt(e[1])||e[1]>i)&&(s[1]=i),s[0]>i&&(s[0]=i),s[1]<r&&(s[1]=r),s},sdt=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var s=0,a=0,o=0;o<n;++o){var l=fb(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=s,e[o][r][1]=s+l,s=e[o][r][1]):(e[o][r][0]=a,e[o][r][1]=a+l,a=e[o][r][1])}},adt=function(e){var n=e.length;if(!(n<=0))for(var r=0,i=e[0].length;r<i;++r)for(var s=0,a=0;a<n;++a){var o=fb(e[a][r][1])?e[a][r][0]:e[a][r][1];o>=0?(e[a][r][0]=s,e[a][r][1]=s+o,s=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},odt={sign:sdt,expand:xZe,none:n0,silhouette:bZe,wiggle:wZe,positive:adt},ldt=function(e,n,r){var i=n.map(function(o){return o.props.dataKey}),s=odt[r],a=vZe().keys(i).value(function(o,l){return+nl(o,l,0)}).order(Vj).offset(s);return a(e)},cdt=function(e,n,r,i,s,a){if(!e)return null;var o=a?n.reverse():n,l={},c=o.reduce(function(d,h){var f,p=(f=h.type)!==null&&f!==void 0&&f.defaultProps?yi(yi({},h.type.defaultProps),h.props):h.props,g=p.stackId,m=p.hide;if(m)return d;var y=p[r],x=d[y]||{hasStack:!1,stackGroups:{}};if(os(g)){var b=x.stackGroups[g]||{numericAxisId:r,cateAxisId:i,items:[]};b.items.push(h),x.hasStack=!0,x.stackGroups[g]=b}else x.stackGroups[eE("_stackId_")]={numericAxisId:r,cateAxisId:i,items:[h]};return yi(yi({},d),{},cx({},y,x))},l),u={};return Object.keys(c).reduce(function(d,h){var f=c[h];if(f.hasStack){var p={};f.stackGroups=Object.keys(f.stackGroups).reduce(function(g,m){var y=f.stackGroups[m];return yi(yi({},g),{},cx({},m,{numericAxisId:r,cateAxisId:i,items:y.items,stackedData:ldt(e,y.items,s)}))},p)}return yi(yi({},d),{},cx({},h,f))},u)},udt=function(e,n){var r=n.realScaleType,i=n.type,s=n.tickCount,a=n.originalDomain,o=n.allowDecimals,l=r||n.scale;if(l!=="auto"&&l!=="linear")return null;if(s&&i==="number"&&a&&(a[0]==="auto"||a[1]==="auto")){var c=e.domain();if(!c.length)return null;var u=wut(c,s,o);return e.domain([bP(u),vf(u)]),{niceTicks:u}}if(s&&i==="number"){var d=e.domain(),h=Sut(d,s,o);return{niceTicks:h}}return null};function cZ(t){var e=t.axis,n=t.ticks,r=t.bandSize,i=t.entry,s=t.index,a=t.dataKey;if(e.type==="category"){if(!e.allowDuplicatedCategory&&e.dataKey&&!Un(i[e.dataKey])){var o=eI(n,"value",i[e.dataKey]);if(o)return o.coordinate+r/2}return n[s]?n[s].coordinate+r/2:null}var l=nl(i,Un(a)?e.dataKey:a);return Un(l)?null:e.scale(l)}var uZ=function(e){var n=e.axis,r=e.ticks,i=e.offset,s=e.bandSize,a=e.entry,o=e.index;if(n.type==="category")return r[o]?r[o].coordinate+i:null;var l=nl(a,n.dataKey,n.domain[o]);return Un(l)?null:n.scale(l)-s/2+i},ddt=function(e){var n=e.numericAxis,r=n.scale.domain();if(n.type==="number"){var i=Math.min(r[0],r[1]),s=Math.max(r[0],r[1]);return i<=0&&s>=0?0:s<0?s:i}return r[0]},hdt=function(e,n){var r,i=(r=e.type)!==null&&r!==void 0&&r.defaultProps?yi(yi({},e.type.defaultProps),e.props):e.props,s=i.stackId;if(os(s)){var a=n[s];if(a){var o=a.items.indexOf(e);return o>=0?a.stackedData[o]:null}}return null},fdt=function(e){return e.reduce(function(n,r){return[bP(r.concat([n[0]]).filter(tt)),vf(r.concat([n[1]]).filter(tt))]},[1/0,-1/0])},Cfe=function(e,n,r){return Object.keys(e).reduce(function(i,s){var a=e[s],o=a.stackedData,l=o.reduce(function(c,u){var d=fdt(u.slice(n,r+1));return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]).map(function(i){return i===1/0||i===-1/0?0:i})},dZ=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,hZ=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,xz=function(e,n,r){if(wn(e))return e(n,r);if(!Array.isArray(e))return n;var i=[];if(tt(e[0]))i[0]=r?e[0]:Math.min(e[0],n[0]);else if(dZ.test(e[0])){var s=+dZ.exec(e[0])[1];i[0]=n[0]-s}else wn(e[0])?i[0]=e[0](n[0]):i[0]=n[0];if(tt(e[1]))i[1]=r?e[1]:Math.max(e[1],n[1]);else if(hZ.test(e[1])){var a=+hZ.exec(e[1])[1];i[1]=n[1]+a}else wn(e[1])?i[1]=e[1](n[1]):i[1]=n[1];return i},kI=function(e,n,r){if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!r||i>0)return i}if(e&&n&&n.length>=2){for(var s=sH(n,function(d){return d.coordinate}),a=1/0,o=1,l=s.length;o<l;o++){var c=s[o],u=s[o-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return r?void 0:0},fZ=function(e,n,r){return!e||!e.length||vS(e,Vl(r,"type.defaultProps.domain"))?n:e},Nfe=function(e,n){var r=e.type.defaultProps?yi(yi({},e.type.defaultProps),e.props):e.props,i=r.dataKey,s=r.name,a=r.unit,o=r.formatter,l=r.tooltipType,c=r.chartType,u=r.hide;return yi(yi({},Rn(e,!1)),{},{dataKey:i,unit:a,formatter:o,name:s||i,color:MH(e),value:nl(n,i),type:l,payload:n,chartType:c,hide:u})};function _S(t){"@babel/helpers - typeof";return _S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_S(t)}function pZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function mZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pZ(Object(n),!0).forEach(function(r){pdt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function pdt(t,e,n){return e=mdt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mdt(t){var e=gdt(t,"string");return _S(e)=="symbol"?e:e+""}function gdt(t,e){if(_S(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(_S(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var MI=Math.PI/180,ydt=function(e){return e*180/Math.PI},Vs=function(e,n,r,i){return{x:e+Math.cos(-MI*i)*r,y:n+Math.sin(-MI*i)*r}},vdt=function(e,n){var r=e.x,i=e.y,s=n.x,a=n.y;return Math.sqrt(Math.pow(r-s,2)+Math.pow(i-a,2))},xdt=function(e,n){var r=e.x,i=e.y,s=n.cx,a=n.cy,o=vdt({x:r,y:i},{x:s,y:a});if(o<=0)return{radius:o};var l=(r-s)/o,c=Math.acos(l);return i>a&&(c=2*Math.PI-c),{radius:o,angle:ydt(c),angleInRadian:c}},bdt=function(e){var n=e.startAngle,r=e.endAngle,i=Math.floor(n/360),s=Math.floor(r/360),a=Math.min(i,s);return{startAngle:n-a*360,endAngle:r-a*360}},wdt=function(e,n){var r=n.startAngle,i=n.endAngle,s=Math.floor(r/360),a=Math.floor(i/360),o=Math.min(s,a);return e+o*360},gZ=function(e,n){var r=e.x,i=e.y,s=xdt({x:r,y:i},n),a=s.radius,o=s.angle,l=n.innerRadius,c=n.outerRadius;if(a<l||a>c)return!1;if(a===0)return!0;var u=bdt(n),d=u.startAngle,h=u.endAngle,f=o,p;if(d<=h){for(;f>h;)f-=360;for(;f<d;)f+=360;p=f>=d&&f<=h}else{for(;f>d;)f-=360;for(;f<h;)f+=360;p=f>=h&&f<=d}return p?mZ(mZ({},n),{},{radius:a,angle:wdt(f,n)}):null};function TS(t){"@babel/helpers - typeof";return TS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},TS(t)}var Sdt=["offset"];function _dt(t){return Ndt(t)||Cdt(t)||Edt(t)||Tdt()}function Tdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Edt(t,e){if(t){if(typeof t=="string")return bz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bz(t,e)}}function Cdt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ndt(t){if(Array.isArray(t))return bz(t)}function bz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Adt(t,e){if(t==null)return{};var n=Idt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Idt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function yZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ji(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yZ(Object(n),!0).forEach(function(r){kdt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function kdt(t,e,n){return e=Mdt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mdt(t){var e=Rdt(t,"string");return TS(e)=="symbol"?e:e+""}function Rdt(t,e){if(TS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(TS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ES(){return ES=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},ES.apply(this,arguments)}var Pdt=function(e){var n=e.value,r=e.formatter,i=Un(e.children)?n:e.children;return wn(r)?r(i):i},Odt=function(e,n){var r=Mc(n-e),i=Math.min(Math.abs(n-e),360);return r*i},Ddt=function(e,n,r){var i=e.position,s=e.viewBox,a=e.offset,o=e.className,l=s,c=l.cx,u=l.cy,d=l.innerRadius,h=l.outerRadius,f=l.startAngle,p=l.endAngle,g=l.clockWise,m=(d+h)/2,y=Odt(f,p),x=y>=0?1:-1,b,_;i==="insideStart"?(b=f+x*a,_=g):i==="insideEnd"?(b=p-x*a,_=!g):i==="end"&&(b=p+x*a,_=g),_=y<=0?_:!_;var T=Vs(c,u,m,b),E=Vs(c,u,m,b+(_?1:-1)*359),C="M".concat(T.x,",").concat(T.y,`
    A`).concat(m,",").concat(m,",0,1,").concat(_?0:1,`,
    `).concat(E.x,",").concat(E.y),I=Un(e.id)?eE("recharts-radial-line-"):e.id;return le.createElement("text",ES({},r,{dominantBaseline:"central",className:qn("recharts-radial-bar-label",o)}),le.createElement("defs",null,le.createElement("path",{id:I,d:C})),le.createElement("textPath",{xlinkHref:"#".concat(I)},n))},$dt=function(e){var n=e.viewBox,r=e.offset,i=e.position,s=n,a=s.cx,o=s.cy,l=s.innerRadius,c=s.outerRadius,u=s.startAngle,d=s.endAngle,h=(u+d)/2;if(i==="outside"){var f=Vs(a,o,c+r,h),p=f.x,g=f.y;return{x:p,y:g,textAnchor:p>=a?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:a,y:o,textAnchor:"middle",verticalAnchor:"end"};var m=(l+c)/2,y=Vs(a,o,m,h),x=y.x,b=y.y;return{x,y:b,textAnchor:"middle",verticalAnchor:"middle"}},Ldt=function(e){var n=e.viewBox,r=e.parentViewBox,i=e.offset,s=e.position,a=n,o=a.x,l=a.y,c=a.width,u=a.height,d=u>=0?1:-1,h=d*i,f=d>0?"end":"start",p=d>0?"start":"end",g=c>=0?1:-1,m=g*i,y=g>0?"end":"start",x=g>0?"start":"end";if(s==="top"){var b={x:o+c/2,y:l-d*i,textAnchor:"middle",verticalAnchor:f};return Ji(Ji({},b),r?{height:Math.max(l-r.y,0),width:c}:{})}if(s==="bottom"){var _={x:o+c/2,y:l+u+h,textAnchor:"middle",verticalAnchor:p};return Ji(Ji({},_),r?{height:Math.max(r.y+r.height-(l+u),0),width:c}:{})}if(s==="left"){var T={x:o-m,y:l+u/2,textAnchor:y,verticalAnchor:"middle"};return Ji(Ji({},T),r?{width:Math.max(T.x-r.x,0),height:u}:{})}if(s==="right"){var E={x:o+c+m,y:l+u/2,textAnchor:x,verticalAnchor:"middle"};return Ji(Ji({},E),r?{width:Math.max(r.x+r.width-E.x,0),height:u}:{})}var C=r?{width:c,height:u}:{};return s==="insideLeft"?Ji({x:o+m,y:l+u/2,textAnchor:x,verticalAnchor:"middle"},C):s==="insideRight"?Ji({x:o+c-m,y:l+u/2,textAnchor:y,verticalAnchor:"middle"},C):s==="insideTop"?Ji({x:o+c/2,y:l+h,textAnchor:"middle",verticalAnchor:p},C):s==="insideBottom"?Ji({x:o+c/2,y:l+u-h,textAnchor:"middle",verticalAnchor:f},C):s==="insideTopLeft"?Ji({x:o+m,y:l+h,textAnchor:x,verticalAnchor:p},C):s==="insideTopRight"?Ji({x:o+c-m,y:l+h,textAnchor:y,verticalAnchor:p},C):s==="insideBottomLeft"?Ji({x:o+m,y:l+u-h,textAnchor:x,verticalAnchor:f},C):s==="insideBottomRight"?Ji({x:o+c-m,y:l+u-h,textAnchor:y,verticalAnchor:f},C):cb(s)&&(tt(s.x)||Im(s.x))&&(tt(s.y)||Im(s.y))?Ji({x:o+kg(s.x,c),y:l+kg(s.y,u),textAnchor:"end",verticalAnchor:"end"},C):Ji({x:o+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},C)},Fdt=function(e){return"cx"in e&&tt(e.cx)};function da(t){var e=t.offset,n=e===void 0?5:e,r=Adt(t,Sdt),i=Ji({offset:n},r),s=i.viewBox,a=i.position,o=i.value,l=i.children,c=i.content,u=i.className,d=u===void 0?"":u,h=i.textBreakAll;if(!s||Un(o)&&Un(l)&&!P.isValidElement(c)&&!wn(c))return null;if(P.isValidElement(c))return P.cloneElement(c,i);var f;if(wn(c)){if(f=P.createElement(c,i),P.isValidElement(f))return f}else f=Pdt(i);var p=Fdt(s),g=Rn(i,!0);if(p&&(a==="insideStart"||a==="insideEnd"||a==="end"))return Ddt(i,f,g);var m=p?$dt(i):Ldt(i);return le.createElement(gI,ES({className:qn("recharts-label",d)},g,m,{breakAll:h}),f)}da.displayName="Label";var Afe=function(e){var n=e.cx,r=e.cy,i=e.angle,s=e.startAngle,a=e.endAngle,o=e.r,l=e.radius,c=e.innerRadius,u=e.outerRadius,d=e.x,h=e.y,f=e.top,p=e.left,g=e.width,m=e.height,y=e.clockWise,x=e.labelViewBox;if(x)return x;if(tt(g)&&tt(m)){if(tt(d)&&tt(h))return{x:d,y:h,width:g,height:m};if(tt(f)&&tt(p))return{x:f,y:p,width:g,height:m}}return tt(d)&&tt(h)?{x:d,y:h,width:0,height:0}:tt(n)&&tt(r)?{cx:n,cy:r,startAngle:s||i||0,endAngle:a||i||0,innerRadius:c||0,outerRadius:u||l||o||0,clockWise:y}:e.viewBox?e.viewBox:{}},jdt=function(e,n){return e?e===!0?le.createElement(da,{key:"label-implicit",viewBox:n}):os(e)?le.createElement(da,{key:"label-implicit",viewBox:n,value:e}):P.isValidElement(e)?e.type===da?P.cloneElement(e,{key:"label-implicit",viewBox:n}):le.createElement(da,{key:"label-implicit",content:e,viewBox:n}):wn(e)?le.createElement(da,{key:"label-implicit",content:e,viewBox:n}):cb(e)?le.createElement(da,ES({viewBox:n},e,{key:"label-implicit"})):null:null},zdt=function(e,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&r&&!e.label)return null;var i=e.children,s=Afe(e),a=jc(i,da).map(function(l,c){return P.cloneElement(l,{viewBox:n||s,key:"label-".concat(c)})});if(!r)return a;var o=jdt(e.label,n||s);return[o].concat(_dt(a))};da.parseViewBox=Afe;da.renderCallByParent=zdt;function Bdt(t){var e=t==null?0:t.length;return e?t[e-1]:void 0}var Udt=Bdt;const Vdt=lr(Udt);function CS(t){"@babel/helpers - typeof";return CS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},CS(t)}var Wdt=["valueAccessor"],Hdt=["data","dataKey","clockWise","id","textBreakAll"];function Gdt(t){return Ydt(t)||Kdt(t)||Xdt(t)||qdt()}function qdt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xdt(t,e){if(t){if(typeof t=="string")return wz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wz(t,e)}}function Kdt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Ydt(t){if(Array.isArray(t))return wz(t)}function wz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RI(){return RI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},RI.apply(this,arguments)}function vZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function xZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?vZ(Object(n),!0).forEach(function(r){Zdt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):vZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Zdt(t,e,n){return e=Qdt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qdt(t){var e=Jdt(t,"string");return CS(e)=="symbol"?e:e+""}function Jdt(t,e){if(CS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(CS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function bZ(t,e){if(t==null)return{};var n=eht(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function eht(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var tht=function(e){return Array.isArray(e.value)?Vdt(e.value):e.value};function Rf(t){var e=t.valueAccessor,n=e===void 0?tht:e,r=bZ(t,Wdt),i=r.data,s=r.dataKey,a=r.clockWise,o=r.id,l=r.textBreakAll,c=bZ(r,Hdt);return!i||!i.length?null:le.createElement(si,{className:"recharts-label-list"},i.map(function(u,d){var h=Un(s)?n(u,d):nl(u&&u.payload,s),f=Un(o)?{}:{id:"".concat(o,"-").concat(d)};return le.createElement(da,RI({},Rn(u,!0),c,f,{parentViewBox:u.parentViewBox,value:h,textBreakAll:l,viewBox:da.parseViewBox(Un(a)?u:xZ(xZ({},u),{},{clockWise:a})),key:"label-".concat(d),index:d}))}))}Rf.displayName="LabelList";function nht(t,e){return t?t===!0?le.createElement(Rf,{key:"labelList-implicit",data:e}):le.isValidElement(t)||wn(t)?le.createElement(Rf,{key:"labelList-implicit",data:e,content:t}):cb(t)?le.createElement(Rf,RI({data:e},t,{key:"labelList-implicit"})):null:null}function rht(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&n&&!t.label)return null;var r=t.children,i=jc(r,Rf).map(function(a,o){return P.cloneElement(a,{data:e,key:"labelList-".concat(o)})});if(!n)return i;var s=nht(t.label,e);return[s].concat(Gdt(i))}Rf.renderCallByParent=rht;function NS(t){"@babel/helpers - typeof";return NS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},NS(t)}function Sz(){return Sz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Sz.apply(this,arguments)}function wZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function SZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wZ(Object(n),!0).forEach(function(r){iht(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function iht(t,e,n){return e=sht(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sht(t){var e=aht(t,"string");return NS(e)=="symbol"?e:e+""}function aht(t,e){if(NS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(NS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var oht=function(e,n){var r=Mc(n-e),i=Math.min(Math.abs(n-e),359.999);return r*i},xN=function(e){var n=e.cx,r=e.cy,i=e.radius,s=e.angle,a=e.sign,o=e.isExternal,l=e.cornerRadius,c=e.cornerIsExternal,u=l*(o?1:-1)+i,d=Math.asin(l/u)/MI,h=c?s:s+a*d,f=Vs(n,r,u,h),p=Vs(n,r,i,h),g=c?s-a*d:s,m=Vs(n,r,u*Math.cos(d*MI),g);return{center:f,circleTangency:p,lineTangency:m,theta:d}},Ife=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,s=e.outerRadius,a=e.startAngle,o=e.endAngle,l=oht(a,o),c=a+l,u=Vs(n,r,s,a),d=Vs(n,r,s,c),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(s,",").concat(s,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(a>c),`,
    `).concat(d.x,",").concat(d.y,`
  `);if(i>0){var f=Vs(n,r,i,a),p=Vs(n,r,i,c);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(a<=c),`,
            `).concat(f.x,",").concat(f.y," Z")}else h+="L ".concat(n,",").concat(r," Z");return h},lht=function(e){var n=e.cx,r=e.cy,i=e.innerRadius,s=e.outerRadius,a=e.cornerRadius,o=e.forceCornerRadius,l=e.cornerIsExternal,c=e.startAngle,u=e.endAngle,d=Mc(u-c),h=xN({cx:n,cy:r,radius:s,angle:c,sign:d,cornerRadius:a,cornerIsExternal:l}),f=h.circleTangency,p=h.lineTangency,g=h.theta,m=xN({cx:n,cy:r,radius:s,angle:u,sign:-d,cornerRadius:a,cornerIsExternal:l}),y=m.circleTangency,x=m.lineTangency,b=m.theta,_=l?Math.abs(c-u):Math.abs(c-u)-g-b;if(_<0)return o?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):Ife({cx:n,cy:r,innerRadius:i,outerRadius:s,startAngle:c,endAngle:u});var T="M ".concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(s,",").concat(s,",0,").concat(+(_>180),",").concat(+(d<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(x.x,",").concat(x.y,`
  `);if(i>0){var E=xN({cx:n,cy:r,radius:i,angle:c,sign:d,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),C=E.circleTangency,I=E.lineTangency,A=E.theta,k=xN({cx:n,cy:r,radius:i,angle:u,sign:-d,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),R=k.circleTangency,$=k.lineTangency,z=k.theta,O=l?Math.abs(c-u):Math.abs(c-u)-A-z;if(O<0&&a===0)return"".concat(T,"L").concat(n,",").concat(r,"Z");T+="L".concat($.x,",").concat($.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(R.x,",").concat(R.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(O>180),",").concat(+(d>0),",").concat(C.x,",").concat(C.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(d<0),",").concat(I.x,",").concat(I.y,"Z")}else T+="L".concat(n,",").concat(r,"Z");return T},cht={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},kfe=function(e){var n=SZ(SZ({},cht),e),r=n.cx,i=n.cy,s=n.innerRadius,a=n.outerRadius,o=n.cornerRadius,l=n.forceCornerRadius,c=n.cornerIsExternal,u=n.startAngle,d=n.endAngle,h=n.className;if(a<s||u===d)return null;var f=qn("recharts-sector",h),p=a-s,g=kg(o,p,0,!0),m;return g>0&&Math.abs(u-d)<360?m=lht({cx:r,cy:i,innerRadius:s,outerRadius:a,cornerRadius:Math.min(g,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:d}):m=Ife({cx:r,cy:i,innerRadius:s,outerRadius:a,startAngle:u,endAngle:d}),le.createElement("path",Sz({},Rn(n,!0),{className:f,d:m,role:"img"}))};function AS(t){"@babel/helpers - typeof";return AS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},AS(t)}function _z(){return _z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_z.apply(this,arguments)}function _Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function TZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_Z(Object(n),!0).forEach(function(r){uht(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_Z(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function uht(t,e,n){return e=dht(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dht(t){var e=hht(t,"string");return AS(e)=="symbol"?e:e+""}function hht(t,e){if(AS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(AS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var EZ={curveBasisClosed:oZe,curveBasisOpen:lZe,curveBasis:aZe,curveBumpX:GYe,curveBumpY:qYe,curveLinearClosed:cZe,curveLinear:cP,curveMonotoneX:uZe,curveMonotoneY:dZe,curveNatural:hZe,curveStep:fZe,curveStepAfter:mZe,curveStepBefore:pZe},bN=function(e){return e.x===+e.x&&e.y===+e.y},gw=function(e){return e.x},yw=function(e){return e.y},fht=function(e,n){if(wn(e))return e;var r="curve".concat(oP(e));return(r==="curveMonotone"||r==="curveBump")&&n?EZ["".concat(r).concat(n==="vertical"?"Y":"X")]:EZ[r]||cP},pht=function(e){var n=e.type,r=n===void 0?"linear":n,i=e.points,s=i===void 0?[]:i,a=e.baseLine,o=e.layout,l=e.connectNulls,c=l===void 0?!1:l,u=fht(r,o),d=c?s.filter(function(g){return bN(g)}):s,h;if(Array.isArray(a)){var f=c?a.filter(function(g){return bN(g)}):a,p=d.map(function(g,m){return TZ(TZ({},g),{},{base:f[m]})});return o==="vertical"?h=uN().y(yw).x1(gw).x0(function(g){return g.base.x}):h=uN().x(gw).y1(yw).y0(function(g){return g.base.y}),h.defined(bN).curve(u),h(p)}return o==="vertical"&&tt(a)?h=uN().y(yw).x1(gw).x0(a):tt(a)?h=uN().x(gw).y1(yw).y0(a):h=kde().x(gw).y(yw),h.defined(bN).curve(u),h(d)},p1=function(e){var n=e.className,r=e.points,i=e.path,s=e.pathRef;if((!r||!r.length)&&!i)return null;var a=r&&r.length?pht(e):i;return le.createElement("path",_z({},Rn(e,!1),tI(e),{className:qn("recharts-curve",n),d:a,ref:s}))},Mfe={exports:{}},mht="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",ght=mht,yht=ght;function Rfe(){}function Pfe(){}Pfe.resetWarningCache=Rfe;var vht=function(){function t(r,i,s,a,o,l){if(l!==yht){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}t.isRequired=t;function e(){return t}var n={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,elementType:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:Pfe,resetWarningCache:Rfe};return n.PropTypes=n,n};Mfe.exports=vht();var xht=Mfe.exports;const ir=lr(xht);var bht=Object.getOwnPropertyNames,wht=Object.getOwnPropertySymbols,Sht=Object.prototype.hasOwnProperty;function CZ(t,e){return function(r,i,s){return t(r,i,s)&&e(r,i,s)}}function wN(t){return function(n,r,i){if(!n||!r||typeof n!="object"||typeof r!="object")return t(n,r,i);var s=i.cache,a=s.get(n),o=s.get(r);if(a&&o)return a===r&&o===n;s.set(n,r),s.set(r,n);var l=t(n,r,i);return s.delete(n),s.delete(r),l}}function NZ(t){return bht(t).concat(wht(t))}var _ht=Object.hasOwn||function(t,e){return Sht.call(t,e)};function ay(t,e){return t===e||!t&&!e&&t!==t&&e!==e}var Tht="__v",Eht="__o",Cht="_owner",AZ=Object.getOwnPropertyDescriptor,IZ=Object.keys;function Nht(t,e,n){var r=t.length;if(e.length!==r)return!1;for(;r-- >0;)if(!n.equals(t[r],e[r],r,r,t,e,n))return!1;return!0}function Aht(t,e){return ay(t.getTime(),e.getTime())}function Iht(t,e){return t.name===e.name&&t.message===e.message&&t.cause===e.cause&&t.stack===e.stack}function kht(t,e){return t===e}function kZ(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.entries(),a,o,l=0;(a=s.next())&&!a.done;){for(var c=e.entries(),u=!1,d=0;(o=c.next())&&!o.done;){if(i[d]){d++;continue}var h=a.value,f=o.value;if(n.equals(h[0],f[0],l,d,t,e,n)&&n.equals(h[1],f[1],h[0],f[0],t,e,n)){u=i[d]=!0;break}d++}if(!u)return!1;l++}return!0}var Mht=ay;function Rht(t,e,n){var r=IZ(t),i=r.length;if(IZ(e).length!==i)return!1;for(;i-- >0;)if(!Ofe(t,e,n,r[i]))return!1;return!0}function vw(t,e,n){var r=NZ(t),i=r.length;if(NZ(e).length!==i)return!1;for(var s,a,o;i-- >0;)if(s=r[i],!Ofe(t,e,n,s)||(a=AZ(t,s),o=AZ(e,s),(a||o)&&(!a||!o||a.configurable!==o.configurable||a.enumerable!==o.enumerable||a.writable!==o.writable)))return!1;return!0}function Pht(t,e){return ay(t.valueOf(),e.valueOf())}function Oht(t,e){return t.source===e.source&&t.flags===e.flags}function MZ(t,e,n){var r=t.size;if(r!==e.size)return!1;if(!r)return!0;for(var i=new Array(r),s=t.values(),a,o;(a=s.next())&&!a.done;){for(var l=e.values(),c=!1,u=0;(o=l.next())&&!o.done;){if(!i[u]&&n.equals(a.value,o.value,a.value,o.value,t,e,n)){c=i[u]=!0;break}u++}if(!c)return!1}return!0}function Dht(t,e){var n=t.length;if(e.length!==n)return!1;for(;n-- >0;)if(t[n]!==e[n])return!1;return!0}function $ht(t,e){return t.hostname===e.hostname&&t.pathname===e.pathname&&t.protocol===e.protocol&&t.port===e.port&&t.hash===e.hash&&t.username===e.username&&t.password===e.password}function Ofe(t,e,n,r){return(r===Cht||r===Eht||r===Tht)&&(t.$$typeof||e.$$typeof)?!0:_ht(e,r)&&n.equals(t[r],e[r],r,r,t,e,n)}var Lht="[object Arguments]",Fht="[object Boolean]",jht="[object Date]",zht="[object Error]",Bht="[object Map]",Uht="[object Number]",Vht="[object Object]",Wht="[object RegExp]",Hht="[object Set]",Ght="[object String]",qht="[object URL]",Xht=Array.isArray,RZ=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,PZ=Object.assign,Kht=Object.prototype.toString.call.bind(Object.prototype.toString);function Yht(t){var e=t.areArraysEqual,n=t.areDatesEqual,r=t.areErrorsEqual,i=t.areFunctionsEqual,s=t.areMapsEqual,a=t.areNumbersEqual,o=t.areObjectsEqual,l=t.arePrimitiveWrappersEqual,c=t.areRegExpsEqual,u=t.areSetsEqual,d=t.areTypedArraysEqual,h=t.areUrlsEqual;return function(p,g,m){if(p===g)return!0;if(p==null||g==null)return!1;var y=typeof p;if(y!==typeof g)return!1;if(y!=="object")return y==="number"?a(p,g,m):y==="function"?i(p,g,m):!1;var x=p.constructor;if(x!==g.constructor)return!1;if(x===Object)return o(p,g,m);if(Xht(p))return e(p,g,m);if(RZ!=null&&RZ(p))return d(p,g,m);if(x===Date)return n(p,g,m);if(x===RegExp)return c(p,g,m);if(x===Map)return s(p,g,m);if(x===Set)return u(p,g,m);var b=Kht(p);return b===jht?n(p,g,m):b===Wht?c(p,g,m):b===Bht?s(p,g,m):b===Hht?u(p,g,m):b===Vht?typeof p.then!="function"&&typeof g.then!="function"&&o(p,g,m):b===qht?h(p,g,m):b===zht?r(p,g,m):b===Lht?o(p,g,m):b===Fht||b===Uht||b===Ght?l(p,g,m):!1}}function Zht(t){var e=t.circular,n=t.createCustomConfig,r=t.strict,i={areArraysEqual:r?vw:Nht,areDatesEqual:Aht,areErrorsEqual:Iht,areFunctionsEqual:kht,areMapsEqual:r?CZ(kZ,vw):kZ,areNumbersEqual:Mht,areObjectsEqual:r?vw:Rht,arePrimitiveWrappersEqual:Pht,areRegExpsEqual:Oht,areSetsEqual:r?CZ(MZ,vw):MZ,areTypedArraysEqual:r?vw:Dht,areUrlsEqual:$ht};if(n&&(i=PZ({},i,n(i))),e){var s=wN(i.areArraysEqual),a=wN(i.areMapsEqual),o=wN(i.areObjectsEqual),l=wN(i.areSetsEqual);i=PZ({},i,{areArraysEqual:s,areMapsEqual:a,areObjectsEqual:o,areSetsEqual:l})}return i}function Qht(t){return function(e,n,r,i,s,a,o){return t(e,n,o)}}function Jht(t){var e=t.circular,n=t.comparator,r=t.createState,i=t.equals,s=t.strict;if(r)return function(l,c){var u=r(),d=u.cache,h=d===void 0?e?new WeakMap:void 0:d,f=u.meta;return n(l,c,{cache:h,equals:i,meta:f,strict:s})};if(e)return function(l,c){return n(l,c,{cache:new WeakMap,equals:i,meta:void 0,strict:s})};var a={cache:void 0,equals:i,meta:void 0,strict:s};return function(l,c){return n(l,c,a)}}var eft=Ep();Ep({strict:!0});Ep({circular:!0});Ep({circular:!0,strict:!0});Ep({createInternalComparator:function(){return ay}});Ep({strict:!0,createInternalComparator:function(){return ay}});Ep({circular:!0,createInternalComparator:function(){return ay}});Ep({circular:!0,createInternalComparator:function(){return ay},strict:!0});function Ep(t){t===void 0&&(t={});var e=t.circular,n=e===void 0?!1:e,r=t.createInternalComparator,i=t.createState,s=t.strict,a=s===void 0?!1:s,o=Zht(t),l=Yht(o),c=r?r(l):Qht(l);return Jht({circular:n,comparator:l,createState:i,equals:c,strict:a})}function tft(t){typeof requestAnimationFrame<"u"&&requestAnimationFrame(t)}function OZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function i(s){n<0&&(n=s),s-n>e?(t(s),n=-1):tft(i)};requestAnimationFrame(r)}function Tz(t){"@babel/helpers - typeof";return Tz=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tz(t)}function nft(t){return aft(t)||sft(t)||ift(t)||rft()}function rft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ift(t,e){if(t){if(typeof t=="string")return DZ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return DZ(t,e)}}function DZ(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function sft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function aft(t){if(Array.isArray(t))return t}function oft(){var t={},e=function(){return null},n=!1,r=function i(s){if(!n){if(Array.isArray(s)){if(!s.length)return;var a=s,o=nft(a),l=o[0],c=o.slice(1);if(typeof l=="number"){OZ(i.bind(null,c),l);return}i(l),OZ(i.bind(null,c));return}Tz(s)==="object"&&(t=s,e(t)),typeof s=="function"&&s()}};return{stop:function(){n=!0},start:function(s){n=!1,r(s)},subscribe:function(s){return e=s,function(){e=function(){return null}}}}}function IS(t){"@babel/helpers - typeof";return IS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},IS(t)}function $Z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function LZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$Z(Object(n),!0).forEach(function(r){Dfe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$Z(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Dfe(t,e,n){return e=lft(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lft(t){var e=cft(t,"string");return IS(e)==="symbol"?e:String(e)}function cft(t,e){if(IS(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(IS(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var uft=function(e,n){return[Object.keys(e),Object.keys(n)].reduce(function(r,i){return r.filter(function(s){return i.includes(s)})})},dft=function(e){return e},hft=function(e){return e.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},m1=function(e,n){return Object.keys(n).reduce(function(r,i){return LZ(LZ({},r),{},Dfe({},i,e(i,n[i])))},{})},FZ=function(e,n,r){return e.map(function(i){return"".concat(hft(i)," ").concat(n,"ms ").concat(r)}).join(",")};function fft(t,e){return gft(t)||mft(t,e)||$fe(t,e)||pft()}function pft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mft(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function gft(t){if(Array.isArray(t))return t}function yft(t){return bft(t)||xft(t)||$fe(t)||vft()}function vft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $fe(t,e){if(t){if(typeof t=="string")return Ez(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ez(t,e)}}function xft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function bft(t){if(Array.isArray(t))return Ez(t)}function Ez(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var PI=1e-4,Lfe=function(e,n){return[0,3*e,3*n-6*e,3*e-3*n+1]},Ffe=function(e,n){return e.map(function(r,i){return r*Math.pow(n,i)}).reduce(function(r,i){return r+i})},jZ=function(e,n){return function(r){var i=Lfe(e,n);return Ffe(i,r)}},wft=function(e,n){return function(r){var i=Lfe(e,n),s=[].concat(yft(i.map(function(a,o){return a*o}).slice(1)),[0]);return Ffe(s,r)}},zZ=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0],s=n[1],a=n[2],o=n[3];if(n.length===1)switch(n[0]){case"linear":i=0,s=0,a=1,o=1;break;case"ease":i=.25,s=.1,a=.25,o=1;break;case"ease-in":i=.42,s=0,a=1,o=1;break;case"ease-out":i=.42,s=0,a=.58,o=1;break;case"ease-in-out":i=0,s=0,a=.58,o=1;break;default:{var l=n[0].split("(");if(l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4){var c=l[1].split(")")[0].split(",").map(function(m){return parseFloat(m)}),u=fft(c,4);i=u[0],s=u[1],a=u[2],o=u[3]}}}var d=jZ(i,a),h=jZ(s,o),f=wft(i,a),p=function(y){return y>1?1:y<0?0:y},g=function(y){for(var x=y>1?1:y,b=x,_=0;_<8;++_){var T=d(b)-x,E=f(b);if(Math.abs(T-x)<PI||E<PI)return h(b);b=p(b-T/E)}return h(b)};return g.isStepper=!1,g},Sft=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=e.stiff,r=n===void 0?100:n,i=e.damping,s=i===void 0?8:i,a=e.dt,o=a===void 0?17:a,l=function(u,d,h){var f=-(u-d)*r,p=h*s,g=h+(f-p)*o/1e3,m=h*o/1e3+u;return Math.abs(m-d)<PI&&Math.abs(g)<PI?[d,0]:[m,g]};return l.isStepper=!0,l.dt=o,l},_ft=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=n[0];if(typeof i=="string")switch(i){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return zZ(i);case"spring":return Sft();default:if(i.split("(")[0]==="cubic-bezier")return zZ(i)}return typeof i=="function"?i:null};function kS(t){"@babel/helpers - typeof";return kS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kS(t)}function BZ(t){return Cft(t)||Eft(t)||jfe(t)||Tft()}function Tft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Eft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Cft(t){if(Array.isArray(t))return Nz(t)}function UZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function zs(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UZ(Object(n),!0).forEach(function(r){Cz(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Cz(t,e,n){return e=Nft(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nft(t){var e=Aft(t,"string");return kS(e)==="symbol"?e:String(e)}function Aft(t,e){if(kS(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(kS(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ift(t,e){return Rft(t)||Mft(t,e)||jfe(t,e)||kft()}function kft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jfe(t,e){if(t){if(typeof t=="string")return Nz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Nz(t,e)}}function Nz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Mft(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Rft(t){if(Array.isArray(t))return t}var OI=function(e,n,r){return e+(n-e)*r},Az=function(e){var n=e.from,r=e.to;return n!==r},Pft=function t(e,n,r){var i=m1(function(s,a){if(Az(a)){var o=e(a.from,a.to,a.velocity),l=Ift(o,2),c=l[0],u=l[1];return zs(zs({},a),{},{from:c,velocity:u})}return a},n);return r<1?m1(function(s,a){return Az(a)?zs(zs({},a),{},{velocity:OI(a.velocity,i[s].velocity,r),from:OI(a.from,i[s].from,r)}):a},n):t(e,i,r-1)};const Oft=function(t,e,n,r,i){var s=uft(t,e),a=s.reduce(function(m,y){return zs(zs({},m),{},Cz({},y,[t[y],e[y]]))},{}),o=s.reduce(function(m,y){return zs(zs({},m),{},Cz({},y,{from:t[y],velocity:0,to:e[y]}))},{}),l=-1,c,u,d=function(){return null},h=function(){return m1(function(y,x){return x.from},o)},f=function(){return!Object.values(o).filter(Az).length},p=function(y){c||(c=y);var x=y-c,b=x/n.dt;o=Pft(n,o,b),i(zs(zs(zs({},t),e),h())),c=y,f()||(l=requestAnimationFrame(d))},g=function(y){u||(u=y);var x=(y-u)/r,b=m1(function(T,E){return OI.apply(void 0,BZ(E).concat([n(x)]))},a);if(i(zs(zs(zs({},t),e),b)),x<1)l=requestAnimationFrame(d);else{var _=m1(function(T,E){return OI.apply(void 0,BZ(E).concat([n(1)]))},a);i(zs(zs(zs({},t),e),_))}};return d=n.isStepper?p:g,function(){return requestAnimationFrame(d),function(){cancelAnimationFrame(l)}}};function d0(t){"@babel/helpers - typeof";return d0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d0(t)}var Dft=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function $ft(t,e){if(t==null)return{};var n=Lft(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Lft(t,e){if(t==null)return{};var n={},r=Object.keys(t),i,s;for(s=0;s<r.length;s++)i=r[s],!(e.indexOf(i)>=0)&&(n[i]=t[i]);return n}function xL(t){return Bft(t)||zft(t)||jft(t)||Fft()}function Fft(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jft(t,e){if(t){if(typeof t=="string")return Iz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Iz(t,e)}}function zft(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Bft(t){if(Array.isArray(t))return Iz(t)}function Iz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function VZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function oc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?VZ(Object(n),!0).forEach(function(r){Gw(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):VZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Gw(t,e,n){return e=zfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uft(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Vft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zfe(r.key),r)}}function Wft(t,e,n){return e&&Vft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function zfe(t){var e=Hft(t,"string");return d0(e)==="symbol"?e:String(e)}function Hft(t,e){if(d0(t)!=="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(d0(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Gft(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&kz(t,e)}function kz(t,e){return kz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},kz(t,e)}function qft(t){var e=Xft();return function(){var r=DI(t),i;if(e){var s=DI(this).constructor;i=Reflect.construct(r,arguments,s)}else i=r.apply(this,arguments);return Mz(this,i)}}function Mz(t,e){if(e&&(d0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Rz(t)}function Rz(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xft(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function DI(t){return DI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},DI(t)}var ch=function(t){Gft(n,t);var e=qft(n);function n(r,i){var s;Uft(this,n),s=e.call(this,r,i);var a=s.props,o=a.isActive,l=a.attributeName,c=a.from,u=a.to,d=a.steps,h=a.children,f=a.duration;if(s.handleStyleChange=s.handleStyleChange.bind(Rz(s)),s.changeStyle=s.changeStyle.bind(Rz(s)),!o||f<=0)return s.state={style:{}},typeof h=="function"&&(s.state={style:u}),Mz(s);if(d&&d.length)s.state={style:d[0].style};else if(c){if(typeof h=="function")return s.state={style:c},Mz(s);s.state={style:l?Gw({},l,c):c}}else s.state={style:{}};return s}return Wft(n,[{key:"componentDidMount",value:function(){var i=this.props,s=i.isActive,a=i.canBegin;this.mounted=!0,!(!s||!a)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(i){var s=this.props,a=s.isActive,o=s.canBegin,l=s.attributeName,c=s.shouldReAnimate,u=s.to,d=s.from,h=this.state.style;if(o){if(!a){var f={style:l?Gw({},l,u):u};this.state&&h&&(l&&h[l]!==u||!l&&h!==u)&&this.setState(f);return}if(!(eft(i.to,u)&&i.canBegin&&i.isActive)){var p=!i.canBegin||!i.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var g=p||c?d:i.to;if(this.state&&h){var m={style:l?Gw({},l,g):g};(l&&h[l]!==g||!l&&h!==g)&&this.setState(m)}this.runAnimation(oc(oc({},this.props),{},{from:g,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var i=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),i&&i()}},{key:"handleStyleChange",value:function(i){this.changeStyle(i)}},{key:"changeStyle",value:function(i){this.mounted&&this.setState({style:i})}},{key:"runJSAnimation",value:function(i){var s=this,a=i.from,o=i.to,l=i.duration,c=i.easing,u=i.begin,d=i.onAnimationEnd,h=i.onAnimationStart,f=Oft(a,o,_ft(c),l,this.changeStyle),p=function(){s.stopJSAnimation=f()};this.manager.start([h,u,p,l,d])}},{key:"runStepAnimation",value:function(i){var s=this,a=i.steps,o=i.begin,l=i.onAnimationStart,c=a[0],u=c.style,d=c.duration,h=d===void 0?0:d,f=function(g,m,y){if(y===0)return g;var x=m.duration,b=m.easing,_=b===void 0?"ease":b,T=m.style,E=m.properties,C=m.onAnimationEnd,I=y>0?a[y-1]:m,A=E||Object.keys(T);if(typeof _=="function"||_==="spring")return[].concat(xL(g),[s.runJSAnimation.bind(s,{from:I.style,to:T,duration:x,easing:_}),x]);var k=FZ(A,x,_),R=oc(oc(oc({},I.style),T),{},{transition:k});return[].concat(xL(g),[R,x,C]).filter(dft)};return this.manager.start([l].concat(xL(a.reduce(f,[u,Math.max(h,o)])),[i.onAnimationEnd]))}},{key:"runAnimation",value:function(i){this.manager||(this.manager=oft());var s=i.begin,a=i.duration,o=i.attributeName,l=i.to,c=i.easing,u=i.onAnimationStart,d=i.onAnimationEnd,h=i.steps,f=i.children,p=this.manager;if(this.unSubscribe=p.subscribe(this.handleStyleChange),typeof c=="function"||typeof f=="function"||c==="spring"){this.runJSAnimation(i);return}if(h.length>1){this.runStepAnimation(i);return}var g=o?Gw({},o,l):l,m=FZ(Object.keys(g),a,c);p.start([u,s,oc(oc({},g),{},{transition:m}),a,d])}},{key:"render",value:function(){var i=this.props,s=i.children;i.begin;var a=i.duration;i.attributeName,i.easing;var o=i.isActive;i.steps,i.from,i.to,i.canBegin,i.onAnimationEnd,i.shouldReAnimate,i.onAnimationReStart;var l=$ft(i,Dft),c=P.Children.count(s),u=this.state.style;if(typeof s=="function")return s(u);if(!o||c===0||a<=0)return s;var d=function(f){var p=f.props,g=p.style,m=g===void 0?{}:g,y=p.className,x=P.cloneElement(f,oc(oc({},l),{},{style:oc(oc({},m),u),className:y}));return x};return c===1?d(P.Children.only(s)):le.createElement("div",null,P.Children.map(s,function(h){return d(h)}))}}]),n}(P.PureComponent);ch.displayName="Animate";ch.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};ch.propTypes={from:ir.oneOfType([ir.object,ir.string]),to:ir.oneOfType([ir.object,ir.string]),attributeName:ir.string,duration:ir.number,begin:ir.number,easing:ir.oneOfType([ir.string,ir.func]),steps:ir.arrayOf(ir.shape({duration:ir.number.isRequired,style:ir.object.isRequired,easing:ir.oneOfType([ir.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),ir.func]),properties:ir.arrayOf("string"),onAnimationEnd:ir.func})),children:ir.oneOfType([ir.node,ir.func]),isActive:ir.bool,canBegin:ir.bool,onAnimationEnd:ir.func,shouldReAnimate:ir.bool,onAnimationStart:ir.func,onAnimationReStart:ir.func};function MS(t){"@babel/helpers - typeof";return MS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},MS(t)}function $I(){return $I=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$I.apply(this,arguments)}function Kft(t,e){return Jft(t)||Qft(t,e)||Zft(t,e)||Yft()}function Yft(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Zft(t,e){if(t){if(typeof t=="string")return WZ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return WZ(t,e)}}function WZ(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Qft(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Jft(t){if(Array.isArray(t))return t}function HZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function GZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HZ(Object(n),!0).forEach(function(r){ept(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function ept(t,e,n){return e=tpt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tpt(t){var e=npt(t,"string");return MS(e)=="symbol"?e:e+""}function npt(t,e){if(MS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(MS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qZ=function(e,n,r,i,s){var a=Math.min(Math.abs(r)/2,Math.abs(i)/2),o=i>=0?1:-1,l=r>=0?1:-1,c=i>=0&&r>=0||i<0&&r<0?1:0,u;if(a>0&&s instanceof Array){for(var d=[0,0,0,0],h=0,f=4;h<f;h++)d[h]=s[h]>a?a:s[h];u="M".concat(e,",").concat(n+o*d[0]),d[0]>0&&(u+="A ".concat(d[0],",").concat(d[0],",0,0,").concat(c,",").concat(e+l*d[0],",").concat(n)),u+="L ".concat(e+r-l*d[1],",").concat(n),d[1]>0&&(u+="A ".concat(d[1],",").concat(d[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(n+o*d[1])),u+="L ".concat(e+r,",").concat(n+i-o*d[2]),d[2]>0&&(u+="A ".concat(d[2],",").concat(d[2],",0,0,").concat(c,`,
        `).concat(e+r-l*d[2],",").concat(n+i)),u+="L ".concat(e+l*d[3],",").concat(n+i),d[3]>0&&(u+="A ".concat(d[3],",").concat(d[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(n+i-o*d[3])),u+="Z"}else if(a>0&&s===+s&&s>0){var p=Math.min(a,s);u="M ".concat(e,",").concat(n+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+l*p,",").concat(n,`
            L `).concat(e+r-l*p,",").concat(n,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r,",").concat(n+o*p,`
            L `).concat(e+r,",").concat(n+i-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+r-l*p,",").concat(n+i,`
            L `).concat(e+l*p,",").concat(n+i,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(n+i-o*p," Z")}else u="M ".concat(e,",").concat(n," h ").concat(r," v ").concat(i," h ").concat(-r," Z");return u},rpt=function(e,n){if(!e||!n)return!1;var r=e.x,i=e.y,s=n.x,a=n.y,o=n.width,l=n.height;if(Math.abs(o)>0&&Math.abs(l)>0){var c=Math.min(s,s+o),u=Math.max(s,s+o),d=Math.min(a,a+l),h=Math.max(a,a+l);return r>=c&&r<=u&&i>=d&&i<=h}return!1},ipt={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},RH=function(e){var n=GZ(GZ({},ipt),e),r=P.useRef(),i=P.useState(-1),s=Kft(i,2),a=s[0],o=s[1];P.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&o(_)}catch{}},[]);var l=n.x,c=n.y,u=n.width,d=n.height,h=n.radius,f=n.className,p=n.animationEasing,g=n.animationDuration,m=n.animationBegin,y=n.isAnimationActive,x=n.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||d!==+d||u===0||d===0)return null;var b=qn("recharts-rectangle",f);return x?le.createElement(ch,{canBegin:a>0,from:{width:u,height:d,x:l,y:c},to:{width:u,height:d,x:l,y:c},duration:g,animationEasing:p,isActive:x},function(_){var T=_.width,E=_.height,C=_.x,I=_.y;return le.createElement(ch,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:g,isActive:y,easing:p},le.createElement("path",$I({},Rn(n,!0),{className:b,d:qZ(C,I,T,E,h),ref:r})))}):le.createElement("path",$I({},Rn(n,!0),{className:b,d:qZ(l,c,u,d,h)}))};function Pz(){return Pz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pz.apply(this,arguments)}var PH=function(e){var n=e.cx,r=e.cy,i=e.r,s=e.className,a=qn("recharts-dot",s);return n===+n&&r===+r&&i===+i?le.createElement("circle",Pz({},Rn(e,!1),tI(e),{className:a,cx:n,cy:r,r:i})):null};function RS(t){"@babel/helpers - typeof";return RS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},RS(t)}var spt=["x","y","top","left","width","height","className"];function Oz(){return Oz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Oz.apply(this,arguments)}function XZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function apt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XZ(Object(n),!0).forEach(function(r){opt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function opt(t,e,n){return e=lpt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lpt(t){var e=cpt(t,"string");return RS(e)=="symbol"?e:e+""}function cpt(t,e){if(RS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(RS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function upt(t,e){if(t==null)return{};var n=dpt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function dpt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var hpt=function(e,n,r,i,s,a){return"M".concat(e,",").concat(s,"v").concat(i,"M").concat(a,",").concat(n,"h").concat(r)},fpt=function(e){var n=e.x,r=n===void 0?0:n,i=e.y,s=i===void 0?0:i,a=e.top,o=a===void 0?0:a,l=e.left,c=l===void 0?0:l,u=e.width,d=u===void 0?0:u,h=e.height,f=h===void 0?0:h,p=e.className,g=upt(e,spt),m=apt({x:r,y:s,top:o,left:c,width:d,height:f},g);return!tt(r)||!tt(s)||!tt(d)||!tt(f)||!tt(o)||!tt(c)?null:le.createElement("path",Oz({},Rn(m,!0),{className:qn("recharts-cross",p),d:hpt(r,s,d,f,o,c)}))},ppt=ehe,mpt=ppt(Object.getPrototypeOf,Object),gpt=mpt,ypt=wh,vpt=gpt,xpt=Sh,bpt="[object Object]",wpt=Function.prototype,Spt=Object.prototype,Bfe=wpt.toString,_pt=Spt.hasOwnProperty,Tpt=Bfe.call(Object);function Ept(t){if(!xpt(t)||ypt(t)!=bpt)return!1;var e=vpt(t);if(e===null)return!0;var n=_pt.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&Bfe.call(n)==Tpt}var Cpt=Ept;const Npt=lr(Cpt);var Apt=wh,Ipt=Sh,kpt="[object Boolean]";function Mpt(t){return t===!0||t===!1||Ipt(t)&&Apt(t)==kpt}var Rpt=Mpt;const Ppt=lr(Rpt);function PS(t){"@babel/helpers - typeof";return PS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},PS(t)}function LI(){return LI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},LI.apply(this,arguments)}function Opt(t,e){return Fpt(t)||Lpt(t,e)||$pt(t,e)||Dpt()}function Dpt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $pt(t,e){if(t){if(typeof t=="string")return KZ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return KZ(t,e)}}function KZ(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function Lpt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function Fpt(t){if(Array.isArray(t))return t}function YZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ZZ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YZ(Object(n),!0).forEach(function(r){jpt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jpt(t,e,n){return e=zpt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zpt(t){var e=Bpt(t,"string");return PS(e)=="symbol"?e:e+""}function Bpt(t,e){if(PS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(PS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var QZ=function(e,n,r,i,s){var a=r-i,o;return o="M ".concat(e,",").concat(n),o+="L ".concat(e+r,",").concat(n),o+="L ".concat(e+r-a/2,",").concat(n+s),o+="L ".concat(e+r-a/2-i,",").concat(n+s),o+="L ".concat(e,",").concat(n," Z"),o},Upt={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Vpt=function(e){var n=ZZ(ZZ({},Upt),e),r=P.useRef(),i=P.useState(-1),s=Opt(i,2),a=s[0],o=s[1];P.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&o(b)}catch{}},[]);var l=n.x,c=n.y,u=n.upperWidth,d=n.lowerWidth,h=n.height,f=n.className,p=n.animationEasing,g=n.animationDuration,m=n.animationBegin,y=n.isUpdateAnimationActive;if(l!==+l||c!==+c||u!==+u||d!==+d||h!==+h||u===0&&d===0||h===0)return null;var x=qn("recharts-trapezoid",f);return y?le.createElement(ch,{canBegin:a>0,from:{upperWidth:0,lowerWidth:0,height:h,x:l,y:c},to:{upperWidth:u,lowerWidth:d,height:h,x:l,y:c},duration:g,animationEasing:p,isActive:y},function(b){var _=b.upperWidth,T=b.lowerWidth,E=b.height,C=b.x,I=b.y;return le.createElement(ch,{canBegin:a>0,from:"0px ".concat(a===-1?1:a,"px"),to:"".concat(a,"px 0px"),attributeName:"strokeDasharray",begin:m,duration:g,easing:p},le.createElement("path",LI({},Rn(n,!0),{className:x,d:QZ(C,I,_,T,E),ref:r})))}):le.createElement("g",null,le.createElement("path",LI({},Rn(n,!0),{className:x,d:QZ(l,c,u,d,h)})))},Wpt=["option","shapeType","propTransformer","activeClassName","isActive"];function OS(t){"@babel/helpers - typeof";return OS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},OS(t)}function Hpt(t,e){if(t==null)return{};var n=Gpt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Gpt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function JZ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function FI(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?JZ(Object(n),!0).forEach(function(r){qpt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):JZ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function qpt(t,e,n){return e=Xpt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xpt(t){var e=Kpt(t,"string");return OS(e)=="symbol"?e:e+""}function Kpt(t,e){if(OS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(OS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ypt(t,e){return FI(FI({},e),t)}function Zpt(t,e){return t==="symbols"}function eQ(t){var e=t.shapeType,n=t.elementProps;switch(e){case"rectangle":return le.createElement(RH,n);case"trapezoid":return le.createElement(Vpt,n);case"sector":return le.createElement(kfe,n);case"symbols":if(Zpt(e))return le.createElement(Z5,n);break;default:return null}}function Qpt(t){return P.isValidElement(t)?t.props:t}function Jpt(t){var e=t.option,n=t.shapeType,r=t.propTransformer,i=r===void 0?Ypt:r,s=t.activeClassName,a=s===void 0?"recharts-active-shape":s,o=t.isActive,l=Hpt(t,Wpt),c;if(P.isValidElement(e))c=P.cloneElement(e,FI(FI({},l),Qpt(e)));else if(wn(e))c=e(l);else if(Npt(e)&&!Ppt(e)){var u=i(e,l);c=le.createElement(eQ,{shapeType:n,elementProps:u})}else{var d=l;c=le.createElement(eQ,{shapeType:n,elementProps:d})}return o?le.createElement(si,{className:a},c):c}function TP(t,e){return e!=null&&"trapezoids"in t.props}function EP(t,e){return e!=null&&"sectors"in t.props}function DS(t,e){return e!=null&&"points"in t.props}function emt(t,e){var n,r,i=t.x===(e==null||(n=e.labelViewBox)===null||n===void 0?void 0:n.x)||t.x===e.x,s=t.y===(e==null||(r=e.labelViewBox)===null||r===void 0?void 0:r.y)||t.y===e.y;return i&&s}function tmt(t,e){var n=t.endAngle===e.endAngle,r=t.startAngle===e.startAngle;return n&&r}function nmt(t,e){var n=t.x===e.x,r=t.y===e.y,i=t.z===e.z;return n&&r&&i}function rmt(t,e){var n;return TP(t,e)?n=emt:EP(t,e)?n=tmt:DS(t,e)&&(n=nmt),n}function imt(t,e){var n;return TP(t,e)?n="trapezoids":EP(t,e)?n="sectors":DS(t,e)&&(n="points"),n}function smt(t,e){if(TP(t,e)){var n;return(n=e.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(EP(t,e)){var r;return(r=e.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return DS(t,e)?e.payload:{}}function amt(t){var e=t.activeTooltipItem,n=t.graphicalItem,r=t.itemData,i=imt(n,e),s=smt(n,e),a=r.filter(function(l,c){var u=vS(s,l),d=n.props[i].filter(function(p){var g=rmt(n,e);return g(p,e)}),h=n.props[i].indexOf(d[d.length-1]),f=c===h;return u&&f}),o=r.indexOf(a[a.length-1]);return o}var omt=Math.ceil,lmt=Math.max;function cmt(t,e,n,r){for(var i=-1,s=lmt(omt((e-t)/(n||1)),0),a=Array(s);s--;)a[r?s:++i]=t,t+=n;return a}var umt=cmt,dmt=xhe,hmt=1/0,fmt=17976931348623157e292;function pmt(t){if(!t)return t===0?t:0;if(t=dmt(t),t===hmt||t===-1/0){var e=t<0?-1:1;return e*fmt}return t===t?t:0}var Ufe=pmt,mmt=umt,gmt=fP,bL=Ufe;function ymt(t){return function(e,n,r){return r&&typeof r!="number"&&gmt(e,n,r)&&(n=r=void 0),e=bL(e),n===void 0?(n=e,e=0):n=bL(n),r=r===void 0?e<n?1:-1:bL(r),mmt(e,n,r,t)}}var vmt=ymt,xmt=vmt,bmt=xmt(),wmt=bmt;const jI=lr(wmt);function $S(t){"@babel/helpers - typeof";return $S=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},$S(t)}function tQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function nQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tQ(Object(n),!0).forEach(function(r){Vfe(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Vfe(t,e,n){return e=Smt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Smt(t){var e=_mt(t,"string");return $S(e)=="symbol"?e:e+""}function _mt(t,e){if($S(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if($S(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Tmt=["Webkit","Moz","O","ms"],Emt=function(e,n){var r=e.replace(/(\w)/,function(s){return s.toUpperCase()}),i=Tmt.reduce(function(s,a){return nQ(nQ({},s),{},Vfe({},a+r,n))},{});return i[e]=n,i};function h0(t){"@babel/helpers - typeof";return h0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h0(t)}function zI(){return zI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zI.apply(this,arguments)}function rQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function wL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rQ(Object(n),!0).forEach(function(r){$o(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Cmt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Hfe(r.key),r)}}function Nmt(t,e,n){return e&&iQ(t.prototype,e),n&&iQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Amt(t,e,n){return e=BI(e),Imt(t,Wfe()?Reflect.construct(e,n||[],BI(t).constructor):e.apply(t,n))}function Imt(t,e){if(e&&(h0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return kmt(t)}function kmt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Wfe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wfe=function(){return!!t})()}function BI(t){return BI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},BI(t)}function Mmt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dz(t,e)}function Dz(t,e){return Dz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Dz(t,e)}function $o(t,e,n){return e=Hfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Hfe(t){var e=Rmt(t,"string");return h0(e)=="symbol"?e:e+""}function Rmt(t,e){if(h0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(h0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Pmt=function(e){var n=e.data,r=e.startIndex,i=e.endIndex,s=e.x,a=e.width,o=e.travellerWidth;if(!n||!n.length)return{};var l=n.length,c=h1().domain(jI(0,l)).range([s,s+a-o]),u=c.domain().map(function(d){return c(d)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:c(r),endX:c(i),scale:c,scaleValues:u}},sQ=function(e){return e.changedTouches&&!!e.changedTouches.length},f0=function(t){function e(n){var r;return Cmt(this,e),r=Amt(this,e,[n]),$o(r,"handleDrag",function(i){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(i):r.state.isSlideMoving&&r.handleSlideDrag(i)}),$o(r,"handleTouchMove",function(i){i.changedTouches!=null&&i.changedTouches.length>0&&r.handleDrag(i.changedTouches[0])}),$o(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var i=r.props,s=i.endIndex,a=i.onDragEnd,o=i.startIndex;a==null||a({endIndex:s,startIndex:o})}),r.detachDragEndListener()}),$o(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),$o(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),$o(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),$o(r,"handleSlideDragStart",function(i){var s=sQ(i)?i.changedTouches[0]:i;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:s.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return Mmt(e,t),Nmt(e,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var i=r.startX,s=r.endX,a=this.state.scaleValues,o=this.props,l=o.gap,c=o.data,u=c.length-1,d=Math.min(i,s),h=Math.max(i,s),f=e.getIndexInRange(a,d),p=e.getIndexInRange(a,h);return{startIndex:f-f%l,endIndex:p===u?u:p-p%l}}},{key:"getTextOfTick",value:function(r){var i=this.props,s=i.data,a=i.tickFormatter,o=i.dataKey,l=nl(s[r],o,r);return wn(a)?a(l,r):l}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var i=this.state,s=i.slideMoveStartX,a=i.startX,o=i.endX,l=this.props,c=l.x,u=l.width,d=l.travellerWidth,h=l.startIndex,f=l.endIndex,p=l.onChange,g=r.pageX-s;g>0?g=Math.min(g,c+u-d-o,c+u-d-a):g<0&&(g=Math.max(g,c-a,c-o));var m=this.getIndex({startX:a+g,endX:o+g});(m.startIndex!==h||m.endIndex!==f)&&p&&p(m),this.setState({startX:a+g,endX:o+g,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,i){var s=sQ(i)?i.changedTouches[0]:i;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:s.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var i=this.state,s=i.brushMoveStartX,a=i.movingTravellerId,o=i.endX,l=i.startX,c=this.state[a],u=this.props,d=u.x,h=u.width,f=u.travellerWidth,p=u.onChange,g=u.gap,m=u.data,y={startX:this.state.startX,endX:this.state.endX},x=r.pageX-s;x>0?x=Math.min(x,d+h-f-c):x<0&&(x=Math.max(x,d-c)),y[a]=c+x;var b=this.getIndex(y),_=b.startIndex,T=b.endIndex,E=function(){var I=m.length-1;return a==="startX"&&(o>l?_%g===0:T%g===0)||o<l&&T===I||a==="endX"&&(o>l?T%g===0:_%g===0)||o>l&&T===I};this.setState($o($o({},a,c+x),"brushMoveStartX",r.pageX),function(){p&&E()&&p(b)})}},{key:"handleTravellerMoveKeyboard",value:function(r,i){var s=this,a=this.state,o=a.scaleValues,l=a.startX,c=a.endX,u=this.state[i],d=o.indexOf(u);if(d!==-1){var h=d+r;if(!(h===-1||h>=o.length)){var f=o[h];i==="startX"&&f>=c||i==="endX"&&f<=l||this.setState($o({},i,f),function(){s.props.onChange(s.getIndex({startX:s.state.startX,endX:s.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.fill,c=r.stroke;return le.createElement("rect",{stroke:c,fill:l,x:i,y:s,width:a,height:o})}},{key:"renderPanorama",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.data,c=r.children,u=r.padding,d=P.Children.only(c);return d?le.cloneElement(d,{x:i,y:s,width:a,height:o,margin:u,compact:!0,data:l}):null}},{key:"renderTravellerLayer",value:function(r,i){var s,a,o=this,l=this.props,c=l.y,u=l.travellerWidth,d=l.height,h=l.traveller,f=l.ariaLabel,p=l.data,g=l.startIndex,m=l.endIndex,y=Math.max(r,this.props.x),x=wL(wL({},Rn(this.props,!1)),{},{x:y,y:c,width:u,height:d}),b=f||"Min value: ".concat((s=p[g])===null||s===void 0?void 0:s.name,", Max value: ").concat((a=p[m])===null||a===void 0?void 0:a.name);return le.createElement(si,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[i],onTouchStart:this.travellerDragStartHandlers[i],onKeyDown:function(T){["ArrowLeft","ArrowRight"].includes(T.key)&&(T.preventDefault(),T.stopPropagation(),o.handleTravellerMoveKeyboard(T.key==="ArrowRight"?1:-1,i))},onFocus:function(){o.setState({isTravellerFocused:!0})},onBlur:function(){o.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},e.renderTraveller(h,x))}},{key:"renderSlide",value:function(r,i){var s=this.props,a=s.y,o=s.height,l=s.stroke,c=s.travellerWidth,u=Math.min(r,i)+c,d=Math.max(Math.abs(i-r)-c,0);return le.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:l,fillOpacity:.2,x:u,y:a,width:d,height:o})}},{key:"renderText",value:function(){var r=this.props,i=r.startIndex,s=r.endIndex,a=r.y,o=r.height,l=r.travellerWidth,c=r.stroke,u=this.state,d=u.startX,h=u.endX,f=5,p={pointerEvents:"none",fill:c};return le.createElement(si,{className:"recharts-brush-texts"},le.createElement(gI,zI({textAnchor:"end",verticalAnchor:"middle",x:Math.min(d,h)-f,y:a+o/2},p),this.getTextOfTick(i)),le.createElement(gI,zI({textAnchor:"start",verticalAnchor:"middle",x:Math.max(d,h)+l+f,y:a+o/2},p),this.getTextOfTick(s)))}},{key:"render",value:function(){var r=this.props,i=r.data,s=r.className,a=r.children,o=r.x,l=r.y,c=r.width,u=r.height,d=r.alwaysShowText,h=this.state,f=h.startX,p=h.endX,g=h.isTextActive,m=h.isSlideMoving,y=h.isTravellerMoving,x=h.isTravellerFocused;if(!i||!i.length||!tt(o)||!tt(l)||!tt(c)||!tt(u)||c<=0||u<=0)return null;var b=qn("recharts-brush",s),_=le.Children.count(a)===1,T=Emt("userSelect","none");return le.createElement(si,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:T},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(f,p),this.renderTravellerLayer(f,"startX"),this.renderTravellerLayer(p,"endX"),(g||m||y||x||d)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var i=r.x,s=r.y,a=r.width,o=r.height,l=r.stroke,c=Math.floor(s+o/2)-1;return le.createElement(le.Fragment,null,le.createElement("rect",{x:i,y:s,width:a,height:o,fill:l,stroke:"none"}),le.createElement("line",{x1:i+1,y1:c,x2:i+a-1,y2:c,fill:"none",stroke:"#fff"}),le.createElement("line",{x1:i+1,y1:c+2,x2:i+a-1,y2:c+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,i){var s;return le.isValidElement(r)?s=le.cloneElement(r,i):wn(r)?s=r(i):s=e.renderDefaultTraveller(i),s}},{key:"getDerivedStateFromProps",value:function(r,i){var s=r.data,a=r.width,o=r.x,l=r.travellerWidth,c=r.updateId,u=r.startIndex,d=r.endIndex;if(s!==i.prevData||c!==i.prevUpdateId)return wL({prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:a},s&&s.length?Pmt({data:s,width:a,x:o,travellerWidth:l,startIndex:u,endIndex:d}):{scale:null,scaleValues:null});if(i.scale&&(a!==i.prevWidth||o!==i.prevX||l!==i.prevTravellerWidth)){i.scale.range([o,o+a-l]);var h=i.scale.domain().map(function(f){return i.scale(f)});return{prevData:s,prevTravellerWidth:l,prevUpdateId:c,prevX:o,prevWidth:a,startX:i.scale(r.startIndex),endX:i.scale(r.endIndex),scaleValues:h}}return null}},{key:"getIndexInRange",value:function(r,i){for(var s=r.length,a=0,o=s-1;o-a>1;){var l=Math.floor((a+o)/2);r[l]>i?o=l:a=l}return i>=r[o]?o:a}}])}(P.PureComponent);$o(f0,"displayName","Brush");$o(f0,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var Omt=iH;function Dmt(t,e){var n;return Omt(t,function(r,i,s){return n=e(r,i,s),!n}),!!n}var $mt=Dmt,Lmt=Gde,Fmt=Sp,jmt=$mt,zmt=No,Bmt=fP;function Umt(t,e,n){var r=zmt(t)?Lmt:jmt;return n&&Bmt(t,e,n)&&(e=void 0),r(t,Fmt(e))}var Vmt=Umt;const Wmt=lr(Vmt);var Fu=function(e,n){var r=e.alwaysShow,i=e.ifOverflow;return r&&(i="extendDomain"),i===n},aQ=phe;function Hmt(t,e,n){e=="__proto__"&&aQ?aQ(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}var Gmt=Hmt,qmt=Gmt,Xmt=hhe,Kmt=Sp;function Ymt(t,e){var n={};return e=Kmt(e),Xmt(t,function(r,i,s){qmt(n,i,e(r,i,s))}),n}var Zmt=Ymt;const Qmt=lr(Zmt);function Jmt(t,e){for(var n=-1,r=t==null?0:t.length;++n<r;)if(!e(t[n],n,t))return!1;return!0}var egt=Jmt,tgt=iH;function ngt(t,e){var n=!0;return tgt(t,function(r,i,s){return n=!!e(r,i,s),n}),n}var rgt=ngt,igt=egt,sgt=rgt,agt=Sp,ogt=No,lgt=fP;function cgt(t,e,n){var r=ogt(t)?igt:sgt;return n&&lgt(t,e,n)&&(e=void 0),r(t,agt(e))}var ugt=cgt;const Gfe=lr(ugt);var dgt=["x","y"];function LS(t){"@babel/helpers - typeof";return LS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},LS(t)}function $z(){return $z=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},$z.apply(this,arguments)}function oQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function xw(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?oQ(Object(n),!0).forEach(function(r){hgt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):oQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function hgt(t,e,n){return e=fgt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fgt(t){var e=pgt(t,"string");return LS(e)=="symbol"?e:e+""}function pgt(t,e){if(LS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(LS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mgt(t,e){if(t==null)return{};var n=ggt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function ggt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function ygt(t,e){var n=t.x,r=t.y,i=mgt(t,dgt),s="".concat(n),a=parseInt(s,10),o="".concat(r),l=parseInt(o,10),c="".concat(e.height||i.height),u=parseInt(c,10),d="".concat(e.width||i.width),h=parseInt(d,10);return xw(xw(xw(xw(xw({},e),i),a?{x:a}:{}),l?{y:l}:{}),{},{height:u,width:h,name:e.name,radius:e.radius})}function lQ(t){return le.createElement(Jpt,$z({shapeType:"rectangle",propTransformer:ygt,activeClassName:"recharts-active-bar"},t))}var vgt=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,i){if(typeof e=="number")return e;var s=typeof r=="number";return s?e(r,i):(s||Rg(),n)}},xgt=["value","background"],qfe;function p0(t){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p0(t)}function bgt(t,e){if(t==null)return{};var n=wgt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function wgt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function UI(){return UI=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},UI.apply(this,arguments)}function cQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function zi(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cQ(Object(n),!0).forEach(function(r){xf(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Sgt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function uQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Kfe(r.key),r)}}function _gt(t,e,n){return e&&uQ(t.prototype,e),n&&uQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tgt(t,e,n){return e=VI(e),Egt(t,Xfe()?Reflect.construct(e,n||[],VI(t).constructor):e.apply(t,n))}function Egt(t,e){if(e&&(p0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Cgt(t)}function Cgt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Xfe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Xfe=function(){return!!t})()}function VI(t){return VI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},VI(t)}function Ngt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Lz(t,e)}function Lz(t,e){return Lz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Lz(t,e)}function xf(t,e,n){return e=Kfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kfe(t){var e=Agt(t,"string");return p0(e)=="symbol"?e:e+""}function Agt(t,e){if(p0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(p0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var aE=function(t){function e(){var n;Sgt(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=Tgt(this,e,[].concat(i)),xf(n,"state",{isAnimationFinished:!1}),xf(n,"id",eE("recharts-bar-")),xf(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),a&&a()}),xf(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),a&&a()}),n}return Ngt(e,t),_gt(e,[{key:"renderRectanglesStatically",value:function(r){var i=this,s=this.props,a=s.shape,o=s.dataKey,l=s.activeIndex,c=s.activeBar,u=Rn(this.props,!1);return r&&r.map(function(d,h){var f=h===l,p=f?c:a,g=zi(zi(zi({},u),d),{},{isActive:f,option:p,index:h,dataKey:o,onAnimationStart:i.handleAnimationStart,onAnimationEnd:i.handleAnimationEnd});return le.createElement(si,UI({className:"recharts-bar-rectangle"},nI(i.props,d,h),{key:"rectangle-".concat(d==null?void 0:d.x,"-").concat(d==null?void 0:d.y,"-").concat(d==null?void 0:d.value,"-").concat(h)}),le.createElement(lQ,g))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,i=this.props,s=i.data,a=i.layout,o=i.isAnimationActive,l=i.animationBegin,c=i.animationDuration,u=i.animationEasing,d=i.animationId,h=this.state.prevData;return le.createElement(ch,{begin:l,duration:c,isActive:o,easing:u,from:{t:0},to:{t:1},key:"bar-".concat(d),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(f){var p=f.t,g=s.map(function(m,y){var x=h&&h[y];if(x){var b=Al(x.x,m.x),_=Al(x.y,m.y),T=Al(x.width,m.width),E=Al(x.height,m.height);return zi(zi({},m),{},{x:b(p),y:_(p),width:T(p),height:E(p)})}if(a==="horizontal"){var C=Al(0,m.height),I=C(p);return zi(zi({},m),{},{y:m.y+m.height-I,height:I})}var A=Al(0,m.width),k=A(p);return zi(zi({},m),{},{width:k})});return le.createElement(si,null,r.renderRectanglesStatically(g))})}},{key:"renderRectangles",value:function(){var r=this.props,i=r.data,s=r.isAnimationActive,a=this.state.prevData;return s&&i&&i.length&&(!a||!vS(a,i))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(i)}},{key:"renderBackground",value:function(){var r=this,i=this.props,s=i.data,a=i.dataKey,o=i.activeIndex,l=Rn(this.props.background,!1);return s.map(function(c,u){c.value;var d=c.background,h=bgt(c,xgt);if(!d)return null;var f=zi(zi(zi(zi(zi({},h),{},{fill:"#eee"},d),l),nI(r.props,c,u)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:a,index:u,className:"recharts-bar-background-rectangle"});return le.createElement(lQ,UI({key:"background-bar-".concat(u),option:r.props.background,isActive:u===o},f))})}},{key:"renderErrorBar",value:function(r,i){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var s=this.props,a=s.data,o=s.xAxis,l=s.yAxis,c=s.layout,u=s.children,d=jc(u,_P);if(!d)return null;var h=c==="vertical"?a[0].height/2:a[0].width/2,f=function(m,y){var x=Array.isArray(m.value)?m.value[1]:m.value;return{x:m.x,y:m.y,value:x,errorVal:nl(m,y)}},p={clipPath:r?"url(#clipPath-".concat(i,")"):null};return le.createElement(si,p,d.map(function(g){return le.cloneElement(g,{key:"error-bar-".concat(i,"-").concat(g.props.dataKey),data:a,xAxis:o,yAxis:l,layout:c,offset:h,dataPointFormatter:f})}))}},{key:"render",value:function(){var r=this.props,i=r.hide,s=r.data,a=r.className,o=r.xAxis,l=r.yAxis,c=r.left,u=r.top,d=r.width,h=r.height,f=r.isAnimationActive,p=r.background,g=r.id;if(i||!s||!s.length)return null;var m=this.state.isAnimationFinished,y=qn("recharts-bar",a),x=o&&o.allowDataOverflow,b=l&&l.allowDataOverflow,_=x||b,T=Un(g)?this.id:g;return le.createElement(si,{className:y},x||b?le.createElement("defs",null,le.createElement("clipPath",{id:"clipPath-".concat(T)},le.createElement("rect",{x:x?c:c-d/2,y:b?u:u-h/2,width:x?d:d*2,height:b?h:h*2}))):null,le.createElement(si,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(T,")"):null},p?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,T),(!f||m)&&Rf.renderCallByParent(this.props,s))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:i.curData}:r.data!==i.curData?{curData:r.data}:null}}])}(P.PureComponent);qfe=aE;xf(aE,"displayName","Bar");xf(aE,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!yb.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});xf(aE,"getComposedData",function(t){var e=t.props,n=t.item,r=t.barPosition,i=t.bandSize,s=t.xAxis,a=t.yAxis,o=t.xAxisTicks,l=t.yAxisTicks,c=t.stackedData,u=t.dataStartIndex,d=t.displayedData,h=t.offset,f=rdt(r,n);if(!f)return null;var p=e.layout,g=n.type.defaultProps,m=g!==void 0?zi(zi({},g),n.props):n.props,y=m.dataKey,x=m.children,b=m.minPointSize,_=p==="horizontal"?a:s,T=c?_.scale.domain():null,E=ddt({numericAxis:_}),C=jc(x,whe),I=d.map(function(A,k){var R,$,z,O,j,B;c?R=idt(c[u+k],T):(R=nl(A,y),Array.isArray(R)||(R=[E,R]));var W=vgt(b,qfe.defaultProps.minPointSize)(R[1],k);if(p==="horizontal"){var L,V=[a.scale(R[0]),a.scale(R[1])],H=V[0],K=V[1];$=uZ({axis:s,ticks:o,bandSize:i,offset:f.offset,entry:A,index:k}),z=(L=K??H)!==null&&L!==void 0?L:void 0,O=f.size;var te=H-K;if(j=Number.isNaN(te)?0:te,B={x:$,y:a.y,width:O,height:a.height},Math.abs(W)>0&&Math.abs(j)<Math.abs(W)){var J=Mc(j||W)*(Math.abs(W)-Math.abs(j));z-=J,j+=J}}else{var oe=[s.scale(R[0]),s.scale(R[1])],fe=oe[0],Ee=oe[1];if($=fe,z=uZ({axis:a,ticks:l,bandSize:i,offset:f.offset,entry:A,index:k}),O=Ee-fe,j=f.size,B={x:s.x,y:z,width:s.width,height:j},Math.abs(W)>0&&Math.abs(O)<Math.abs(W)){var me=Mc(O||W)*(Math.abs(W)-Math.abs(O));O+=me}}return zi(zi(zi({},A),{},{x:$,y:z,width:O,height:j,value:c?R:R[1],payload:A,background:B},C&&C[k]&&C[k].props),{},{tooltipPayload:[Nfe(n,A)],tooltipPosition:{x:$+O/2,y:z+j/2}})});return zi({data:I,layout:p},h)});function FS(t){"@babel/helpers - typeof";return FS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},FS(t)}function Igt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function dQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Yfe(r.key),r)}}function kgt(t,e,n){return e&&dQ(t.prototype,e),n&&dQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function hQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function xc(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?hQ(Object(n),!0).forEach(function(r){CP(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function CP(t,e,n){return e=Yfe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yfe(t){var e=Mgt(t,"string");return FS(e)=="symbol"?e:e+""}function Mgt(t,e){if(FS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(FS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Rgt=function(e,n,r,i,s){var a=e.width,o=e.height,l=e.layout,c=e.children,u=Object.keys(n),d={left:r.left,leftMirror:r.left,right:a-r.right,rightMirror:a-r.right,top:r.top,topMirror:r.top,bottom:o-r.bottom,bottomMirror:o-r.bottom},h=!!jo(c,aE);return u.reduce(function(f,p){var g=n[p],m=g.orientation,y=g.domain,x=g.padding,b=x===void 0?{}:x,_=g.mirror,T=g.reversed,E="".concat(m).concat(_?"Mirror":""),C,I,A,k,R;if(g.type==="number"&&(g.padding==="gap"||g.padding==="no-gap")){var $=y[1]-y[0],z=1/0,O=g.categoricalDomain.sort(OKe);if(O.forEach(function(oe,fe){fe>0&&(z=Math.min((oe||0)-(O[fe-1]||0),z))}),Number.isFinite(z)){var j=z/$,B=g.layout==="vertical"?r.height:r.width;if(g.padding==="gap"&&(C=j*B/2),g.padding==="no-gap"){var W=kg(e.barCategoryGap,j*B),L=j*B/2;C=L-W-(L-W)/B*W}}}i==="xAxis"?I=[r.left+(b.left||0)+(C||0),r.left+r.width-(b.right||0)-(C||0)]:i==="yAxis"?I=l==="horizontal"?[r.top+r.height-(b.bottom||0),r.top+(b.top||0)]:[r.top+(b.top||0)+(C||0),r.top+r.height-(b.bottom||0)-(C||0)]:I=g.range,T&&(I=[I[1],I[0]]);var V=tdt(g,s,h),H=V.scale,K=V.realScaleType;H.domain(y).range(I),ndt(H);var te=udt(H,xc(xc({},g),{},{realScaleType:K}));i==="xAxis"?(R=m==="top"&&!_||m==="bottom"&&_,A=r.left,k=d[E]-R*g.height):i==="yAxis"&&(R=m==="left"&&!_||m==="right"&&_,A=d[E]-R*g.width,k=r.top);var J=xc(xc(xc({},g),te),{},{realScaleType:K,x:A,y:k,scale:H,width:i==="xAxis"?r.width:g.width,height:i==="yAxis"?r.height:g.height});return J.bandSize=kI(J,te),!g.hide&&i==="xAxis"?d[E]+=(R?-1:1)*J.height:g.hide||(d[E]+=(R?-1:1)*J.width),xc(xc({},f),{},CP({},p,J))},{})},Zfe=function(e,n){var r=e.x,i=e.y,s=n.x,a=n.y;return{x:Math.min(r,s),y:Math.min(i,a),width:Math.abs(s-r),height:Math.abs(a-i)}},Pgt=function(e){var n=e.x1,r=e.y1,i=e.x2,s=e.y2;return Zfe({x:n,y:r},{x:i,y:s})},Qfe=function(){function t(e){Igt(this,t),this.scale=e}return kgt(t,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=r.bandAware,s=r.position;if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+a}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(n)+o}default:return this.scale(n)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),i=r[0],s=r[r.length-1];return i<=s?n>=i&&n<=s:n>=s&&n<=i}}],[{key:"create",value:function(n){return new t(n)}}])}();CP(Qfe,"EPS",1e-4);var OH=function(e){var n=Object.keys(e).reduce(function(r,i){return xc(xc({},r),{},CP({},i,Qfe.create(e[i])))},{});return xc(xc({},n),{},{apply:function(i){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=s.bandAware,o=s.position;return Qmt(i,function(l,c){return n[c].apply(l,{bandAware:a,position:o})})},isInRange:function(i){return Gfe(i,function(s,a){return n[a].isInRange(s)})}})};function Ogt(t){return(t%180+180)%180}var Dgt=function(e){var n=e.width,r=e.height,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=Ogt(i),a=s*Math.PI/180,o=Math.atan(r/n),l=a>o&&a<Math.PI-o?r/Math.sin(a):n/Math.cos(a);return Math.abs(l)},$gt=Sp,Lgt=tE,Fgt=dP;function jgt(t){return function(e,n,r){var i=Object(e);if(!Lgt(e)){var s=$gt(n);e=Fgt(e),n=function(o){return s(i[o],o,i)}}var a=t(e,n,r);return a>-1?i[s?e[a]:a]:void 0}}var zgt=jgt,Bgt=Ufe;function Ugt(t){var e=Bgt(t),n=e%1;return e===e?n?e-n:e:0}var Vgt=Ugt,Wgt=ahe,Hgt=Sp,Ggt=Vgt,qgt=Math.max;function Xgt(t,e,n){var r=t==null?0:t.length;if(!r)return-1;var i=n==null?0:Ggt(n);return i<0&&(i=qgt(r+i,0)),Wgt(t,Hgt(e),i)}var Kgt=Xgt,Ygt=zgt,Zgt=Kgt,Qgt=Ygt(Zgt),Jgt=Qgt;const eyt=lr(Jgt);var tyt=FXe(function(t){return{x:t.left,y:t.top,width:t.width,height:t.height}},function(t){return["l",t.left,"t",t.top,"w",t.width,"h",t.height].join("")}),DH=P.createContext(void 0),$H=P.createContext(void 0),Jfe=P.createContext(void 0),epe=P.createContext({}),tpe=P.createContext(void 0),npe=P.createContext(0),rpe=P.createContext(0),fQ=function(e){var n=e.state,r=n.xAxisMap,i=n.yAxisMap,s=n.offset,a=e.clipPathId,o=e.children,l=e.width,c=e.height,u=tyt(s);return le.createElement(DH.Provider,{value:r},le.createElement($H.Provider,{value:i},le.createElement(epe.Provider,{value:s},le.createElement(Jfe.Provider,{value:u},le.createElement(tpe.Provider,{value:a},le.createElement(npe.Provider,{value:c},le.createElement(rpe.Provider,{value:l},o)))))))},nyt=function(){return P.useContext(tpe)},ipe=function(e){var n=P.useContext(DH);n==null&&Rg();var r=n[e];return r==null&&Rg(),r},ryt=function(){var e=P.useContext(DH);return tf(e)},iyt=function(){var e=P.useContext($H),n=eyt(e,function(r){return Gfe(r.domain,Number.isFinite)});return n||tf(e)},spe=function(e){var n=P.useContext($H);n==null&&Rg();var r=n[e];return r==null&&Rg(),r},syt=function(){var e=P.useContext(Jfe);return e},ayt=function(){return P.useContext(epe)},LH=function(){return P.useContext(rpe)},FH=function(){return P.useContext(npe)};function m0(t){"@babel/helpers - typeof";return m0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m0(t)}function oyt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function lyt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ope(r.key),r)}}function cyt(t,e,n){return e&&lyt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function uyt(t,e,n){return e=WI(e),dyt(t,ape()?Reflect.construct(e,n||[],WI(t).constructor):e.apply(t,n))}function dyt(t,e){if(e&&(m0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return hyt(t)}function hyt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ape(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ape=function(){return!!t})()}function WI(t){return WI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},WI(t)}function fyt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fz(t,e)}function Fz(t,e){return Fz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Fz(t,e)}function pQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function mQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pQ(Object(n),!0).forEach(function(r){jH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):pQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function jH(t,e,n){return e=ope(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ope(t){var e=pyt(t,"string");return m0(e)=="symbol"?e:e+""}function pyt(t,e){if(m0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(m0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function myt(t,e){return xyt(t)||vyt(t,e)||yyt(t,e)||gyt()}function gyt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yyt(t,e){if(t){if(typeof t=="string")return gQ(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gQ(t,e)}}function gQ(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function vyt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function xyt(t){if(Array.isArray(t))return t}function jz(){return jz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},jz.apply(this,arguments)}var byt=function(e,n){var r;return le.isValidElement(e)?r=le.cloneElement(e,n):wn(e)?r=e(n):r=le.createElement("line",jz({},n,{className:"recharts-reference-line-line"})),r},wyt=function(e,n,r,i,s,a,o,l,c){var u=s.x,d=s.y,h=s.width,f=s.height;if(r){var p=c.y,g=e.y.apply(p,{position:a});if(Fu(c,"discard")&&!e.y.isInRange(g))return null;var m=[{x:u+h,y:g},{x:u,y:g}];return l==="left"?m.reverse():m}if(n){var y=c.x,x=e.x.apply(y,{position:a});if(Fu(c,"discard")&&!e.x.isInRange(x))return null;var b=[{x,y:d+f},{x,y:d}];return o==="top"?b.reverse():b}if(i){var _=c.segment,T=_.map(function(E){return e.apply(E,{position:a})});return Fu(c,"discard")&&Wmt(T,function(E){return!e.isInRange(E)})?null:T}return null};function Syt(t){var e=t.x,n=t.y,r=t.segment,i=t.xAxisId,s=t.yAxisId,a=t.shape,o=t.className,l=t.alwaysShow,c=nyt(),u=ipe(i),d=spe(s),h=syt();if(!c||!h)return null;Gd(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var f=OH({x:u.scale,y:d.scale}),p=os(e),g=os(n),m=r&&r.length===2,y=wyt(f,p,g,m,h,t.position,u.orientation,d.orientation,t);if(!y)return null;var x=myt(y,2),b=x[0],_=b.x,T=b.y,E=x[1],C=E.x,I=E.y,A=Fu(t,"hidden")?"url(#".concat(c,")"):void 0,k=mQ(mQ({clipPath:A},Rn(t,!0)),{},{x1:_,y1:T,x2:C,y2:I});return le.createElement(si,{className:qn("recharts-reference-line",o)},byt(a,k),da.renderCallByParent(t,Pgt({x1:_,y1:T,x2:C,y2:I})))}var zH=function(t){function e(){return oyt(this,e),uyt(this,e,arguments)}return fyt(e,t),cyt(e,[{key:"render",value:function(){return le.createElement(Syt,this.props)}}])}(le.Component);jH(zH,"displayName","ReferenceLine");jH(zH,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function zz(){return zz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zz.apply(this,arguments)}function g0(t){"@babel/helpers - typeof";return g0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g0(t)}function yQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function vQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yQ(Object(n),!0).forEach(function(r){NP(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _yt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Tyt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,cpe(r.key),r)}}function Eyt(t,e,n){return e&&Tyt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Cyt(t,e,n){return e=HI(e),Nyt(t,lpe()?Reflect.construct(e,n||[],HI(t).constructor):e.apply(t,n))}function Nyt(t,e){if(e&&(g0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ayt(t)}function Ayt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function lpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lpe=function(){return!!t})()}function HI(t){return HI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},HI(t)}function Iyt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bz(t,e)}function Bz(t,e){return Bz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Bz(t,e)}function NP(t,e,n){return e=cpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cpe(t){var e=kyt(t,"string");return g0(e)=="symbol"?e:e+""}function kyt(t,e){if(g0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(g0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Myt=function(e){var n=e.x,r=e.y,i=e.xAxis,s=e.yAxis,a=OH({x:i.scale,y:s.scale}),o=a.apply({x:n,y:r},{bandAware:!0});return Fu(e,"discard")&&!a.isInRange(o)?null:o},AP=function(t){function e(){return _yt(this,e),Cyt(this,e,arguments)}return Iyt(e,t),Eyt(e,[{key:"render",value:function(){var r=this.props,i=r.x,s=r.y,a=r.r,o=r.alwaysShow,l=r.clipPathId,c=os(i),u=os(s);if(Gd(o===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!c||!u)return null;var d=Myt(this.props);if(!d)return null;var h=d.x,f=d.y,p=this.props,g=p.shape,m=p.className,y=Fu(this.props,"hidden")?"url(#".concat(l,")"):void 0,x=vQ(vQ({clipPath:y},Rn(this.props,!0)),{},{cx:h,cy:f});return le.createElement(si,{className:qn("recharts-reference-dot",m)},e.renderDot(g,x),da.renderCallByParent(this.props,{x:h-a,y:f-a,width:2*a,height:2*a}))}}])}(le.Component);NP(AP,"displayName","ReferenceDot");NP(AP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});NP(AP,"renderDot",function(t,e){var n;return le.isValidElement(t)?n=le.cloneElement(t,e):wn(t)?n=t(e):n=le.createElement(PH,zz({},e,{cx:e.cx,cy:e.cy,className:"recharts-reference-dot-dot"})),n});function Uz(){return Uz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Uz.apply(this,arguments)}function y0(t){"@babel/helpers - typeof";return y0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y0(t)}function xQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function bQ(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xQ(Object(n),!0).forEach(function(r){IP(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Ryt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Pyt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dpe(r.key),r)}}function Oyt(t,e,n){return e&&Pyt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Dyt(t,e,n){return e=GI(e),$yt(t,upe()?Reflect.construct(e,n||[],GI(t).constructor):e.apply(t,n))}function $yt(t,e){if(e&&(y0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lyt(t)}function Lyt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function upe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(upe=function(){return!!t})()}function GI(t){return GI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},GI(t)}function Fyt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Vz(t,e)}function Vz(t,e){return Vz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Vz(t,e)}function IP(t,e,n){return e=dpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dpe(t){var e=jyt(t,"string");return y0(e)=="symbol"?e:e+""}function jyt(t,e){if(y0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(y0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var zyt=function(e,n,r,i,s){var a=s.x1,o=s.x2,l=s.y1,c=s.y2,u=s.xAxis,d=s.yAxis;if(!u||!d)return null;var h=OH({x:u.scale,y:d.scale}),f={x:e?h.x.apply(a,{position:"start"}):h.x.rangeMin,y:r?h.y.apply(l,{position:"start"}):h.y.rangeMin},p={x:n?h.x.apply(o,{position:"end"}):h.x.rangeMax,y:i?h.y.apply(c,{position:"end"}):h.y.rangeMax};return Fu(s,"discard")&&(!h.isInRange(f)||!h.isInRange(p))?null:Zfe(f,p)},kP=function(t){function e(){return Ryt(this,e),Dyt(this,e,arguments)}return Fyt(e,t),Oyt(e,[{key:"render",value:function(){var r=this.props,i=r.x1,s=r.x2,a=r.y1,o=r.y2,l=r.className,c=r.alwaysShow,u=r.clipPathId;Gd(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var d=os(i),h=os(s),f=os(a),p=os(o),g=this.props.shape;if(!d&&!h&&!f&&!p&&!g)return null;var m=zyt(d,h,f,p,this.props);if(!m&&!g)return null;var y=Fu(this.props,"hidden")?"url(#".concat(u,")"):void 0;return le.createElement(si,{className:qn("recharts-reference-area",l)},e.renderRect(g,bQ(bQ({clipPath:y},Rn(this.props,!0)),m)),da.renderCallByParent(this.props,m))}}])}(le.Component);IP(kP,"displayName","ReferenceArea");IP(kP,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});IP(kP,"renderRect",function(t,e){var n;return le.isValidElement(t)?n=le.cloneElement(t,e):wn(t)?n=t(e):n=le.createElement(RH,Uz({},e,{className:"recharts-reference-area-rect"})),n});function hpe(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var r=[],i=0;i<t.length;i+=e)r.push(t[i]);return r}function Byt(t,e,n){var r={width:t.width+e.width,height:t.height+e.height};return Dgt(r,n)}function Uyt(t,e,n){var r=n==="width",i=t.x,s=t.y,a=t.width,o=t.height;return e===1?{start:r?i:s,end:r?i+a:s+o}:{start:r?i+a:s+o,end:r?i:s}}function qI(t,e,n,r,i){if(t*e<t*r||t*e>t*i)return!1;var s=n();return t*(e-t*s/2-r)>=0&&t*(e+t*s/2-i)<=0}function Vyt(t,e){return hpe(t,e+1)}function Wyt(t,e,n,r,i){for(var s=(r||[]).slice(),a=e.start,o=e.end,l=0,c=1,u=a,d=function(){var p=r==null?void 0:r[l];if(p===void 0)return{v:hpe(r,c)};var g=l,m,y=function(){return m===void 0&&(m=n(p,g)),m},x=p.coordinate,b=l===0||qI(t,x,y,u,o);b||(l=0,u=a,c+=1),b&&(u=x+t*(y()/2+i),l+=c)},h;c<=s.length;)if(h=d(),h)return h.v;return[]}function jS(t){"@babel/helpers - typeof";return jS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},jS(t)}function wQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function oa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?wQ(Object(n),!0).forEach(function(r){Hyt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):wQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Hyt(t,e,n){return e=Gyt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gyt(t){var e=qyt(t,"string");return jS(e)=="symbol"?e:e+""}function qyt(t,e){if(jS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(jS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Xyt(t,e,n,r,i){for(var s=(r||[]).slice(),a=s.length,o=e.start,l=e.end,c=function(h){var f=s[h],p,g=function(){return p===void 0&&(p=n(f,h)),p};if(h===a-1){var m=t*(f.coordinate+t*g()/2-l);s[h]=f=oa(oa({},f),{},{tickCoord:m>0?f.coordinate-m*t:f.coordinate})}else s[h]=f=oa(oa({},f),{},{tickCoord:f.coordinate});var y=qI(t,f.tickCoord,g,o,l);y&&(l=f.tickCoord-t*(g()/2+i),s[h]=oa(oa({},f),{},{isShow:!0}))},u=a-1;u>=0;u--)c(u);return s}function Kyt(t,e,n,r,i,s){var a=(r||[]).slice(),o=a.length,l=e.start,c=e.end;if(s){var u=r[o-1],d=n(u,o-1),h=t*(u.coordinate+t*d/2-c);a[o-1]=u=oa(oa({},u),{},{tickCoord:h>0?u.coordinate-h*t:u.coordinate});var f=qI(t,u.tickCoord,function(){return d},l,c);f&&(c=u.tickCoord-t*(d/2+i),a[o-1]=oa(oa({},u),{},{isShow:!0}))}for(var p=s?o-1:o,g=function(x){var b=a[x],_,T=function(){return _===void 0&&(_=n(b,x)),_};if(x===0){var E=t*(b.coordinate-t*T()/2-l);a[x]=b=oa(oa({},b),{},{tickCoord:E<0?b.coordinate-E*t:b.coordinate})}else a[x]=b=oa(oa({},b),{},{tickCoord:b.coordinate});var C=qI(t,b.tickCoord,T,l,c);C&&(l=b.tickCoord+t*(T()/2+i),a[x]=oa(oa({},b),{},{isShow:!0}))},m=0;m<p;m++)g(m);return a}function BH(t,e,n){var r=t.tick,i=t.ticks,s=t.viewBox,a=t.minTickGap,o=t.orientation,l=t.interval,c=t.tickFormatter,u=t.unit,d=t.angle;if(!i||!i.length||!r)return[];if(tt(l)||yb.isSsr)return Vyt(i,typeof l=="number"&&tt(l)?l:0);var h=[],f=o==="top"||o==="bottom"?"width":"height",p=u&&f==="width"?d1(u,{fontSize:e,letterSpacing:n}):{width:0,height:0},g=function(b,_){var T=wn(c)?c(b.value,_):b.value;return f==="width"?Byt(d1(T,{fontSize:e,letterSpacing:n}),p,d):d1(T,{fontSize:e,letterSpacing:n})[f]},m=i.length>=2?Mc(i[1].coordinate-i[0].coordinate):1,y=Uyt(s,m,f);return l==="equidistantPreserveStart"?Wyt(m,y,g,i,a):(l==="preserveStart"||l==="preserveStartEnd"?h=Kyt(m,y,g,i,a,l==="preserveStartEnd"):h=Xyt(m,y,g,i,a),h.filter(function(x){return x.isShow}))}var Yyt=["viewBox"],Zyt=["viewBox"],Qyt=["ticks"];function v0(t){"@babel/helpers - typeof";return v0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v0(t)}function Ov(){return Ov=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Ov.apply(this,arguments)}function SQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ca(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?SQ(Object(n),!0).forEach(function(r){UH(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):SQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function SL(t,e){if(t==null)return{};var n=Jyt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Jyt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function evt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _Q(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ppe(r.key),r)}}function tvt(t,e,n){return e&&_Q(t.prototype,e),n&&_Q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function nvt(t,e,n){return e=XI(e),rvt(t,fpe()?Reflect.construct(e,n||[],XI(t).constructor):e.apply(t,n))}function rvt(t,e){if(e&&(v0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ivt(t)}function ivt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function fpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(fpe=function(){return!!t})()}function XI(t){return XI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},XI(t)}function svt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wz(t,e)}function Wz(t,e){return Wz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Wz(t,e)}function UH(t,e,n){return e=ppe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ppe(t){var e=avt(t,"string");return v0(e)=="symbol"?e:e+""}function avt(t,e){if(v0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(v0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var wb=function(t){function e(n){var r;return evt(this,e),r=nvt(this,e,[n]),r.state={fontSize:"",letterSpacing:""},r}return svt(e,t),tvt(e,[{key:"shouldComponentUpdate",value:function(r,i){var s=r.viewBox,a=SL(r,Yyt),o=this.props,l=o.viewBox,c=SL(o,Zyt);return!ax(s,l)||!ax(a,c)||!ax(i,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var i=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];i&&this.setState({fontSize:window.getComputedStyle(i).fontSize,letterSpacing:window.getComputedStyle(i).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var i=this.props,s=i.x,a=i.y,o=i.width,l=i.height,c=i.orientation,u=i.tickSize,d=i.mirror,h=i.tickMargin,f,p,g,m,y,x,b=d?-1:1,_=r.tickSize||u,T=tt(r.tickCoord)?r.tickCoord:r.coordinate;switch(c){case"top":f=p=r.coordinate,m=a+ +!d*l,g=m-b*_,x=g-b*h,y=T;break;case"left":g=m=r.coordinate,p=s+ +!d*o,f=p-b*_,y=f-b*h,x=T;break;case"right":g=m=r.coordinate,p=s+ +d*o,f=p+b*_,y=f+b*h,x=T;break;default:f=p=r.coordinate,m=a+ +d*l,g=m+b*_,x=g+b*h,y=T;break}return{line:{x1:f,y1:g,x2:p,y2:m},tick:{x:y,y:x}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,i=r.orientation,s=r.mirror,a;switch(i){case"left":a=s?"start":"end";break;case"right":a=s?"end":"start";break;default:a="middle";break}return a}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,i=r.orientation,s=r.mirror,a="end";switch(i){case"left":case"right":a="middle";break;case"top":a=s?"start":"end";break;default:a=s?"end":"start";break}return a}},{key:"renderAxisLine",value:function(){var r=this.props,i=r.x,s=r.y,a=r.width,o=r.height,l=r.orientation,c=r.mirror,u=r.axisLine,d=Ca(Ca(Ca({},Rn(this.props,!1)),Rn(u,!1)),{},{fill:"none"});if(l==="top"||l==="bottom"){var h=+(l==="top"&&!c||l==="bottom"&&c);d=Ca(Ca({},d),{},{x1:i,y1:s+h*o,x2:i+a,y2:s+h*o})}else{var f=+(l==="left"&&!c||l==="right"&&c);d=Ca(Ca({},d),{},{x1:i+f*a,y1:s,x2:i+f*a,y2:s+o})}return le.createElement("line",Ov({},d,{className:qn("recharts-cartesian-axis-line",Vl(u,"className"))}))}},{key:"renderTicks",value:function(r,i,s){var a=this,o=this.props,l=o.tickLine,c=o.stroke,u=o.tick,d=o.tickFormatter,h=o.unit,f=BH(Ca(Ca({},this.props),{},{ticks:r}),i,s),p=this.getTickTextAnchor(),g=this.getTickVerticalAnchor(),m=Rn(this.props,!1),y=Rn(u,!1),x=Ca(Ca({},m),{},{fill:"none"},Rn(l,!1)),b=f.map(function(_,T){var E=a.getTickLineCoord(_),C=E.line,I=E.tick,A=Ca(Ca(Ca(Ca({textAnchor:p,verticalAnchor:g},m),{},{stroke:"none",fill:c},y),I),{},{index:T,payload:_,visibleTicksCount:f.length,tickFormatter:d});return le.createElement(si,Ov({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},nI(a.props,_,T)),l&&le.createElement("line",Ov({},x,C,{className:qn("recharts-cartesian-axis-tick-line",Vl(l,"className"))})),u&&e.renderTickItem(u,A,"".concat(wn(d)?d(_.value,T):_.value).concat(h||"")))});return le.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var r=this,i=this.props,s=i.axisLine,a=i.width,o=i.height,l=i.ticksGenerator,c=i.className,u=i.hide;if(u)return null;var d=this.props,h=d.ticks,f=SL(d,Qyt),p=h;return wn(l)&&(p=h&&h.length>0?l(this.props):l(f)),a<=0||o<=0||!p||!p.length?null:le.createElement(si,{className:qn("recharts-cartesian-axis",c),ref:function(m){r.layerReference=m}},s&&this.renderAxisLine(),this.renderTicks(p,this.state.fontSize,this.state.letterSpacing),da.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,i,s){var a;return le.isValidElement(r)?a=le.cloneElement(r,i):wn(r)?a=r(i):a=le.createElement(gI,Ov({},i,{className:"recharts-cartesian-axis-tick-value"}),s),a}}])}(P.Component);UH(wb,"displayName","CartesianAxis");UH(wb,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var ovt=["x1","y1","x2","y2","key"],lvt=["offset"];function Pg(t){"@babel/helpers - typeof";return Pg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pg(t)}function TQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function ha(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?TQ(Object(n),!0).forEach(function(r){cvt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):TQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function cvt(t,e,n){return e=uvt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uvt(t){var e=dvt(t,"string");return Pg(e)=="symbol"?e:e+""}function dvt(t,e){if(Pg(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Pg(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rm(){return Rm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Rm.apply(this,arguments)}function EQ(t,e){if(t==null)return{};var n=hvt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function hvt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}var fvt=function(e){var n=e.fill;if(!n||n==="none")return null;var r=e.fillOpacity,i=e.x,s=e.y,a=e.width,o=e.height,l=e.ry;return le.createElement("rect",{x:i,y:s,ry:l,width:a,height:o,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function mpe(t,e){var n;if(le.isValidElement(t))n=le.cloneElement(t,e);else if(wn(t))n=t(e);else{var r=e.x1,i=e.y1,s=e.x2,a=e.y2,o=e.key,l=EQ(e,ovt),c=Rn(l,!1);c.offset;var u=EQ(c,lvt);n=le.createElement("line",Rm({},u,{x1:r,y1:i,x2:s,y2:a,fill:"none",key:o}))}return n}function pvt(t){var e=t.x,n=t.width,r=t.horizontal,i=r===void 0?!0:r,s=t.horizontalPoints;if(!i||!s||!s.length)return null;var a=s.map(function(o,l){var c=ha(ha({},t),{},{x1:e,y1:o,x2:e+n,y2:o,key:"line-".concat(l),index:l});return mpe(i,c)});return le.createElement("g",{className:"recharts-cartesian-grid-horizontal"},a)}function mvt(t){var e=t.y,n=t.height,r=t.vertical,i=r===void 0?!0:r,s=t.verticalPoints;if(!i||!s||!s.length)return null;var a=s.map(function(o,l){var c=ha(ha({},t),{},{x1:o,y1:e,x2:o,y2:e+n,key:"line-".concat(l),index:l});return mpe(i,c)});return le.createElement("g",{className:"recharts-cartesian-grid-vertical"},a)}function gvt(t){var e=t.horizontalFill,n=t.fillOpacity,r=t.x,i=t.y,s=t.width,a=t.height,o=t.horizontalPoints,l=t.horizontal,c=l===void 0?!0:l;if(!c||!e||!e.length)return null;var u=o.map(function(h){return Math.round(h+i-i)}).sort(function(h,f){return h-f});i!==u[0]&&u.unshift(0);var d=u.map(function(h,f){var p=!u[f+1],g=p?i+a-h:u[f+1]-h;if(g<=0)return null;var m=f%e.length;return le.createElement("rect",{key:"react-".concat(f),y:h,x:r,height:g,width:s,stroke:"none",fill:e[m],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},d)}function yvt(t){var e=t.vertical,n=e===void 0?!0:e,r=t.verticalFill,i=t.fillOpacity,s=t.x,a=t.y,o=t.width,l=t.height,c=t.verticalPoints;if(!n||!r||!r.length)return null;var u=c.map(function(h){return Math.round(h+s-s)}).sort(function(h,f){return h-f});s!==u[0]&&u.unshift(0);var d=u.map(function(h,f){var p=!u[f+1],g=p?s+o-h:u[f+1]-h;if(g<=0)return null;var m=f%r.length;return le.createElement("rect",{key:"react-".concat(f),x:h,y:a,width:g,height:l,stroke:"none",fill:r[m],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return le.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},d)}var vvt=function(e,n){var r=e.xAxis,i=e.width,s=e.height,a=e.offset;return Efe(BH(ha(ha(ha({},wb.defaultProps),r),{},{ticks:Ld(r,!0),viewBox:{x:0,y:0,width:i,height:s}})),a.left,a.left+a.width,n)},xvt=function(e,n){var r=e.yAxis,i=e.width,s=e.height,a=e.offset;return Efe(BH(ha(ha(ha({},wb.defaultProps),r),{},{ticks:Ld(r,!0),viewBox:{x:0,y:0,width:i,height:s}})),a.top,a.top+a.height,n)},zy={horizontal:!0,vertical:!0,stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function gpe(t){var e,n,r,i,s,a,o=LH(),l=FH(),c=ayt(),u=ha(ha({},t),{},{stroke:(e=t.stroke)!==null&&e!==void 0?e:zy.stroke,fill:(n=t.fill)!==null&&n!==void 0?n:zy.fill,horizontal:(r=t.horizontal)!==null&&r!==void 0?r:zy.horizontal,horizontalFill:(i=t.horizontalFill)!==null&&i!==void 0?i:zy.horizontalFill,vertical:(s=t.vertical)!==null&&s!==void 0?s:zy.vertical,verticalFill:(a=t.verticalFill)!==null&&a!==void 0?a:zy.verticalFill,x:tt(t.x)?t.x:c.left,y:tt(t.y)?t.y:c.top,width:tt(t.width)?t.width:c.width,height:tt(t.height)?t.height:c.height}),d=u.x,h=u.y,f=u.width,p=u.height,g=u.syncWithTicks,m=u.horizontalValues,y=u.verticalValues,x=ryt(),b=iyt();if(!tt(f)||f<=0||!tt(p)||p<=0||!tt(d)||d!==+d||!tt(h)||h!==+h)return null;var _=u.verticalCoordinatesGenerator||vvt,T=u.horizontalCoordinatesGenerator||xvt,E=u.horizontalPoints,C=u.verticalPoints;if((!E||!E.length)&&wn(T)){var I=m&&m.length,A=T({yAxis:b?ha(ha({},b),{},{ticks:I?m:b.ticks}):void 0,width:o,height:l,offset:c},I?!0:g);Gd(Array.isArray(A),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(Pg(A),"]")),Array.isArray(A)&&(E=A)}if((!C||!C.length)&&wn(_)){var k=y&&y.length,R=_({xAxis:x?ha(ha({},x),{},{ticks:k?y:x.ticks}):void 0,width:o,height:l,offset:c},k?!0:g);Gd(Array.isArray(R),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(Pg(R),"]")),Array.isArray(R)&&(C=R)}return le.createElement("g",{className:"recharts-cartesian-grid"},le.createElement(fvt,{fill:u.fill,fillOpacity:u.fillOpacity,x:u.x,y:u.y,width:u.width,height:u.height,ry:u.ry}),le.createElement(pvt,Rm({},u,{offset:c,horizontalPoints:E,xAxis:x,yAxis:b})),le.createElement(mvt,Rm({},u,{offset:c,verticalPoints:C,xAxis:x,yAxis:b})),le.createElement(gvt,Rm({},u,{horizontalPoints:E})),le.createElement(yvt,Rm({},u,{verticalPoints:C})))}gpe.displayName="CartesianGrid";var bvt=["layout","type","stroke","connectNulls","isRange","ref"],wvt=["key"],ype;function x0(t){"@babel/helpers - typeof";return x0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x0(t)}function vpe(t,e){if(t==null)return{};var n=Svt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function Svt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function Pm(){return Pm=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Pm.apply(this,arguments)}function CQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function qh(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?CQ(Object(n),!0).forEach(function(r){Iu(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):CQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function _vt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function NQ(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bpe(r.key),r)}}function Tvt(t,e,n){return e&&NQ(t.prototype,e),n&&NQ(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Evt(t,e,n){return e=KI(e),Cvt(t,xpe()?Reflect.construct(e,n||[],KI(t).constructor):e.apply(t,n))}function Cvt(t,e){if(e&&(x0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Nvt(t)}function Nvt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function xpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(xpe=function(){return!!t})()}function KI(t){return KI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},KI(t)}function Avt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Hz(t,e)}function Hz(t,e){return Hz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Hz(t,e)}function Iu(t,e,n){return e=bpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bpe(t){var e=Ivt(t,"string");return x0(e)=="symbol"?e:e+""}function Ivt(t,e){if(x0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(x0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var Cp=function(t){function e(){var n;_vt(this,e);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return n=Evt(this,e,[].concat(i)),Iu(n,"state",{isAnimationFinished:!0}),Iu(n,"id",eE("recharts-area-")),Iu(n,"handleAnimationEnd",function(){var a=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),wn(a)&&a()}),Iu(n,"handleAnimationStart",function(){var a=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),wn(a)&&a()}),n}return Avt(e,t),Tvt(e,[{key:"renderDots",value:function(r,i,s){var a=this.props.isAnimationActive,o=this.state.isAnimationFinished;if(a&&!o)return null;var l=this.props,c=l.dot,u=l.points,d=l.dataKey,h=Rn(this.props,!1),f=Rn(c,!0),p=u.map(function(m,y){var x=qh(qh(qh({key:"dot-".concat(y),r:3},h),f),{},{index:y,cx:m.x,cy:m.y,dataKey:d,value:m.value,payload:m.payload,points:u});return e.renderDotItem(c,x)}),g={clipPath:r?"url(#clipPath-".concat(i?"":"dots-").concat(s,")"):null};return le.createElement(si,Pm({className:"recharts-area-dots"},g),p)}},{key:"renderHorizontalRect",value:function(r){var i=this.props,s=i.baseLine,a=i.points,o=i.strokeWidth,l=a[0].x,c=a[a.length-1].x,u=r*Math.abs(l-c),d=vf(a.map(function(h){return h.y||0}));return tt(s)&&typeof s=="number"?d=Math.max(s,d):s&&Array.isArray(s)&&s.length&&(d=Math.max(vf(s.map(function(h){return h.y||0})),d)),tt(d)?le.createElement("rect",{x:l<c?l:l-u,y:0,width:u,height:Math.floor(d+(o?parseInt("".concat(o),10):1))}):null}},{key:"renderVerticalRect",value:function(r){var i=this.props,s=i.baseLine,a=i.points,o=i.strokeWidth,l=a[0].y,c=a[a.length-1].y,u=r*Math.abs(l-c),d=vf(a.map(function(h){return h.x||0}));return tt(s)&&typeof s=="number"?d=Math.max(s,d):s&&Array.isArray(s)&&s.length&&(d=Math.max(vf(s.map(function(h){return h.x||0})),d)),tt(d)?le.createElement("rect",{x:0,y:l<c?l:l-u,width:d+(o?parseInt("".concat(o),10):1),height:Math.floor(u)}):null}},{key:"renderClipRect",value:function(r){var i=this.props.layout;return i==="vertical"?this.renderVerticalRect(r):this.renderHorizontalRect(r)}},{key:"renderAreaStatically",value:function(r,i,s,a){var o=this.props,l=o.layout,c=o.type,u=o.stroke,d=o.connectNulls,h=o.isRange;o.ref;var f=vpe(o,bvt);return le.createElement(si,{clipPath:s?"url(#clipPath-".concat(a,")"):null},le.createElement(p1,Pm({},Rn(f,!0),{points:r,connectNulls:d,type:c,baseLine:i,layout:l,stroke:"none",className:"recharts-area-area"})),u!=="none"&&le.createElement(p1,Pm({},Rn(this.props,!1),{className:"recharts-area-curve",layout:l,type:c,connectNulls:d,fill:"none",points:r})),u!=="none"&&h&&le.createElement(p1,Pm({},Rn(this.props,!1),{className:"recharts-area-curve",layout:l,type:c,connectNulls:d,fill:"none",points:i})))}},{key:"renderAreaWithAnimation",value:function(r,i){var s=this,a=this.props,o=a.points,l=a.baseLine,c=a.isAnimationActive,u=a.animationBegin,d=a.animationDuration,h=a.animationEasing,f=a.animationId,p=this.state,g=p.prevPoints,m=p.prevBaseLine;return le.createElement(ch,{begin:u,duration:d,isActive:c,easing:h,from:{t:0},to:{t:1},key:"area-".concat(f),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(y){var x=y.t;if(g){var b=g.length/o.length,_=o.map(function(I,A){var k=Math.floor(A*b);if(g[k]){var R=g[k],$=Al(R.x,I.x),z=Al(R.y,I.y);return qh(qh({},I),{},{x:$(x),y:z(x)})}return I}),T;if(tt(l)&&typeof l=="number"){var E=Al(m,l);T=E(x)}else if(Un(l)||fb(l)){var C=Al(m,0);T=C(x)}else T=l.map(function(I,A){var k=Math.floor(A*b);if(m[k]){var R=m[k],$=Al(R.x,I.x),z=Al(R.y,I.y);return qh(qh({},I),{},{x:$(x),y:z(x)})}return I});return s.renderAreaStatically(_,T,r,i)}return le.createElement(si,null,le.createElement("defs",null,le.createElement("clipPath",{id:"animationClipPath-".concat(i)},s.renderClipRect(x))),le.createElement(si,{clipPath:"url(#animationClipPath-".concat(i,")")},s.renderAreaStatically(o,l,r,i)))})}},{key:"renderArea",value:function(r,i){var s=this.props,a=s.points,o=s.baseLine,l=s.isAnimationActive,c=this.state,u=c.prevPoints,d=c.prevBaseLine,h=c.totalLength;return l&&a&&a.length&&(!u&&h>0||!vS(u,a)||!vS(d,o))?this.renderAreaWithAnimation(r,i):this.renderAreaStatically(a,o,r,i)}},{key:"render",value:function(){var r,i=this.props,s=i.hide,a=i.dot,o=i.points,l=i.className,c=i.top,u=i.left,d=i.xAxis,h=i.yAxis,f=i.width,p=i.height,g=i.isAnimationActive,m=i.id;if(s||!o||!o.length)return null;var y=this.state.isAnimationFinished,x=o.length===1,b=qn("recharts-area",l),_=d&&d.allowDataOverflow,T=h&&h.allowDataOverflow,E=_||T,C=Un(m)?this.id:m,I=(r=Rn(a,!1))!==null&&r!==void 0?r:{r:3,strokeWidth:2},A=I.r,k=A===void 0?3:A,R=I.strokeWidth,$=R===void 0?2:R,z=VKe(a)?a:{},O=z.clipDot,j=O===void 0?!0:O,B=k*2+$;return le.createElement(si,{className:b},_||T?le.createElement("defs",null,le.createElement("clipPath",{id:"clipPath-".concat(C)},le.createElement("rect",{x:_?u:u-f/2,y:T?c:c-p/2,width:_?f:f*2,height:T?p:p*2})),!j&&le.createElement("clipPath",{id:"clipPath-dots-".concat(C)},le.createElement("rect",{x:u-B/2,y:c-B/2,width:f+B,height:p+B}))):null,x?null:this.renderArea(E,C),(a||x)&&this.renderDots(E,j,C),(!g||y)&&Rf.renderCallByParent(this.props,o))}}],[{key:"getDerivedStateFromProps",value:function(r,i){return r.animationId!==i.prevAnimationId?{prevAnimationId:r.animationId,curPoints:r.points,curBaseLine:r.baseLine,prevPoints:i.curPoints,prevBaseLine:i.curBaseLine}:r.points!==i.curPoints||r.baseLine!==i.curBaseLine?{curPoints:r.points,curBaseLine:r.baseLine}:null}}])}(P.PureComponent);ype=Cp;Iu(Cp,"displayName","Area");Iu(Cp,"defaultProps",{stroke:"#3182bd",fill:"#3182bd",fillOpacity:.6,xAxisId:0,yAxisId:0,legendType:"line",connectNulls:!1,points:[],dot:!1,activeDot:!0,hide:!1,isAnimationActive:!yb.isSsr,animationBegin:0,animationDuration:1500,animationEasing:"ease"});Iu(Cp,"getBaseValue",function(t,e,n,r){var i=t.layout,s=t.baseValue,a=e.props.baseValue,o=a??s;if(tt(o)&&typeof o=="number")return o;var l=i==="horizontal"?r:n,c=l.scale.domain();if(l.type==="number"){var u=Math.max(c[0],c[1]),d=Math.min(c[0],c[1]);return o==="dataMin"?d:o==="dataMax"||u<0?u:Math.max(Math.min(c[0],c[1]),0)}return o==="dataMin"?c[0]:o==="dataMax"?c[1]:c[0]});Iu(Cp,"getComposedData",function(t){var e=t.props,n=t.item,r=t.xAxis,i=t.yAxis,s=t.xAxisTicks,a=t.yAxisTicks,o=t.bandSize,l=t.dataKey,c=t.stackedData,u=t.dataStartIndex,d=t.displayedData,h=t.offset,f=e.layout,p=c&&c.length,g=ype.getBaseValue(e,n,r,i),m=f==="horizontal",y=!1,x=d.map(function(_,T){var E;p?E=c[u+T]:(E=nl(_,l),Array.isArray(E)?y=!0:E=[g,E]);var C=E[1]==null||p&&nl(_,l)==null;return m?{x:cZ({axis:r,ticks:s,bandSize:o,entry:_,index:T}),y:C?null:i.scale(E[1]),value:E,payload:_}:{x:C?null:r.scale(E[1]),y:cZ({axis:i,ticks:a,bandSize:o,entry:_,index:T}),value:E,payload:_}}),b;return p||y?b=x.map(function(_){var T=Array.isArray(_.value)?_.value[0]:null;return m?{x:_.x,y:T!=null&&_.y!=null?i.scale(T):null}:{x:T!=null?r.scale(T):null,y:_.y}}):b=m?i.scale(g):r.scale(g),qh({points:x,baseLine:b,layout:f,isRange:y},h)});Iu(Cp,"renderDotItem",function(t,e){var n;if(le.isValidElement(t))n=le.cloneElement(t,e);else if(wn(t))n=t(e);else{var r=qn("recharts-area-dot",typeof t!="boolean"?t.className:""),i=e.key,s=vpe(e,wvt);n=le.createElement(PH,Pm({},s,{key:i,className:r}))}return n});function b0(t){"@babel/helpers - typeof";return b0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b0(t)}function kvt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mvt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,_pe(r.key),r)}}function Rvt(t,e,n){return e&&Mvt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Pvt(t,e,n){return e=YI(e),Ovt(t,wpe()?Reflect.construct(e,n||[],YI(t).constructor):e.apply(t,n))}function Ovt(t,e){if(e&&(b0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Dvt(t)}function Dvt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function wpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wpe=function(){return!!t})()}function YI(t){return YI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},YI(t)}function $vt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Gz(t,e)}function Gz(t,e){return Gz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Gz(t,e)}function Spe(t,e,n){return e=_pe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _pe(t){var e=Lvt(t,"string");return b0(e)=="symbol"?e:e+""}function Lvt(t,e){if(b0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(b0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function qz(){return qz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},qz.apply(this,arguments)}function Fvt(t){var e=t.xAxisId,n=LH(),r=FH(),i=ipe(e);return i==null?null:le.createElement(wb,qz({},i,{className:qn("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(a){return Ld(a,!0)}}))}var MP=function(t){function e(){return kvt(this,e),Pvt(this,e,arguments)}return $vt(e,t),Rvt(e,[{key:"render",value:function(){return le.createElement(Fvt,this.props)}}])}(le.Component);Spe(MP,"displayName","XAxis");Spe(MP,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function w0(t){"@babel/helpers - typeof";return w0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w0(t)}function jvt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function zvt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Cpe(r.key),r)}}function Bvt(t,e,n){return e&&zvt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function Uvt(t,e,n){return e=ZI(e),Vvt(t,Tpe()?Reflect.construct(e,n||[],ZI(t).constructor):e.apply(t,n))}function Vvt(t,e){if(e&&(w0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wvt(t)}function Wvt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Tpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Tpe=function(){return!!t})()}function ZI(t){return ZI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ZI(t)}function Hvt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Xz(t,e)}function Xz(t,e){return Xz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Xz(t,e)}function Epe(t,e,n){return e=Cpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cpe(t){var e=Gvt(t,"string");return w0(e)=="symbol"?e:e+""}function Gvt(t,e){if(w0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(w0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Kz(){return Kz=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Kz.apply(this,arguments)}var qvt=function(e){var n=e.yAxisId,r=LH(),i=FH(),s=spe(n);return s==null?null:le.createElement(wb,Kz({},s,{className:qn("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:r,height:i},ticksGenerator:function(o){return Ld(o,!0)}}))},RP=function(t){function e(){return jvt(this,e),Uvt(this,e,arguments)}return Hvt(e,t),Bvt(e,[{key:"render",value:function(){return le.createElement(qvt,this.props)}}])}(le.Component);Epe(RP,"displayName","YAxis");Epe(RP,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function AQ(t){return Zvt(t)||Yvt(t)||Kvt(t)||Xvt()}function Xvt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Kvt(t,e){if(t){if(typeof t=="string")return Yz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yz(t,e)}}function Yvt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Zvt(t){if(Array.isArray(t))return Yz(t)}function Yz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Zz=function(e,n,r,i,s){var a=jc(e,zH),o=jc(e,AP),l=[].concat(AQ(a),AQ(o)),c=jc(e,kP),u="".concat(i,"Id"),d=i[0],h=n;if(l.length&&(h=l.reduce(function(g,m){if(m.props[u]===r&&Fu(m.props,"extendDomain")&&tt(m.props[d])){var y=m.props[d];return[Math.min(g[0],y),Math.max(g[1],y)]}return g},h)),c.length){var f="".concat(d,"1"),p="".concat(d,"2");h=c.reduce(function(g,m){if(m.props[u]===r&&Fu(m.props,"extendDomain")&&tt(m.props[f])&&tt(m.props[p])){var y=m.props[f],x=m.props[p];return[Math.min(g[0],y,x),Math.max(g[1],y,x)]}return g},h)}return s&&s.length&&(h=s.reduce(function(g,m){return tt(m)?[Math.min(g[0],m),Math.max(g[1],m)]:g},h)),h},Npe={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function s(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new i(u,d||l,h),p=n?n+c:c;return l._events[p]?l._events[p].fn?l._events[p]=[l._events[p],f]:l._events[p].push(f):(l._events[p]=f,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)e.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,f=d.length,p=new Array(f);h<f;h++)p[h]=d[h].fn;return p},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,f,p){var g=n?n+c:c;if(!this._events[g])return!1;var m=this._events[g],y=arguments.length,x,b;if(m.fn){switch(m.once&&this.removeListener(c,m.fn,void 0,!0),y){case 1:return m.fn.call(m.context),!0;case 2:return m.fn.call(m.context,u),!0;case 3:return m.fn.call(m.context,u,d),!0;case 4:return m.fn.call(m.context,u,d,h),!0;case 5:return m.fn.call(m.context,u,d,h,f),!0;case 6:return m.fn.call(m.context,u,d,h,f,p),!0}for(b=1,x=new Array(y-1);b<y;b++)x[b-1]=arguments[b];m.fn.apply(m.context,x)}else{var _=m.length,T;for(b=0;b<_;b++)switch(m[b].once&&this.removeListener(c,m[b].fn,void 0,!0),y){case 1:m[b].fn.call(m[b].context);break;case 2:m[b].fn.call(m[b].context,u);break;case 3:m[b].fn.call(m[b].context,u,d);break;case 4:m[b].fn.call(m[b].context,u,d,h);break;default:if(!x)for(T=1,x=new Array(y-1);T<y;T++)x[T-1]=arguments[T];m[b].fn.apply(m[b].context,x)}}return!0},o.prototype.on=function(c,u,d){return s(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return s(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return a(this,f),this;var p=this._events[f];if(p.fn)p.fn===u&&(!h||p.once)&&(!d||p.context===d)&&a(this,f);else{for(var g=0,m=[],y=p.length;g<y;g++)(p[g].fn!==u||h&&!p[g].once||d&&p[g].context!==d)&&m.push(p[g]);m.length?this._events[f]=m.length===1?m[0]:m:a(this,f)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(Npe);var Qvt=Npe.exports;const Jvt=lr(Qvt);var _L=new Jvt,TL="recharts.syncMouseEvents";function zS(t){"@babel/helpers - typeof";return zS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zS(t)}function ext(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function txt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ape(r.key),r)}}function nxt(t,e,n){return e&&txt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function EL(t,e,n){return e=Ape(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ape(t){var e=rxt(t,"string");return zS(e)=="symbol"?e:e+""}function rxt(t,e){if(zS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(zS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}var ixt=function(){function t(){ext(this,t),EL(this,"activeIndex",0),EL(this,"coordinateList",[]),EL(this,"layout","horizontal")}return nxt(t,[{key:"setDetails",value:function(n){var r,i=n.coordinateList,s=i===void 0?null:i,a=n.container,o=a===void 0?null:a,l=n.layout,c=l===void 0?null:l,u=n.offset,d=u===void 0?null:u,h=n.mouseHandlerCallback,f=h===void 0?null:h;this.coordinateList=(r=s??this.coordinateList)!==null&&r!==void 0?r:[],this.container=o??this.container,this.layout=c??this.layout,this.offset=d??this.offset,this.mouseHandlerCallback=f??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var i=this.container.getBoundingClientRect(),s=i.x,a=i.y,o=i.height,l=this.coordinateList[this.activeIndex].coordinate,c=((n=window)===null||n===void 0?void 0:n.scrollX)||0,u=((r=window)===null||r===void 0?void 0:r.scrollY)||0,d=s+l+c,h=a+this.offset.top+o/2+u;this.mouseHandlerCallback({pageX:d,pageY:h})}}}])}();function sxt(t,e,n){if(n==="number"&&e===!0&&Array.isArray(t)){var r=t==null?void 0:t[0],i=t==null?void 0:t[1];if(r&&i&&tt(r)&&tt(i))return!0}return!1}function axt(t,e,n,r){var i=r/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-i:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-i,width:t==="horizontal"?r:n.width-1,height:t==="horizontal"?n.height-1:r}}function Ipe(t){var e=t.cx,n=t.cy,r=t.radius,i=t.startAngle,s=t.endAngle,a=Vs(e,n,r,i),o=Vs(e,n,r,s);return{points:[a,o],cx:e,cy:n,radius:r,startAngle:i,endAngle:s}}function oxt(t,e,n){var r,i,s,a;if(t==="horizontal")r=e.x,s=r,i=n.top,a=n.top+n.height;else if(t==="vertical")i=e.y,a=i,r=n.left,s=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var o=e.cx,l=e.cy,c=e.innerRadius,u=e.outerRadius,d=e.angle,h=Vs(o,l,c,d),f=Vs(o,l,u,d);r=h.x,i=h.y,s=f.x,a=f.y}else return Ipe(e);return[{x:r,y:i},{x:s,y:a}]}function BS(t){"@babel/helpers - typeof";return BS=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},BS(t)}function IQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function SN(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?IQ(Object(n),!0).forEach(function(r){lxt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):IQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function lxt(t,e,n){return e=cxt(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cxt(t){var e=uxt(t,"string");return BS(e)=="symbol"?e:e+""}function uxt(t,e){if(BS(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(BS(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function dxt(t){var e,n,r=t.element,i=t.tooltipEventType,s=t.isActive,a=t.activeCoordinate,o=t.activePayload,l=t.offset,c=t.activeTooltipIndex,u=t.tooltipAxisBandSize,d=t.layout,h=t.chartName,f=(e=r.props.cursor)!==null&&e!==void 0?e:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!f||!s||!a||h!=="ScatterChart"&&i!=="axis")return null;var p,g=p1;if(h==="ScatterChart")p=a,g=fpt;else if(h==="BarChart")p=axt(d,a,l,u),g=RH;else if(d==="radial"){var m=Ipe(a),y=m.cx,x=m.cy,b=m.radius,_=m.startAngle,T=m.endAngle;p={cx:y,cy:x,startAngle:_,endAngle:T,innerRadius:b,outerRadius:b},g=kfe}else p={points:oxt(d,a,l)},g=p1;var E=SN(SN(SN(SN({stroke:"#ccc",pointerEvents:"none"},l),p),Rn(f,!1)),{},{payload:o,payloadIndex:c,className:qn("recharts-tooltip-cursor",f.className)});return P.isValidElement(f)?P.cloneElement(f,E):P.createElement(g,E)}var hxt=["item"],fxt=["children","className","width","height","style","compact","title","desc"];function S0(t){"@babel/helpers - typeof";return S0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S0(t)}function Dv(){return Dv=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dv.apply(this,arguments)}function kQ(t,e){return gxt(t)||mxt(t,e)||Mpe(t,e)||pxt()}function pxt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function mxt(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,i,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e!==0)for(;!(l=(r=s.call(n)).done)&&(o.push(r.value),o.length!==e);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return o}}function gxt(t){if(Array.isArray(t))return t}function MQ(t,e){if(t==null)return{};var n=yxt(t,e),r,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function yxt(t,e){if(t==null)return{};var n={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;n[r]=t[r]}return n}function vxt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function xxt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Rpe(r.key),r)}}function bxt(t,e,n){return e&&xxt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function wxt(t,e,n){return e=QI(e),Sxt(t,kpe()?Reflect.construct(e,n||[],QI(t).constructor):e.apply(t,n))}function Sxt(t,e){if(e&&(S0(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _xt(t)}function _xt(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function kpe(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(kpe=function(){return!!t})()}function QI(t){return QI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},QI(t)}function Txt(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Qz(t,e)}function Qz(t,e){return Qz=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,i){return r.__proto__=i,r},Qz(t,e)}function _0(t){return Nxt(t)||Cxt(t)||Mpe(t)||Ext()}function Ext(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Mpe(t,e){if(t){if(typeof t=="string")return Jz(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jz(t,e)}}function Cxt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Nxt(t){if(Array.isArray(t))return Jz(t)}function Jz(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function RQ(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),n.push.apply(n,r)}return n}function Ve(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RQ(Object(n),!0).forEach(function(r){Xt(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RQ(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function Xt(t,e,n){return e=Rpe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rpe(t){var e=Axt(t,"string");return S0(e)=="symbol"?e:e+""}function Axt(t,e){if(S0(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(S0(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Ixt={xAxis:["bottom","top"],yAxis:["left","right"]},kxt={width:"100%",height:"100%"},Ppe={x:0,y:0};function _N(t){return t}var Mxt=function(e,n){return n==="horizontal"?e.x:n==="vertical"?e.y:n==="centric"?e.angle:e.radius},Rxt=function(e,n,r,i){var s=n.find(function(u){return u&&u.index===r});if(s){if(e==="horizontal")return{x:s.coordinate,y:i.y};if(e==="vertical")return{x:i.x,y:s.coordinate};if(e==="centric"){var a=s.coordinate,o=i.radius;return Ve(Ve(Ve({},i),Vs(i.cx,i.cy,o,a)),{},{angle:a,radius:o})}var l=s.coordinate,c=i.angle;return Ve(Ve(Ve({},i),Vs(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return Ppe},PP=function(e,n){var r=n.graphicalItems,i=n.dataStartIndex,s=n.dataEndIndex,a=(r??[]).reduce(function(o,l){var c=l.props.data;return c&&c.length?[].concat(_0(o),_0(c)):o},[]);return a.length>0?a:e&&e.length&&tt(i)&&tt(s)?e.slice(i,s+1):[]};function Ope(t){return t==="number"?[0,"auto"]:void 0}var e4=function(e,n,r,i){var s=e.graphicalItems,a=e.tooltipAxis,o=PP(n,e);return r<0||!s||!s.length||r>=o.length?null:s.reduce(function(l,c){var u,d=(u=c.props.data)!==null&&u!==void 0?u:n;d&&e.dataStartIndex+e.dataEndIndex!==0&&e.dataEndIndex-e.dataStartIndex>=r&&(d=d.slice(e.dataStartIndex,e.dataEndIndex+1));var h;if(a.dataKey&&!a.allowDuplicatedCategory){var f=d===void 0?o:d;h=eI(f,a.dataKey,i)}else h=d&&d[r]||o[r];return h?[].concat(_0(l),[Nfe(c,h)]):l},[])},PQ=function(e,n,r,i){var s=i||{x:e.chartX,y:e.chartY},a=Mxt(s,r),o=e.orderedTooltipTicks,l=e.tooltipAxis,c=e.tooltipTicks,u=Kut(a,o,c,l);if(u>=0&&c){var d=c[u]&&c[u].value,h=e4(e,n,u,d),f=Rxt(r,o,u,s);return{activeTooltipIndex:u,activeLabel:d,activePayload:h,activeCoordinate:f}}return null},Pxt=function(e,n){var r=n.axes,i=n.graphicalItems,s=n.axisType,a=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.layout,d=e.children,h=e.stackOffset,f=Tfe(u,s);return r.reduce(function(p,g){var m,y=g.type.defaultProps!==void 0?Ve(Ve({},g.type.defaultProps),g.props):g.props,x=y.type,b=y.dataKey,_=y.allowDataOverflow,T=y.allowDuplicatedCategory,E=y.scale,C=y.ticks,I=y.includeHidden,A=y[a];if(p[A])return p;var k=PP(e.data,{graphicalItems:i.filter(function(te){var J,oe=a in te.props?te.props[a]:(J=te.type.defaultProps)===null||J===void 0?void 0:J[a];return oe===A}),dataStartIndex:l,dataEndIndex:c}),R=k.length,$,z,O;sxt(y.domain,_,x)&&($=xz(y.domain,null,_),f&&(x==="number"||E!=="auto")&&(O=f1(k,b,"category")));var j=Ope(x);if(!$||$.length===0){var B,W=(B=y.domain)!==null&&B!==void 0?B:j;if(b){if($=f1(k,b,x),x==="category"&&f){var L=PKe($);T&&L?(z=$,$=jI(0,R)):T||($=fZ(W,$,g).reduce(function(te,J){return te.indexOf(J)>=0?te:[].concat(_0(te),[J])},[]))}else if(x==="category")T?$=$.filter(function(te){return te!==""&&!Un(te)}):$=fZ(W,$,g).reduce(function(te,J){return te.indexOf(J)>=0||J===""||Un(J)?te:[].concat(_0(te),[J])},[]);else if(x==="number"){var V=edt(k,i.filter(function(te){var J,oe,fe=a in te.props?te.props[a]:(J=te.type.defaultProps)===null||J===void 0?void 0:J[a],Ee="hide"in te.props?te.props.hide:(oe=te.type.defaultProps)===null||oe===void 0?void 0:oe.hide;return fe===A&&(I||!Ee)}),b,s,u);V&&($=V)}f&&(x==="number"||E!=="auto")&&(O=f1(k,b,"category"))}else f?$=jI(0,R):o&&o[A]&&o[A].hasStack&&x==="number"?$=h==="expand"?[0,1]:Cfe(o[A].stackGroups,l,c):$=_fe(k,i.filter(function(te){var J=a in te.props?te.props[a]:te.type.defaultProps[a],oe="hide"in te.props?te.props.hide:te.type.defaultProps.hide;return J===A&&(I||!oe)}),x,u,!0);if(x==="number")$=Zz(d,$,A,s,C),W&&($=xz(W,$,_));else if(x==="category"&&W){var H=W,K=$.every(function(te){return H.indexOf(te)>=0});K&&($=H)}}return Ve(Ve({},p),{},Xt({},A,Ve(Ve({},y),{},{axisType:s,domain:$,categoricalDomain:O,duplicateDomain:z,originalDomain:(m=y.domain)!==null&&m!==void 0?m:j,isCategorical:f,layout:u})))},{})},Oxt=function(e,n){var r=n.graphicalItems,i=n.Axis,s=n.axisType,a=n.axisIdKey,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.layout,d=e.children,h=PP(e.data,{graphicalItems:r,dataStartIndex:l,dataEndIndex:c}),f=h.length,p=Tfe(u,s),g=-1;return r.reduce(function(m,y){var x=y.type.defaultProps!==void 0?Ve(Ve({},y.type.defaultProps),y.props):y.props,b=x[a],_=Ope("number");if(!m[b]){g++;var T;return p?T=jI(0,f):o&&o[b]&&o[b].hasStack?(T=Cfe(o[b].stackGroups,l,c),T=Zz(d,T,b,s)):(T=xz(_,_fe(h,r.filter(function(E){var C,I,A=a in E.props?E.props[a]:(C=E.type.defaultProps)===null||C===void 0?void 0:C[a],k="hide"in E.props?E.props.hide:(I=E.type.defaultProps)===null||I===void 0?void 0:I.hide;return A===b&&!k}),"number",u),i.defaultProps.allowDataOverflow),T=Zz(d,T,b,s)),Ve(Ve({},m),{},Xt({},b,Ve(Ve({axisType:s},i.defaultProps),{},{hide:!0,orientation:Vl(Ixt,"".concat(s,".").concat(g%2),null),domain:T,originalDomain:_,isCategorical:p,layout:u})))}return m},{})},Dxt=function(e,n){var r=n.axisType,i=r===void 0?"xAxis":r,s=n.AxisComp,a=n.graphicalItems,o=n.stackGroups,l=n.dataStartIndex,c=n.dataEndIndex,u=e.children,d="".concat(i,"Id"),h=jc(u,s),f={};return h&&h.length?f=Pxt(e,{axes:h,graphicalItems:a,axisType:i,axisIdKey:d,stackGroups:o,dataStartIndex:l,dataEndIndex:c}):a&&a.length&&(f=Oxt(e,{Axis:s,graphicalItems:a,axisType:i,axisIdKey:d,stackGroups:o,dataStartIndex:l,dataEndIndex:c})),f},$xt=function(e){var n=tf(e),r=Ld(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:sH(r,function(i){return i.coordinate}),tooltipAxis:n,tooltipAxisBandSize:kI(n,r)}},OQ=function(e){var n=e.children,r=e.defaultShowTooltip,i=jo(n,f0),s=0,a=0;return e.data&&e.data.length!==0&&(a=e.data.length-1),i&&i.props&&(i.props.startIndex>=0&&(s=i.props.startIndex),i.props.endIndex>=0&&(a=i.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:s,dataEndIndex:a,activeTooltipIndex:-1,isTooltipActive:!!r}},Lxt=function(e){return!e||!e.length?!1:e.some(function(n){var r=Hd(n&&n.type);return r&&r.indexOf("Bar")>=0})},DQ=function(e){return e==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:e==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:e==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},Fxt=function(e,n){var r=e.props,i=e.graphicalItems,s=e.xAxisMap,a=s===void 0?{}:s,o=e.yAxisMap,l=o===void 0?{}:o,c=r.width,u=r.height,d=r.children,h=r.margin||{},f=jo(d,f0),p=jo(d,ox),g=Object.keys(l).reduce(function(T,E){var C=l[E],I=C.orientation;return!C.mirror&&!C.hide?Ve(Ve({},T),{},Xt({},I,T[I]+C.width)):T},{left:h.left||0,right:h.right||0}),m=Object.keys(a).reduce(function(T,E){var C=a[E],I=C.orientation;return!C.mirror&&!C.hide?Ve(Ve({},T),{},Xt({},I,Vl(T,"".concat(I))+C.height)):T},{top:h.top||0,bottom:h.bottom||0}),y=Ve(Ve({},m),g),x=y.bottom;f&&(y.bottom+=f.props.height||f0.defaultProps.height),p&&n&&(y=Qut(y,i,r,n));var b=c-y.left-y.right,_=u-y.top-y.bottom;return Ve(Ve({brushBottom:x},y),{},{width:Math.max(b,0),height:Math.max(_,0)})},jxt=function(e,n){if(n==="xAxis")return e[n].width;if(n==="yAxis")return e[n].height},zxt=function(e){var n=e.chartName,r=e.GraphicalChild,i=e.defaultTooltipEventType,s=i===void 0?"axis":i,a=e.validateTooltipEventTypes,o=a===void 0?["axis"]:a,l=e.axisComponents,c=e.legendContent,u=e.formatAxisMap,d=e.defaultProps,h=function(y,x){var b=x.graphicalItems,_=x.stackGroups,T=x.offset,E=x.updateId,C=x.dataStartIndex,I=x.dataEndIndex,A=y.barSize,k=y.layout,R=y.barGap,$=y.barCategoryGap,z=y.maxBarSize,O=DQ(k),j=O.numericAxisName,B=O.cateAxisName,W=Lxt(b),L=[];return b.forEach(function(V,H){var K=PP(y.data,{graphicalItems:[V],dataStartIndex:C,dataEndIndex:I}),te=V.type.defaultProps!==void 0?Ve(Ve({},V.type.defaultProps),V.props):V.props,J=te.dataKey,oe=te.maxBarSize,fe=te["".concat(j,"Id")],Ee=te["".concat(B,"Id")],me={},De=l.reduce(function(we,Z){var ie=x["".concat(Z.axisType,"Map")],ae=te["".concat(Z.axisType,"Id")];ie&&ie[ae]||Z.axisType==="zAxis"||Rg();var Le=ie[ae];return Ve(Ve({},we),{},Xt(Xt({},Z.axisType,Le),"".concat(Z.axisType,"Ticks"),Ld(Le)))},me),ge=De[B],_e=De["".concat(B,"Ticks")],Ce=_&&_[fe]&&_[fe].hasStack&&hdt(V,_[fe].stackGroups),G=Hd(V.type).indexOf("Bar")>=0,ke=kI(ge,_e),xe=[],Pe=W&&Yut({barSize:A,stackGroups:_,totalSize:jxt(De,B)});if(G){var Te,Ye,qe=Un(oe)?z:oe,Q=(Te=(Ye=kI(ge,_e,!0))!==null&&Ye!==void 0?Ye:qe)!==null&&Te!==void 0?Te:0;xe=Zut({barGap:R,barCategoryGap:$,bandSize:Q!==ke?Q:ke,sizeList:Pe[Ee],maxBarSize:qe}),Q!==ke&&(xe=xe.map(function(we){return Ve(Ve({},we),{},{position:Ve(Ve({},we.position),{},{offset:we.position.offset-Q/2})})}))}var X=V&&V.type&&V.type.getComposedData;X&&L.push({props:Ve(Ve({},X(Ve(Ve({},De),{},{displayedData:K,props:y,dataKey:J,item:V,bandSize:ke,barPosition:xe,offset:T,stackedData:Ce,layout:k,dataStartIndex:C,dataEndIndex:I}))),{},Xt(Xt(Xt({key:V.key||"item-".concat(H)},j,De[j]),B,De[B]),"animationId",E)),childIndex:GKe(V,y.children),item:V})}),L},f=function(y,x){var b=y.props,_=y.dataStartIndex,T=y.dataEndIndex,E=y.updateId;if(!aK({props:b}))return null;var C=b.children,I=b.layout,A=b.stackOffset,k=b.data,R=b.reverseStackOrder,$=DQ(I),z=$.numericAxisName,O=$.cateAxisName,j=jc(C,r),B=cdt(k,j,"".concat(z,"Id"),"".concat(O,"Id"),A,R),W=l.reduce(function(te,J){var oe="".concat(J.axisType,"Map");return Ve(Ve({},te),{},Xt({},oe,Dxt(b,Ve(Ve({},J),{},{graphicalItems:j,stackGroups:J.axisType===z&&B,dataStartIndex:_,dataEndIndex:T}))))},{}),L=Fxt(Ve(Ve({},W),{},{props:b,graphicalItems:j}),x==null?void 0:x.legendBBox);Object.keys(W).forEach(function(te){W[te]=u(b,W[te],L,te.replace("Map",""),n)});var V=W["".concat(O,"Map")],H=$xt(V),K=h(b,Ve(Ve({},W),{},{dataStartIndex:_,dataEndIndex:T,updateId:E,graphicalItems:j,stackGroups:B,offset:L}));return Ve(Ve({formattedGraphicalItems:K,graphicalItems:j,offset:L,stackGroups:B},H),W)},p=function(m){function y(x){var b,_,T;return vxt(this,y),T=wxt(this,y,[x]),Xt(T,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Xt(T,"accessibilityManager",new ixt),Xt(T,"handleLegendBBoxUpdate",function(E){if(E){var C=T.state,I=C.dataStartIndex,A=C.dataEndIndex,k=C.updateId;T.setState(Ve({legendBBox:E},f({props:T.props,dataStartIndex:I,dataEndIndex:A,updateId:k},Ve(Ve({},T.state),{},{legendBBox:E}))))}}),Xt(T,"handleReceiveSyncEvent",function(E,C,I){if(T.props.syncId===E){if(I===T.eventEmitterSymbol&&typeof T.props.syncMethod!="function")return;T.applySyncEvent(C)}}),Xt(T,"handleBrushChange",function(E){var C=E.startIndex,I=E.endIndex;if(C!==T.state.dataStartIndex||I!==T.state.dataEndIndex){var A=T.state.updateId;T.setState(function(){return Ve({dataStartIndex:C,dataEndIndex:I},f({props:T.props,dataStartIndex:C,dataEndIndex:I,updateId:A},T.state))}),T.triggerSyncEvent({dataStartIndex:C,dataEndIndex:I})}}),Xt(T,"handleMouseEnter",function(E){var C=T.getMouseInfo(E);if(C){var I=Ve(Ve({},C),{},{isTooltipActive:!0});T.setState(I),T.triggerSyncEvent(I);var A=T.props.onMouseEnter;wn(A)&&A(I,E)}}),Xt(T,"triggeredAfterMouseMove",function(E){var C=T.getMouseInfo(E),I=C?Ve(Ve({},C),{},{isTooltipActive:!0}):{isTooltipActive:!1};T.setState(I),T.triggerSyncEvent(I);var A=T.props.onMouseMove;wn(A)&&A(I,E)}),Xt(T,"handleItemMouseEnter",function(E){T.setState(function(){return{isTooltipActive:!0,activeItem:E,activePayload:E.tooltipPayload,activeCoordinate:E.tooltipPosition||{x:E.cx,y:E.cy}}})}),Xt(T,"handleItemMouseLeave",function(){T.setState(function(){return{isTooltipActive:!1}})}),Xt(T,"handleMouseMove",function(E){E.persist(),T.throttleTriggeredAfterMouseMove(E)}),Xt(T,"handleMouseLeave",function(E){T.throttleTriggeredAfterMouseMove.cancel();var C={isTooltipActive:!1};T.setState(C),T.triggerSyncEvent(C);var I=T.props.onMouseLeave;wn(I)&&I(C,E)}),Xt(T,"handleOuterEvent",function(E){var C=HKe(E),I=Vl(T.props,"".concat(C));if(C&&wn(I)){var A,k;/.*touch.*/i.test(C)?k=T.getMouseInfo(E.changedTouches[0]):k=T.getMouseInfo(E),I((A=k)!==null&&A!==void 0?A:{},E)}}),Xt(T,"handleClick",function(E){var C=T.getMouseInfo(E);if(C){var I=Ve(Ve({},C),{},{isTooltipActive:!0});T.setState(I),T.triggerSyncEvent(I);var A=T.props.onClick;wn(A)&&A(I,E)}}),Xt(T,"handleMouseDown",function(E){var C=T.props.onMouseDown;if(wn(C)){var I=T.getMouseInfo(E);C(I,E)}}),Xt(T,"handleMouseUp",function(E){var C=T.props.onMouseUp;if(wn(C)){var I=T.getMouseInfo(E);C(I,E)}}),Xt(T,"handleTouchMove",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&T.throttleTriggeredAfterMouseMove(E.changedTouches[0])}),Xt(T,"handleTouchStart",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&T.handleMouseDown(E.changedTouches[0])}),Xt(T,"handleTouchEnd",function(E){E.changedTouches!=null&&E.changedTouches.length>0&&T.handleMouseUp(E.changedTouches[0])}),Xt(T,"handleDoubleClick",function(E){var C=T.props.onDoubleClick;if(wn(C)){var I=T.getMouseInfo(E);C(I,E)}}),Xt(T,"handleContextMenu",function(E){var C=T.props.onContextMenu;if(wn(C)){var I=T.getMouseInfo(E);C(I,E)}}),Xt(T,"triggerSyncEvent",function(E){T.props.syncId!==void 0&&_L.emit(TL,T.props.syncId,E,T.eventEmitterSymbol)}),Xt(T,"applySyncEvent",function(E){var C=T.props,I=C.layout,A=C.syncMethod,k=T.state.updateId,R=E.dataStartIndex,$=E.dataEndIndex;if(E.dataStartIndex!==void 0||E.dataEndIndex!==void 0)T.setState(Ve({dataStartIndex:R,dataEndIndex:$},f({props:T.props,dataStartIndex:R,dataEndIndex:$,updateId:k},T.state)));else if(E.activeTooltipIndex!==void 0){var z=E.chartX,O=E.chartY,j=E.activeTooltipIndex,B=T.state,W=B.offset,L=B.tooltipTicks;if(!W)return;if(typeof A=="function")j=A(L,E);else if(A==="value"){j=-1;for(var V=0;V<L.length;V++)if(L[V].value===E.activeLabel){j=V;break}}var H=Ve(Ve({},W),{},{x:W.left,y:W.top}),K=Math.min(z,H.x+H.width),te=Math.min(O,H.y+H.height),J=L[j]&&L[j].value,oe=e4(T.state,T.props.data,j),fe=L[j]?{x:I==="horizontal"?L[j].coordinate:K,y:I==="horizontal"?te:L[j].coordinate}:Ppe;T.setState(Ve(Ve({},E),{},{activeLabel:J,activeCoordinate:fe,activePayload:oe,activeTooltipIndex:j}))}else T.setState(E)}),Xt(T,"renderCursor",function(E){var C,I=T.state,A=I.isTooltipActive,k=I.activeCoordinate,R=I.activePayload,$=I.offset,z=I.activeTooltipIndex,O=I.tooltipAxisBandSize,j=T.getTooltipEventType(),B=(C=E.props.active)!==null&&C!==void 0?C:A,W=T.props.layout,L=E.key||"_recharts-cursor";return le.createElement(dxt,{key:L,activeCoordinate:k,activePayload:R,activeTooltipIndex:z,chartName:n,element:E,isActive:B,layout:W,offset:$,tooltipAxisBandSize:O,tooltipEventType:j})}),Xt(T,"renderPolarAxis",function(E,C,I){var A=Vl(E,"type.axisType"),k=Vl(T.state,"".concat(A,"Map")),R=E.type.defaultProps,$=R!==void 0?Ve(Ve({},R),E.props):E.props,z=k&&k[$["".concat(A,"Id")]];return P.cloneElement(E,Ve(Ve({},z),{},{className:qn(A,z.className),key:E.key||"".concat(C,"-").concat(I),ticks:Ld(z,!0)}))}),Xt(T,"renderPolarGrid",function(E){var C=E.props,I=C.radialLines,A=C.polarAngles,k=C.polarRadius,R=T.state,$=R.radiusAxisMap,z=R.angleAxisMap,O=tf($),j=tf(z),B=j.cx,W=j.cy,L=j.innerRadius,V=j.outerRadius;return P.cloneElement(E,{polarAngles:Array.isArray(A)?A:Ld(j,!0).map(function(H){return H.coordinate}),polarRadius:Array.isArray(k)?k:Ld(O,!0).map(function(H){return H.coordinate}),cx:B,cy:W,innerRadius:L,outerRadius:V,key:E.key||"polar-grid",radialLines:I})}),Xt(T,"renderLegend",function(){var E=T.state.formattedGraphicalItems,C=T.props,I=C.children,A=C.width,k=C.height,R=T.props.margin||{},$=A-(R.left||0)-(R.right||0),z=wfe({children:I,formattedGraphicalItems:E,legendWidth:$,legendContent:c});if(!z)return null;var O=z.item,j=MQ(z,hxt);return P.cloneElement(O,Ve(Ve({},j),{},{chartWidth:A,chartHeight:k,margin:R,onBBoxUpdate:T.handleLegendBBoxUpdate}))}),Xt(T,"renderTooltip",function(){var E,C=T.props,I=C.children,A=C.accessibilityLayer,k=jo(I,yu);if(!k)return null;var R=T.state,$=R.isTooltipActive,z=R.activeCoordinate,O=R.activePayload,j=R.activeLabel,B=R.offset,W=(E=k.props.active)!==null&&E!==void 0?E:$;return P.cloneElement(k,{viewBox:Ve(Ve({},B),{},{x:B.left,y:B.top}),active:W,label:j,payload:W?O:[],coordinate:z,accessibilityLayer:A})}),Xt(T,"renderBrush",function(E){var C=T.props,I=C.margin,A=C.data,k=T.state,R=k.offset,$=k.dataStartIndex,z=k.dataEndIndex,O=k.updateId;return P.cloneElement(E,{key:E.key||"_recharts-brush",onChange:vN(T.handleBrushChange,E.props.onChange),data:A,x:tt(E.props.x)?E.props.x:R.left,y:tt(E.props.y)?E.props.y:R.top+R.height+R.brushBottom-(I.bottom||0),width:tt(E.props.width)?E.props.width:R.width,startIndex:$,endIndex:z,updateId:"brush-".concat(O)})}),Xt(T,"renderReferenceElement",function(E,C,I){if(!E)return null;var A=T,k=A.clipPathId,R=T.state,$=R.xAxisMap,z=R.yAxisMap,O=R.offset,j=E.type.defaultProps||{},B=E.props,W=B.xAxisId,L=W===void 0?j.xAxisId:W,V=B.yAxisId,H=V===void 0?j.yAxisId:V;return P.cloneElement(E,{key:E.key||"".concat(C,"-").concat(I),xAxis:$[L],yAxis:z[H],viewBox:{x:O.left,y:O.top,width:O.width,height:O.height},clipPathId:k})}),Xt(T,"renderActivePoints",function(E){var C=E.item,I=E.activePoint,A=E.basePoint,k=E.childIndex,R=E.isRange,$=[],z=C.props.key,O=C.item.type.defaultProps!==void 0?Ve(Ve({},C.item.type.defaultProps),C.item.props):C.item.props,j=O.activeDot,B=O.dataKey,W=Ve(Ve({index:k,dataKey:B,cx:I.x,cy:I.y,r:4,fill:MH(C.item),strokeWidth:2,stroke:"#fff",payload:I.payload,value:I.value},Rn(j,!1)),tI(j));return $.push(y.renderActiveDot(j,W,"".concat(z,"-activePoint-").concat(k))),A?$.push(y.renderActiveDot(j,Ve(Ve({},W),{},{cx:A.x,cy:A.y}),"".concat(z,"-basePoint-").concat(k))):R&&$.push(null),$}),Xt(T,"renderGraphicChild",function(E,C,I){var A=T.filterFormatItem(E,C,I);if(!A)return null;var k=T.getTooltipEventType(),R=T.state,$=R.isTooltipActive,z=R.tooltipAxis,O=R.activeTooltipIndex,j=R.activeLabel,B=T.props.children,W=jo(B,yu),L=A.props,V=L.points,H=L.isRange,K=L.baseLine,te=A.item.type.defaultProps!==void 0?Ve(Ve({},A.item.type.defaultProps),A.item.props):A.item.props,J=te.activeDot,oe=te.hide,fe=te.activeBar,Ee=te.activeShape,me=!!(!oe&&$&&W&&(J||fe||Ee)),De={};k!=="axis"&&W&&W.props.trigger==="click"?De={onClick:vN(T.handleItemMouseEnter,E.props.onClick)}:k!=="axis"&&(De={onMouseLeave:vN(T.handleItemMouseLeave,E.props.onMouseLeave),onMouseEnter:vN(T.handleItemMouseEnter,E.props.onMouseEnter)});var ge=P.cloneElement(E,Ve(Ve({},A.props),De));function _e(Z){return typeof z.dataKey=="function"?z.dataKey(Z.payload):null}if(me)if(O>=0){var Ce,G;if(z.dataKey&&!z.allowDuplicatedCategory){var ke=typeof z.dataKey=="function"?_e:"payload.".concat(z.dataKey.toString());Ce=eI(V,ke,j),G=H&&K&&eI(K,ke,j)}else Ce=V==null?void 0:V[O],G=H&&K&&K[O];if(Ee||fe){var xe=E.props.activeIndex!==void 0?E.props.activeIndex:O;return[P.cloneElement(E,Ve(Ve(Ve({},A.props),De),{},{activeIndex:xe})),null,null]}if(!Un(Ce))return[ge].concat(_0(T.renderActivePoints({item:A,activePoint:Ce,basePoint:G,childIndex:O,isRange:H})))}else{var Pe,Te=(Pe=T.getItemByXY(T.state.activeCoordinate))!==null&&Pe!==void 0?Pe:{graphicalItem:ge},Ye=Te.graphicalItem,qe=Ye.item,Q=qe===void 0?E:qe,X=Ye.childIndex,we=Ve(Ve(Ve({},A.props),De),{},{activeIndex:X});return[P.cloneElement(Q,we),null,null]}return H?[ge,null,null]:[ge,null]}),Xt(T,"renderCustomized",function(E,C,I){return P.cloneElement(E,Ve(Ve({key:"recharts-customized-".concat(I)},T.props),T.state))}),Xt(T,"renderMap",{CartesianGrid:{handler:_N,once:!0},ReferenceArea:{handler:T.renderReferenceElement},ReferenceLine:{handler:_N},ReferenceDot:{handler:T.renderReferenceElement},XAxis:{handler:_N},YAxis:{handler:_N},Brush:{handler:T.renderBrush,once:!0},Bar:{handler:T.renderGraphicChild},Line:{handler:T.renderGraphicChild},Area:{handler:T.renderGraphicChild},Radar:{handler:T.renderGraphicChild},RadialBar:{handler:T.renderGraphicChild},Scatter:{handler:T.renderGraphicChild},Pie:{handler:T.renderGraphicChild},Funnel:{handler:T.renderGraphicChild},Tooltip:{handler:T.renderCursor,once:!0},PolarGrid:{handler:T.renderPolarGrid,once:!0},PolarAngleAxis:{handler:T.renderPolarAxis},PolarRadiusAxis:{handler:T.renderPolarAxis},Customized:{handler:T.renderCustomized}}),T.clipPathId="".concat((b=x.id)!==null&&b!==void 0?b:eE("recharts"),"-clip"),T.throttleTriggeredAfterMouseMove=bhe(T.triggeredAfterMouseMove,(_=x.throttleDelay)!==null&&_!==void 0?_:1e3/60),T.state={},T}return Txt(y,m),bxt(y,[{key:"componentDidMount",value:function(){var b,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,_=b.children,T=b.data,E=b.height,C=b.layout,I=jo(_,yu);if(I){var A=I.props.defaultIndex;if(!(typeof A!="number"||A<0||A>this.state.tooltipTicks.length-1)){var k=this.state.tooltipTicks[A]&&this.state.tooltipTicks[A].value,R=e4(this.state,T,A,k),$=this.state.tooltipTicks[A].coordinate,z=(this.state.offset.top+E)/2,O=C==="horizontal",j=O?{x:$,y:z}:{y:$,x:z},B=this.state.formattedGraphicalItems.find(function(L){var V=L.item;return V.type.name==="Scatter"});B&&(j=Ve(Ve({},j),B.props.points[A].tooltipPosition),R=B.props.points[A].tooltipPayload);var W={activeTooltipIndex:A,isTooltipActive:!0,activeLabel:k,activePayload:R,activeCoordinate:j};this.setState(W),this.renderCursor(I),this.accessibilityManager.setIndex(A)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var T,E;this.accessibilityManager.setDetails({offset:{left:(T=this.props.margin.left)!==null&&T!==void 0?T:0,top:(E=this.props.margin.top)!==null&&E!==void 0?E:0}})}return null}},{key:"componentDidUpdate",value:function(b){Oj([jo(b.children,yu)],[jo(this.props.children,yu)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=jo(this.props.children,yu);if(b&&typeof b.props.shared=="boolean"){var _=b.props.shared?"axis":"item";return o.indexOf(_)>=0?_:s}return s}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var _=this.container,T=_.getBoundingClientRect(),E=wat(T),C={chartX:Math.round(b.pageX-E.left),chartY:Math.round(b.pageY-E.top)},I=T.width/_.offsetWidth||1,A=this.inRange(C.chartX,C.chartY,I);if(!A)return null;var k=this.state,R=k.xAxisMap,$=k.yAxisMap,z=this.getTooltipEventType(),O=PQ(this.state,this.props.data,this.props.layout,A);if(z!=="axis"&&R&&$){var j=tf(R).scale,B=tf($).scale,W=j&&j.invert?j.invert(C.chartX):null,L=B&&B.invert?B.invert(C.chartY):null;return Ve(Ve({},C),{},{xValue:W,yValue:L},O)}return O?Ve(Ve({},C),O):null}},{key:"inRange",value:function(b,_){var T=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,E=this.props.layout,C=b/T,I=_/T;if(E==="horizontal"||E==="vertical"){var A=this.state.offset,k=C>=A.left&&C<=A.left+A.width&&I>=A.top&&I<=A.top+A.height;return k?{x:C,y:I}:null}var R=this.state,$=R.angleAxisMap,z=R.radiusAxisMap;if($&&z){var O=tf($);return gZ({x:C,y:I},O)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,_=this.getTooltipEventType(),T=jo(b,yu),E={};T&&_==="axis"&&(T.props.trigger==="click"?E={onClick:this.handleClick}:E={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var C=tI(this.props,this.handleOuterEvent);return Ve(Ve({},C),E)}},{key:"addListener",value:function(){_L.on(TL,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){_L.removeListener(TL,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,_,T){for(var E=this.state.formattedGraphicalItems,C=0,I=E.length;C<I;C++){var A=E[C];if(A.item===b||A.props.key===b.key||_===Hd(A.item.type)&&T===A.childIndex)return A}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,_=this.state.offset,T=_.left,E=_.top,C=_.height,I=_.width;return le.createElement("defs",null,le.createElement("clipPath",{id:b},le.createElement("rect",{x:T,y:E,height:C,width:I})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(_,T){var E=kQ(T,2),C=E[0],I=E[1];return Ve(Ve({},_),{},Xt({},C,I.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(_,T){var E=kQ(T,2),C=E[0],I=E[1];return Ve(Ve({},_),{},Xt({},C,I.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(b){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(b){var _=this.state,T=_.formattedGraphicalItems,E=_.activeItem;if(T&&T.length)for(var C=0,I=T.length;C<I;C++){var A=T[C],k=A.props,R=A.item,$=R.type.defaultProps!==void 0?Ve(Ve({},R.type.defaultProps),R.props):R.props,z=Hd(R.type);if(z==="Bar"){var O=(k.data||[]).find(function(L){return rpt(b,L)});if(O)return{graphicalItem:A,payload:O}}else if(z==="RadialBar"){var j=(k.data||[]).find(function(L){return gZ(b,L)});if(j)return{graphicalItem:A,payload:j}}else if(TP(A,E)||EP(A,E)||DS(A,E)){var B=amt({graphicalItem:A,activeTooltipItem:E,itemData:$.data}),W=$.activeIndex===void 0?B:$.activeIndex;return{graphicalItem:Ve(Ve({},A),{},{childIndex:W}),payload:DS(A,E)?$.data[B]:A.props.data[B]}}}return null}},{key:"render",value:function(){var b=this;if(!aK(this))return null;var _=this.props,T=_.children,E=_.className,C=_.width,I=_.height,A=_.style,k=_.compact,R=_.title,$=_.desc,z=MQ(_,fxt),O=Rn(z,!1);if(k)return le.createElement(fQ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement($j,Dv({},O,{width:C,height:I,title:R,desc:$}),this.renderClipPath(),lK(T,this.renderMap)));if(this.props.accessibilityLayer){var j,B;O.tabIndex=(j=this.props.tabIndex)!==null&&j!==void 0?j:0,O.role=(B=this.props.role)!==null&&B!==void 0?B:"application",O.onKeyDown=function(L){b.accessibilityManager.keyboardEvent(L)},O.onFocus=function(){b.accessibilityManager.focus()}}var W=this.parseEventsOfWrapper();return le.createElement(fQ,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},le.createElement("div",Dv({className:qn("recharts-wrapper",E),style:Ve({position:"relative",cursor:"default",width:C,height:I},A)},W,{ref:function(V){b.container=V}}),le.createElement($j,Dv({},O,{width:C,height:I,title:R,desc:$,style:kxt}),this.renderClipPath(),lK(T,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(P.Component);Xt(p,"displayName",n),Xt(p,"defaultProps",Ve({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},d)),Xt(p,"getDerivedStateFromProps",function(m,y){var x=m.dataKey,b=m.data,_=m.children,T=m.width,E=m.height,C=m.layout,I=m.stackOffset,A=m.margin,k=y.dataStartIndex,R=y.dataEndIndex;if(y.updateId===void 0){var $=OQ(m);return Ve(Ve(Ve({},$),{},{updateId:0},f(Ve(Ve({props:m},$),{},{updateId:0}),y)),{},{prevDataKey:x,prevData:b,prevWidth:T,prevHeight:E,prevLayout:C,prevStackOffset:I,prevMargin:A,prevChildren:_})}if(x!==y.prevDataKey||b!==y.prevData||T!==y.prevWidth||E!==y.prevHeight||C!==y.prevLayout||I!==y.prevStackOffset||!ax(A,y.prevMargin)){var z=OQ(m),O={chartX:y.chartX,chartY:y.chartY,isTooltipActive:y.isTooltipActive},j=Ve(Ve({},PQ(y,b,C)),{},{updateId:y.updateId+1}),B=Ve(Ve(Ve({},z),O),j);return Ve(Ve(Ve({},B),f(Ve({props:m},B),y)),{},{prevDataKey:x,prevData:b,prevWidth:T,prevHeight:E,prevLayout:C,prevStackOffset:I,prevMargin:A,prevChildren:_})}if(!Oj(_,y.prevChildren)){var W,L,V,H,K=jo(_,f0),te=K&&(W=(L=K.props)===null||L===void 0?void 0:L.startIndex)!==null&&W!==void 0?W:k,J=K&&(V=(H=K.props)===null||H===void 0?void 0:H.endIndex)!==null&&V!==void 0?V:R,oe=te!==k||J!==R,fe=!Un(b),Ee=fe&&!oe?y.updateId:y.updateId+1;return Ve(Ve({updateId:Ee},f(Ve(Ve({props:m},y),{},{updateId:Ee,dataStartIndex:te,dataEndIndex:J}),y)),{},{prevChildren:_,dataStartIndex:te,dataEndIndex:J})}return null}),Xt(p,"renderActiveDot",function(m,y,x){var b;return P.isValidElement(m)?b=P.cloneElement(m,y):wn(m)?b=m(y):b=le.createElement(PH,y),le.createElement(si,{className:"recharts-active-dot",key:x},b)});var g=P.forwardRef(function(y,x){return le.createElement(p,Dv({},y,{ref:x}))});return g.displayName=p.displayName,g},Bxt=zxt({chartName:"AreaChart",GraphicalChild:Cp,axisComponents:[{axisType:"xAxis",AxisComp:MP},{axisType:"yAxis",AxisComp:RP}],formatAxisMap:Rgt});const ux=({data:t=[],timeRange:e,dataKey:n="value",color:r="#1976D2"})=>{const[i,s]=P.useState([]);P.useEffect(()=>{if(!t||t.length===0){const d=o(e);s(d);return}const l=new Date,u=t.filter(d=>{if(e==="week"){const h=new Date;return h.setDate(l.getDate()-7),d.date>=h}else if(e==="month"){const h=new Date;return h.setMonth(l.getMonth()-1),d.date>=h}return!0}).map(d=>({date:a(d.date,e),[n]:d.value}));s(u)},[t,e,n]);const a=(l,c)=>c==="week"?l.toLocaleDateString("en-US",{weekday:"short"}):c==="month"?l.toLocaleDateString("en-US",{month:"short",day:"numeric"}):l.toLocaleDateString("en-US",{month:"short",year:"numeric"}),o=l=>{const c=[],u=new Date;let d=l==="week"?7:l==="month"?30:12,h=50,f=150;for(let p=0;p<d;p++){const g=new Date;l==="week"||l==="month"?g.setDate(u.getDate()-(d-p-1)):g.setMonth(u.getMonth()-(d-p-1));const m=p/(d-1),y=Math.round(h+(f-h)*m+(Math.random()*20-10));c.push({date:a(g,l),[n]:y})}return c};return v.jsx(pat,{width:"100%",height:"100%",children:v.jsxs(Bxt,{data:i,margin:{top:10,right:10,left:0,bottom:0},children:[v.jsx("defs",{children:v.jsxs("linearGradient",{id:`color${n}`,x1:"0",y1:"0",x2:"0",y2:"1",children:[v.jsx("stop",{offset:"5%",stopColor:r,stopOpacity:.8}),v.jsx("stop",{offset:"95%",stopColor:r,stopOpacity:.1})]})}),v.jsx(gpe,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),v.jsx(MP,{dataKey:"date",tick:{fontSize:12},tickLine:!1,axisLine:{stroke:"#e0e0e0"}}),v.jsx(RP,{hide:!0,domain:["dataMin - 10","dataMax + 10"]}),v.jsx(yu,{formatter:l=>[`${l}`,n==="rangeOfMotion"?"Degrees":"Score"],labelFormatter:l=>`Date: ${l}`}),v.jsx(Cp,{type:"monotone",dataKey:n,stroke:r,fillOpacity:1,fill:`url(#color${n})`})]})})},dx=({value:t,color:e="green"})=>{const r=(()=>{if(typeof e=="string")switch(e){case"green":return"bg-green-500";case"yellow":return"bg-yellow-500";case"red":return"bg-red-500";default:return e.startsWith("#")||e.startsWith("rgb")?e:"bg-primary"}return"bg-primary"})(),i=Math.min(Math.max(t,0),100);return v.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden progress-indicator",children:v.jsx("div",{className:Pt("h-full rounded-full progress-bar",typeof r=="string"&&r.startsWith("bg-")?r:"bg-primary"),style:{width:`${i}%`,...typeof r=="string"&&!r.startsWith("bg-")?{backgroundColor:r}:{}}})})},Uxt=({userId:t})=>{const[e,n]=P.useState("month"),{data:r,isLoading:i}=Kr({queryKey:[`/api/progress/${t}`]}),s={current:142,goal:180,improvement:12},a={good:72,fair:23,poor:5,improvement:8},o={progress:76,estimatedDate:"Jul 18",weeksEarly:2};return v.jsxs("div",{className:"mb-8",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:"Your Progress Dashboard"}),v.jsxs("div",{className:"flex space-x-2",children:[v.jsx(et,{variant:e==="week"?"default":"outline",size:"sm",onClick:()=>n("week"),children:"Week"}),v.jsx(et,{variant:e==="month"?"default":"outline",size:"sm",onClick:()=>n("month"),children:"Month"}),v.jsx(et,{variant:e==="all"?"default":"outline",size:"sm",onClick:()=>n("all"),children:"All"})]})]}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{className:"text-base font-medium",children:"Range of Motion"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map(l=>({date:new Date(l.date),value:l.rangeOfMotion||0})),timeRange:e,dataKey:"rangeOfMotion",color:"#1976D2"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between text-sm text-neutral-700 mb-1",children:[v.jsx("span",{children:"Current"}),v.jsxs("span",{className:"font-medium",children:[s.current,"°"]})]}),v.jsxs("div",{className:"flex justify-between text-sm text-neutral-700 mb-1",children:[v.jsx("span",{children:"Goal"}),v.jsxs("span",{className:"font-medium",children:[s.goal,"°"]})]}),v.jsx(dx,{value:s.current/s.goal*100,color:"green"}),v.jsxs("p",{className:"text-sm text-green-600 mt-2 font-medium flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),"Improved ",s.improvement,"° this month"]})]})]})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{className:"text-base font-medium",children:"Posture Quality"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map(l=>({date:new Date(l.date),value:l.postureQuality||0})),timeRange:e,dataKey:"postureQuality",color:"#4CAF50"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[v.jsxs("div",{className:"bg-green-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Good"}),v.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[a.good,"%"]})]}),v.jsxs("div",{className:"bg-yellow-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Fair"}),v.jsxs("p",{className:"text-lg font-semibold text-yellow-600",children:[a.fair,"%"]})]}),v.jsxs("div",{className:"bg-red-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Poor"}),v.jsxs("p",{className:"text-lg font-semibold text-red-600",children:[a.poor,"%"]})]})]}),v.jsxs("p",{className:"text-sm text-green-600 mt-2 font-medium flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),"Improved ",a.improvement,"% this month"]})]})]})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{className:"text-base font-medium",children:"Recovery Timeline"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map((l,c,u)=>({date:new Date(l.date),value:(u.length-c)/u.length*100})),timeRange:e,dataKey:"recoveryTimeline",color:"#FF5722"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("p",{className:"text-xs text-neutral-500",children:"AI Prediction"}),v.jsxs("p",{className:"text-lg font-semibold text-primary",children:["Full Recovery: ",o.estimatedDate]})]}),v.jsxs("div",{className:"bg-primary-light bg-opacity-10 text-primary rounded-full px-3 py-1 text-sm font-medium",children:[o.weeksEarly," weeks early"]})]}),v.jsxs("div",{className:"mt-3",children:[v.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[v.jsx("span",{className:"text-neutral-600",children:"Overall Progress"}),v.jsxs("span",{className:"text-neutral-800 font-medium",children:[o.progress,"%"]})]}),v.jsx(dx,{value:o.progress,color:"green"})]})]})]})]})]})]})},Vxt=Jk("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function qr({className:t,variant:e,...n}){return v.jsx("div",{className:Pt(Vxt({variant:e}),t),...n})}const Wxt=({userId:t})=>{const{data:e,isLoading:n}=Kr({queryKey:[`/api/therapist-notes/${t}`]}),r=e==null?void 0:e[0],i=a=>a?new Date(a).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",s=a=>!a||a.length===0?null:a.map((o,l)=>{let c=v.jsx(br,{className:"h-4 w-4 mr-1"}),u="bg-blue-100 text-primary";return o.includes("progress")?(c=v.jsx(br,{className:"h-4 w-4 mr-1"}),u="bg-blue-100 text-primary"):o.includes("new exercise")?(c=v.jsx(br,{className:"h-4 w-4 mr-1"}),u="bg-green-100 text-green-700"):(o.includes("posture")||o.includes("correction"))&&(c=v.jsx(z0,{className:"h-4 w-4 mr-1"}),u="bg-yellow-100 text-yellow-800"),v.jsxs(qr,{variant:"outline",className:`mr-2 mb-2 ${u} flex items-center`,children:[c,o]},l)});return v.jsxs("div",{className:"mb-8",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:"Therapist Notes & Recommendations"}),v.jsx(Lc,{href:"/therapist",children:v.jsxs(et,{variant:"ghost",className:"text-primary font-medium flex items-center",children:[v.jsx(Zie,{className:"h-5 w-5 mr-1"}),"Message Therapist"]})})]}),v.jsx(Dt,{children:v.jsx(Lt,{className:"p-6",children:n?v.jsxs("div",{className:"flex flex-col space-y-2 animate-pulse",children:[v.jsx("div",{className:"h-6 bg-gray-200 rounded w-1/4"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/3"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-full mt-4"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]}):r?v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-medium text-lg mr-4",children:"DR"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("h3",{className:"font-medium text-neutral-800",children:"Dr. Rachel Stevens"}),v.jsx("span",{className:"text-neutral-500 text-sm ml-2",children:i(r.date)})]}),v.jsx("div",{className:"mt-2 text-neutral-700 whitespace-pre-line",children:r.notes.split(`
`).map((a,o)=>v.jsx("p",{className:o>0?"mt-2":"",children:a},o))}),v.jsx("div",{className:"mt-4 flex flex-wrap",children:s(r.flags)})]})]}):v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-neutral-600",children:"No therapist notes available."})})})})]})},Hxt=()=>v.jsx("div",{className:"mb-8",children:v.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-green-500 rounded-xl shadow-md overflow-hidden",children:v.jsxs("div",{className:"p-6 md:p-8 flex flex-col md:flex-row",children:[v.jsxs("div",{className:"md:w-2/3 text-white",children:[v.jsx("h2",{className:"text-2xl font-bold font-heading",children:"GutrehaB"}),v.jsx("p",{className:"mt-2",children:"Our one-in-all solution for all gut problems coupled with mental wellbeing programs for a deep rooted holistic approach."}),v.jsxs("div",{className:"mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4",children:[v.jsxs("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium",children:"Gut Health Assessment"}),v.jsx("p",{className:"mt-1 text-sm text-teal-100",children:"Comprehensive analysis of your digestive system health"}),v.jsx(Lc,{href:"/gutrehab?assessment=true",children:v.jsx(et,{className:"mt-3 bg-teal-600 hover:bg-teal-700 text-white border-none",children:"Take Assessment"})})]}),v.jsxs("div",{className:"bg-white bg-opacity-20 rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium",children:"Mental Wellbeing"}),v.jsx("p",{className:"mt-1 text-sm text-teal-100",children:"Mindfulness and stress reduction techniques"}),v.jsx(Lc,{href:"/gutrehab?programs=true",children:v.jsx(et,{className:"mt-3 bg-teal-600 hover:bg-teal-700 text-white border-none",children:"Explore Programs"})})]})]}),v.jsx(Lc,{href:"/gutrehab",children:v.jsx(et,{className:"mt-6 bg-white text-teal-600 hover:bg-teal-50 font-medium transition-colors",children:"Learn More About GutrehaB"})})]}),v.jsx("div",{className:"md:w-1/3 mt-6 md:mt-0 flex items-center justify-center",children:v.jsx("div",{className:"w-full h-64 bg-teal-400 rounded-lg overflow-hidden flex items-center justify-center",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 text-white opacity-75",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})})})]})})}),Gxt=({userId:t})=>{const[e,n]=P.useState("weekly"),{data:r,isLoading:i}=Kr({queryKey:[`/api/engagement/${t}`]}),s=r==null?void 0:r[0],a=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],o=c=>["Mon","Tue","Wed","Thu"].includes(c),l=[{name:"Shoulder Program",date:"Thu, May 18",time:"3:00 PM",status:"completed"},{name:"Shoulder Program",date:"Wed, May 17",time:"3:15 PM",status:"completed"},{name:"Shoulder Program",date:"Tue, May 16",time:"3:00 PM",status:"missed"}];return v.jsxs("div",{className:"mb-8",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:"Your Engagement"}),v.jsxs("div",{className:"flex items-center text-sm",children:[v.jsx("span",{className:"text-neutral-600 mr-2",children:"View:"}),v.jsx(et,{variant:e==="weekly"?"default":"outline",size:"sm",onClick:()=>n("weekly"),children:"Weekly"}),v.jsx(et,{variant:e==="monthly"?"default":"outline",size:"sm",className:"ml-2",onClick:()=>n("monthly"),children:"Monthly"})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsx(Dt,{children:v.jsxs(Lt,{className:"p-4",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("h3",{className:"font-heading font-medium text-neutral-800",children:"Weekly Score"}),v.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold text-lg",children:"A"})]}),v.jsx("div",{className:"mt-6 flex flex-col items-center",children:v.jsxs("div",{className:"relative w-32 h-32",children:[v.jsxs("svg",{viewBox:"0 0 36 36",className:"w-full h-full",children:[v.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e0e0e0",strokeWidth:"3"}),v.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#4CAF50",strokeWidth:"3",strokeDasharray:`${i?0:(s==null?void 0:s.weeklyScore)||85}, 100`})]}),v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsxs("div",{className:"text-center",children:[v.jsx("span",{className:"text-3xl font-bold text-green-600",children:i?"--":(s==null?void 0:s.weeklyScore)||85}),v.jsx("span",{className:"text-sm text-neutral-600 block",children:"points"})]})})]})}),v.jsx("div",{className:"mt-4 text-center",children:v.jsxs("p",{className:"text-green-600 font-medium flex items-center justify-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M12 7a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0V8.414l-4.293 4.293a1 1 0 01-1.414 0L8 10.414l-4.293 4.293a1 1 0 01-1.414-1.414l5-5a1 1 0 011.414 0L11 10.586 14.586 7H12z",clipRule:"evenodd"})}),"+12 from last week"]})})]})}),v.jsx(Dt,{children:v.jsxs(Lt,{className:"p-4",children:[v.jsx("h3",{className:"font-heading font-medium text-neutral-800",children:"Check-in Streak"}),v.jsx("div",{className:"mt-4 grid grid-cols-7 gap-2",children:a.map((c,u)=>v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-xs text-neutral-500 mb-1",children:c}),v.jsx("div",{className:Pt("h-10 w-10 mx-auto rounded-full flex items-center justify-center",o(c)?"bg-green-500":"bg-gray-200"),children:o(c)?v.jsx(qie,{className:"h-5 w-5 text-white"}):v.jsx("span",{className:"text-neutral-500 font-medium",children:c.substring(0,1)})})]},u))}),v.jsxs("div",{className:"mt-6 text-center",children:[v.jsxs("p",{className:"text-lg font-bold text-primary",children:[i?"--":(s==null?void 0:s.checkInStreak)||4," Day Streak!"]}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Keep it up to earn bonus points"})]})]})}),v.jsx(Dt,{children:v.jsxs(Lt,{className:"p-4",children:[v.jsx("h3",{className:"font-heading font-medium text-neutral-800",children:"Session Completion"}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between text-sm text-neutral-700 mb-1",children:[v.jsx("span",{children:"This Week"}),v.jsx("span",{className:"font-medium",children:"4/5 sessions"})]}),v.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-green-500 rounded-full",style:{width:"80%"}})}),v.jsxs("div",{className:"flex justify-between text-sm text-neutral-700 mb-1 mt-3",children:[v.jsx("span",{children:"Last Week"}),v.jsx("span",{className:"font-medium",children:"3/5 sessions"})]}),v.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-yellow-500 rounded-full",style:{width:"60%"}})}),v.jsxs("div",{className:"mt-6",children:[v.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"Recent Sessions"}),v.jsx("div",{className:"space-y-3",children:l.map((c,u)=>v.jsxs("div",{className:Pt("flex justify-between items-center p-2 rounded-md",c.status==="completed"?"bg-green-50":"bg-red-50"),children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-neutral-800",children:c.name}),v.jsxs("p",{className:"text-xs text-neutral-500",children:[c.date," • ",c.time]})]}),v.jsx("span",{className:Pt("text-xs font-medium px-2 py-1 rounded",c.status==="completed"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"),children:c.status==="completed"?"Completed":"Missed"})]},u))})]})]})]})})]})]})},VH=P.forwardRef(({className:t,...e},n)=>v.jsx("div",{className:"relative w-full overflow-auto",children:v.jsx("table",{ref:n,className:Pt("w-full caption-bottom text-sm",t),...e})}));VH.displayName="Table";const WH=P.forwardRef(({className:t,...e},n)=>v.jsx("thead",{ref:n,className:Pt("[&_tr]:border-b",t),...e}));WH.displayName="TableHeader";const HH=P.forwardRef(({className:t,...e},n)=>v.jsx("tbody",{ref:n,className:Pt("[&_tr:last-child]:border-0",t),...e}));HH.displayName="TableBody";const qxt=P.forwardRef(({className:t,...e},n)=>v.jsx("tfoot",{ref:n,className:Pt("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...e}));qxt.displayName="TableFooter";const Fd=P.forwardRef(({className:t,...e},n)=>v.jsx("tr",{ref:n,className:Pt("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...e}));Fd.displayName="TableRow";const Cc=P.forwardRef(({className:t,...e},n)=>v.jsx("th",{ref:n,className:Pt("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...e}));Cc.displayName="TableHead";const Da=P.forwardRef(({className:t,...e},n)=>v.jsx("td",{ref:n,className:Pt("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...e}));Da.displayName="TableCell";const Xxt=P.forwardRef(({className:t,...e},n)=>v.jsx("caption",{ref:n,className:Pt("mt-4 text-sm text-muted-foreground",t),...e}));Xxt.displayName="TableCaption";const Kxt=({userId:t})=>{const{data:e,isLoading:n}=Kr({queryKey:[`/api/payments/${t}`]}),r=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s/100),i=s=>new Date(s).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return v.jsxs("div",{className:"mb-8",children:[v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:"Billing & Payments"}),v.jsx(Lc,{href:"/payments",children:v.jsx(et,{variant:"ghost",className:"text-primary font-medium",children:"View All"})})]}),v.jsx(Dt,{children:v.jsxs(Lt,{className:"p-6",children:[v.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg text-neutral-800",children:"Premium Rehabilitation Plan"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"Includes unlimited sessions, therapist consultations, and premium features"})]}),v.jsxs("div",{className:"mt-4 md:mt-0",children:[v.jsx("span",{className:"text-2xl font-bold",children:"$49.99"}),v.jsx("span",{className:"text-neutral-600",children:"/month"})]})]}),v.jsxs("div",{className:"mt-6 border-t pt-6",children:[v.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"Payment Methods"}),v.jsxs("div",{className:"flex flex-col md:flex-row md:items-center space-y-3 md:space-y-0 md:space-x-3",children:[v.jsxs("div",{className:"p-3 border rounded-lg flex items-center flex-1",children:[v.jsx("div",{className:"h-10 w-10 bg-blue-100 rounded-md flex items-center justify-center mr-3",children:v.jsx(Yie,{className:"h-6 w-6 text-primary"})}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-neutral-800",children:"Visa ending in 4242"}),v.jsx("p",{className:"text-xs text-neutral-500",children:"Expires 05/2024"})]}),v.jsx("div",{className:"ml-auto",children:v.jsx(qr,{variant:"outline",className:"bg-green-100 text-green-800 border-none",children:"Default"})})]}),v.jsxs(et,{variant:"outline",className:"py-3 border-dashed text-neutral-600 hover:bg-gray-50 flex items-center justify-center",children:[v.jsx(Qie,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})]}),v.jsxs("div",{className:"mt-6 border-t pt-6",children:[v.jsx("h4",{className:"text-sm font-medium text-neutral-700 mb-3",children:"Billing History"}),v.jsx("div",{className:"overflow-x-auto",children:v.jsxs(VH,{children:[v.jsx(WH,{children:v.jsxs(Fd,{children:[v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Date"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Description"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Amount"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Status"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Receipt"})]})}),v.jsx(HH,{children:n?v.jsx(Fd,{children:v.jsx(Da,{colSpan:5,className:"text-center py-4",children:"Loading payment history..."})}):e&&e.length>0?e.slice(0,3).map(s=>v.jsxs(Fd,{children:[v.jsx(Da,{className:"text-sm text-neutral-600",children:i(s.date)}),v.jsx(Da,{className:"text-sm text-neutral-600",children:s.description}),v.jsx(Da,{className:"text-sm font-medium text-neutral-800",children:r(s.amount)}),v.jsx(Da,{children:v.jsx(qr,{variant:"outline",className:s.status==="processed"?"bg-green-100 text-green-800 border-none":"bg-yellow-100 text-yellow-800 border-none",children:s.status==="processed"?"Paid":"Pending"})}),v.jsx(Da,{className:"text-sm text-primary",children:s.receiptUrl?v.jsx("a",{href:s.receiptUrl,className:"hover:underline",children:"Download"}):v.jsx("span",{className:"text-neutral-400",children:"N/A"})})]},s.id)):v.jsx(Fd,{children:v.jsx(Da,{colSpan:5,className:"text-center py-4",children:"No payment records found."})})})]})})]})]})})]})},Yxt=()=>v.jsxs(Dt,{className:"mb-6 bg-gradient-to-br from-indigo-50 to-blue-50",children:[v.jsxs(en,{children:[v.jsxs(tn,{className:"flex items-center gap-2",children:[v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[v.jsx("path",{d:"M3 8V6a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v2"}),v.jsx("path",{d:"M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V8"}),v.jsx("path",{d:"M3 12h18"}),v.jsx("path",{d:"M12 16a2 2 0 0 1 0-4"})]}),"Immersive Therapy"]}),v.jsx(Nr,{children:"Experience rehabilitation in virtual and augmented reality"})]}),v.jsxs(Lt,{children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsx("div",{className:"bg-white p-5 rounded-lg border border-gray-100 shadow-sm",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg text-primary-dark mb-2",children:"VR Therapy"}),v.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Engage in immersive rehabilitation exercises in a virtual environment with gamified elements."}),v.jsxs("ul",{className:"text-sm space-y-1 mb-4",children:[v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Customizable virtual environments"]}),v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Interactive exercise guidance"]}),v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Real-time progress tracking"]})]}),v.jsx(Lc,{href:"/vr-therapy",children:v.jsx(et,{className:"w-full",children:"Try VR Therapy"})})]}),v.jsx("div",{className:"hidden md:block bg-blue-100 rounded-lg p-3 h-24 w-24 flex items-center justify-center",children:v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-blue-600",children:[v.jsx("path",{d:"M3 7v2a3 3 0 0 0 3 3h12a3 3 0 0 0 3-3V7"}),v.jsx("path",{d:"M9 13v4"}),v.jsx("path",{d:"M15 13v4"}),v.jsx("path",{d:"M6 20a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2v-7H6v7Z"}),v.jsx("path",{d:"M4 7V5a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v2"})]})})]})}),v.jsx("div",{className:"bg-white p-5 rounded-lg border border-gray-100 shadow-sm",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg text-primary-dark mb-2",children:"AR Therapy"}),v.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Use your mobile device to see exercise guides overlaid on your real environment."}),v.jsxs("ul",{className:"text-sm space-y-1 mb-4",children:[v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Works on most mobile devices"]}),v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Camera-based movement analysis"]}),v.jsxs("li",{className:"flex items-center",children:[v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 text-green-500 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:v.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Real-world environment integration"]})]}),v.jsx(Lc,{href:"/ar-therapy",children:v.jsx(et,{variant:"outline",className:"w-full",children:"Try AR Therapy"})})]}),v.jsx("div",{className:"hidden md:block bg-indigo-100 rounded-lg p-3 h-24 w-24 flex items-center justify-center",children:v.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-indigo-600",children:[v.jsx("rect",{width:"20",height:"14",x:"2",y:"3",rx:"2"}),v.jsx("line",{x1:"8",x2:"16",y1:"21",y2:"21"}),v.jsx("line",{x1:"12",x2:"12",y1:"17",y2:"21"})]})})]})})]}),v.jsx("div",{className:"mt-4 text-center",children:v.jsx("p",{className:"text-sm text-gray-500",children:"Both VR and AR therapy sessions are tracked and integrated with your progress reports."})})]})]}),Zxt=()=>v.jsxs(nd,{children:[v.jsx(DAe,{userId:1}),v.jsx(tqe,{userId:1}),v.jsx(Uxt,{userId:1}),v.jsx(Wxt,{userId:1}),v.jsx(Yxt,{}),v.jsx(Hxt,{}),v.jsx(Gxt,{userId:1}),v.jsx(Kxt,{userId:1})]});var Qxt=P.createContext(void 0);function OP(t){const e=P.useContext(Qxt);return t||e||"ltr"}var CL="rovingFocusGroup.onEntryFocus",Jxt={bubbles:!1,cancelable:!0},oE="RovingFocusGroup",[t4,Dpe,e0t]=Yk(oE),[t0t,$pe]=Yl(oE,[e0t]),[n0t,r0t]=t0t(oE),Lpe=P.forwardRef((t,e)=>v.jsx(t4.Provider,{scope:t.__scopeRovingFocusGroup,children:v.jsx(t4.Slot,{scope:t.__scopeRovingFocusGroup,children:v.jsx(i0t,{...t,ref:e})})}));Lpe.displayName=oE;var i0t=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:i=!1,dir:s,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=t,h=P.useRef(null),f=Vn(e,h),p=OP(s),[g,m]=zf({prop:a,defaultProp:o??null,onChange:l,caller:oE}),[y,x]=P.useState(!1),b=Jo(c),_=Dpe(n),T=P.useRef(!1),[E,C]=P.useState(0);return P.useEffect(()=>{const I=h.current;if(I)return I.addEventListener(CL,b),()=>I.removeEventListener(CL,b)},[b]),v.jsx(n0t,{scope:n,orientation:r,dir:p,loop:i,currentTabStopId:g,onItemFocus:P.useCallback(I=>m(I),[m]),onItemShiftTab:P.useCallback(()=>x(!0),[]),onFocusableItemAdd:P.useCallback(()=>C(I=>I+1),[]),onFocusableItemRemove:P.useCallback(()=>C(I=>I-1),[]),children:v.jsx(Wt.div,{tabIndex:y||E===0?-1:0,"data-orientation":r,...d,ref:f,style:{outline:"none",...t.style},onMouseDown:kt(t.onMouseDown,()=>{T.current=!0}),onFocus:kt(t.onFocus,I=>{const A=!T.current;if(I.target===I.currentTarget&&A&&!y){const k=new CustomEvent(CL,Jxt);if(I.currentTarget.dispatchEvent(k),!k.defaultPrevented){const R=_().filter(B=>B.focusable),$=R.find(B=>B.active),z=R.find(B=>B.id===g),j=[$,z,...R].filter(Boolean).map(B=>B.ref.current);zpe(j,u)}}T.current=!1}),onBlur:kt(t.onBlur,()=>x(!1))})})}),Fpe="RovingFocusGroupItem",jpe=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:i=!1,tabStopId:s,children:a,...o}=t,l=Ud(),c=s||l,u=r0t(Fpe,n),d=u.currentTabStopId===c,h=Dpe(n),{onFocusableItemAdd:f,onFocusableItemRemove:p,currentTabStopId:g}=u;return P.useEffect(()=>{if(r)return f(),()=>p()},[r,f,p]),v.jsx(t4.ItemSlot,{scope:n,id:c,focusable:r,active:i,children:v.jsx(Wt.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:e,onMouseDown:kt(t.onMouseDown,m=>{r?u.onItemFocus(c):m.preventDefault()}),onFocus:kt(t.onFocus,()=>u.onItemFocus(c)),onKeyDown:kt(t.onKeyDown,m=>{if(m.key==="Tab"&&m.shiftKey){u.onItemShiftTab();return}if(m.target!==m.currentTarget)return;const y=o0t(m,u.orientation,u.dir);if(y!==void 0){if(m.metaKey||m.ctrlKey||m.altKey||m.shiftKey)return;m.preventDefault();let b=h().filter(_=>_.focusable).map(_=>_.ref.current);if(y==="last")b.reverse();else if(y==="prev"||y==="next"){y==="prev"&&b.reverse();const _=b.indexOf(m.currentTarget);b=u.loop?l0t(b,_+1):b.slice(_+1)}setTimeout(()=>zpe(b))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:g!=null}):a})})});jpe.displayName=Fpe;var s0t={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function a0t(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function o0t(t,e,n){const r=a0t(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return s0t[r]}function zpe(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function l0t(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var c0t=Lpe,u0t=jpe,DP="Tabs",[d0t,X3t]=Yl(DP,[$pe]),Bpe=$pe(),[h0t,GH]=d0t(DP),Upe=P.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:i,defaultValue:s,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=t,u=OP(o),[d,h]=zf({prop:r,onChange:i,defaultProp:s??"",caller:DP});return v.jsx(h0t,{scope:n,baseId:Ud(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:v.jsx(Wt.div,{dir:u,"data-orientation":a,...c,ref:e})})});Upe.displayName=DP;var Vpe="TabsList",Wpe=P.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...i}=t,s=GH(Vpe,n),a=Bpe(n);return v.jsx(c0t,{asChild:!0,...a,orientation:s.orientation,dir:s.dir,loop:r,children:v.jsx(Wt.div,{role:"tablist","aria-orientation":s.orientation,...i,ref:e})})});Wpe.displayName=Vpe;var Hpe="TabsTrigger",Gpe=P.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:i=!1,...s}=t,a=GH(Hpe,n),o=Bpe(n),l=Kpe(a.baseId,r),c=Ype(a.baseId,r),u=r===a.value;return v.jsx(u0t,{asChild:!0,...o,focusable:!i,active:u,children:v.jsx(Wt.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:l,...s,ref:e,onMouseDown:kt(t.onMouseDown,d=>{!i&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:kt(t.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:kt(t.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!i&&d&&a.onValueChange(r)})})})});Gpe.displayName=Hpe;var qpe="TabsContent",Xpe=P.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:i,children:s,...a}=t,o=GH(qpe,n),l=Kpe(o.baseId,r),c=Ype(o.baseId,r),u=r===o.value,d=P.useRef(u);return P.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),v.jsx(mh,{present:i||u,children:({present:h})=>v.jsx(Wt.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:e,style:{...t.style,animationDuration:d.current?"0s":void 0},children:h&&s})})});Xpe.displayName=qpe;function Kpe(t,e){return`${t}-trigger-${e}`}function Ype(t,e){return`${t}-content-${e}`}var f0t=Upe,Zpe=Wpe,Qpe=Gpe,Jpe=Xpe;const oy=f0t,Np=P.forwardRef(({className:t,...e},n)=>v.jsx(Zpe,{ref:n,className:Pt("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Np.displayName=Zpe.displayName;const oi=P.forwardRef(({className:t,...e},n)=>v.jsx(Qpe,{ref:n,className:Pt("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...e}));oi.displayName=Qpe.displayName;const li=P.forwardRef(({className:t,...e},n)=>v.jsx(Jpe,{ref:n,className:Pt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));li.displayName=Jpe.displayName;const p0t=({canvasRef:t,color:e="#1976D2",showDetails:n=!0,onToggleDetails:r})=>(P.useEffect(()=>{if(t.current){const s=t.current.parentElement;s&&(t.current.width=s.clientWidth,t.current.height=s.clientHeight)}const i=()=>{if(t.current){const s=t.current.parentElement;s&&(t.current.width=s.clientWidth,t.current.height=s.clientHeight)}};return window.addEventListener("resize",i),()=>{window.removeEventListener("resize",i)}},[t]),v.jsxs(v.Fragment,{children:[v.jsx("canvas",{ref:t,className:"absolute top-0 left-0 w-full h-full skeleton-overlay"}),r&&v.jsx("button",{onClick:r,className:"absolute bottom-4 left-4 bg-black bg-opacity-60 text-white text-xs px-3 py-1 rounded-full hover:bg-opacity-80 transition-opacity flex items-center",children:n?v.jsxs(v.Fragment,{children:[v.jsx(eCe,{className:"h-3 w-3 mr-1"}),"Hide Details"]}):v.jsxs(v.Fragment,{children:[v.jsx(tCe,{className:"h-3 w-3 mr-1"}),"Show Details"]})})]})),m0t=({onPoseDetected:t,showControls:e=!0,autoStart:n=!1,width:r="100%",height:i="100%",showJointDetails:s=!0})=>{const a=P.useRef(null),o=P.useRef(null),[l,c]=P.useState(n),[u,d]=P.useState(!1),{videoReady:h,videoError:f,startWebcam:p,stopWebcam:g}=lae(a),{poses:m,isDetecting:y,showDetails:x,toggleDetails:b,startPoseDetection:_,stopPoseDetection:T}=sde(a,o);P.useEffect(()=>{t&&m&&t(m)},[m,t]);const E=async()=>{try{d(!0),await p(),d(!1)}catch(I){console.error("Failed to initialize camera:",I),d(!1)}};P.useEffect(()=>(l?E():(g(),T()),()=>{g(),T()}),[l,g,T]),P.useEffect(()=>{h&&l&&_()},[h,l,_]);const C=async()=>{if(l)c(!1),g(),T();else{d(!0),c(!0);try{await p()}catch(I){console.error("Error in toggleTracking:",I)}}};return P.useEffect(()=>{n&&!l&&(d(!0),c(!0),(async()=>{try{await p()}catch(I){console.error("Failed to auto-start camera:",I)}finally{d(!1)}})())},[n,l,p]),v.jsx("div",{className:"relative",style:{width:r,height:i},children:v.jsxs("div",{className:"webcam-container relative aspect-video bg-black rounded-lg overflow-hidden",children:[l?v.jsxs(v.Fragment,{children:[v.jsx("video",{ref:a,className:"w-full h-full object-cover",autoPlay:!0,playsInline:!0}),v.jsx(p0t,{canvasRef:o,showDetails:x,onToggleDetails:b}),!h&&!f&&v.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70",children:v.jsxs("div",{className:"text-center text-white p-4 rounded",children:[v.jsx("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-3"}),v.jsx("p",{className:"mb-2",children:"Initializing camera..."}),v.jsx("p",{className:"text-xs text-gray-300",children:"You may need to allow camera access in your browser"})]})}),f&&v.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-70",children:v.jsxs("div",{className:"text-center text-white max-w-md p-6 rounded bg-red-900 bg-opacity-40",children:[v.jsx(IA,{className:"h-10 w-10 mx-auto mb-3 text-red-500"}),v.jsx("h3",{className:"text-lg font-medium mb-2",children:"Camera Access Error"}),v.jsx("p",{className:"mb-4 text-sm opacity-90",children:f.includes("denied")||f.includes("permission")?"Please allow camera access to use motion tracking features. You might need to check your browser settings.":f.includes("browser")?f:"There was a problem accessing your camera. Please check your device and try again."}),v.jsxs("div",{className:"flex flex-col gap-2",children:[v.jsx(et,{onClick:C,variant:"outline",className:"border-white text-white hover:bg-white hover:text-red-800",children:"Try Again"}),v.jsx("p",{className:"text-xs mt-2",children:"Note: Motion tracking requires a camera. If you're using a device without a camera or in an environment where camera access is restricted, some features may not work."})]})]})}),h&&!y&&v.jsx("div",{className:"absolute top-0 left-0 m-2 px-3 py-1 bg-yellow-500 text-black text-xs rounded",children:v.jsxs("div",{className:"flex items-center",children:[v.jsx(z0,{className:"h-3 w-3 mr-1"}),"Initializing motion tracking..."]})}),y&&v.jsx("div",{className:"absolute top-0 left-0 m-2 px-3 py-1 bg-green-500 text-black text-xs rounded",children:v.jsxs("div",{className:"flex items-center",children:[v.jsx("div",{className:"h-2 w-2 mr-1 rounded-full bg-green-900 animate-pulse"}),"Motion tracking active"]})})]}):v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsxs("div",{className:"text-center text-white p-6 max-w-md",children:[v.jsx(Gie,{className:"h-12 w-12 mx-auto mb-4 opacity-60"}),v.jsx("h3",{className:"text-xl font-medium mb-2",children:"Motion Analysis"}),v.jsx("p",{className:"mb-6 opacity-80",children:"Enable your camera to start real-time posture analysis and exercise tracking"}),v.jsx(et,{onClick:C,size:"lg",children:u?v.jsxs(v.Fragment,{children:[v.jsx("div",{className:"animate-spin mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full"}),"Starting Camera..."]}):v.jsx(v.Fragment,{children:"Enable Camera"})})]})}),e&&l&&v.jsx("div",{className:"absolute bottom-4 right-4 flex space-x-2",children:v.jsxs(et,{variant:"outline",size:"sm",className:"bg-white hover:bg-gray-100 text-gray-800",onClick:C,children:[v.jsx(IA,{className:"h-4 w-4 mr-1"}),"Stop Camera"]})})]})})};function g0t(t,e){switch(e){case"shoulderFlexion":return y0t(t);case"shoulderExternalRotation":return v0t(t);case"scapularRetraction":return x0t(t);case"pendulumExercise":return b0t(t);default:return{isCorrectForm:!1,angle:0,issues:["Unknown exercise type"]}}}function y0t(t){const e=[];let n=!0,r=0;const i=Fa(t,"right_shoulder"),s=Fa(t,"right_elbow"),a=Fa(t,"right_wrist"),o=Fa(t,"right_hip");if(!i||!s||!a||!o)return{isCorrectForm:!1,angle:0,issues:["Cannot detect all required body points. Please adjust your position."]};r=t0(o,i,s),r<45&&(e.push("Raise your arm higher"),n=!1),t0(i,s,a)<160&&(e.push("Keep your arm straight during the movement"),n=!1);const c=Fa(t,"left_shoulder");return c&&i&&Math.abs(c.y-i.y)>30&&(e.push("Keep your shoulders level"),n=!1),{isCorrectForm:n,angle:r,issues:e}}function v0t(t){const e=[];let n=!0,r=0;const i=Fa(t,"right_shoulder"),s=Fa(t,"right_elbow"),a=Fa(t,"right_wrist");if(!i||!s||!a)return{isCorrectForm:!1,angle:0,issues:["Cannot detect all required body points. Please adjust your position."]};r=t0(i,s,a);const o=Fa(t,"right_hip");return o&&s&&Math.sqrt(Math.pow(s.x-o.x,2)+Math.pow(s.y-o.y,2))>50&&(e.push("Keep your elbow close to your body"),n=!1),r<30&&(e.push("Rotate your arm outward more"),n=!1),{isCorrectForm:n,angle:r,issues:e}}function x0t(t){const e=[];let n=!0,r=0;const i=Fa(t,"left_shoulder"),s=Fa(t,"right_shoulder");if(((i==null?void 0:i.x)||0+(s==null?void 0:s.x)||0)/2,((i==null?void 0:i.y)||0+(s==null?void 0:s.y)||0)/2+40,!i||!s)return{isCorrectForm:!1,angle:0,issues:["Cannot detect shoulders. Please adjust your position."]};const a=Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2));return r=a,a<100&&(e.push("Pull your shoulder blades together more"),n=!1),Math.abs(i.y-s.y)>20&&(e.push("Keep your shoulders level"),n=!1),{isCorrectForm:n,angle:r,issues:e}}function b0t(t){const e=[];let n=!0,r=0;const i=Fa(t,"right_shoulder"),s=Fa(t,"right_elbow"),a=Fa(t,"right_wrist"),o=Fa(t,"right_hip");return!i||!s||!a||!o?{isCorrectForm:!1,angle:0,issues:["Cannot detect all required body points. Please adjust your position."]}:(t0({x:i.x,y:0},i,o)<30&&(e.push("Bend forward more at the waist"),n=!1),r=t0(i,s,a),r<160&&(e.push("Keep your arm relaxed and straight"),n=!1),{isCorrectForm:n,angle:r,issues:e})}const w0t=()=>{const[t,e]=P.useState(0),[n,r]=P.useState(0),[i,s]=P.useState([]),[a,o]=P.useState([]),[l,c]=P.useState(!1),u=P.useRef({inRepetition:!1,currentAngle:0,repetitionThreshold:30,lastFeedbackTime:0,poseHistory:[],feedbackCooldown:2e3}),d=P.useCallback(()=>{e(0),r(0),s([]),o([]),u.current={inRepetition:!1,currentAngle:0,repetitionThreshold:30,lastFeedbackTime:0,poseHistory:[],feedbackCooldown:2e3}},[]),h=P.useCallback(()=>{d(),c(!0)},[d]),f=P.useCallback(()=>{c(!1)},[]),p=P.useCallback((g,m)=>{if(!l||!g||!g.keypoints||!m)return;const y=10;u.current.poseHistory.push(g),u.current.poseHistory.length>y&&u.current.poseHistory.shift();let x="shoulderFlexion";m.name.toLowerCase().includes("external rotation")?x="shoulderExternalRotation":m.name.toLowerCase().includes("retraction")?x="scapularRetraction":m.name.toLowerCase().includes("pendulum")&&(x="pendulumExercise");const b=g0t(g,x);u.current.currentAngle=b.angle;let _=45,T=20;if(x==="shoulderFlexion"?(_=60,T=30):x==="shoulderExternalRotation"?(_=30,T=15):x==="scapularRetraction"&&(_=120,T=100),u.current.repetitionThreshold=_,!b.isCorrectForm&&b.issues.length>0){const E=Date.now();E-u.current.lastFeedbackTime>u.current.feedbackCooldown&&(o(b.issues),u.current.lastFeedbackTime=E)}else if(b.isCorrectForm){if(a.length>0&&o([]),!u.current.inRepetition&&b.angle>_){u.current.inRepetition=!0;const E=Date.now();E-u.current.lastFeedbackTime>u.current.feedbackCooldown*2&&(o(["Good form! Keep going."]),u.current.lastFeedbackTime=E)}else if(u.current.inRepetition&&b.angle<T){u.current.inRepetition=!1;const E=t+1;e(E);const C=m.reps||12,I=m.sets||3,A=C*I,k=E/A*100;if(r(Math.min(k,100)),E%5===0?s(R=>[...R.slice(-4),`Great job! ${E} repetitions completed!`]):s(R=>[...R.slice(-4),`Repetition ${E} completed`]),E%C===0){const R=Math.ceil(E/C);R<I?o([`Set ${R} complete! Take a short break, then continue.`]):o(["All sets complete! Great work!"]),u.current.lastFeedbackTime=Date.now()}}}},[l,t,a]);return{repetitionCount:t,exerciseProgress:n,feedbackMessages:i,postureFeedback:a,registerPose:p,startExercise:h,stopExercise:f,resetExercise:d}},S0t=()=>{var z;const[t,e]=P.useState("live"),[n,r]=P.useState(null),[i,s]=P.useState(!1),[a,o]=P.useState(0),[l,c]=P.useState(1),[u,d]=P.useState([]),h=1,{data:f}=Kr({queryKey:[`/api/sessions/patient/${h}`]}),p=f==null?void 0:f.find(O=>{const j=new Date(O.date),B=new Date;return j.toDateString()===B.toDateString()}),{data:g,isLoading:m}=Kr({queryKey:[`/api/session-exercises/${p==null?void 0:p.id}`],enabled:!!(p!=null&&p.id)}),{data:y}=Kr({queryKey:["/api/exercises"]}),x=g==null?void 0:g.map(O=>{const j=y==null?void 0:y.find(B=>B.id===O.exerciseId);return{...O,details:j,completed:!1}}),b=(z=x==null?void 0:x.find(O=>O.exerciseId===n))==null?void 0:z.details,{repetitionCount:_,postureFeedback:T,registerPose:E,startExercise:C,stopExercise:I,resetExercise:A}=w0t(),k=O=>{!i||!O||O.length===0||E(O[0],b)},R=()=>{if(!g||g.length===0)return;const O=g[0];O&&(r(O.exerciseId),s(!0),setTimeout(()=>{C()},500))},$=()=>{if(I(),g&&n){const O=g.findIndex(j=>j.exerciseId===n);if(O>=0&&O<g.length-1){const j=g[O+1];j&&(r(j.exerciseId),A(),C())}else s(!1)}};return P.useEffect(()=>{_>0&&(o(_%((b==null?void 0:b.reps)||12)),c(Math.floor(_/((b==null?void 0:b.reps)||12))+1))},[_,b]),P.useEffect(()=>{d(T)},[T]),v.jsxs(nd,{title:"Therapy Session",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Therapy Session"}),v.jsx("p",{className:"text-neutral-600",children:"Complete your prescribed exercises with real-time AI guidance and posture correction."})]}),v.jsxs(oy,{defaultValue:"live",className:"mb-6",onValueChange:e,children:[v.jsxs(Np,{children:[v.jsx(oi,{value:"live",children:"Live Session"}),v.jsx(oi,{value:"schedule",children:"Schedule"}),v.jsx(oi,{value:"history",children:"Session History"})]}),v.jsx(li,{value:"live",className:"mt-4",children:v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsx("div",{className:"lg:col-span-2",children:v.jsxs(Dt,{className:"overflow-hidden",children:[v.jsxs(en,{className:"pb-2",children:[v.jsx(tn,{children:"Motion Tracking"}),v.jsx(Nr,{children:"Your camera will be used to track your movements and provide real-time feedback"})]}),v.jsxs(Lt,{className:"p-6",children:[v.jsx("div",{className:"webcam-container mb-4",children:v.jsx(m0t,{onPoseDetected:k,autoStart:i,showControls:!0,showJointDetails:!0,width:"100%",height:"auto"})}),i?v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg mb-4",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg text-neutral-800",children:(b==null?void 0:b.name)||"Exercise"}),v.jsx("p",{className:"text-neutral-600 text-sm mt-1",children:b==null?void 0:b.description})]}),v.jsxs("div",{className:"bg-primary text-white px-3 py-1 rounded-full text-sm",children:["Set ",l,"/",(b==null?void 0:b.sets)||3]})]}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[v.jsx("span",{className:"text-neutral-600",children:"Repetitions"}),v.jsxs("span",{className:"text-neutral-800 font-medium",children:[a,"/",(b==null?void 0:b.reps)||12," reps"]})]}),v.jsx(dx,{value:a/((b==null?void 0:b.reps)||12)*100,color:"green"})]})]}),v.jsxs("div",{className:"flex justify-end mt-4 space-x-2",children:[v.jsx(et,{variant:"outline",onClick:A,children:"Reset"}),v.jsx(et,{onClick:$,children:"Complete Exercise"})]})]}):v.jsx("div",{className:"flex justify-center mt-4",children:v.jsx(et,{onClick:R,disabled:!g||g.length===0,size:"lg",children:"Start Session"})})]})]})}),v.jsxs("div",{children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Session Progress"})}),v.jsx(Lt,{children:!m&&x?v.jsx("div",{className:"space-y-4",children:x.map((O,j)=>{var B;return v.jsx("div",{className:`p-3 rounded-lg border ${O.exerciseId===n?"border-primary bg-primary/5":O.completed?"border-green-500 bg-green-50":"border-gray-200"}`,children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:`h-6 w-6 rounded-full flex items-center justify-center flex-shrink-0 mr-3 ${O.exerciseId===n?"bg-primary text-white":O.completed?"bg-green-500 text-white":"bg-gray-200 text-gray-500"}`,children:O.exerciseId===n?v.jsx(EU,{className:"h-3 w-3"}):O.completed?v.jsx(br,{className:"h-3 w-3"}):j+1}),v.jsxs("div",{children:[v.jsx("p",{className:"font-medium text-neutral-800",children:((B=O.details)==null?void 0:B.name)||`Exercise ${j+1}`}),v.jsxs("p",{className:"text-xs text-neutral-500 mt-1",children:[O.sets," sets • ",O.reps," reps"]})]})]})},O.id)})}):v.jsx("div",{className:"flex items-center justify-center h-40",children:v.jsx("p",{className:"text-neutral-600",children:"No exercises scheduled for today"})})})]}),v.jsxs(Dt,{className:"mt-4",children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Posture Analysis"})}),v.jsx(Lt,{children:u.length>0?v.jsx("ul",{className:"space-y-2",children:u.map((O,j)=>v.jsxs("li",{className:"flex items-start text-sm",children:[v.jsx(z0,{className:"h-5 w-5 mr-2 text-yellow-500 flex-shrink-0"}),v.jsx("span",{children:O})]},j))}):i?v.jsx("div",{className:"flex items-center justify-center h-24",children:v.jsxs("div",{className:"text-center",children:[v.jsx(br,{className:"h-8 w-8 text-green-500 mx-auto mb-2"}),v.jsx("p",{className:"text-neutral-600",children:"Your posture looks good!"})]})}):v.jsx("div",{className:"flex items-center justify-center h-24",children:v.jsx("p",{className:"text-neutral-600",children:"Start a session to see real-time feedback"})})})]})]})]})}),v.jsx(li,{value:"schedule",className:"mt-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Session Schedule"}),v.jsx(Nr,{children:"View your upcoming therapy sessions"})]}),v.jsx(Lt,{children:v.jsx("div",{className:"space-y-4",children:f?f.length>0?f.map(O=>{const j=new Date(O.date),B=new Date,W=j.toDateString()===B.toDateString();return v.jsxs("div",{className:`p-4 rounded-lg border ${W?"border-primary bg-primary/5":"border-gray-200"}`,children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("h3",{className:"font-medium text-neutral-800",children:W?"Today":j.toLocaleDateString("en-US",{weekday:"long"})}),W&&v.jsx("span",{className:"ml-2 text-xs font-medium bg-primary text-white px-2 py-0.5 rounded-full",children:"Today"})]}),v.jsxs("p",{className:"text-sm text-neutral-600 mt-1",children:[j.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}),O.startTime&&` • ${new Date(O.startTime).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})}`]})]}),v.jsx("div",{className:`px-2 py-1 rounded text-xs font-medium ${O.status==="completed"?"bg-green-100 text-green-800":O.status==="missed"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:O.status.charAt(0).toUpperCase()+O.status.slice(1)})]}),W&&O.status==="scheduled"&&v.jsx("div",{className:"mt-3",children:v.jsx(et,{onClick:R,children:"Start Session"})})]},O.id)}):v.jsxs("div",{className:"text-center py-12",children:[v.jsx(IA,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),v.jsx("h3",{className:"font-medium text-neutral-800 mb-1",children:"No Sessions Scheduled"}),v.jsx("p",{className:"text-neutral-600",children:"You don't have any therapy sessions scheduled."})]}):v.jsx("div",{className:"py-12 text-center text-neutral-600",children:"Loading sessions..."})})})]})}),v.jsx(li,{value:"history",className:"mt-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Session History"}),v.jsx(Nr,{children:"Review your completed therapy sessions"})]}),v.jsx(Lt,{children:v.jsx("div",{className:"space-y-4",children:f?f.filter(O=>O.status==="completed").length>0?f.filter(O=>O.status==="completed").map(O=>{const j=new Date(O.date);return v.jsxs("div",{className:"p-4 rounded-lg border border-gray-200",children:[v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-neutral-800",children:"Therapy Session"}),v.jsx("p",{className:"text-sm text-neutral-600 mt-1",children:j.toLocaleDateString("en-US",{weekday:"long",month:"short",day:"numeric",year:"numeric"})})]}),v.jsx("div",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium",children:"Completed"})]}),v.jsx("div",{className:"mt-3 flex space-x-2",children:v.jsx(et,{variant:"outline",size:"sm",children:"View Details"})})]},O.id)}):v.jsxs("div",{className:"text-center py-12",children:[v.jsx(IA,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),v.jsx("h3",{className:"font-medium text-neutral-800 mb-1",children:"No Completed Sessions"}),v.jsx("p",{className:"text-neutral-600",children:"You haven't completed any therapy sessions yet."})]}):v.jsx("div",{className:"py-12 text-center text-neutral-600",children:"Loading session history..."})})})]})})]})]})},Il=P.forwardRef(({className:t,type:e,...n},r)=>v.jsx("input",{type:e,className:Pt("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:r,...n}));Il.displayName="Input";var _0t="Label",eme=P.forwardRef((t,e)=>v.jsx(Wt.label,{...t,ref:e,onMouseDown:n=>{var i;n.target.closest("button, input, select, textarea")||((i=t.onMouseDown)==null||i.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));eme.displayName=_0t;var tme=eme;const T0t=Jk("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Nc=P.forwardRef(({className:t,...e},n)=>v.jsx(tme,{ref:n,className:Pt(T0t(),t),...e}));Nc.displayName=tme.displayName;function E0t(){return Zre.useSyncExternalStore(C0t,()=>!0,()=>!1)}function C0t(){return()=>{}}var qH="Avatar",[N0t,K3t]=Yl(qH),[A0t,nme]=N0t(qH),rme=P.forwardRef((t,e)=>{const{__scopeAvatar:n,...r}=t,[i,s]=P.useState("idle");return v.jsx(A0t,{scope:n,imageLoadingStatus:i,onImageLoadingStatusChange:s,children:v.jsx(Wt.span,{...r,ref:e})})});rme.displayName=qH;var ime="AvatarImage",sme=P.forwardRef((t,e)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:i=()=>{},...s}=t,a=nme(ime,n),o=I0t(r,s),l=Jo(c=>{i(c),a.onImageLoadingStatusChange(c)});return Ki(()=>{o!=="idle"&&l(o)},[o,l]),o==="loaded"?v.jsx(Wt.img,{...s,ref:e,src:r}):null});sme.displayName=ime;var ame="AvatarFallback",ome=P.forwardRef((t,e)=>{const{__scopeAvatar:n,delayMs:r,...i}=t,s=nme(ame,n),[a,o]=P.useState(r===void 0);return P.useEffect(()=>{if(r!==void 0){const l=window.setTimeout(()=>o(!0),r);return()=>window.clearTimeout(l)}},[r]),a&&s.imageLoadingStatus!=="loaded"?v.jsx(Wt.span,{...i,ref:e}):null});ome.displayName=ame;function $Q(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function I0t(t,{referrerPolicy:e,crossOrigin:n}){const r=E0t(),i=P.useRef(null),s=r?(i.current||(i.current=new window.Image),i.current):null,[a,o]=P.useState(()=>$Q(s,t));return Ki(()=>{o($Q(s,t))},[s,t]),Ki(()=>{const l=d=>()=>{o(d)};if(!s)return;const c=l("loaded"),u=l("error");return s.addEventListener("load",c),s.addEventListener("error",u),e&&(s.referrerPolicy=e),typeof n=="string"&&(s.crossOrigin=n),()=>{s.removeEventListener("load",c),s.removeEventListener("error",u)}},[s,n,e]),a}var lme=rme,cme=sme,ume=ome;const XH=P.forwardRef(({className:t,...e},n)=>v.jsx(lme,{ref:n,className:Pt("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));XH.displayName=lme.displayName;const k0t=P.forwardRef(({className:t,...e},n)=>v.jsx(cme,{ref:n,className:Pt("aspect-square h-full w-full",t),...e}));k0t.displayName=cme.displayName;const KH=P.forwardRef(({className:t,...e},n)=>v.jsx(ume,{ref:n,className:Pt("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));KH.displayName=ume.displayName;var lE=t=>t.type==="checkbox",Om=t=>t instanceof Date,Pa=t=>t==null;const dme=t=>typeof t=="object";var Di=t=>!Pa(t)&&!Array.isArray(t)&&dme(t)&&!Om(t),hme=t=>Di(t)&&t.target?lE(t.target)?t.target.checked:t.target.value:t,M0t=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,fme=(t,e)=>t.has(M0t(e)),R0t=t=>{const e=t.constructor&&t.constructor.prototype;return Di(e)&&e.hasOwnProperty("isPrototypeOf")},YH=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function js(t){let e;const n=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)e=new Date(t);else if(t instanceof Set)e=new Set(t);else if(!(YH&&(t instanceof Blob||r))&&(n||Di(t)))if(e=n?[]:{},!n&&!R0t(t))e=t;else for(const i in t)t.hasOwnProperty(i)&&(e[i]=js(t[i]));else return t;return e}var $P=t=>Array.isArray(t)?t.filter(Boolean):[],Ai=t=>t===void 0,lt=(t,e,n)=>{if(!e||!Di(t))return n;const r=$P(e.split(/[,[\].]+?/)).reduce((i,s)=>Pa(i)?i:i[s],t);return Ai(r)||r===t?Ai(t[e])?n:t[e]:r},zo=t=>typeof t=="boolean",ZH=t=>/^\w*$/.test(t),pme=t=>$P(t.replace(/["|']|\]/g,"").split(/\.|\[/)),sr=(t,e,n)=>{let r=-1;const i=ZH(e)?[e]:pme(e),s=i.length,a=s-1;for(;++r<s;){const o=i[r];let l=n;if(r!==a){const c=t[o];l=Di(c)||Array.isArray(c)?c:isNaN(+i[r+1])?{}:[]}if(o==="__proto__"||o==="constructor"||o==="prototype")return;t[o]=l,t=t[o]}};const JI={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Ac={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},md={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},mme=le.createContext(null),LP=()=>le.useContext(mme),P0t=t=>{const{children:e,...n}=t;return le.createElement(mme.Provider,{value:n},e)};var gme=(t,e,n,r=!0)=>{const i={defaultValues:e._defaultValues};for(const s in t)Object.defineProperty(i,s,{get:()=>{const a=s;return e._proxyFormState[a]!==Ac.all&&(e._proxyFormState[a]=!r||Ac.all),n&&(n[a]=!0),t[a]}});return i};const QH=typeof window<"u"?P.useLayoutEffect:P.useEffect;function O0t(t){const e=LP(),{control:n=e.control,disabled:r,name:i,exact:s}=t||{},[a,o]=le.useState(n._formState),l=le.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return QH(()=>n._subscribe({name:i,formState:l.current,exact:s,callback:c=>{!r&&o({...n._formState,...c})}}),[i,r,s]),le.useEffect(()=>{l.current.isValid&&n._setValid(!0)},[n]),le.useMemo(()=>gme(a,n,l.current,!1),[a,n])}var ku=t=>typeof t=="string",yme=(t,e,n,r,i)=>ku(t)?(r&&e.watch.add(t),lt(n,t,i)):Array.isArray(t)?t.map(s=>(r&&e.watch.add(s),lt(n,s))):(r&&(e.watchAll=!0),n);function D0t(t){const e=LP(),{control:n=e.control,name:r,defaultValue:i,disabled:s,exact:a}=t||{},o=le.useRef(i),[l,c]=le.useState(n._getWatch(r,o.current));return QH(()=>n._subscribe({name:r,formState:{values:!0},exact:a,callback:u=>!s&&c(yme(r,n._names,u.values||n._formValues,!1,o.current))}),[r,n,s,a]),le.useEffect(()=>n._removeUnmounted()),l}function $0t(t){const e=LP(),{name:n,disabled:r,control:i=e.control,shouldUnregister:s}=t,a=fme(i._names.array,n),o=D0t({control:i,name:n,defaultValue:lt(i._formValues,n,lt(i._defaultValues,n,t.defaultValue)),exact:!0}),l=O0t({control:i,name:n,exact:!0}),c=le.useRef(t),u=le.useRef(i.register(n,{...t.rules,value:o,...zo(t.disabled)?{disabled:t.disabled}:{}})),d=le.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!lt(l.errors,n)},isDirty:{enumerable:!0,get:()=>!!lt(l.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!lt(l.touchedFields,n)},isValidating:{enumerable:!0,get:()=>!!lt(l.validatingFields,n)},error:{enumerable:!0,get:()=>lt(l.errors,n)}}),[l,n]),h=le.useCallback(m=>u.current.onChange({target:{value:hme(m),name:n},type:JI.CHANGE}),[n]),f=le.useCallback(()=>u.current.onBlur({target:{value:lt(i._formValues,n),name:n},type:JI.BLUR}),[n,i._formValues]),p=le.useCallback(m=>{const y=lt(i._fields,n);y&&m&&(y._f.ref={focus:()=>m.focus(),select:()=>m.select(),setCustomValidity:x=>m.setCustomValidity(x),reportValidity:()=>m.reportValidity()})},[i._fields,n]),g=le.useMemo(()=>({name:n,value:o,...zo(r)||l.disabled?{disabled:l.disabled||r}:{},onChange:h,onBlur:f,ref:p}),[n,r,l.disabled,h,f,p,o]);return le.useEffect(()=>{const m=i._options.shouldUnregister||s;i.register(n,{...c.current.rules,...zo(c.current.disabled)?{disabled:c.current.disabled}:{}});const y=(x,b)=>{const _=lt(i._fields,x);_&&_._f&&(_._f.mount=b)};if(y(n,!0),m){const x=js(lt(i._options.defaultValues,n));sr(i._defaultValues,n,x),Ai(lt(i._formValues,n))&&sr(i._formValues,n,x)}return!a&&i.register(n),()=>{(a?m&&!i._state.action:m)?i.unregister(n):y(n,!1)}},[n,i,a,s]),le.useEffect(()=>{i._setDisabledField({disabled:r,name:n})},[r,n,i]),le.useMemo(()=>({field:g,formState:l,fieldState:d}),[g,l,d])}const L0t=t=>t.render($0t(t));var vme=(t,e,n,r,i)=>e?{...n[t],types:{...n[t]&&n[t].types?n[t].types:{},[r]:i||!0}}:{},g1=t=>Array.isArray(t)?t:[t],LQ=()=>{let t=[];return{get observers(){return t},next:i=>{for(const s of t)s.next&&s.next(i)},subscribe:i=>(t.push(i),{unsubscribe:()=>{t=t.filter(s=>s!==i)}}),unsubscribe:()=>{t=[]}}},n4=t=>Pa(t)||!dme(t);function nf(t,e){if(n4(t)||n4(e))return t===e;if(Om(t)&&Om(e))return t.getTime()===e.getTime();const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const i of n){const s=t[i];if(!r.includes(i))return!1;if(i!=="ref"){const a=e[i];if(Om(s)&&Om(a)||Di(s)&&Di(a)||Array.isArray(s)&&Array.isArray(a)?!nf(s,a):s!==a)return!1}}return!0}var Ma=t=>Di(t)&&!Object.keys(t).length,JH=t=>t.type==="file",Ic=t=>typeof t=="function",ek=t=>{if(!YH)return!1;const e=t?t.ownerDocument:0;return t instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},xme=t=>t.type==="select-multiple",eG=t=>t.type==="radio",F0t=t=>eG(t)||lE(t),NL=t=>ek(t)&&t.isConnected;function j0t(t,e){const n=e.slice(0,-1).length;let r=0;for(;r<n;)t=Ai(t)?r++:t[e[r++]];return t}function z0t(t){for(const e in t)if(t.hasOwnProperty(e)&&!Ai(t[e]))return!1;return!0}function es(t,e){const n=Array.isArray(e)?e:ZH(e)?[e]:pme(e),r=n.length===1?t:j0t(t,n),i=n.length-1,s=n[i];return r&&delete r[s],i!==0&&(Di(r)&&Ma(r)||Array.isArray(r)&&z0t(r))&&es(t,n.slice(0,-1)),t}var bme=t=>{for(const e in t)if(Ic(t[e]))return!0;return!1};function tk(t,e={}){const n=Array.isArray(t);if(Di(t)||n)for(const r in t)Array.isArray(t[r])||Di(t[r])&&!bme(t[r])?(e[r]=Array.isArray(t[r])?[]:{},tk(t[r],e[r])):Pa(t[r])||(e[r]=!0);return e}function wme(t,e,n){const r=Array.isArray(t);if(Di(t)||r)for(const i in t)Array.isArray(t[i])||Di(t[i])&&!bme(t[i])?Ai(e)||n4(n[i])?n[i]=Array.isArray(t[i])?tk(t[i],[]):{...tk(t[i])}:wme(t[i],Pa(e)?{}:e[i],n[i]):n[i]=!nf(t[i],e[i]);return n}var bw=(t,e)=>wme(t,e,tk(e));const FQ={value:!1,isValid:!1},jQ={value:!0,isValid:!0};var Sme=t=>{if(Array.isArray(t)){if(t.length>1){const e=t.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:e,isValid:!!e.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Ai(t[0].attributes.value)?Ai(t[0].value)||t[0].value===""?jQ:{value:t[0].value,isValid:!0}:jQ:FQ}return FQ},_me=(t,{valueAsNumber:e,valueAsDate:n,setValueAs:r})=>Ai(t)?t:e?t===""?NaN:t&&+t:n&&ku(t)?new Date(t):r?r(t):t;const zQ={isValid:!1,value:null};var Tme=t=>Array.isArray(t)?t.reduce((e,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:e,zQ):zQ;function BQ(t){const e=t.ref;return JH(e)?e.files:eG(e)?Tme(t.refs).value:xme(e)?[...e.selectedOptions].map(({value:n})=>n):lE(e)?Sme(t.refs).value:_me(Ai(e.value)?t.ref.value:e.value,t)}var B0t=(t,e,n,r)=>{const i={};for(const s of t){const a=lt(e,s);a&&sr(i,s,a._f)}return{criteriaMode:n,names:[...t],fields:i,shouldUseNativeValidation:r}},nk=t=>t instanceof RegExp,ww=t=>Ai(t)?t:nk(t)?t.source:Di(t)?nk(t.value)?t.value.source:t.value:t,UQ=t=>({isOnSubmit:!t||t===Ac.onSubmit,isOnBlur:t===Ac.onBlur,isOnChange:t===Ac.onChange,isOnAll:t===Ac.all,isOnTouch:t===Ac.onTouched});const VQ="AsyncFunction";var U0t=t=>!!t&&!!t.validate&&!!(Ic(t.validate)&&t.validate.constructor.name===VQ||Di(t.validate)&&Object.values(t.validate).find(e=>e.constructor.name===VQ)),V0t=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),WQ=(t,e,n)=>!n&&(e.watchAll||e.watch.has(t)||[...e.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const y1=(t,e,n,r)=>{for(const i of n||Object.keys(t)){const s=lt(t,i);if(s){const{_f:a,...o}=s;if(a){if(a.refs&&a.refs[0]&&e(a.refs[0],i)&&!r)return!0;if(a.ref&&e(a.ref,a.name)&&!r)return!0;if(y1(o,e))break}else if(Di(o)&&y1(o,e))break}}};function HQ(t,e,n){const r=lt(t,n);if(r||ZH(n))return{error:r,name:n};const i=n.split(".");for(;i.length;){const s=i.join("."),a=lt(e,s),o=lt(t,s);if(a&&!Array.isArray(a)&&n!==s)return{name:n};if(o&&o.type)return{name:s,error:o};i.pop()}return{name:n}}var W0t=(t,e,n,r)=>{n(t);const{name:i,...s}=t;return Ma(s)||Object.keys(s).length>=Object.keys(e).length||Object.keys(s).find(a=>e[a]===(!r||Ac.all))},H0t=(t,e,n)=>!t||!e||t===e||g1(t).some(r=>r&&(n?r===e:r.startsWith(e)||e.startsWith(r))),G0t=(t,e,n,r,i)=>i.isOnAll?!1:!n&&i.isOnTouch?!(e||t):(n?r.isOnBlur:i.isOnBlur)?!t:(n?r.isOnChange:i.isOnChange)?t:!0,q0t=(t,e)=>!$P(lt(t,e)).length&&es(t,e),X0t=(t,e,n)=>{const r=g1(lt(t,n));return sr(r,"root",e[n]),sr(t,n,r),t},W2=t=>ku(t);function GQ(t,e,n="validate"){if(W2(t)||Array.isArray(t)&&t.every(W2)||zo(t)&&!t)return{type:n,message:W2(t)?t:"",ref:e}}var By=t=>Di(t)&&!nk(t)?t:{value:t,message:""},qQ=async(t,e,n,r,i,s)=>{const{ref:a,refs:o,required:l,maxLength:c,minLength:u,min:d,max:h,pattern:f,validate:p,name:g,valueAsNumber:m,mount:y}=t._f,x=lt(n,g);if(!y||e.has(g))return{};const b=o?o[0]:a,_=$=>{i&&b.reportValidity&&(b.setCustomValidity(zo($)?"":$||""),b.reportValidity())},T={},E=eG(a),C=lE(a),I=E||C,A=(m||JH(a))&&Ai(a.value)&&Ai(x)||ek(a)&&a.value===""||x===""||Array.isArray(x)&&!x.length,k=vme.bind(null,g,r,T),R=($,z,O,j=md.maxLength,B=md.minLength)=>{const W=$?z:O;T[g]={type:$?j:B,message:W,ref:a,...k($?j:B,W)}};if(s?!Array.isArray(x)||!x.length:l&&(!I&&(A||Pa(x))||zo(x)&&!x||C&&!Sme(o).isValid||E&&!Tme(o).isValid)){const{value:$,message:z}=W2(l)?{value:!!l,message:l}:By(l);if($&&(T[g]={type:md.required,message:z,ref:b,...k(md.required,z)},!r))return _(z),T}if(!A&&(!Pa(d)||!Pa(h))){let $,z;const O=By(h),j=By(d);if(!Pa(x)&&!isNaN(x)){const B=a.valueAsNumber||x&&+x;Pa(O.value)||($=B>O.value),Pa(j.value)||(z=B<j.value)}else{const B=a.valueAsDate||new Date(x),W=H=>new Date(new Date().toDateString()+" "+H),L=a.type=="time",V=a.type=="week";ku(O.value)&&x&&($=L?W(x)>W(O.value):V?x>O.value:B>new Date(O.value)),ku(j.value)&&x&&(z=L?W(x)<W(j.value):V?x<j.value:B<new Date(j.value))}if(($||z)&&(R(!!$,O.message,j.message,md.max,md.min),!r))return _(T[g].message),T}if((c||u)&&!A&&(ku(x)||s&&Array.isArray(x))){const $=By(c),z=By(u),O=!Pa($.value)&&x.length>+$.value,j=!Pa(z.value)&&x.length<+z.value;if((O||j)&&(R(O,$.message,z.message),!r))return _(T[g].message),T}if(f&&!A&&ku(x)){const{value:$,message:z}=By(f);if(nk($)&&!x.match($)&&(T[g]={type:md.pattern,message:z,ref:a,...k(md.pattern,z)},!r))return _(z),T}if(p){if(Ic(p)){const $=await p(x,n),z=GQ($,b);if(z&&(T[g]={...z,...k(md.validate,z.message)},!r))return _(z.message),T}else if(Di(p)){let $={};for(const z in p){if(!Ma($)&&!r)break;const O=GQ(await p[z](x,n),b,z);O&&($={...O,...k(z,O.message)},_(O.message),r&&(T[g]=$))}if(!Ma($)&&(T[g]={ref:b,...$},!r))return T}}return _(!0),T};const K0t={mode:Ac.onSubmit,reValidateMode:Ac.onChange,shouldFocusError:!0};function Y0t(t={}){let e={...K0t,...t},n={submitCount:0,isDirty:!1,isReady:!1,isLoading:Ic(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1};const r={};let i=Di(e.defaultValues)||Di(e.values)?js(e.defaultValues||e.values)||{}:{},s=e.shouldUnregister?{}:js(i),a={action:!1,mount:!1,watch:!1},o={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},l,c=0;const u={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let d={...u};const h={array:LQ(),state:LQ()},f=UQ(e.mode),p=UQ(e.reValidateMode),g=e.criteriaMode===Ac.all,m=Z=>ie=>{clearTimeout(c),c=setTimeout(Z,ie)},y=async Z=>{if(!e.disabled&&(u.isValid||d.isValid||Z)){const ie=e.resolver?Ma((await A()).errors):await R(r,!0);ie!==n.isValid&&h.state.next({isValid:ie})}},x=(Z,ie)=>{!e.disabled&&(u.isValidating||u.validatingFields||d.isValidating||d.validatingFields)&&((Z||Array.from(o.mount)).forEach(ae=>{ae&&(ie?sr(n.validatingFields,ae,ie):es(n.validatingFields,ae))}),h.state.next({validatingFields:n.validatingFields,isValidating:!Ma(n.validatingFields)}))},b=(Z,ie=[],ae,Le,Ae=!0,Ie=!0)=>{if(Le&&ae&&!e.disabled){if(a.action=!0,Ie&&Array.isArray(lt(r,Z))){const Ge=ae(lt(r,Z),Le.argA,Le.argB);Ae&&sr(r,Z,Ge)}if(Ie&&Array.isArray(lt(n.errors,Z))){const Ge=ae(lt(n.errors,Z),Le.argA,Le.argB);Ae&&sr(n.errors,Z,Ge),q0t(n.errors,Z)}if((u.touchedFields||d.touchedFields)&&Ie&&Array.isArray(lt(n.touchedFields,Z))){const Ge=ae(lt(n.touchedFields,Z),Le.argA,Le.argB);Ae&&sr(n.touchedFields,Z,Ge)}(u.dirtyFields||d.dirtyFields)&&(n.dirtyFields=bw(i,s)),h.state.next({name:Z,isDirty:z(Z,ie),dirtyFields:n.dirtyFields,errors:n.errors,isValid:n.isValid})}else sr(s,Z,ie)},_=(Z,ie)=>{sr(n.errors,Z,ie),h.state.next({errors:n.errors})},T=Z=>{n.errors=Z,h.state.next({errors:n.errors,isValid:!1})},E=(Z,ie,ae,Le)=>{const Ae=lt(r,Z);if(Ae){const Ie=lt(s,Z,Ai(ae)?lt(i,Z):ae);Ai(Ie)||Le&&Le.defaultChecked||ie?sr(s,Z,ie?Ie:BQ(Ae._f)):B(Z,Ie),a.mount&&y()}},C=(Z,ie,ae,Le,Ae)=>{let Ie=!1,Ge=!1;const rt={name:Z};if(!e.disabled){if(!ae||Le){(u.isDirty||d.isDirty)&&(Ge=n.isDirty,n.isDirty=rt.isDirty=z(),Ie=Ge!==rt.isDirty);const We=nf(lt(i,Z),ie);Ge=!!lt(n.dirtyFields,Z),We?es(n.dirtyFields,Z):sr(n.dirtyFields,Z,!0),rt.dirtyFields=n.dirtyFields,Ie=Ie||(u.dirtyFields||d.dirtyFields)&&Ge!==!We}if(ae){const We=lt(n.touchedFields,Z);We||(sr(n.touchedFields,Z,ae),rt.touchedFields=n.touchedFields,Ie=Ie||(u.touchedFields||d.touchedFields)&&We!==ae)}Ie&&Ae&&h.state.next(rt)}return Ie?rt:{}},I=(Z,ie,ae,Le)=>{const Ae=lt(n.errors,Z),Ie=(u.isValid||d.isValid)&&zo(ie)&&n.isValid!==ie;if(e.delayError&&ae?(l=m(()=>_(Z,ae)),l(e.delayError)):(clearTimeout(c),l=null,ae?sr(n.errors,Z,ae):es(n.errors,Z)),(ae?!nf(Ae,ae):Ae)||!Ma(Le)||Ie){const Ge={...Le,...Ie&&zo(ie)?{isValid:ie}:{},errors:n.errors,name:Z};n={...n,...Ge},h.state.next(Ge)}},A=async Z=>{x(Z,!0);const ie=await e.resolver(s,e.context,B0t(Z||o.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return x(Z),ie},k=async Z=>{const{errors:ie}=await A(Z);if(Z)for(const ae of Z){const Le=lt(ie,ae);Le?sr(n.errors,ae,Le):es(n.errors,ae)}else n.errors=ie;return ie},R=async(Z,ie,ae={valid:!0})=>{for(const Le in Z){const Ae=Z[Le];if(Ae){const{_f:Ie,...Ge}=Ae;if(Ie){const rt=o.array.has(Ie.name),We=Ae._f&&U0t(Ae._f);We&&u.validatingFields&&x([Le],!0);const Ut=await qQ(Ae,o.disabled,s,g,e.shouldUseNativeValidation&&!ie,rt);if(We&&u.validatingFields&&x([Le]),Ut[Ie.name]&&(ae.valid=!1,ie))break;!ie&&(lt(Ut,Ie.name)?rt?X0t(n.errors,Ut,Ie.name):sr(n.errors,Ie.name,Ut[Ie.name]):es(n.errors,Ie.name))}!Ma(Ge)&&await R(Ge,ie,ae)}}return ae.valid},$=()=>{for(const Z of o.unMount){const ie=lt(r,Z);ie&&(ie._f.refs?ie._f.refs.every(ae=>!NL(ae)):!NL(ie._f.ref))&&ge(Z)}o.unMount=new Set},z=(Z,ie)=>!e.disabled&&(Z&&ie&&sr(s,Z,ie),!nf(te(),i)),O=(Z,ie,ae)=>yme(Z,o,{...a.mount?s:Ai(ie)?i:ku(Z)?{[Z]:ie}:ie},ae,ie),j=Z=>$P(lt(a.mount?s:i,Z,e.shouldUnregister?lt(i,Z,[]):[])),B=(Z,ie,ae={})=>{const Le=lt(r,Z);let Ae=ie;if(Le){const Ie=Le._f;Ie&&(!Ie.disabled&&sr(s,Z,_me(ie,Ie)),Ae=ek(Ie.ref)&&Pa(ie)?"":ie,xme(Ie.ref)?[...Ie.ref.options].forEach(Ge=>Ge.selected=Ae.includes(Ge.value)):Ie.refs?lE(Ie.ref)?Ie.refs.length>1?Ie.refs.forEach(Ge=>(!Ge.defaultChecked||!Ge.disabled)&&(Ge.checked=Array.isArray(Ae)?!!Ae.find(rt=>rt===Ge.value):Ae===Ge.value)):Ie.refs[0]&&(Ie.refs[0].checked=!!Ae):Ie.refs.forEach(Ge=>Ge.checked=Ge.value===Ae):JH(Ie.ref)?Ie.ref.value="":(Ie.ref.value=Ae,Ie.ref.type||h.state.next({name:Z,values:js(s)})))}(ae.shouldDirty||ae.shouldTouch)&&C(Z,Ae,ae.shouldTouch,ae.shouldDirty,!0),ae.shouldValidate&&K(Z)},W=(Z,ie,ae)=>{for(const Le in ie){const Ae=ie[Le],Ie=`${Z}.${Le}`,Ge=lt(r,Ie);(o.array.has(Z)||Di(Ae)||Ge&&!Ge._f)&&!Om(Ae)?W(Ie,Ae,ae):B(Ie,Ae,ae)}},L=(Z,ie,ae={})=>{const Le=lt(r,Z),Ae=o.array.has(Z),Ie=js(ie);sr(s,Z,Ie),Ae?(h.array.next({name:Z,values:js(s)}),(u.isDirty||u.dirtyFields||d.isDirty||d.dirtyFields)&&ae.shouldDirty&&h.state.next({name:Z,dirtyFields:bw(i,s),isDirty:z(Z,Ie)})):Le&&!Le._f&&!Pa(Ie)?W(Z,Ie,ae):B(Z,Ie,ae),WQ(Z,o)&&h.state.next({...n}),h.state.next({name:a.mount?Z:void 0,values:js(s)})},V=async Z=>{a.mount=!0;const ie=Z.target;let ae=ie.name,Le=!0;const Ae=lt(r,ae),Ie=Ge=>{Le=Number.isNaN(Ge)||Om(Ge)&&isNaN(Ge.getTime())||nf(Ge,lt(s,ae,Ge))};if(Ae){let Ge,rt;const We=ie.type?BQ(Ae._f):hme(Z),Ut=Z.type===JI.BLUR||Z.type===JI.FOCUS_OUT,hn=!V0t(Ae._f)&&!e.resolver&&!lt(n.errors,ae)&&!Ae._f.deps||G0t(Ut,lt(n.touchedFields,ae),n.isSubmitted,p,f),Vt=WQ(ae,o,Ut);sr(s,ae,We),Ut?(Ae._f.onBlur&&Ae._f.onBlur(Z),l&&l(0)):Ae._f.onChange&&Ae._f.onChange(Z);const Ot=C(ae,We,Ut),bt=!Ma(Ot)||Vt;if(!Ut&&h.state.next({name:ae,type:Z.type,values:js(s)}),hn)return(u.isValid||d.isValid)&&(e.mode==="onBlur"?Ut&&y():Ut||y()),bt&&h.state.next({name:ae,...Vt?{}:Ot});if(!Ut&&Vt&&h.state.next({...n}),e.resolver){const{errors:ln}=await A([ae]);if(Ie(We),Le){const Hn=HQ(n.errors,r,ae),Tr=HQ(ln,r,Hn.name||ae);Ge=Tr.error,ae=Tr.name,rt=Ma(ln)}}else x([ae],!0),Ge=(await qQ(Ae,o.disabled,s,g,e.shouldUseNativeValidation))[ae],x([ae]),Ie(We),Le&&(Ge?rt=!1:(u.isValid||d.isValid)&&(rt=await R(r,!0)));Le&&(Ae._f.deps&&K(Ae._f.deps),I(ae,rt,Ge,Ot))}},H=(Z,ie)=>{if(lt(n.errors,ie)&&Z.focus)return Z.focus(),1},K=async(Z,ie={})=>{let ae,Le;const Ae=g1(Z);if(e.resolver){const Ie=await k(Ai(Z)?Z:Ae);ae=Ma(Ie),Le=Z?!Ae.some(Ge=>lt(Ie,Ge)):ae}else Z?(Le=(await Promise.all(Ae.map(async Ie=>{const Ge=lt(r,Ie);return await R(Ge&&Ge._f?{[Ie]:Ge}:Ge)}))).every(Boolean),!(!Le&&!n.isValid)&&y()):Le=ae=await R(r);return h.state.next({...!ku(Z)||(u.isValid||d.isValid)&&ae!==n.isValid?{}:{name:Z},...e.resolver||!Z?{isValid:ae}:{},errors:n.errors}),ie.shouldFocus&&!Le&&y1(r,H,Z?Ae:o.mount),Le},te=Z=>{const ie={...a.mount?s:i};return Ai(Z)?ie:ku(Z)?lt(ie,Z):Z.map(ae=>lt(ie,ae))},J=(Z,ie)=>({invalid:!!lt((ie||n).errors,Z),isDirty:!!lt((ie||n).dirtyFields,Z),error:lt((ie||n).errors,Z),isValidating:!!lt(n.validatingFields,Z),isTouched:!!lt((ie||n).touchedFields,Z)}),oe=Z=>{Z&&g1(Z).forEach(ie=>es(n.errors,ie)),h.state.next({errors:Z?n.errors:{}})},fe=(Z,ie,ae)=>{const Le=(lt(r,Z,{_f:{}})._f||{}).ref,Ae=lt(n.errors,Z)||{},{ref:Ie,message:Ge,type:rt,...We}=Ae;sr(n.errors,Z,{...We,...ie,ref:Le}),h.state.next({name:Z,errors:n.errors,isValid:!1}),ae&&ae.shouldFocus&&Le&&Le.focus&&Le.focus()},Ee=(Z,ie)=>Ic(Z)?h.state.subscribe({next:ae=>Z(O(void 0,ie),ae)}):O(Z,ie,!0),me=Z=>h.state.subscribe({next:ie=>{H0t(Z.name,ie.name,Z.exact)&&W0t(ie,Z.formState||u,Q,Z.reRenderRoot)&&Z.callback({values:{...s},...n,...ie})}}).unsubscribe,De=Z=>(a.mount=!0,d={...d,...Z.formState},me({...Z,formState:d})),ge=(Z,ie={})=>{for(const ae of Z?g1(Z):o.mount)o.mount.delete(ae),o.array.delete(ae),ie.keepValue||(es(r,ae),es(s,ae)),!ie.keepError&&es(n.errors,ae),!ie.keepDirty&&es(n.dirtyFields,ae),!ie.keepTouched&&es(n.touchedFields,ae),!ie.keepIsValidating&&es(n.validatingFields,ae),!e.shouldUnregister&&!ie.keepDefaultValue&&es(i,ae);h.state.next({values:js(s)}),h.state.next({...n,...ie.keepDirty?{isDirty:z()}:{}}),!ie.keepIsValid&&y()},_e=({disabled:Z,name:ie})=>{(zo(Z)&&a.mount||Z||o.disabled.has(ie))&&(Z?o.disabled.add(ie):o.disabled.delete(ie))},Ce=(Z,ie={})=>{let ae=lt(r,Z);const Le=zo(ie.disabled)||zo(e.disabled);return sr(r,Z,{...ae||{},_f:{...ae&&ae._f?ae._f:{ref:{name:Z}},name:Z,mount:!0,...ie}}),o.mount.add(Z),ae?_e({disabled:zo(ie.disabled)?ie.disabled:e.disabled,name:Z}):E(Z,!0,ie.value),{...Le?{disabled:ie.disabled||e.disabled}:{},...e.progressive?{required:!!ie.required,min:ww(ie.min),max:ww(ie.max),minLength:ww(ie.minLength),maxLength:ww(ie.maxLength),pattern:ww(ie.pattern)}:{},name:Z,onChange:V,onBlur:V,ref:Ae=>{if(Ae){Ce(Z,ie),ae=lt(r,Z);const Ie=Ai(Ae.value)&&Ae.querySelectorAll&&Ae.querySelectorAll("input,select,textarea")[0]||Ae,Ge=F0t(Ie),rt=ae._f.refs||[];if(Ge?rt.find(We=>We===Ie):Ie===ae._f.ref)return;sr(r,Z,{_f:{...ae._f,...Ge?{refs:[...rt.filter(NL),Ie,...Array.isArray(lt(i,Z))?[{}]:[]],ref:{type:Ie.type,name:Z}}:{ref:Ie}}}),E(Z,!1,void 0,Ie)}else ae=lt(r,Z,{}),ae._f&&(ae._f.mount=!1),(e.shouldUnregister||ie.shouldUnregister)&&!(fme(o.array,Z)&&a.action)&&o.unMount.add(Z)}}},G=()=>e.shouldFocusError&&y1(r,H,o.mount),ke=Z=>{zo(Z)&&(h.state.next({disabled:Z}),y1(r,(ie,ae)=>{const Le=lt(r,ae);Le&&(ie.disabled=Le._f.disabled||Z,Array.isArray(Le._f.refs)&&Le._f.refs.forEach(Ae=>{Ae.disabled=Le._f.disabled||Z}))},0,!1))},xe=(Z,ie)=>async ae=>{let Le;ae&&(ae.preventDefault&&ae.preventDefault(),ae.persist&&ae.persist());let Ae=js(s);if(h.state.next({isSubmitting:!0}),e.resolver){const{errors:Ie,values:Ge}=await A();n.errors=Ie,Ae=Ge}else await R(r);if(o.disabled.size)for(const Ie of o.disabled)sr(Ae,Ie,void 0);if(es(n.errors,"root"),Ma(n.errors)){h.state.next({errors:{}});try{await Z(Ae,ae)}catch(Ie){Le=Ie}}else ie&&await ie({...n.errors},ae),G(),setTimeout(G);if(h.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ma(n.errors)&&!Le,submitCount:n.submitCount+1,errors:n.errors}),Le)throw Le},Pe=(Z,ie={})=>{lt(r,Z)&&(Ai(ie.defaultValue)?L(Z,js(lt(i,Z))):(L(Z,ie.defaultValue),sr(i,Z,js(ie.defaultValue))),ie.keepTouched||es(n.touchedFields,Z),ie.keepDirty||(es(n.dirtyFields,Z),n.isDirty=ie.defaultValue?z(Z,js(lt(i,Z))):z()),ie.keepError||(es(n.errors,Z),u.isValid&&y()),h.state.next({...n}))},Te=(Z,ie={})=>{const ae=Z?js(Z):i,Le=js(ae),Ae=Ma(Z),Ie=Ae?i:Le;if(ie.keepDefaultValues||(i=ae),!ie.keepValues){if(ie.keepDirtyValues){const Ge=new Set([...o.mount,...Object.keys(bw(i,s))]);for(const rt of Array.from(Ge))lt(n.dirtyFields,rt)?sr(Ie,rt,lt(s,rt)):L(rt,lt(Ie,rt))}else{if(YH&&Ai(Z))for(const Ge of o.mount){const rt=lt(r,Ge);if(rt&&rt._f){const We=Array.isArray(rt._f.refs)?rt._f.refs[0]:rt._f.ref;if(ek(We)){const Ut=We.closest("form");if(Ut){Ut.reset();break}}}}for(const Ge of o.mount)L(Ge,lt(Ie,Ge))}s=js(Ie),h.array.next({values:{...Ie}}),h.state.next({values:{...Ie}})}o={mount:ie.keepDirtyValues?o.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},a.mount=!u.isValid||!!ie.keepIsValid||!!ie.keepDirtyValues,a.watch=!!e.shouldUnregister,h.state.next({submitCount:ie.keepSubmitCount?n.submitCount:0,isDirty:Ae?!1:ie.keepDirty?n.isDirty:!!(ie.keepDefaultValues&&!nf(Z,i)),isSubmitted:ie.keepIsSubmitted?n.isSubmitted:!1,dirtyFields:Ae?{}:ie.keepDirtyValues?ie.keepDefaultValues&&s?bw(i,s):n.dirtyFields:ie.keepDefaultValues&&Z?bw(i,Z):ie.keepDirty?n.dirtyFields:{},touchedFields:ie.keepTouched?n.touchedFields:{},errors:ie.keepErrors?n.errors:{},isSubmitSuccessful:ie.keepIsSubmitSuccessful?n.isSubmitSuccessful:!1,isSubmitting:!1})},Ye=(Z,ie)=>Te(Ic(Z)?Z(s):Z,ie),qe=(Z,ie={})=>{const ae=lt(r,Z),Le=ae&&ae._f;if(Le){const Ae=Le.refs?Le.refs[0]:Le.ref;Ae.focus&&(Ae.focus(),ie.shouldSelect&&Ic(Ae.select)&&Ae.select())}},Q=Z=>{n={...n,...Z}},we={control:{register:Ce,unregister:ge,getFieldState:J,handleSubmit:xe,setError:fe,_subscribe:me,_runSchema:A,_getWatch:O,_getDirty:z,_setValid:y,_setFieldArray:b,_setDisabledField:_e,_setErrors:T,_getFieldArray:j,_reset:Te,_resetDefaultValues:()=>Ic(e.defaultValues)&&e.defaultValues().then(Z=>{Ye(Z,e.resetOptions),h.state.next({isLoading:!1})}),_removeUnmounted:$,_disableForm:ke,_subjects:h,_proxyFormState:u,get _fields(){return r},get _formValues(){return s},get _state(){return a},set _state(Z){a=Z},get _defaultValues(){return i},get _names(){return o},set _names(Z){o=Z},get _formState(){return n},get _options(){return e},set _options(Z){e={...e,...Z}}},subscribe:De,trigger:K,register:Ce,handleSubmit:xe,watch:Ee,setValue:L,getValues:te,reset:Ye,resetField:Pe,clearErrors:oe,unregister:ge,setError:fe,setFocus:qe,getFieldState:J};return{...we,formControl:we}}function XQ(t={}){const e=le.useRef(void 0),n=le.useRef(void 0),[r,i]=le.useState({isDirty:!1,isValidating:!1,isLoading:Ic(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:Ic(t.defaultValues)?void 0:t.defaultValues});e.current||(e.current={...t.formControl?t.formControl:Y0t(t),formState:r},t.formControl&&t.defaultValues&&!Ic(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions));const s=e.current.control;return s._options=t,QH(()=>{const a=s._subscribe({formState:s._proxyFormState,callback:()=>i({...s._formState}),reRenderRoot:!0});return i(o=>({...o,isReady:!0})),s._formState.isReady=!0,a},[s]),le.useEffect(()=>s._disableForm(t.disabled),[s,t.disabled]),le.useEffect(()=>{t.mode&&(s._options.mode=t.mode),t.reValidateMode&&(s._options.reValidateMode=t.reValidateMode),t.errors&&!Ma(t.errors)&&s._setErrors(t.errors)},[s,t.errors,t.mode,t.reValidateMode]),le.useEffect(()=>{t.shouldUnregister&&s._subjects.state.next({values:s._getWatch()})},[s,t.shouldUnregister]),le.useEffect(()=>{if(s._proxyFormState.isDirty){const a=s._getDirty();a!==r.isDirty&&s._subjects.state.next({isDirty:a})}},[s,r.isDirty]),le.useEffect(()=>{t.values&&!nf(t.values,n.current)?(s._reset(t.values,s._options.resetOptions),n.current=t.values,i(a=>({...a}))):s._resetDefaultValues()},[s,t.values]),le.useEffect(()=>{s._state.mount||(s._setValid(),s._state.mount=!0),s._state.watch&&(s._state.watch=!1,s._subjects.state.next({...s._formState})),s._removeUnmounted()}),e.current.formState=gme(r,s),e.current}var Gn;(function(t){t.assertEqual=i=>i;function e(i){}t.assertIs=e;function n(i){throw new Error}t.assertNever=n,t.arrayToEnum=i=>{const s={};for(const a of i)s[a]=a;return s},t.getValidEnumValues=i=>{const s=t.objectKeys(i).filter(o=>typeof i[i[o]]!="number"),a={};for(const o of s)a[o]=i[o];return t.objectValues(a)},t.objectValues=i=>t.objectKeys(i).map(function(s){return i[s]}),t.objectKeys=typeof Object.keys=="function"?i=>Object.keys(i):i=>{const s=[];for(const a in i)Object.prototype.hasOwnProperty.call(i,a)&&s.push(a);return s},t.find=(i,s)=>{for(const a of i)if(s(a))return a},t.isInteger=typeof Number.isInteger=="function"?i=>Number.isInteger(i):i=>typeof i=="number"&&isFinite(i)&&Math.floor(i)===i;function r(i,s=" | "){return i.map(a=>typeof a=="string"?`'${a}'`:a).join(s)}t.joinValues=r,t.jsonStringifyReplacer=(i,s)=>typeof s=="bigint"?s.toString():s})(Gn||(Gn={}));var r4;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(r4||(r4={}));const vt=Gn.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ad=t=>{switch(typeof t){case"undefined":return vt.undefined;case"string":return vt.string;case"number":return isNaN(t)?vt.nan:vt.number;case"boolean":return vt.boolean;case"function":return vt.function;case"bigint":return vt.bigint;case"symbol":return vt.symbol;case"object":return Array.isArray(t)?vt.array:t===null?vt.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?vt.promise:typeof Map<"u"&&t instanceof Map?vt.map:typeof Set<"u"&&t instanceof Set?vt.set:typeof Date<"u"&&t instanceof Date?vt.date:vt.object;default:return vt.unknown}},Ze=Gn.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Z0t=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class Yo extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(s){return s.message},r={_errors:[]},i=s=>{for(const a of s.issues)if(a.code==="invalid_union")a.unionErrors.map(i);else if(a.code==="invalid_return_type")i(a.returnTypeError);else if(a.code==="invalid_arguments")i(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return i(this),r}static assert(e){if(!(e instanceof Yo))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Gn.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const i of this.issues)i.path.length>0?(n[i.path[0]]=n[i.path[0]]||[],n[i.path[0]].push(e(i))):r.push(e(i));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Yo.create=t=>new Yo(t);const T0=(t,e)=>{let n;switch(t.code){case Ze.invalid_type:t.received===vt.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case Ze.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,Gn.jsonStringifyReplacer)}`;break;case Ze.unrecognized_keys:n=`Unrecognized key(s) in object: ${Gn.joinValues(t.keys,", ")}`;break;case Ze.invalid_union:n="Invalid input";break;case Ze.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${Gn.joinValues(t.options)}`;break;case Ze.invalid_enum_value:n=`Invalid enum value. Expected ${Gn.joinValues(t.options)}, received '${t.received}'`;break;case Ze.invalid_arguments:n="Invalid function arguments";break;case Ze.invalid_return_type:n="Invalid function return type";break;case Ze.invalid_date:n="Invalid date";break;case Ze.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:Gn.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case Ze.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case Ze.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case Ze.custom:n="Invalid input";break;case Ze.invalid_intersection_types:n="Intersection results could not be merged";break;case Ze.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case Ze.not_finite:n="Number must be finite";break;default:n=e.defaultError,Gn.assertNever(t)}return{message:n}};let Eme=T0;function Q0t(t){Eme=t}function rk(){return Eme}const ik=t=>{const{data:e,path:n,errorMaps:r,issueData:i}=t,s=[...n,...i.path||[]],a={...i,path:s};if(i.message!==void 0)return{...i,path:s,message:i.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:e,defaultError:o}).message;return{...i,path:s,message:o}},J0t=[];function ft(t,e){const n=rk(),r=ik({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===T0?void 0:T0].filter(i=>!!i)});t.common.issues.push(r)}class ba{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const i of n){if(i.status==="aborted")return sn;i.status==="dirty"&&e.dirty(),r.push(i.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const i of n){const s=await i.key,a=await i.value;r.push({key:s,value:a})}return ba.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const i of n){const{key:s,value:a}=i;if(s.status==="aborted"||a.status==="aborted")return sn;s.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof a.value<"u"||i.alwaysSet)&&(r[s.value]=a.value)}return{status:e.value,value:r}}}const sn=Object.freeze({status:"aborted"}),$v=t=>({status:"dirty",value:t}),qa=t=>({status:"valid",value:t}),i4=t=>t.status==="aborted",s4=t=>t.status==="dirty",Og=t=>t.status==="valid",US=t=>typeof Promise<"u"&&t instanceof Promise;function sk(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function Cme(t,e,n,r,i){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var Rt;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Rt||(Rt={}));var qw,Xw;class Yu{constructor(e,n,r,i){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=i}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const KQ=(t,e)=>{if(Og(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Yo(t.common.issues);return this._error=n,this._error}}};function gn(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:i}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:i}:{errorMap:(a,o)=>{var l,c;const{message:u}=t;return a.code==="invalid_enum_value"?{message:u??o.defaultError}:typeof o.data>"u"?{message:(l=u??r)!==null&&l!==void 0?l:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(c=u??n)!==null&&c!==void 0?c:o.defaultError}},description:i}}class En{get description(){return this._def.description}_getType(e){return Ad(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Ad(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ba,ctx:{common:e.parent.common,data:e.data,parsedType:Ad(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(US(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const i={common:{issues:[],async:(r=n==null?void 0:n.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ad(e)},s=this._parseSync({data:e,path:i.path,parent:i});return KQ(i,s)}"~validate"(e){var n,r;const i={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ad(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:i});return Og(s)?{value:s.value}:{issues:i.common.issues}}catch(s){!((r=(n=s==null?void 0:s.message)===null||n===void 0?void 0:n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),i.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:i}).then(s=>Og(s)?{value:s.value}:{issues:i.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ad(e)},i=this._parse({data:e,path:r.path,parent:r}),s=await(US(i)?i:Promise.resolve(i));return KQ(r,s)}refine(e,n){const r=i=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(i):n;return this._refinement((i,s)=>{const a=e(i),o=()=>s.addIssue({code:Ze.custom,...r(i)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,i)=>e(r)?!0:(i.addIssue(typeof n=="function"?n(r,i):n),!1))}_refinement(e){return new Xc({schema:this,typeName:nn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return ju.create(this,this._def)}nullable(){return Jf.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return zc.create(this)}promise(){return C0.create(this,this._def)}or(e){return GS.create([this,e],this._def)}and(e){return qS.create(this,e,this._def)}transform(e){return new Xc({...gn(this._def),schema:this,typeName:nn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new QS({...gn(this._def),innerType:this,defaultValue:n,typeName:nn.ZodDefault})}brand(){return new tG({typeName:nn.ZodBranded,type:this,...gn(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new JS({...gn(this._def),innerType:this,catchValue:n,typeName:nn.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return cE.create(this,e)}readonly(){return e_.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ebt=/^c[^\s-]{8,}$/i,tbt=/^[0-9a-z]+$/,nbt=/^[0-9A-HJKMNP-TV-Z]{26}$/i,rbt=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ibt=/^[a-z0-9_-]{21}$/i,sbt=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,abt=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,obt=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,lbt="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let AL;const cbt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ubt=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,dbt=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,hbt=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,fbt=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,pbt=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,Nme="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",mbt=new RegExp(`^${Nme}$`);function Ame(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const n=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${n}`}function gbt(t){return new RegExp(`^${Ame(t)}$`)}function Ime(t){let e=`${Nme}T${Ame(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function ybt(t,e){return!!((e==="v4"||!e)&&cbt.test(t)||(e==="v6"||!e)&&dbt.test(t))}function vbt(t,e){if(!sbt.test(t))return!1;try{const[n]=t.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),i=JSON.parse(atob(r));return!(typeof i!="object"||i===null||!i.typ||!i.alg||e&&i.alg!==e)}catch{return!1}}function xbt(t,e){return!!((e==="v4"||!e)&&ubt.test(t)||(e==="v6"||!e)&&hbt.test(t))}class Rc extends En{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==vt.string){const s=this._getOrReturnCtx(e);return ft(s,{code:Ze.invalid_type,expected:vt.string,received:s.parsedType}),sn}const r=new ba;let i;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const a=e.data.length>s.value,o=e.data.length<s.value;(a||o)&&(i=this._getOrReturnCtx(e,i),a?ft(i,{code:Ze.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&ft(i,{code:Ze.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")obt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"email",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")AL||(AL=new RegExp(lbt,"u")),AL.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"emoji",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")rbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"uuid",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="nanoid")ibt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"nanoid",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")ebt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"cuid",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")tbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"cuid2",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")nbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"ulid",code:Ze.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{i=this._getOrReturnCtx(e,i),ft(i,{validation:"url",code:Ze.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"regex",code:Ze.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?Ime(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="date"?mbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:"date",message:s.message}),r.dirty()):s.kind==="time"?gbt(s).test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.invalid_string,validation:"time",message:s.message}),r.dirty()):s.kind==="duration"?abt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"duration",code:Ze.invalid_string,message:s.message}),r.dirty()):s.kind==="ip"?ybt(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"ip",code:Ze.invalid_string,message:s.message}),r.dirty()):s.kind==="jwt"?vbt(e.data,s.alg)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"jwt",code:Ze.invalid_string,message:s.message}),r.dirty()):s.kind==="cidr"?xbt(e.data,s.version)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"cidr",code:Ze.invalid_string,message:s.message}),r.dirty()):s.kind==="base64"?fbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"base64",code:Ze.invalid_string,message:s.message}),r.dirty()):s.kind==="base64url"?pbt.test(e.data)||(i=this._getOrReturnCtx(e,i),ft(i,{validation:"base64url",code:Ze.invalid_string,message:s.message}),r.dirty()):Gn.assertNever(s);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(i=>e.test(i),{validation:n,code:Ze.invalid_string,...Rt.errToObj(r)})}_addCheck(e){return new Rc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Rt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Rt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Rt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Rt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Rt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Rt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Rt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Rt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Rt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Rt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Rt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Rt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Rt.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(n=e==null?void 0:e.offset)!==null&&n!==void 0?n:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...Rt.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Rt.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Rt.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...Rt.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n==null?void 0:n.position,...Rt.errToObj(n==null?void 0:n.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...Rt.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...Rt.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...Rt.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...Rt.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...Rt.errToObj(n)})}nonempty(e){return this.min(1,Rt.errToObj(e))}trim(){return new Rc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Rc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Rc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Rc.create=t=>{var e;return new Rc({checks:[],typeName:nn.ZodString,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...gn(t)})};function bbt(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,i=n>r?n:r,s=parseInt(t.toFixed(i).replace(".","")),a=parseInt(e.toFixed(i).replace(".",""));return s%a/Math.pow(10,i)}class Yf extends En{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==vt.number){const s=this._getOrReturnCtx(e);return ft(s,{code:Ze.invalid_type,expected:vt.number,received:s.parsedType}),sn}let r;const i=new ba;for(const s of this._def.checks)s.kind==="int"?Gn.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.invalid_type,expected:"integer",received:"float",message:s.message}),i.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),i.dirty()):s.kind==="multipleOf"?bbt(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.not_finite,message:s.message}),i.dirty()):Gn.assertNever(s);return{status:i.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,Rt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Rt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Rt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Rt.toString(n))}setLimit(e,n,r,i){return new Yf({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Rt.toString(i)}]})}_addCheck(e){return new Yf({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Rt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Rt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Rt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Rt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Rt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Rt.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:Rt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Rt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Rt.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Gn.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Yf.create=t=>new Yf({checks:[],typeName:nn.ZodNumber,coerce:(t==null?void 0:t.coerce)||!1,...gn(t)});class Zf extends En{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==vt.bigint)return this._getInvalidInput(e);let r;const i=new ba;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),i.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ft(r,{code:Ze.not_multiple_of,multipleOf:s.value,message:s.message}),i.dirty()):Gn.assertNever(s);return{status:i.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return ft(n,{code:Ze.invalid_type,expected:vt.bigint,received:n.parsedType}),sn}gte(e,n){return this.setLimit("min",e,!0,Rt.toString(n))}gt(e,n){return this.setLimit("min",e,!1,Rt.toString(n))}lte(e,n){return this.setLimit("max",e,!0,Rt.toString(n))}lt(e,n){return this.setLimit("max",e,!1,Rt.toString(n))}setLimit(e,n,r,i){return new Zf({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:Rt.toString(i)}]})}_addCheck(e){return new Zf({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Rt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Rt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Rt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Rt.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:Rt.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Zf.create=t=>{var e;return new Zf({checks:[],typeName:nn.ZodBigInt,coerce:(e=t==null?void 0:t.coerce)!==null&&e!==void 0?e:!1,...gn(t)})};class VS extends En{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==vt.boolean){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.boolean,received:r.parsedType}),sn}return qa(e.data)}}VS.create=t=>new VS({typeName:nn.ZodBoolean,coerce:(t==null?void 0:t.coerce)||!1,...gn(t)});class Dg extends En{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==vt.date){const s=this._getOrReturnCtx(e);return ft(s,{code:Ze.invalid_type,expected:vt.date,received:s.parsedType}),sn}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return ft(s,{code:Ze.invalid_date}),sn}const r=new ba;let i;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(i=this._getOrReturnCtx(e,i),ft(i,{code:Ze.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):Gn.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Dg({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:Rt.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:Rt.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Dg.create=t=>new Dg({checks:[],coerce:(t==null?void 0:t.coerce)||!1,typeName:nn.ZodDate,...gn(t)});class ak extends En{_parse(e){if(this._getType(e)!==vt.symbol){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.symbol,received:r.parsedType}),sn}return qa(e.data)}}ak.create=t=>new ak({typeName:nn.ZodSymbol,...gn(t)});class WS extends En{_parse(e){if(this._getType(e)!==vt.undefined){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.undefined,received:r.parsedType}),sn}return qa(e.data)}}WS.create=t=>new WS({typeName:nn.ZodUndefined,...gn(t)});class HS extends En{_parse(e){if(this._getType(e)!==vt.null){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.null,received:r.parsedType}),sn}return qa(e.data)}}HS.create=t=>new HS({typeName:nn.ZodNull,...gn(t)});class E0 extends En{constructor(){super(...arguments),this._any=!0}_parse(e){return qa(e.data)}}E0.create=t=>new E0({typeName:nn.ZodAny,...gn(t)});class Qm extends En{constructor(){super(...arguments),this._unknown=!0}_parse(e){return qa(e.data)}}Qm.create=t=>new Qm({typeName:nn.ZodUnknown,...gn(t)});class uh extends En{_parse(e){const n=this._getOrReturnCtx(e);return ft(n,{code:Ze.invalid_type,expected:vt.never,received:n.parsedType}),sn}}uh.create=t=>new uh({typeName:nn.ZodNever,...gn(t)});class ok extends En{_parse(e){if(this._getType(e)!==vt.undefined){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.void,received:r.parsedType}),sn}return qa(e.data)}}ok.create=t=>new ok({typeName:nn.ZodVoid,...gn(t)});class zc extends En{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),i=this._def;if(n.parsedType!==vt.array)return ft(n,{code:Ze.invalid_type,expected:vt.array,received:n.parsedType}),sn;if(i.exactLength!==null){const a=n.data.length>i.exactLength.value,o=n.data.length<i.exactLength.value;(a||o)&&(ft(n,{code:a?Ze.too_big:Ze.too_small,minimum:o?i.exactLength.value:void 0,maximum:a?i.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:i.exactLength.message}),r.dirty())}if(i.minLength!==null&&n.data.length<i.minLength.value&&(ft(n,{code:Ze.too_small,minimum:i.minLength.value,type:"array",inclusive:!0,exact:!1,message:i.minLength.message}),r.dirty()),i.maxLength!==null&&n.data.length>i.maxLength.value&&(ft(n,{code:Ze.too_big,maximum:i.maxLength.value,type:"array",inclusive:!0,exact:!1,message:i.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>i.type._parseAsync(new Yu(n,a,n.path,o)))).then(a=>ba.mergeArray(r,a));const s=[...n.data].map((a,o)=>i.type._parseSync(new Yu(n,a,n.path,o)));return ba.mergeArray(r,s)}get element(){return this._def.type}min(e,n){return new zc({...this._def,minLength:{value:e,message:Rt.toString(n)}})}max(e,n){return new zc({...this._def,maxLength:{value:e,message:Rt.toString(n)}})}length(e,n){return new zc({...this._def,exactLength:{value:e,message:Rt.toString(n)}})}nonempty(e){return this.min(1,e)}}zc.create=(t,e)=>new zc({type:t,minLength:null,maxLength:null,exactLength:null,typeName:nn.ZodArray,...gn(e)});function yv(t){if(t instanceof ni){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=ju.create(yv(r))}return new ni({...t._def,shape:()=>e})}else return t instanceof zc?new zc({...t._def,type:yv(t.element)}):t instanceof ju?ju.create(yv(t.unwrap())):t instanceof Jf?Jf.create(yv(t.unwrap())):t instanceof Zu?Zu.create(t.items.map(e=>yv(e))):t}class ni extends En{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=Gn.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==vt.object){const c=this._getOrReturnCtx(e);return ft(c,{code:Ze.invalid_type,expected:vt.object,received:c.parsedType}),sn}const{status:r,ctx:i}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof uh&&this._def.unknownKeys==="strip"))for(const c in i.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=s[c],d=i.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Yu(i,d,i.path,c)),alwaysSet:c in i.data})}if(this._def.catchall instanceof uh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:i.data[u]}});else if(c==="strict")o.length>0&&(ft(i,{code:Ze.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=i.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Yu(i,d,i.path,u)),alwaysSet:u in i.data})}}return i.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>ba.mergeObjectSync(r,c)):ba.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(e){return Rt.errToObj,new ni({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var i,s,a,o;const l=(a=(s=(i=this._def).errorMap)===null||s===void 0?void 0:s.call(i,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=Rt.errToObj(e).message)!==null&&o!==void 0?o:l}:{message:l}}}:{}})}strip(){return new ni({...this._def,unknownKeys:"strip"})}passthrough(){return new ni({...this._def,unknownKeys:"passthrough"})}extend(e){return new ni({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ni({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:nn.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new ni({...this._def,catchall:e})}pick(e){const n={};return Gn.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new ni({...this._def,shape:()=>n})}omit(e){const n={};return Gn.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new ni({...this._def,shape:()=>n})}deepPartial(){return yv(this)}partial(e){const n={};return Gn.objectKeys(this.shape).forEach(r=>{const i=this.shape[r];e&&!e[r]?n[r]=i:n[r]=i.optional()}),new ni({...this._def,shape:()=>n})}required(e){const n={};return Gn.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof ju;)s=s._def.innerType;n[r]=s}}),new ni({...this._def,shape:()=>n})}keyof(){return kme(Gn.objectKeys(this.shape))}}ni.create=(t,e)=>new ni({shape:()=>t,unknownKeys:"strip",catchall:uh.create(),typeName:nn.ZodObject,...gn(e)});ni.strictCreate=(t,e)=>new ni({shape:()=>t,unknownKeys:"strict",catchall:uh.create(),typeName:nn.ZodObject,...gn(e)});ni.lazycreate=(t,e)=>new ni({shape:t,unknownKeys:"strip",catchall:uh.create(),typeName:nn.ZodObject,...gn(e)});class GS extends En{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function i(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=s.map(o=>new Yo(o.ctx.common.issues));return ft(n,{code:Ze.invalid_union,unionErrors:a}),sn}if(n.common.async)return Promise.all(r.map(async s=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await s._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(i);{let s;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(s)return n.common.issues.push(...s.ctx.common.issues),s.result;const o=a.map(l=>new Yo(l));return ft(n,{code:Ze.invalid_union,unionErrors:o}),sn}}get options(){return this._def.options}}GS.create=(t,e)=>new GS({options:t,typeName:nn.ZodUnion,...gn(e)});const _d=t=>t instanceof KS?_d(t.schema):t instanceof Xc?_d(t.innerType()):t instanceof YS?[t.value]:t instanceof Qf?t.options:t instanceof ZS?Gn.objectValues(t.enum):t instanceof QS?_d(t._def.innerType):t instanceof WS?[void 0]:t instanceof HS?[null]:t instanceof ju?[void 0,..._d(t.unwrap())]:t instanceof Jf?[null,..._d(t.unwrap())]:t instanceof tG||t instanceof e_?_d(t.unwrap()):t instanceof JS?_d(t._def.innerType):[];class FP extends En{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==vt.object)return ft(n,{code:Ze.invalid_type,expected:vt.object,received:n.parsedType}),sn;const r=this.discriminator,i=n.data[r],s=this.optionsMap.get(i);return s?n.common.async?s._parseAsync({data:n.data,path:n.path,parent:n}):s._parseSync({data:n.data,path:n.path,parent:n}):(ft(n,{code:Ze.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),sn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const i=new Map;for(const s of n){const a=_d(s.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(i.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);i.set(o,s)}}return new FP({typeName:nn.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:i,...gn(r)})}}function a4(t,e){const n=Ad(t),r=Ad(e);if(t===e)return{valid:!0,data:t};if(n===vt.object&&r===vt.object){const i=Gn.objectKeys(e),s=Gn.objectKeys(t).filter(o=>i.indexOf(o)!==-1),a={...t,...e};for(const o of s){const l=a4(t[o],e[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===vt.array&&r===vt.array){if(t.length!==e.length)return{valid:!1};const i=[];for(let s=0;s<t.length;s++){const a=t[s],o=e[s],l=a4(a,o);if(!l.valid)return{valid:!1};i.push(l.data)}return{valid:!0,data:i}}else return n===vt.date&&r===vt.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class qS extends En{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=(s,a)=>{if(i4(s)||i4(a))return sn;const o=a4(s.value,a.value);return o.valid?((s4(s)||s4(a))&&n.dirty(),{status:n.value,value:o.data}):(ft(r,{code:Ze.invalid_intersection_types}),sn)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,a])=>i(s,a)):i(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}qS.create=(t,e,n)=>new qS({left:t,right:e,typeName:nn.ZodIntersection,...gn(n)});class Zu extends En{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==vt.array)return ft(r,{code:Ze.invalid_type,expected:vt.array,received:r.parsedType}),sn;if(r.data.length<this._def.items.length)return ft(r,{code:Ze.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),sn;!this._def.rest&&r.data.length>this._def.items.length&&(ft(r,{code:Ze.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const s=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Yu(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(s).then(a=>ba.mergeArray(n,a)):ba.mergeArray(n,s)}get items(){return this._def.items}rest(e){return new Zu({...this._def,rest:e})}}Zu.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Zu({items:t,typeName:nn.ZodTuple,rest:null,...gn(e)})};class XS extends En{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==vt.object)return ft(r,{code:Ze.invalid_type,expected:vt.object,received:r.parsedType}),sn;const i=[],s=this._def.keyType,a=this._def.valueType;for(const o in r.data)i.push({key:s._parse(new Yu(r,o,r.path,o)),value:a._parse(new Yu(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?ba.mergeObjectAsync(n,i):ba.mergeObjectSync(n,i)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof En?new XS({keyType:e,valueType:n,typeName:nn.ZodRecord,...gn(r)}):new XS({keyType:Rc.create(),valueType:e,typeName:nn.ZodRecord,...gn(n)})}}class lk extends En{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==vt.map)return ft(r,{code:Ze.invalid_type,expected:vt.map,received:r.parsedType}),sn;const i=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:i._parse(new Yu(r,o,r.path,[c,"key"])),value:s._parse(new Yu(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return sn;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return sn;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}lk.create=(t,e,n)=>new lk({valueType:e,keyType:t,typeName:nn.ZodMap,...gn(n)});class $g extends En{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==vt.set)return ft(r,{code:Ze.invalid_type,expected:vt.set,received:r.parsedType}),sn;const i=this._def;i.minSize!==null&&r.data.size<i.minSize.value&&(ft(r,{code:Ze.too_small,minimum:i.minSize.value,type:"set",inclusive:!0,exact:!1,message:i.minSize.message}),n.dirty()),i.maxSize!==null&&r.data.size>i.maxSize.value&&(ft(r,{code:Ze.too_big,maximum:i.maxSize.value,type:"set",inclusive:!0,exact:!1,message:i.maxSize.message}),n.dirty());const s=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return sn;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>s._parse(new Yu(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(e,n){return new $g({...this._def,minSize:{value:e,message:Rt.toString(n)}})}max(e,n){return new $g({...this._def,maxSize:{value:e,message:Rt.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}$g.create=(t,e)=>new $g({valueType:t,minSize:null,maxSize:null,typeName:nn.ZodSet,...gn(e)});class hx extends En{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==vt.function)return ft(n,{code:Ze.invalid_type,expected:vt.function,received:n.parsedType}),sn;function r(o,l){return ik({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,rk(),T0].filter(c=>!!c),issueData:{code:Ze.invalid_arguments,argumentsError:l}})}function i(o,l){return ik({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,rk(),T0].filter(c=>!!c),issueData:{code:Ze.invalid_return_type,returnTypeError:l}})}const s={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof C0){const o=this;return qa(async function(...l){const c=new Yo([]),u=await o._def.args.parseAsync(l,s).catch(f=>{throw c.addIssue(r(l,f)),c}),d=await Reflect.apply(a,this,u);return await o._def.returns._def.type.parseAsync(d,s).catch(f=>{throw c.addIssue(i(d,f)),c})})}else{const o=this;return qa(function(...l){const c=o._def.args.safeParse(l,s);if(!c.success)throw new Yo([r(l,c.error)]);const u=Reflect.apply(a,this,c.data),d=o._def.returns.safeParse(u,s);if(!d.success)throw new Yo([i(u,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new hx({...this._def,args:Zu.create(e).rest(Qm.create())})}returns(e){return new hx({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new hx({args:e||Zu.create([]).rest(Qm.create()),returns:n||Qm.create(),typeName:nn.ZodFunction,...gn(r)})}}class KS extends En{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}KS.create=(t,e)=>new KS({getter:t,typeName:nn.ZodLazy,...gn(e)});class YS extends En{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return ft(n,{received:n.data,code:Ze.invalid_literal,expected:this._def.value}),sn}return{status:"valid",value:e.data}}get value(){return this._def.value}}YS.create=(t,e)=>new YS({value:t,typeName:nn.ZodLiteral,...gn(e)});function kme(t,e){return new Qf({values:t,typeName:nn.ZodEnum,...gn(e)})}class Qf extends En{constructor(){super(...arguments),qw.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return ft(n,{expected:Gn.joinValues(r),received:n.parsedType,code:Ze.invalid_type}),sn}if(sk(this,qw)||Cme(this,qw,new Set(this._def.values)),!sk(this,qw).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return ft(n,{received:n.data,code:Ze.invalid_enum_value,options:r}),sn}return qa(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Qf.create(e,{...this._def,...n})}exclude(e,n=this._def){return Qf.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}qw=new WeakMap;Qf.create=kme;class ZS extends En{constructor(){super(...arguments),Xw.set(this,void 0)}_parse(e){const n=Gn.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==vt.string&&r.parsedType!==vt.number){const i=Gn.objectValues(n);return ft(r,{expected:Gn.joinValues(i),received:r.parsedType,code:Ze.invalid_type}),sn}if(sk(this,Xw)||Cme(this,Xw,new Set(Gn.getValidEnumValues(this._def.values))),!sk(this,Xw).has(e.data)){const i=Gn.objectValues(n);return ft(r,{received:r.data,code:Ze.invalid_enum_value,options:i}),sn}return qa(e.data)}get enum(){return this._def.values}}Xw=new WeakMap;ZS.create=(t,e)=>new ZS({values:t,typeName:nn.ZodNativeEnum,...gn(e)});class C0 extends En{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==vt.promise&&n.common.async===!1)return ft(n,{code:Ze.invalid_type,expected:vt.promise,received:n.parsedType}),sn;const r=n.parsedType===vt.promise?n.data:Promise.resolve(n.data);return qa(r.then(i=>this._def.type.parseAsync(i,{path:n.path,errorMap:n.common.contextualErrorMap})))}}C0.create=(t,e)=>new C0({type:t,typeName:nn.ZodPromise,...gn(e)});class Xc extends En{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===nn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),i=this._def.effect||null,s={addIssue:a=>{ft(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),i.type==="preprocess"){const a=i.transform(r.data,s);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return sn;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?sn:l.status==="dirty"||n.value==="dirty"?$v(l.value):l});{if(n.value==="aborted")return sn;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?sn:o.status==="dirty"||n.value==="dirty"?$v(o.value):o}}if(i.type==="refinement"){const a=o=>{const l=i.refinement(o,s);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?sn:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?sn:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(i.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Og(a))return a;const o=i.transform(a.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Og(a)?Promise.resolve(i.transform(a.value,s)).then(o=>({status:n.value,value:o})):a);Gn.assertNever(i)}}Xc.create=(t,e,n)=>new Xc({schema:t,typeName:nn.ZodEffects,effect:e,...gn(n)});Xc.createWithPreprocess=(t,e,n)=>new Xc({schema:e,effect:{type:"preprocess",transform:t},typeName:nn.ZodEffects,...gn(n)});class ju extends En{_parse(e){return this._getType(e)===vt.undefined?qa(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ju.create=(t,e)=>new ju({innerType:t,typeName:nn.ZodOptional,...gn(e)});class Jf extends En{_parse(e){return this._getType(e)===vt.null?qa(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Jf.create=(t,e)=>new Jf({innerType:t,typeName:nn.ZodNullable,...gn(e)});class QS extends En{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===vt.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}QS.create=(t,e)=>new QS({innerType:t,typeName:nn.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...gn(e)});class JS extends En{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},i=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return US(i)?i.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Yo(r.common.issues)},input:r.data})})):{status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Yo(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}JS.create=(t,e)=>new JS({innerType:t,typeName:nn.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...gn(e)});class ck extends En{_parse(e){if(this._getType(e)!==vt.nan){const r=this._getOrReturnCtx(e);return ft(r,{code:Ze.invalid_type,expected:vt.nan,received:r.parsedType}),sn}return{status:"valid",value:e.data}}}ck.create=t=>new ck({typeName:nn.ZodNaN,...gn(t)});const wbt=Symbol("zod_brand");class tG extends En{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class cE extends En{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?sn:s.status==="dirty"?(n.dirty(),$v(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const i=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?sn:i.status==="dirty"?(n.dirty(),{status:"dirty",value:i.value}):this._def.out._parseSync({data:i.value,path:r.path,parent:r})}}static create(e,n){return new cE({in:e,out:n,typeName:nn.ZodPipeline})}}class e_ extends En{_parse(e){const n=this._def.innerType._parse(e),r=i=>(Og(i)&&(i.value=Object.freeze(i.value)),i);return US(n)?n.then(i=>r(i)):r(n)}unwrap(){return this._def.innerType}}e_.create=(t,e)=>new e_({innerType:t,typeName:nn.ZodReadonly,...gn(e)});function YQ(t,e){const n=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof n=="string"?{message:n}:n}function Mme(t,e={},n){return t?E0.create().superRefine((r,i)=>{var s,a;const o=t(r);if(o instanceof Promise)return o.then(l=>{var c,u;if(!l){const d=YQ(e,r),h=(u=(c=d.fatal)!==null&&c!==void 0?c:n)!==null&&u!==void 0?u:!0;i.addIssue({code:"custom",...d,fatal:h})}});if(!o){const l=YQ(e,r),c=(a=(s=l.fatal)!==null&&s!==void 0?s:n)!==null&&a!==void 0?a:!0;i.addIssue({code:"custom",...l,fatal:c})}}):E0.create()}const Sbt={object:ni.lazycreate};var nn;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(nn||(nn={}));const _bt=(t,e={message:`Input not instance of ${t.name}`})=>Mme(n=>n instanceof t,e),Rme=Rc.create,Pme=Yf.create,Tbt=ck.create,Ebt=Zf.create,Ome=VS.create,Cbt=Dg.create,Nbt=ak.create,Abt=WS.create,Ibt=HS.create,kbt=E0.create,Mbt=Qm.create,Rbt=uh.create,Pbt=ok.create,Obt=zc.create,Dbt=ni.create,$bt=ni.strictCreate,Lbt=GS.create,Fbt=FP.create,jbt=qS.create,zbt=Zu.create,Bbt=XS.create,Ubt=lk.create,Vbt=$g.create,Wbt=hx.create,Hbt=KS.create,Gbt=YS.create,qbt=Qf.create,Xbt=ZS.create,Kbt=C0.create,ZQ=Xc.create,Ybt=ju.create,Zbt=Jf.create,Qbt=Xc.createWithPreprocess,Jbt=cE.create,ewt=()=>Rme().optional(),twt=()=>Pme().optional(),nwt=()=>Ome().optional(),rwt={string:t=>Rc.create({...t,coerce:!0}),number:t=>Yf.create({...t,coerce:!0}),boolean:t=>VS.create({...t,coerce:!0}),bigint:t=>Zf.create({...t,coerce:!0}),date:t=>Dg.create({...t,coerce:!0})},iwt=sn;var Lh=Object.freeze({__proto__:null,defaultErrorMap:T0,setErrorMap:Q0t,getErrorMap:rk,makeIssue:ik,EMPTY_PATH:J0t,addIssueToContext:ft,ParseStatus:ba,INVALID:sn,DIRTY:$v,OK:qa,isAborted:i4,isDirty:s4,isValid:Og,isAsync:US,get util(){return Gn},get objectUtil(){return r4},ZodParsedType:vt,getParsedType:Ad,ZodType:En,datetimeRegex:Ime,ZodString:Rc,ZodNumber:Yf,ZodBigInt:Zf,ZodBoolean:VS,ZodDate:Dg,ZodSymbol:ak,ZodUndefined:WS,ZodNull:HS,ZodAny:E0,ZodUnknown:Qm,ZodNever:uh,ZodVoid:ok,ZodArray:zc,ZodObject:ni,ZodUnion:GS,ZodDiscriminatedUnion:FP,ZodIntersection:qS,ZodTuple:Zu,ZodRecord:XS,ZodMap:lk,ZodSet:$g,ZodFunction:hx,ZodLazy:KS,ZodLiteral:YS,ZodEnum:Qf,ZodNativeEnum:ZS,ZodPromise:C0,ZodEffects:Xc,ZodTransformer:Xc,ZodOptional:ju,ZodNullable:Jf,ZodDefault:QS,ZodCatch:JS,ZodNaN:ck,BRAND:wbt,ZodBranded:tG,ZodPipeline:cE,ZodReadonly:e_,custom:Mme,Schema:En,ZodSchema:En,late:Sbt,get ZodFirstPartyTypeKind(){return nn},coerce:rwt,any:kbt,array:Obt,bigint:Ebt,boolean:Ome,date:Cbt,discriminatedUnion:Fbt,effect:ZQ,enum:qbt,function:Wbt,instanceof:_bt,intersection:jbt,lazy:Hbt,literal:Gbt,map:Ubt,nan:Tbt,nativeEnum:Xbt,never:Rbt,null:Ibt,nullable:Zbt,number:Pme,object:Dbt,oboolean:nwt,onumber:twt,optional:Ybt,ostring:ewt,pipeline:Jbt,preprocess:Qbt,promise:Kbt,record:Bbt,set:Vbt,strictObject:$bt,string:Rme,symbol:Nbt,transformer:ZQ,tuple:zbt,undefined:Abt,union:Lbt,unknown:Mbt,void:Pbt,NEVER:iwt,ZodIssueCode:Ze,quotelessJson:Z0t,ZodError:Yo});const QQ=(t,e,n)=>{if(t&&"reportValidity"in t){const r=lt(n,e);t.setCustomValidity(r&&r.message||""),t.reportValidity()}},Dme=(t,e)=>{for(const n in e.fields){const r=e.fields[n];r&&r.ref&&"reportValidity"in r.ref?QQ(r.ref,n,t):r.refs&&r.refs.forEach(i=>QQ(i,n,t))}},swt=(t,e)=>{e.shouldUseNativeValidation&&Dme(t,e);const n={};for(const r in t){const i=lt(e.fields,r),s=Object.assign(t[r]||{},{ref:i&&i.ref});if(awt(e.names||Object.keys(t),r)){const a=Object.assign({},lt(n,r));sr(a,"root",s),sr(n,r,a)}else sr(n,r,s)}return n},awt=(t,e)=>t.some(n=>n.startsWith(e+"."));var owt=function(t,e){for(var n={};t.length;){var r=t[0],i=r.code,s=r.message,a=r.path.join(".");if(!n[a])if("unionErrors"in r){var o=r.unionErrors[0].errors[0];n[a]={message:o.message,type:o.code}}else n[a]={message:s,type:i};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(d){return t.push(d)})}),e){var l=n[a].types,c=l&&l[r.code];n[a]=vme(a,e,n,i,c?[].concat(c,r.message):r.message)}t.shift()}return n},JQ=function(t,e,n){return n===void 0&&(n={}),function(r,i,s){try{return Promise.resolve(function(a,o){try{var l=Promise.resolve(t[n.mode==="sync"?"parse":"parseAsync"](r,e)).then(function(c){return s.shouldUseNativeValidation&&Dme({},s),{errors:{},values:n.raw?r:c}})}catch(c){return o(c)}return l&&l.then?l.then(void 0,o):l}(0,function(a){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(a))return{values:{},errors:swt(owt(a.errors,!s.shouldUseNativeValidation&&s.criteriaMode==="all"),s)};throw a}))}catch(a){return Promise.reject(a)}}};const eJ=P0t,$me=P.createContext({}),Uy=({...t})=>v.jsx($me.Provider,{value:{name:t.name},children:v.jsx(L0t,{...t})}),jP=()=>{const t=P.useContext($me),e=P.useContext(Lme),{getFieldState:n,formState:r}=LP(),i=n(t.name,r);if(!t)throw new Error("useFormField should be used within <FormField>");const{id:s}=e;return{id:s,name:t.name,formItemId:`${s}-form-item`,formDescriptionId:`${s}-form-item-description`,formMessageId:`${s}-form-item-message`,...i}},Lme=P.createContext({}),um=P.forwardRef(({className:t,...e},n)=>{const r=P.useId();return v.jsx(Lme.Provider,{value:{id:r},children:v.jsx("div",{ref:n,className:Pt("space-y-2",t),...e})})});um.displayName="FormItem";const dm=P.forwardRef(({className:t,...e},n)=>{const{error:r,formItemId:i}=jP();return v.jsx(Nc,{ref:n,className:Pt(r&&"text-destructive",t),htmlFor:i,...e})});dm.displayName="FormLabel";const hm=P.forwardRef(({...t},e)=>{const{error:n,formItemId:r,formDescriptionId:i,formMessageId:s}=jP();return v.jsx(vie,{ref:e,id:r,"aria-describedby":n?`${i} ${s}`:`${i}`,"aria-invalid":!!n,...t})});hm.displayName="FormControl";const lwt=P.forwardRef(({className:t,...e},n)=>{const{formDescriptionId:r}=jP();return v.jsx("p",{ref:n,id:r,className:Pt("text-sm text-muted-foreground",t),...e})});lwt.displayName="FormDescription";const fm=P.forwardRef(({className:t,children:e,...n},r)=>{const{error:i,formMessageId:s}=jP(),a=i?String((i==null?void 0:i.message)??""):e;return a?v.jsx("p",{ref:r,id:s,className:Pt("text-sm font-medium text-destructive",t),...n,children:a}):null});fm.displayName="FormMessage";const cwt=()=>{var c;const{data:e,isLoading:n}=Kr({queryKey:["/api/users/1"]}),r=Lh.object({fullName:Lh.string().min(2,{message:"Name must be at least 2 characters."}),email:Lh.string().email({message:"Please enter a valid email address."}),username:Lh.string().min(3,{message:"Username must be at least 3 characters."})}),i=Lh.object({currentPassword:Lh.string().min(6,{message:"Password must be at least 6 characters."}),newPassword:Lh.string().min(8,{message:"New password must be at least 8 characters."}),confirmPassword:Lh.string().min(8,{message:"Confirm password must be at least 8 characters."})}).refine(u=>u.newPassword===u.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),s=XQ({resolver:JQ(r),defaultValues:{fullName:(e==null?void 0:e.fullName)||"",email:(e==null?void 0:e.email)||"",username:(e==null?void 0:e.username)||""}}),a=XQ({resolver:JQ(i),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}});le.useEffect(()=>{e&&s.reset({fullName:e.fullName,email:e.email,username:e.username})},[e,s]);const o=u=>{console.log(u)},l=u=>{console.log(u)};return v.jsxs(nd,{title:"My Profile",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"My Profile"}),v.jsx("p",{className:"text-neutral-600",children:"Manage your account settings and preferences"})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[v.jsx("div",{className:"md:col-span-1",children:v.jsx(Dt,{children:v.jsxs(Lt,{className:"p-6",children:[v.jsxs("div",{className:"flex flex-col items-center text-center",children:[v.jsx(XH,{className:"h-24 w-24 mb-4",children:v.jsx(KH,{className:"text-2xl bg-primary text-white",children:((c=e==null?void 0:e.fullName)==null?void 0:c.split(" ").map(u=>u[0]).join(""))||"JD"})}),v.jsx("h2",{className:"font-semibold text-lg",children:n?"Loading...":e==null?void 0:e.fullName}),v.jsx("p",{className:"text-sm text-neutral-500",children:n?"":e==null?void 0:e.email}),v.jsx("p",{className:"text-xs bg-blue-100 text-primary px-2 py-1 rounded-full mt-2",children:n?"":(e==null?void 0:e.userType)==="patient"?"Patient":"Therapist"})]}),v.jsxs("div",{className:"mt-6 space-y-2",children:[v.jsxs(et,{variant:"outline",className:"w-full justify-start",children:[v.jsx(lCe,{className:"mr-2 h-4 w-4"}),"Account"]}),v.jsxs(et,{variant:"outline",className:"w-full justify-start",children:[v.jsx(ZEe,{className:"mr-2 h-4 w-4"}),"Notifications"]}),v.jsxs(et,{variant:"outline",className:"w-full justify-start",children:[v.jsx(AA,{className:"mr-2 h-4 w-4"}),"Activity"]}),v.jsxs(et,{variant:"outline",className:"w-full justify-start",children:[v.jsx(rCe,{className:"mr-2 h-4 w-4"}),"Security"]})]})]})})}),v.jsx("div",{className:"md:col-span-3",children:v.jsxs(oy,{defaultValue:"account",children:[v.jsxs(Np,{className:"mb-4",children:[v.jsx(oi,{value:"account",children:"Account"}),v.jsx(oi,{value:"security",children:"Security"}),v.jsx(oi,{value:"preferences",children:"Preferences"})]}),v.jsx(li,{value:"account",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Profile Information"}),v.jsx(Nr,{children:"Update your account details and profile information"})]}),v.jsx(Lt,{children:v.jsx(eJ,{...s,children:v.jsxs("form",{onSubmit:s.handleSubmit(o),className:"space-y-6",children:[v.jsx(Uy,{control:s.control,name:"fullName",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"Full Name"}),v.jsx(hm,{children:v.jsx(Il,{placeholder:"John Doe",...u})}),v.jsx(fm,{})]})}),v.jsx(Uy,{control:s.control,name:"username",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"Username"}),v.jsx(hm,{children:v.jsx(Il,{placeholder:"johndoe",...u})}),v.jsx(fm,{})]})}),v.jsx(Uy,{control:s.control,name:"email",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"Email"}),v.jsx(hm,{children:v.jsx(Il,{placeholder:"john@example.com",...u})}),v.jsx(fm,{})]})}),v.jsx(et,{type:"submit",children:"Save Changes"})]})})})]})}),v.jsx(li,{value:"security",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Security Settings"}),v.jsx(Nr,{children:"Update your password and manage your account security"})]}),v.jsx(Lt,{children:v.jsx(eJ,{...a,children:v.jsxs("form",{onSubmit:a.handleSubmit(l),className:"space-y-6",children:[v.jsx(Uy,{control:a.control,name:"currentPassword",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"Current Password"}),v.jsx(hm,{children:v.jsx(Il,{type:"password",placeholder:"Enter current password",...u})}),v.jsx(fm,{})]})}),v.jsx(Uy,{control:a.control,name:"newPassword",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"New Password"}),v.jsx(hm,{children:v.jsx(Il,{type:"password",placeholder:"Enter new password",...u})}),v.jsx(fm,{})]})}),v.jsx(Uy,{control:a.control,name:"confirmPassword",render:({field:u})=>v.jsxs(um,{children:[v.jsx(dm,{children:"Confirm New Password"}),v.jsx(hm,{children:v.jsx(Il,{type:"password",placeholder:"Confirm new password",...u})}),v.jsx(fm,{})]})}),v.jsx(et,{type:"submit",children:"Update Password"})]})})})]})}),v.jsx(li,{value:"preferences",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Preferences"}),v.jsx(Nr,{children:"Manage your notification preferences and other settings"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-6",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-3",children:"Notifications"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Email Notifications"}),v.jsx("p",{className:"text-sm text-neutral-500",children:"Receive email about your therapy sessions"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(Nc,{htmlFor:"email-notifications",className:"sr-only",children:"Email Notifications"}),v.jsx("input",{id:"email-notifications",type:"checkbox",className:"form-checkbox h-5 w-5 text-primary rounded border-gray-300 focus:ring-primary",defaultChecked:!0})]})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Session Reminders"}),v.jsx("p",{className:"text-sm text-neutral-500",children:"Get reminders before your scheduled sessions"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(Nc,{htmlFor:"session-reminders",className:"sr-only",children:"Session Reminders"}),v.jsx("input",{id:"session-reminders",type:"checkbox",className:"form-checkbox h-5 w-5 text-primary rounded border-gray-300 focus:ring-primary",defaultChecked:!0})]})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Progress Updates"}),v.jsx("p",{className:"text-sm text-neutral-500",children:"Receive weekly updates on your recovery progress"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(Nc,{htmlFor:"progress-updates",className:"sr-only",children:"Progress Updates"}),v.jsx("input",{id:"progress-updates",type:"checkbox",className:"form-checkbox h-5 w-5 text-primary rounded border-gray-300 focus:ring-primary",defaultChecked:!0})]})]})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-3",children:"Appearance"}),v.jsx("div",{className:"space-y-3",children:v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsxs("div",{children:[v.jsx("p",{className:"font-medium",children:"Dark Mode"}),v.jsx("p",{className:"text-sm text-neutral-500",children:"Enable dark mode for the application"})]}),v.jsxs("div",{className:"flex items-center space-x-2",children:[v.jsx(Nc,{htmlFor:"dark-mode",className:"sr-only",children:"Dark Mode"}),v.jsx("input",{id:"dark-mode",type:"checkbox",className:"form-checkbox h-5 w-5 text-primary rounded border-gray-300 focus:ring-primary"})]})]})})]}),v.jsx(et,{children:"Save Preferences"})]})})]})})]})})]})]})};var zP="Dialog",[Fme,Y3t]=Yl(zP),[uwt,tu]=Fme(zP),jme=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:i,onOpenChange:s,modal:a=!0}=t,o=P.useRef(null),l=P.useRef(null),[c,u]=zf({prop:r,defaultProp:i??!1,onChange:s,caller:zP});return v.jsx(uwt,{scope:e,triggerRef:o,contentRef:l,contentId:Ud(),titleId:Ud(),descriptionId:Ud(),open:c,onOpenChange:u,onOpenToggle:P.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};jme.displayName=zP;var zme="DialogTrigger",Bme=P.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=tu(zme,n),s=Vn(e,i.triggerRef);return v.jsx(Wt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":iG(i.open),...r,ref:s,onClick:kt(t.onClick,i.onOpenToggle)})});Bme.displayName=zme;var nG="DialogPortal",[dwt,Ume]=Fme(nG,{forceMount:void 0}),Vme=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:i}=t,s=tu(nG,e);return v.jsx(dwt,{scope:e,forceMount:n,children:P.Children.map(r,a=>v.jsx(mh,{present:n||s.open,children:v.jsx(L_,{asChild:!0,container:i,children:a})}))})};Vme.displayName=nG;var uk="DialogOverlay",Wme=P.forwardRef((t,e)=>{const n=Ume(uk,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,s=tu(uk,t.__scopeDialog);return s.modal?v.jsx(mh,{present:r||s.open,children:v.jsx(fwt,{...i,ref:e})}):null});Wme.displayName=uk;var hwt=hg("DialogOverlay.RemoveScroll"),fwt=P.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=tu(uk,n);return v.jsx(lM,{as:hwt,allowPinchZoom:!0,shards:[i.contentRef],children:v.jsx(Wt.div,{"data-state":iG(i.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Lg="DialogContent",Hme=P.forwardRef((t,e)=>{const n=Ume(Lg,t.__scopeDialog),{forceMount:r=n.forceMount,...i}=t,s=tu(Lg,t.__scopeDialog);return v.jsx(mh,{present:r||s.open,children:s.modal?v.jsx(pwt,{...i,ref:e}):v.jsx(mwt,{...i,ref:e})})});Hme.displayName=Lg;var pwt=P.forwardRef((t,e)=>{const n=tu(Lg,t.__scopeDialog),r=P.useRef(null),i=Vn(e,n.contentRef,r);return P.useEffect(()=>{const s=r.current;if(s)return zU(s)},[]),v.jsx(Gme,{...t,ref:i,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:kt(t.onCloseAutoFocus,s=>{var a;s.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:kt(t.onPointerDownOutside,s=>{const a=s.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&s.preventDefault()}),onFocusOutside:kt(t.onFocusOutside,s=>s.preventDefault())})}),mwt=P.forwardRef((t,e)=>{const n=tu(Lg,t.__scopeDialog),r=P.useRef(!1),i=P.useRef(!1);return v.jsx(Gme,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:s=>{var a,o;(a=t.onCloseAutoFocus)==null||a.call(t,s),s.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),s.preventDefault()),r.current=!1,i.current=!1},onInteractOutside:s=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,s),s.defaultPrevented||(r.current=!0,s.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const a=s.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&s.preventDefault(),s.detail.originalEvent.type==="focusin"&&i.current&&s.preventDefault()}})}),Gme=P.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:i,onCloseAutoFocus:s,...a}=t,o=tu(Lg,n),l=P.useRef(null),c=Vn(e,l);return jU(),v.jsxs(v.Fragment,{children:[v.jsx(aM,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:i,onUnmountAutoFocus:s,children:v.jsx(j0,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":iG(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),v.jsxs(v.Fragment,{children:[v.jsx(gwt,{titleId:o.titleId}),v.jsx(vwt,{contentRef:l,descriptionId:o.descriptionId})]})]})}),rG="DialogTitle",qme=P.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=tu(rG,n);return v.jsx(Wt.h2,{id:i.titleId,...r,ref:e})});qme.displayName=rG;var Xme="DialogDescription",Kme=P.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=tu(Xme,n);return v.jsx(Wt.p,{id:i.descriptionId,...r,ref:e})});Kme.displayName=Xme;var Yme="DialogClose",Zme=P.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,i=tu(Yme,n);return v.jsx(Wt.button,{type:"button",...r,ref:e,onClick:kt(t.onClick,()=>i.onOpenChange(!1))})});Zme.displayName=Yme;function iG(t){return t?"open":"closed"}var Qme="DialogTitleWarning",[Z3t,Jme]=rEe(Qme,{contentName:Lg,titleName:rG,docsSlug:"dialog"}),gwt=({titleId:t})=>{const e=Jme(Qme),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return P.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},ywt="DialogDescriptionWarning",vwt=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${Jme(ywt).contentName}}.`;return P.useEffect(()=>{var s;const i=(s=t.current)==null?void 0:s.getAttribute("aria-describedby");e&&i&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},xwt=jme,bwt=Bme,wwt=Vme,ege=Wme,tge=Hme,nge=qme,rge=Kme,Swt=Zme;const v1=xwt,H2=bwt,_wt=wwt,ige=P.forwardRef(({className:t,...e},n)=>v.jsx(ege,{ref:n,className:Pt("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));ige.displayName=ege.displayName;const fx=P.forwardRef(({className:t,children:e,...n},r)=>v.jsxs(_wt,{children:[v.jsx(ige,{}),v.jsxs(tge,{ref:r,className:Pt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,v.jsxs(Swt,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[v.jsx(Jie,{className:"h-4 w-4"}),v.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));fx.displayName=tge.displayName;const px=({className:t,...e})=>v.jsx("div",{className:Pt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});px.displayName="DialogHeader";const mx=P.forwardRef(({className:t,...e},n)=>v.jsx(nge,{ref:n,className:Pt("text-lg font-semibold leading-none tracking-tight",t),...e}));mx.displayName=nge.displayName;const gx=P.forwardRef(({className:t,...e},n)=>v.jsx(rge,{ref:n,className:Pt("text-sm text-muted-foreground",t),...e}));gx.displayName=rge.displayName;function Twt(t,e,n=3){if(!t||t.length===0)return[];const r=t.map(i=>{let s=0;return i.targetArea.toLowerCase().includes("shoulder")&&(s+=5),i.difficulty==="easy"?s+=3:i.difficulty==="medium"?s+=5:i.difficulty==="hard"&&(s+=2),s+=Math.random()*3,{exercise:i,score:s}});return r.sort((i,s)=>s.score-i.score),r.slice(0,n).map(i=>i.exercise)}const Ewt=()=>{const[t,e]=P.useState(""),[n,r]=P.useState(null),[i,s]=P.useState("all"),a=1,{data:o,isLoading:l}=Kr({queryKey:["/api/exercises"]}),c=o==null?void 0:o.filter(h=>{const f=h.name.toLowerCase().includes(t.toLowerCase())||h.description.toLowerCase().includes(t.toLowerCase())||h.targetArea.toLowerCase().includes(t.toLowerCase()),p=i==="all"||h.difficulty===i;return f&&p}),u=c==null?void 0:c.reduce((h,f)=>(h[f.targetArea]||(h[f.targetArea]=[]),h[f.targetArea].push(f),h),{}),d=o?Twt(o,a,5):[];return v.jsxs(nd,{title:"Exercises",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Exercises Library"}),v.jsx("p",{className:"text-neutral-600",children:"Browse and explore exercises recommended by your physiotherapist"})]}),v.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[v.jsxs("div",{className:"relative flex-grow",children:[v.jsx(sCe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-neutral-400",size:18}),v.jsx(Il,{placeholder:"Search exercises...",className:"pl-10",value:t,onChange:h=>e(h.target.value)})]}),v.jsxs("div",{className:"flex space-x-2",children:[v.jsx(et,{variant:i==="all"?"default":"outline",onClick:()=>s("all"),size:"sm",children:"All"}),v.jsx(et,{variant:i==="easy"?"default":"outline",onClick:()=>s("easy"),size:"sm",children:"Easy"}),v.jsx(et,{variant:i==="medium"?"default":"outline",onClick:()=>s("medium"),size:"sm",children:"Medium"}),v.jsx(et,{variant:i==="hard"?"default":"outline",onClick:()=>s("hard"),size:"sm",children:"Hard"})]})]}),v.jsxs(oy,{defaultValue:"recommended",children:[v.jsxs(Np,{className:"mb-4",children:[v.jsx(oi,{value:"recommended",children:"Recommended"}),v.jsx(oi,{value:"all",children:"All Exercises"}),v.jsx(oi,{value:"byArea",children:"By Target Area"})]}),v.jsx(li,{value:"recommended",children:v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l?v.jsx("p",{children:"Loading exercises..."}):d.length>0?d.map(h=>v.jsxs(v1,{children:[v.jsx(H2,{asChild:!0,children:v.jsx("div",{onClick:()=>r(h),children:v.jsx(j2,{exercise:h,isNew:h.id%2===0})})}),n&&v.jsxs(fx,{className:"sm:max-w-md",children:[v.jsxs(px,{children:[v.jsx(mx,{children:n.name}),v.jsx(gx,{children:n.description})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Exercise Details"}),v.jsxs("div",{className:"mt-2 space-y-2",children:[v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Target Area"}),v.jsx("span",{className:"font-medium",children:n.targetArea})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Difficulty"}),v.jsx(qr,{variant:"outline",className:n.difficulty==="easy"?"bg-green-100 text-green-800 border-none":n.difficulty==="medium"?"bg-yellow-100 text-yellow-800 border-none":"bg-red-100 text-red-800 border-none",children:n.difficulty.charAt(0).toUpperCase()+n.difficulty.slice(1)})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Sets"}),v.jsx("span",{className:"font-medium",children:n.sets})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Repetitions"}),v.jsx("span",{className:"font-medium",children:n.reps})]})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Instructions"}),v.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-neutral-600",children:[v.jsx("li",{children:"Start by standing straight with your arms by your sides."}),v.jsx("li",{children:"Slowly raise your arm forward and upward to shoulder height."}),v.jsx("li",{children:"Hold the position for a few seconds."}),v.jsx("li",{children:"Slowly lower your arm back to the starting position."}),v.jsx("li",{children:"Repeat for the recommended number of repetitions."})]})]}),v.jsx("div",{className:"flex justify-end",children:v.jsxs(et,{children:["Start Exercise ",v.jsx(Tm,{className:"ml-2 h-4 w-4"})]})})]})]})]},h.id)):v.jsx("p",{children:"No recommended exercises found. Try browsing all exercises."})})}),v.jsx(li,{value:"all",children:v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l?v.jsx("p",{children:"Loading exercises..."}):c&&c.length>0?c.map(h=>v.jsxs(v1,{children:[v.jsx(H2,{asChild:!0,children:v.jsx("div",{onClick:()=>r(h),children:v.jsx(j2,{exercise:h})})}),n&&v.jsxs(fx,{className:"sm:max-w-md",children:[v.jsxs(px,{children:[v.jsx(mx,{children:n.name}),v.jsx(gx,{children:n.description})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Exercise Details"}),v.jsxs("div",{className:"mt-2 space-y-2",children:[v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Target Area"}),v.jsx("span",{className:"font-medium",children:n.targetArea})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Difficulty"}),v.jsx(qr,{variant:"outline",className:n.difficulty==="easy"?"bg-green-100 text-green-800 border-none":n.difficulty==="medium"?"bg-yellow-100 text-yellow-800 border-none":"bg-red-100 text-red-800 border-none",children:n.difficulty.charAt(0).toUpperCase()+n.difficulty.slice(1)})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Sets"}),v.jsx("span",{className:"font-medium",children:n.sets})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Repetitions"}),v.jsx("span",{className:"font-medium",children:n.reps})]})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Instructions"}),v.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-neutral-600",children:[v.jsx("li",{children:"Start by standing straight with your arms by your sides."}),v.jsx("li",{children:"Slowly raise your arm forward and upward to shoulder height."}),v.jsx("li",{children:"Hold the position for a few seconds."}),v.jsx("li",{children:"Slowly lower your arm back to the starting position."}),v.jsx("li",{children:"Repeat for the recommended number of repetitions."})]})]}),v.jsx("div",{className:"flex justify-end",children:v.jsxs(et,{children:["Start Exercise ",v.jsx(Tm,{className:"ml-2 h-4 w-4"})]})})]})]})]},h.id)):v.jsxs("div",{className:"col-span-3 text-center py-12",children:[v.jsx(AA,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),v.jsx("h3",{className:"font-medium text-neutral-800 mb-1",children:"No Exercises Found"}),v.jsx("p",{className:"text-neutral-600",children:"Try adjusting your search or filters."})]})})}),v.jsx(li,{value:"byArea",children:l?v.jsx("p",{children:"Loading exercises..."}):u&&Object.keys(u).length>0?Object.entries(u).map(([h,f])=>v.jsxs("div",{className:"mb-8",children:[v.jsxs("h2",{className:"text-xl font-semibold mb-4 capitalize",children:[h," Exercises"]}),v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(p=>v.jsxs(v1,{children:[v.jsx(H2,{asChild:!0,children:v.jsx("div",{onClick:()=>r(p),children:v.jsx(j2,{exercise:p})})}),n&&v.jsxs(fx,{className:"sm:max-w-md",children:[v.jsxs(px,{children:[v.jsx(mx,{children:n.name}),v.jsx(gx,{children:n.description})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Exercise Details"}),v.jsxs("div",{className:"mt-2 space-y-2",children:[v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Target Area"}),v.jsx("span",{className:"font-medium",children:n.targetArea})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Difficulty"}),v.jsx(qr,{variant:"outline",className:n.difficulty==="easy"?"bg-green-100 text-green-800 border-none":n.difficulty==="medium"?"bg-yellow-100 text-yellow-800 border-none":"bg-red-100 text-red-800 border-none",children:n.difficulty.charAt(0).toUpperCase()+n.difficulty.slice(1)})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Sets"}),v.jsx("span",{className:"font-medium",children:n.sets})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Repetitions"}),v.jsx("span",{className:"font-medium",children:n.reps})]})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Instructions"}),v.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-neutral-600",children:[v.jsx("li",{children:"Start by standing straight with your arms by your sides."}),v.jsx("li",{children:"Slowly raise your arm forward and upward to shoulder height."}),v.jsx("li",{children:"Hold the position for a few seconds."}),v.jsx("li",{children:"Slowly lower your arm back to the starting position."}),v.jsx("li",{children:"Repeat for the recommended number of repetitions."})]})]}),v.jsx("div",{className:"flex justify-end",children:v.jsxs(et,{children:["Start Exercise ",v.jsx(Tm,{className:"ml-2 h-4 w-4"})]})})]})]})]},p.id))})]},h)):v.jsxs("div",{className:"text-center py-12",children:[v.jsx(AA,{className:"h-12 w-12 text-neutral-300 mx-auto mb-4"}),v.jsx("h3",{className:"font-medium text-neutral-800 mb-1",children:"No Exercises Found"}),v.jsx("p",{className:"text-neutral-600",children:"Try adjusting your search or filters."})]})})]})]})},Cwt=()=>{const[t,e]=P.useState("month"),n=1,{data:r,isLoading:i}=Kr({queryKey:[`/api/progress/${n}`]}),{data:s,isLoading:a}=Kr({queryKey:[`/api/sessions/patient/${n}`]}),l=(()=>{if(!s)return{completed:0,missed:0,total:0,rate:0};const p=s.filter(x=>x.status==="completed").length,g=s.filter(x=>x.status==="missed").length,m=s.length,y=m>0?p/m*100:0;return{completed:p,missed:g,total:m,rate:y}})(),u=!r||r.length===0?{rangeOfMotion:0,postureQuality:0,painLevel:0}:{rangeOfMotion:r[0].rangeOfMotion||0,postureQuality:r[0].postureQuality||0,painLevel:r[0].painLevel||0},d=p=>{if(!r||r.length<2)return 0;const g=r[0][p]||0,m=r[1][p]||0;return p==="painLevel"?m-g:g-m},h={rangeOfMotion:d("rangeOfMotion"),postureQuality:d("postureQuality"),painLevel:d("painLevel")},f=(p,g=!1)=>{const m=g?p<0:p>0,y=Math.abs(p);return m?`+${y}`:`-${y}`};return v.jsxs(nd,{title:"Progress Reports",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Progress Reports"}),v.jsx("p",{className:"text-neutral-600",children:"Track your recovery journey and analyze your improvements over time"})]}),v.jsxs("div",{className:"flex justify-between items-center mb-6",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800",children:"Progress Dashboard"}),v.jsxs("div",{className:"flex space-x-2",children:[v.jsx(et,{variant:t==="week"?"default":"outline",size:"sm",onClick:()=>e("week"),children:"Week"}),v.jsx(et,{variant:t==="month"?"default":"outline",size:"sm",onClick:()=>e("month"),children:"Month"}),v.jsx(et,{variant:t==="all"?"default":"outline",size:"sm",onClick:()=>e("all"),children:"All"})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Range of Motion"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map(p=>({date:new Date(p.date),value:p.rangeOfMotion||0})),timeRange:t,dataKey:"rangeOfMotion",color:"#1976D2"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-sm text-neutral-600",children:"Current"}),v.jsxs("div",{className:"font-medium text-lg flex items-center",children:[u.rangeOfMotion,"°",h.rangeOfMotion!==0&&v.jsxs(qr,{variant:"outline",className:h.rangeOfMotion>0?"bg-green-100 text-green-800 border-none ml-2":"bg-red-100 text-red-800 border-none ml-2",children:[h.rangeOfMotion>0?v.jsx(qC,{className:"h-3 w-3 mr-1"}):v.jsx(y$,{className:"h-3 w-3 mr-1"}),f(h.rangeOfMotion),"°"]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("span",{className:"text-sm text-neutral-600",children:"Goal"}),v.jsx("div",{className:"font-medium text-lg",children:"180°"})]})]}),v.jsx("div",{className:"mt-2",children:v.jsx(dx,{value:u.rangeOfMotion/180*100,color:"primary"})})]})]})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Posture Quality"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map(p=>({date:new Date(p.date),value:p.postureQuality||0})),timeRange:t,dataKey:"postureQuality",color:"#4CAF50"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[v.jsxs("div",{className:"bg-green-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Good"}),v.jsxs("p",{className:"text-lg font-semibold text-green-600",children:[u.postureQuality,"%"]})]}),v.jsxs("div",{className:"bg-yellow-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Fair"}),v.jsxs("p",{className:"text-lg font-semibold text-yellow-600",children:[Math.round(100-u.postureQuality-5),"%"]})]}),v.jsxs("div",{className:"bg-red-50 p-2 rounded-lg text-center",children:[v.jsx("p",{className:"text-xs text-neutral-600",children:"Poor"}),v.jsx("p",{className:"text-lg font-semibold text-red-600",children:"5%"})]})]}),h.postureQuality!==0&&v.jsxs("div",{className:"text-sm text-green-600 mt-2 font-medium flex items-center",children:[h.postureQuality>0?v.jsx(qC,{className:"h-4 w-4 mr-1"}):v.jsx(y$,{className:"h-4 w-4 mr-1"}),h.postureQuality>0?`Improved ${h.postureQuality}% since last measurement`:`Decreased ${Math.abs(h.postureQuality)}% since last measurement`]})]})]})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Pain Level"})}),v.jsxs(Lt,{children:[v.jsx("div",{className:"h-[250px]",children:v.jsx(ux,{data:r==null?void 0:r.map(p=>({date:new Date(p.date),value:p.painLevel||0})),timeRange:t,dataKey:"painLevel",color:"#F44336"})}),v.jsxs("div",{className:"mt-4",children:[v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("span",{className:"text-sm text-neutral-600",children:"Current Pain Level"}),v.jsxs("div",{className:"font-medium text-lg flex items-center",children:[u.painLevel,"/10",h.painLevel!==0&&v.jsxs(qr,{variant:"outline",className:h.painLevel>0?"bg-green-100 text-green-800 border-none ml-2":"bg-red-100 text-red-800 border-none ml-2",children:[h.painLevel>0?v.jsx(y$,{className:"h-3 w-3 mr-1"}):v.jsx(qC,{className:"h-3 w-3 mr-1"}),f(h.painLevel,!0)]})]})]}),v.jsxs("div",{className:"text-right",children:[v.jsx("span",{className:"text-sm text-neutral-600",children:"Target"}),v.jsx("div",{className:"font-medium text-lg",children:"0/10"})]})]}),v.jsx("div",{className:"mt-2",children:v.jsx(dx,{value:(10-u.painLevel)/10*100,color:"green"})}),v.jsx("p",{className:"text-sm text-neutral-600 mt-2",children:u.painLevel<=3?"Mild pain, manageable during activities":u.painLevel<=6?"Moderate pain, may limit some activities":"Severe pain, significantly limits activities"})]})]})]})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Session Completion"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[v.jsxs("div",{className:"relative h-32 w-32",children:[v.jsxs("svg",{viewBox:"0 0 36 36",className:"w-full h-full",children:[v.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:"#e0e0e0",strokeWidth:"3"}),v.jsx("path",{d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831",fill:"none",stroke:l.rate>=80?"#4CAF50":l.rate>=60?"#FFC107":"#F44336",strokeWidth:"3",strokeDasharray:`${l.rate}, 100`})]}),v.jsxs("div",{className:"absolute inset-0 flex items-center justify-center flex-col",children:[v.jsxs("span",{className:"text-3xl font-bold",children:[Math.round(l.rate),"%"]}),v.jsx("span",{className:"text-sm text-neutral-600",children:"completed"})]})]}),v.jsxs("div",{className:"mt-4 text-center",children:[v.jsxs("p",{className:"font-medium text-neutral-800",children:[l.completed,"/",l.total," sessions completed"]}),v.jsxs("p",{className:"text-sm text-neutral-600",children:[l.missed," sessions missed"]})]})]})})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Recovery Estimate"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("p",{className:"text-sm text-neutral-600",children:"AI Prediction"}),v.jsx("p",{className:"text-2xl font-bold text-primary mt-1",children:"Full Recovery: Jul 18"}),v.jsx("div",{className:"inline-block bg-primary-light bg-opacity-10 text-primary rounded-full px-3 py-1 text-sm font-medium mt-2",children:"2 weeks early"})]}),v.jsxs("div",{className:"w-full mt-6",children:[v.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[v.jsx("span",{className:"text-neutral-600",children:"Overall Progress"}),v.jsx("span",{className:"text-neutral-800 font-medium",children:"76%"})]}),v.jsx(dx,{value:76,color:"green"})]})]})})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Consistency Score"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"flex flex-col items-center justify-center py-4",children:[v.jsxs("div",{className:"text-center",children:[v.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-500 mx-auto flex items-center justify-center text-white font-bold text-2xl",children:"A"}),v.jsx("p",{className:"text-2xl font-bold mt-3",children:"85 points"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Weekly Score"})]}),v.jsx("div",{className:"w-full mt-6",children:v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsxs("span",{className:"text-green-600 font-medium flex items-center",children:[v.jsx(qC,{className:"h-4 w-4 mr-1"}),"+12 from last week"]}),v.jsx("span",{className:"text-neutral-600",children:"Top 10%"})]})})]})})]})]}),v.jsxs("div",{className:"mb-8",children:[v.jsx("h2",{className:"text-xl font-heading font-semibold text-neutral-800 mb-4",children:"Progress History"}),v.jsx(Dt,{children:v.jsx(Lt,{className:"p-0",children:v.jsx("div",{className:"overflow-x-auto",children:v.jsxs("table",{className:"w-full text-sm",children:[v.jsx("thead",{children:v.jsxs("tr",{className:"border-b",children:[v.jsx("th",{className:"text-left whitespace-nowrap px-4 py-3 font-medium text-neutral-600",children:"Date"}),v.jsx("th",{className:"text-left whitespace-nowrap px-4 py-3 font-medium text-neutral-600",children:"Range of Motion"}),v.jsx("th",{className:"text-left whitespace-nowrap px-4 py-3 font-medium text-neutral-600",children:"Posture Quality"}),v.jsx("th",{className:"text-left whitespace-nowrap px-4 py-3 font-medium text-neutral-600",children:"Pain Level"}),v.jsx("th",{className:"text-left whitespace-nowrap px-4 py-3 font-medium text-neutral-600",children:"Notes"}),v.jsx("th",{className:"text-right whitespace-nowrap px-4 py-3 font-medium text-neutral-600"})]})}),v.jsx("tbody",{children:i?v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"text-center py-4",children:"Loading progress history..."})}):r&&r.length>0?r.map(p=>{const g=new Date(p.date);return v.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[v.jsx("td",{className:"whitespace-nowrap px-4 py-3 font-medium",children:g.toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),v.jsx("td",{className:"whitespace-nowrap px-4 py-3",children:p.rangeOfMotion?`${p.rangeOfMotion}°`:"--"}),v.jsx("td",{className:"whitespace-nowrap px-4 py-3",children:p.postureQuality?`${p.postureQuality}%`:"--"}),v.jsx("td",{className:"whitespace-nowrap px-4 py-3",children:p.painLevel!==void 0&&p.painLevel!==null?`${p.painLevel}/10`:"--"}),v.jsx("td",{className:"px-4 py-3 max-w-[300px] truncate",children:p.notes||"No notes"}),v.jsx("td",{className:"whitespace-nowrap px-4 py-3 text-right",children:v.jsx(et,{variant:"ghost",size:"sm",children:v.jsx(Kie,{className:"h-4 w-4"})})})]},p.id)}):v.jsx("tr",{children:v.jsx("td",{colSpan:6,className:"text-center py-4",children:"No progress records found."})})})]})})})})]})]})},sge=P.forwardRef(({className:t,...e},n)=>v.jsx("textarea",{className:Pt("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:n,...e}));sge.displayName="Textarea";const Nwt=()=>{var u;const[t,e]=P.useState(""),n=1,{data:r,isLoading:i}=Kr({queryKey:[`/api/therapist-notes/${n}`]}),{data:s,isLoading:a}=Kr({queryKey:["/api/users/2"]}),o=d=>d?new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"",l=d=>!d||d.length===0?null:d.map((h,f)=>{let p=v.jsx(br,{className:"h-4 w-4 mr-1"}),g="bg-blue-100 text-primary";return h.includes("progress")?(p=v.jsx(br,{className:"h-4 w-4 mr-1"}),g="bg-blue-100 text-primary"):h.includes("new exercise")?(p=v.jsx(br,{className:"h-4 w-4 mr-1"}),g="bg-green-100 text-green-700"):(h.includes("posture")||h.includes("correction"))&&(p=v.jsx(z0,{className:"h-4 w-4 mr-1"}),g="bg-yellow-100 text-yellow-800"),v.jsxs(qr,{variant:"outline",className:`mr-2 mb-2 ${g} flex items-center`,children:[p,h]},f)}),c=()=>{t.trim()&&(console.log("Sending message to therapist:",t),e(""))};return v.jsxs(nd,{title:"Therapist Notes",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Therapist Communication"}),v.jsx("p",{className:"text-neutral-600",children:"Review notes from your therapist and communicate directly"})]}),v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[v.jsxs("div",{className:"lg:col-span-1",children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Your Therapist"})}),v.jsx(Lt,{children:a?v.jsxs("div",{className:"flex flex-col items-center py-4 animate-pulse",children:[v.jsx("div",{className:"h-20 w-20 rounded-full bg-gray-200 mb-4"}),v.jsx("div",{className:"h-4 w-32 bg-gray-200 rounded mb-2"}),v.jsx("div",{className:"h-3 w-24 bg-gray-200 rounded"})]}):v.jsxs("div",{className:"flex flex-col items-center py-4",children:[v.jsx(XH,{className:"h-20 w-20 mb-4",children:v.jsx(KH,{className:"bg-teal-100 text-teal-600 text-xl",children:((u=s==null?void 0:s.fullName)==null?void 0:u.split(" ").map(d=>d[0]).join(""))||"DR"})}),v.jsx("h3",{className:"font-medium text-lg",children:(s==null?void 0:s.fullName)||"Dr. Rachel Stevens"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"Physical Therapist"}),v.jsxs("div",{className:"w-full mt-6 space-y-3",children:[v.jsxs(et,{className:"w-full",children:[v.jsx(Zie,{className:"mr-2 h-4 w-4"}),"Send Message"]}),v.jsxs(v1,{children:[v.jsx(H2,{asChild:!0,children:v.jsxs(et,{variant:"outline",className:"w-full",children:[v.jsx(Dq,{className:"mr-2 h-4 w-4"}),"Schedule Video Call"]})}),v.jsxs(fx,{children:[v.jsxs(px,{children:[v.jsx(mx,{children:"Schedule Video Consultation"}),v.jsx(gx,{children:"Choose a date and time for your video consultation with Dr. Rachel Stevens."})]}),v.jsxs("div",{className:"py-4",children:[v.jsxs("div",{className:"mb-4",children:[v.jsx("h3",{className:"font-medium mb-2",children:"Available Slots"}),v.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[v.jsxs(et,{variant:"outline",className:"justify-start",children:[v.jsx(My,{className:"mr-2 h-4 w-4"}),"Today, 3:00 PM"]}),v.jsxs(et,{variant:"outline",className:"justify-start",children:[v.jsx(My,{className:"mr-2 h-4 w-4"}),"Today, 4:30 PM"]}),v.jsxs(et,{variant:"outline",className:"justify-start",children:[v.jsx(My,{className:"mr-2 h-4 w-4"}),"Tomorrow, 2:00 PM"]}),v.jsxs(et,{variant:"outline",className:"justify-start",children:[v.jsx(My,{className:"mr-2 h-4 w-4"}),"Tomorrow, 3:30 PM"]})]})]}),v.jsx(et,{className:"w-full",children:"Schedule Consultation"})]})]})]})]})]})})]}),v.jsxs(Dt,{className:"mt-4",children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Upcoming Appointments"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"p-3 border rounded-lg bg-primary/5 border-primary",children:[v.jsxs("div",{className:"flex items-center mb-2",children:[v.jsx(My,{className:"h-4 w-4 mr-2 text-primary"}),v.jsx("p",{className:"font-medium",children:"Today, 3:00 PM"})]}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Regular Therapy Session"})]}),v.jsxs("div",{className:"p-3 border rounded-lg",children:[v.jsxs("div",{className:"flex items-center mb-2",children:[v.jsx(My,{className:"h-4 w-4 mr-2 text-neutral-600"}),v.jsx("p",{className:"font-medium",children:"May 25, 3:00 PM"})]}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Regular Therapy Session"})]}),v.jsxs("div",{className:"p-3 border rounded-lg",children:[v.jsxs("div",{className:"flex items-center mb-2",children:[v.jsx(Dq,{className:"h-4 w-4 mr-2 text-neutral-600"}),v.jsx("p",{className:"font-medium",children:"May 27, 2:30 PM"})]}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Video Consultation"})]})]})})]})]}),v.jsx("div",{className:"lg:col-span-3",children:v.jsxs(oy,{defaultValue:"notes",children:[v.jsxs(Np,{className:"mb-4",children:[v.jsx(oi,{value:"notes",children:"Therapist Notes"}),v.jsx(oi,{value:"messages",children:"Messages"})]}),v.jsx(li,{value:"notes",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Recent Notes & Recommendations"}),v.jsx(Nr,{children:"Notes and feedback from your therapist about your rehabilitation progress"})]}),v.jsx(Lt,{children:i?v.jsx("div",{className:"space-y-6 animate-pulse",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-gray-200 mr-4"}),v.jsxs("div",{className:"flex-1",children:[v.jsx("div",{className:"h-5 bg-gray-200 rounded w-1/3 mb-2"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-4"}),v.jsxs("div",{className:"space-y-2",children:[v.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-full"}),v.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"})]})]})]})}):r&&r.length>0?v.jsx("div",{className:"space-y-8",children:r.map(d=>v.jsx("div",{className:"pb-6 border-b last:border-b-0 last:pb-0",children:v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-medium text-lg mr-4",children:"DR"}),v.jsxs("div",{children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("h3",{className:"font-medium text-neutral-800",children:"Dr. Rachel Stevens"}),v.jsx("span",{className:"text-neutral-500 text-sm ml-2",children:o(d.date)})]}),v.jsx("div",{className:"mt-2 text-neutral-700 whitespace-pre-line",children:d.notes.split(`
`).map((h,f)=>v.jsx("p",{className:f>0?"mt-2":"",children:h},f))}),v.jsx("div",{className:"mt-4 flex flex-wrap",children:l(d.flags)})]})]})},d.id))}):v.jsx("div",{className:"text-center py-6",children:v.jsx("p",{className:"text-neutral-600",children:"No therapist notes available."})})})]})}),v.jsx(li,{value:"messages",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Messages"}),v.jsx(Nr,{children:"Send and receive messages from your therapist"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"flex flex-col h-[500px]",children:[v.jsx("div",{className:"flex-1 overflow-y-auto mb-4 p-4 border rounded-lg",children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-medium text-sm mr-2 flex-shrink-0",children:"DR"}),v.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 max-w-[80%]",children:[v.jsx("p",{className:"text-sm",children:"Hi John, how is your shoulder feeling after yesterday's session?"}),v.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"10:30 AM"})]})]}),v.jsxs("div",{className:"flex items-start justify-end",children:[v.jsxs("div",{className:"bg-primary text-white rounded-lg p-3 max-w-[80%]",children:[v.jsx("p",{className:"text-sm",children:"Hi Dr. Rachel, it's feeling better today. Still a bit sore but the pain is less intense."}),v.jsx("p",{className:"text-xs text-primary-foreground mt-1",children:"10:45 AM"})]}),v.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-medium text-sm ml-2 flex-shrink-0",children:"JD"})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-medium text-sm mr-2 flex-shrink-0",children:"DR"}),v.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 max-w-[80%]",children:[v.jsx("p",{className:"text-sm",children:"That's good to hear! Make sure to apply ice if the soreness continues. Did you complete the pendulum exercises this morning?"}),v.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"11:02 AM"})]})]}),v.jsxs("div",{className:"flex items-start justify-end",children:[v.jsxs("div",{className:"bg-primary text-white rounded-lg p-3 max-w-[80%]",children:[v.jsx("p",{className:"text-sm",children:"Yes, I did them as soon as I woke up. I also tried the new scapular retraction exercise you recommended, but I'm not sure if I'm doing it correctly."}),v.jsx("p",{className:"text-xs text-primary-foreground mt-1",children:"11:10 AM"})]}),v.jsx("div",{className:"h-8 w-8 rounded-full bg-primary flex items-center justify-center text-white font-medium text-sm ml-2 flex-shrink-0",children:"JD"})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"h-8 w-8 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-medium text-sm mr-2 flex-shrink-0",children:"DR"}),v.jsxs("div",{className:"bg-gray-100 rounded-lg p-3 max-w-[80%]",children:[v.jsx("p",{className:"text-sm",children:"I can show you the proper technique during our session today. Remember to focus on squeezing your shoulder blades together, not just pulling your shoulders back."}),v.jsx("p",{className:"text-xs text-neutral-500 mt-1",children:"11:15 AM"})]})]})]})}),v.jsxs("div",{className:"flex items-center",children:[v.jsx(sge,{placeholder:"Type your message here...",className:"flex-1 min-h-[80px] resize-none",value:t,onChange:d=>e(d.target.value)}),v.jsx(et,{className:"ml-2 h-10",onClick:c,children:"Send"})]})]})})]})})]})})]})]})},Awt=()=>{const[t,e]=P.useState(!1),n=1,{data:r,isLoading:i}=Kr({queryKey:[`/api/payments/${n}`]}),s=o=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(o/100),a=o=>new Date(o).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"});return v.jsxs(nd,{title:"Billing & Payments",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Billing & Payments"}),v.jsx("p",{className:"text-neutral-600",children:"Manage your subscription plan, payment methods, and billing history"})]}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[v.jsx("div",{className:"md:col-span-2",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Current Plan"}),v.jsx(Nr,{children:"Your current subscription plan and billing information"})]}),v.jsxs(Lt,{children:[v.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between p-4 border rounded-lg bg-blue-50",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg text-neutral-800",children:"Premium Rehabilitation Plan"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"Includes unlimited sessions, therapist consultations, and premium features"}),v.jsx(qr,{variant:"default",className:"mt-2",children:"Active"})]}),v.jsxs("div",{className:"mt-4 md:mt-0 text-right",children:[v.jsx("span",{className:"text-2xl font-bold",children:"$49.99"}),v.jsx("span",{className:"text-neutral-600",children:"/month"}),v.jsx("p",{className:"text-sm text-neutral-500 mt-1",children:"Next billing: June 1, 2023"})]})]}),v.jsxs("div",{className:"flex flex-wrap gap-4 mt-6",children:[v.jsx(et,{variant:"outline",children:"Change Plan"}),v.jsx(et,{variant:"outline",className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:"Cancel Subscription"})]})]})]})}),v.jsx("div",{children:v.jsxs(Dt,{children:[v.jsx(en,{children:v.jsx(tn,{children:"Summary"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Current Plan"}),v.jsx("span",{className:"font-medium",children:"Premium"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Billing Cycle"}),v.jsx("span",{className:"font-medium",children:"Monthly"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Next Payment"}),v.jsx("span",{className:"font-medium",children:"$49.99"})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx("span",{className:"text-neutral-600",children:"Payment Method"}),v.jsx("span",{className:"font-medium",children:"Visa •••• 4242"})]})]})})]})})]}),v.jsxs(Dt,{className:"mb-6",children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Payment Methods"}),v.jsx(Nr,{children:"Manage your payment methods and default payment option"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"p-4 border rounded-lg flex items-center",children:[v.jsx("div",{className:"h-12 w-12 bg-blue-100 rounded-md flex items-center justify-center mr-4",children:v.jsx(Yie,{className:"h-6 w-6 text-primary"})}),v.jsxs("div",{className:"flex-1",children:[v.jsx("p",{className:"font-medium text-neutral-800",children:"Visa ending in 4242"}),v.jsx("p",{className:"text-sm text-neutral-500",children:"Expires 05/2024"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx(qr,{variant:"outline",className:"bg-green-100 text-green-800 border-none mr-4",children:"Default"}),v.jsx(et,{variant:"ghost",size:"sm",children:"Edit"})]})]}),v.jsxs(et,{variant:"outline",className:"w-full",onClick:()=>e(!0),children:[v.jsx(Qie,{className:"h-5 w-5 mr-2"}),"Add Payment Method"]})]})})]}),v.jsxs(Dt,{children:[v.jsx(en,{children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx(tn,{children:"Billing History"}),v.jsx(Nr,{children:"View your past invoices and payment history"})]}),v.jsxs(et,{variant:"outline",size:"sm",children:[v.jsx(Pq,{className:"h-4 w-4 mr-2"}),"Export"]})]})}),v.jsx(Lt,{className:"p-0",children:v.jsx("div",{className:"overflow-x-auto",children:v.jsxs(VH,{children:[v.jsx(WH,{children:v.jsxs(Fd,{children:[v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Date"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Description"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Amount"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Status"}),v.jsx(Cc,{className:"text-xs font-medium text-neutral-500 uppercase tracking-wider",children:"Receipt"})]})}),v.jsx(HH,{children:i?v.jsx(Fd,{children:v.jsx(Da,{colSpan:5,className:"text-center py-4",children:"Loading payment history..."})}):r&&r.length>0?r.map(o=>v.jsxs(Fd,{children:[v.jsx(Da,{className:"text-sm text-neutral-600",children:a(o.date)}),v.jsx(Da,{className:"text-sm text-neutral-600",children:o.description}),v.jsx(Da,{className:"text-sm font-medium text-neutral-800",children:s(o.amount)}),v.jsx(Da,{children:o.status==="processed"?v.jsxs(qr,{variant:"outline",className:"bg-green-100 text-green-800 border-none flex items-center w-fit",children:[v.jsx(br,{className:"h-3 w-3 mr-1"}),"Paid"]}):o.status==="pending"?v.jsxs(qr,{variant:"outline",className:"bg-yellow-100 text-yellow-800 border-none flex items-center w-fit",children:[v.jsx(EU,{className:"h-3 w-3 mr-1"}),"Pending"]}):v.jsxs(qr,{variant:"outline",className:"bg-red-100 text-red-800 border-none flex items-center w-fit",children:[v.jsx(z0,{className:"h-3 w-3 mr-1"}),"Failed"]})}),v.jsx(Da,{className:"text-sm text-primary",children:o.receiptUrl?v.jsxs("a",{href:o.receiptUrl,className:"flex items-center hover:underline",target:"_blank",rel:"noopener noreferrer",children:[v.jsx(Pq,{className:"h-4 w-4 mr-1"}),"Download"]}):v.jsx("span",{className:"text-neutral-400",children:"N/A"})})]},o.id)):v.jsx(Fd,{children:v.jsx(Da,{colSpan:5,className:"text-center py-4",children:"No payment records found."})})})]})})})]}),v.jsx(v1,{open:t,onOpenChange:e,children:v.jsxs(fx,{className:"sm:max-w-[425px]",children:[v.jsxs(px,{children:[v.jsx(mx,{children:"Add Payment Method"}),v.jsx(gx,{children:"Enter your card information to add a new payment method."})]}),v.jsxs("div",{className:"space-y-4 py-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Nc,{htmlFor:"cardNumber",children:"Card Number"}),v.jsx(Il,{id:"cardNumber",placeholder:"1234 5678 9012 3456"})]}),v.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[v.jsxs("div",{className:"space-y-2",children:[v.jsx(Nc,{htmlFor:"expiryDate",children:"Expiry Date"}),v.jsx(Il,{id:"expiryDate",placeholder:"MM/YY"})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Nc,{htmlFor:"cvc",children:"CVC"}),v.jsx(Il,{id:"cvc",placeholder:"123"})]})]}),v.jsxs("div",{className:"space-y-2",children:[v.jsx(Nc,{htmlFor:"nameOnCard",children:"Name on Card"}),v.jsx(Il,{id:"nameOnCard",placeholder:"John Doe"})]}),v.jsx("div",{className:"space-y-2",children:v.jsxs(Nc,{children:[v.jsx("input",{type:"checkbox",className:"mr-2"}),"Set as default payment method"]})})]}),v.jsxs("div",{className:"flex justify-end space-x-2",children:[v.jsx(et,{variant:"outline",onClick:()=>e(!1),children:"Cancel"}),v.jsx(et,{onClick:()=>e(!1),children:"Add Card"})]})]})})]})};var sG="Progress",aG=100,[Iwt,Q3t]=Yl(sG),[kwt,Mwt]=Iwt(sG),age=P.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:i,getValueLabel:s=Rwt,...a}=t;(i||i===0)&&!tJ(i)&&console.error(Pwt(`${i}`,"Progress"));const o=tJ(i)?i:aG;r!==null&&!nJ(r,o)&&console.error(Owt(`${r}`,"Progress"));const l=nJ(r,o)?r:null,c=dk(l)?s(l,o):void 0;return v.jsx(kwt,{scope:n,value:l,max:o,children:v.jsx(Wt.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":dk(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":cge(l,o),"data-value":l??void 0,"data-max":o,...a,ref:e})})});age.displayName=sG;var oge="ProgressIndicator",lge=P.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,i=Mwt(oge,n);return v.jsx(Wt.div,{"data-state":cge(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...r,ref:e})});lge.displayName=oge;function Rwt(t,e){return`${Math.round(t/e*100)}%`}function cge(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function dk(t){return typeof t=="number"}function tJ(t){return dk(t)&&!isNaN(t)&&t>0}function nJ(t,e){return dk(t)&&!isNaN(t)&&t<=e&&t>=0}function Pwt(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${aG}\`.`}function Owt(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${aG} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var uge=age,Dwt=lge;const o4=P.forwardRef(({className:t,value:e,...n},r)=>v.jsx(uge,{ref:r,className:Pt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:v.jsx(Dwt,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));o4.displayName=uge.displayName;var $wt="Separator",rJ="horizontal",Lwt=["horizontal","vertical"],dge=P.forwardRef((t,e)=>{const{decorative:n,orientation:r=rJ,...i}=t,s=Fwt(r)?r:rJ,o=n?{role:"none"}:{"aria-orientation":s==="vertical"?s:void 0,role:"separator"};return v.jsx(Wt.div,{"data-orientation":s,...o,...i,ref:e})});dge.displayName=$wt;function Fwt(t){return Lwt.includes(t)}var hge=dge;const G2=P.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},i)=>v.jsx(hge,{ref:i,decorative:n,orientation:e,className:Pt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));G2.displayName=hge.displayName;const jwt=()=>{yU();const t=new URLSearchParams(window.location.search),e=t.get("assessment")==="true",n=t.get("programs")==="true",[r,i]=P.useState(e?"assessment":n?"programs":"overview"),[s,a]=P.useState(!1),[o,l]=P.useState(1),c=10,u=()=>{a(!0)};return v.jsxs(nd,{title:"GutrehaB",children:[v.jsx("div",{className:"bg-gradient-to-r from-teal-500 to-green-500 rounded-xl shadow-md overflow-hidden mb-8",children:v.jsxs("div",{className:"p-8 text-white",children:[v.jsx("h1",{className:"text-3xl font-bold mb-2",children:"GutrehaB"}),v.jsx("p",{className:"text-xl mb-4",children:"Our one-in-all solution for all gut problems coupled with mental wellbeing programs"}),v.jsx("p",{className:"opacity-90",children:"Experience a deep-rooted holistic approach to gut health and mental wellness, backed by science and designed for sustainable healing."})]})}),v.jsxs(oy,{defaultValue:r,onValueChange:i,children:[v.jsxs(Np,{className:"mb-4",children:[v.jsx(oi,{value:"overview",children:"Overview"}),v.jsx(oi,{value:"assessment",children:"Gut Health Assessment"}),v.jsx(oi,{value:"programs",children:"Mental Wellbeing"}),v.jsx(oi,{value:"plans",children:"Plans & Pricing"})]}),v.jsxs(li,{value:"overview",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[v.jsxs(Dt,{children:[v.jsxs(en,{className:"pb-2",children:[v.jsx(tn,{children:"The Gut-Brain Connection"}),v.jsx(Nr,{children:"Understanding the powerful connection between gut health and mental wellbeing"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"flex flex-col items-center mb-4",children:[v.jsx("div",{className:"w-full md:w-3/4 h-64 bg-teal-100 rounded-lg overflow-hidden flex items-center justify-center mb-4",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-24 w-24 text-teal-500 opacity-75",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),v.jsx("p",{className:"text-neutral-700",children:"Research shows that the gut and brain are connected through millions of nerves, creating a two-way communication system often called the gut-brain axis. This connection explains why gut health significantly impacts mental wellbeing and vice versa."}),v.jsxs("div",{className:"flex justify-center mt-4",children:[v.jsx(et,{variant:"outline",className:"mr-2",onClick:()=>i("assessment"),children:"Take Assessment"}),v.jsx(et,{onClick:()=>i("programs"),children:"Explore Programs"})]})]})})]}),v.jsxs(Dt,{children:[v.jsxs(en,{className:"pb-2",children:[v.jsx(tn,{children:"Our Holistic Approach"}),v.jsx(Nr,{children:"Addressing both gut health and mental wellbeing for complete healing"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center mr-3 flex-shrink-0",children:v.jsx(Oq,{className:"h-5 w-5 text-teal-600"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Gut Microbiome Analysis"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Detailed assessment of your gut health to identify imbalances"})]})]}),v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center mr-3 flex-shrink-0",children:v.jsx(cCe,{className:"h-5 w-5 text-teal-600"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Personalized Nutrition"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Customized dietary plans based on your specific gut needs"})]})]}),v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center mr-3 flex-shrink-0",children:v.jsx(g$,{className:"h-5 w-5 text-teal-600"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Mental Wellbeing Programs"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Mindfulness, stress reduction, and cognitive techniques"})]})]}),v.jsxs("div",{className:"flex",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-teal-100 flex items-center justify-center mr-3 flex-shrink-0",children:v.jsx(AA,{className:"h-5 w-5 text-teal-600"})}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium",children:"Lifestyle Optimization"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Sleep, exercise, and daily routine adjustments for optimal health"})]})]})]})})]})]}),v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Benefits of GutrehaB"}),v.jsx(Nr,{children:"How our holistic approach can transform your health"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-blue-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Improved Digestion"}),v.jsx("p",{className:"text-neutral-600",children:"Reduce bloating, gas, constipation, and other digestive discomforts through targeted gut healing protocols."})]}),v.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-green-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-green-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.828 14.828a4 4 0 01-5.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Enhanced Mood"}),v.jsx("p",{className:"text-neutral-600",children:"Experience reduced anxiety, improved mood stability, and greater emotional resilience."})]}),v.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-purple-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-purple-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Increased Energy"}),v.jsx("p",{className:"text-neutral-600",children:"Boost your overall vitality by improving nutrient absorption and reducing inflammatory burden."})]}),v.jsxs("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-yellow-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-yellow-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Stronger Immunity"}),v.jsx("p",{className:"text-neutral-600",children:"70% of your immune system resides in your gut. Strengthen your defenses against illness."})]}),v.jsxs("div",{className:"bg-red-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-red-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Reduced Inflammation"}),v.jsx("p",{className:"text-neutral-600",children:"Address the root causes of inflammatory conditions through gut healing and stress reduction."})]}),v.jsxs("div",{className:"bg-indigo-50 p-4 rounded-lg",children:[v.jsx("div",{className:"h-12 w-12 rounded-full bg-indigo-100 flex items-center justify-center mb-3",children:v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-indigo-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:v.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"})})}),v.jsx("h3",{className:"font-medium text-lg mb-1",children:"Better Sleep"}),v.jsx("p",{className:"text-neutral-600",children:"Improve sleep quality and duration through balanced gut microbiome and reduced anxiety."})]})]})})]})]}),v.jsx(li,{value:"assessment",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Gut Health Assessment"}),v.jsx(Nr,{children:"Complete this comprehensive assessment to receive personalized gut health insights"})]}),v.jsx(Lt,{children:s?v.jsxs("div",{className:"text-center py-8",children:[v.jsx("div",{className:"h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:v.jsx(br,{className:"h-8 w-8 text-green-600"})}),v.jsx("h3",{className:"text-xl font-medium mb-2",children:"Assessment Completed!"}),v.jsx("p",{className:"text-neutral-600 mb-6 max-w-md mx-auto",children:"Based on your responses, we've created a personalized gut health profile with targeted recommendations."}),v.jsx("div",{className:"max-w-xl mx-auto mb-8",children:v.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg",children:[v.jsx("h4",{className:"font-medium mb-3",children:"Your Gut Health Score: 68/100"}),v.jsx(o4,{value:68,className:"h-2 mb-4"}),v.jsx("p",{className:"text-sm text-neutral-700 mb-3",children:"Your gut health is in the moderate range. We've identified several areas for improvement that could significantly enhance your digestive wellness and overall health."}),v.jsx("h5",{className:"font-medium mb-2",children:"Key Insights:"}),v.jsxs("ul",{className:"list-disc list-inside text-sm text-neutral-700 space-y-1",children:[v.jsx("li",{children:"Signs of moderate gut inflammation"}),v.jsx("li",{children:"Potential imbalance in gut microbiome"}),v.jsx("li",{children:"Digestive enzyme insufficiency possible"}),v.jsx("li",{children:"Stress appears to be impacting digestive function"})]})]})}),v.jsx(et,{children:"View Full Results & Recommendations"})]}):v.jsxs("div",{children:[v.jsxs("div",{className:"mb-4",children:[v.jsxs("div",{className:"flex justify-between items-center mb-2",children:[v.jsx("span",{className:"text-sm text-neutral-600",children:"Progress"}),v.jsxs("span",{className:"text-sm font-medium",children:[o,"/",c]})]}),v.jsx(o4,{value:o/c*100,className:"h-2"})]}),v.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-6",children:[v.jsxs("h3",{className:"font-medium text-lg mb-4",children:["Question ",o,": How frequently do you experience digestive discomfort?"]}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"radio",id:"q1-a",name:"q1",className:"mr-3 h-4 w-4 text-primary"}),v.jsx("label",{htmlFor:"q1-a",children:"Rarely or never"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"radio",id:"q1-b",name:"q1",className:"mr-3 h-4 w-4 text-primary"}),v.jsx("label",{htmlFor:"q1-b",children:"Once or twice a month"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"radio",id:"q1-c",name:"q1",className:"mr-3 h-4 w-4 text-primary"}),v.jsx("label",{htmlFor:"q1-c",children:"Once or twice a week"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"radio",id:"q1-d",name:"q1",className:"mr-3 h-4 w-4 text-primary"}),v.jsx("label",{htmlFor:"q1-d",children:"Several times a week"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"radio",id:"q1-e",name:"q1",className:"mr-3 h-4 w-4 text-primary"}),v.jsx("label",{htmlFor:"q1-e",children:"Daily"})]})]})]}),v.jsxs("div",{className:"flex justify-between",children:[v.jsx(et,{variant:"outline",disabled:o===1,onClick:()=>l(d=>Math.max(d-1,1)),children:"Previous"}),v.jsx(et,{onClick:()=>{o<c?l(d=>d+1):u()},children:o<c?"Next":"Complete Assessment"})]})]})})]})}),v.jsxs(li,{value:"programs",children:[v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Mental Wellbeing Programs"}),v.jsx(Nr,{children:"Science-backed programs to reduce stress and improve mental health"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsx("div",{className:"border rounded-lg p-4 hover:border-primary cursor-pointer transition-colors",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg",children:"8-Week Mindfulness Journey"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"A comprehensive program to develop present-moment awareness and reduce stress response"}),v.jsxs("div",{className:"flex items-center mt-2",children:[v.jsx(qr,{className:"mr-2 bg-blue-100 text-blue-800 hover:bg-blue-200",children:"Beginner Friendly"}),v.jsx(qr,{variant:"outline",children:"8 Weeks"})]})]}),v.jsx(Tm,{className:"h-5 w-5 text-neutral-400"})]})}),v.jsx("div",{className:"border rounded-lg p-4 hover:border-primary cursor-pointer transition-colors",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg",children:"Stress & Anxiety Relief"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"Targeted techniques to manage stress, reduce anxiety, and regulate nervous system"}),v.jsxs("div",{className:"flex items-center mt-2",children:[v.jsx(qr,{className:"mr-2 bg-green-100 text-green-800 hover:bg-green-200",children:"Most Popular"}),v.jsx(qr,{variant:"outline",children:"6 Weeks"})]})]}),v.jsx(Tm,{className:"h-5 w-5 text-neutral-400"})]})}),v.jsx("div",{className:"border rounded-lg p-4 hover:border-primary cursor-pointer transition-colors",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg",children:"Sleep Enhancement"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"Improve sleep quality through cognitive techniques and relaxation practices"}),v.jsx("div",{className:"flex items-center mt-2",children:v.jsx(qr,{variant:"outline",children:"4 Weeks"})})]}),v.jsx(Tm,{className:"h-5 w-5 text-neutral-400"})]})}),v.jsx("div",{className:"border rounded-lg p-4 hover:border-primary cursor-pointer transition-colors",children:v.jsxs("div",{className:"flex justify-between items-start",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg",children:"Emotional Resilience"}),v.jsx("p",{className:"text-neutral-600 mt-1",children:"Build capacity to navigate difficult emotions and develop psychological flexibility"}),v.jsxs("div",{className:"flex items-center mt-2",children:[v.jsx(qr,{className:"mr-2 bg-purple-100 text-purple-800 hover:bg-purple-200",children:"Advanced"}),v.jsx(qr,{variant:"outline",children:"10 Weeks"})]})]}),v.jsx(Tm,{className:"h-5 w-5 text-neutral-400"})]})})]})})]}),v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Featured Program: Stress & Anxiety Relief"}),v.jsx(Nr,{children:"Our most popular program for reducing stress and managing anxiety"})]}),v.jsxs(Lt,{children:[v.jsx("div",{className:"w-full h-48 bg-blue-100 rounded-lg flex items-center justify-center mb-4",children:v.jsx(g$,{className:"h-16 w-16 text-blue-500 opacity-70"})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Program Overview"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"This 6-week program combines evidence-based techniques from cognitive behavioral therapy, mindfulness practices, and nervous system regulation to help you effectively manage stress and reduce anxiety."})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"What You'll Learn"}),v.jsxs("ul",{className:"space-y-2",children:[v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{className:"text-sm",children:"Identify stress triggers and anxiety patterns"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{className:"text-sm",children:"Practice quick-relief techniques for acute anxiety"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{className:"text-sm",children:"Develop a personalized stress management routine"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{className:"text-sm",children:"Understand the gut-brain connection in anxiety"})]})]})]}),v.jsx("div",{className:"flex justify-center pt-2",children:v.jsx(et,{className:"w-full",children:"Start Free Trial"})})]})]})]})]}),v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Daily Practices"}),v.jsx(Nr,{children:"Quick exercises to incorporate into your daily routine"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[v.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center mb-3",children:v.jsx(nCe,{className:"h-5 w-5 text-blue-600"})}),v.jsx("h3",{className:"font-medium mb-1",children:"5-Minute Breath Work"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Quick breathing exercise to calm the nervous system"}),v.jsx(qr,{variant:"outline",className:"mt-2",children:"3 min"})]}),v.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-green-100 flex items-center justify-center mb-3",children:v.jsx(g$,{className:"h-5 w-5 text-green-600"})}),v.jsx("h3",{className:"font-medium mb-1",children:"Body Scan Meditation"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Release physical tension and increase body awareness"}),v.jsx(qr,{variant:"outline",className:"mt-2",children:"10 min"})]}),v.jsxs("div",{className:"border rounded-lg p-4 hover:bg-gray-50 cursor-pointer transition-colors",children:[v.jsx("div",{className:"h-10 w-10 rounded-full bg-purple-100 flex items-center justify-center mb-3",children:v.jsx(Oq,{className:"h-5 w-5 text-purple-600"})}),v.jsx("h3",{className:"font-medium mb-1",children:"Gratitude Practice"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Shift focus to positive aspects to reduce anxiety"}),v.jsx(qr,{variant:"outline",className:"mt-2",children:"5 min"})]})]})})]})]}),v.jsxs(li,{value:"plans",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Choose Your GutrehaB Plan"}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[v.jsxs(Dt,{className:"border-2 hover:border-primary",children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Basic"}),v.jsxs("div",{className:"mt-2",children:[v.jsx("span",{className:"text-3xl font-bold",children:"$29"}),v.jsx("span",{className:"text-neutral-600 ml-1",children:"/month"})]})]}),v.jsxs(Lt,{children:[v.jsxs("ul",{className:"space-y-2 mb-6",children:[v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Gut health assessment"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Basic dietary recommendations"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Access to 2 wellbeing programs"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Weekly progress tracking"})]})]}),v.jsx(et,{className:"w-full",children:"Select Plan"})]})]}),v.jsxs(Dt,{className:"border-2 border-primary relative",children:[v.jsx("div",{className:"absolute top-0 right-0 bg-primary text-white text-xs font-medium px-3 py-1 rounded-bl-lg",children:"Popular"}),v.jsxs(en,{children:[v.jsx(tn,{children:"Premium"}),v.jsxs("div",{className:"mt-2",children:[v.jsx("span",{className:"text-3xl font-bold",children:"$49"}),v.jsx("span",{className:"text-neutral-600 ml-1",children:"/month"})]})]}),v.jsxs(Lt,{children:[v.jsxs("ul",{className:"space-y-2 mb-6",children:[v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Advanced gut health analysis"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Personalized nutrition plan"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Unlimited access to all programs"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Bi-weekly progress consultation"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Priority support"})]})]}),v.jsx(et,{className:"w-full",children:"Select Plan"})]})]}),v.jsxs(Dt,{className:"border-2 hover:border-primary",children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Ultimate"}),v.jsxs("div",{className:"mt-2",children:[v.jsx("span",{className:"text-3xl font-bold",children:"$89"}),v.jsx("span",{className:"text-neutral-600 ml-1",children:"/month"})]})]}),v.jsxs(Lt,{children:[v.jsxs("ul",{className:"space-y-2 mb-6",children:[v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Comprehensive gut microbiome testing"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Custom meal plans and recipes"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"1:1 sessions with gut health specialist"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"Weekly therapy sessions"})]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx(br,{className:"h-5 w-5 text-green-500 mr-2 flex-shrink-0 mt-0.5"}),v.jsx("span",{children:"24/7 premium support"})]})]}),v.jsx(et,{className:"w-full",children:"Select Plan"})]})]})]})]}),v.jsxs(Dt,{children:[v.jsx(en,{children:v.jsx(tn,{children:"Frequently Asked Questions"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-1",children:"How is GutrehaB different from other gut health programs?"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"GutrehaB is unique in its comprehensive approach that addresses both gut health and mental wellbeing simultaneously. We recognize the powerful gut-brain connection and provide integrated solutions that target both aspects for more complete healing."})]}),v.jsx(G2,{}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-1",children:"Can I cancel my subscription anytime?"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"Yes, all subscriptions can be canceled at any time without penalty. You'll continue to have access to the services until the end of your current billing period."})]}),v.jsx(G2,{}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-1",children:"How soon can I expect to see results?"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"Many users report noticeable improvements in digestive symptoms and mood within 2-4 weeks. However, deep healing of the gut microbiome typically takes 3-6 months of consistent work. Your results may vary based on your specific conditions and adherence to the program."})]}),v.jsx(G2,{}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-1",children:"Is GutrehaB right for me if I have a diagnosed condition?"}),v.jsx("p",{className:"text-neutral-600 text-sm",children:"GutrehaB can be used as a complementary approach alongside conventional medical treatment. However, it's essential to consult with your healthcare provider before starting any new health program, especially if you have diagnosed conditions like IBS, IBD, or clinical depression/anxiety."})]})]})})]})]})]})]})};function hk(t,[e,n]){return Math.min(n,Math.max(e,t))}function fge(t){const e=P.useRef({value:t,previous:t});return P.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var zwt=[" ","Enter","ArrowUp","ArrowDown"],Bwt=[" ","Enter"],Fg="Select",[BP,UP,Uwt]=Yk(Fg),[Sb,J3t]=Yl(Fg,[Uwt,W0]),VP=W0(),[Vwt,Ap]=Sb(Fg),[Wwt,Hwt]=Sb(Fg),pge=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:i,onOpenChange:s,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:f,form:p}=t,g=VP(e),[m,y]=P.useState(null),[x,b]=P.useState(null),[_,T]=P.useState(!1),E=OP(c),[C,I]=zf({prop:r,defaultProp:i??!1,onChange:s,caller:Fg}),[A,k]=zf({prop:a,defaultProp:o,onChange:l,caller:Fg}),R=P.useRef(null),$=m?p||!!m.closest("form"):!0,[z,O]=P.useState(new Set),j=Array.from(z).map(B=>B.props.value).join(";");return v.jsx(Mse,{...g,children:v.jsxs(Vwt,{required:f,scope:e,trigger:m,onTriggerChange:y,valueNode:x,onValueNodeChange:b,valueNodeHasChildren:_,onValueNodeHasChildrenChange:T,contentId:Ud(),value:A,onValueChange:k,open:C,onOpenChange:I,dir:E,triggerPointerDownPosRef:R,disabled:h,children:[v.jsx(BP.Provider,{scope:e,children:v.jsx(Wwt,{scope:t.__scopeSelect,onNativeOptionAdd:P.useCallback(B=>{O(W=>new Set(W).add(B))},[]),onNativeOptionRemove:P.useCallback(B=>{O(W=>{const L=new Set(W);return L.delete(B),L})},[]),children:n})}),$?v.jsxs(Fge,{"aria-hidden":!0,required:f,tabIndex:-1,name:u,autoComplete:d,value:A,onChange:B=>k(B.target.value),disabled:h,form:p,children:[A===void 0?v.jsx("option",{value:""}):null,Array.from(z)]},j):null]})})};pge.displayName=Fg;var mge="SelectTrigger",gge=P.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...i}=t,s=VP(n),a=Ap(mge,n),o=a.disabled||r,l=Vn(e,a.onTriggerChange),c=UP(n),u=P.useRef("touch"),[d,h,f]=zge(g=>{const m=c().filter(b=>!b.disabled),y=m.find(b=>b.value===a.value),x=Bge(m,g,y);x!==void 0&&a.onValueChange(x.value)}),p=g=>{o||(a.onOpenChange(!0),f()),g&&(a.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)})};return v.jsx(rM,{asChild:!0,...s,children:v.jsx(Wt.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":jge(a.value)?"":void 0,...i,ref:l,onClick:kt(i.onClick,g=>{g.currentTarget.focus(),u.current!=="mouse"&&p(g)}),onPointerDown:kt(i.onPointerDown,g=>{u.current=g.pointerType;const m=g.target;m.hasPointerCapture(g.pointerId)&&m.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&g.pointerType==="mouse"&&(p(g),g.preventDefault())}),onKeyDown:kt(i.onKeyDown,g=>{const m=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(m&&g.key===" ")&&zwt.includes(g.key)&&(p(),g.preventDefault())})})})});gge.displayName=mge;var yge="SelectValue",vge=P.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,children:s,placeholder:a="",...o}=t,l=Ap(yge,n),{onValueNodeHasChildrenChange:c}=l,u=s!==void 0,d=Vn(e,l.onValueNodeChange);return Ki(()=>{c(u)},[c,u]),v.jsx(Wt.span,{...o,ref:d,style:{pointerEvents:"none"},children:jge(l.value)?v.jsx(v.Fragment,{children:a}):s})});vge.displayName=yge;var Gwt="SelectIcon",xge=P.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...i}=t;return v.jsx(Wt.span,{"aria-hidden":!0,...i,ref:e,children:r||"▼"})});xge.displayName=Gwt;var qwt="SelectPortal",bge=t=>v.jsx(L_,{asChild:!0,...t});bge.displayName=qwt;var jg="SelectContent",wge=P.forwardRef((t,e)=>{const n=Ap(jg,t.__scopeSelect),[r,i]=P.useState();if(Ki(()=>{i(new DocumentFragment)},[]),!n.open){const s=r;return s?Gg.createPortal(v.jsx(Sge,{scope:t.__scopeSelect,children:v.jsx(BP.Slot,{scope:t.__scopeSelect,children:v.jsx("div",{children:t.children})})}),s):null}return v.jsx(_ge,{...t,ref:e})});wge.displayName=jg;var hc=10,[Sge,Ip]=Sb(jg),Xwt="SelectContentImpl",Kwt=hg("SelectContent.RemoveScroll"),_ge=P.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:s,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:g,avoidCollisions:m,...y}=t,x=Ap(jg,n),[b,_]=P.useState(null),[T,E]=P.useState(null),C=Vn(e,me=>_(me)),[I,A]=P.useState(null),[k,R]=P.useState(null),$=UP(n),[z,O]=P.useState(!1),j=P.useRef(!1);P.useEffect(()=>{if(b)return zU(b)},[b]),jU();const B=P.useCallback(me=>{const[De,...ge]=$().map(G=>G.ref.current),[_e]=ge.slice(-1),Ce=document.activeElement;for(const G of me)if(G===Ce||(G==null||G.scrollIntoView({block:"nearest"}),G===De&&T&&(T.scrollTop=0),G===_e&&T&&(T.scrollTop=T.scrollHeight),G==null||G.focus(),document.activeElement!==Ce))return},[$,T]),W=P.useCallback(()=>B([I,b]),[B,I,b]);P.useEffect(()=>{z&&W()},[z,W]);const{onOpenChange:L,triggerPointerDownPosRef:V}=x;P.useEffect(()=>{if(b){let me={x:0,y:0};const De=_e=>{var Ce,G;me={x:Math.abs(Math.round(_e.pageX)-(((Ce=V.current)==null?void 0:Ce.x)??0)),y:Math.abs(Math.round(_e.pageY)-(((G=V.current)==null?void 0:G.y)??0))}},ge=_e=>{me.x<=10&&me.y<=10?_e.preventDefault():b.contains(_e.target)||L(!1),document.removeEventListener("pointermove",De),V.current=null};return V.current!==null&&(document.addEventListener("pointermove",De),document.addEventListener("pointerup",ge,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",De),document.removeEventListener("pointerup",ge,{capture:!0})}}},[b,L,V]),P.useEffect(()=>{const me=()=>L(!1);return window.addEventListener("blur",me),window.addEventListener("resize",me),()=>{window.removeEventListener("blur",me),window.removeEventListener("resize",me)}},[L]);const[H,K]=zge(me=>{const De=$().filter(Ce=>!Ce.disabled),ge=De.find(Ce=>Ce.ref.current===document.activeElement),_e=Bge(De,me,ge);_e&&setTimeout(()=>_e.ref.current.focus())}),te=P.useCallback((me,De,ge)=>{const _e=!j.current&&!ge;(x.value!==void 0&&x.value===De||_e)&&(A(me),_e&&(j.current=!0))},[x.value]),J=P.useCallback(()=>b==null?void 0:b.focus(),[b]),oe=P.useCallback((me,De,ge)=>{const _e=!j.current&&!ge;(x.value!==void 0&&x.value===De||_e)&&R(me)},[x.value]),fe=r==="popper"?l4:Tge,Ee=fe===l4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:f,sticky:p,hideWhenDetached:g,avoidCollisions:m}:{};return v.jsx(Sge,{scope:n,content:b,viewport:T,onViewportChange:E,itemRefCallback:te,selectedItem:I,onItemLeave:J,itemTextRefCallback:oe,focusSelectedItem:W,selectedItemText:k,position:r,isPositioned:z,searchRef:H,children:v.jsx(lM,{as:Kwt,allowPinchZoom:!0,children:v.jsx(aM,{asChild:!0,trapped:x.open,onMountAutoFocus:me=>{me.preventDefault()},onUnmountAutoFocus:kt(i,me=>{var De;(De=x.trigger)==null||De.focus({preventScroll:!0}),me.preventDefault()}),children:v.jsx(j0,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:me=>me.preventDefault(),onDismiss:()=>x.onOpenChange(!1),children:v.jsx(fe,{role:"listbox",id:x.contentId,"data-state":x.open?"open":"closed",dir:x.dir,onContextMenu:me=>me.preventDefault(),...y,...Ee,onPlaced:()=>O(!0),ref:C,style:{display:"flex",flexDirection:"column",outline:"none",...y.style},onKeyDown:kt(y.onKeyDown,me=>{const De=me.ctrlKey||me.altKey||me.metaKey;if(me.key==="Tab"&&me.preventDefault(),!De&&me.key.length===1&&K(me.key),["ArrowUp","ArrowDown","Home","End"].includes(me.key)){let _e=$().filter(Ce=>!Ce.disabled).map(Ce=>Ce.ref.current);if(["ArrowUp","End"].includes(me.key)&&(_e=_e.slice().reverse()),["ArrowUp","ArrowDown"].includes(me.key)){const Ce=me.target,G=_e.indexOf(Ce);_e=_e.slice(G+1)}setTimeout(()=>B(_e)),me.preventDefault()}})})})})})})});_ge.displayName=Xwt;var Ywt="SelectItemAlignedPosition",Tge=P.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...i}=t,s=Ap(jg,n),a=Ip(jg,n),[o,l]=P.useState(null),[c,u]=P.useState(null),d=Vn(e,C=>u(C)),h=UP(n),f=P.useRef(!1),p=P.useRef(!0),{viewport:g,selectedItem:m,selectedItemText:y,focusSelectedItem:x}=a,b=P.useCallback(()=>{if(s.trigger&&s.valueNode&&o&&c&&g&&m&&y){const C=s.trigger.getBoundingClientRect(),I=c.getBoundingClientRect(),A=s.valueNode.getBoundingClientRect(),k=y.getBoundingClientRect();if(s.dir!=="rtl"){const Ce=k.left-I.left,G=A.left-Ce,ke=C.left-G,xe=C.width+ke,Pe=Math.max(xe,I.width),Te=window.innerWidth-hc,Ye=hk(G,[hc,Math.max(hc,Te-Pe)]);o.style.minWidth=xe+"px",o.style.left=Ye+"px"}else{const Ce=I.right-k.right,G=window.innerWidth-A.right-Ce,ke=window.innerWidth-C.right-G,xe=C.width+ke,Pe=Math.max(xe,I.width),Te=window.innerWidth-hc,Ye=hk(G,[hc,Math.max(hc,Te-Pe)]);o.style.minWidth=xe+"px",o.style.right=Ye+"px"}const R=h(),$=window.innerHeight-hc*2,z=g.scrollHeight,O=window.getComputedStyle(c),j=parseInt(O.borderTopWidth,10),B=parseInt(O.paddingTop,10),W=parseInt(O.borderBottomWidth,10),L=parseInt(O.paddingBottom,10),V=j+B+z+L+W,H=Math.min(m.offsetHeight*5,V),K=window.getComputedStyle(g),te=parseInt(K.paddingTop,10),J=parseInt(K.paddingBottom,10),oe=C.top+C.height/2-hc,fe=$-oe,Ee=m.offsetHeight/2,me=m.offsetTop+Ee,De=j+B+me,ge=V-De;if(De<=oe){const Ce=R.length>0&&m===R[R.length-1].ref.current;o.style.bottom="0px";const G=c.clientHeight-g.offsetTop-g.offsetHeight,ke=Math.max(fe,Ee+(Ce?J:0)+G+W),xe=De+ke;o.style.height=xe+"px"}else{const Ce=R.length>0&&m===R[0].ref.current;o.style.top="0px";const ke=Math.max(oe,j+g.offsetTop+(Ce?te:0)+Ee)+ge;o.style.height=ke+"px",g.scrollTop=De-oe+g.offsetTop}o.style.margin=`${hc}px 0`,o.style.minHeight=H+"px",o.style.maxHeight=$+"px",r==null||r(),requestAnimationFrame(()=>f.current=!0)}},[h,s.trigger,s.valueNode,o,c,g,m,y,s.dir,r]);Ki(()=>b(),[b]);const[_,T]=P.useState();Ki(()=>{c&&T(window.getComputedStyle(c).zIndex)},[c]);const E=P.useCallback(C=>{C&&p.current===!0&&(b(),x==null||x(),p.current=!1)},[b,x]);return v.jsx(Qwt,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:f,onScrollButtonChange:E,children:v.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:v.jsx(Wt.div,{...i,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});Tge.displayName=Ywt;var Zwt="SelectPopperPosition",l4=P.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:i=hc,...s}=t,a=VP(n);return v.jsx($U,{...a,...s,ref:e,align:r,collisionPadding:i,style:{boxSizing:"border-box",...s.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});l4.displayName=Zwt;var[Qwt,oG]=Sb(jg,{}),c4="SelectViewport",Ege=P.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...i}=t,s=Ip(c4,n),a=oG(c4,n),o=Vn(e,s.onViewportChange),l=P.useRef(0);return v.jsxs(v.Fragment,{children:[v.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),v.jsx(BP.Slot,{scope:n,children:v.jsx(Wt.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:kt(i.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const p=window.innerHeight-hc*2,g=parseFloat(d.style.minHeight),m=parseFloat(d.style.height),y=Math.max(g,m);if(y<p){const x=y+f,b=Math.min(p,x),_=x-b;d.style.height=b+"px",d.style.bottom==="0px"&&(u.scrollTop=_>0?_:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});Ege.displayName=c4;var Cge="SelectGroup",[Jwt,e1t]=Sb(Cge),t1t=P.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=Ud();return v.jsx(Jwt,{scope:n,id:i,children:v.jsx(Wt.div,{role:"group","aria-labelledby":i,...r,ref:e})})});t1t.displayName=Cge;var Nge="SelectLabel",Age=P.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=e1t(Nge,n);return v.jsx(Wt.div,{id:i.id,...r,ref:e})});Age.displayName=Nge;var fk="SelectItem",[n1t,Ige]=Sb(fk),kge=P.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:i=!1,textValue:s,...a}=t,o=Ap(fk,n),l=Ip(fk,n),c=o.value===r,[u,d]=P.useState(s??""),[h,f]=P.useState(!1),p=Vn(e,x=>{var b;return(b=l.itemRefCallback)==null?void 0:b.call(l,x,r,i)}),g=Ud(),m=P.useRef("touch"),y=()=>{i||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return v.jsx(n1t,{scope:n,value:r,disabled:i,textId:g,isSelected:c,onItemTextChange:P.useCallback(x=>{d(b=>b||((x==null?void 0:x.textContent)??"").trim())},[]),children:v.jsx(BP.ItemSlot,{scope:n,value:r,disabled:i,textValue:u,children:v.jsx(Wt.div,{role:"option","aria-labelledby":g,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...a,ref:p,onFocus:kt(a.onFocus,()=>f(!0)),onBlur:kt(a.onBlur,()=>f(!1)),onClick:kt(a.onClick,()=>{m.current!=="mouse"&&y()}),onPointerUp:kt(a.onPointerUp,()=>{m.current==="mouse"&&y()}),onPointerDown:kt(a.onPointerDown,x=>{m.current=x.pointerType}),onPointerMove:kt(a.onPointerMove,x=>{var b;m.current=x.pointerType,i?(b=l.onItemLeave)==null||b.call(l):m.current==="mouse"&&x.currentTarget.focus({preventScroll:!0})}),onPointerLeave:kt(a.onPointerLeave,x=>{var b;x.currentTarget===document.activeElement&&((b=l.onItemLeave)==null||b.call(l))}),onKeyDown:kt(a.onKeyDown,x=>{var _;((_=l.searchRef)==null?void 0:_.current)!==""&&x.key===" "||(Bwt.includes(x.key)&&y(),x.key===" "&&x.preventDefault())})})})})});kge.displayName=fk;var Kw="SelectItemText",Mge=P.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:i,...s}=t,a=Ap(Kw,n),o=Ip(Kw,n),l=Ige(Kw,n),c=Hwt(Kw,n),[u,d]=P.useState(null),h=Vn(e,y=>d(y),l.onItemTextChange,y=>{var x;return(x=o.itemTextRefCallback)==null?void 0:x.call(o,y,l.value,l.disabled)}),f=u==null?void 0:u.textContent,p=P.useMemo(()=>v.jsx("option",{value:l.value,disabled:l.disabled,children:f},l.value),[l.disabled,l.value,f]),{onNativeOptionAdd:g,onNativeOptionRemove:m}=c;return Ki(()=>(g(p),()=>m(p)),[g,m,p]),v.jsxs(v.Fragment,{children:[v.jsx(Wt.span,{id:l.textId,...s,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?Gg.createPortal(s.children,a.valueNode):null]})});Mge.displayName=Kw;var Rge="SelectItemIndicator",Pge=P.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return Ige(Rge,n).isSelected?v.jsx(Wt.span,{"aria-hidden":!0,...r,ref:e}):null});Pge.displayName=Rge;var u4="SelectScrollUpButton",Oge=P.forwardRef((t,e)=>{const n=Ip(u4,t.__scopeSelect),r=oG(u4,t.__scopeSelect),[i,s]=P.useState(!1),a=Vn(e,r.onScrollButtonChange);return Ki(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;s(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),i?v.jsx($ge,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});Oge.displayName=u4;var d4="SelectScrollDownButton",Dge=P.forwardRef((t,e)=>{const n=Ip(d4,t.__scopeSelect),r=oG(d4,t.__scopeSelect),[i,s]=P.useState(!1),a=Vn(e,r.onScrollButtonChange);return Ki(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;s(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),i?v.jsx($ge,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});Dge.displayName=d4;var $ge=P.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...i}=t,s=Ip("SelectScrollButton",n),a=P.useRef(null),o=UP(n),l=P.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return P.useEffect(()=>()=>l(),[l]),Ki(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),v.jsx(Wt.div,{"aria-hidden":!0,...i,ref:e,style:{flexShrink:0,...i.style},onPointerDown:kt(i.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:kt(i.onPointerMove,()=>{var c;(c=s.onItemLeave)==null||c.call(s),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:kt(i.onPointerLeave,()=>{l()})})}),r1t="SelectSeparator",Lge=P.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return v.jsx(Wt.div,{"aria-hidden":!0,...r,ref:e})});Lge.displayName=r1t;var h4="SelectArrow",i1t=P.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,i=VP(n),s=Ap(h4,n),a=Ip(h4,n);return s.open&&a.position==="popper"?v.jsx(LU,{...i,...r,ref:e}):null});i1t.displayName=h4;var s1t="SelectBubbleInput",Fge=P.forwardRef(({__scopeSelect:t,value:e,...n},r)=>{const i=P.useRef(null),s=Vn(r,i),a=fge(e);return P.useEffect(()=>{const o=i.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&u){const d=new Event("change",{bubbles:!0});u.call(o,e),o.dispatchEvent(d)}},[a,e]),v.jsx(Wt.select,{...n,style:{...Tie,...n.style},ref:s,defaultValue:e})});Fge.displayName=s1t;function jge(t){return t===""||t===void 0}function zge(t){const e=Jo(t),n=P.useRef(""),r=P.useRef(0),i=P.useCallback(a=>{const o=n.current+a;e(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[e]),s=P.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,i,s]}function Bge(t,e,n){const i=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,s=n?t.indexOf(n):-1;let a=a1t(t,Math.max(s,0));i.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(i.toLowerCase()));return l!==n?l:void 0}function a1t(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var o1t=pge,Uge=gge,l1t=vge,c1t=xge,u1t=bge,Vge=wge,d1t=Ege,Wge=Age,Hge=kge,h1t=Mge,f1t=Pge,Gge=Oge,qge=Dge,Xge=Lge;const Yw=o1t,Zw=l1t,Lv=P.forwardRef(({className:t,children:e,...n},r)=>v.jsxs(Uge,{ref:r,className:Pt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,v.jsx(c1t,{asChild:!0,children:v.jsx(Xie,{className:"h-4 w-4 opacity-50"})})]}));Lv.displayName=Uge.displayName;const Kge=P.forwardRef(({className:t,...e},n)=>v.jsx(Gge,{ref:n,className:Pt("flex cursor-default items-center justify-center py-1",t),...e,children:v.jsx(JEe,{className:"h-4 w-4"})}));Kge.displayName=Gge.displayName;const Yge=P.forwardRef(({className:t,...e},n)=>v.jsx(qge,{ref:n,className:Pt("flex cursor-default items-center justify-center py-1",t),...e,children:v.jsx(Xie,{className:"h-4 w-4"})}));Yge.displayName=qge.displayName;const Fv=P.forwardRef(({className:t,children:e,position:n="popper",...r},i)=>v.jsx(u1t,{children:v.jsxs(Vge,{ref:i,className:Pt("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[v.jsx(Kge,{}),v.jsx(d1t,{className:Pt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),v.jsx(Yge,{})]})}));Fv.displayName=Vge.displayName;const p1t=P.forwardRef(({className:t,...e},n)=>v.jsx(Wge,{ref:n,className:Pt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));p1t.displayName=Wge.displayName;const ts=P.forwardRef(({className:t,children:e,...n},r)=>v.jsxs(Hge,{ref:r,className:Pt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[v.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:v.jsx(f1t,{children:v.jsx(qie,{className:"h-4 w-4"})})}),v.jsx(h1t,{children:e})]}));ts.displayName=Hge.displayName;const m1t=P.forwardRef(({className:t,...e},n)=>v.jsx(Xge,{ref:n,className:Pt("-mx-1 my-1 h-px bg-muted",t),...e}));m1t.displayName=Xge.displayName;const g1t=()=>{var _;const[t,e]=P.useState("immersive"),[n,r]=P.useState("shoulderFlexion"),[i,s]=P.useState("underwater"),[a,o]=P.useState("easy"),[l,c]=P.useState(120),[u,d]=P.useState(!1),[h,f]=P.useState(0),[p,g]=P.useState(0),{data:m=[]}=Kr({queryKey:["/api/exercises"]}),y=m.filter(T=>{var E,C;return((E=T.targetArea)==null?void 0:E.toLowerCase().includes("shoulder"))||((C=T.targetArea)==null?void 0:C.toLowerCase().includes("knee"))}),x=()=>{d(!0),f(0),g(0)},b=()=>{d(!1)};return v.jsxs(nd,{title:"VR Therapy Session",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"VR/AR Therapy"}),v.jsx("p",{className:"text-neutral-600",children:"Experience immersive rehabilitation exercises in virtual reality with gamified elements to enhance your recovery."})]}),v.jsxs(oy,{defaultValue:"immersive",className:"mb-6",onValueChange:e,children:[v.jsxs(Np,{children:[v.jsx(oi,{value:"immersive",children:"Immersive VR"}),v.jsx(oi,{value:"ar",children:"AR Exercises"}),v.jsx(oi,{value:"settings",children:"Settings & Customization"})]}),v.jsx(li,{value:"immersive",className:"space-y-4",children:v.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[v.jsx("div",{className:"lg:col-span-2",children:v.jsxs(Dt,{className:"overflow-hidden",children:[v.jsxs(en,{className:"pb-2",children:[v.jsx(tn,{children:"VR Exercise Environment"}),v.jsx(Nr,{children:"Enter an immersive virtual environment for your rehabilitation exercises"})]}),v.jsxs(Lt,{className:"p-6",children:[v.jsxs("div",{className:"vr-container relative aspect-[16/9] bg-black rounded-lg overflow-hidden",children:[v.jsx("div",{className:"absolute inset-0 z-10 flex items-center justify-center",children:v.jsxs("div",{className:`h-full w-full p-8 flex flex-col items-center justify-center ${i==="underwater"?"bg-blue-900":i==="space"?"bg-indigo-900":i==="forest"?"bg-green-900":"bg-gray-700"}`,children:[v.jsxs("div",{className:"text-white text-center mb-8",children:[v.jsx("h3",{className:"text-xl font-bold mb-2",children:i==="underwater"?"Underwater Therapy Environment":i==="space"?"Space Rehabilitation Zone":i==="forest"?"Forest Healing Sanctuary":"Mountain Recovery Area"}),v.jsx("p",{children:u?`Current exercise: ${n}`:"Start a session to begin exercises"})]}),v.jsx("div",{className:"flex items-center justify-center mb-8",children:v.jsx("div",{className:`w-32 h-32 rounded-full flex items-center justify-center ${u?"animate-pulse":""}`,style:{backgroundColor:u?"rgba(255,255,255,0.2)":"rgba(255,255,255,0.1)"},children:v.jsx("div",{className:`w-24 h-24 rounded-full ${n==="shoulderFlexion"?"bg-blue-500":n==="shoulderRotation"?"bg-purple-500":n==="kneeFlexion"?"bg-orange-500":"bg-green-500"} flex items-center justify-center`,children:v.jsx("span",{className:"text-white font-bold",children:u?"ACTIVE":"READY"})})})})]})}),v.jsx("div",{className:"absolute bottom-4 left-4 right-4 z-20",children:v.jsx("div",{className:"flex justify-center",children:v.jsx(et,{className:"bg-primary hover:bg-primary-dark text-white font-bold py-2 px-4 rounded",onClick:u?b:x,children:u?"Stop VR Session":"Start VR Session"})})})]}),v.jsx("div",{className:"mt-4",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium text-lg",children:((_=m.find(T=>{var E;return(E=T.name)==null?void 0:E.toLowerCase().includes(n)}))==null?void 0:_.name)||"Shoulder Flexion Exercise"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Follow the guide and complete the movement pattern"})]}),u?v.jsx(et,{variant:"destructive",onClick:b,children:"End Session"}):v.jsx(et,{onClick:x,children:"Start Session"})]})})]})]})}),v.jsx("div",{children:v.jsxs(Dt,{children:[v.jsx(en,{children:v.jsx(tn,{children:"Session Progress"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[v.jsx("span",{children:"Progress"}),v.jsxs("span",{children:[Math.round(p),"%"]})]}),v.jsx("div",{className:"h-2 w-full bg-gray-200 rounded-full overflow-hidden",children:v.jsx("div",{className:"h-full bg-primary rounded-full",style:{width:`${p}%`}})})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Score"}),v.jsx("div",{className:"text-3xl font-bold text-primary",children:h})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Current Exercise"}),v.jsx("div",{className:"flex items-center space-x-2",children:v.jsxs(Yw,{value:n,onValueChange:T=>r(T),children:[v.jsx(Lv,{className:"w-full",children:v.jsx(Zw,{placeholder:"Select Exercise"})}),v.jsxs(Fv,{children:[v.jsx(ts,{value:"shoulderFlexion",children:"Shoulder Flexion"}),v.jsx(ts,{value:"shoulderRotation",children:"Shoulder Rotation"}),v.jsx(ts,{value:"kneeFlexion",children:"Knee Flexion"}),v.jsx(ts,{value:"balanceTraining",children:"Balance Training"})]})]})})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Theme"}),v.jsx("div",{className:"flex items-center space-x-2",children:v.jsxs(Yw,{value:i,onValueChange:T=>s(T),children:[v.jsx(Lv,{className:"w-full",children:v.jsx(Zw,{placeholder:"Select Theme"})}),v.jsxs(Fv,{children:[v.jsx(ts,{value:"underwater",children:"Underwater World"}),v.jsx(ts,{value:"space",children:"Space Adventure"}),v.jsx(ts,{value:"forest",children:"Forest Retreat"}),v.jsx(ts,{value:"mountains",children:"Mountain Journey"})]})]})})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Difficulty"}),v.jsx("div",{className:"flex items-center space-x-2",children:v.jsxs(Yw,{value:a,onValueChange:T=>o(T),children:[v.jsx(Lv,{className:"w-full",children:v.jsx(Zw,{placeholder:"Select Difficulty"})}),v.jsxs(Fv,{children:[v.jsx(ts,{value:"easy",children:"Easy"}),v.jsx(ts,{value:"medium",children:"Medium"}),v.jsx(ts,{value:"hard",children:"Hard"})]})]})})]})]})})]})})]})}),v.jsx(li,{value:"ar",className:"space-y-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"AR Exercises"}),v.jsx(Nr,{children:"Use your device's camera to experience AR-based exercise guidance"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"text-center p-10 border-2 border-dashed border-gray-300 rounded-lg",children:[v.jsx("h3",{className:"text-lg font-medium mb-2",children:"AR Mode Coming Soon"}),v.jsx("p",{className:"text-neutral-600 mb-4",children:"AR support for mobile devices is in development. This will allow you to use your camera to see exercise guides overlaid on your real environment."}),v.jsx(et,{onClick:()=>window.location.href="/ar-therapy",variant:"outline",children:"Try AR Therapy Beta"})]})})]})}),v.jsx(li,{value:"settings",className:"space-y-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Exercise Customization"}),v.jsx(Nr,{children:"Personalize your VR/AR therapy experience"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Session Duration (seconds)"}),v.jsx("input",{type:"range",min:"60",max:"600",step:"30",value:l,onChange:T=>c(parseInt(T.target.value)),className:"w-full"}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"1 min"}),v.jsxs("span",{children:[Math.round(l/60)," min"]}),v.jsx("span",{children:"10 min"})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Feedback Preferences"}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"checkbox",id:"audioFeedback",className:"mr-2",defaultChecked:!0}),v.jsx("label",{htmlFor:"audioFeedback",children:"Audio Feedback"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"checkbox",id:"hapticsEnabled",className:"mr-2",defaultChecked:!0}),v.jsx("label",{htmlFor:"hapticsEnabled",children:"Haptic Feedback (when available)"})]}),v.jsxs("div",{className:"flex items-center",children:[v.jsx("input",{type:"checkbox",id:"visualCues",className:"mr-2",defaultChecked:!0}),v.jsx("label",{htmlFor:"visualCues",children:"Visual Exercise Guides"})]})]})]})]}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Avatar Customization"}),v.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg text-center",children:[v.jsx("p",{className:"text-sm text-neutral-600 mb-2",children:"Choose how your avatar appears in multiplayer therapy sessions"}),v.jsx(et,{variant:"outline",size:"sm",children:"Customize Avatar"})]})]}),v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-2",children:"Device Settings"}),v.jsxs("div",{className:"space-y-2",children:[v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"VR Quality"}),v.jsxs(Yw,{defaultValue:"medium",children:[v.jsx(Lv,{className:"w-32",children:v.jsx(Zw,{placeholder:"Quality"})}),v.jsxs(Fv,{children:[v.jsx(ts,{value:"low",children:"Low"}),v.jsx(ts,{value:"medium",children:"Medium"}),v.jsx(ts,{value:"high",children:"High"})]})]})]}),v.jsxs("div",{className:"flex justify-between text-sm",children:[v.jsx("span",{children:"Audio Volume"}),v.jsx("input",{type:"range",min:"0",max:"100",defaultValue:"80",className:"w-32"})]})]})]}),v.jsx("div",{className:"mt-6",children:v.jsx(et,{className:"w-full",children:"Save Settings"})})]})]})})]})})]}),v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Recommended Exercises"}),v.jsx(Nr,{children:"Exercises assigned by your therapist for VR/AR practice"})]}),v.jsx(Lt,{children:v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:y.length>0?y.slice(0,3).map((T,E)=>v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-2",children:T.name}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:T.description}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{var C,I;(C=T.targetArea)!=null&&C.toLowerCase().includes("shoulder")?r("shoulderFlexion"):(I=T.targetArea)!=null&&I.toLowerCase().includes("knee")&&r("kneeFlexion"),e("immersive"),x()},children:"Practice in VR"})]},E)):v.jsx("div",{className:"col-span-3 text-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:v.jsx("p",{className:"text-neutral-600",children:"No exercises have been assigned yet. Please check back later or contact your therapist."})})})})]})]})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const WP="160",y1t={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},v1t={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},Zge=0,f4=1,Qge=2,x1t=3,Jge=0,HP=1,x1=2,mc=3,dh=0,Ua=1,Cu=2,b1t=2,Xd=0,Jm=1,p4=2,m4=3,g4=4,eye=5,rf=100,tye=101,nye=102,y4=103,v4=104,rye=200,iye=201,sye=202,aye=203,pk=204,mk=205,oye=206,lye=207,cye=208,uye=209,dye=210,hye=211,fye=212,pye=213,mye=214,gye=0,yye=1,vye=2,t_=3,xye=4,bye=5,wye=6,Sye=7,uE=0,_ye=1,Tye=2,zu=0,Eye=1,Cye=2,Nye=3,lG=4,Aye=5,Iye=6,x4="attached",kye="detached",GP=300,hh=301,ep=302,n_=303,r_=304,_b=306,i_=1e3,pa=1001,s_=1002,Ii=1003,gk=1004,w1t=1004,b1=1005,S1t=1005,Ri=1006,cG=1007,_1t=1007,tp=1008,T1t=1008,Bu=1009,Mye=1010,Rye=1011,qP=1012,uG=1013,jd=1014,Pc=1015,N0=1016,dG=1017,hG=1018,Pf=1020,Pye=1021,ja=1023,Oye=1024,Dye=1025,Of=1026,zg=1027,$ye=1028,fG=1029,Lye=1030,pG=1031,mG=1033,q2=33776,X2=33777,K2=33778,Y2=33779,b4=35840,w4=35841,S4=35842,_4=35843,gG=36196,T4=37492,E4=37496,C4=37808,N4=37809,A4=37810,I4=37811,k4=37812,M4=37813,R4=37814,P4=37815,O4=37816,D4=37817,$4=37818,L4=37819,F4=37820,j4=37821,Z2=36492,z4=36494,B4=36495,Fye=36283,U4=36284,V4=36285,W4=36286,jye=2200,zye=2201,Bye=2202,a_=2300,o_=2301,Q2=2302,Dm=2400,$m=2401,l_=2402,XP=2500,yG=2501,E1t=0,C1t=1,N1t=2,vG=3e3,Df=3001,Uye=3200,Vye=3201,kp=0,Wye=1,Wo="",rs="srgb",Qu="srgb-linear",KP="display-p3",dE="display-p3-linear",c_="linear",kr="srgb",u_="rec709",d_="p3",A1t=0,pm=7680,I1t=7681,k1t=7682,M1t=7683,R1t=34055,P1t=34056,O1t=5386,D1t=512,$1t=513,L1t=514,F1t=515,j1t=516,z1t=517,B1t=518,H4=519,Hye=512,Gye=513,qye=514,xG=515,Xye=516,Kye=517,Yye=518,Zye=519,h_=35044,U1t=35048,V1t=35040,W1t=35045,H1t=35049,G1t=35041,q1t=35046,X1t=35050,K1t=35042,Y1t="100",G4="300 es",yk=1035,Oc=2e3,A0=2001;class Th{addEventListener(e,n){this._listeners===void 0&&(this._listeners={});const r=this._listeners;r[e]===void 0&&(r[e]=[]),r[e].indexOf(n)===-1&&r[e].push(n)}hasEventListener(e,n){if(this._listeners===void 0)return!1;const r=this._listeners;return r[e]!==void 0&&r[e].indexOf(n)!==-1}removeEventListener(e,n){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(n);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const r=this._listeners[e.type];if(r!==void 0){e.target=this;const i=r.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}const ra=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let iJ=1234567;const eg=Math.PI/180,I0=180/Math.PI;function Zo(){const t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,n=Math.random()*4294967295|0,r=Math.random()*4294967295|0;return(ra[t&255]+ra[t>>8&255]+ra[t>>16&255]+ra[t>>24&255]+"-"+ra[e&255]+ra[e>>8&255]+"-"+ra[e>>16&15|64]+ra[e>>24&255]+"-"+ra[n&63|128]+ra[n>>8&255]+"-"+ra[n>>16&255]+ra[n>>24&255]+ra[r&255]+ra[r>>8&255]+ra[r>>16&255]+ra[r>>24&255]).toLowerCase()}function vi(t,e,n){return Math.max(e,Math.min(n,t))}function bG(t,e){return(t%e+e)%e}function Z1t(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)}function Q1t(t,e,n){return t!==e?(n-t)/(e-t):0}function w1(t,e,n){return(1-n)*t+n*e}function J1t(t,e,n,r){return w1(t,e,1-Math.exp(-n*r))}function eSt(t,e=1){return e-Math.abs(bG(t,e*2)-e)}function tSt(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*(3-2*t))}function nSt(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e),t*t*t*(t*(t*6-15)+10))}function rSt(t,e){return t+Math.floor(Math.random()*(e-t+1))}function iSt(t,e){return t+Math.random()*(e-t)}function sSt(t){return t*(.5-Math.random())}function aSt(t){t!==void 0&&(iJ=t);let e=iJ+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function oSt(t){return t*eg}function lSt(t){return t*I0}function q4(t){return(t&t-1)===0&&t!==0}function cSt(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function vk(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}function uSt(t,e,n,r,i){const s=Math.cos,a=Math.sin,o=s(n/2),l=a(n/2),c=s((e+r)/2),u=a((e+r)/2),d=s((e-r)/2),h=a((e-r)/2),f=s((r-e)/2),p=a((r-e)/2);switch(i){case"XYX":t.set(o*u,l*d,l*h,o*c);break;case"YZY":t.set(l*h,o*u,l*d,o*c);break;case"ZXZ":t.set(l*d,l*h,o*u,o*c);break;case"XZX":t.set(o*u,l*p,l*f,o*c);break;case"YXY":t.set(l*f,o*u,l*p,o*c);break;case"ZYZ":t.set(l*p,l*f,o*u,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function co(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function bn(t,e){switch(e.constructor){case Float32Array:return t;case Uint32Array:return Math.round(t*4294967295);case Uint16Array:return Math.round(t*65535);case Uint8Array:return Math.round(t*255);case Int32Array:return Math.round(t*2147483647);case Int16Array:return Math.round(t*32767);case Int8Array:return Math.round(t*127);default:throw new Error("Invalid component type.")}}const dSt={DEG2RAD:eg,RAD2DEG:I0,generateUUID:Zo,clamp:vi,euclideanModulo:bG,mapLinear:Z1t,inverseLerp:Q1t,lerp:w1,damp:J1t,pingpong:eSt,smoothstep:tSt,smootherstep:nSt,randInt:rSt,randFloat:iSt,randFloatSpread:sSt,seededRandom:aSt,degToRad:oSt,radToDeg:lSt,isPowerOfTwo:q4,ceilPowerOfTwo:cSt,floorPowerOfTwo:vk,setQuaternionFromProperEuler:uSt,normalize:bn,denormalize:co};class Xe{constructor(e=0,n=0){Xe.prototype.isVector2=!0,this.x=e,this.y=n}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,n){return this.x=e,this.y=n,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const n=this.x,r=this.y,i=e.elements;return this.x=i[0]*n+i[3]*r+i[6],this.y=i[1]*n+i[4]*r+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y;return n*n+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this}rotateAround(e,n){const r=Math.cos(n),i=Math.sin(n),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*i+e.x,this.y=s*i+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Tn{constructor(e,n,r,i,s,a,o,l,c){Tn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,a,o,l,c)}set(e,n,r,i,s,a,o,l,c){const u=this.elements;return u[0]=e,u[1]=i,u[2]=o,u[3]=n,u[4]=s,u[5]=l,u[6]=r,u[7]=a,u[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],this}extractBasis(e,n,r){return e.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const n=e.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,a=r[0],o=r[3],l=r[6],c=r[1],u=r[4],d=r[7],h=r[2],f=r[5],p=r[8],g=i[0],m=i[3],y=i[6],x=i[1],b=i[4],_=i[7],T=i[2],E=i[5],C=i[8];return s[0]=a*g+o*x+l*T,s[3]=a*m+o*b+l*E,s[6]=a*y+o*_+l*C,s[1]=c*g+u*x+d*T,s[4]=c*m+u*b+d*E,s[7]=c*y+u*_+d*C,s[2]=h*g+f*x+p*T,s[5]=h*m+f*b+p*E,s[8]=h*y+f*_+p*C,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=e,n[4]*=e,n[7]*=e,n[2]*=e,n[5]*=e,n[8]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8];return n*a*u-n*o*c-r*s*u+r*o*l+i*s*c-i*a*l}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=u*a-o*c,h=o*l-u*s,f=c*s-a*l,p=n*d+r*h+i*f;if(p===0)return this.set(0,0,0,0,0,0,0,0,0);const g=1/p;return e[0]=d*g,e[1]=(i*c-u*r)*g,e[2]=(o*r-i*a)*g,e[3]=h*g,e[4]=(u*n-i*l)*g,e[5]=(i*s-o*n)*g,e[6]=f*g,e[7]=(r*l-c*n)*g,e[8]=(a*n-r*s)*g,this}transpose(){let e;const n=this.elements;return e=n[1],n[1]=n[3],n[3]=e,e=n[2],n[2]=n[6],n[6]=e,e=n[5],n[5]=n[7],n[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const n=this.elements;return e[0]=n[0],e[1]=n[3],e[2]=n[6],e[3]=n[1],e[4]=n[4],e[5]=n[7],e[6]=n[2],e[7]=n[5],e[8]=n[8],this}setUvTransform(e,n,r,i,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(r*l,r*c,-r*(l*a+c*o)+a+e,-i*c,i*l,-i*(-c*a+l*o)+o+n,0,0,1),this}scale(e,n){return this.premultiply(IL.makeScale(e,n)),this}rotate(e){return this.premultiply(IL.makeRotation(-e)),this}translate(e,n){return this.premultiply(IL.makeTranslation(e,n)),this}makeTranslation(e,n){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,n,0,0,1),this}makeRotation(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,r,n,0,0,0,1),this}makeScale(e,n){return this.set(e,0,0,0,n,0,0,0,1),this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<9;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<9;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const IL=new Tn;function Qye(t){for(let e=t.length-1;e>=0;--e)if(t[e]>=65535)return!0;return!1}const hSt={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function jv(t,e){return new hSt[t](e)}function f_(t){return document.createElementNS("http://www.w3.org/1999/xhtml",t)}function Jye(){const t=f_("canvas");return t.style.display="block",t}const sJ={};function S1(t){t in sJ||(sJ[t]=!0,console.warn(t))}const aJ=new Tn().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),oJ=new Tn().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),TN={[Qu]:{transfer:c_,primaries:u_,toReference:t=>t,fromReference:t=>t},[rs]:{transfer:kr,primaries:u_,toReference:t=>t.convertSRGBToLinear(),fromReference:t=>t.convertLinearToSRGB()},[dE]:{transfer:c_,primaries:d_,toReference:t=>t.applyMatrix3(oJ),fromReference:t=>t.applyMatrix3(aJ)},[KP]:{transfer:kr,primaries:d_,toReference:t=>t.convertSRGBToLinear().applyMatrix3(oJ),fromReference:t=>t.applyMatrix3(aJ).convertLinearToSRGB()}},fSt=new Set([Qu,dE]),dr={enabled:!0,_workingColorSpace:Qu,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!fSt.has(t))throw new Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(t,e,n){if(this.enabled===!1||e===n||!e||!n)return t;const r=TN[e].toReference,i=TN[n].fromReference;return i(r(t))},fromWorkingColorSpace:function(t,e){return this.convert(t,this._workingColorSpace,e)},toWorkingColorSpace:function(t,e){return this.convert(t,e,this._workingColorSpace)},getPrimaries:function(t){return TN[t].primaries},getTransfer:function(t){return t===Wo?c_:TN[t].transfer}};function yx(t){return t<.04045?t*.0773993808:Math.pow(t*.9478672986+.0521327014,2.4)}function kL(t){return t<.0031308?t*12.92:1.055*Math.pow(t,.41666)-.055}let Vy;class wG{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{Vy===void 0&&(Vy=f_("canvas")),Vy.width=e.width,Vy.height=e.height;const r=Vy.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),n=Vy}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const n=f_("canvas");n.width=e.width,n.height=e.height;const r=n.getContext("2d");r.drawImage(e,0,0,e.width,e.height);const i=r.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=yx(s[a]/255)*255;return r.putImageData(i,0,0),n}else if(e.data){const n=e.data.slice(0);for(let r=0;r<n.length;r++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[r]=Math.floor(yx(n[r]/255)*255):n[r]=yx(n[r]);return{data:n,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let pSt=0;class Lm{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:pSt++}),this.uuid=Zo(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const r={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(ML(i[a].image)):s.push(ML(i[a]))}else s=ML(i);r.url=s}return n||(e.images[this.uuid]=r),r}}function ML(t){return typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?wG.getDataURL(t):t.data?{data:Array.from(t.data),width:t.width,height:t.height,type:t.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let mSt=0;class $i extends Th{constructor(e=$i.DEFAULT_IMAGE,n=$i.DEFAULT_MAPPING,r=pa,i=pa,s=Ri,a=tp,o=ja,l=Bu,c=$i.DEFAULT_ANISOTROPY,u=Wo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:mSt++}),this.uuid=Zo(),this.name="",this.source=new Lm(e),this.mipmaps=[],this.mapping=n,this.channel=0,this.wrapS=r,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new Xe(0,0),this.repeat=new Xe(1,1),this.center=new Xe(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Tn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof u=="string"?this.colorSpace=u:(S1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===Df?rs:Wo),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const n=e===void 0||typeof e=="string";if(!n&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),n||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==GP)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case i_:e.x=e.x-Math.floor(e.x);break;case pa:e.x=e.x<0?0:1;break;case s_:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case i_:e.y=e.y-Math.floor(e.y);break;case pa:e.y=e.y<0?0:1;break;case s_:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return S1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===rs?Df:vG}set encoding(e){S1("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===Df?rs:Wo}}$i.DEFAULT_IMAGE=null;$i.DEFAULT_MAPPING=GP;$i.DEFAULT_ANISOTROPY=1;class hr{constructor(e=0,n=0,r=0,i=1){hr.prototype.isVector4=!0,this.x=e,this.y=n,this.z=r,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,n,r,i){return this.x=e,this.y=n,this.z=r,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this.w=e.w+n.w,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this.w+=e.w*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this.w=e.w-n.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*n+a[4]*r+a[8]*i+a[12]*s,this.y=a[1]*n+a[5]*r+a[9]*i+a[13]*s,this.z=a[2]*n+a[6]*r+a[10]*i+a[14]*s,this.w=a[3]*n+a[7]*r+a[11]*i+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const n=Math.sqrt(1-e.w*e.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/n,this.y=e.y/n,this.z=e.z/n),this}setAxisAngleFromRotationMatrix(e){let n,r,i,s;const l=e.elements,c=l[0],u=l[4],d=l[8],h=l[1],f=l[5],p=l[9],g=l[2],m=l[6],y=l[10];if(Math.abs(u-h)<.01&&Math.abs(d-g)<.01&&Math.abs(p-m)<.01){if(Math.abs(u+h)<.1&&Math.abs(d+g)<.1&&Math.abs(p+m)<.1&&Math.abs(c+f+y-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const b=(c+1)/2,_=(f+1)/2,T=(y+1)/2,E=(u+h)/4,C=(d+g)/4,I=(p+m)/4;return b>_&&b>T?b<.01?(r=0,i=.707106781,s=.707106781):(r=Math.sqrt(b),i=E/r,s=C/r):_>T?_<.01?(r=.707106781,i=0,s=.707106781):(i=Math.sqrt(_),r=E/i,s=I/i):T<.01?(r=.707106781,i=.707106781,s=0):(s=Math.sqrt(T),r=C/s,i=I/s),this.set(r,i,s,n),this}let x=Math.sqrt((m-p)*(m-p)+(d-g)*(d-g)+(h-u)*(h-u));return Math.abs(x)<.001&&(x=1),this.x=(m-p)/x,this.y=(d-g)/x,this.z=(h-u)/x,this.w=Math.acos((c+f+y-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this.w=Math.max(e.w,Math.min(n.w,this.w)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this.w=Math.max(e,Math.min(n,this.w)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this.w+=(e.w-this.w)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this.w=e.w+(n.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this.w=e[n+3],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e[n+3]=this.w,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this.w=e.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class eve extends Th{constructor(e=1,n=1,r={}){super(),this.isRenderTarget=!0,this.width=e,this.height=n,this.depth=1,this.scissor=new hr(0,0,e,n),this.scissorTest=!1,this.viewport=new hr(0,0,e,n);const i={width:e,height:n,depth:1};r.encoding!==void 0&&(S1("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=r.encoding===Df?rs:Wo),r=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:Ri,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},r),this.texture=new $i(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=r.generateMipmaps,this.texture.internalFormat=r.internalFormat,this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.samples=r.samples}setSize(e,n,r=1){(this.width!==e||this.height!==n||this.depth!==r)&&(this.width=e,this.height=n,this.depth=r,this.texture.image.width=e,this.texture.image.height=n,this.texture.image.depth=r,this.dispose()),this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},e.texture.image);return this.texture.source=new Lm(n),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Kc extends eve{constructor(e=1,n=1,r={}){super(e,n,r),this.isWebGLRenderTarget=!0}}class YP extends $i{constructor(e=null,n=1,r=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class gSt extends Kc{constructor(e=1,n=1,r=1,i={}){super(e,n,i),this.isWebGLArrayRenderTarget=!0,this.depth=r,this.texture=new YP(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class SG extends $i{constructor(e=null,n=1,r=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:n,height:r,depth:i},this.magFilter=Ii,this.minFilter=Ii,this.wrapR=pa,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class ySt extends Kc{constructor(e=1,n=1,r=1,i={}){super(e,n,i),this.isWebGL3DRenderTarget=!0,this.depth=r,this.texture=new SG(null,e,n,r),this.texture.isRenderTargetTexture=!0}}class vSt extends Kc{constructor(e=1,n=1,r=1,i={}){super(e,n,i),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let a=0;a<r;a++)this.texture[a]=s.clone(),this.texture[a].isRenderTargetTexture=!0}setSize(e,n,r=1){if(this.width!==e||this.height!==n||this.depth!==r){this.width=e,this.height=n,this.depth=r;for(let i=0,s=this.texture.length;i<s;i++)this.texture[i].image.width=e,this.texture[i].image.height=n,this.texture[i].image.depth=r;this.dispose()}this.viewport.set(0,0,e,n),this.scissor.set(0,0,e,n)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let n=0,r=e.texture.length;n<r;n++)this.texture[n]=e.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class xo{constructor(e=0,n=0,r=0,i=1){this.isQuaternion=!0,this._x=e,this._y=n,this._z=r,this._w=i}static slerpFlat(e,n,r,i,s,a,o){let l=r[i+0],c=r[i+1],u=r[i+2],d=r[i+3];const h=s[a+0],f=s[a+1],p=s[a+2],g=s[a+3];if(o===0){e[n+0]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d;return}if(o===1){e[n+0]=h,e[n+1]=f,e[n+2]=p,e[n+3]=g;return}if(d!==g||l!==h||c!==f||u!==p){let m=1-o;const y=l*h+c*f+u*p+d*g,x=y>=0?1:-1,b=1-y*y;if(b>Number.EPSILON){const T=Math.sqrt(b),E=Math.atan2(T,y*x);m=Math.sin(m*E)/T,o=Math.sin(o*E)/T}const _=o*x;if(l=l*m+h*_,c=c*m+f*_,u=u*m+p*_,d=d*m+g*_,m===1-o){const T=1/Math.sqrt(l*l+c*c+u*u+d*d);l*=T,c*=T,u*=T,d*=T}}e[n]=l,e[n+1]=c,e[n+2]=u,e[n+3]=d}static multiplyQuaternionsFlat(e,n,r,i,s,a){const o=r[i],l=r[i+1],c=r[i+2],u=r[i+3],d=s[a],h=s[a+1],f=s[a+2],p=s[a+3];return e[n]=o*p+u*d+l*f-c*h,e[n+1]=l*p+u*h+c*d-o*f,e[n+2]=c*p+u*f+o*h-l*d,e[n+3]=u*p-o*d-l*h-c*f,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,n,r,i){return this._x=e,this._y=n,this._z=r,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,n=!0){const r=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(r/2),u=o(i/2),d=o(s/2),h=l(r/2),f=l(i/2),p=l(s/2);switch(a){case"XYZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"YXZ":this._x=h*u*d+c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"ZXY":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d-h*f*p;break;case"ZYX":this._x=h*u*d-c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d+h*f*p;break;case"YZX":this._x=h*u*d+c*f*p,this._y=c*f*d+h*u*p,this._z=c*u*p-h*f*d,this._w=c*u*d-h*f*p;break;case"XZY":this._x=h*u*d-c*f*p,this._y=c*f*d-h*u*p,this._z=c*u*p+h*f*d,this._w=c*u*d+h*f*p;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return n===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,n){const r=n/2,i=Math.sin(r);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){const n=e.elements,r=n[0],i=n[4],s=n[8],a=n[1],o=n[5],l=n[9],c=n[2],u=n[6],d=n[10],h=r+o+d;if(h>0){const f=.5/Math.sqrt(h+1);this._w=.25/f,this._x=(u-l)*f,this._y=(s-c)*f,this._z=(a-i)*f}else if(r>o&&r>d){const f=2*Math.sqrt(1+r-o-d);this._w=(u-l)/f,this._x=.25*f,this._y=(i+a)/f,this._z=(s+c)/f}else if(o>d){const f=2*Math.sqrt(1+o-r-d);this._w=(s-c)/f,this._x=(i+a)/f,this._y=.25*f,this._z=(l+u)/f}else{const f=2*Math.sqrt(1+d-r-o);this._w=(a-i)/f,this._x=(s+c)/f,this._y=(l+u)/f,this._z=.25*f}return this._onChangeCallback(),this}setFromUnitVectors(e,n){let r=e.dot(n)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=r):(this._x=0,this._y=-e.z,this._z=e.y,this._w=r)):(this._x=e.y*n.z-e.z*n.y,this._y=e.z*n.x-e.x*n.z,this._z=e.x*n.y-e.y*n.x,this._w=r),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(vi(this.dot(e),-1,1)))}rotateTowards(e,n){const r=this.angleTo(e);if(r===0)return this;const i=Math.min(1,n/r);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,n){const r=e._x,i=e._y,s=e._z,a=e._w,o=n._x,l=n._y,c=n._z,u=n._w;return this._x=r*u+a*o+i*c-s*l,this._y=i*u+a*l+s*o-r*c,this._z=s*u+a*c+r*l-i*o,this._w=a*u-r*o-i*l-s*c,this._onChangeCallback(),this}slerp(e,n){if(n===0)return this;if(n===1)return this.copy(e);const r=this._x,i=this._y,s=this._z,a=this._w;let o=a*e._w+r*e._x+i*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=i,this._z=s,this;const l=1-o*o;if(l<=Number.EPSILON){const f=1-n;return this._w=f*a+n*this._w,this._x=f*r+n*this._x,this._y=f*i+n*this._y,this._z=f*s+n*this._z,this.normalize(),this}const c=Math.sqrt(l),u=Math.atan2(c,o),d=Math.sin((1-n)*u)/c,h=Math.sin(n*u)/c;return this._w=a*d+this._w*h,this._x=r*d+this._x*h,this._y=i*d+this._y*h,this._z=s*d+this._z*h,this._onChangeCallback(),this}slerpQuaternions(e,n,r){return this.copy(e).slerp(n,r)}random(){const e=Math.random(),n=Math.sqrt(1-e),r=Math.sqrt(e),i=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(i),r*Math.sin(s),r*Math.cos(s),n*Math.sin(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,n=0){return this._x=e[n],this._y=e[n+1],this._z=e[n+2],this._w=e[n+3],this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._w,e}fromBufferAttribute(e,n){return this._x=e.getX(n),this._y=e.getY(n),this._z=e.getZ(n),this._w=e.getW(n),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ne{constructor(e=0,n=0,r=0){ne.prototype.isVector3=!0,this.x=e,this.y=n,this.z=r}set(e,n,r){return r===void 0&&(r=this.z),this.x=e,this.y=n,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,n){switch(e){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,n){return this.x=e.x+n.x,this.y=e.y+n.y,this.z=e.z+n.z,this}addScaledVector(e,n){return this.x+=e.x*n,this.y+=e.y*n,this.z+=e.z*n,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,n){return this.x=e.x-n.x,this.y=e.y-n.y,this.z=e.z-n.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,n){return this.x=e.x*n.x,this.y=e.y*n.y,this.z=e.z*n.z,this}applyEuler(e){return this.applyQuaternion(lJ.setFromEuler(e))}applyAxisAngle(e,n){return this.applyQuaternion(lJ.setFromAxisAngle(e,n))}applyMatrix3(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[3]*r+s[6]*i,this.y=s[1]*n+s[4]*r+s[7]*i,this.z=s[2]*n+s[5]*r+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const n=this.x,r=this.y,i=this.z,s=e.elements,a=1/(s[3]*n+s[7]*r+s[11]*i+s[15]);return this.x=(s[0]*n+s[4]*r+s[8]*i+s[12])*a,this.y=(s[1]*n+s[5]*r+s[9]*i+s[13])*a,this.z=(s[2]*n+s[6]*r+s[10]*i+s[14])*a,this}applyQuaternion(e){const n=this.x,r=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*i-o*r),u=2*(o*n-s*i),d=2*(s*r-a*n);return this.x=n+l*c+a*d-o*u,this.y=r+l*u+o*c-s*d,this.z=i+l*d+s*u-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const n=this.x,r=this.y,i=this.z,s=e.elements;return this.x=s[0]*n+s[4]*r+s[8]*i,this.y=s[1]*n+s[5]*r+s[9]*i,this.z=s[2]*n+s[6]*r+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,n){return this.x=Math.max(e.x,Math.min(n.x,this.x)),this.y=Math.max(e.y,Math.min(n.y,this.y)),this.z=Math.max(e.z,Math.min(n.z,this.z)),this}clampScalar(e,n){return this.x=Math.max(e,Math.min(n,this.x)),this.y=Math.max(e,Math.min(n,this.y)),this.z=Math.max(e,Math.min(n,this.z)),this}clampLength(e,n){const r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(n,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,n){return this.x+=(e.x-this.x)*n,this.y+=(e.y-this.y)*n,this.z+=(e.z-this.z)*n,this}lerpVectors(e,n,r){return this.x=e.x+(n.x-e.x)*r,this.y=e.y+(n.y-e.y)*r,this.z=e.z+(n.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,n){const r=e.x,i=e.y,s=e.z,a=n.x,o=n.y,l=n.z;return this.x=i*l-s*o,this.y=s*a-r*l,this.z=r*o-i*a,this}projectOnVector(e){const n=e.lengthSq();if(n===0)return this.set(0,0,0);const r=e.dot(this)/n;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return RL.copy(this).projectOnVector(e),this.sub(RL)}reflect(e){return this.sub(RL.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const n=Math.sqrt(this.lengthSq()*e.lengthSq());if(n===0)return Math.PI/2;const r=this.dot(e)/n;return Math.acos(vi(r,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const n=this.x-e.x,r=this.y-e.y,i=this.z-e.z;return n*n+r*r+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,n,r){const i=Math.sin(n)*e;return this.x=i*Math.sin(r),this.y=Math.cos(n)*e,this.z=i*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,n,r){return this.x=e*Math.sin(n),this.y=r,this.z=e*Math.cos(n),this}setFromMatrixPosition(e){const n=e.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(e){const n=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=n,this.y=r,this.z=i,this}setFromMatrixColumn(e,n){return this.fromArray(e.elements,n*4)}setFromMatrix3Column(e,n){return this.fromArray(e.elements,n*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,n=0){return this.x=e[n],this.y=e[n+1],this.z=e[n+2],this}toArray(e=[],n=0){return e[n]=this.x,e[n+1]=this.y,e[n+2]=this.z,e}fromBufferAttribute(e,n){return this.x=e.getX(n),this.y=e.getY(n),this.z=e.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,r=Math.sqrt(1-e**2);return this.x=r*Math.cos(n),this.y=r*Math.sin(n),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const RL=new ne,lJ=new xo;class Va{constructor(e=new ne(1/0,1/0,1/0),n=new ne(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromArray(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n+=3)this.expandByPoint(lc.fromArray(e,n));return this}setFromBufferAttribute(e){this.makeEmpty();for(let n=0,r=e.count;n<r;n++)this.expandByPoint(lc.fromBufferAttribute(e,n));return this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=lc.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,n=!1){return this.makeEmpty(),this.expandByObject(e,n)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,n=!1){e.updateWorldMatrix(!1,!1);const r=e.geometry;if(r!==void 0){const s=r.getAttribute("position");if(n===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,lc):lc.fromBufferAttribute(s,a),lc.applyMatrix4(e.matrixWorld),this.expandByPoint(lc);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),EN.copy(e.boundingBox)):(r.boundingBox===null&&r.computeBoundingBox(),EN.copy(r.boundingBox)),EN.applyMatrix4(e.matrixWorld),this.union(EN)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],n);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,lc),lc.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let n,r;return e.normal.x>0?(n=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(n=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(n+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(n+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(n+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(n+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),n<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Sw),CN.subVectors(this.max,Sw),Wy.subVectors(e.a,Sw),Hy.subVectors(e.b,Sw),Gy.subVectors(e.c,Sw),Fh.subVectors(Hy,Wy),jh.subVectors(Gy,Hy),qp.subVectors(Wy,Gy);let n=[0,-Fh.z,Fh.y,0,-jh.z,jh.y,0,-qp.z,qp.y,Fh.z,0,-Fh.x,jh.z,0,-jh.x,qp.z,0,-qp.x,-Fh.y,Fh.x,0,-jh.y,jh.x,0,-qp.y,qp.x,0];return!PL(n,Wy,Hy,Gy,CN)||(n=[1,0,0,0,1,0,0,0,1],!PL(n,Wy,Hy,Gy,CN))?!1:(NN.crossVectors(Fh,jh),n=[NN.x,NN.y,NN.z],PL(n,Wy,Hy,Gy,CN))}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,lc).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(lc).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(gd[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gd[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gd[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gd[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gd[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gd[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gd[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gd[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gd),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const gd=[new ne,new ne,new ne,new ne,new ne,new ne,new ne,new ne],lc=new ne,EN=new Va,Wy=new ne,Hy=new ne,Gy=new ne,Fh=new ne,jh=new ne,qp=new ne,Sw=new ne,CN=new ne,NN=new ne,Xp=new ne;function PL(t,e,n,r,i){for(let s=0,a=t.length-3;s<=a;s+=3){Xp.fromArray(t,s);const o=i.x*Math.abs(Xp.x)+i.y*Math.abs(Xp.y)+i.z*Math.abs(Xp.z),l=e.dot(Xp),c=n.dot(Xp),u=r.dot(Xp);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>o)return!1}return!0}const xSt=new Va,_w=new ne,OL=new ne;class ga{constructor(e=new ne,n=-1){this.isSphere=!0,this.center=e,this.radius=n}set(e,n){return this.center.copy(e),this.radius=n,this}setFromPoints(e,n){const r=this.center;n!==void 0?r.copy(n):xSt.setFromPoints(e).getCenter(r);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,r.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const n=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=n*n}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,n){const r=this.center.distanceToSquared(e);return n.copy(e),r>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;_w.subVectors(e,this.center);const n=_w.lengthSq();if(n>this.radius*this.radius){const r=Math.sqrt(n),i=(r-this.radius)*.5;this.center.addScaledVector(_w,i/r),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(OL.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(_w.copy(e.center).add(OL)),this.expandByPoint(_w.copy(e.center).sub(OL))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const yd=new ne,DL=new ne,AN=new ne,zh=new ne,$L=new ne,IN=new ne,LL=new ne;class Tb{constructor(e=new ne,n=new ne(0,0,-1)){this.origin=e,this.direction=n}set(e,n){return this.origin.copy(e),this.direction.copy(n),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,n){return n.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,yd)),this}closestPointToPoint(e,n){n.subVectors(e,this.origin);const r=n.dot(this.direction);return r<0?n.copy(this.origin):n.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const n=yd.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(yd.copy(this.origin).addScaledVector(this.direction,n),yd.distanceToSquared(e))}distanceSqToSegment(e,n,r,i){DL.copy(e).add(n).multiplyScalar(.5),AN.copy(n).sub(e).normalize(),zh.copy(this.origin).sub(DL);const s=e.distanceTo(n)*.5,a=-this.direction.dot(AN),o=zh.dot(this.direction),l=-zh.dot(AN),c=zh.lengthSq(),u=Math.abs(1-a*a);let d,h,f,p;if(u>0)if(d=a*l-o,h=a*o-l,p=s*u,d>=0)if(h>=-p)if(h<=p){const g=1/u;d*=g,h*=g,f=d*(d+a*h+2*o)+h*(a*d+h+2*l)+c}else h=s,d=Math.max(0,-(a*h+o)),f=-d*d+h*(h+2*l)+c;else h=-s,d=Math.max(0,-(a*h+o)),f=-d*d+h*(h+2*l)+c;else h<=-p?(d=Math.max(0,-(-a*s+o)),h=d>0?-s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c):h<=p?(d=0,h=Math.min(Math.max(-s,-l),s),f=h*(h+2*l)+c):(d=Math.max(0,-(a*s+o)),h=d>0?s:Math.min(Math.max(-s,-l),s),f=-d*d+h*(h+2*l)+c);else h=a>0?-s:s,d=Math.max(0,-(a*h+o)),f=-d*d+h*(h+2*l)+c;return r&&r.copy(this.origin).addScaledVector(this.direction,d),i&&i.copy(DL).addScaledVector(AN,h),f}intersectSphere(e,n){yd.subVectors(e.center,this.origin);const r=yd.dot(this.direction),i=yd.dot(yd)-r*r,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,n):this.at(o,n)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const n=e.normal.dot(this.direction);if(n===0)return e.distanceToPoint(this.origin)===0?0:null;const r=-(this.origin.dot(e.normal)+e.constant)/n;return r>=0?r:null}intersectPlane(e,n){const r=this.distanceToPlane(e);return r===null?null:this.at(r,n)}intersectsPlane(e){const n=e.distanceToPoint(this.origin);return n===0||e.normal.dot(this.direction)*n<0}intersectBox(e,n){let r,i,s,a,o,l;const c=1/this.direction.x,u=1/this.direction.y,d=1/this.direction.z,h=this.origin;return c>=0?(r=(e.min.x-h.x)*c,i=(e.max.x-h.x)*c):(r=(e.max.x-h.x)*c,i=(e.min.x-h.x)*c),u>=0?(s=(e.min.y-h.y)*u,a=(e.max.y-h.y)*u):(s=(e.max.y-h.y)*u,a=(e.min.y-h.y)*u),r>a||s>i||((s>r||isNaN(r))&&(r=s),(a<i||isNaN(i))&&(i=a),d>=0?(o=(e.min.z-h.z)*d,l=(e.max.z-h.z)*d):(o=(e.max.z-h.z)*d,l=(e.min.z-h.z)*d),r>l||o>i)||((o>r||r!==r)&&(r=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(r>=0?r:i,n)}intersectsBox(e){return this.intersectBox(e,yd)!==null}intersectTriangle(e,n,r,i,s){$L.subVectors(n,e),IN.subVectors(r,e),LL.crossVectors($L,IN);let a=this.direction.dot(LL),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;zh.subVectors(this.origin,e);const l=o*this.direction.dot(IN.crossVectors(zh,IN));if(l<0)return null;const c=o*this.direction.dot($L.cross(zh));if(c<0||l+c>a)return null;const u=-o*zh.dot(LL);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class an{constructor(e,n,r,i,s,a,o,l,c,u,d,h,f,p,g,m){an.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,n,r,i,s,a,o,l,c,u,d,h,f,p,g,m)}set(e,n,r,i,s,a,o,l,c,u,d,h,f,p,g,m){const y=this.elements;return y[0]=e,y[4]=n,y[8]=r,y[12]=i,y[1]=s,y[5]=a,y[9]=o,y[13]=l,y[2]=c,y[6]=u,y[10]=d,y[14]=h,y[3]=f,y[7]=p,y[11]=g,y[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new an().fromArray(this.elements)}copy(e){const n=this.elements,r=e.elements;return n[0]=r[0],n[1]=r[1],n[2]=r[2],n[3]=r[3],n[4]=r[4],n[5]=r[5],n[6]=r[6],n[7]=r[7],n[8]=r[8],n[9]=r[9],n[10]=r[10],n[11]=r[11],n[12]=r[12],n[13]=r[13],n[14]=r[14],n[15]=r[15],this}copyPosition(e){const n=this.elements,r=e.elements;return n[12]=r[12],n[13]=r[13],n[14]=r[14],this}setFromMatrix3(e){const n=e.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(e,n,r){return e.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,n,r){return this.set(e.x,n.x,r.x,0,e.y,n.y,r.y,0,e.z,n.z,r.z,0,0,0,0,1),this}extractRotation(e){const n=this.elements,r=e.elements,i=1/qy.setFromMatrixColumn(e,0).length(),s=1/qy.setFromMatrixColumn(e,1).length(),a=1/qy.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[3]=0,n[4]=r[4]*s,n[5]=r[5]*s,n[6]=r[6]*s,n[7]=0,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(e){const n=this.elements,r=e.x,i=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(i),c=Math.sin(i),u=Math.cos(s),d=Math.sin(s);if(e.order==="XYZ"){const h=a*u,f=a*d,p=o*u,g=o*d;n[0]=l*u,n[4]=-l*d,n[8]=c,n[1]=f+p*c,n[5]=h-g*c,n[9]=-o*l,n[2]=g-h*c,n[6]=p+f*c,n[10]=a*l}else if(e.order==="YXZ"){const h=l*u,f=l*d,p=c*u,g=c*d;n[0]=h+g*o,n[4]=p*o-f,n[8]=a*c,n[1]=a*d,n[5]=a*u,n[9]=-o,n[2]=f*o-p,n[6]=g+h*o,n[10]=a*l}else if(e.order==="ZXY"){const h=l*u,f=l*d,p=c*u,g=c*d;n[0]=h-g*o,n[4]=-a*d,n[8]=p+f*o,n[1]=f+p*o,n[5]=a*u,n[9]=g-h*o,n[2]=-a*c,n[6]=o,n[10]=a*l}else if(e.order==="ZYX"){const h=a*u,f=a*d,p=o*u,g=o*d;n[0]=l*u,n[4]=p*c-f,n[8]=h*c+g,n[1]=l*d,n[5]=g*c+h,n[9]=f*c-p,n[2]=-c,n[6]=o*l,n[10]=a*l}else if(e.order==="YZX"){const h=a*l,f=a*c,p=o*l,g=o*c;n[0]=l*u,n[4]=g-h*d,n[8]=p*d+f,n[1]=d,n[5]=a*u,n[9]=-o*u,n[2]=-c*u,n[6]=f*d+p,n[10]=h-g*d}else if(e.order==="XZY"){const h=a*l,f=a*c,p=o*l,g=o*c;n[0]=l*u,n[4]=-d,n[8]=c*u,n[1]=h*d+g,n[5]=a*u,n[9]=f*d-p,n[2]=p*d-f,n[6]=o*u,n[10]=g*d+h}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(e){return this.compose(bSt,e,wSt)}lookAt(e,n,r){const i=this.elements;return Oo.subVectors(e,n),Oo.lengthSq()===0&&(Oo.z=1),Oo.normalize(),Bh.crossVectors(r,Oo),Bh.lengthSq()===0&&(Math.abs(r.z)===1?Oo.x+=1e-4:Oo.z+=1e-4,Oo.normalize(),Bh.crossVectors(r,Oo)),Bh.normalize(),kN.crossVectors(Oo,Bh),i[0]=Bh.x,i[4]=kN.x,i[8]=Oo.x,i[1]=Bh.y,i[5]=kN.y,i[9]=Oo.y,i[2]=Bh.z,i[6]=kN.z,i[10]=Oo.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,n){const r=e.elements,i=n.elements,s=this.elements,a=r[0],o=r[4],l=r[8],c=r[12],u=r[1],d=r[5],h=r[9],f=r[13],p=r[2],g=r[6],m=r[10],y=r[14],x=r[3],b=r[7],_=r[11],T=r[15],E=i[0],C=i[4],I=i[8],A=i[12],k=i[1],R=i[5],$=i[9],z=i[13],O=i[2],j=i[6],B=i[10],W=i[14],L=i[3],V=i[7],H=i[11],K=i[15];return s[0]=a*E+o*k+l*O+c*L,s[4]=a*C+o*R+l*j+c*V,s[8]=a*I+o*$+l*B+c*H,s[12]=a*A+o*z+l*W+c*K,s[1]=u*E+d*k+h*O+f*L,s[5]=u*C+d*R+h*j+f*V,s[9]=u*I+d*$+h*B+f*H,s[13]=u*A+d*z+h*W+f*K,s[2]=p*E+g*k+m*O+y*L,s[6]=p*C+g*R+m*j+y*V,s[10]=p*I+g*$+m*B+y*H,s[14]=p*A+g*z+m*W+y*K,s[3]=x*E+b*k+_*O+T*L,s[7]=x*C+b*R+_*j+T*V,s[11]=x*I+b*$+_*B+T*H,s[15]=x*A+b*z+_*W+T*K,this}multiplyScalar(e){const n=this.elements;return n[0]*=e,n[4]*=e,n[8]*=e,n[12]*=e,n[1]*=e,n[5]*=e,n[9]*=e,n[13]*=e,n[2]*=e,n[6]*=e,n[10]*=e,n[14]*=e,n[3]*=e,n[7]*=e,n[11]*=e,n[15]*=e,this}determinant(){const e=this.elements,n=e[0],r=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],u=e[2],d=e[6],h=e[10],f=e[14],p=e[3],g=e[7],m=e[11],y=e[15];return p*(+s*l*d-i*c*d-s*o*h+r*c*h+i*o*f-r*l*f)+g*(+n*l*f-n*c*h+s*a*h-i*a*f+i*c*u-s*l*u)+m*(+n*c*d-n*o*f-s*a*d+r*a*f+s*o*u-r*c*u)+y*(-i*o*u-n*l*d+n*o*h+i*a*d-r*a*h+r*l*u)}transpose(){const e=this.elements;let n;return n=e[1],e[1]=e[4],e[4]=n,n=e[2],e[2]=e[8],e[8]=n,n=e[6],e[6]=e[9],e[9]=n,n=e[3],e[3]=e[12],e[12]=n,n=e[7],e[7]=e[13],e[13]=n,n=e[11],e[11]=e[14],e[14]=n,this}setPosition(e,n,r){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=n,i[14]=r),this}invert(){const e=this.elements,n=e[0],r=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],u=e[8],d=e[9],h=e[10],f=e[11],p=e[12],g=e[13],m=e[14],y=e[15],x=d*m*c-g*h*c+g*l*f-o*m*f-d*l*y+o*h*y,b=p*h*c-u*m*c-p*l*f+a*m*f+u*l*y-a*h*y,_=u*g*c-p*d*c+p*o*f-a*g*f-u*o*y+a*d*y,T=p*d*l-u*g*l-p*o*h+a*g*h+u*o*m-a*d*m,E=n*x+r*b+i*_+s*T;if(E===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const C=1/E;return e[0]=x*C,e[1]=(g*h*s-d*m*s-g*i*f+r*m*f+d*i*y-r*h*y)*C,e[2]=(o*m*s-g*l*s+g*i*c-r*m*c-o*i*y+r*l*y)*C,e[3]=(d*l*s-o*h*s-d*i*c+r*h*c+o*i*f-r*l*f)*C,e[4]=b*C,e[5]=(u*m*s-p*h*s+p*i*f-n*m*f-u*i*y+n*h*y)*C,e[6]=(p*l*s-a*m*s-p*i*c+n*m*c+a*i*y-n*l*y)*C,e[7]=(a*h*s-u*l*s+u*i*c-n*h*c-a*i*f+n*l*f)*C,e[8]=_*C,e[9]=(p*d*s-u*g*s-p*r*f+n*g*f+u*r*y-n*d*y)*C,e[10]=(a*g*s-p*o*s+p*r*c-n*g*c-a*r*y+n*o*y)*C,e[11]=(u*o*s-a*d*s-u*r*c+n*d*c+a*r*f-n*o*f)*C,e[12]=T*C,e[13]=(u*g*i-p*d*i+p*r*h-n*g*h-u*r*m+n*d*m)*C,e[14]=(p*o*i-a*g*i-p*r*l+n*g*l+a*r*m-n*o*m)*C,e[15]=(a*d*i-u*o*i+u*r*l-n*d*l-a*r*h+n*o*h)*C,this}scale(e){const n=this.elements,r=e.x,i=e.y,s=e.z;return n[0]*=r,n[4]*=i,n[8]*=s,n[1]*=r,n[5]*=i,n[9]*=s,n[2]*=r,n[6]*=i,n[10]*=s,n[3]*=r,n[7]*=i,n[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],r=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(n,r,i))}makeTranslation(e,n,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,n,0,0,1,r,0,0,0,1),this}makeRotationX(e){const n=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,n,-r,0,0,r,n,0,0,0,0,1),this}makeRotationY(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,0,r,0,0,1,0,0,-r,0,n,0,0,0,0,1),this}makeRotationZ(e){const n=Math.cos(e),r=Math.sin(e);return this.set(n,-r,0,0,r,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,n){const r=Math.cos(n),i=Math.sin(n),s=1-r,a=e.x,o=e.y,l=e.z,c=s*a,u=s*o;return this.set(c*a+r,c*o-i*l,c*l+i*o,0,c*o+i*l,u*o+r,u*l-i*a,0,c*l-i*o,u*l+i*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,n,r){return this.set(e,0,0,0,0,n,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,n,r,i,s,a){return this.set(1,r,s,0,e,1,a,0,n,i,1,0,0,0,0,1),this}compose(e,n,r){const i=this.elements,s=n._x,a=n._y,o=n._z,l=n._w,c=s+s,u=a+a,d=o+o,h=s*c,f=s*u,p=s*d,g=a*u,m=a*d,y=o*d,x=l*c,b=l*u,_=l*d,T=r.x,E=r.y,C=r.z;return i[0]=(1-(g+y))*T,i[1]=(f+_)*T,i[2]=(p-b)*T,i[3]=0,i[4]=(f-_)*E,i[5]=(1-(h+y))*E,i[6]=(m+x)*E,i[7]=0,i[8]=(p+b)*C,i[9]=(m-x)*C,i[10]=(1-(h+g))*C,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,n,r){const i=this.elements;let s=qy.set(i[0],i[1],i[2]).length();const a=qy.set(i[4],i[5],i[6]).length(),o=qy.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),e.x=i[12],e.y=i[13],e.z=i[14],cc.copy(this);const c=1/s,u=1/a,d=1/o;return cc.elements[0]*=c,cc.elements[1]*=c,cc.elements[2]*=c,cc.elements[4]*=u,cc.elements[5]*=u,cc.elements[6]*=u,cc.elements[8]*=d,cc.elements[9]*=d,cc.elements[10]*=d,n.setFromRotationMatrix(cc),r.x=s,r.y=a,r.z=o,this}makePerspective(e,n,r,i,s,a,o=Oc){const l=this.elements,c=2*s/(n-e),u=2*s/(r-i),d=(n+e)/(n-e),h=(r+i)/(r-i);let f,p;if(o===Oc)f=-(a+s)/(a-s),p=-2*a*s/(a-s);else if(o===A0)f=-a/(a-s),p=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=c,l[4]=0,l[8]=d,l[12]=0,l[1]=0,l[5]=u,l[9]=h,l[13]=0,l[2]=0,l[6]=0,l[10]=f,l[14]=p,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,n,r,i,s,a,o=Oc){const l=this.elements,c=1/(n-e),u=1/(r-i),d=1/(a-s),h=(n+e)*c,f=(r+i)*u;let p,g;if(o===Oc)p=(a+s)*d,g=-2*d;else if(o===A0)p=s*d,g=-1*d;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*c,l[4]=0,l[8]=0,l[12]=-h,l[1]=0,l[5]=2*u,l[9]=0,l[13]=-f,l[2]=0,l[6]=0,l[10]=g,l[14]=-p,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){const n=this.elements,r=e.elements;for(let i=0;i<16;i++)if(n[i]!==r[i])return!1;return!0}fromArray(e,n=0){for(let r=0;r<16;r++)this.elements[r]=e[r+n];return this}toArray(e=[],n=0){const r=this.elements;return e[n]=r[0],e[n+1]=r[1],e[n+2]=r[2],e[n+3]=r[3],e[n+4]=r[4],e[n+5]=r[5],e[n+6]=r[6],e[n+7]=r[7],e[n+8]=r[8],e[n+9]=r[9],e[n+10]=r[10],e[n+11]=r[11],e[n+12]=r[12],e[n+13]=r[13],e[n+14]=r[14],e[n+15]=r[15],e}}const qy=new ne,cc=new an,bSt=new ne(0,0,0),wSt=new ne(1,1,1),Bh=new ne,kN=new ne,Oo=new ne,cJ=new an,uJ=new xo;class hE{constructor(e=0,n=0,r=0,i=hE.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=n,this._z=r,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,n,r,i=this._order){return this._x=e,this._y=n,this._z=r,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,n=this._order,r=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],c=i[5],u=i[9],d=i[2],h=i[6],f=i[10];switch(n){case"XYZ":this._y=Math.asin(vi(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-u,f),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(h,c),this._z=0);break;case"YXZ":this._x=Math.asin(-vi(u,-1,1)),Math.abs(u)<.9999999?(this._y=Math.atan2(o,f),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-d,s),this._z=0);break;case"ZXY":this._x=Math.asin(vi(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-vi(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(vi(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-u,c),this._y=Math.atan2(-d,s)):(this._x=0,this._y=Math.atan2(o,f));break;case"XZY":this._z=Math.asin(-vi(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(h,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,n,r){return cJ.makeRotationFromQuaternion(e),this.setFromRotationMatrix(cJ,n,r)}setFromVector3(e,n=this._order){return this.set(e.x,e.y,e.z,n)}reorder(e){return uJ.setFromEuler(this),this.setFromQuaternion(uJ,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],n=0){return e[n]=this._x,e[n+1]=this._y,e[n+2]=this._z,e[n+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}hE.DEFAULT_ORDER="XYZ";class tg{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let SSt=0;const dJ=new ne,Xy=new xo,vd=new an,MN=new ne,Tw=new ne,_St=new ne,TSt=new xo,hJ=new ne(1,0,0),fJ=new ne(0,1,0),pJ=new ne(0,0,1),ESt={type:"added"},CSt={type:"removed"};class tr extends Th{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:SSt++}),this.uuid=Zo(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=tr.DEFAULT_UP.clone();const e=new ne,n=new hE,r=new xo,i=new ne(1,1,1);function s(){r.setFromEuler(n,!1)}function a(){n.setFromQuaternion(r,void 0,!1)}n._onChange(s),r._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new an},normalMatrix:{value:new Tn}}),this.matrix=new an,this.matrixWorld=new an,this.matrixAutoUpdate=tr.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=tr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new tg,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,n){this.quaternion.setFromAxisAngle(e,n)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,n){return Xy.setFromAxisAngle(e,n),this.quaternion.multiply(Xy),this}rotateOnWorldAxis(e,n){return Xy.setFromAxisAngle(e,n),this.quaternion.premultiply(Xy),this}rotateX(e){return this.rotateOnAxis(hJ,e)}rotateY(e){return this.rotateOnAxis(fJ,e)}rotateZ(e){return this.rotateOnAxis(pJ,e)}translateOnAxis(e,n){return dJ.copy(e).applyQuaternion(this.quaternion),this.position.add(dJ.multiplyScalar(n)),this}translateX(e){return this.translateOnAxis(hJ,e)}translateY(e){return this.translateOnAxis(fJ,e)}translateZ(e){return this.translateOnAxis(pJ,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(vd.copy(this.matrixWorld).invert())}lookAt(e,n,r){e.isVector3?MN.copy(e):MN.set(e,n,r);const i=this.parent;this.updateWorldMatrix(!0,!1),Tw.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?vd.lookAt(Tw,MN,this.up):vd.lookAt(MN,Tw,this.up),this.quaternion.setFromRotationMatrix(vd),i&&(vd.extractRotation(i.matrixWorld),Xy.setFromRotationMatrix(vd),this.quaternion.premultiply(Xy.invert()))}add(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ESt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}const n=this.children.indexOf(e);return n!==-1&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(CSt)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),vd.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),vd.multiply(e.parent.matrixWorld)),e.applyMatrix4(vd),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,n){if(this[e]===n)return this;for(let r=0,i=this.children.length;r<i;r++){const a=this.children[r].getObjectByProperty(e,n);if(a!==void 0)return a}}getObjectsByProperty(e,n,r=[]){this[e]===n&&r.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,n,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tw,e,_St),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Tw,TSt,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return e.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(e){e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const n=this.children;for(let r=0,i=n.length;r<i;r++)n[r].traverseVisible(e)}traverseAncestors(e){const n=this.parent;n!==null&&(e(n),n.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const n=this.children;for(let r=0,i=n.length;r<i;r++){const s=n[r];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,n){const r=this.parent;if(e===!0&&r!==null&&r.matrixWorldAutoUpdate===!0&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++){const o=i[s];o.matrixWorldAutoUpdate===!0&&o.updateWorldMatrix(!1,!0)}}}toJSON(e){const n=e===void 0||typeof e=="string",r={};n&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(o=>({boxInitialized:o.boxInitialized,boxMin:o.box.min.toArray(),boxMax:o.box.max.toArray(),sphereInitialized:o.sphereInitialized,sphereRadius:o.sphere.radius,sphereCenter:o.sphere.center.toArray()})),i.maxGeometryCount=this._maxGeometryCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,u=l.length;c<u;c++){const d=l[c];s(e.shapes,d)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(n){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),u=a(e.images),d=a(e.shapes),h=a(e.skeletons),f=a(e.animations),p=a(e.nodes);o.length>0&&(r.geometries=o),l.length>0&&(r.materials=l),c.length>0&&(r.textures=c),u.length>0&&(r.images=u),d.length>0&&(r.shapes=d),h.length>0&&(r.skeletons=h),f.length>0&&(r.animations=f),p.length>0&&(r.nodes=p)}return r.object=i,r;function a(o){const l=[];for(const c in o){const u=o[c];delete u.metadata,l.push(u)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,n=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),n===!0)for(let r=0;r<e.children.length;r++){const i=e.children[r];this.add(i.clone())}return this}}tr.DEFAULT_UP=new ne(0,1,0);tr.DEFAULT_MATRIX_AUTO_UPDATE=!0;tr.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const uc=new ne,xd=new ne,FL=new ne,bd=new ne,Ky=new ne,Yy=new ne,mJ=new ne,jL=new ne,zL=new ne,BL=new ne;let RN=!1;class oo{constructor(e=new ne,n=new ne,r=new ne){this.a=e,this.b=n,this.c=r}static getNormal(e,n,r,i){i.subVectors(r,n),uc.subVectors(e,n),i.cross(uc);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,n,r,i,s){uc.subVectors(i,n),xd.subVectors(r,n),FL.subVectors(e,n);const a=uc.dot(uc),o=uc.dot(xd),l=uc.dot(FL),c=xd.dot(xd),u=xd.dot(FL),d=a*c-o*o;if(d===0)return s.set(0,0,0),null;const h=1/d,f=(c*l-o*u)*h,p=(a*u-o*l)*h;return s.set(1-f-p,p,f)}static containsPoint(e,n,r,i){return this.getBarycoord(e,n,r,i,bd)===null?!1:bd.x>=0&&bd.y>=0&&bd.x+bd.y<=1}static getUV(e,n,r,i,s,a,o,l){return RN===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),RN=!0),this.getInterpolation(e,n,r,i,s,a,o,l)}static getInterpolation(e,n,r,i,s,a,o,l){return this.getBarycoord(e,n,r,i,bd)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,bd.x),l.addScaledVector(a,bd.y),l.addScaledVector(o,bd.z),l)}static isFrontFacing(e,n,r,i){return uc.subVectors(r,n),xd.subVectors(e,n),uc.cross(xd).dot(i)<0}set(e,n,r){return this.a.copy(e),this.b.copy(n),this.c.copy(r),this}setFromPointsAndIndices(e,n,r,i){return this.a.copy(e[n]),this.b.copy(e[r]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,n,r,i){return this.a.fromBufferAttribute(e,n),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return uc.subVectors(this.c,this.b),xd.subVectors(this.a,this.b),uc.cross(xd).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return oo.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,n){return oo.getBarycoord(e,this.a,this.b,this.c,n)}getUV(e,n,r,i,s){return RN===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),RN=!0),oo.getInterpolation(e,this.a,this.b,this.c,n,r,i,s)}getInterpolation(e,n,r,i,s){return oo.getInterpolation(e,this.a,this.b,this.c,n,r,i,s)}containsPoint(e){return oo.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return oo.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,n){const r=this.a,i=this.b,s=this.c;let a,o;Ky.subVectors(i,r),Yy.subVectors(s,r),jL.subVectors(e,r);const l=Ky.dot(jL),c=Yy.dot(jL);if(l<=0&&c<=0)return n.copy(r);zL.subVectors(e,i);const u=Ky.dot(zL),d=Yy.dot(zL);if(u>=0&&d<=u)return n.copy(i);const h=l*d-u*c;if(h<=0&&l>=0&&u<=0)return a=l/(l-u),n.copy(r).addScaledVector(Ky,a);BL.subVectors(e,s);const f=Ky.dot(BL),p=Yy.dot(BL);if(p>=0&&f<=p)return n.copy(s);const g=f*c-l*p;if(g<=0&&c>=0&&p<=0)return o=c/(c-p),n.copy(r).addScaledVector(Yy,o);const m=u*p-f*d;if(m<=0&&d-u>=0&&f-p>=0)return mJ.subVectors(s,i),o=(d-u)/(d-u+(f-p)),n.copy(i).addScaledVector(mJ,o);const y=1/(m+g+h);return a=g*y,o=h*y,n.copy(r).addScaledVector(Ky,a).addScaledVector(Yy,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const tve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Uh={h:0,s:0,l:0},PN={h:0,s:0,l:0};function UL(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*6*(2/3-n):t}class xt{constructor(e,n,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,n,r)}set(e,n,r){if(n===void 0&&r===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,n,r);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,n=rs){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,dr.toWorkingColorSpace(this,n),this}setRGB(e,n,r,i=dr.workingColorSpace){return this.r=e,this.g=n,this.b=r,dr.toWorkingColorSpace(this,i),this}setHSL(e,n,r,i=dr.workingColorSpace){if(e=bG(e,1),n=vi(n,0,1),r=vi(r,0,1),n===0)this.r=this.g=this.b=r;else{const s=r<=.5?r*(1+n):r+n-r*n,a=2*r-s;this.r=UL(a,s,e+1/3),this.g=UL(a,s,e),this.b=UL(a,s,e-1/3)}return dr.toWorkingColorSpace(this,i),this}setStyle(e,n=rs){function r(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,n);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,n);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(a===6)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}setColorName(e,n=rs){const r=tve[e.toLowerCase()];return r!==void 0?this.setHex(r,n):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=yx(e.r),this.g=yx(e.g),this.b=yx(e.b),this}copyLinearToSRGB(e){return this.r=kL(e.r),this.g=kL(e.g),this.b=kL(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=rs){return dr.fromWorkingColorSpace(ia.copy(this),e),Math.round(vi(ia.r*255,0,255))*65536+Math.round(vi(ia.g*255,0,255))*256+Math.round(vi(ia.b*255,0,255))}getHexString(e=rs){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,n=dr.workingColorSpace){dr.fromWorkingColorSpace(ia.copy(this),n);const r=ia.r,i=ia.g,s=ia.b,a=Math.max(r,i,s),o=Math.min(r,i,s);let l,c;const u=(o+a)/2;if(o===a)l=0,c=0;else{const d=a-o;switch(c=u<=.5?d/(a+o):d/(2-a-o),a){case r:l=(i-s)/d+(i<s?6:0);break;case i:l=(s-r)/d+2;break;case s:l=(r-i)/d+4;break}l/=6}return e.h=l,e.s=c,e.l=u,e}getRGB(e,n=dr.workingColorSpace){return dr.fromWorkingColorSpace(ia.copy(this),n),e.r=ia.r,e.g=ia.g,e.b=ia.b,e}getStyle(e=rs){dr.fromWorkingColorSpace(ia.copy(this),e);const n=ia.r,r=ia.g,i=ia.b;return e!==rs?`color(${e} ${n.toFixed(3)} ${r.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(n*255)},${Math.round(r*255)},${Math.round(i*255)})`}offsetHSL(e,n,r){return this.getHSL(Uh),this.setHSL(Uh.h+e,Uh.s+n,Uh.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,n){return this.r=e.r+n.r,this.g=e.g+n.g,this.b=e.b+n.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,n){return this.r+=(e.r-this.r)*n,this.g+=(e.g-this.g)*n,this.b+=(e.b-this.b)*n,this}lerpColors(e,n,r){return this.r=e.r+(n.r-e.r)*r,this.g=e.g+(n.g-e.g)*r,this.b=e.b+(n.b-e.b)*r,this}lerpHSL(e,n){this.getHSL(Uh),e.getHSL(PN);const r=w1(Uh.h,PN.h,n),i=w1(Uh.s,PN.s,n),s=w1(Uh.l,PN.l,n);return this.setHSL(r,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const n=this.r,r=this.g,i=this.b,s=e.elements;return this.r=s[0]*n+s[3]*r+s[6]*i,this.g=s[1]*n+s[4]*r+s[7]*i,this.b=s[2]*n+s[5]*r+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,n=0){return this.r=e[n],this.g=e[n+1],this.b=e[n+2],this}toArray(e=[],n=0){return e[n]=this.r,e[n+1]=this.g,e[n+2]=this.b,e}fromBufferAttribute(e,n){return this.r=e.getX(n),this.g=e.getY(n),this.b=e.getZ(n),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ia=new xt;xt.NAMES=tve;let NSt=0;class _a extends Th{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:NSt++}),this.uuid=Zo(),this.name="",this.type="Material",this.blending=Jm,this.side=dh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=pk,this.blendDst=mk,this.blendEquation=rf,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new xt(0,0,0),this.blendAlpha=0,this.depthFunc=t_,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=H4,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=pm,this.stencilZFail=pm,this.stencilZPass=pm,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const n in e){const r=e[n];if(r===void 0){console.warn(`THREE.Material: parameter '${n}' has value of undefined.`);continue}const i=this[n];if(i===void 0){console.warn(`THREE.Material: '${n}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(r):i&&i.isVector3&&r&&r.isVector3?i.copy(r):this[n]=r}}toJSON(e){const n=e===void 0||typeof e=="string";n&&(e={textures:{},images:{}});const r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),this.roughness!==void 0&&(r.roughness=this.roughness),this.metalness!==void 0&&(r.metalness=this.metalness),this.sheen!==void 0&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(r.shininess=this.shininess),this.clearcoat!==void 0&&(r.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(r.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(r.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(r.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(r.combine=this.combine)),this.envMapIntensity!==void 0&&(r.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(r.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(r.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(r.size=this.size),this.shadowSide!==null&&(r.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==Jm&&(r.blending=this.blending),this.side!==dh&&(r.side=this.side),this.vertexColors===!0&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),this.transparent===!0&&(r.transparent=!0),this.blendSrc!==pk&&(r.blendSrc=this.blendSrc),this.blendDst!==mk&&(r.blendDst=this.blendDst),this.blendEquation!==rf&&(r.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(r.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(r.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(r.blendAlpha=this.blendAlpha),this.depthFunc!==t_&&(r.depthFunc=this.depthFunc),this.depthTest===!1&&(r.depthTest=this.depthTest),this.depthWrite===!1&&(r.depthWrite=this.depthWrite),this.colorWrite===!1&&(r.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(r.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==H4&&(r.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(r.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(r.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==pm&&(r.stencilFail=this.stencilFail),this.stencilZFail!==pm&&(r.stencilZFail=this.stencilZFail),this.stencilZPass!==pm&&(r.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(r.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(r.rotation=this.rotation),this.polygonOffset===!0&&(r.polygonOffset=!0),this.polygonOffsetFactor!==0&&(r.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(r.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(r.linewidth=this.linewidth),this.dashSize!==void 0&&(r.dashSize=this.dashSize),this.gapSize!==void 0&&(r.gapSize=this.gapSize),this.scale!==void 0&&(r.scale=this.scale),this.dithering===!0&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),this.alphaHash===!0&&(r.alphaHash=!0),this.alphaToCoverage===!0&&(r.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(r.premultipliedAlpha=!0),this.forceSinglePass===!0&&(r.forceSinglePass=!0),this.wireframe===!0&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(r.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(r.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(r.flatShading=!0),this.visible===!1&&(r.visible=!1),this.toneMapped===!1&&(r.toneMapped=!1),this.fog===!1&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(n){const s=i(e.textures),a=i(e.images);s.length>0&&(r.textures=s),a.length>0&&(r.images=a)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const n=e.clippingPlanes;let r=null;if(n!==null){const i=n.length;r=new Array(i);for(let s=0;s!==i;++s)r[s]=n[s].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Mp extends _a{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Rd=ASt();function ASt(){const t=new ArrayBuffer(4),e=new Float32Array(t),n=new Uint32Array(t),r=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(r[l]=0,r[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(r[l]=1024>>-c-14,r[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(r[l]=c+15<<10,r[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(r[l]=31744,r[l|256]=64512,i[l]=24,i[l|256]=24):(r[l]=31744,r[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,u=0;for(;!(c&8388608);)c<<=1,u-=8388608;c&=-8388609,u+=947912704,s[l]=c|u}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:n,baseTable:r,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function to(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=vi(t,-65504,65504),Rd.floatView[0]=t;const e=Rd.uint32View[0],n=e>>23&511;return Rd.baseTable[n]+((e&8388607)>>Rd.shiftTable[n])}function Qw(t){const e=t>>10;return Rd.uint32View[0]=Rd.mantissaTable[Rd.offsetTable[e]+(t&1023)]+Rd.exponentTable[e],Rd.floatView[0]}const ISt={toHalfFloat:to,fromHalfFloat:Qw},ji=new ne,ON=new Xe;class mr{constructor(e,n,r=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=n,this.count=e!==void 0?e.length/n:0,this.normalized=r,this.usage=h_,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=Pc,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,n,r){e*=this.itemSize,r*=n.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=n.array[r+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let n=0,r=this.count;n<r;n++)ON.fromBufferAttribute(this,n),ON.applyMatrix3(e),this.setXY(n,ON.x,ON.y);else if(this.itemSize===3)for(let n=0,r=this.count;n<r;n++)ji.fromBufferAttribute(this,n),ji.applyMatrix3(e),this.setXYZ(n,ji.x,ji.y,ji.z);return this}applyMatrix4(e){for(let n=0,r=this.count;n<r;n++)ji.fromBufferAttribute(this,n),ji.applyMatrix4(e),this.setXYZ(n,ji.x,ji.y,ji.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)ji.fromBufferAttribute(this,n),ji.applyNormalMatrix(e),this.setXYZ(n,ji.x,ji.y,ji.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)ji.fromBufferAttribute(this,n),ji.transformDirection(e),this.setXYZ(n,ji.x,ji.y,ji.z);return this}set(e,n=0){return this.array.set(e,n),this}getComponent(e,n){let r=this.array[e*this.itemSize+n];return this.normalized&&(r=co(r,this.array)),r}setComponent(e,n,r){return this.normalized&&(r=bn(r,this.array)),this.array[e*this.itemSize+n]=r,this}getX(e){let n=this.array[e*this.itemSize];return this.normalized&&(n=co(n,this.array)),n}setX(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize]=n,this}getY(e){let n=this.array[e*this.itemSize+1];return this.normalized&&(n=co(n,this.array)),n}setY(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+1]=n,this}getZ(e){let n=this.array[e*this.itemSize+2];return this.normalized&&(n=co(n,this.array)),n}setZ(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+2]=n,this}getW(e){let n=this.array[e*this.itemSize+3];return this.normalized&&(n=co(n,this.array)),n}setW(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+3]=n,this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array)),this.array[e+0]=n,this.array[e+1]=r,this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this}setXYZW(e,n,r,i,s){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array),s=bn(s,this.array)),this.array[e+0]=n,this.array[e+1]=r,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==h_&&(e.usage=this.usage),e}}class kSt extends mr{constructor(e,n,r){super(new Int8Array(e),n,r)}}class MSt extends mr{constructor(e,n,r){super(new Uint8Array(e),n,r)}}class RSt extends mr{constructor(e,n,r){super(new Uint8ClampedArray(e),n,r)}}class PSt extends mr{constructor(e,n,r){super(new Int16Array(e),n,r)}}class _G extends mr{constructor(e,n,r){super(new Uint16Array(e),n,r)}}class OSt extends mr{constructor(e,n,r){super(new Int32Array(e),n,r)}}class TG extends mr{constructor(e,n,r){super(new Uint32Array(e),n,r)}}class DSt extends mr{constructor(e,n,r){super(new Uint16Array(e),n,r),this.isFloat16BufferAttribute=!0}getX(e){let n=Qw(this.array[e*this.itemSize]);return this.normalized&&(n=co(n,this.array)),n}setX(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize]=to(n),this}getY(e){let n=Qw(this.array[e*this.itemSize+1]);return this.normalized&&(n=co(n,this.array)),n}setY(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+1]=to(n),this}getZ(e){let n=Qw(this.array[e*this.itemSize+2]);return this.normalized&&(n=co(n,this.array)),n}setZ(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+2]=to(n),this}getW(e){let n=Qw(this.array[e*this.itemSize+3]);return this.normalized&&(n=co(n,this.array)),n}setW(e,n){return this.normalized&&(n=bn(n,this.array)),this.array[e*this.itemSize+3]=to(n),this}setXY(e,n,r){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array)),this.array[e+0]=to(n),this.array[e+1]=to(r),this}setXYZ(e,n,r,i){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array)),this.array[e+0]=to(n),this.array[e+1]=to(r),this.array[e+2]=to(i),this}setXYZW(e,n,r,i,s){return e*=this.itemSize,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array),s=bn(s,this.array)),this.array[e+0]=to(n),this.array[e+1]=to(r),this.array[e+2]=to(i),this.array[e+3]=to(s),this}}class Mt extends mr{constructor(e,n,r){super(new Float32Array(e),n,r)}}class $St extends mr{constructor(e,n,r){super(new Float64Array(e),n,r)}}let LSt=0;const wl=new an,VL=new tr,Zy=new ne,Do=new Va,Ew=new Va,ws=new ne;class Cn extends Th{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:LSt++}),this.uuid=Zo(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(Qye(e)?TG:_G)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,n){return this.attributes[e]=n,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,n,r=0){this.groups.push({start:e,count:n,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,n){this.drawRange.start=e,this.drawRange.count=n}applyMatrix4(e){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(e),n.needsUpdate=!0);const r=this.attributes.normal;if(r!==void 0){const s=new Tn().getNormalMatrix(e);r.applyNormalMatrix(s),r.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return wl.makeRotationFromQuaternion(e),this.applyMatrix4(wl),this}rotateX(e){return wl.makeRotationX(e),this.applyMatrix4(wl),this}rotateY(e){return wl.makeRotationY(e),this.applyMatrix4(wl),this}rotateZ(e){return wl.makeRotationZ(e),this.applyMatrix4(wl),this}translate(e,n,r){return wl.makeTranslation(e,n,r),this.applyMatrix4(wl),this}scale(e,n,r){return wl.makeScale(e,n,r),this.applyMatrix4(wl),this}lookAt(e){return VL.lookAt(e),VL.updateMatrix(),this.applyMatrix4(VL.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zy).negate(),this.translate(Zy.x,Zy.y,Zy.z),this}setFromPoints(e){const n=[];for(let r=0,i=e.length;r<i;r++){const s=e[r];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new Mt(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Va);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new ne(-1/0,-1/0,-1/0),new ne(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),n)for(let r=0,i=n.length;r<i;r++){const s=n[r];Do.setFromBufferAttribute(s),this.morphTargetsRelative?(ws.addVectors(this.boundingBox.min,Do.min),this.boundingBox.expandByPoint(ws),ws.addVectors(this.boundingBox.max,Do.max),this.boundingBox.expandByPoint(ws)):(this.boundingBox.expandByPoint(Do.min),this.boundingBox.expandByPoint(Do.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ga);const e=this.attributes.position,n=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new ne,1/0);return}if(e){const r=this.boundingSphere.center;if(Do.setFromBufferAttribute(e),n)for(let s=0,a=n.length;s<a;s++){const o=n[s];Ew.setFromBufferAttribute(o),this.morphTargetsRelative?(ws.addVectors(Do.min,Ew.min),Do.expandByPoint(ws),ws.addVectors(Do.max,Ew.max),Do.expandByPoint(ws)):(Do.expandByPoint(Ew.min),Do.expandByPoint(Ew.max))}Do.getCenter(r);let i=0;for(let s=0,a=e.count;s<a;s++)ws.fromBufferAttribute(e,s),i=Math.max(i,r.distanceToSquared(ws));if(n)for(let s=0,a=n.length;s<a;s++){const o=n[s],l=this.morphTargetsRelative;for(let c=0,u=o.count;c<u;c++)ws.fromBufferAttribute(o,c),l&&(Zy.fromBufferAttribute(e,c),ws.add(Zy)),i=Math.max(i,r.distanceToSquared(ws))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,n=this.attributes;if(e===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const r=e.array,i=n.position.array,s=n.normal.array,a=n.uv.array,o=i.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new mr(new Float32Array(4*o),4));const l=this.getAttribute("tangent").array,c=[],u=[];for(let k=0;k<o;k++)c[k]=new ne,u[k]=new ne;const d=new ne,h=new ne,f=new ne,p=new Xe,g=new Xe,m=new Xe,y=new ne,x=new ne;function b(k,R,$){d.fromArray(i,k*3),h.fromArray(i,R*3),f.fromArray(i,$*3),p.fromArray(a,k*2),g.fromArray(a,R*2),m.fromArray(a,$*2),h.sub(d),f.sub(d),g.sub(p),m.sub(p);const z=1/(g.x*m.y-m.x*g.y);isFinite(z)&&(y.copy(h).multiplyScalar(m.y).addScaledVector(f,-g.y).multiplyScalar(z),x.copy(f).multiplyScalar(g.x).addScaledVector(h,-m.x).multiplyScalar(z),c[k].add(y),c[R].add(y),c[$].add(y),u[k].add(x),u[R].add(x),u[$].add(x))}let _=this.groups;_.length===0&&(_=[{start:0,count:r.length}]);for(let k=0,R=_.length;k<R;++k){const $=_[k],z=$.start,O=$.count;for(let j=z,B=z+O;j<B;j+=3)b(r[j+0],r[j+1],r[j+2])}const T=new ne,E=new ne,C=new ne,I=new ne;function A(k){C.fromArray(s,k*3),I.copy(C);const R=c[k];T.copy(R),T.sub(C.multiplyScalar(C.dot(R))).normalize(),E.crossVectors(I,R);const z=E.dot(u[k])<0?-1:1;l[k*4]=T.x,l[k*4+1]=T.y,l[k*4+2]=T.z,l[k*4+3]=z}for(let k=0,R=_.length;k<R;++k){const $=_[k],z=$.start,O=$.count;for(let j=z,B=z+O;j<B;j+=3)A(r[j+0]),A(r[j+1]),A(r[j+2])}}computeVertexNormals(){const e=this.index,n=this.getAttribute("position");if(n!==void 0){let r=this.getAttribute("normal");if(r===void 0)r=new mr(new Float32Array(n.count*3),3),this.setAttribute("normal",r);else for(let h=0,f=r.count;h<f;h++)r.setXYZ(h,0,0,0);const i=new ne,s=new ne,a=new ne,o=new ne,l=new ne,c=new ne,u=new ne,d=new ne;if(e)for(let h=0,f=e.count;h<f;h+=3){const p=e.getX(h+0),g=e.getX(h+1),m=e.getX(h+2);i.fromBufferAttribute(n,p),s.fromBufferAttribute(n,g),a.fromBufferAttribute(n,m),u.subVectors(a,s),d.subVectors(i,s),u.cross(d),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,g),c.fromBufferAttribute(r,m),o.add(u),l.add(u),c.add(u),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(g,l.x,l.y,l.z),r.setXYZ(m,c.x,c.y,c.z)}else for(let h=0,f=n.count;h<f;h+=3)i.fromBufferAttribute(n,h+0),s.fromBufferAttribute(n,h+1),a.fromBufferAttribute(n,h+2),u.subVectors(a,s),d.subVectors(i,s),u.cross(d),r.setXYZ(h+0,u.x,u.y,u.z),r.setXYZ(h+1,u.x,u.y,u.z),r.setXYZ(h+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let n=0,r=e.count;n<r;n++)ws.fromBufferAttribute(e,n),ws.normalize(),e.setXYZ(n,ws.x,ws.y,ws.z)}toNonIndexed(){function e(o,l){const c=o.array,u=o.itemSize,d=o.normalized,h=new c.constructor(l.length*u);let f=0,p=0;for(let g=0,m=l.length;g<m;g++){o.isInterleavedBufferAttribute?f=l[g]*o.data.stride+o.offset:f=l[g]*u;for(let y=0;y<u;y++)h[p++]=c[f++]}return new mr(h,u,d)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Cn,r=this.index.array,i=this.attributes;for(const o in i){const l=i[o],c=e(l,r);n.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let u=0,d=c.length;u<d;u++){const h=c[u],f=e(h,r);l.push(f)}n.morphAttributes[o]=l}n.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];n.addGroup(c.start,c.count,c.materialIndex)}return n}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const n=this.index;n!==null&&(e.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const r=this.attributes;for(const l in r){const c=r[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],u=[];for(let d=0,h=c.length;d<h;d++){const f=c[d];u.push(f.toJSON(e.data))}u.length>0&&(i[l]=u,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=e.name;const r=e.index;r!==null&&this.setIndex(r.clone(n));const i=e.attributes;for(const c in i){const u=i[c];this.setAttribute(c,u.clone(n))}const s=e.morphAttributes;for(const c in s){const u=[],d=s[c];for(let h=0,f=d.length;h<f;h++)u.push(d[h].clone(n));this.morphAttributes[c]=u}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,u=a.length;c<u;c++){const d=a[c];this.addGroup(d.start,d.count,d.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const gJ=new an,Kp=new Tb,DN=new ga,yJ=new ne,Qy=new ne,Jy=new ne,ev=new ne,WL=new ne,$N=new ne,LN=new Xe,FN=new Xe,jN=new Xe,vJ=new ne,xJ=new ne,bJ=new ne,zN=new ne,BN=new ne;class ls extends tr{constructor(e=new Cn,n=new Mp){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,n){const r=this.geometry,i=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;n.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){$N.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const u=o[l],d=s[l];u!==0&&(WL.fromBufferAttribute(d,e),a?$N.addScaledVector(WL,u):$N.addScaledVector(WL.sub(n),u))}n.add($N)}return n}raycast(e,n){const r=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(r.boundingSphere===null&&r.computeBoundingSphere(),DN.copy(r.boundingSphere),DN.applyMatrix4(s),Kp.copy(e.ray).recast(e.near),!(DN.containsPoint(Kp.origin)===!1&&(Kp.intersectSphere(DN,yJ)===null||Kp.origin.distanceToSquared(yJ)>(e.far-e.near)**2))&&(gJ.copy(s).invert(),Kp.copy(e.ray).applyMatrix4(gJ),!(r.boundingBox!==null&&Kp.intersectsBox(r.boundingBox)===!1)&&this._computeIntersections(e,n,Kp)))}_computeIntersections(e,n,r){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,u=s.attributes.uv1,d=s.attributes.normal,h=s.groups,f=s.drawRange;if(o!==null)if(Array.isArray(a))for(let p=0,g=h.length;p<g;p++){const m=h[p],y=a[m.materialIndex],x=Math.max(m.start,f.start),b=Math.min(o.count,Math.min(m.start+m.count,f.start+f.count));for(let _=x,T=b;_<T;_+=3){const E=o.getX(_),C=o.getX(_+1),I=o.getX(_+2);i=UN(this,y,e,r,c,u,d,E,C,I),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=m.materialIndex,n.push(i))}}else{const p=Math.max(0,f.start),g=Math.min(o.count,f.start+f.count);for(let m=p,y=g;m<y;m+=3){const x=o.getX(m),b=o.getX(m+1),_=o.getX(m+2);i=UN(this,a,e,r,c,u,d,x,b,_),i&&(i.faceIndex=Math.floor(m/3),n.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let p=0,g=h.length;p<g;p++){const m=h[p],y=a[m.materialIndex],x=Math.max(m.start,f.start),b=Math.min(l.count,Math.min(m.start+m.count,f.start+f.count));for(let _=x,T=b;_<T;_+=3){const E=_,C=_+1,I=_+2;i=UN(this,y,e,r,c,u,d,E,C,I),i&&(i.faceIndex=Math.floor(_/3),i.face.materialIndex=m.materialIndex,n.push(i))}}else{const p=Math.max(0,f.start),g=Math.min(l.count,f.start+f.count);for(let m=p,y=g;m<y;m+=3){const x=m,b=m+1,_=m+2;i=UN(this,a,e,r,c,u,d,x,b,_),i&&(i.faceIndex=Math.floor(m/3),n.push(i))}}}}function FSt(t,e,n,r,i,s,a,o){let l;if(e.side===Ua?l=r.intersectTriangle(a,s,i,!0,o):l=r.intersectTriangle(i,s,a,e.side===dh,o),l===null)return null;BN.copy(o),BN.applyMatrix4(t.matrixWorld);const c=n.ray.origin.distanceTo(BN);return c<n.near||c>n.far?null:{distance:c,point:BN.clone(),object:t}}function UN(t,e,n,r,i,s,a,o,l,c){t.getVertexPosition(o,Qy),t.getVertexPosition(l,Jy),t.getVertexPosition(c,ev);const u=FSt(t,e,n,r,Qy,Jy,ev,zN);if(u){i&&(LN.fromBufferAttribute(i,o),FN.fromBufferAttribute(i,l),jN.fromBufferAttribute(i,c),u.uv=oo.getInterpolation(zN,Qy,Jy,ev,LN,FN,jN,new Xe)),s&&(LN.fromBufferAttribute(s,o),FN.fromBufferAttribute(s,l),jN.fromBufferAttribute(s,c),u.uv1=oo.getInterpolation(zN,Qy,Jy,ev,LN,FN,jN,new Xe),u.uv2=u.uv1),a&&(vJ.fromBufferAttribute(a,o),xJ.fromBufferAttribute(a,l),bJ.fromBufferAttribute(a,c),u.normal=oo.getInterpolation(zN,Qy,Jy,ev,vJ,xJ,bJ,new ne),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));const d={a:o,b:l,c,normal:new ne,materialIndex:0};oo.getNormal(Qy,Jy,ev,d.normal),u.face=d}return u}class ly extends Cn{constructor(e=1,n=1,r=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:n,depth:r,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],u=[],d=[];let h=0,f=0;p("z","y","x",-1,-1,r,n,e,a,s,0),p("z","y","x",1,-1,r,n,-e,a,s,1),p("x","z","y",1,1,e,r,n,i,a,2),p("x","z","y",1,-1,e,r,-n,i,a,3),p("x","y","z",1,-1,e,n,r,i,s,4),p("x","y","z",-1,-1,e,n,-r,i,s,5),this.setIndex(l),this.setAttribute("position",new Mt(c,3)),this.setAttribute("normal",new Mt(u,3)),this.setAttribute("uv",new Mt(d,2));function p(g,m,y,x,b,_,T,E,C,I,A){const k=_/C,R=T/I,$=_/2,z=T/2,O=E/2,j=C+1,B=I+1;let W=0,L=0;const V=new ne;for(let H=0;H<B;H++){const K=H*R-z;for(let te=0;te<j;te++){const J=te*k-$;V[g]=J*x,V[m]=K*b,V[y]=O,c.push(V.x,V.y,V.z),V[g]=0,V[m]=0,V[y]=E>0?1:-1,u.push(V.x,V.y,V.z),d.push(te/C),d.push(1-H/I),W+=1}}for(let H=0;H<I;H++)for(let K=0;K<C;K++){const te=h+K+j*H,J=h+K+j*(H+1),oe=h+(K+1)+j*(H+1),fe=h+(K+1)+j*H;l.push(te,J,fe),l.push(J,oe,fe),L+=6}o.addGroup(f,L,A),f+=L,h+=W}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ly(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function k0(t){const e={};for(const n in t){e[n]={};for(const r in t[n]){const i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[n][r]=null):e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}function Aa(t){const e={};for(let n=0;n<t.length;n++){const r=k0(t[n]);for(const i in r)e[i]=r[i]}return e}function jSt(t){const e=[];for(let n=0;n<t.length;n++)e.push(t[n].clone());return e}function nve(t){return t.getRenderTarget()===null?t.outputColorSpace:dr.workingColorSpace}const rve={clone:k0,merge:Aa};var zSt=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,BSt=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ju extends _a{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=zSt,this.fragmentShader=BSt,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=k0(e.uniforms),this.uniformsGroups=jSt(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const n=super.toJSON(e);n.glslVersion=this.glslVersion,n.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?n.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[i]={type:"m4",value:a.toArray()}:n.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;const r={};for(const i in this.extensions)this.extensions[i]===!0&&(r[i]=!0);return Object.keys(r).length>0&&(n.extensions=r),n}}class fE extends tr{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new an,this.projectionMatrix=new an,this.projectionMatrixInverse=new an,this.coordinateSystem=Oc}copy(e,n){return super.copy(e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,n){super.updateWorldMatrix(e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Ts extends fE{constructor(e=50,n=1,r=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=i,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const n=.5*this.getFilmHeight()/e;this.fov=I0*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(eg*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return I0*2*Math.atan(Math.tan(eg*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,n,r,i,s,a){this.aspect=e/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let n=e*Math.tan(eg*.5*this.fov)/this.zoom,r=2*n,i=this.aspect*r,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*i/l,n-=a.offsetY*r/c,i*=a.width/l,r*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,n,n-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const tv=-90,nv=1;class ive extends tr{constructor(e,n,r){super(),this.type="CubeCamera",this.renderTarget=r,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Ts(tv,nv,e,n);i.layers=this.layers,this.add(i);const s=new Ts(tv,nv,e,n);s.layers=this.layers,this.add(s);const a=new Ts(tv,nv,e,n);a.layers=this.layers,this.add(a);const o=new Ts(tv,nv,e,n);o.layers=this.layers,this.add(o);const l=new Ts(tv,nv,e,n);l.layers=this.layers,this.add(l);const c=new Ts(tv,nv,e,n);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,n=this.children.concat(),[r,i,s,a,o,l]=n;for(const c of n)this.remove(c);if(e===Oc)r.up.set(0,1,0),r.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===A0)r.up.set(0,-1,0),r.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of n)this.add(c),c.updateMatrixWorld()}update(e,n){this.parent===null&&this.updateMatrixWorld();const{renderTarget:r,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,u]=this.children,d=e.getRenderTarget(),h=e.getActiveCubeFace(),f=e.getActiveMipmapLevel(),p=e.xr.enabled;e.xr.enabled=!1;const g=r.texture.generateMipmaps;r.texture.generateMipmaps=!1,e.setRenderTarget(r,0,i),e.render(n,s),e.setRenderTarget(r,1,i),e.render(n,a),e.setRenderTarget(r,2,i),e.render(n,o),e.setRenderTarget(r,3,i),e.render(n,l),e.setRenderTarget(r,4,i),e.render(n,c),r.texture.generateMipmaps=g,e.setRenderTarget(r,5,i),e.render(n,u),e.setRenderTarget(d,h,f),e.xr.enabled=p,r.texture.needsPMREMUpdate=!0}}class pE extends $i{constructor(e,n,r,i,s,a,o,l,c,u){e=e!==void 0?e:[],n=n!==void 0?n:hh,super(e,n,r,i,s,a,o,l,c,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class sve extends Kc{constructor(e=1,n={}){super(e,e,n),this.isWebGLCubeRenderTarget=!0;const r={width:e,height:e,depth:1},i=[r,r,r,r,r,r];n.encoding!==void 0&&(S1("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),n.colorSpace=n.encoding===Df?rs:Wo),this.texture=new pE(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Ri}fromEquirectangularTexture(e,n){this.texture.type=n.type,this.texture.colorSpace=n.colorSpace,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const r={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new ly(5,5,5),s=new Ju({name:"CubemapFromEquirect",uniforms:k0(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader,side:Ua,blending:Xd});s.uniforms.tEquirect.value=n;const a=new ls(i,s),o=n.minFilter;return n.minFilter===tp&&(n.minFilter=Ri),new ive(1,10,this).update(e,a),n.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,n,r,i){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(n,r,i);e.setRenderTarget(s)}}const HL=new ne,USt=new ne,VSt=new Tn;class Qh{constructor(e=new ne(1,0,0),n=0){this.isPlane=!0,this.normal=e,this.constant=n}set(e,n){return this.normal.copy(e),this.constant=n,this}setComponents(e,n,r,i){return this.normal.set(e,n,r),this.constant=i,this}setFromNormalAndCoplanarPoint(e,n){return this.normal.copy(e),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(e,n,r){const i=HL.subVectors(r,n).cross(USt.subVectors(e,n)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,n){return n.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,n){const r=e.delta(HL),i=this.normal.dot(r);if(i===0)return this.distanceToPoint(e.start)===0?n.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:n.copy(e.start).addScaledVector(r,s)}intersectsLine(e){const n=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return n<0&&r>0||r<0&&n>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,n){const r=n||VSt.getNormalMatrix(e),i=this.coplanarPoint(HL).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Yp=new ga,VN=new ne;class mE{constructor(e=new Qh,n=new Qh,r=new Qh,i=new Qh,s=new Qh,a=new Qh){this.planes=[e,n,r,i,s,a]}set(e,n,r,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(n),o[2].copy(r),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const n=this.planes;for(let r=0;r<6;r++)n[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,n=Oc){const r=this.planes,i=e.elements,s=i[0],a=i[1],o=i[2],l=i[3],c=i[4],u=i[5],d=i[6],h=i[7],f=i[8],p=i[9],g=i[10],m=i[11],y=i[12],x=i[13],b=i[14],_=i[15];if(r[0].setComponents(l-s,h-c,m-f,_-y).normalize(),r[1].setComponents(l+s,h+c,m+f,_+y).normalize(),r[2].setComponents(l+a,h+u,m+p,_+x).normalize(),r[3].setComponents(l-a,h-u,m-p,_-x).normalize(),r[4].setComponents(l-o,h-d,m-g,_-b).normalize(),n===Oc)r[5].setComponents(l+o,h+d,m+g,_+b).normalize();else if(n===A0)r[5].setComponents(o,d,g,b).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+n);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Yp.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const n=e.geometry;n.boundingSphere===null&&n.computeBoundingSphere(),Yp.copy(n.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Yp)}intersectsSprite(e){return Yp.center.set(0,0,0),Yp.radius=.7071067811865476,Yp.applyMatrix4(e.matrixWorld),this.intersectsSphere(Yp)}intersectsSphere(e){const n=this.planes,r=e.center,i=-e.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(r)<i)return!1;return!0}intersectsBox(e){const n=this.planes;for(let r=0;r<6;r++){const i=n[r];if(VN.x=i.normal.x>0?e.max.x:e.min.x,VN.y=i.normal.y>0?e.max.y:e.min.y,VN.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(VN)<0)return!1}return!0}containsPoint(e){const n=this.planes;for(let r=0;r<6;r++)if(n[r].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function ave(){let t=null,e=!1,n=null,r=null;function i(s,a){n(s,a),r=t.requestAnimationFrame(i)}return{start:function(){e!==!0&&n!==null&&(r=t.requestAnimationFrame(i),e=!0)},stop:function(){t.cancelAnimationFrame(r),e=!1},setAnimationLoop:function(s){n=s},setContext:function(s){t=s}}}function WSt(t,e){const n=e.isWebGL2,r=new WeakMap;function i(c,u){const d=c.array,h=c.usage,f=d.byteLength,p=t.createBuffer();t.bindBuffer(u,p),t.bufferData(u,d,h),c.onUploadCallback();let g;if(d instanceof Float32Array)g=t.FLOAT;else if(d instanceof Uint16Array)if(c.isFloat16BufferAttribute)if(n)g=t.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else g=t.UNSIGNED_SHORT;else if(d instanceof Int16Array)g=t.SHORT;else if(d instanceof Uint32Array)g=t.UNSIGNED_INT;else if(d instanceof Int32Array)g=t.INT;else if(d instanceof Int8Array)g=t.BYTE;else if(d instanceof Uint8Array)g=t.UNSIGNED_BYTE;else if(d instanceof Uint8ClampedArray)g=t.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+d);return{buffer:p,type:g,bytesPerElement:d.BYTES_PER_ELEMENT,version:c.version,size:f}}function s(c,u,d){const h=u.array,f=u._updateRange,p=u.updateRanges;if(t.bindBuffer(d,c),f.count===-1&&p.length===0&&t.bufferSubData(d,0,h),p.length!==0){for(let g=0,m=p.length;g<m;g++){const y=p[g];n?t.bufferSubData(d,y.start*h.BYTES_PER_ELEMENT,h,y.start,y.count):t.bufferSubData(d,y.start*h.BYTES_PER_ELEMENT,h.subarray(y.start,y.start+y.count))}u.clearUpdateRanges()}f.count!==-1&&(n?t.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h,f.offset,f.count):t.bufferSubData(d,f.offset*h.BYTES_PER_ELEMENT,h.subarray(f.offset,f.offset+f.count)),f.count=-1),u.onUploadCallback()}function a(c){return c.isInterleavedBufferAttribute&&(c=c.data),r.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);const u=r.get(c);u&&(t.deleteBuffer(u.buffer),r.delete(c))}function l(c,u){if(c.isGLBufferAttribute){const h=r.get(c);(!h||h.version<c.version)&&r.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}c.isInterleavedBufferAttribute&&(c=c.data);const d=r.get(c);if(d===void 0)r.set(c,i(c,u));else if(d.version<c.version){if(d.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(d.buffer,c,u),d.version=c.version}}return{get:a,remove:o,update:l}}class gE extends Cn{constructor(e=1,n=1,r=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:n,widthSegments:r,heightSegments:i};const s=e/2,a=n/2,o=Math.floor(r),l=Math.floor(i),c=o+1,u=l+1,d=e/o,h=n/l,f=[],p=[],g=[],m=[];for(let y=0;y<u;y++){const x=y*h-a;for(let b=0;b<c;b++){const _=b*d-s;p.push(_,-x,0),g.push(0,0,1),m.push(b/o),m.push(1-y/l)}}for(let y=0;y<l;y++)for(let x=0;x<o;x++){const b=x+c*y,_=x+c*(y+1),T=x+1+c*(y+1),E=x+1+c*y;f.push(b,_,E),f.push(_,T,E)}this.setIndex(f),this.setAttribute("position",new Mt(p,3)),this.setAttribute("normal",new Mt(g,3)),this.setAttribute("uv",new Mt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gE(e.width,e.height,e.widthSegments,e.heightSegments)}}var HSt=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,GSt=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,qSt=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,XSt=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,KSt=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,YSt=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,ZSt=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,QSt=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,JSt=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,e_t=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,t_t=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,n_t=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,r_t=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,i_t=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,s_t=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,a_t=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,o_t=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,l_t=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,c_t=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,u_t=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,d_t=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,h_t=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,f_t=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,p_t=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,m_t=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,g_t=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,y_t=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,v_t=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,x_t=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,b_t=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,w_t="gl_FragColor = linearToOutputTexel( gl_FragColor );",S_t=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,__t=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,T_t=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,E_t=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,C_t=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,N_t=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,A_t=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,I_t=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,k_t=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,M_t=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,R_t=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,P_t=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,O_t=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,D_t=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,$_t=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,L_t=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,F_t=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,j_t=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,z_t=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,B_t=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,U_t=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,V_t=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,W_t=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,H_t=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,G_t=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,q_t=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,X_t=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,K_t=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Y_t=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Z_t=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,Q_t=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,J_t=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,eTt=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,tTt=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,nTt=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,rTt=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,iTt=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,sTt=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,aTt=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,oTt=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,lTt=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,cTt=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,uTt=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,dTt=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,hTt=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,fTt=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,pTt=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,mTt=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,gTt=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,yTt=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,vTt=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,xTt=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,bTt=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,wTt=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,STt=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,_Tt=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,TTt=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ETt=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,CTt=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,NTt=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,ATt=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,ITt=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,kTt=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,MTt=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,RTt=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,PTt=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,OTt=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,DTt=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,$Tt=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,LTt=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,FTt=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,jTt=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,zTt=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,BTt=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,UTt=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,VTt=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const WTt=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,HTt=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,GTt=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,qTt=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,XTt=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,KTt=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,YTt=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ZTt=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,QTt=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,JTt=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,eEt=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,tEt=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nEt=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,rEt=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,iEt=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,sEt=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,aEt=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,oEt=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,lEt=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,cEt=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,uEt=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,dEt=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,hEt=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,fEt=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pEt=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,mEt=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gEt=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,yEt=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,vEt=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,xEt=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,bEt=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wEt=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,SEt=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,_Et=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,xn={alphahash_fragment:HSt,alphahash_pars_fragment:GSt,alphamap_fragment:qSt,alphamap_pars_fragment:XSt,alphatest_fragment:KSt,alphatest_pars_fragment:YSt,aomap_fragment:ZSt,aomap_pars_fragment:QSt,batching_pars_vertex:JSt,batching_vertex:e_t,begin_vertex:t_t,beginnormal_vertex:n_t,bsdfs:r_t,iridescence_fragment:i_t,bumpmap_pars_fragment:s_t,clipping_planes_fragment:a_t,clipping_planes_pars_fragment:o_t,clipping_planes_pars_vertex:l_t,clipping_planes_vertex:c_t,color_fragment:u_t,color_pars_fragment:d_t,color_pars_vertex:h_t,color_vertex:f_t,common:p_t,cube_uv_reflection_fragment:m_t,defaultnormal_vertex:g_t,displacementmap_pars_vertex:y_t,displacementmap_vertex:v_t,emissivemap_fragment:x_t,emissivemap_pars_fragment:b_t,colorspace_fragment:w_t,colorspace_pars_fragment:S_t,envmap_fragment:__t,envmap_common_pars_fragment:T_t,envmap_pars_fragment:E_t,envmap_pars_vertex:C_t,envmap_physical_pars_fragment:F_t,envmap_vertex:N_t,fog_vertex:A_t,fog_pars_vertex:I_t,fog_fragment:k_t,fog_pars_fragment:M_t,gradientmap_pars_fragment:R_t,lightmap_fragment:P_t,lightmap_pars_fragment:O_t,lights_lambert_fragment:D_t,lights_lambert_pars_fragment:$_t,lights_pars_begin:L_t,lights_toon_fragment:j_t,lights_toon_pars_fragment:z_t,lights_phong_fragment:B_t,lights_phong_pars_fragment:U_t,lights_physical_fragment:V_t,lights_physical_pars_fragment:W_t,lights_fragment_begin:H_t,lights_fragment_maps:G_t,lights_fragment_end:q_t,logdepthbuf_fragment:X_t,logdepthbuf_pars_fragment:K_t,logdepthbuf_pars_vertex:Y_t,logdepthbuf_vertex:Z_t,map_fragment:Q_t,map_pars_fragment:J_t,map_particle_fragment:eTt,map_particle_pars_fragment:tTt,metalnessmap_fragment:nTt,metalnessmap_pars_fragment:rTt,morphcolor_vertex:iTt,morphnormal_vertex:sTt,morphtarget_pars_vertex:aTt,morphtarget_vertex:oTt,normal_fragment_begin:lTt,normal_fragment_maps:cTt,normal_pars_fragment:uTt,normal_pars_vertex:dTt,normal_vertex:hTt,normalmap_pars_fragment:fTt,clearcoat_normal_fragment_begin:pTt,clearcoat_normal_fragment_maps:mTt,clearcoat_pars_fragment:gTt,iridescence_pars_fragment:yTt,opaque_fragment:vTt,packing:xTt,premultiplied_alpha_fragment:bTt,project_vertex:wTt,dithering_fragment:STt,dithering_pars_fragment:_Tt,roughnessmap_fragment:TTt,roughnessmap_pars_fragment:ETt,shadowmap_pars_fragment:CTt,shadowmap_pars_vertex:NTt,shadowmap_vertex:ATt,shadowmask_pars_fragment:ITt,skinbase_vertex:kTt,skinning_pars_vertex:MTt,skinning_vertex:RTt,skinnormal_vertex:PTt,specularmap_fragment:OTt,specularmap_pars_fragment:DTt,tonemapping_fragment:$Tt,tonemapping_pars_fragment:LTt,transmission_fragment:FTt,transmission_pars_fragment:jTt,uv_pars_fragment:zTt,uv_pars_vertex:BTt,uv_vertex:UTt,worldpos_vertex:VTt,background_vert:WTt,background_frag:HTt,backgroundCube_vert:GTt,backgroundCube_frag:qTt,cube_vert:XTt,cube_frag:KTt,depth_vert:YTt,depth_frag:ZTt,distanceRGBA_vert:QTt,distanceRGBA_frag:JTt,equirect_vert:eEt,equirect_frag:tEt,linedashed_vert:nEt,linedashed_frag:rEt,meshbasic_vert:iEt,meshbasic_frag:sEt,meshlambert_vert:aEt,meshlambert_frag:oEt,meshmatcap_vert:lEt,meshmatcap_frag:cEt,meshnormal_vert:uEt,meshnormal_frag:dEt,meshphong_vert:hEt,meshphong_frag:fEt,meshphysical_vert:pEt,meshphysical_frag:mEt,meshtoon_vert:gEt,meshtoon_frag:yEt,points_vert:vEt,points_frag:xEt,shadow_vert:bEt,shadow_frag:wEt,sprite_vert:SEt,sprite_frag:_Et},at={common:{diffuse:{value:new xt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Tn},alphaMap:{value:null},alphaMapTransform:{value:new Tn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Tn}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Tn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Tn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Tn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Tn},normalScale:{value:new Xe(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Tn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Tn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Tn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Tn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new xt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new xt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Tn},alphaTest:{value:0},uvTransform:{value:new Tn}},sprite:{diffuse:{value:new xt(16777215)},opacity:{value:1},center:{value:new Xe(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Tn},alphaMap:{value:null},alphaMapTransform:{value:new Tn},alphaTest:{value:0}}},Tc={basic:{uniforms:Aa([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.fog]),vertexShader:xn.meshbasic_vert,fragmentShader:xn.meshbasic_frag},lambert:{uniforms:Aa([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new xt(0)}}]),vertexShader:xn.meshlambert_vert,fragmentShader:xn.meshlambert_frag},phong:{uniforms:Aa([at.common,at.specularmap,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.fog,at.lights,{emissive:{value:new xt(0)},specular:{value:new xt(1118481)},shininess:{value:30}}]),vertexShader:xn.meshphong_vert,fragmentShader:xn.meshphong_frag},standard:{uniforms:Aa([at.common,at.envmap,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.roughnessmap,at.metalnessmap,at.fog,at.lights,{emissive:{value:new xt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:xn.meshphysical_vert,fragmentShader:xn.meshphysical_frag},toon:{uniforms:Aa([at.common,at.aomap,at.lightmap,at.emissivemap,at.bumpmap,at.normalmap,at.displacementmap,at.gradientmap,at.fog,at.lights,{emissive:{value:new xt(0)}}]),vertexShader:xn.meshtoon_vert,fragmentShader:xn.meshtoon_frag},matcap:{uniforms:Aa([at.common,at.bumpmap,at.normalmap,at.displacementmap,at.fog,{matcap:{value:null}}]),vertexShader:xn.meshmatcap_vert,fragmentShader:xn.meshmatcap_frag},points:{uniforms:Aa([at.points,at.fog]),vertexShader:xn.points_vert,fragmentShader:xn.points_frag},dashed:{uniforms:Aa([at.common,at.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:xn.linedashed_vert,fragmentShader:xn.linedashed_frag},depth:{uniforms:Aa([at.common,at.displacementmap]),vertexShader:xn.depth_vert,fragmentShader:xn.depth_frag},normal:{uniforms:Aa([at.common,at.bumpmap,at.normalmap,at.displacementmap,{opacity:{value:1}}]),vertexShader:xn.meshnormal_vert,fragmentShader:xn.meshnormal_frag},sprite:{uniforms:Aa([at.sprite,at.fog]),vertexShader:xn.sprite_vert,fragmentShader:xn.sprite_frag},background:{uniforms:{uvTransform:{value:new Tn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:xn.background_vert,fragmentShader:xn.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:xn.backgroundCube_vert,fragmentShader:xn.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:xn.cube_vert,fragmentShader:xn.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:xn.equirect_vert,fragmentShader:xn.equirect_frag},distanceRGBA:{uniforms:Aa([at.common,at.displacementmap,{referencePosition:{value:new ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:xn.distanceRGBA_vert,fragmentShader:xn.distanceRGBA_frag},shadow:{uniforms:Aa([at.lights,at.fog,{color:{value:new xt(0)},opacity:{value:1}}]),vertexShader:xn.shadow_vert,fragmentShader:xn.shadow_frag}};Tc.physical={uniforms:Aa([Tc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Tn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Tn},clearcoatNormalScale:{value:new Xe(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Tn},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Tn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Tn},sheen:{value:0},sheenColor:{value:new xt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Tn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Tn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Tn},transmissionSamplerSize:{value:new Xe},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Tn},attenuationDistance:{value:0},attenuationColor:{value:new xt(0)},specularColor:{value:new xt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Tn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Tn},anisotropyVector:{value:new Xe},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Tn}}]),vertexShader:xn.meshphysical_vert,fragmentShader:xn.meshphysical_frag};const WN={r:0,b:0,g:0};function TEt(t,e,n,r,i,s,a){const o=new xt(0);let l=s===!0?0:1,c,u,d=null,h=0,f=null;function p(m,y){let x=!1,b=y.isScene===!0?y.background:null;b&&b.isTexture&&(b=(y.backgroundBlurriness>0?n:e).get(b)),b===null?g(o,l):b&&b.isColor&&(g(b,1),x=!0);const _=t.xr.getEnvironmentBlendMode();_==="additive"?r.buffers.color.setClear(0,0,0,1,a):_==="alpha-blend"&&r.buffers.color.setClear(0,0,0,0,a),(t.autoClear||x)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),b&&(b.isCubeTexture||b.mapping===_b)?(u===void 0&&(u=new ls(new ly(1,1,1),new Ju({name:"BackgroundCubeMaterial",uniforms:k0(Tc.backgroundCube.uniforms),vertexShader:Tc.backgroundCube.vertexShader,fragmentShader:Tc.backgroundCube.fragmentShader,side:Ua,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),u.geometry.deleteAttribute("uv"),u.onBeforeRender=function(T,E,C){this.matrixWorld.copyPosition(C.matrixWorld)},Object.defineProperty(u.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(u)),u.material.uniforms.envMap.value=b,u.material.uniforms.flipEnvMap.value=b.isCubeTexture&&b.isRenderTargetTexture===!1?-1:1,u.material.uniforms.backgroundBlurriness.value=y.backgroundBlurriness,u.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,u.material.toneMapped=dr.getTransfer(b.colorSpace)!==kr,(d!==b||h!==b.version||f!==t.toneMapping)&&(u.material.needsUpdate=!0,d=b,h=b.version,f=t.toneMapping),u.layers.enableAll(),m.unshift(u,u.geometry,u.material,0,0,null)):b&&b.isTexture&&(c===void 0&&(c=new ls(new gE(2,2),new Ju({name:"BackgroundMaterial",uniforms:k0(Tc.background.uniforms),vertexShader:Tc.background.vertexShader,fragmentShader:Tc.background.fragmentShader,side:dh,depthTest:!1,depthWrite:!1,fog:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=b,c.material.uniforms.backgroundIntensity.value=y.backgroundIntensity,c.material.toneMapped=dr.getTransfer(b.colorSpace)!==kr,b.matrixAutoUpdate===!0&&b.updateMatrix(),c.material.uniforms.uvTransform.value.copy(b.matrix),(d!==b||h!==b.version||f!==t.toneMapping)&&(c.material.needsUpdate=!0,d=b,h=b.version,f=t.toneMapping),c.layers.enableAll(),m.unshift(c,c.geometry,c.material,0,0,null))}function g(m,y){m.getRGB(WN,nve(t)),r.buffers.color.setClear(WN.r,WN.g,WN.b,y,a)}return{getClearColor:function(){return o},setClearColor:function(m,y=1){o.set(m),l=y,g(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(m){l=m,g(o,l)},render:p}}function EEt(t,e,n,r){const i=t.getParameter(t.MAX_VERTEX_ATTRIBS),s=r.isWebGL2?null:e.get("OES_vertex_array_object"),a=r.isWebGL2||s!==null,o={},l=m(null);let c=l,u=!1;function d(O,j,B,W,L){let V=!1;if(a){const H=g(W,B,j);c!==H&&(c=H,f(c.object)),V=y(O,W,B,L),V&&x(O,W,B,L)}else{const H=j.wireframe===!0;(c.geometry!==W.id||c.program!==B.id||c.wireframe!==H)&&(c.geometry=W.id,c.program=B.id,c.wireframe=H,V=!0)}L!==null&&n.update(L,t.ELEMENT_ARRAY_BUFFER),(V||u)&&(u=!1,I(O,j,B,W),L!==null&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n.get(L).buffer))}function h(){return r.isWebGL2?t.createVertexArray():s.createVertexArrayOES()}function f(O){return r.isWebGL2?t.bindVertexArray(O):s.bindVertexArrayOES(O)}function p(O){return r.isWebGL2?t.deleteVertexArray(O):s.deleteVertexArrayOES(O)}function g(O,j,B){const W=B.wireframe===!0;let L=o[O.id];L===void 0&&(L={},o[O.id]=L);let V=L[j.id];V===void 0&&(V={},L[j.id]=V);let H=V[W];return H===void 0&&(H=m(h()),V[W]=H),H}function m(O){const j=[],B=[],W=[];for(let L=0;L<i;L++)j[L]=0,B[L]=0,W[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:j,enabledAttributes:B,attributeDivisors:W,object:O,attributes:{},index:null}}function y(O,j,B,W){const L=c.attributes,V=j.attributes;let H=0;const K=B.getAttributes();for(const te in K)if(K[te].location>=0){const oe=L[te];let fe=V[te];if(fe===void 0&&(te==="instanceMatrix"&&O.instanceMatrix&&(fe=O.instanceMatrix),te==="instanceColor"&&O.instanceColor&&(fe=O.instanceColor)),oe===void 0||oe.attribute!==fe||fe&&oe.data!==fe.data)return!0;H++}return c.attributesNum!==H||c.index!==W}function x(O,j,B,W){const L={},V=j.attributes;let H=0;const K=B.getAttributes();for(const te in K)if(K[te].location>=0){let oe=V[te];oe===void 0&&(te==="instanceMatrix"&&O.instanceMatrix&&(oe=O.instanceMatrix),te==="instanceColor"&&O.instanceColor&&(oe=O.instanceColor));const fe={};fe.attribute=oe,oe&&oe.data&&(fe.data=oe.data),L[te]=fe,H++}c.attributes=L,c.attributesNum=H,c.index=W}function b(){const O=c.newAttributes;for(let j=0,B=O.length;j<B;j++)O[j]=0}function _(O){T(O,0)}function T(O,j){const B=c.newAttributes,W=c.enabledAttributes,L=c.attributeDivisors;B[O]=1,W[O]===0&&(t.enableVertexAttribArray(O),W[O]=1),L[O]!==j&&((r.isWebGL2?t:e.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](O,j),L[O]=j)}function E(){const O=c.newAttributes,j=c.enabledAttributes;for(let B=0,W=j.length;B<W;B++)j[B]!==O[B]&&(t.disableVertexAttribArray(B),j[B]=0)}function C(O,j,B,W,L,V,H){H===!0?t.vertexAttribIPointer(O,j,B,L,V):t.vertexAttribPointer(O,j,B,W,L,V)}function I(O,j,B,W){if(r.isWebGL2===!1&&(O.isInstancedMesh||W.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;b();const L=W.attributes,V=B.getAttributes(),H=j.defaultAttributeValues;for(const K in V){const te=V[K];if(te.location>=0){let J=L[K];if(J===void 0&&(K==="instanceMatrix"&&O.instanceMatrix&&(J=O.instanceMatrix),K==="instanceColor"&&O.instanceColor&&(J=O.instanceColor)),J!==void 0){const oe=J.normalized,fe=J.itemSize,Ee=n.get(J);if(Ee===void 0)continue;const me=Ee.buffer,De=Ee.type,ge=Ee.bytesPerElement,_e=r.isWebGL2===!0&&(De===t.INT||De===t.UNSIGNED_INT||J.gpuType===uG);if(J.isInterleavedBufferAttribute){const Ce=J.data,G=Ce.stride,ke=J.offset;if(Ce.isInstancedInterleavedBuffer){for(let xe=0;xe<te.locationSize;xe++)T(te.location+xe,Ce.meshPerAttribute);O.isInstancedMesh!==!0&&W._maxInstanceCount===void 0&&(W._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let xe=0;xe<te.locationSize;xe++)_(te.location+xe);t.bindBuffer(t.ARRAY_BUFFER,me);for(let xe=0;xe<te.locationSize;xe++)C(te.location+xe,fe/te.locationSize,De,oe,G*ge,(ke+fe/te.locationSize*xe)*ge,_e)}else{if(J.isInstancedBufferAttribute){for(let Ce=0;Ce<te.locationSize;Ce++)T(te.location+Ce,J.meshPerAttribute);O.isInstancedMesh!==!0&&W._maxInstanceCount===void 0&&(W._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let Ce=0;Ce<te.locationSize;Ce++)_(te.location+Ce);t.bindBuffer(t.ARRAY_BUFFER,me);for(let Ce=0;Ce<te.locationSize;Ce++)C(te.location+Ce,fe/te.locationSize,De,oe,fe*ge,fe/te.locationSize*Ce*ge,_e)}}else if(H!==void 0){const oe=H[K];if(oe!==void 0)switch(oe.length){case 2:t.vertexAttrib2fv(te.location,oe);break;case 3:t.vertexAttrib3fv(te.location,oe);break;case 4:t.vertexAttrib4fv(te.location,oe);break;default:t.vertexAttrib1fv(te.location,oe)}}}}E()}function A(){$();for(const O in o){const j=o[O];for(const B in j){const W=j[B];for(const L in W)p(W[L].object),delete W[L];delete j[B]}delete o[O]}}function k(O){if(o[O.id]===void 0)return;const j=o[O.id];for(const B in j){const W=j[B];for(const L in W)p(W[L].object),delete W[L];delete j[B]}delete o[O.id]}function R(O){for(const j in o){const B=o[j];if(B[O.id]===void 0)continue;const W=B[O.id];for(const L in W)p(W[L].object),delete W[L];delete B[O.id]}}function $(){z(),u=!0,c!==l&&(c=l,f(c.object))}function z(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:d,reset:$,resetDefaultState:z,dispose:A,releaseStatesOfGeometry:k,releaseStatesOfProgram:R,initAttributes:b,enableAttribute:_,disableUnusedAttributes:E}}function CEt(t,e,n,r){const i=r.isWebGL2;let s;function a(u){s=u}function o(u,d){t.drawArrays(s,u,d),n.update(d,s,1)}function l(u,d,h){if(h===0)return;let f,p;if(i)f=t,p="drawArraysInstanced";else if(f=e.get("ANGLE_instanced_arrays"),p="drawArraysInstancedANGLE",f===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}f[p](s,u,d,h),n.update(d,s,h)}function c(u,d,h){if(h===0)return;const f=e.get("WEBGL_multi_draw");if(f===null)for(let p=0;p<h;p++)this.render(u[p],d[p]);else{f.multiDrawArraysWEBGL(s,u,0,d,0,h);let p=0;for(let g=0;g<h;g++)p+=d[g];n.update(p,s,1)}}this.setMode=a,this.render=o,this.renderInstances=l,this.renderMultiDraw=c}function NEt(t,e,n){let r;function i(){if(r!==void 0)return r;if(e.has("EXT_texture_filter_anisotropic")===!0){const C=e.get("EXT_texture_filter_anisotropic");r=t.getParameter(C.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function s(C){if(C==="highp"){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";C="mediump"}return C==="mediump"&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const a=typeof WebGL2RenderingContext<"u"&&t.constructor.name==="WebGL2RenderingContext";let o=n.precision!==void 0?n.precision:"highp";const l=s(o);l!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",l,"instead."),o=l);const c=a||e.has("WEBGL_draw_buffers"),u=n.logarithmicDepthBuffer===!0,d=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),f=t.getParameter(t.MAX_TEXTURE_SIZE),p=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),g=t.getParameter(t.MAX_VERTEX_ATTRIBS),m=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),y=t.getParameter(t.MAX_VARYING_VECTORS),x=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),b=h>0,_=a||e.has("OES_texture_float"),T=b&&_,E=a?t.getParameter(t.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:c,getMaxAnisotropy:i,getMaxPrecision:s,precision:o,logarithmicDepthBuffer:u,maxTextures:d,maxVertexTextures:h,maxTextureSize:f,maxCubemapSize:p,maxAttributes:g,maxVertexUniforms:m,maxVaryings:y,maxFragmentUniforms:x,vertexTextures:b,floatFragmentTextures:_,floatVertexTextures:T,maxSamples:E}}function AEt(t){const e=this;let n=null,r=0,i=!1,s=!1;const a=new Qh,o=new Tn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(d,h){const f=d.length!==0||h||r!==0||i;return i=h,r=d.length,f},this.beginShadows=function(){s=!0,u(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(d,h){n=u(d,h,0)},this.setState=function(d,h,f){const p=d.clippingPlanes,g=d.clipIntersection,m=d.clipShadows,y=t.get(d);if(!i||p===null||p.length===0||s&&!m)s?u(null):c();else{const x=s?0:r,b=x*4;let _=y.clippingState||null;l.value=_,_=u(p,h,b,f);for(let T=0;T!==b;++T)_[T]=n[T];y.clippingState=_,this.numIntersection=g?this.numPlanes:0,this.numPlanes+=x}};function c(){l.value!==n&&(l.value=n,l.needsUpdate=r>0),e.numPlanes=r,e.numIntersection=0}function u(d,h,f,p){const g=d!==null?d.length:0;let m=null;if(g!==0){if(m=l.value,p!==!0||m===null){const y=f+g*4,x=h.matrixWorldInverse;o.getNormalMatrix(x),(m===null||m.length<y)&&(m=new Float32Array(y));for(let b=0,_=f;b!==g;++b,_+=4)a.copy(d[b]).applyMatrix4(x,o),a.normal.toArray(m,_),m[_+3]=a.constant}l.value=m,l.needsUpdate=!0}return e.numPlanes=g,e.numIntersection=0,m}}function IEt(t){let e=new WeakMap;function n(a,o){return o===n_?a.mapping=hh:o===r_&&(a.mapping=ep),a}function r(a){if(a&&a.isTexture){const o=a.mapping;if(o===n_||o===r_)if(e.has(a)){const l=e.get(a).texture;return n(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new sve(l.height/2);return c.fromEquirectangularTexture(t,a),e.set(a,c),a.addEventListener("dispose",i),n(c.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:r,dispose:s}}class yE extends fE{constructor(e=-1,n=1,r=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=n,this.top=r,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,n){return super.copy(e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,n,r,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=n,this.view.offsetX=r,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=r-e,a=r+e,o=i+n,l=i-n;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=u*this.view.offsetY,l=o-u*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const n=super.toJSON(e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const zv=4,wJ=[.125,.215,.35,.446,.526,.582],xm=20,GL=new yE,SJ=new xt;let qL=null,XL=0,KL=0;const mm=(1+Math.sqrt(5))/2,rv=1/mm,_J=[new ne(1,1,1),new ne(-1,1,1),new ne(1,1,-1),new ne(-1,1,-1),new ne(0,mm,rv),new ne(0,mm,-rv),new ne(rv,0,mm),new ne(-rv,0,mm),new ne(mm,rv,0),new ne(-mm,rv,0)];class X4{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,n=0,r=.1,i=100){qL=this._renderer.getRenderTarget(),XL=this._renderer.getActiveCubeFace(),KL=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,r,i,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,n=null){return this._fromTexture(e,n)}fromCubemap(e,n=null){return this._fromTexture(e,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=CJ(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=EJ(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(qL,XL,KL),e.scissorTest=!1,HN(e,0,0,e.width,e.height)}_fromTexture(e,n){e.mapping===hh||e.mapping===ep?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),qL=this._renderer.getRenderTarget(),XL=this._renderer.getActiveCubeFace(),KL=this._renderer.getActiveMipmapLevel();const r=n||this._allocateTargets();return this._textureToCubeUV(e,r),this._applyPMREM(r),this._cleanup(r),r}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,r={magFilter:Ri,minFilter:Ri,generateMipmaps:!1,type:N0,format:ja,colorSpace:Qu,depthBuffer:!1},i=TJ(e,n,r);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==n){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=TJ(e,n,r);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=kEt(s)),this._blurMaterial=MEt(s,e,n)}return i}_compileMaterial(e){const n=new ls(this._lodPlanes[0],e);this._renderer.compile(n,GL)}_sceneToCubeUV(e,n,r,i){const o=new Ts(90,1,n,r),l=[1,-1,1,1,1,1],c=[1,1,1,-1,-1,-1],u=this._renderer,d=u.autoClear,h=u.toneMapping;u.getClearColor(SJ),u.toneMapping=zu,u.autoClear=!1;const f=new Mp({name:"PMREM.Background",side:Ua,depthWrite:!1,depthTest:!1}),p=new ls(new ly,f);let g=!1;const m=e.background;m?m.isColor&&(f.color.copy(m),e.background=null,g=!0):(f.color.copy(SJ),g=!0);for(let y=0;y<6;y++){const x=y%3;x===0?(o.up.set(0,l[y],0),o.lookAt(c[y],0,0)):x===1?(o.up.set(0,0,l[y]),o.lookAt(0,c[y],0)):(o.up.set(0,l[y],0),o.lookAt(0,0,c[y]));const b=this._cubeSize;HN(i,x*b,y>2?b:0,b,b),u.setRenderTarget(i),g&&u.render(p,o),u.render(e,o)}p.geometry.dispose(),p.material.dispose(),u.toneMapping=h,u.autoClear=d,e.background=m}_textureToCubeUV(e,n){const r=this._renderer,i=e.mapping===hh||e.mapping===ep;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=CJ()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=EJ());const s=i?this._cubemapMaterial:this._equirectMaterial,a=new ls(this._lodPlanes[0],s),o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;HN(n,0,0,3*l,2*l),r.setRenderTarget(n),r.render(a,GL)}_applyPMREM(e){const n=this._renderer,r=n.autoClear;n.autoClear=!1;for(let i=1;i<this._lodPlanes.length;i++){const s=Math.sqrt(this._sigmas[i]*this._sigmas[i]-this._sigmas[i-1]*this._sigmas[i-1]),a=_J[(i-1)%_J.length];this._blur(e,i-1,i,s,a)}n.autoClear=r}_blur(e,n,r,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,n,r,i,"latitudinal",s),this._halfBlur(a,e,r,r,i,"longitudinal",s)}_halfBlur(e,n,r,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const u=3,d=new ls(this._lodPlanes[i],c),h=c.uniforms,f=this._sizeLods[r]-1,p=isFinite(s)?Math.PI/(2*f):2*Math.PI/(2*xm-1),g=s/p,m=isFinite(s)?1+Math.floor(u*g):xm;m>xm&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${m} samples when the maximum is set to ${xm}`);const y=[];let x=0;for(let C=0;C<xm;++C){const I=C/g,A=Math.exp(-I*I/2);y.push(A),C===0?x+=A:C<m&&(x+=2*A)}for(let C=0;C<y.length;C++)y[C]=y[C]/x;h.envMap.value=e.texture,h.samples.value=m,h.weights.value=y,h.latitudinal.value=a==="latitudinal",o&&(h.poleAxis.value=o);const{_lodMax:b}=this;h.dTheta.value=p,h.mipInt.value=b-r;const _=this._sizeLods[i],T=3*_*(i>b-zv?i-b+zv:0),E=4*(this._cubeSize-_);HN(n,T,E,3*_,2*_),l.setRenderTarget(n),l.render(d,GL)}}function kEt(t){const e=[],n=[],r=[];let i=t;const s=t-zv+1+wJ.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);n.push(o);let l=1/o;a>t-zv?l=wJ[a-t+zv-1]:a===0&&(l=0),r.push(l);const c=1/(o-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=6,p=6,g=3,m=2,y=1,x=new Float32Array(g*p*f),b=new Float32Array(m*p*f),_=new Float32Array(y*p*f);for(let E=0;E<f;E++){const C=E%3*2/3-1,I=E>2?0:-1,A=[C,I,0,C+2/3,I,0,C+2/3,I+1,0,C,I,0,C+2/3,I+1,0,C,I+1,0];x.set(A,g*p*E),b.set(h,m*p*E);const k=[E,E,E,E,E,E];_.set(k,y*p*E)}const T=new Cn;T.setAttribute("position",new mr(x,g)),T.setAttribute("uv",new mr(b,m)),T.setAttribute("faceIndex",new mr(_,y)),e.push(T),i>zv&&i--}return{lodPlanes:e,sizeLods:n,sigmas:r}}function TJ(t,e,n){const r=new Kc(t,e,n);return r.texture.mapping=_b,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function HN(t,e,n,r,i){t.viewport.set(e,n,r,i),t.scissor.set(e,n,r,i)}function MEt(t,e,n){const r=new Float32Array(xm),i=new ne(0,1,0);return new Ju({name:"SphericalGaussianBlur",defines:{n:xm,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${t}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:EG(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Xd,depthTest:!1,depthWrite:!1})}function EJ(){return new Ju({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:EG(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Xd,depthTest:!1,depthWrite:!1})}function CJ(){return new Ju({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:EG(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Xd,depthTest:!1,depthWrite:!1})}function EG(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function REt(t){let e=new WeakMap,n=null;function r(o){if(o&&o.isTexture){const l=o.mapping,c=l===n_||l===r_,u=l===hh||l===ep;if(c||u)if(o.isRenderTargetTexture&&o.needsPMREMUpdate===!0){o.needsPMREMUpdate=!1;let d=e.get(o);return n===null&&(n=new X4(t)),d=c?n.fromEquirectangular(o,d):n.fromCubemap(o,d),e.set(o,d),d.texture}else{if(e.has(o))return e.get(o).texture;{const d=o.image;if(c&&d&&d.height>0||u&&d&&i(d)){n===null&&(n=new X4(t));const h=c?n.fromEquirectangular(o):n.fromCubemap(o);return e.set(o,h),o.addEventListener("dispose",s),h.texture}else return null}}}return o}function i(o){let l=0;const c=6;for(let u=0;u<c;u++)o[u]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:r,dispose:a}}function PEt(t){const e={};function n(r){if(e[r]!==void 0)return e[r];let i;switch(r){case"WEBGL_depth_texture":i=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=t.getExtension(r)}return e[r]=i,i}return{has:function(r){return n(r)!==null},init:function(r){r.isWebGL2?(n("EXT_color_buffer_float"),n("WEBGL_clip_cull_distance")):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(r){const i=n(r);return i===null&&console.warn("THREE.WebGLRenderer: "+r+" extension not supported."),i}}}function OEt(t,e,n,r){const i={},s=new WeakMap;function a(d){const h=d.target;h.index!==null&&e.remove(h.index);for(const p in h.attributes)e.remove(h.attributes[p]);for(const p in h.morphAttributes){const g=h.morphAttributes[p];for(let m=0,y=g.length;m<y;m++)e.remove(g[m])}h.removeEventListener("dispose",a),delete i[h.id];const f=s.get(h);f&&(e.remove(f),s.delete(h)),r.releaseStatesOfGeometry(h),h.isInstancedBufferGeometry===!0&&delete h._maxInstanceCount,n.memory.geometries--}function o(d,h){return i[h.id]===!0||(h.addEventListener("dispose",a),i[h.id]=!0,n.memory.geometries++),h}function l(d){const h=d.attributes;for(const p in h)e.update(h[p],t.ARRAY_BUFFER);const f=d.morphAttributes;for(const p in f){const g=f[p];for(let m=0,y=g.length;m<y;m++)e.update(g[m],t.ARRAY_BUFFER)}}function c(d){const h=[],f=d.index,p=d.attributes.position;let g=0;if(f!==null){const x=f.array;g=f.version;for(let b=0,_=x.length;b<_;b+=3){const T=x[b+0],E=x[b+1],C=x[b+2];h.push(T,E,E,C,C,T)}}else if(p!==void 0){const x=p.array;g=p.version;for(let b=0,_=x.length/3-1;b<_;b+=3){const T=b+0,E=b+1,C=b+2;h.push(T,E,E,C,C,T)}}else return;const m=new(Qye(h)?TG:_G)(h,1);m.version=g;const y=s.get(d);y&&e.remove(y),s.set(d,m)}function u(d){const h=s.get(d);if(h){const f=d.index;f!==null&&h.version<f.version&&c(d)}else c(d);return s.get(d)}return{get:o,update:l,getWireframeAttribute:u}}function DEt(t,e,n,r){const i=r.isWebGL2;let s;function a(f){s=f}let o,l;function c(f){o=f.type,l=f.bytesPerElement}function u(f,p){t.drawElements(s,p,o,f*l),n.update(p,s,1)}function d(f,p,g){if(g===0)return;let m,y;if(i)m=t,y="drawElementsInstanced";else if(m=e.get("ANGLE_instanced_arrays"),y="drawElementsInstancedANGLE",m===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}m[y](s,p,o,f*l,g),n.update(p,s,g)}function h(f,p,g){if(g===0)return;const m=e.get("WEBGL_multi_draw");if(m===null)for(let y=0;y<g;y++)this.render(f[y]/l,p[y]);else{m.multiDrawElementsWEBGL(s,p,0,o,f,0,g);let y=0;for(let x=0;x<g;x++)y+=p[x];n.update(y,s,1)}}this.setMode=a,this.setIndex=c,this.render=u,this.renderInstances=d,this.renderMultiDraw=h}function $Et(t){const e={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function r(s,a,o){switch(n.calls++,a){case t.TRIANGLES:n.triangles+=o*(s/3);break;case t.LINES:n.lines+=o*(s/2);break;case t.LINE_STRIP:n.lines+=o*(s-1);break;case t.LINE_LOOP:n.lines+=o*s;break;case t.POINTS:n.points+=o*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",a);break}}function i(){n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:e,render:n,programs:null,autoReset:!0,reset:i,update:r}}function LEt(t,e){return t[0]-e[0]}function FEt(t,e){return Math.abs(e[1])-Math.abs(t[1])}function jEt(t,e,n){const r={},i=new Float32Array(8),s=new WeakMap,a=new hr,o=[];for(let c=0;c<8;c++)o[c]=[c,0];function l(c,u,d){const h=c.morphTargetInfluences;if(e.isWebGL2===!0){const f=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,p=f!==void 0?f.length:0;let g=s.get(u);if(g===void 0||g.count!==p){let O=function(){$.dispose(),s.delete(u),u.removeEventListener("dispose",O)};g!==void 0&&g.texture.dispose();const x=u.morphAttributes.position!==void 0,b=u.morphAttributes.normal!==void 0,_=u.morphAttributes.color!==void 0,T=u.morphAttributes.position||[],E=u.morphAttributes.normal||[],C=u.morphAttributes.color||[];let I=0;x===!0&&(I=1),b===!0&&(I=2),_===!0&&(I=3);let A=u.attributes.position.count*I,k=1;A>e.maxTextureSize&&(k=Math.ceil(A/e.maxTextureSize),A=e.maxTextureSize);const R=new Float32Array(A*k*4*p),$=new YP(R,A,k,p);$.type=Pc,$.needsUpdate=!0;const z=I*4;for(let j=0;j<p;j++){const B=T[j],W=E[j],L=C[j],V=A*k*4*j;for(let H=0;H<B.count;H++){const K=H*z;x===!0&&(a.fromBufferAttribute(B,H),R[V+K+0]=a.x,R[V+K+1]=a.y,R[V+K+2]=a.z,R[V+K+3]=0),b===!0&&(a.fromBufferAttribute(W,H),R[V+K+4]=a.x,R[V+K+5]=a.y,R[V+K+6]=a.z,R[V+K+7]=0),_===!0&&(a.fromBufferAttribute(L,H),R[V+K+8]=a.x,R[V+K+9]=a.y,R[V+K+10]=a.z,R[V+K+11]=L.itemSize===4?a.w:1)}}g={count:p,texture:$,size:new Xe(A,k)},s.set(u,g),u.addEventListener("dispose",O)}let m=0;for(let x=0;x<h.length;x++)m+=h[x];const y=u.morphTargetsRelative?1:1-m;d.getUniforms().setValue(t,"morphTargetBaseInfluence",y),d.getUniforms().setValue(t,"morphTargetInfluences",h),d.getUniforms().setValue(t,"morphTargetsTexture",g.texture,n),d.getUniforms().setValue(t,"morphTargetsTextureSize",g.size)}else{const f=h===void 0?0:h.length;let p=r[u.id];if(p===void 0||p.length!==f){p=[];for(let b=0;b<f;b++)p[b]=[b,0];r[u.id]=p}for(let b=0;b<f;b++){const _=p[b];_[0]=b,_[1]=h[b]}p.sort(FEt);for(let b=0;b<8;b++)b<f&&p[b][1]?(o[b][0]=p[b][0],o[b][1]=p[b][1]):(o[b][0]=Number.MAX_SAFE_INTEGER,o[b][1]=0);o.sort(LEt);const g=u.morphAttributes.position,m=u.morphAttributes.normal;let y=0;for(let b=0;b<8;b++){const _=o[b],T=_[0],E=_[1];T!==Number.MAX_SAFE_INTEGER&&E?(g&&u.getAttribute("morphTarget"+b)!==g[T]&&u.setAttribute("morphTarget"+b,g[T]),m&&u.getAttribute("morphNormal"+b)!==m[T]&&u.setAttribute("morphNormal"+b,m[T]),i[b]=E,y+=E):(g&&u.hasAttribute("morphTarget"+b)===!0&&u.deleteAttribute("morphTarget"+b),m&&u.hasAttribute("morphNormal"+b)===!0&&u.deleteAttribute("morphNormal"+b),i[b]=0)}const x=u.morphTargetsRelative?1:1-y;d.getUniforms().setValue(t,"morphTargetBaseInfluence",x),d.getUniforms().setValue(t,"morphTargetInfluences",i)}}return{update:l}}function zEt(t,e,n,r){let i=new WeakMap;function s(l){const c=r.render.frame,u=l.geometry,d=e.get(l,u);if(i.get(d)!==c&&(e.update(d),i.set(d,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==c&&(n.update(l.instanceMatrix,t.ARRAY_BUFFER),l.instanceColor!==null&&n.update(l.instanceColor,t.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const h=l.skeleton;i.get(h)!==c&&(h.update(),i.set(h,c))}return d}function a(){i=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),n.remove(c.instanceMatrix),c.instanceColor!==null&&n.remove(c.instanceColor)}return{update:s,dispose:a}}class CG extends $i{constructor(e,n,r,i,s,a,o,l,c,u){if(u=u!==void 0?u:Of,u!==Of&&u!==zg)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");r===void 0&&u===Of&&(r=jd),r===void 0&&u===zg&&(r=Pf),super(null,i,s,a,o,l,u,r,c),this.isDepthTexture=!0,this.image={width:e,height:n},this.magFilter=o!==void 0?o:Ii,this.minFilter=l!==void 0?l:Ii,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const n=super.toJSON(e);return this.compareFunction!==null&&(n.compareFunction=this.compareFunction),n}}const ove=new $i,lve=new CG(1,1);lve.compareFunction=xG;const cve=new YP,uve=new SG,dve=new pE,NJ=[],AJ=[],IJ=new Float32Array(16),kJ=new Float32Array(9),MJ=new Float32Array(4);function Eb(t,e,n){const r=t[0];if(r<=0||r>0)return t;const i=e*n;let s=NJ[i];if(s===void 0&&(s=new Float32Array(i),NJ[i]=s),e!==0){r.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=n,t[a].toArray(s,o)}return s}function us(t,e){if(t.length!==e.length)return!1;for(let n=0,r=t.length;n<r;n++)if(t[n]!==e[n])return!1;return!0}function ds(t,e){for(let n=0,r=e.length;n<r;n++)t[n]=e[n]}function ZP(t,e){let n=AJ[e];n===void 0&&(n=new Int32Array(e),AJ[e]=n);for(let r=0;r!==e;++r)n[r]=t.allocateTextureUnit();return n}function BEt(t,e){const n=this.cache;n[0]!==e&&(t.uniform1f(this.addr,e),n[0]=e)}function UEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2f(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(us(n,e))return;t.uniform2fv(this.addr,e),ds(n,e)}}function VEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3f(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else if(e.r!==void 0)(n[0]!==e.r||n[1]!==e.g||n[2]!==e.b)&&(t.uniform3f(this.addr,e.r,e.g,e.b),n[0]=e.r,n[1]=e.g,n[2]=e.b);else{if(us(n,e))return;t.uniform3fv(this.addr,e),ds(n,e)}}function WEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4f(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(us(n,e))return;t.uniform4fv(this.addr,e),ds(n,e)}}function HEt(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(us(n,e))return;t.uniformMatrix2fv(this.addr,!1,e),ds(n,e)}else{if(us(n,r))return;MJ.set(r),t.uniformMatrix2fv(this.addr,!1,MJ),ds(n,r)}}function GEt(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(us(n,e))return;t.uniformMatrix3fv(this.addr,!1,e),ds(n,e)}else{if(us(n,r))return;kJ.set(r),t.uniformMatrix3fv(this.addr,!1,kJ),ds(n,r)}}function qEt(t,e){const n=this.cache,r=e.elements;if(r===void 0){if(us(n,e))return;t.uniformMatrix4fv(this.addr,!1,e),ds(n,e)}else{if(us(n,r))return;IJ.set(r),t.uniformMatrix4fv(this.addr,!1,IJ),ds(n,r)}}function XEt(t,e){const n=this.cache;n[0]!==e&&(t.uniform1i(this.addr,e),n[0]=e)}function KEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2i(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(us(n,e))return;t.uniform2iv(this.addr,e),ds(n,e)}}function YEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3i(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(us(n,e))return;t.uniform3iv(this.addr,e),ds(n,e)}}function ZEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4i(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(us(n,e))return;t.uniform4iv(this.addr,e),ds(n,e)}}function QEt(t,e){const n=this.cache;n[0]!==e&&(t.uniform1ui(this.addr,e),n[0]=e)}function JEt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y)&&(t.uniform2ui(this.addr,e.x,e.y),n[0]=e.x,n[1]=e.y);else{if(us(n,e))return;t.uniform2uiv(this.addr,e),ds(n,e)}}function eCt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z)&&(t.uniform3ui(this.addr,e.x,e.y,e.z),n[0]=e.x,n[1]=e.y,n[2]=e.z);else{if(us(n,e))return;t.uniform3uiv(this.addr,e),ds(n,e)}}function tCt(t,e){const n=this.cache;if(e.x!==void 0)(n[0]!==e.x||n[1]!==e.y||n[2]!==e.z||n[3]!==e.w)&&(t.uniform4ui(this.addr,e.x,e.y,e.z,e.w),n[0]=e.x,n[1]=e.y,n[2]=e.z,n[3]=e.w);else{if(us(n,e))return;t.uniform4uiv(this.addr,e),ds(n,e)}}function nCt(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i);const s=this.type===t.SAMPLER_2D_SHADOW?lve:ove;n.setTexture2D(e||s,i)}function rCt(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(e||uve,i)}function iCt(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTextureCube(e||dve,i)}function sCt(t,e,n){const r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(t.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(e||cve,i)}function aCt(t){switch(t){case 5126:return BEt;case 35664:return UEt;case 35665:return VEt;case 35666:return WEt;case 35674:return HEt;case 35675:return GEt;case 35676:return qEt;case 5124:case 35670:return XEt;case 35667:case 35671:return KEt;case 35668:case 35672:return YEt;case 35669:case 35673:return ZEt;case 5125:return QEt;case 36294:return JEt;case 36295:return eCt;case 36296:return tCt;case 35678:case 36198:case 36298:case 36306:case 35682:return nCt;case 35679:case 36299:case 36307:return rCt;case 35680:case 36300:case 36308:case 36293:return iCt;case 36289:case 36303:case 36311:case 36292:return sCt}}function oCt(t,e){t.uniform1fv(this.addr,e)}function lCt(t,e){const n=Eb(e,this.size,2);t.uniform2fv(this.addr,n)}function cCt(t,e){const n=Eb(e,this.size,3);t.uniform3fv(this.addr,n)}function uCt(t,e){const n=Eb(e,this.size,4);t.uniform4fv(this.addr,n)}function dCt(t,e){const n=Eb(e,this.size,4);t.uniformMatrix2fv(this.addr,!1,n)}function hCt(t,e){const n=Eb(e,this.size,9);t.uniformMatrix3fv(this.addr,!1,n)}function fCt(t,e){const n=Eb(e,this.size,16);t.uniformMatrix4fv(this.addr,!1,n)}function pCt(t,e){t.uniform1iv(this.addr,e)}function mCt(t,e){t.uniform2iv(this.addr,e)}function gCt(t,e){t.uniform3iv(this.addr,e)}function yCt(t,e){t.uniform4iv(this.addr,e)}function vCt(t,e){t.uniform1uiv(this.addr,e)}function xCt(t,e){t.uniform2uiv(this.addr,e)}function bCt(t,e){t.uniform3uiv(this.addr,e)}function wCt(t,e){t.uniform4uiv(this.addr,e)}function SCt(t,e,n){const r=this.cache,i=e.length,s=ZP(n,i);us(r,s)||(t.uniform1iv(this.addr,s),ds(r,s));for(let a=0;a!==i;++a)n.setTexture2D(e[a]||ove,s[a])}function _Ct(t,e,n){const r=this.cache,i=e.length,s=ZP(n,i);us(r,s)||(t.uniform1iv(this.addr,s),ds(r,s));for(let a=0;a!==i;++a)n.setTexture3D(e[a]||uve,s[a])}function TCt(t,e,n){const r=this.cache,i=e.length,s=ZP(n,i);us(r,s)||(t.uniform1iv(this.addr,s),ds(r,s));for(let a=0;a!==i;++a)n.setTextureCube(e[a]||dve,s[a])}function ECt(t,e,n){const r=this.cache,i=e.length,s=ZP(n,i);us(r,s)||(t.uniform1iv(this.addr,s),ds(r,s));for(let a=0;a!==i;++a)n.setTexture2DArray(e[a]||cve,s[a])}function CCt(t){switch(t){case 5126:return oCt;case 35664:return lCt;case 35665:return cCt;case 35666:return uCt;case 35674:return dCt;case 35675:return hCt;case 35676:return fCt;case 5124:case 35670:return pCt;case 35667:case 35671:return mCt;case 35668:case 35672:return gCt;case 35669:case 35673:return yCt;case 5125:return vCt;case 36294:return xCt;case 36295:return bCt;case 36296:return wCt;case 35678:case 36198:case 36298:case 36306:case 35682:return SCt;case 35679:case 36299:case 36307:return _Ct;case 35680:case 36300:case 36308:case 36293:return TCt;case 36289:case 36303:case 36311:case 36292:return ECt}}class NCt{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.setValue=aCt(n.type)}}class ACt{constructor(e,n,r){this.id=e,this.addr=r,this.cache=[],this.type=n.type,this.size=n.size,this.setValue=CCt(n.type)}}class ICt{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,n,r){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,n[o.id],r)}}}const YL=/(\w+)(\])?(\[|\.)?/g;function RJ(t,e){t.seq.push(e),t.map[e.id]=e}function kCt(t,e,n){const r=t.name,i=r.length;for(YL.lastIndex=0;;){const s=YL.exec(r),a=YL.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===i){RJ(n,c===void 0?new NCt(o,t,e):new ACt(o,t,e));break}else{let d=n.map[o];d===void 0&&(d=new ICt(o),RJ(n,d)),n=d}}}class J2{constructor(e,n){this.seq=[],this.map={};const r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS);for(let i=0;i<r;++i){const s=e.getActiveUniform(n,i),a=e.getUniformLocation(n,s.name);kCt(s,a,this)}}setValue(e,n,r,i){const s=this.map[n];s!==void 0&&s.setValue(e,r,i)}setOptional(e,n,r){const i=n[r];i!==void 0&&this.setValue(e,r,i)}static upload(e,n,r,i){for(let s=0,a=n.length;s!==a;++s){const o=n[s],l=r[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,n){const r=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in n&&r.push(a)}return r}}function PJ(t,e,n){const r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),r}const MCt=37297;let RCt=0;function PCt(t,e){const n=t.split(`
`),r=[],i=Math.max(e-6,0),s=Math.min(e+6,n.length);for(let a=i;a<s;a++){const o=a+1;r.push(`${o===e?">":" "} ${o}: ${n[a]}`)}return r.join(`
`)}function OCt(t){const e=dr.getPrimaries(dr.workingColorSpace),n=dr.getPrimaries(t);let r;switch(e===n?r="":e===d_&&n===u_?r="LinearDisplayP3ToLinearSRGB":e===u_&&n===d_&&(r="LinearSRGBToLinearDisplayP3"),t){case Qu:case dE:return[r,"LinearTransferOETF"];case rs:case KP:return[r,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",t),[r,"LinearTransferOETF"]}}function OJ(t,e,n){const r=t.getShaderParameter(e,t.COMPILE_STATUS),i=t.getShaderInfoLog(e).trim();if(r&&i==="")return"";const s=/ERROR: 0:(\d+)/.exec(i);if(s){const a=parseInt(s[1]);return n.toUpperCase()+`

`+i+`

`+PCt(t.getShaderSource(e),a)}else return i}function DCt(t,e){const n=OCt(e);return`vec4 ${t}( vec4 value ) { return ${n[0]}( ${n[1]}( value ) ); }`}function $Ct(t,e){let n;switch(e){case Eye:n="Linear";break;case Cye:n="Reinhard";break;case Nye:n="OptimizedCineon";break;case lG:n="ACESFilmic";break;case Iye:n="AgX";break;case Aye:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),n="Linear"}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function LCt(t){return[t.extensionDerivatives||t.envMapCubeUVHeight||t.bumpMap||t.normalMapTangentSpace||t.clearcoatNormalMap||t.flatShading||t.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(t.extensionFragDepth||t.logarithmicDepthBuffer)&&t.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",t.extensionDrawBuffers&&t.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(t.extensionShaderTextureLOD||t.envMap||t.transmission)&&t.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Bv).join(`
`)}function FCt(t){return[t.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(Bv).join(`
`)}function jCt(t){const e=[];for(const n in t){const r=t[n];r!==!1&&e.push("#define "+n+" "+r)}return e.join(`
`)}function zCt(t,e){const n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let i=0;i<r;i++){const s=t.getActiveAttrib(e,i),a=s.name;let o=1;s.type===t.FLOAT_MAT2&&(o=2),s.type===t.FLOAT_MAT3&&(o=3),s.type===t.FLOAT_MAT4&&(o=4),n[a]={type:s.type,location:t.getAttribLocation(e,a),locationSize:o}}return n}function Bv(t){return t!==""}function DJ(t,e){const n=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function $J(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const BCt=/^[ \t]*#include +<([\w\d./]+)>/gm;function K4(t){return t.replace(BCt,VCt)}const UCt=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function VCt(t,e){let n=xn[e];if(n===void 0){const r=UCt.get(e);if(r!==void 0)n=xn[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,r);else throw new Error("Can not resolve #include <"+e+">")}return K4(n)}const WCt=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LJ(t){return t.replace(WCt,HCt)}function HCt(t,e,n,r){let i="";for(let s=parseInt(e);s<parseInt(n);s++)i+=r.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function FJ(t){let e="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?e+=`
#define HIGH_PRECISION`:t.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function GCt(t){let e="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===HP?e="SHADOWMAP_TYPE_PCF":t.shadowMapType===x1?e="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===mc&&(e="SHADOWMAP_TYPE_VSM"),e}function qCt(t){let e="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case hh:case ep:e="ENVMAP_TYPE_CUBE";break;case _b:e="ENVMAP_TYPE_CUBE_UV";break}return e}function XCt(t){let e="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case ep:e="ENVMAP_MODE_REFRACTION";break}return e}function KCt(t){let e="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case uE:e="ENVMAP_BLENDING_MULTIPLY";break;case _ye:e="ENVMAP_BLENDING_MIX";break;case Tye:e="ENVMAP_BLENDING_ADD";break}return e}function YCt(t){const e=t.envMapCubeUVHeight;if(e===null)return null;const n=Math.log2(e)-2,r=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:r,maxMip:n}}function ZCt(t,e,n,r){const i=t.getContext(),s=n.defines;let a=n.vertexShader,o=n.fragmentShader;const l=GCt(n),c=qCt(n),u=XCt(n),d=KCt(n),h=YCt(n),f=n.isWebGL2?"":LCt(n),p=FCt(n),g=jCt(s),m=i.createProgram();let y,x,b=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(y=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(Bv).join(`
`),y.length>0&&(y+=`
`),x=[f,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g].filter(Bv).join(`
`),x.length>0&&(x+=`
`)):(y=[FJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",n.batching?"#define USE_BATCHING":"",n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+u:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Bv).join(`
`),x=[f,FJ(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,g,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+c:"",n.envMap?"#define "+u:"",n.envMap?"#define "+d:"",h?"#define CUBEUV_TEXEL_WIDTH "+h.texelWidth:"",h?"#define CUBEUV_TEXEL_HEIGHT "+h.texelHeight:"",h?"#define CUBEUV_MAX_MIP "+h.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&n.flatShading===!1?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.numLightProbes>0?"#define USE_LIGHT_PROBES":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==zu?"#define TONE_MAPPING":"",n.toneMapping!==zu?xn.tonemapping_pars_fragment:"",n.toneMapping!==zu?$Ct("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",xn.colorspace_pars_fragment,DCt("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(Bv).join(`
`)),a=K4(a),a=DJ(a,n),a=$J(a,n),o=K4(o),o=DJ(o,n),o=$J(o,n),a=LJ(a),o=LJ(o),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(b=`#version 300 es
`,y=[p,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+y,x=["precision mediump sampler2DArray;","#define varying in",n.glslVersion===G4?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===G4?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+x);const _=b+y+a,T=b+x+o,E=PJ(i,i.VERTEX_SHADER,_),C=PJ(i,i.FRAGMENT_SHADER,T);i.attachShader(m,E),i.attachShader(m,C),n.index0AttributeName!==void 0?i.bindAttribLocation(m,0,n.index0AttributeName):n.morphTargets===!0&&i.bindAttribLocation(m,0,"position"),i.linkProgram(m);function I($){if(t.debug.checkShaderErrors){const z=i.getProgramInfoLog(m).trim(),O=i.getShaderInfoLog(E).trim(),j=i.getShaderInfoLog(C).trim();let B=!0,W=!0;if(i.getProgramParameter(m,i.LINK_STATUS)===!1)if(B=!1,typeof t.debug.onShaderError=="function")t.debug.onShaderError(i,m,E,C);else{const L=OJ(i,E,"vertex"),V=OJ(i,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(m,i.VALIDATE_STATUS)+`

Program Info Log: `+z+`
`+L+`
`+V)}else z!==""?console.warn("THREE.WebGLProgram: Program Info Log:",z):(O===""||j==="")&&(W=!1);W&&($.diagnostics={runnable:B,programLog:z,vertexShader:{log:O,prefix:y},fragmentShader:{log:j,prefix:x}})}i.deleteShader(E),i.deleteShader(C),A=new J2(i,m),k=zCt(i,m)}let A;this.getUniforms=function(){return A===void 0&&I(this),A};let k;this.getAttributes=function(){return k===void 0&&I(this),k};let R=n.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return R===!1&&(R=i.getProgramParameter(m,MCt)),R},this.destroy=function(){r.releaseStatesOfProgram(this),i.deleteProgram(m),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=RCt++,this.cacheKey=e,this.usedTimes=1,this.program=m,this.vertexShader=E,this.fragmentShader=C,this}let QCt=0;class JCt{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const n=e.vertexShader,r=e.fragmentShader,i=this._getShaderStage(n),s=this._getShaderStage(r),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const n=this.materialCache.get(e);for(const r of n)r.usedTimes--,r.usedTimes===0&&this.shaderCache.delete(r.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const n=this.materialCache;let r=n.get(e);return r===void 0&&(r=new Set,n.set(e,r)),r}_getShaderStage(e){const n=this.shaderCache;let r=n.get(e);return r===void 0&&(r=new eNt(e),n.set(e,r)),r}}class eNt{constructor(e){this.id=QCt++,this.code=e,this.usedTimes=0}}function tNt(t,e,n,r,i,s,a){const o=new tg,l=new JCt,c=[],u=i.isWebGL2,d=i.logarithmicDepthBuffer,h=i.vertexTextures;let f=i.precision;const p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function g(A){return A===0?"uv":`uv${A}`}function m(A,k,R,$,z){const O=$.fog,j=z.geometry,B=A.isMeshStandardMaterial?$.environment:null,W=(A.isMeshStandardMaterial?n:e).get(A.envMap||B),L=W&&W.mapping===_b?W.image.height:null,V=p[A.type];A.precision!==null&&(f=i.getMaxPrecision(A.precision),f!==A.precision&&console.warn("THREE.WebGLProgram.getParameters:",A.precision,"not supported, using",f,"instead."));const H=j.morphAttributes.position||j.morphAttributes.normal||j.morphAttributes.color,K=H!==void 0?H.length:0;let te=0;j.morphAttributes.position!==void 0&&(te=1),j.morphAttributes.normal!==void 0&&(te=2),j.morphAttributes.color!==void 0&&(te=3);let J,oe,fe,Ee;if(V){const ms=Tc[V];J=ms.vertexShader,oe=ms.fragmentShader}else J=A.vertexShader,oe=A.fragmentShader,l.update(A),fe=l.getVertexShaderID(A),Ee=l.getFragmentShaderID(A);const me=t.getRenderTarget(),De=z.isInstancedMesh===!0,ge=z.isBatchedMesh===!0,_e=!!A.map,Ce=!!A.matcap,G=!!W,ke=!!A.aoMap,xe=!!A.lightMap,Pe=!!A.bumpMap,Te=!!A.normalMap,Ye=!!A.displacementMap,qe=!!A.emissiveMap,Q=!!A.metalnessMap,X=!!A.roughnessMap,we=A.anisotropy>0,Z=A.clearcoat>0,ie=A.iridescence>0,ae=A.sheen>0,Le=A.transmission>0,Ae=we&&!!A.anisotropyMap,Ie=Z&&!!A.clearcoatMap,Ge=Z&&!!A.clearcoatNormalMap,rt=Z&&!!A.clearcoatRoughnessMap,We=ie&&!!A.iridescenceMap,Ut=ie&&!!A.iridescenceThicknessMap,hn=ae&&!!A.sheenColorMap,Vt=ae&&!!A.sheenRoughnessMap,Ot=!!A.specularMap,bt=!!A.specularColorMap,ln=!!A.specularIntensityMap,Hn=Le&&!!A.transmissionMap,Tr=Le&&!!A.thicknessMap,Sn=!!A.gradientMap,it=!!A.alphaMap,pe=A.alphaTest>0,dt=!!A.alphaHash,ht=!!A.extensions,Zt=!!j.attributes.uv1,Ht=!!j.attributes.uv2,vr=!!j.attributes.uv3;let ur=zu;return A.toneMapped&&(me===null||me.isXRRenderTarget===!0)&&(ur=t.toneMapping),{isWebGL2:u,shaderID:V,shaderType:A.type,shaderName:A.name,vertexShader:J,fragmentShader:oe,defines:A.defines,customVertexShaderID:fe,customFragmentShaderID:Ee,isRawShaderMaterial:A.isRawShaderMaterial===!0,glslVersion:A.glslVersion,precision:f,batching:ge,instancing:De,instancingColor:De&&z.instanceColor!==null,supportsVertexTextures:h,outputColorSpace:me===null?t.outputColorSpace:me.isXRRenderTarget===!0?me.texture.colorSpace:Qu,map:_e,matcap:Ce,envMap:G,envMapMode:G&&W.mapping,envMapCubeUVHeight:L,aoMap:ke,lightMap:xe,bumpMap:Pe,normalMap:Te,displacementMap:h&&Ye,emissiveMap:qe,normalMapObjectSpace:Te&&A.normalMapType===Wye,normalMapTangentSpace:Te&&A.normalMapType===kp,metalnessMap:Q,roughnessMap:X,anisotropy:we,anisotropyMap:Ae,clearcoat:Z,clearcoatMap:Ie,clearcoatNormalMap:Ge,clearcoatRoughnessMap:rt,iridescence:ie,iridescenceMap:We,iridescenceThicknessMap:Ut,sheen:ae,sheenColorMap:hn,sheenRoughnessMap:Vt,specularMap:Ot,specularColorMap:bt,specularIntensityMap:ln,transmission:Le,transmissionMap:Hn,thicknessMap:Tr,gradientMap:Sn,opaque:A.transparent===!1&&A.blending===Jm,alphaMap:it,alphaTest:pe,alphaHash:dt,combine:A.combine,mapUv:_e&&g(A.map.channel),aoMapUv:ke&&g(A.aoMap.channel),lightMapUv:xe&&g(A.lightMap.channel),bumpMapUv:Pe&&g(A.bumpMap.channel),normalMapUv:Te&&g(A.normalMap.channel),displacementMapUv:Ye&&g(A.displacementMap.channel),emissiveMapUv:qe&&g(A.emissiveMap.channel),metalnessMapUv:Q&&g(A.metalnessMap.channel),roughnessMapUv:X&&g(A.roughnessMap.channel),anisotropyMapUv:Ae&&g(A.anisotropyMap.channel),clearcoatMapUv:Ie&&g(A.clearcoatMap.channel),clearcoatNormalMapUv:Ge&&g(A.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:rt&&g(A.clearcoatRoughnessMap.channel),iridescenceMapUv:We&&g(A.iridescenceMap.channel),iridescenceThicknessMapUv:Ut&&g(A.iridescenceThicknessMap.channel),sheenColorMapUv:hn&&g(A.sheenColorMap.channel),sheenRoughnessMapUv:Vt&&g(A.sheenRoughnessMap.channel),specularMapUv:Ot&&g(A.specularMap.channel),specularColorMapUv:bt&&g(A.specularColorMap.channel),specularIntensityMapUv:ln&&g(A.specularIntensityMap.channel),transmissionMapUv:Hn&&g(A.transmissionMap.channel),thicknessMapUv:Tr&&g(A.thicknessMap.channel),alphaMapUv:it&&g(A.alphaMap.channel),vertexTangents:!!j.attributes.tangent&&(Te||we),vertexColors:A.vertexColors,vertexAlphas:A.vertexColors===!0&&!!j.attributes.color&&j.attributes.color.itemSize===4,vertexUv1s:Zt,vertexUv2s:Ht,vertexUv3s:vr,pointsUvs:z.isPoints===!0&&!!j.attributes.uv&&(_e||it),fog:!!O,useFog:A.fog===!0,fogExp2:O&&O.isFogExp2,flatShading:A.flatShading===!0,sizeAttenuation:A.sizeAttenuation===!0,logarithmicDepthBuffer:d,skinning:z.isSkinnedMesh===!0,morphTargets:j.morphAttributes.position!==void 0,morphNormals:j.morphAttributes.normal!==void 0,morphColors:j.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:te,numDirLights:k.directional.length,numPointLights:k.point.length,numSpotLights:k.spot.length,numSpotLightMaps:k.spotLightMap.length,numRectAreaLights:k.rectArea.length,numHemiLights:k.hemi.length,numDirLightShadows:k.directionalShadowMap.length,numPointLightShadows:k.pointShadowMap.length,numSpotLightShadows:k.spotShadowMap.length,numSpotLightShadowsWithMaps:k.numSpotLightShadowsWithMaps,numLightProbes:k.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:A.dithering,shadowMapEnabled:t.shadowMap.enabled&&R.length>0,shadowMapType:t.shadowMap.type,toneMapping:ur,useLegacyLights:t._useLegacyLights,decodeVideoTexture:_e&&A.map.isVideoTexture===!0&&dr.getTransfer(A.map.colorSpace)===kr,premultipliedAlpha:A.premultipliedAlpha,doubleSided:A.side===Cu,flipSided:A.side===Ua,useDepthPacking:A.depthPacking>=0,depthPacking:A.depthPacking||0,index0AttributeName:A.index0AttributeName,extensionDerivatives:ht&&A.extensions.derivatives===!0,extensionFragDepth:ht&&A.extensions.fragDepth===!0,extensionDrawBuffers:ht&&A.extensions.drawBuffers===!0,extensionShaderTextureLOD:ht&&A.extensions.shaderTextureLOD===!0,extensionClipCullDistance:ht&&A.extensions.clipCullDistance&&r.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:r.has("KHR_parallel_shader_compile"),customProgramCacheKey:A.customProgramCacheKey()}}function y(A){const k=[];if(A.shaderID?k.push(A.shaderID):(k.push(A.customVertexShaderID),k.push(A.customFragmentShaderID)),A.defines!==void 0)for(const R in A.defines)k.push(R),k.push(A.defines[R]);return A.isRawShaderMaterial===!1&&(x(k,A),b(k,A),k.push(t.outputColorSpace)),k.push(A.customProgramCacheKey),k.join()}function x(A,k){A.push(k.precision),A.push(k.outputColorSpace),A.push(k.envMapMode),A.push(k.envMapCubeUVHeight),A.push(k.mapUv),A.push(k.alphaMapUv),A.push(k.lightMapUv),A.push(k.aoMapUv),A.push(k.bumpMapUv),A.push(k.normalMapUv),A.push(k.displacementMapUv),A.push(k.emissiveMapUv),A.push(k.metalnessMapUv),A.push(k.roughnessMapUv),A.push(k.anisotropyMapUv),A.push(k.clearcoatMapUv),A.push(k.clearcoatNormalMapUv),A.push(k.clearcoatRoughnessMapUv),A.push(k.iridescenceMapUv),A.push(k.iridescenceThicknessMapUv),A.push(k.sheenColorMapUv),A.push(k.sheenRoughnessMapUv),A.push(k.specularMapUv),A.push(k.specularColorMapUv),A.push(k.specularIntensityMapUv),A.push(k.transmissionMapUv),A.push(k.thicknessMapUv),A.push(k.combine),A.push(k.fogExp2),A.push(k.sizeAttenuation),A.push(k.morphTargetsCount),A.push(k.morphAttributeCount),A.push(k.numDirLights),A.push(k.numPointLights),A.push(k.numSpotLights),A.push(k.numSpotLightMaps),A.push(k.numHemiLights),A.push(k.numRectAreaLights),A.push(k.numDirLightShadows),A.push(k.numPointLightShadows),A.push(k.numSpotLightShadows),A.push(k.numSpotLightShadowsWithMaps),A.push(k.numLightProbes),A.push(k.shadowMapType),A.push(k.toneMapping),A.push(k.numClippingPlanes),A.push(k.numClipIntersection),A.push(k.depthPacking)}function b(A,k){o.disableAll(),k.isWebGL2&&o.enable(0),k.supportsVertexTextures&&o.enable(1),k.instancing&&o.enable(2),k.instancingColor&&o.enable(3),k.matcap&&o.enable(4),k.envMap&&o.enable(5),k.normalMapObjectSpace&&o.enable(6),k.normalMapTangentSpace&&o.enable(7),k.clearcoat&&o.enable(8),k.iridescence&&o.enable(9),k.alphaTest&&o.enable(10),k.vertexColors&&o.enable(11),k.vertexAlphas&&o.enable(12),k.vertexUv1s&&o.enable(13),k.vertexUv2s&&o.enable(14),k.vertexUv3s&&o.enable(15),k.vertexTangents&&o.enable(16),k.anisotropy&&o.enable(17),k.alphaHash&&o.enable(18),k.batching&&o.enable(19),A.push(o.mask),o.disableAll(),k.fog&&o.enable(0),k.useFog&&o.enable(1),k.flatShading&&o.enable(2),k.logarithmicDepthBuffer&&o.enable(3),k.skinning&&o.enable(4),k.morphTargets&&o.enable(5),k.morphNormals&&o.enable(6),k.morphColors&&o.enable(7),k.premultipliedAlpha&&o.enable(8),k.shadowMapEnabled&&o.enable(9),k.useLegacyLights&&o.enable(10),k.doubleSided&&o.enable(11),k.flipSided&&o.enable(12),k.useDepthPacking&&o.enable(13),k.dithering&&o.enable(14),k.transmission&&o.enable(15),k.sheen&&o.enable(16),k.opaque&&o.enable(17),k.pointsUvs&&o.enable(18),k.decodeVideoTexture&&o.enable(19),A.push(o.mask)}function _(A){const k=p[A.type];let R;if(k){const $=Tc[k];R=rve.clone($.uniforms)}else R=A.uniforms;return R}function T(A,k){let R;for(let $=0,z=c.length;$<z;$++){const O=c[$];if(O.cacheKey===k){R=O,++R.usedTimes;break}}return R===void 0&&(R=new ZCt(t,k,A,s),c.push(R)),R}function E(A){if(--A.usedTimes===0){const k=c.indexOf(A);c[k]=c[c.length-1],c.pop(),A.destroy()}}function C(A){l.remove(A)}function I(){l.dispose()}return{getParameters:m,getProgramCacheKey:y,getUniforms:_,acquireProgram:T,releaseProgram:E,releaseShaderCache:C,programs:c,dispose:I}}function nNt(){let t=new WeakMap;function e(s){let a=t.get(s);return a===void 0&&(a={},t.set(s,a)),a}function n(s){t.delete(s)}function r(s,a,o){t.get(s)[a]=o}function i(){t=new WeakMap}return{get:e,remove:n,update:r,dispose:i}}function rNt(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function jJ(t,e){return t.groupOrder!==e.groupOrder?t.groupOrder-e.groupOrder:t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function zJ(){const t=[];let e=0;const n=[],r=[],i=[];function s(){e=0,n.length=0,r.length=0,i.length=0}function a(d,h,f,p,g,m){let y=t[e];return y===void 0?(y={id:d.id,object:d,geometry:h,material:f,groupOrder:p,renderOrder:d.renderOrder,z:g,group:m},t[e]=y):(y.id=d.id,y.object=d,y.geometry=h,y.material=f,y.groupOrder=p,y.renderOrder=d.renderOrder,y.z=g,y.group=m),e++,y}function o(d,h,f,p,g,m){const y=a(d,h,f,p,g,m);f.transmission>0?r.push(y):f.transparent===!0?i.push(y):n.push(y)}function l(d,h,f,p,g,m){const y=a(d,h,f,p,g,m);f.transmission>0?r.unshift(y):f.transparent===!0?i.unshift(y):n.unshift(y)}function c(d,h){n.length>1&&n.sort(d||rNt),r.length>1&&r.sort(h||jJ),i.length>1&&i.sort(h||jJ)}function u(){for(let d=e,h=t.length;d<h;d++){const f=t[d];if(f.id===null)break;f.id=null,f.object=null,f.geometry=null,f.material=null,f.group=null}}return{opaque:n,transmissive:r,transparent:i,init:s,push:o,unshift:l,finish:u,sort:c}}function iNt(){let t=new WeakMap;function e(r,i){const s=t.get(r);let a;return s===void 0?(a=new zJ,t.set(r,[a])):i>=s.length?(a=new zJ,s.push(a)):a=s[i],a}function n(){t=new WeakMap}return{get:e,dispose:n}}function sNt(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={direction:new ne,color:new xt};break;case"SpotLight":n={position:new ne,direction:new ne,color:new xt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ne,color:new xt,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ne,skyColor:new xt,groundColor:new xt};break;case"RectAreaLight":n={color:new xt,position:new ne,halfWidth:new ne,halfHeight:new ne};break}return t[e.id]=n,n}}}function aNt(){const t={};return{get:function(e){if(t[e.id]!==void 0)return t[e.id];let n;switch(e.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Xe,shadowCameraNear:1,shadowCameraFar:1e3};break}return t[e.id]=n,n}}}let oNt=0;function lNt(t,e){return(e.castShadow?2:0)-(t.castShadow?2:0)+(e.map?1:0)-(t.map?1:0)}function cNt(t,e){const n=new sNt,r=aNt(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)i.probe.push(new ne);const s=new ne,a=new an,o=new an;function l(u,d){let h=0,f=0,p=0;for(let $=0;$<9;$++)i.probe[$].set(0,0,0);let g=0,m=0,y=0,x=0,b=0,_=0,T=0,E=0,C=0,I=0,A=0;u.sort(lNt);const k=d===!0?Math.PI:1;for(let $=0,z=u.length;$<z;$++){const O=u[$],j=O.color,B=O.intensity,W=O.distance,L=O.shadow&&O.shadow.map?O.shadow.map.texture:null;if(O.isAmbientLight)h+=j.r*B*k,f+=j.g*B*k,p+=j.b*B*k;else if(O.isLightProbe){for(let V=0;V<9;V++)i.probe[V].addScaledVector(O.sh.coefficients[V],B);A++}else if(O.isDirectionalLight){const V=n.get(O);if(V.color.copy(O.color).multiplyScalar(O.intensity*k),O.castShadow){const H=O.shadow,K=r.get(O);K.shadowBias=H.bias,K.shadowNormalBias=H.normalBias,K.shadowRadius=H.radius,K.shadowMapSize=H.mapSize,i.directionalShadow[g]=K,i.directionalShadowMap[g]=L,i.directionalShadowMatrix[g]=O.shadow.matrix,_++}i.directional[g]=V,g++}else if(O.isSpotLight){const V=n.get(O);V.position.setFromMatrixPosition(O.matrixWorld),V.color.copy(j).multiplyScalar(B*k),V.distance=W,V.coneCos=Math.cos(O.angle),V.penumbraCos=Math.cos(O.angle*(1-O.penumbra)),V.decay=O.decay,i.spot[y]=V;const H=O.shadow;if(O.map&&(i.spotLightMap[C]=O.map,C++,H.updateMatrices(O),O.castShadow&&I++),i.spotLightMatrix[y]=H.matrix,O.castShadow){const K=r.get(O);K.shadowBias=H.bias,K.shadowNormalBias=H.normalBias,K.shadowRadius=H.radius,K.shadowMapSize=H.mapSize,i.spotShadow[y]=K,i.spotShadowMap[y]=L,E++}y++}else if(O.isRectAreaLight){const V=n.get(O);V.color.copy(j).multiplyScalar(B),V.halfWidth.set(O.width*.5,0,0),V.halfHeight.set(0,O.height*.5,0),i.rectArea[x]=V,x++}else if(O.isPointLight){const V=n.get(O);if(V.color.copy(O.color).multiplyScalar(O.intensity*k),V.distance=O.distance,V.decay=O.decay,O.castShadow){const H=O.shadow,K=r.get(O);K.shadowBias=H.bias,K.shadowNormalBias=H.normalBias,K.shadowRadius=H.radius,K.shadowMapSize=H.mapSize,K.shadowCameraNear=H.camera.near,K.shadowCameraFar=H.camera.far,i.pointShadow[m]=K,i.pointShadowMap[m]=L,i.pointShadowMatrix[m]=O.shadow.matrix,T++}i.point[m]=V,m++}else if(O.isHemisphereLight){const V=n.get(O);V.skyColor.copy(O.color).multiplyScalar(B*k),V.groundColor.copy(O.groundColor).multiplyScalar(B*k),i.hemi[b]=V,b++}}x>0&&(e.isWebGL2?t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=at.LTC_FLOAT_1,i.rectAreaLTC2=at.LTC_FLOAT_2):(i.rectAreaLTC1=at.LTC_HALF_1,i.rectAreaLTC2=at.LTC_HALF_2):t.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=at.LTC_FLOAT_1,i.rectAreaLTC2=at.LTC_FLOAT_2):t.has("OES_texture_half_float_linear")===!0?(i.rectAreaLTC1=at.LTC_HALF_1,i.rectAreaLTC2=at.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),i.ambient[0]=h,i.ambient[1]=f,i.ambient[2]=p;const R=i.hash;(R.directionalLength!==g||R.pointLength!==m||R.spotLength!==y||R.rectAreaLength!==x||R.hemiLength!==b||R.numDirectionalShadows!==_||R.numPointShadows!==T||R.numSpotShadows!==E||R.numSpotMaps!==C||R.numLightProbes!==A)&&(i.directional.length=g,i.spot.length=y,i.rectArea.length=x,i.point.length=m,i.hemi.length=b,i.directionalShadow.length=_,i.directionalShadowMap.length=_,i.pointShadow.length=T,i.pointShadowMap.length=T,i.spotShadow.length=E,i.spotShadowMap.length=E,i.directionalShadowMatrix.length=_,i.pointShadowMatrix.length=T,i.spotLightMatrix.length=E+C-I,i.spotLightMap.length=C,i.numSpotLightShadowsWithMaps=I,i.numLightProbes=A,R.directionalLength=g,R.pointLength=m,R.spotLength=y,R.rectAreaLength=x,R.hemiLength=b,R.numDirectionalShadows=_,R.numPointShadows=T,R.numSpotShadows=E,R.numSpotMaps=C,R.numLightProbes=A,i.version=oNt++)}function c(u,d){let h=0,f=0,p=0,g=0,m=0;const y=d.matrixWorldInverse;for(let x=0,b=u.length;x<b;x++){const _=u[x];if(_.isDirectionalLight){const T=i.directional[h];T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),h++}else if(_.isSpotLight){const T=i.spot[p];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),T.direction.setFromMatrixPosition(_.matrixWorld),s.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(s),T.direction.transformDirection(y),p++}else if(_.isRectAreaLight){const T=i.rectArea[g];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),o.identity(),a.copy(_.matrixWorld),a.premultiply(y),o.extractRotation(a),T.halfWidth.set(_.width*.5,0,0),T.halfHeight.set(0,_.height*.5,0),T.halfWidth.applyMatrix4(o),T.halfHeight.applyMatrix4(o),g++}else if(_.isPointLight){const T=i.point[f];T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(y),f++}else if(_.isHemisphereLight){const T=i.hemi[m];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(y),m++}}}return{setup:l,setupView:c,state:i}}function BJ(t,e){const n=new cNt(t,e),r=[],i=[];function s(){r.length=0,i.length=0}function a(d){r.push(d)}function o(d){i.push(d)}function l(d){n.setup(r,d)}function c(d){n.setupView(r,d)}return{init:s,state:{lightsArray:r,shadowsArray:i,lights:n},setupLights:l,setupLightsView:c,pushLight:a,pushShadow:o}}function uNt(t,e){let n=new WeakMap;function r(s,a=0){const o=n.get(s);let l;return o===void 0?(l=new BJ(t,e),n.set(s,[l])):a>=o.length?(l=new BJ(t,e),o.push(l)):l=o[a],l}function i(){n=new WeakMap}return{get:r,dispose:i}}class NG extends _a{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Uye,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class AG extends _a{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const dNt=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,hNt=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function fNt(t,e,n){let r=new mE;const i=new Xe,s=new Xe,a=new hr,o=new NG({depthPacking:Vye}),l=new AG,c={},u=n.maxTextureSize,d={[dh]:Ua,[Ua]:dh,[Cu]:Cu},h=new Ju({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Xe},radius:{value:4}},vertexShader:dNt,fragmentShader:hNt}),f=h.clone();f.defines.HORIZONTAL_PASS=1;const p=new Cn;p.setAttribute("position",new mr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const g=new ls(p,h),m=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=HP;let y=this.type;this.render=function(E,C,I){if(m.enabled===!1||m.autoUpdate===!1&&m.needsUpdate===!1||E.length===0)return;const A=t.getRenderTarget(),k=t.getActiveCubeFace(),R=t.getActiveMipmapLevel(),$=t.state;$.setBlending(Xd),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const z=y!==mc&&this.type===mc,O=y===mc&&this.type!==mc;for(let j=0,B=E.length;j<B;j++){const W=E[j],L=W.shadow;if(L===void 0){console.warn("THREE.WebGLShadowMap:",W,"has no shadow.");continue}if(L.autoUpdate===!1&&L.needsUpdate===!1)continue;i.copy(L.mapSize);const V=L.getFrameExtents();if(i.multiply(V),s.copy(L.mapSize),(i.x>u||i.y>u)&&(i.x>u&&(s.x=Math.floor(u/V.x),i.x=s.x*V.x,L.mapSize.x=s.x),i.y>u&&(s.y=Math.floor(u/V.y),i.y=s.y*V.y,L.mapSize.y=s.y)),L.map===null||z===!0||O===!0){const K=this.type!==mc?{minFilter:Ii,magFilter:Ii}:{};L.map!==null&&L.map.dispose(),L.map=new Kc(i.x,i.y,K),L.map.texture.name=W.name+".shadowMap",L.camera.updateProjectionMatrix()}t.setRenderTarget(L.map),t.clear();const H=L.getViewportCount();for(let K=0;K<H;K++){const te=L.getViewport(K);a.set(s.x*te.x,s.y*te.y,s.x*te.z,s.y*te.w),$.viewport(a),L.updateMatrices(W,K),r=L.getFrustum(),_(C,I,L.camera,W,this.type)}L.isPointLightShadow!==!0&&this.type===mc&&x(L,I),L.needsUpdate=!1}y=this.type,m.needsUpdate=!1,t.setRenderTarget(A,k,R)};function x(E,C){const I=e.update(g);h.defines.VSM_SAMPLES!==E.blurSamples&&(h.defines.VSM_SAMPLES=E.blurSamples,f.defines.VSM_SAMPLES=E.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),E.mapPass===null&&(E.mapPass=new Kc(i.x,i.y)),h.uniforms.shadow_pass.value=E.map.texture,h.uniforms.resolution.value=E.mapSize,h.uniforms.radius.value=E.radius,t.setRenderTarget(E.mapPass),t.clear(),t.renderBufferDirect(C,null,I,h,g,null),f.uniforms.shadow_pass.value=E.mapPass.texture,f.uniforms.resolution.value=E.mapSize,f.uniforms.radius.value=E.radius,t.setRenderTarget(E.map),t.clear(),t.renderBufferDirect(C,null,I,f,g,null)}function b(E,C,I,A){let k=null;const R=I.isPointLight===!0?E.customDistanceMaterial:E.customDepthMaterial;if(R!==void 0)k=R;else if(k=I.isPointLight===!0?l:o,t.localClippingEnabled&&C.clipShadows===!0&&Array.isArray(C.clippingPlanes)&&C.clippingPlanes.length!==0||C.displacementMap&&C.displacementScale!==0||C.alphaMap&&C.alphaTest>0||C.map&&C.alphaTest>0){const $=k.uuid,z=C.uuid;let O=c[$];O===void 0&&(O={},c[$]=O);let j=O[z];j===void 0&&(j=k.clone(),O[z]=j,C.addEventListener("dispose",T)),k=j}if(k.visible=C.visible,k.wireframe=C.wireframe,A===mc?k.side=C.shadowSide!==null?C.shadowSide:C.side:k.side=C.shadowSide!==null?C.shadowSide:d[C.side],k.alphaMap=C.alphaMap,k.alphaTest=C.alphaTest,k.map=C.map,k.clipShadows=C.clipShadows,k.clippingPlanes=C.clippingPlanes,k.clipIntersection=C.clipIntersection,k.displacementMap=C.displacementMap,k.displacementScale=C.displacementScale,k.displacementBias=C.displacementBias,k.wireframeLinewidth=C.wireframeLinewidth,k.linewidth=C.linewidth,I.isPointLight===!0&&k.isMeshDistanceMaterial===!0){const $=t.properties.get(k);$.light=I}return k}function _(E,C,I,A,k){if(E.visible===!1)return;if(E.layers.test(C.layers)&&(E.isMesh||E.isLine||E.isPoints)&&(E.castShadow||E.receiveShadow&&k===mc)&&(!E.frustumCulled||r.intersectsObject(E))){E.modelViewMatrix.multiplyMatrices(I.matrixWorldInverse,E.matrixWorld);const z=e.update(E),O=E.material;if(Array.isArray(O)){const j=z.groups;for(let B=0,W=j.length;B<W;B++){const L=j[B],V=O[L.materialIndex];if(V&&V.visible){const H=b(E,V,A,k);E.onBeforeShadow(t,E,C,I,z,H,L),t.renderBufferDirect(I,null,z,H,E,L),E.onAfterShadow(t,E,C,I,z,H,L)}}}else if(O.visible){const j=b(E,O,A,k);E.onBeforeShadow(t,E,C,I,z,j,null),t.renderBufferDirect(I,null,z,j,E,null),E.onAfterShadow(t,E,C,I,z,j,null)}}const $=E.children;for(let z=0,O=$.length;z<O;z++)_($[z],C,I,A,k)}function T(E){E.target.removeEventListener("dispose",T);for(const I in c){const A=c[I],k=E.target.uuid;k in A&&(A[k].dispose(),delete A[k])}}}function pNt(t,e,n){const r=n.isWebGL2;function i(){let pe=!1;const dt=new hr;let ht=null;const Zt=new hr(0,0,0,0);return{setMask:function(Ht){ht!==Ht&&!pe&&(t.colorMask(Ht,Ht,Ht,Ht),ht=Ht)},setLocked:function(Ht){pe=Ht},setClear:function(Ht,vr,ur,Ti,ms){ms===!0&&(Ht*=Ti,vr*=Ti,ur*=Ti),dt.set(Ht,vr,ur,Ti),Zt.equals(dt)===!1&&(t.clearColor(Ht,vr,ur,Ti),Zt.copy(dt))},reset:function(){pe=!1,ht=null,Zt.set(-1,0,0,0)}}}function s(){let pe=!1,dt=null,ht=null,Zt=null;return{setTest:function(Ht){Ht?ge(t.DEPTH_TEST):_e(t.DEPTH_TEST)},setMask:function(Ht){dt!==Ht&&!pe&&(t.depthMask(Ht),dt=Ht)},setFunc:function(Ht){if(ht!==Ht){switch(Ht){case gye:t.depthFunc(t.NEVER);break;case yye:t.depthFunc(t.ALWAYS);break;case vye:t.depthFunc(t.LESS);break;case t_:t.depthFunc(t.LEQUAL);break;case xye:t.depthFunc(t.EQUAL);break;case bye:t.depthFunc(t.GEQUAL);break;case wye:t.depthFunc(t.GREATER);break;case Sye:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}ht=Ht}},setLocked:function(Ht){pe=Ht},setClear:function(Ht){Zt!==Ht&&(t.clearDepth(Ht),Zt=Ht)},reset:function(){pe=!1,dt=null,ht=null,Zt=null}}}function a(){let pe=!1,dt=null,ht=null,Zt=null,Ht=null,vr=null,ur=null,Ti=null,ms=null;return{setTest:function(xr){pe||(xr?ge(t.STENCIL_TEST):_e(t.STENCIL_TEST))},setMask:function(xr){dt!==xr&&!pe&&(t.stencilMask(xr),dt=xr)},setFunc:function(xr,Ds,ol){(ht!==xr||Zt!==Ds||Ht!==ol)&&(t.stencilFunc(xr,Ds,ol),ht=xr,Zt=Ds,Ht=ol)},setOp:function(xr,Ds,ol){(vr!==xr||ur!==Ds||Ti!==ol)&&(t.stencilOp(xr,Ds,ol),vr=xr,ur=Ds,Ti=ol)},setLocked:function(xr){pe=xr},setClear:function(xr){ms!==xr&&(t.clearStencil(xr),ms=xr)},reset:function(){pe=!1,dt=null,ht=null,Zt=null,Ht=null,vr=null,ur=null,Ti=null,ms=null}}}const o=new i,l=new s,c=new a,u=new WeakMap,d=new WeakMap;let h={},f={},p=new WeakMap,g=[],m=null,y=!1,x=null,b=null,_=null,T=null,E=null,C=null,I=null,A=new xt(0,0,0),k=0,R=!1,$=null,z=null,O=null,j=null,B=null;const W=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let L=!1,V=0;const H=t.getParameter(t.VERSION);H.indexOf("WebGL")!==-1?(V=parseFloat(/^WebGL (\d)/.exec(H)[1]),L=V>=1):H.indexOf("OpenGL ES")!==-1&&(V=parseFloat(/^OpenGL ES (\d)/.exec(H)[1]),L=V>=2);let K=null,te={};const J=t.getParameter(t.SCISSOR_BOX),oe=t.getParameter(t.VIEWPORT),fe=new hr().fromArray(J),Ee=new hr().fromArray(oe);function me(pe,dt,ht,Zt){const Ht=new Uint8Array(4),vr=t.createTexture();t.bindTexture(pe,vr),t.texParameteri(pe,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(pe,t.TEXTURE_MAG_FILTER,t.NEAREST);for(let ur=0;ur<ht;ur++)r&&(pe===t.TEXTURE_3D||pe===t.TEXTURE_2D_ARRAY)?t.texImage3D(dt,0,t.RGBA,1,1,Zt,0,t.RGBA,t.UNSIGNED_BYTE,Ht):t.texImage2D(dt+ur,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,Ht);return vr}const De={};De[t.TEXTURE_2D]=me(t.TEXTURE_2D,t.TEXTURE_2D,1),De[t.TEXTURE_CUBE_MAP]=me(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(De[t.TEXTURE_2D_ARRAY]=me(t.TEXTURE_2D_ARRAY,t.TEXTURE_2D_ARRAY,1,1),De[t.TEXTURE_3D]=me(t.TEXTURE_3D,t.TEXTURE_3D,1,1)),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),ge(t.DEPTH_TEST),l.setFunc(t_),qe(!1),Q(f4),ge(t.CULL_FACE),Te(Xd);function ge(pe){h[pe]!==!0&&(t.enable(pe),h[pe]=!0)}function _e(pe){h[pe]!==!1&&(t.disable(pe),h[pe]=!1)}function Ce(pe,dt){return f[pe]!==dt?(t.bindFramebuffer(pe,dt),f[pe]=dt,r&&(pe===t.DRAW_FRAMEBUFFER&&(f[t.FRAMEBUFFER]=dt),pe===t.FRAMEBUFFER&&(f[t.DRAW_FRAMEBUFFER]=dt)),!0):!1}function G(pe,dt){let ht=g,Zt=!1;if(pe)if(ht=p.get(dt),ht===void 0&&(ht=[],p.set(dt,ht)),pe.isWebGLMultipleRenderTargets){const Ht=pe.texture;if(ht.length!==Ht.length||ht[0]!==t.COLOR_ATTACHMENT0){for(let vr=0,ur=Ht.length;vr<ur;vr++)ht[vr]=t.COLOR_ATTACHMENT0+vr;ht.length=Ht.length,Zt=!0}}else ht[0]!==t.COLOR_ATTACHMENT0&&(ht[0]=t.COLOR_ATTACHMENT0,Zt=!0);else ht[0]!==t.BACK&&(ht[0]=t.BACK,Zt=!0);Zt&&(n.isWebGL2?t.drawBuffers(ht):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(ht))}function ke(pe){return m!==pe?(t.useProgram(pe),m=pe,!0):!1}const xe={[rf]:t.FUNC_ADD,[tye]:t.FUNC_SUBTRACT,[nye]:t.FUNC_REVERSE_SUBTRACT};if(r)xe[y4]=t.MIN,xe[v4]=t.MAX;else{const pe=e.get("EXT_blend_minmax");pe!==null&&(xe[y4]=pe.MIN_EXT,xe[v4]=pe.MAX_EXT)}const Pe={[rye]:t.ZERO,[iye]:t.ONE,[sye]:t.SRC_COLOR,[pk]:t.SRC_ALPHA,[dye]:t.SRC_ALPHA_SATURATE,[cye]:t.DST_COLOR,[oye]:t.DST_ALPHA,[aye]:t.ONE_MINUS_SRC_COLOR,[mk]:t.ONE_MINUS_SRC_ALPHA,[uye]:t.ONE_MINUS_DST_COLOR,[lye]:t.ONE_MINUS_DST_ALPHA,[hye]:t.CONSTANT_COLOR,[fye]:t.ONE_MINUS_CONSTANT_COLOR,[pye]:t.CONSTANT_ALPHA,[mye]:t.ONE_MINUS_CONSTANT_ALPHA};function Te(pe,dt,ht,Zt,Ht,vr,ur,Ti,ms,xr){if(pe===Xd){y===!0&&(_e(t.BLEND),y=!1);return}if(y===!1&&(ge(t.BLEND),y=!0),pe!==eye){if(pe!==x||xr!==R){if((b!==rf||E!==rf)&&(t.blendEquation(t.FUNC_ADD),b=rf,E=rf),xr)switch(pe){case Jm:t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case p4:t.blendFunc(t.ONE,t.ONE);break;case m4:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case g4:t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}else switch(pe){case Jm:t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA);break;case p4:t.blendFunc(t.SRC_ALPHA,t.ONE);break;case m4:t.blendFuncSeparate(t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ZERO,t.ONE);break;case g4:t.blendFunc(t.ZERO,t.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",pe);break}_=null,T=null,C=null,I=null,A.set(0,0,0),k=0,x=pe,R=xr}return}Ht=Ht||dt,vr=vr||ht,ur=ur||Zt,(dt!==b||Ht!==E)&&(t.blendEquationSeparate(xe[dt],xe[Ht]),b=dt,E=Ht),(ht!==_||Zt!==T||vr!==C||ur!==I)&&(t.blendFuncSeparate(Pe[ht],Pe[Zt],Pe[vr],Pe[ur]),_=ht,T=Zt,C=vr,I=ur),(Ti.equals(A)===!1||ms!==k)&&(t.blendColor(Ti.r,Ti.g,Ti.b,ms),A.copy(Ti),k=ms),x=pe,R=!1}function Ye(pe,dt){pe.side===Cu?_e(t.CULL_FACE):ge(t.CULL_FACE);let ht=pe.side===Ua;dt&&(ht=!ht),qe(ht),pe.blending===Jm&&pe.transparent===!1?Te(Xd):Te(pe.blending,pe.blendEquation,pe.blendSrc,pe.blendDst,pe.blendEquationAlpha,pe.blendSrcAlpha,pe.blendDstAlpha,pe.blendColor,pe.blendAlpha,pe.premultipliedAlpha),l.setFunc(pe.depthFunc),l.setTest(pe.depthTest),l.setMask(pe.depthWrite),o.setMask(pe.colorWrite);const Zt=pe.stencilWrite;c.setTest(Zt),Zt&&(c.setMask(pe.stencilWriteMask),c.setFunc(pe.stencilFunc,pe.stencilRef,pe.stencilFuncMask),c.setOp(pe.stencilFail,pe.stencilZFail,pe.stencilZPass)),we(pe.polygonOffset,pe.polygonOffsetFactor,pe.polygonOffsetUnits),pe.alphaToCoverage===!0?ge(t.SAMPLE_ALPHA_TO_COVERAGE):_e(t.SAMPLE_ALPHA_TO_COVERAGE)}function qe(pe){$!==pe&&(pe?t.frontFace(t.CW):t.frontFace(t.CCW),$=pe)}function Q(pe){pe!==Zge?(ge(t.CULL_FACE),pe!==z&&(pe===f4?t.cullFace(t.BACK):pe===Qge?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):_e(t.CULL_FACE),z=pe}function X(pe){pe!==O&&(L&&t.lineWidth(pe),O=pe)}function we(pe,dt,ht){pe?(ge(t.POLYGON_OFFSET_FILL),(j!==dt||B!==ht)&&(t.polygonOffset(dt,ht),j=dt,B=ht)):_e(t.POLYGON_OFFSET_FILL)}function Z(pe){pe?ge(t.SCISSOR_TEST):_e(t.SCISSOR_TEST)}function ie(pe){pe===void 0&&(pe=t.TEXTURE0+W-1),K!==pe&&(t.activeTexture(pe),K=pe)}function ae(pe,dt,ht){ht===void 0&&(K===null?ht=t.TEXTURE0+W-1:ht=K);let Zt=te[ht];Zt===void 0&&(Zt={type:void 0,texture:void 0},te[ht]=Zt),(Zt.type!==pe||Zt.texture!==dt)&&(K!==ht&&(t.activeTexture(ht),K=ht),t.bindTexture(pe,dt||De[pe]),Zt.type=pe,Zt.texture=dt)}function Le(){const pe=te[K];pe!==void 0&&pe.type!==void 0&&(t.bindTexture(pe.type,null),pe.type=void 0,pe.texture=void 0)}function Ae(){try{t.compressedTexImage2D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ie(){try{t.compressedTexImage3D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ge(){try{t.texSubImage2D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function rt(){try{t.texSubImage3D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function We(){try{t.compressedTexSubImage2D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ut(){try{t.compressedTexSubImage3D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function hn(){try{t.texStorage2D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Vt(){try{t.texStorage3D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function Ot(){try{t.texImage2D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function bt(){try{t.texImage3D.apply(t,arguments)}catch(pe){console.error("THREE.WebGLState:",pe)}}function ln(pe){fe.equals(pe)===!1&&(t.scissor(pe.x,pe.y,pe.z,pe.w),fe.copy(pe))}function Hn(pe){Ee.equals(pe)===!1&&(t.viewport(pe.x,pe.y,pe.z,pe.w),Ee.copy(pe))}function Tr(pe,dt){let ht=d.get(dt);ht===void 0&&(ht=new WeakMap,d.set(dt,ht));let Zt=ht.get(pe);Zt===void 0&&(Zt=t.getUniformBlockIndex(dt,pe.name),ht.set(pe,Zt))}function Sn(pe,dt){const Zt=d.get(dt).get(pe);u.get(dt)!==Zt&&(t.uniformBlockBinding(dt,Zt,pe.__bindingPointIndex),u.set(dt,Zt))}function it(){t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SCISSOR_TEST),t.disable(t.STENCIL_TEST),t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.blendFuncSeparate(t.ONE,t.ZERO,t.ONE,t.ZERO),t.blendColor(0,0,0,0),t.colorMask(!0,!0,!0,!0),t.clearColor(0,0,0,0),t.depthMask(!0),t.depthFunc(t.LESS),t.clearDepth(1),t.stencilMask(4294967295),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.clearStencil(0),t.cullFace(t.BACK),t.frontFace(t.CCW),t.polygonOffset(0,0),t.activeTexture(t.TEXTURE0),t.bindFramebuffer(t.FRAMEBUFFER,null),r===!0&&(t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),t.bindFramebuffer(t.READ_FRAMEBUFFER,null)),t.useProgram(null),t.lineWidth(1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.viewport(0,0,t.canvas.width,t.canvas.height),h={},K=null,te={},f={},p=new WeakMap,g=[],m=null,y=!1,x=null,b=null,_=null,T=null,E=null,C=null,I=null,A=new xt(0,0,0),k=0,R=!1,$=null,z=null,O=null,j=null,B=null,fe.set(0,0,t.canvas.width,t.canvas.height),Ee.set(0,0,t.canvas.width,t.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:ge,disable:_e,bindFramebuffer:Ce,drawBuffers:G,useProgram:ke,setBlending:Te,setMaterial:Ye,setFlipSided:qe,setCullFace:Q,setLineWidth:X,setPolygonOffset:we,setScissorTest:Z,activeTexture:ie,bindTexture:ae,unbindTexture:Le,compressedTexImage2D:Ae,compressedTexImage3D:Ie,texImage2D:Ot,texImage3D:bt,updateUBOMapping:Tr,uniformBlockBinding:Sn,texStorage2D:hn,texStorage3D:Vt,texSubImage2D:Ge,texSubImage3D:rt,compressedTexSubImage2D:We,compressedTexSubImage3D:Ut,scissor:ln,viewport:Hn,reset:it}}function mNt(t,e,n,r,i,s,a){const o=i.isWebGL2,l=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,c=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new WeakMap;let d;const h=new WeakMap;let f=!1;try{f=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function p(Q,X){return f?new OffscreenCanvas(Q,X):f_("canvas")}function g(Q,X,we,Z){let ie=1;if((Q.width>Z||Q.height>Z)&&(ie=Z/Math.max(Q.width,Q.height)),ie<1||X===!0)if(typeof HTMLImageElement<"u"&&Q instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Q instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Q instanceof ImageBitmap){const ae=X?vk:Math.floor,Le=ae(ie*Q.width),Ae=ae(ie*Q.height);d===void 0&&(d=p(Le,Ae));const Ie=we?p(Le,Ae):d;return Ie.width=Le,Ie.height=Ae,Ie.getContext("2d").drawImage(Q,0,0,Le,Ae),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+Q.width+"x"+Q.height+") to ("+Le+"x"+Ae+")."),Ie}else return"data"in Q&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+Q.width+"x"+Q.height+")."),Q;return Q}function m(Q){return q4(Q.width)&&q4(Q.height)}function y(Q){return o?!1:Q.wrapS!==pa||Q.wrapT!==pa||Q.minFilter!==Ii&&Q.minFilter!==Ri}function x(Q,X){return Q.generateMipmaps&&X&&Q.minFilter!==Ii&&Q.minFilter!==Ri}function b(Q){t.generateMipmap(Q)}function _(Q,X,we,Z,ie=!1){if(o===!1)return X;if(Q!==null){if(t[Q]!==void 0)return t[Q];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Q+"'")}let ae=X;if(X===t.RED&&(we===t.FLOAT&&(ae=t.R32F),we===t.HALF_FLOAT&&(ae=t.R16F),we===t.UNSIGNED_BYTE&&(ae=t.R8)),X===t.RED_INTEGER&&(we===t.UNSIGNED_BYTE&&(ae=t.R8UI),we===t.UNSIGNED_SHORT&&(ae=t.R16UI),we===t.UNSIGNED_INT&&(ae=t.R32UI),we===t.BYTE&&(ae=t.R8I),we===t.SHORT&&(ae=t.R16I),we===t.INT&&(ae=t.R32I)),X===t.RG&&(we===t.FLOAT&&(ae=t.RG32F),we===t.HALF_FLOAT&&(ae=t.RG16F),we===t.UNSIGNED_BYTE&&(ae=t.RG8)),X===t.RGBA){const Le=ie?c_:dr.getTransfer(Z);we===t.FLOAT&&(ae=t.RGBA32F),we===t.HALF_FLOAT&&(ae=t.RGBA16F),we===t.UNSIGNED_BYTE&&(ae=Le===kr?t.SRGB8_ALPHA8:t.RGBA8),we===t.UNSIGNED_SHORT_4_4_4_4&&(ae=t.RGBA4),we===t.UNSIGNED_SHORT_5_5_5_1&&(ae=t.RGB5_A1)}return(ae===t.R16F||ae===t.R32F||ae===t.RG16F||ae===t.RG32F||ae===t.RGBA16F||ae===t.RGBA32F)&&e.get("EXT_color_buffer_float"),ae}function T(Q,X,we){return x(Q,we)===!0||Q.isFramebufferTexture&&Q.minFilter!==Ii&&Q.minFilter!==Ri?Math.log2(Math.max(X.width,X.height))+1:Q.mipmaps!==void 0&&Q.mipmaps.length>0?Q.mipmaps.length:Q.isCompressedTexture&&Array.isArray(Q.image)?X.mipmaps.length:1}function E(Q){return Q===Ii||Q===gk||Q===b1?t.NEAREST:t.LINEAR}function C(Q){const X=Q.target;X.removeEventListener("dispose",C),A(X),X.isVideoTexture&&u.delete(X)}function I(Q){const X=Q.target;X.removeEventListener("dispose",I),R(X)}function A(Q){const X=r.get(Q);if(X.__webglInit===void 0)return;const we=Q.source,Z=h.get(we);if(Z){const ie=Z[X.__cacheKey];ie.usedTimes--,ie.usedTimes===0&&k(Q),Object.keys(Z).length===0&&h.delete(we)}r.remove(Q)}function k(Q){const X=r.get(Q);t.deleteTexture(X.__webglTexture);const we=Q.source,Z=h.get(we);delete Z[X.__cacheKey],a.memory.textures--}function R(Q){const X=Q.texture,we=r.get(Q),Z=r.get(X);if(Z.__webglTexture!==void 0&&(t.deleteTexture(Z.__webglTexture),a.memory.textures--),Q.depthTexture&&Q.depthTexture.dispose(),Q.isWebGLCubeRenderTarget)for(let ie=0;ie<6;ie++){if(Array.isArray(we.__webglFramebuffer[ie]))for(let ae=0;ae<we.__webglFramebuffer[ie].length;ae++)t.deleteFramebuffer(we.__webglFramebuffer[ie][ae]);else t.deleteFramebuffer(we.__webglFramebuffer[ie]);we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer[ie])}else{if(Array.isArray(we.__webglFramebuffer))for(let ie=0;ie<we.__webglFramebuffer.length;ie++)t.deleteFramebuffer(we.__webglFramebuffer[ie]);else t.deleteFramebuffer(we.__webglFramebuffer);if(we.__webglDepthbuffer&&t.deleteRenderbuffer(we.__webglDepthbuffer),we.__webglMultisampledFramebuffer&&t.deleteFramebuffer(we.__webglMultisampledFramebuffer),we.__webglColorRenderbuffer)for(let ie=0;ie<we.__webglColorRenderbuffer.length;ie++)we.__webglColorRenderbuffer[ie]&&t.deleteRenderbuffer(we.__webglColorRenderbuffer[ie]);we.__webglDepthRenderbuffer&&t.deleteRenderbuffer(we.__webglDepthRenderbuffer)}if(Q.isWebGLMultipleRenderTargets)for(let ie=0,ae=X.length;ie<ae;ie++){const Le=r.get(X[ie]);Le.__webglTexture&&(t.deleteTexture(Le.__webglTexture),a.memory.textures--),r.remove(X[ie])}r.remove(X),r.remove(Q)}let $=0;function z(){$=0}function O(){const Q=$;return Q>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+Q+" texture units while this GPU supports only "+i.maxTextures),$+=1,Q}function j(Q){const X=[];return X.push(Q.wrapS),X.push(Q.wrapT),X.push(Q.wrapR||0),X.push(Q.magFilter),X.push(Q.minFilter),X.push(Q.anisotropy),X.push(Q.internalFormat),X.push(Q.format),X.push(Q.type),X.push(Q.generateMipmaps),X.push(Q.premultiplyAlpha),X.push(Q.flipY),X.push(Q.unpackAlignment),X.push(Q.colorSpace),X.join()}function B(Q,X){const we=r.get(Q);if(Q.isVideoTexture&&Ye(Q),Q.isRenderTargetTexture===!1&&Q.version>0&&we.__version!==Q.version){const Z=Q.image;if(Z===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Z.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fe(we,Q,X);return}}n.bindTexture(t.TEXTURE_2D,we.__webglTexture,t.TEXTURE0+X)}function W(Q,X){const we=r.get(Q);if(Q.version>0&&we.__version!==Q.version){fe(we,Q,X);return}n.bindTexture(t.TEXTURE_2D_ARRAY,we.__webglTexture,t.TEXTURE0+X)}function L(Q,X){const we=r.get(Q);if(Q.version>0&&we.__version!==Q.version){fe(we,Q,X);return}n.bindTexture(t.TEXTURE_3D,we.__webglTexture,t.TEXTURE0+X)}function V(Q,X){const we=r.get(Q);if(Q.version>0&&we.__version!==Q.version){Ee(we,Q,X);return}n.bindTexture(t.TEXTURE_CUBE_MAP,we.__webglTexture,t.TEXTURE0+X)}const H={[i_]:t.REPEAT,[pa]:t.CLAMP_TO_EDGE,[s_]:t.MIRRORED_REPEAT},K={[Ii]:t.NEAREST,[gk]:t.NEAREST_MIPMAP_NEAREST,[b1]:t.NEAREST_MIPMAP_LINEAR,[Ri]:t.LINEAR,[cG]:t.LINEAR_MIPMAP_NEAREST,[tp]:t.LINEAR_MIPMAP_LINEAR},te={[Hye]:t.NEVER,[Zye]:t.ALWAYS,[Gye]:t.LESS,[xG]:t.LEQUAL,[qye]:t.EQUAL,[Yye]:t.GEQUAL,[Xye]:t.GREATER,[Kye]:t.NOTEQUAL};function J(Q,X,we){if(we?(t.texParameteri(Q,t.TEXTURE_WRAP_S,H[X.wrapS]),t.texParameteri(Q,t.TEXTURE_WRAP_T,H[X.wrapT]),(Q===t.TEXTURE_3D||Q===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Q,t.TEXTURE_WRAP_R,H[X.wrapR]),t.texParameteri(Q,t.TEXTURE_MAG_FILTER,K[X.magFilter]),t.texParameteri(Q,t.TEXTURE_MIN_FILTER,K[X.minFilter])):(t.texParameteri(Q,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(Q,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),(Q===t.TEXTURE_3D||Q===t.TEXTURE_2D_ARRAY)&&t.texParameteri(Q,t.TEXTURE_WRAP_R,t.CLAMP_TO_EDGE),(X.wrapS!==pa||X.wrapT!==pa)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(Q,t.TEXTURE_MAG_FILTER,E(X.magFilter)),t.texParameteri(Q,t.TEXTURE_MIN_FILTER,E(X.minFilter)),X.minFilter!==Ii&&X.minFilter!==Ri&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),X.compareFunction&&(t.texParameteri(Q,t.TEXTURE_COMPARE_MODE,t.COMPARE_REF_TO_TEXTURE),t.texParameteri(Q,t.TEXTURE_COMPARE_FUNC,te[X.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Z=e.get("EXT_texture_filter_anisotropic");if(X.magFilter===Ii||X.minFilter!==b1&&X.minFilter!==tp||X.type===Pc&&e.has("OES_texture_float_linear")===!1||o===!1&&X.type===N0&&e.has("OES_texture_half_float_linear")===!1)return;(X.anisotropy>1||r.get(X).__currentAnisotropy)&&(t.texParameterf(Q,Z.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(X.anisotropy,i.getMaxAnisotropy())),r.get(X).__currentAnisotropy=X.anisotropy)}}function oe(Q,X){let we=!1;Q.__webglInit===void 0&&(Q.__webglInit=!0,X.addEventListener("dispose",C));const Z=X.source;let ie=h.get(Z);ie===void 0&&(ie={},h.set(Z,ie));const ae=j(X);if(ae!==Q.__cacheKey){ie[ae]===void 0&&(ie[ae]={texture:t.createTexture(),usedTimes:0},a.memory.textures++,we=!0),ie[ae].usedTimes++;const Le=ie[Q.__cacheKey];Le!==void 0&&(ie[Q.__cacheKey].usedTimes--,Le.usedTimes===0&&k(X)),Q.__cacheKey=ae,Q.__webglTexture=ie[ae].texture}return we}function fe(Q,X,we){let Z=t.TEXTURE_2D;(X.isDataArrayTexture||X.isCompressedArrayTexture)&&(Z=t.TEXTURE_2D_ARRAY),X.isData3DTexture&&(Z=t.TEXTURE_3D);const ie=oe(Q,X),ae=X.source;n.bindTexture(Z,Q.__webglTexture,t.TEXTURE0+we);const Le=r.get(ae);if(ae.version!==Le.__version||ie===!0){n.activeTexture(t.TEXTURE0+we);const Ae=dr.getPrimaries(dr.workingColorSpace),Ie=X.colorSpace===Wo?null:dr.getPrimaries(X.colorSpace),Ge=X.colorSpace===Wo||Ae===Ie?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,X.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,X.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);const rt=y(X)&&m(X.image)===!1;let We=g(X.image,rt,!1,i.maxTextureSize);We=qe(X,We);const Ut=m(We)||o,hn=s.convert(X.format,X.colorSpace);let Vt=s.convert(X.type),Ot=_(X.internalFormat,hn,Vt,X.colorSpace,X.isVideoTexture);J(Z,X,Ut);let bt;const ln=X.mipmaps,Hn=o&&X.isVideoTexture!==!0&&Ot!==gG,Tr=Le.__version===void 0||ie===!0,Sn=T(X,We,Ut);if(X.isDepthTexture)Ot=t.DEPTH_COMPONENT,o?X.type===Pc?Ot=t.DEPTH_COMPONENT32F:X.type===jd?Ot=t.DEPTH_COMPONENT24:X.type===Pf?Ot=t.DEPTH24_STENCIL8:Ot=t.DEPTH_COMPONENT16:X.type===Pc&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),X.format===Of&&Ot===t.DEPTH_COMPONENT&&X.type!==qP&&X.type!==jd&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),X.type=jd,Vt=s.convert(X.type)),X.format===zg&&Ot===t.DEPTH_COMPONENT&&(Ot=t.DEPTH_STENCIL,X.type!==Pf&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),X.type=Pf,Vt=s.convert(X.type))),Tr&&(Hn?n.texStorage2D(t.TEXTURE_2D,1,Ot,We.width,We.height):n.texImage2D(t.TEXTURE_2D,0,Ot,We.width,We.height,0,hn,Vt,null));else if(X.isDataTexture)if(ln.length>0&&Ut){Hn&&Tr&&n.texStorage2D(t.TEXTURE_2D,Sn,Ot,ln[0].width,ln[0].height);for(let it=0,pe=ln.length;it<pe;it++)bt=ln[it],Hn?n.texSubImage2D(t.TEXTURE_2D,it,0,0,bt.width,bt.height,hn,Vt,bt.data):n.texImage2D(t.TEXTURE_2D,it,Ot,bt.width,bt.height,0,hn,Vt,bt.data);X.generateMipmaps=!1}else Hn?(Tr&&n.texStorage2D(t.TEXTURE_2D,Sn,Ot,We.width,We.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,We.width,We.height,hn,Vt,We.data)):n.texImage2D(t.TEXTURE_2D,0,Ot,We.width,We.height,0,hn,Vt,We.data);else if(X.isCompressedTexture)if(X.isCompressedArrayTexture){Hn&&Tr&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Sn,Ot,ln[0].width,ln[0].height,We.depth);for(let it=0,pe=ln.length;it<pe;it++)bt=ln[it],X.format!==ja?hn!==null?Hn?n.compressedTexSubImage3D(t.TEXTURE_2D_ARRAY,it,0,0,0,bt.width,bt.height,We.depth,hn,bt.data,0,0):n.compressedTexImage3D(t.TEXTURE_2D_ARRAY,it,Ot,bt.width,bt.height,We.depth,0,bt.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Hn?n.texSubImage3D(t.TEXTURE_2D_ARRAY,it,0,0,0,bt.width,bt.height,We.depth,hn,Vt,bt.data):n.texImage3D(t.TEXTURE_2D_ARRAY,it,Ot,bt.width,bt.height,We.depth,0,hn,Vt,bt.data)}else{Hn&&Tr&&n.texStorage2D(t.TEXTURE_2D,Sn,Ot,ln[0].width,ln[0].height);for(let it=0,pe=ln.length;it<pe;it++)bt=ln[it],X.format!==ja?hn!==null?Hn?n.compressedTexSubImage2D(t.TEXTURE_2D,it,0,0,bt.width,bt.height,hn,bt.data):n.compressedTexImage2D(t.TEXTURE_2D,it,Ot,bt.width,bt.height,0,bt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Hn?n.texSubImage2D(t.TEXTURE_2D,it,0,0,bt.width,bt.height,hn,Vt,bt.data):n.texImage2D(t.TEXTURE_2D,it,Ot,bt.width,bt.height,0,hn,Vt,bt.data)}else if(X.isDataArrayTexture)Hn?(Tr&&n.texStorage3D(t.TEXTURE_2D_ARRAY,Sn,Ot,We.width,We.height,We.depth),n.texSubImage3D(t.TEXTURE_2D_ARRAY,0,0,0,0,We.width,We.height,We.depth,hn,Vt,We.data)):n.texImage3D(t.TEXTURE_2D_ARRAY,0,Ot,We.width,We.height,We.depth,0,hn,Vt,We.data);else if(X.isData3DTexture)Hn?(Tr&&n.texStorage3D(t.TEXTURE_3D,Sn,Ot,We.width,We.height,We.depth),n.texSubImage3D(t.TEXTURE_3D,0,0,0,0,We.width,We.height,We.depth,hn,Vt,We.data)):n.texImage3D(t.TEXTURE_3D,0,Ot,We.width,We.height,We.depth,0,hn,Vt,We.data);else if(X.isFramebufferTexture){if(Tr)if(Hn)n.texStorage2D(t.TEXTURE_2D,Sn,Ot,We.width,We.height);else{let it=We.width,pe=We.height;for(let dt=0;dt<Sn;dt++)n.texImage2D(t.TEXTURE_2D,dt,Ot,it,pe,0,hn,Vt,null),it>>=1,pe>>=1}}else if(ln.length>0&&Ut){Hn&&Tr&&n.texStorage2D(t.TEXTURE_2D,Sn,Ot,ln[0].width,ln[0].height);for(let it=0,pe=ln.length;it<pe;it++)bt=ln[it],Hn?n.texSubImage2D(t.TEXTURE_2D,it,0,0,hn,Vt,bt):n.texImage2D(t.TEXTURE_2D,it,Ot,hn,Vt,bt);X.generateMipmaps=!1}else Hn?(Tr&&n.texStorage2D(t.TEXTURE_2D,Sn,Ot,We.width,We.height),n.texSubImage2D(t.TEXTURE_2D,0,0,0,hn,Vt,We)):n.texImage2D(t.TEXTURE_2D,0,Ot,hn,Vt,We);x(X,Ut)&&b(Z),Le.__version=ae.version,X.onUpdate&&X.onUpdate(X)}Q.__version=X.version}function Ee(Q,X,we){if(X.image.length!==6)return;const Z=oe(Q,X),ie=X.source;n.bindTexture(t.TEXTURE_CUBE_MAP,Q.__webglTexture,t.TEXTURE0+we);const ae=r.get(ie);if(ie.version!==ae.__version||Z===!0){n.activeTexture(t.TEXTURE0+we);const Le=dr.getPrimaries(dr.workingColorSpace),Ae=X.colorSpace===Wo?null:dr.getPrimaries(X.colorSpace),Ie=X.colorSpace===Wo||Le===Ae?t.NONE:t.BROWSER_DEFAULT_WEBGL;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,X.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,X.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,X.unpackAlignment),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ie);const Ge=X.isCompressedTexture||X.image[0].isCompressedTexture,rt=X.image[0]&&X.image[0].isDataTexture,We=[];for(let it=0;it<6;it++)!Ge&&!rt?We[it]=g(X.image[it],!1,!0,i.maxCubemapSize):We[it]=rt?X.image[it].image:X.image[it],We[it]=qe(X,We[it]);const Ut=We[0],hn=m(Ut)||o,Vt=s.convert(X.format,X.colorSpace),Ot=s.convert(X.type),bt=_(X.internalFormat,Vt,Ot,X.colorSpace),ln=o&&X.isVideoTexture!==!0,Hn=ae.__version===void 0||Z===!0;let Tr=T(X,Ut,hn);J(t.TEXTURE_CUBE_MAP,X,hn);let Sn;if(Ge){ln&&Hn&&n.texStorage2D(t.TEXTURE_CUBE_MAP,Tr,bt,Ut.width,Ut.height);for(let it=0;it<6;it++){Sn=We[it].mipmaps;for(let pe=0;pe<Sn.length;pe++){const dt=Sn[pe];X.format!==ja?Vt!==null?ln?n.compressedTexSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe,0,0,dt.width,dt.height,Vt,dt.data):n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe,bt,dt.width,dt.height,0,dt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ln?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe,0,0,dt.width,dt.height,Vt,Ot,dt.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe,bt,dt.width,dt.height,0,Vt,Ot,dt.data)}}}else{Sn=X.mipmaps,ln&&Hn&&(Sn.length>0&&Tr++,n.texStorage2D(t.TEXTURE_CUBE_MAP,Tr,bt,We[0].width,We[0].height));for(let it=0;it<6;it++)if(rt){ln?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,We[it].width,We[it].height,Vt,Ot,We[it].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,bt,We[it].width,We[it].height,0,Vt,Ot,We[it].data);for(let pe=0;pe<Sn.length;pe++){const ht=Sn[pe].image[it].image;ln?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe+1,0,0,ht.width,ht.height,Vt,Ot,ht.data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe+1,bt,ht.width,ht.height,0,Vt,Ot,ht.data)}}else{ln?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,Vt,Ot,We[it]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,bt,Vt,Ot,We[it]);for(let pe=0;pe<Sn.length;pe++){const dt=Sn[pe];ln?n.texSubImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe+1,0,0,Vt,Ot,dt.image[it]):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+it,pe+1,bt,Vt,Ot,dt.image[it])}}}x(X,hn)&&b(t.TEXTURE_CUBE_MAP),ae.__version=ie.version,X.onUpdate&&X.onUpdate(X)}Q.__version=X.version}function me(Q,X,we,Z,ie,ae){const Le=s.convert(we.format,we.colorSpace),Ae=s.convert(we.type),Ie=_(we.internalFormat,Le,Ae,we.colorSpace);if(!r.get(X).__hasExternalTextures){const rt=Math.max(1,X.width>>ae),We=Math.max(1,X.height>>ae);ie===t.TEXTURE_3D||ie===t.TEXTURE_2D_ARRAY?n.texImage3D(ie,ae,Ie,rt,We,X.depth,0,Le,Ae,null):n.texImage2D(ie,ae,Ie,rt,We,0,Le,Ae,null)}n.bindFramebuffer(t.FRAMEBUFFER,Q),Te(X)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,Z,ie,r.get(we).__webglTexture,0,Pe(X)):(ie===t.TEXTURE_2D||ie>=t.TEXTURE_CUBE_MAP_POSITIVE_X&&ie<=t.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&t.framebufferTexture2D(t.FRAMEBUFFER,Z,ie,r.get(we).__webglTexture,ae),n.bindFramebuffer(t.FRAMEBUFFER,null)}function De(Q,X,we){if(t.bindRenderbuffer(t.RENDERBUFFER,Q),X.depthBuffer&&!X.stencilBuffer){let Z=o===!0?t.DEPTH_COMPONENT24:t.DEPTH_COMPONENT16;if(we||Te(X)){const ie=X.depthTexture;ie&&ie.isDepthTexture&&(ie.type===Pc?Z=t.DEPTH_COMPONENT32F:ie.type===jd&&(Z=t.DEPTH_COMPONENT24));const ae=Pe(X);Te(X)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,ae,Z,X.width,X.height):t.renderbufferStorageMultisample(t.RENDERBUFFER,ae,Z,X.width,X.height)}else t.renderbufferStorage(t.RENDERBUFFER,Z,X.width,X.height);t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,Q)}else if(X.depthBuffer&&X.stencilBuffer){const Z=Pe(X);we&&Te(X)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Z,t.DEPTH24_STENCIL8,X.width,X.height):Te(X)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Z,t.DEPTH24_STENCIL8,X.width,X.height):t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,X.width,X.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,Q)}else{const Z=X.isWebGLMultipleRenderTargets===!0?X.texture:[X.texture];for(let ie=0;ie<Z.length;ie++){const ae=Z[ie],Le=s.convert(ae.format,ae.colorSpace),Ae=s.convert(ae.type),Ie=_(ae.internalFormat,Le,Ae,ae.colorSpace),Ge=Pe(X);we&&Te(X)===!1?t.renderbufferStorageMultisample(t.RENDERBUFFER,Ge,Ie,X.width,X.height):Te(X)?l.renderbufferStorageMultisampleEXT(t.RENDERBUFFER,Ge,Ie,X.width,X.height):t.renderbufferStorage(t.RENDERBUFFER,Ie,X.width,X.height)}}t.bindRenderbuffer(t.RENDERBUFFER,null)}function ge(Q,X){if(X&&X.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(t.FRAMEBUFFER,Q),!(X.depthTexture&&X.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!r.get(X.depthTexture).__webglTexture||X.depthTexture.image.width!==X.width||X.depthTexture.image.height!==X.height)&&(X.depthTexture.image.width=X.width,X.depthTexture.image.height=X.height,X.depthTexture.needsUpdate=!0),B(X.depthTexture,0);const Z=r.get(X.depthTexture).__webglTexture,ie=Pe(X);if(X.depthTexture.format===Of)Te(X)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Z,0,ie):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,Z,0);else if(X.depthTexture.format===zg)Te(X)?l.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Z,0,ie):t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,Z,0);else throw new Error("Unknown depthTexture format")}function _e(Q){const X=r.get(Q),we=Q.isWebGLCubeRenderTarget===!0;if(Q.depthTexture&&!X.__autoAllocateDepthBuffer){if(we)throw new Error("target.depthTexture not supported in Cube render targets");ge(X.__webglFramebuffer,Q)}else if(we){X.__webglDepthbuffer=[];for(let Z=0;Z<6;Z++)n.bindFramebuffer(t.FRAMEBUFFER,X.__webglFramebuffer[Z]),X.__webglDepthbuffer[Z]=t.createRenderbuffer(),De(X.__webglDepthbuffer[Z],Q,!1)}else n.bindFramebuffer(t.FRAMEBUFFER,X.__webglFramebuffer),X.__webglDepthbuffer=t.createRenderbuffer(),De(X.__webglDepthbuffer,Q,!1);n.bindFramebuffer(t.FRAMEBUFFER,null)}function Ce(Q,X,we){const Z=r.get(Q);X!==void 0&&me(Z.__webglFramebuffer,Q,Q.texture,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,0),we!==void 0&&_e(Q)}function G(Q){const X=Q.texture,we=r.get(Q),Z=r.get(X);Q.addEventListener("dispose",I),Q.isWebGLMultipleRenderTargets!==!0&&(Z.__webglTexture===void 0&&(Z.__webglTexture=t.createTexture()),Z.__version=X.version,a.memory.textures++);const ie=Q.isWebGLCubeRenderTarget===!0,ae=Q.isWebGLMultipleRenderTargets===!0,Le=m(Q)||o;if(ie){we.__webglFramebuffer=[];for(let Ae=0;Ae<6;Ae++)if(o&&X.mipmaps&&X.mipmaps.length>0){we.__webglFramebuffer[Ae]=[];for(let Ie=0;Ie<X.mipmaps.length;Ie++)we.__webglFramebuffer[Ae][Ie]=t.createFramebuffer()}else we.__webglFramebuffer[Ae]=t.createFramebuffer()}else{if(o&&X.mipmaps&&X.mipmaps.length>0){we.__webglFramebuffer=[];for(let Ae=0;Ae<X.mipmaps.length;Ae++)we.__webglFramebuffer[Ae]=t.createFramebuffer()}else we.__webglFramebuffer=t.createFramebuffer();if(ae)if(i.drawBuffers){const Ae=Q.texture;for(let Ie=0,Ge=Ae.length;Ie<Ge;Ie++){const rt=r.get(Ae[Ie]);rt.__webglTexture===void 0&&(rt.__webglTexture=t.createTexture(),a.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(o&&Q.samples>0&&Te(Q)===!1){const Ae=ae?X:[X];we.__webglMultisampledFramebuffer=t.createFramebuffer(),we.__webglColorRenderbuffer=[],n.bindFramebuffer(t.FRAMEBUFFER,we.__webglMultisampledFramebuffer);for(let Ie=0;Ie<Ae.length;Ie++){const Ge=Ae[Ie];we.__webglColorRenderbuffer[Ie]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,we.__webglColorRenderbuffer[Ie]);const rt=s.convert(Ge.format,Ge.colorSpace),We=s.convert(Ge.type),Ut=_(Ge.internalFormat,rt,We,Ge.colorSpace,Q.isXRRenderTarget===!0),hn=Pe(Q);t.renderbufferStorageMultisample(t.RENDERBUFFER,hn,Ut,Q.width,Q.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ie,t.RENDERBUFFER,we.__webglColorRenderbuffer[Ie])}t.bindRenderbuffer(t.RENDERBUFFER,null),Q.depthBuffer&&(we.__webglDepthRenderbuffer=t.createRenderbuffer(),De(we.__webglDepthRenderbuffer,Q,!0)),n.bindFramebuffer(t.FRAMEBUFFER,null)}}if(ie){n.bindTexture(t.TEXTURE_CUBE_MAP,Z.__webglTexture),J(t.TEXTURE_CUBE_MAP,X,Le);for(let Ae=0;Ae<6;Ae++)if(o&&X.mipmaps&&X.mipmaps.length>0)for(let Ie=0;Ie<X.mipmaps.length;Ie++)me(we.__webglFramebuffer[Ae][Ie],Q,X,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,Ie);else me(we.__webglFramebuffer[Ae],Q,X,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+Ae,0);x(X,Le)&&b(t.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(ae){const Ae=Q.texture;for(let Ie=0,Ge=Ae.length;Ie<Ge;Ie++){const rt=Ae[Ie],We=r.get(rt);n.bindTexture(t.TEXTURE_2D,We.__webglTexture),J(t.TEXTURE_2D,rt,Le),me(we.__webglFramebuffer,Q,rt,t.COLOR_ATTACHMENT0+Ie,t.TEXTURE_2D,0),x(rt,Le)&&b(t.TEXTURE_2D)}n.unbindTexture()}else{let Ae=t.TEXTURE_2D;if((Q.isWebGL3DRenderTarget||Q.isWebGLArrayRenderTarget)&&(o?Ae=Q.isWebGL3DRenderTarget?t.TEXTURE_3D:t.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(Ae,Z.__webglTexture),J(Ae,X,Le),o&&X.mipmaps&&X.mipmaps.length>0)for(let Ie=0;Ie<X.mipmaps.length;Ie++)me(we.__webglFramebuffer[Ie],Q,X,t.COLOR_ATTACHMENT0,Ae,Ie);else me(we.__webglFramebuffer,Q,X,t.COLOR_ATTACHMENT0,Ae,0);x(X,Le)&&b(Ae),n.unbindTexture()}Q.depthBuffer&&_e(Q)}function ke(Q){const X=m(Q)||o,we=Q.isWebGLMultipleRenderTargets===!0?Q.texture:[Q.texture];for(let Z=0,ie=we.length;Z<ie;Z++){const ae=we[Z];if(x(ae,X)){const Le=Q.isWebGLCubeRenderTarget?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,Ae=r.get(ae).__webglTexture;n.bindTexture(Le,Ae),b(Le),n.unbindTexture()}}}function xe(Q){if(o&&Q.samples>0&&Te(Q)===!1){const X=Q.isWebGLMultipleRenderTargets?Q.texture:[Q.texture],we=Q.width,Z=Q.height;let ie=t.COLOR_BUFFER_BIT;const ae=[],Le=Q.stencilBuffer?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT,Ae=r.get(Q),Ie=Q.isWebGLMultipleRenderTargets===!0;if(Ie)for(let Ge=0;Ge<X.length;Ge++)n.bindFramebuffer(t.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ge,t.RENDERBUFFER,null),n.bindFramebuffer(t.FRAMEBUFFER,Ae.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ge,t.TEXTURE_2D,null,0);n.bindFramebuffer(t.READ_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ae.__webglFramebuffer);for(let Ge=0;Ge<X.length;Ge++){ae.push(t.COLOR_ATTACHMENT0+Ge),Q.depthBuffer&&ae.push(Le);const rt=Ae.__ignoreDepthValues!==void 0?Ae.__ignoreDepthValues:!1;if(rt===!1&&(Q.depthBuffer&&(ie|=t.DEPTH_BUFFER_BIT),Q.stencilBuffer&&(ie|=t.STENCIL_BUFFER_BIT)),Ie&&t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,Ae.__webglColorRenderbuffer[Ge]),rt===!0&&(t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[Le]),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,[Le])),Ie){const We=r.get(X[Ge]).__webglTexture;t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,We,0)}t.blitFramebuffer(0,0,we,Z,0,0,we,Z,ie,t.NEAREST),c&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,ae)}if(n.bindFramebuffer(t.READ_FRAMEBUFFER,null),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,null),Ie)for(let Ge=0;Ge<X.length;Ge++){n.bindFramebuffer(t.FRAMEBUFFER,Ae.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ge,t.RENDERBUFFER,Ae.__webglColorRenderbuffer[Ge]);const rt=r.get(X[Ge]).__webglTexture;n.bindFramebuffer(t.FRAMEBUFFER,Ae.__webglFramebuffer),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+Ge,t.TEXTURE_2D,rt,0)}n.bindFramebuffer(t.DRAW_FRAMEBUFFER,Ae.__webglMultisampledFramebuffer)}}function Pe(Q){return Math.min(i.maxSamples,Q.samples)}function Te(Q){const X=r.get(Q);return o&&Q.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&X.__useRenderToTexture!==!1}function Ye(Q){const X=a.render.frame;u.get(Q)!==X&&(u.set(Q,X),Q.update())}function qe(Q,X){const we=Q.colorSpace,Z=Q.format,ie=Q.type;return Q.isCompressedTexture===!0||Q.isVideoTexture===!0||Q.format===yk||we!==Qu&&we!==Wo&&(dr.getTransfer(we)===kr?o===!1?e.has("EXT_sRGB")===!0&&Z===ja?(Q.format=yk,Q.minFilter=Ri,Q.generateMipmaps=!1):X=wG.sRGBToLinear(X):(Z!==ja||ie!==Bu)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",we)),X}this.allocateTextureUnit=O,this.resetTextureUnits=z,this.setTexture2D=B,this.setTexture2DArray=W,this.setTexture3D=L,this.setTextureCube=V,this.rebindTextures=Ce,this.setupRenderTarget=G,this.updateRenderTargetMipmap=ke,this.updateMultisampleRenderTarget=xe,this.setupDepthRenderbuffer=_e,this.setupFrameBufferTexture=me,this.useMultisampledRTT=Te}function hve(t,e,n){const r=n.isWebGL2;function i(s,a=Wo){let o;const l=dr.getTransfer(a);if(s===Bu)return t.UNSIGNED_BYTE;if(s===dG)return t.UNSIGNED_SHORT_4_4_4_4;if(s===hG)return t.UNSIGNED_SHORT_5_5_5_1;if(s===Mye)return t.BYTE;if(s===Rye)return t.SHORT;if(s===qP)return t.UNSIGNED_SHORT;if(s===uG)return t.INT;if(s===jd)return t.UNSIGNED_INT;if(s===Pc)return t.FLOAT;if(s===N0)return r?t.HALF_FLOAT:(o=e.get("OES_texture_half_float"),o!==null?o.HALF_FLOAT_OES:null);if(s===Pye)return t.ALPHA;if(s===ja)return t.RGBA;if(s===Oye)return t.LUMINANCE;if(s===Dye)return t.LUMINANCE_ALPHA;if(s===Of)return t.DEPTH_COMPONENT;if(s===zg)return t.DEPTH_STENCIL;if(s===yk)return o=e.get("EXT_sRGB"),o!==null?o.SRGB_ALPHA_EXT:null;if(s===$ye)return t.RED;if(s===fG)return t.RED_INTEGER;if(s===Lye)return t.RG;if(s===pG)return t.RG_INTEGER;if(s===mG)return t.RGBA_INTEGER;if(s===q2||s===X2||s===K2||s===Y2)if(l===kr)if(o=e.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(s===q2)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===X2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===K2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Y2)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=e.get("WEBGL_compressed_texture_s3tc"),o!==null){if(s===q2)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===X2)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===K2)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Y2)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===b4||s===w4||s===S4||s===_4)if(o=e.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(s===b4)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===w4)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===S4)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===_4)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===gG)return o=e.get("WEBGL_compressed_texture_etc1"),o!==null?o.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===T4||s===E4)if(o=e.get("WEBGL_compressed_texture_etc"),o!==null){if(s===T4)return l===kr?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(s===E4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===C4||s===N4||s===A4||s===I4||s===k4||s===M4||s===R4||s===P4||s===O4||s===D4||s===$4||s===L4||s===F4||s===j4)if(o=e.get("WEBGL_compressed_texture_astc"),o!==null){if(s===C4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===N4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===A4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===I4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===k4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===M4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===R4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===P4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===O4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===D4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===$4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===L4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===F4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===j4)return l===kr?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Z2||s===z4||s===B4)if(o=e.get("EXT_texture_compression_bptc"),o!==null){if(s===Z2)return l===kr?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===z4)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===B4)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===Fye||s===U4||s===V4||s===W4)if(o=e.get("EXT_texture_compression_rgtc"),o!==null){if(s===Z2)return o.COMPRESSED_RED_RGTC1_EXT;if(s===U4)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===V4)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===W4)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===Pf?r?t.UNSIGNED_INT_24_8:(o=e.get("WEBGL_depth_texture"),o!==null?o.UNSIGNED_INT_24_8_WEBGL:null):t[s]!==void 0?t[s]:null}return{convert:i}}class fve extends Ts{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class Uv extends tr{constructor(){super(),this.isGroup=!0,this.type="Group"}}const gNt={type:"move"};class ZL{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Uv,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Uv,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ne,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ne),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Uv,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ne,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ne),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const n=this._hand;if(n)for(const r of e.hand.values())this._getHandJoint(n,r)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,n,r){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&n.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const g of e.hand.values()){const m=n.getJointPose(g,r),y=this._getHandJoint(c,g);m!==null&&(y.matrix.fromArray(m.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),y.matrixWorldNeedsUpdate=!0,y.jointRadius=m.radius),y.visible=m!==null}const u=c.joints["index-finger-tip"],d=c.joints["thumb-tip"],h=u.position.distanceTo(d.position),f=.02,p=.005;c.inputState.pinching&&h>f+p?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&h<=f-p&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=n.getPose(e.gripSpace,r),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=n.getPose(e.targetRaySpace,r),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(gNt)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,n){if(e.joints[n.jointName]===void 0){const r=new Uv;r.matrixAutoUpdate=!1,r.visible=!1,e.joints[n.jointName]=r,e.add(r)}return e.joints[n.jointName]}}class yNt extends Th{constructor(e,n){super();const r=this;let i=null,s=1,a=null,o="local-floor",l=1,c=null,u=null,d=null,h=null,f=null,p=null;const g=n.getContextAttributes();let m=null,y=null;const x=[],b=[],_=new Xe;let T=null;const E=new Ts;E.layers.enable(1),E.viewport=new hr;const C=new Ts;C.layers.enable(2),C.viewport=new hr;const I=[E,C],A=new fve;A.layers.enable(1),A.layers.enable(2);let k=null,R=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let oe=x[J];return oe===void 0&&(oe=new ZL,x[J]=oe),oe.getTargetRaySpace()},this.getControllerGrip=function(J){let oe=x[J];return oe===void 0&&(oe=new ZL,x[J]=oe),oe.getGripSpace()},this.getHand=function(J){let oe=x[J];return oe===void 0&&(oe=new ZL,x[J]=oe),oe.getHandSpace()};function $(J){const oe=b.indexOf(J.inputSource);if(oe===-1)return;const fe=x[oe];fe!==void 0&&(fe.update(J.inputSource,J.frame,c||a),fe.dispatchEvent({type:J.type,data:J.inputSource}))}function z(){i.removeEventListener("select",$),i.removeEventListener("selectstart",$),i.removeEventListener("selectend",$),i.removeEventListener("squeeze",$),i.removeEventListener("squeezestart",$),i.removeEventListener("squeezeend",$),i.removeEventListener("end",z),i.removeEventListener("inputsourceschange",O);for(let J=0;J<x.length;J++){const oe=b[J];oe!==null&&(b[J]=null,x[J].disconnect(oe))}k=null,R=null,e.setRenderTarget(m),f=null,h=null,d=null,i=null,y=null,te.stop(),r.isPresenting=!1,e.setPixelRatio(T),e.setSize(_.width,_.height,!1),r.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){s=J,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){o=J,r.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(J){c=J},this.getBaseLayer=function(){return h!==null?h:f},this.getBinding=function(){return d},this.getFrame=function(){return p},this.getSession=function(){return i},this.setSession=async function(J){if(i=J,i!==null){if(m=e.getRenderTarget(),i.addEventListener("select",$),i.addEventListener("selectstart",$),i.addEventListener("selectend",$),i.addEventListener("squeeze",$),i.addEventListener("squeezestart",$),i.addEventListener("squeezeend",$),i.addEventListener("end",z),i.addEventListener("inputsourceschange",O),g.xrCompatible!==!0&&await n.makeXRCompatible(),T=e.getPixelRatio(),e.getSize(_),i.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const oe={antialias:i.renderState.layers===void 0?g.antialias:!0,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:s};f=new XRWebGLLayer(i,n,oe),i.updateRenderState({baseLayer:f}),e.setPixelRatio(1),e.setSize(f.framebufferWidth,f.framebufferHeight,!1),y=new Kc(f.framebufferWidth,f.framebufferHeight,{format:ja,type:Bu,colorSpace:e.outputColorSpace,stencilBuffer:g.stencil})}else{let oe=null,fe=null,Ee=null;g.depth&&(Ee=g.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,oe=g.stencil?zg:Of,fe=g.stencil?Pf:jd);const me={colorFormat:n.RGBA8,depthFormat:Ee,scaleFactor:s};d=new XRWebGLBinding(i,n),h=d.createProjectionLayer(me),i.updateRenderState({layers:[h]}),e.setPixelRatio(1),e.setSize(h.textureWidth,h.textureHeight,!1),y=new Kc(h.textureWidth,h.textureHeight,{format:ja,type:Bu,depthTexture:new CG(h.textureWidth,h.textureHeight,fe,void 0,void 0,void 0,void 0,void 0,void 0,oe),stencilBuffer:g.stencil,colorSpace:e.outputColorSpace,samples:g.antialias?4:0});const De=e.properties.get(y);De.__ignoreDepthValues=h.ignoreDepthValues}y.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await i.requestReferenceSpace(o),te.setContext(i),te.start(),r.isPresenting=!0,r.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode};function O(J){for(let oe=0;oe<J.removed.length;oe++){const fe=J.removed[oe],Ee=b.indexOf(fe);Ee>=0&&(b[Ee]=null,x[Ee].disconnect(fe))}for(let oe=0;oe<J.added.length;oe++){const fe=J.added[oe];let Ee=b.indexOf(fe);if(Ee===-1){for(let De=0;De<x.length;De++)if(De>=b.length){b.push(fe),Ee=De;break}else if(b[De]===null){b[De]=fe,Ee=De;break}if(Ee===-1)break}const me=x[Ee];me&&me.connect(fe)}}const j=new ne,B=new ne;function W(J,oe,fe){j.setFromMatrixPosition(oe.matrixWorld),B.setFromMatrixPosition(fe.matrixWorld);const Ee=j.distanceTo(B),me=oe.projectionMatrix.elements,De=fe.projectionMatrix.elements,ge=me[14]/(me[10]-1),_e=me[14]/(me[10]+1),Ce=(me[9]+1)/me[5],G=(me[9]-1)/me[5],ke=(me[8]-1)/me[0],xe=(De[8]+1)/De[0],Pe=ge*ke,Te=ge*xe,Ye=Ee/(-ke+xe),qe=Ye*-ke;oe.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(qe),J.translateZ(Ye),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();const Q=ge+Ye,X=_e+Ye,we=Pe-qe,Z=Te+(Ee-qe),ie=Ce*_e/X*Q,ae=G*_e/X*Q;J.projectionMatrix.makePerspective(we,Z,ie,ae,Q,X),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}function L(J,oe){oe===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(oe.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(i===null)return;A.near=C.near=E.near=J.near,A.far=C.far=E.far=J.far,(k!==A.near||R!==A.far)&&(i.updateRenderState({depthNear:A.near,depthFar:A.far}),k=A.near,R=A.far);const oe=J.parent,fe=A.cameras;L(A,oe);for(let Ee=0;Ee<fe.length;Ee++)L(fe[Ee],oe);fe.length===2?W(A,E,C):A.projectionMatrix.copy(E.projectionMatrix),V(J,A,oe)};function V(J,oe,fe){fe===null?J.matrix.copy(oe.matrixWorld):(J.matrix.copy(fe.matrixWorld),J.matrix.invert(),J.matrix.multiply(oe.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(oe.projectionMatrix),J.projectionMatrixInverse.copy(oe.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=I0*2*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}this.getCamera=function(){return A},this.getFoveation=function(){if(!(h===null&&f===null))return l},this.setFoveation=function(J){l=J,h!==null&&(h.fixedFoveation=J),f!==null&&f.fixedFoveation!==void 0&&(f.fixedFoveation=J)};let H=null;function K(J,oe){if(u=oe.getViewerPose(c||a),p=oe,u!==null){const fe=u.views;f!==null&&(e.setRenderTargetFramebuffer(y,f.framebuffer),e.setRenderTarget(y));let Ee=!1;fe.length!==A.cameras.length&&(A.cameras.length=0,Ee=!0);for(let me=0;me<fe.length;me++){const De=fe[me];let ge=null;if(f!==null)ge=f.getViewport(De);else{const Ce=d.getViewSubImage(h,De);ge=Ce.viewport,me===0&&(e.setRenderTargetTextures(y,Ce.colorTexture,h.ignoreDepthValues?void 0:Ce.depthStencilTexture),e.setRenderTarget(y))}let _e=I[me];_e===void 0&&(_e=new Ts,_e.layers.enable(me),_e.viewport=new hr,I[me]=_e),_e.matrix.fromArray(De.transform.matrix),_e.matrix.decompose(_e.position,_e.quaternion,_e.scale),_e.projectionMatrix.fromArray(De.projectionMatrix),_e.projectionMatrixInverse.copy(_e.projectionMatrix).invert(),_e.viewport.set(ge.x,ge.y,ge.width,ge.height),me===0&&(A.matrix.copy(_e.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),Ee===!0&&A.cameras.push(_e)}}for(let fe=0;fe<x.length;fe++){const Ee=b[fe],me=x[fe];Ee!==null&&me!==void 0&&me.update(Ee,oe,c||a)}H&&H(J,oe),oe.detectedPlanes&&r.dispatchEvent({type:"planesdetected",data:oe}),p=null}const te=new ave;te.setAnimationLoop(K),this.setAnimationLoop=function(J){H=J},this.dispose=function(){}}}function vNt(t,e){function n(m,y){m.matrixAutoUpdate===!0&&m.updateMatrix(),y.value.copy(m.matrix)}function r(m,y){y.color.getRGB(m.fogColor.value,nve(t)),y.isFog?(m.fogNear.value=y.near,m.fogFar.value=y.far):y.isFogExp2&&(m.fogDensity.value=y.density)}function i(m,y,x,b,_){y.isMeshBasicMaterial||y.isMeshLambertMaterial?s(m,y):y.isMeshToonMaterial?(s(m,y),d(m,y)):y.isMeshPhongMaterial?(s(m,y),u(m,y)):y.isMeshStandardMaterial?(s(m,y),h(m,y),y.isMeshPhysicalMaterial&&f(m,y,_)):y.isMeshMatcapMaterial?(s(m,y),p(m,y)):y.isMeshDepthMaterial?s(m,y):y.isMeshDistanceMaterial?(s(m,y),g(m,y)):y.isMeshNormalMaterial?s(m,y):y.isLineBasicMaterial?(a(m,y),y.isLineDashedMaterial&&o(m,y)):y.isPointsMaterial?l(m,y,x,b):y.isSpriteMaterial?c(m,y):y.isShadowMaterial?(m.color.value.copy(y.color),m.opacity.value=y.opacity):y.isShaderMaterial&&(y.uniformsNeedUpdate=!1)}function s(m,y){m.opacity.value=y.opacity,y.color&&m.diffuse.value.copy(y.color),y.emissive&&m.emissive.value.copy(y.emissive).multiplyScalar(y.emissiveIntensity),y.map&&(m.map.value=y.map,n(y.map,m.mapTransform)),y.alphaMap&&(m.alphaMap.value=y.alphaMap,n(y.alphaMap,m.alphaMapTransform)),y.bumpMap&&(m.bumpMap.value=y.bumpMap,n(y.bumpMap,m.bumpMapTransform),m.bumpScale.value=y.bumpScale,y.side===Ua&&(m.bumpScale.value*=-1)),y.normalMap&&(m.normalMap.value=y.normalMap,n(y.normalMap,m.normalMapTransform),m.normalScale.value.copy(y.normalScale),y.side===Ua&&m.normalScale.value.negate()),y.displacementMap&&(m.displacementMap.value=y.displacementMap,n(y.displacementMap,m.displacementMapTransform),m.displacementScale.value=y.displacementScale,m.displacementBias.value=y.displacementBias),y.emissiveMap&&(m.emissiveMap.value=y.emissiveMap,n(y.emissiveMap,m.emissiveMapTransform)),y.specularMap&&(m.specularMap.value=y.specularMap,n(y.specularMap,m.specularMapTransform)),y.alphaTest>0&&(m.alphaTest.value=y.alphaTest);const x=e.get(y).envMap;if(x&&(m.envMap.value=x,m.flipEnvMap.value=x.isCubeTexture&&x.isRenderTargetTexture===!1?-1:1,m.reflectivity.value=y.reflectivity,m.ior.value=y.ior,m.refractionRatio.value=y.refractionRatio),y.lightMap){m.lightMap.value=y.lightMap;const b=t._useLegacyLights===!0?Math.PI:1;m.lightMapIntensity.value=y.lightMapIntensity*b,n(y.lightMap,m.lightMapTransform)}y.aoMap&&(m.aoMap.value=y.aoMap,m.aoMapIntensity.value=y.aoMapIntensity,n(y.aoMap,m.aoMapTransform))}function a(m,y){m.diffuse.value.copy(y.color),m.opacity.value=y.opacity,y.map&&(m.map.value=y.map,n(y.map,m.mapTransform))}function o(m,y){m.dashSize.value=y.dashSize,m.totalSize.value=y.dashSize+y.gapSize,m.scale.value=y.scale}function l(m,y,x,b){m.diffuse.value.copy(y.color),m.opacity.value=y.opacity,m.size.value=y.size*x,m.scale.value=b*.5,y.map&&(m.map.value=y.map,n(y.map,m.uvTransform)),y.alphaMap&&(m.alphaMap.value=y.alphaMap,n(y.alphaMap,m.alphaMapTransform)),y.alphaTest>0&&(m.alphaTest.value=y.alphaTest)}function c(m,y){m.diffuse.value.copy(y.color),m.opacity.value=y.opacity,m.rotation.value=y.rotation,y.map&&(m.map.value=y.map,n(y.map,m.mapTransform)),y.alphaMap&&(m.alphaMap.value=y.alphaMap,n(y.alphaMap,m.alphaMapTransform)),y.alphaTest>0&&(m.alphaTest.value=y.alphaTest)}function u(m,y){m.specular.value.copy(y.specular),m.shininess.value=Math.max(y.shininess,1e-4)}function d(m,y){y.gradientMap&&(m.gradientMap.value=y.gradientMap)}function h(m,y){m.metalness.value=y.metalness,y.metalnessMap&&(m.metalnessMap.value=y.metalnessMap,n(y.metalnessMap,m.metalnessMapTransform)),m.roughness.value=y.roughness,y.roughnessMap&&(m.roughnessMap.value=y.roughnessMap,n(y.roughnessMap,m.roughnessMapTransform)),e.get(y).envMap&&(m.envMapIntensity.value=y.envMapIntensity)}function f(m,y,x){m.ior.value=y.ior,y.sheen>0&&(m.sheenColor.value.copy(y.sheenColor).multiplyScalar(y.sheen),m.sheenRoughness.value=y.sheenRoughness,y.sheenColorMap&&(m.sheenColorMap.value=y.sheenColorMap,n(y.sheenColorMap,m.sheenColorMapTransform)),y.sheenRoughnessMap&&(m.sheenRoughnessMap.value=y.sheenRoughnessMap,n(y.sheenRoughnessMap,m.sheenRoughnessMapTransform))),y.clearcoat>0&&(m.clearcoat.value=y.clearcoat,m.clearcoatRoughness.value=y.clearcoatRoughness,y.clearcoatMap&&(m.clearcoatMap.value=y.clearcoatMap,n(y.clearcoatMap,m.clearcoatMapTransform)),y.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=y.clearcoatRoughnessMap,n(y.clearcoatRoughnessMap,m.clearcoatRoughnessMapTransform)),y.clearcoatNormalMap&&(m.clearcoatNormalMap.value=y.clearcoatNormalMap,n(y.clearcoatNormalMap,m.clearcoatNormalMapTransform),m.clearcoatNormalScale.value.copy(y.clearcoatNormalScale),y.side===Ua&&m.clearcoatNormalScale.value.negate())),y.iridescence>0&&(m.iridescence.value=y.iridescence,m.iridescenceIOR.value=y.iridescenceIOR,m.iridescenceThicknessMinimum.value=y.iridescenceThicknessRange[0],m.iridescenceThicknessMaximum.value=y.iridescenceThicknessRange[1],y.iridescenceMap&&(m.iridescenceMap.value=y.iridescenceMap,n(y.iridescenceMap,m.iridescenceMapTransform)),y.iridescenceThicknessMap&&(m.iridescenceThicknessMap.value=y.iridescenceThicknessMap,n(y.iridescenceThicknessMap,m.iridescenceThicknessMapTransform))),y.transmission>0&&(m.transmission.value=y.transmission,m.transmissionSamplerMap.value=x.texture,m.transmissionSamplerSize.value.set(x.width,x.height),y.transmissionMap&&(m.transmissionMap.value=y.transmissionMap,n(y.transmissionMap,m.transmissionMapTransform)),m.thickness.value=y.thickness,y.thicknessMap&&(m.thicknessMap.value=y.thicknessMap,n(y.thicknessMap,m.thicknessMapTransform)),m.attenuationDistance.value=y.attenuationDistance,m.attenuationColor.value.copy(y.attenuationColor)),y.anisotropy>0&&(m.anisotropyVector.value.set(y.anisotropy*Math.cos(y.anisotropyRotation),y.anisotropy*Math.sin(y.anisotropyRotation)),y.anisotropyMap&&(m.anisotropyMap.value=y.anisotropyMap,n(y.anisotropyMap,m.anisotropyMapTransform))),m.specularIntensity.value=y.specularIntensity,m.specularColor.value.copy(y.specularColor),y.specularColorMap&&(m.specularColorMap.value=y.specularColorMap,n(y.specularColorMap,m.specularColorMapTransform)),y.specularIntensityMap&&(m.specularIntensityMap.value=y.specularIntensityMap,n(y.specularIntensityMap,m.specularIntensityMapTransform))}function p(m,y){y.matcap&&(m.matcap.value=y.matcap)}function g(m,y){const x=e.get(y).light;m.referencePosition.value.setFromMatrixPosition(x.matrixWorld),m.nearDistance.value=x.shadow.camera.near,m.farDistance.value=x.shadow.camera.far}return{refreshFogUniforms:r,refreshMaterialUniforms:i}}function xNt(t,e,n,r){let i={},s={},a=[];const o=n.isWebGL2?t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(x,b){const _=b.program;r.uniformBlockBinding(x,_)}function c(x,b){let _=i[x.id];_===void 0&&(p(x),_=u(x),i[x.id]=_,x.addEventListener("dispose",m));const T=b.program;r.updateUBOMapping(x,T);const E=e.render.frame;s[x.id]!==E&&(h(x),s[x.id]=E)}function u(x){const b=d();x.__bindingPointIndex=b;const _=t.createBuffer(),T=x.__size,E=x.usage;return t.bindBuffer(t.UNIFORM_BUFFER,_),t.bufferData(t.UNIFORM_BUFFER,T,E),t.bindBuffer(t.UNIFORM_BUFFER,null),t.bindBufferBase(t.UNIFORM_BUFFER,b,_),_}function d(){for(let x=0;x<o;x++)if(a.indexOf(x)===-1)return a.push(x),x;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function h(x){const b=i[x.id],_=x.uniforms,T=x.__cache;t.bindBuffer(t.UNIFORM_BUFFER,b);for(let E=0,C=_.length;E<C;E++){const I=Array.isArray(_[E])?_[E]:[_[E]];for(let A=0,k=I.length;A<k;A++){const R=I[A];if(f(R,E,A,T)===!0){const $=R.__offset,z=Array.isArray(R.value)?R.value:[R.value];let O=0;for(let j=0;j<z.length;j++){const B=z[j],W=g(B);typeof B=="number"||typeof B=="boolean"?(R.__data[0]=B,t.bufferSubData(t.UNIFORM_BUFFER,$+O,R.__data)):B.isMatrix3?(R.__data[0]=B.elements[0],R.__data[1]=B.elements[1],R.__data[2]=B.elements[2],R.__data[3]=0,R.__data[4]=B.elements[3],R.__data[5]=B.elements[4],R.__data[6]=B.elements[5],R.__data[7]=0,R.__data[8]=B.elements[6],R.__data[9]=B.elements[7],R.__data[10]=B.elements[8],R.__data[11]=0):(B.toArray(R.__data,O),O+=W.storage/Float32Array.BYTES_PER_ELEMENT)}t.bufferSubData(t.UNIFORM_BUFFER,$,R.__data)}}}t.bindBuffer(t.UNIFORM_BUFFER,null)}function f(x,b,_,T){const E=x.value,C=b+"_"+_;if(T[C]===void 0)return typeof E=="number"||typeof E=="boolean"?T[C]=E:T[C]=E.clone(),!0;{const I=T[C];if(typeof E=="number"||typeof E=="boolean"){if(I!==E)return T[C]=E,!0}else if(I.equals(E)===!1)return I.copy(E),!0}return!1}function p(x){const b=x.uniforms;let _=0;const T=16;for(let C=0,I=b.length;C<I;C++){const A=Array.isArray(b[C])?b[C]:[b[C]];for(let k=0,R=A.length;k<R;k++){const $=A[k],z=Array.isArray($.value)?$.value:[$.value];for(let O=0,j=z.length;O<j;O++){const B=z[O],W=g(B),L=_%T;L!==0&&T-L<W.boundary&&(_+=T-L),$.__data=new Float32Array(W.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=_,_+=W.storage}}}const E=_%T;return E>0&&(_+=T-E),x.__size=_,x.__cache={},this}function g(x){const b={boundary:0,storage:0};return typeof x=="number"||typeof x=="boolean"?(b.boundary=4,b.storage=4):x.isVector2?(b.boundary=8,b.storage=8):x.isVector3||x.isColor?(b.boundary=16,b.storage=12):x.isVector4?(b.boundary=16,b.storage=16):x.isMatrix3?(b.boundary=48,b.storage=48):x.isMatrix4?(b.boundary=64,b.storage=64):x.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",x),b}function m(x){const b=x.target;b.removeEventListener("dispose",m);const _=a.indexOf(b.__bindingPointIndex);a.splice(_,1),t.deleteBuffer(i[b.id]),delete i[b.id],delete s[b.id]}function y(){for(const x in i)t.deleteBuffer(i[x]);a=[],i={},s={}}return{bind:l,update:c,dispose:y}}class IG{constructor(e={}){const{canvas:n=Jye(),context:r=null,depth:i=!0,stencil:s=!0,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:u="default",failIfMajorPerformanceCaveat:d=!1}=e;this.isWebGLRenderer=!0;let h;r!==null?h=r.getContextAttributes().alpha:h=a;const f=new Uint32Array(4),p=new Int32Array(4);let g=null,m=null;const y=[],x=[];this.domElement=n,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=rs,this._useLegacyLights=!1,this.toneMapping=zu,this.toneMappingExposure=1;const b=this;let _=!1,T=0,E=0,C=null,I=-1,A=null;const k=new hr,R=new hr;let $=null;const z=new xt(0);let O=0,j=n.width,B=n.height,W=1,L=null,V=null;const H=new hr(0,0,j,B),K=new hr(0,0,j,B);let te=!1;const J=new mE;let oe=!1,fe=!1,Ee=null;const me=new an,De=new Xe,ge=new ne,_e={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Ce(){return C===null?W:1}let G=r;function ke(ee,Ne){for(let Fe=0;Fe<ee.length;Fe++){const ze=ee[Fe],$e=n.getContext(ze,Ne);if($e!==null)return $e}return null}try{const ee={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:d};if("setAttribute"in n&&n.setAttribute("data-engine",`three.js r${WP}`),n.addEventListener("webglcontextlost",it,!1),n.addEventListener("webglcontextrestored",pe,!1),n.addEventListener("webglcontextcreationerror",dt,!1),G===null){const Ne=["webgl2","webgl","experimental-webgl"];if(b.isWebGL1Renderer===!0&&Ne.shift(),G=ke(Ne,ee),G===null)throw ke(Ne)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&G instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),G.getShaderPrecisionFormat===void 0&&(G.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(ee){throw console.error("THREE.WebGLRenderer: "+ee.message),ee}let xe,Pe,Te,Ye,qe,Q,X,we,Z,ie,ae,Le,Ae,Ie,Ge,rt,We,Ut,hn,Vt,Ot,bt,ln,Hn;function Tr(){xe=new PEt(G),Pe=new NEt(G,xe,e),xe.init(Pe),bt=new hve(G,xe,Pe),Te=new pNt(G,xe,Pe),Ye=new $Et(G),qe=new nNt,Q=new mNt(G,xe,Te,qe,Pe,bt,Ye),X=new IEt(b),we=new REt(b),Z=new WSt(G,Pe),ln=new EEt(G,xe,Z,Pe),ie=new OEt(G,Z,Ye,ln),ae=new zEt(G,ie,Z,Ye),hn=new jEt(G,Pe,Q),rt=new AEt(qe),Le=new tNt(b,X,we,xe,Pe,ln,rt),Ae=new vNt(b,qe),Ie=new iNt,Ge=new uNt(xe,Pe),Ut=new TEt(b,X,we,Te,ae,h,l),We=new fNt(b,ae,Pe),Hn=new xNt(G,Ye,Pe,Te),Vt=new CEt(G,xe,Ye,Pe),Ot=new DEt(G,xe,Ye,Pe),Ye.programs=Le.programs,b.capabilities=Pe,b.extensions=xe,b.properties=qe,b.renderLists=Ie,b.shadowMap=We,b.state=Te,b.info=Ye}Tr();const Sn=new yNt(b,G);this.xr=Sn,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const ee=xe.get("WEBGL_lose_context");ee&&ee.loseContext()},this.forceContextRestore=function(){const ee=xe.get("WEBGL_lose_context");ee&&ee.restoreContext()},this.getPixelRatio=function(){return W},this.setPixelRatio=function(ee){ee!==void 0&&(W=ee,this.setSize(j,B,!1))},this.getSize=function(ee){return ee.set(j,B)},this.setSize=function(ee,Ne,Fe=!0){if(Sn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}j=ee,B=Ne,n.width=Math.floor(ee*W),n.height=Math.floor(Ne*W),Fe===!0&&(n.style.width=ee+"px",n.style.height=Ne+"px"),this.setViewport(0,0,ee,Ne)},this.getDrawingBufferSize=function(ee){return ee.set(j*W,B*W).floor()},this.setDrawingBufferSize=function(ee,Ne,Fe){j=ee,B=Ne,W=Fe,n.width=Math.floor(ee*Fe),n.height=Math.floor(Ne*Fe),this.setViewport(0,0,ee,Ne)},this.getCurrentViewport=function(ee){return ee.copy(k)},this.getViewport=function(ee){return ee.copy(H)},this.setViewport=function(ee,Ne,Fe,ze){ee.isVector4?H.set(ee.x,ee.y,ee.z,ee.w):H.set(ee,Ne,Fe,ze),Te.viewport(k.copy(H).multiplyScalar(W).floor())},this.getScissor=function(ee){return ee.copy(K)},this.setScissor=function(ee,Ne,Fe,ze){ee.isVector4?K.set(ee.x,ee.y,ee.z,ee.w):K.set(ee,Ne,Fe,ze),Te.scissor(R.copy(K).multiplyScalar(W).floor())},this.getScissorTest=function(){return te},this.setScissorTest=function(ee){Te.setScissorTest(te=ee)},this.setOpaqueSort=function(ee){L=ee},this.setTransparentSort=function(ee){V=ee},this.getClearColor=function(ee){return ee.copy(Ut.getClearColor())},this.setClearColor=function(){Ut.setClearColor.apply(Ut,arguments)},this.getClearAlpha=function(){return Ut.getClearAlpha()},this.setClearAlpha=function(){Ut.setClearAlpha.apply(Ut,arguments)},this.clear=function(ee=!0,Ne=!0,Fe=!0){let ze=0;if(ee){let $e=!1;if(C!==null){const yt=C.texture.format;$e=yt===mG||yt===pG||yt===fG}if($e){const yt=C.texture.type,jt=yt===Bu||yt===jd||yt===qP||yt===Pf||yt===dG||yt===hG,qt=Ut.getClearColor(),Qt=Ut.getClearAlpha(),cn=qt.r,on=qt.g,un=qt.b;jt?(f[0]=cn,f[1]=on,f[2]=un,f[3]=Qt,G.clearBufferuiv(G.COLOR,0,f)):(p[0]=cn,p[1]=on,p[2]=un,p[3]=Qt,G.clearBufferiv(G.COLOR,0,p))}else ze|=G.COLOR_BUFFER_BIT}Ne&&(ze|=G.DEPTH_BUFFER_BIT),Fe&&(ze|=G.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),G.clear(ze)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",it,!1),n.removeEventListener("webglcontextrestored",pe,!1),n.removeEventListener("webglcontextcreationerror",dt,!1),Ie.dispose(),Ge.dispose(),qe.dispose(),X.dispose(),we.dispose(),ae.dispose(),ln.dispose(),Hn.dispose(),Le.dispose(),Sn.dispose(),Sn.removeEventListener("sessionstart",ms),Sn.removeEventListener("sessionend",xr),Ee&&(Ee.dispose(),Ee=null),Ds.stop()};function it(ee){ee.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),_=!0}function pe(){console.log("THREE.WebGLRenderer: Context Restored."),_=!1;const ee=Ye.autoReset,Ne=We.enabled,Fe=We.autoUpdate,ze=We.needsUpdate,$e=We.type;Tr(),Ye.autoReset=ee,We.enabled=Ne,We.autoUpdate=Fe,We.needsUpdate=ze,We.type=$e}function dt(ee){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",ee.statusMessage)}function ht(ee){const Ne=ee.target;Ne.removeEventListener("dispose",ht),Zt(Ne)}function Zt(ee){Ht(ee),qe.remove(ee)}function Ht(ee){const Ne=qe.get(ee).programs;Ne!==void 0&&(Ne.forEach(function(Fe){Le.releaseProgram(Fe)}),ee.isShaderMaterial&&Le.releaseShaderCache(ee))}this.renderBufferDirect=function(ee,Ne,Fe,ze,$e,yt){Ne===null&&(Ne=_e);const jt=$e.isMesh&&$e.matrixWorld.determinant()<0,qt=MO(ee,Ne,Fe,ze,$e);Te.setMaterial(ze,jt);let Qt=Fe.index,cn=1;if(ze.wireframe===!0){if(Qt=ie.getWireframeAttribute(Fe),Qt===void 0)return;cn=2}const on=Fe.drawRange,un=Fe.attributes.position;let ei=on.start*cn,$s=(on.start+on.count)*cn;yt!==null&&(ei=Math.max(ei,yt.start*cn),$s=Math.min($s,(yt.start+yt.count)*cn)),Qt!==null?(ei=Math.max(ei,0),$s=Math.min($s,Qt.count)):un!=null&&(ei=Math.max(ei,0),$s=Math.min($s,un.count));const $r=$s-ei;if($r<0||$r===1/0)return;ln.setup($e,ze,qt,Fe,Qt);let gs,Jt=Vt;if(Qt!==null&&(gs=Z.get(Qt),Jt=Ot,Jt.setIndex(gs)),$e.isMesh)ze.wireframe===!0?(Te.setLineWidth(ze.wireframeLinewidth*Ce()),Jt.setMode(G.LINES)):Jt.setMode(G.TRIANGLES);else if($e.isLine){let _t=ze.linewidth;_t===void 0&&(_t=1),Te.setLineWidth(_t*Ce()),$e.isLineSegments?Jt.setMode(G.LINES):$e.isLineLoop?Jt.setMode(G.LINE_LOOP):Jt.setMode(G.LINE_STRIP)}else $e.isPoints?Jt.setMode(G.POINTS):$e.isSprite&&Jt.setMode(G.TRIANGLES);if($e.isBatchedMesh)Jt.renderMultiDraw($e._multiDrawStarts,$e._multiDrawCounts,$e._multiDrawCount);else if($e.isInstancedMesh)Jt.renderInstances(ei,$r,$e.count);else if(Fe.isInstancedBufferGeometry){const _t=Fe._maxInstanceCount!==void 0?Fe._maxInstanceCount:1/0,ll=Math.min(Fe.instanceCount,_t);Jt.renderInstances(ei,$r,ll)}else Jt.render(ei,$r)};function vr(ee,Ne,Fe){ee.transparent===!0&&ee.side===Cu&&ee.forceSinglePass===!1?(ee.side=Ua,ee.needsUpdate=!0,my(ee,Ne,Fe),ee.side=dh,ee.needsUpdate=!0,my(ee,Ne,Fe),ee.side=Cu):my(ee,Ne,Fe)}this.compile=function(ee,Ne,Fe=null){Fe===null&&(Fe=ee),m=Ge.get(Fe),m.init(),x.push(m),Fe.traverseVisible(function($e){$e.isLight&&$e.layers.test(Ne.layers)&&(m.pushLight($e),$e.castShadow&&m.pushShadow($e))}),ee!==Fe&&ee.traverseVisible(function($e){$e.isLight&&$e.layers.test(Ne.layers)&&(m.pushLight($e),$e.castShadow&&m.pushShadow($e))}),m.setupLights(b._useLegacyLights);const ze=new Set;return ee.traverse(function($e){const yt=$e.material;if(yt)if(Array.isArray(yt))for(let jt=0;jt<yt.length;jt++){const qt=yt[jt];vr(qt,Fe,$e),ze.add(qt)}else vr(yt,Fe,$e),ze.add(yt)}),x.pop(),m=null,ze},this.compileAsync=function(ee,Ne,Fe=null){const ze=this.compile(ee,Ne,Fe);return new Promise($e=>{function yt(){if(ze.forEach(function(jt){qe.get(jt).currentProgram.isReady()&&ze.delete(jt)}),ze.size===0){$e(ee);return}setTimeout(yt,10)}xe.get("KHR_parallel_shader_compile")!==null?yt():setTimeout(yt,10)})};let ur=null;function Ti(ee){ur&&ur(ee)}function ms(){Ds.stop()}function xr(){Ds.start()}const Ds=new ave;Ds.setAnimationLoop(Ti),typeof self<"u"&&Ds.setContext(self),this.setAnimationLoop=function(ee){ur=ee,Sn.setAnimationLoop(ee),ee===null?Ds.stop():Ds.start()},Sn.addEventListener("sessionstart",ms),Sn.addEventListener("sessionend",xr),this.render=function(ee,Ne){if(Ne!==void 0&&Ne.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(_===!0)return;ee.matrixWorldAutoUpdate===!0&&ee.updateMatrixWorld(),Ne.parent===null&&Ne.matrixWorldAutoUpdate===!0&&Ne.updateMatrixWorld(),Sn.enabled===!0&&Sn.isPresenting===!0&&(Sn.cameraAutoUpdate===!0&&Sn.updateCamera(Ne),Ne=Sn.getCamera()),ee.isScene===!0&&ee.onBeforeRender(b,ee,Ne,C),m=Ge.get(ee,x.length),m.init(),x.push(m),me.multiplyMatrices(Ne.projectionMatrix,Ne.matrixWorldInverse),J.setFromProjectionMatrix(me),fe=this.localClippingEnabled,oe=rt.init(this.clippingPlanes,fe),g=Ie.get(ee,y.length),g.init(),y.push(g),ol(ee,Ne,0,b.sortObjects),g.finish(),b.sortObjects===!0&&g.sort(L,V),this.info.render.frame++,oe===!0&&rt.beginShadows();const Fe=m.state.shadowsArray;if(We.render(Fe,ee,Ne),oe===!0&&rt.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ut.render(g,ee),m.setupLights(b._useLegacyLights),Ne.isArrayCamera){const ze=Ne.cameras;for(let $e=0,yt=ze.length;$e<yt;$e++){const jt=ze[$e];kb(g,ee,jt,jt.viewport)}}else kb(g,ee,Ne);C!==null&&(Q.updateMultisampleRenderTarget(C),Q.updateRenderTargetMipmap(C)),ee.isScene===!0&&ee.onAfterRender(b,ee,Ne),ln.resetDefaultState(),I=-1,A=null,x.pop(),x.length>0?m=x[x.length-1]:m=null,y.pop(),y.length>0?g=y[y.length-1]:g=null};function ol(ee,Ne,Fe,ze){if(ee.visible===!1)return;if(ee.layers.test(Ne.layers)){if(ee.isGroup)Fe=ee.renderOrder;else if(ee.isLOD)ee.autoUpdate===!0&&ee.update(Ne);else if(ee.isLight)m.pushLight(ee),ee.castShadow&&m.pushShadow(ee);else if(ee.isSprite){if(!ee.frustumCulled||J.intersectsSprite(ee)){ze&&ge.setFromMatrixPosition(ee.matrixWorld).applyMatrix4(me);const jt=ae.update(ee),qt=ee.material;qt.visible&&g.push(ee,jt,qt,Fe,ge.z,null)}}else if((ee.isMesh||ee.isLine||ee.isPoints)&&(!ee.frustumCulled||J.intersectsObject(ee))){const jt=ae.update(ee),qt=ee.material;if(ze&&(ee.boundingSphere!==void 0?(ee.boundingSphere===null&&ee.computeBoundingSphere(),ge.copy(ee.boundingSphere.center)):(jt.boundingSphere===null&&jt.computeBoundingSphere(),ge.copy(jt.boundingSphere.center)),ge.applyMatrix4(ee.matrixWorld).applyMatrix4(me)),Array.isArray(qt)){const Qt=jt.groups;for(let cn=0,on=Qt.length;cn<on;cn++){const un=Qt[cn],ei=qt[un.materialIndex];ei&&ei.visible&&g.push(ee,jt,ei,Fe,ge.z,un)}}else qt.visible&&g.push(ee,jt,qt,Fe,ge.z,null)}}const yt=ee.children;for(let jt=0,qt=yt.length;jt<qt;jt++)ol(yt[jt],Ne,Fe,ze)}function kb(ee,Ne,Fe,ze){const $e=ee.opaque,yt=ee.transmissive,jt=ee.transparent;m.setupLightsView(Fe),oe===!0&&rt.setGlobalState(b.clippingPlanes,Fe),yt.length>0&&Mb($e,yt,Ne,Fe),ze&&Te.viewport(k.copy(ze)),$e.length>0&&py($e,Ne,Fe),yt.length>0&&py(yt,Ne,Fe),jt.length>0&&py(jt,Ne,Fe),Te.buffers.depth.setTest(!0),Te.buffers.depth.setMask(!0),Te.buffers.color.setMask(!0),Te.setPolygonOffset(!1)}function Mb(ee,Ne,Fe,ze){if((Fe.isScene===!0?Fe.overrideMaterial:null)!==null)return;const yt=Pe.isWebGL2;Ee===null&&(Ee=new Kc(1,1,{generateMipmaps:!0,type:xe.has("EXT_color_buffer_half_float")?N0:Bu,minFilter:tp,samples:yt?4:0})),b.getDrawingBufferSize(De),yt?Ee.setSize(De.x,De.y):Ee.setSize(vk(De.x),vk(De.y));const jt=b.getRenderTarget();b.setRenderTarget(Ee),b.getClearColor(z),O=b.getClearAlpha(),O<1&&b.setClearColor(16777215,.5),b.clear();const qt=b.toneMapping;b.toneMapping=zu,py(ee,Fe,ze),Q.updateMultisampleRenderTarget(Ee),Q.updateRenderTargetMipmap(Ee);let Qt=!1;for(let cn=0,on=Ne.length;cn<on;cn++){const un=Ne[cn],ei=un.object,$s=un.geometry,$r=un.material,gs=un.group;if($r.side===Cu&&ei.layers.test(ze.layers)){const Jt=$r.side;$r.side=Ua,$r.needsUpdate=!0,Eh(ei,Fe,ze,$s,$r,gs),$r.side=Jt,$r.needsUpdate=!0,Qt=!0}}Qt===!0&&(Q.updateMultisampleRenderTarget(Ee),Q.updateRenderTargetMipmap(Ee)),b.setRenderTarget(jt),b.setClearColor(z,O),b.toneMapping=qt}function py(ee,Ne,Fe){const ze=Ne.isScene===!0?Ne.overrideMaterial:null;for(let $e=0,yt=ee.length;$e<yt;$e++){const jt=ee[$e],qt=jt.object,Qt=jt.geometry,cn=ze===null?jt.material:ze,on=jt.group;qt.layers.test(Fe.layers)&&Eh(qt,Ne,Fe,Qt,cn,on)}}function Eh(ee,Ne,Fe,ze,$e,yt){ee.onBeforeRender(b,Ne,Fe,ze,$e,yt),ee.modelViewMatrix.multiplyMatrices(Fe.matrixWorldInverse,ee.matrixWorld),ee.normalMatrix.getNormalMatrix(ee.modelViewMatrix),$e.onBeforeRender(b,Ne,Fe,ze,ee,yt),$e.transparent===!0&&$e.side===Cu&&$e.forceSinglePass===!1?($e.side=Ua,$e.needsUpdate=!0,b.renderBufferDirect(Fe,Ne,ze,$e,ee,yt),$e.side=dh,$e.needsUpdate=!0,b.renderBufferDirect(Fe,Ne,ze,$e,ee,yt),$e.side=Cu):b.renderBufferDirect(Fe,Ne,ze,$e,ee,yt),ee.onAfterRender(b,Ne,Fe,ze,$e,yt)}function my(ee,Ne,Fe){Ne.isScene!==!0&&(Ne=_e);const ze=qe.get(ee),$e=m.state.lights,yt=m.state.shadowsArray,jt=$e.state.version,qt=Le.getParameters(ee,$e.state,yt,Ne,Fe),Qt=Le.getProgramCacheKey(qt);let cn=ze.programs;ze.environment=ee.isMeshStandardMaterial?Ne.environment:null,ze.fog=Ne.fog,ze.envMap=(ee.isMeshStandardMaterial?we:X).get(ee.envMap||ze.environment),cn===void 0&&(ee.addEventListener("dispose",ht),cn=new Map,ze.programs=cn);let on=cn.get(Qt);if(on!==void 0){if(ze.currentProgram===on&&ze.lightsStateVersion===jt)return RE(ee,qt),on}else qt.uniforms=Le.getUniforms(ee),ee.onBuild(Fe,qt,b),ee.onBeforeCompile(qt,b),on=Le.acquireProgram(qt,Qt),cn.set(Qt,on),ze.uniforms=qt.uniforms;const un=ze.uniforms;return(!ee.isShaderMaterial&&!ee.isRawShaderMaterial||ee.clipping===!0)&&(un.clippingPlanes=rt.uniform),RE(ee,qt),ze.needsLights=PO(ee),ze.lightsStateVersion=jt,ze.needsLights&&(un.ambientLightColor.value=$e.state.ambient,un.lightProbe.value=$e.state.probe,un.directionalLights.value=$e.state.directional,un.directionalLightShadows.value=$e.state.directionalShadow,un.spotLights.value=$e.state.spot,un.spotLightShadows.value=$e.state.spotShadow,un.rectAreaLights.value=$e.state.rectArea,un.ltc_1.value=$e.state.rectAreaLTC1,un.ltc_2.value=$e.state.rectAreaLTC2,un.pointLights.value=$e.state.point,un.pointLightShadows.value=$e.state.pointShadow,un.hemisphereLights.value=$e.state.hemi,un.directionalShadowMap.value=$e.state.directionalShadowMap,un.directionalShadowMatrix.value=$e.state.directionalShadowMatrix,un.spotShadowMap.value=$e.state.spotShadowMap,un.spotLightMatrix.value=$e.state.spotLightMatrix,un.spotLightMap.value=$e.state.spotLightMap,un.pointShadowMap.value=$e.state.pointShadowMap,un.pointShadowMatrix.value=$e.state.pointShadowMatrix),ze.currentProgram=on,ze.uniformsList=null,on}function ME(ee){if(ee.uniformsList===null){const Ne=ee.currentProgram.getUniforms();ee.uniformsList=J2.seqWithValue(Ne.seq,ee.uniforms)}return ee.uniformsList}function RE(ee,Ne){const Fe=qe.get(ee);Fe.outputColorSpace=Ne.outputColorSpace,Fe.batching=Ne.batching,Fe.instancing=Ne.instancing,Fe.instancingColor=Ne.instancingColor,Fe.skinning=Ne.skinning,Fe.morphTargets=Ne.morphTargets,Fe.morphNormals=Ne.morphNormals,Fe.morphColors=Ne.morphColors,Fe.morphTargetsCount=Ne.morphTargetsCount,Fe.numClippingPlanes=Ne.numClippingPlanes,Fe.numIntersection=Ne.numClipIntersection,Fe.vertexAlphas=Ne.vertexAlphas,Fe.vertexTangents=Ne.vertexTangents,Fe.toneMapping=Ne.toneMapping}function MO(ee,Ne,Fe,ze,$e){Ne.isScene!==!0&&(Ne=_e),Q.resetTextureUnits();const yt=Ne.fog,jt=ze.isMeshStandardMaterial?Ne.environment:null,qt=C===null?b.outputColorSpace:C.isXRRenderTarget===!0?C.texture.colorSpace:Qu,Qt=(ze.isMeshStandardMaterial?we:X).get(ze.envMap||jt),cn=ze.vertexColors===!0&&!!Fe.attributes.color&&Fe.attributes.color.itemSize===4,on=!!Fe.attributes.tangent&&(!!ze.normalMap||ze.anisotropy>0),un=!!Fe.morphAttributes.position,ei=!!Fe.morphAttributes.normal,$s=!!Fe.morphAttributes.color;let $r=zu;ze.toneMapped&&(C===null||C.isXRRenderTarget===!0)&&($r=b.toneMapping);const gs=Fe.morphAttributes.position||Fe.morphAttributes.normal||Fe.morphAttributes.color,Jt=gs!==void 0?gs.length:0,_t=qe.get(ze),ll=m.state.lights;if(oe===!0&&(fe===!0||ee!==A)){const Ls=ee===A&&ze.id===I;rt.setState(ze,ee,Ls)}let In=!1;ze.version===_t.__version?(_t.needsLights&&_t.lightsStateVersion!==ll.state.version||_t.outputColorSpace!==qt||$e.isBatchedMesh&&_t.batching===!1||!$e.isBatchedMesh&&_t.batching===!0||$e.isInstancedMesh&&_t.instancing===!1||!$e.isInstancedMesh&&_t.instancing===!0||$e.isSkinnedMesh&&_t.skinning===!1||!$e.isSkinnedMesh&&_t.skinning===!0||$e.isInstancedMesh&&_t.instancingColor===!0&&$e.instanceColor===null||$e.isInstancedMesh&&_t.instancingColor===!1&&$e.instanceColor!==null||_t.envMap!==Qt||ze.fog===!0&&_t.fog!==yt||_t.numClippingPlanes!==void 0&&(_t.numClippingPlanes!==rt.numPlanes||_t.numIntersection!==rt.numIntersection)||_t.vertexAlphas!==cn||_t.vertexTangents!==on||_t.morphTargets!==un||_t.morphNormals!==ei||_t.morphColors!==$s||_t.toneMapping!==$r||Pe.isWebGL2===!0&&_t.morphTargetsCount!==Jt)&&(In=!0):(In=!0,_t.__version=ze.version);let hi=_t.currentProgram;In===!0&&(hi=my(ze,Ne,$e));let su=!1,cl=!1,ys=!1;const Ei=hi.getUniforms(),au=_t.uniforms;if(Te.useProgram(hi.program)&&(su=!0,cl=!0,ys=!0),ze.id!==I&&(I=ze.id,cl=!0),su||A!==ee){Ei.setValue(G,"projectionMatrix",ee.projectionMatrix),Ei.setValue(G,"viewMatrix",ee.matrixWorldInverse);const Ls=Ei.map.cameraPosition;Ls!==void 0&&Ls.setValue(G,ge.setFromMatrixPosition(ee.matrixWorld)),Pe.logarithmicDepthBuffer&&Ei.setValue(G,"logDepthBufFC",2/(Math.log(ee.far+1)/Math.LN2)),(ze.isMeshPhongMaterial||ze.isMeshToonMaterial||ze.isMeshLambertMaterial||ze.isMeshBasicMaterial||ze.isMeshStandardMaterial||ze.isShaderMaterial)&&Ei.setValue(G,"isOrthographic",ee.isOrthographicCamera===!0),A!==ee&&(A=ee,cl=!0,ys=!0)}if($e.isSkinnedMesh){Ei.setOptional(G,$e,"bindMatrix"),Ei.setOptional(G,$e,"bindMatrixInverse");const Ls=$e.skeleton;Ls&&(Pe.floatVertexTextures?(Ls.boneTexture===null&&Ls.computeBoneTexture(),Ei.setValue(G,"boneTexture",Ls.boneTexture,Q)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}$e.isBatchedMesh&&(Ei.setOptional(G,$e,"batchingTexture"),Ei.setValue(G,"batchingTexture",$e._matricesTexture,Q));const gy=Fe.morphAttributes;if((gy.position!==void 0||gy.normal!==void 0||gy.color!==void 0&&Pe.isWebGL2===!0)&&hn.update($e,Fe,hi),(cl||_t.receiveShadow!==$e.receiveShadow)&&(_t.receiveShadow=$e.receiveShadow,Ei.setValue(G,"receiveShadow",$e.receiveShadow)),ze.isMeshGouraudMaterial&&ze.envMap!==null&&(au.envMap.value=Qt,au.flipEnvMap.value=Qt.isCubeTexture&&Qt.isRenderTargetTexture===!1?-1:1),cl&&(Ei.setValue(G,"toneMappingExposure",b.toneMappingExposure),_t.needsLights&&RO(au,ys),yt&&ze.fog===!0&&Ae.refreshFogUniforms(au,yt),Ae.refreshMaterialUniforms(au,ze,W,B,Ee),J2.upload(G,ME(_t),au,Q)),ze.isShaderMaterial&&ze.uniformsNeedUpdate===!0&&(J2.upload(G,ME(_t),au,Q),ze.uniformsNeedUpdate=!1),ze.isSpriteMaterial&&Ei.setValue(G,"center",$e.center),Ei.setValue(G,"modelViewMatrix",$e.modelViewMatrix),Ei.setValue(G,"normalMatrix",$e.normalMatrix),Ei.setValue(G,"modelMatrix",$e.matrixWorld),ze.isShaderMaterial||ze.isRawShaderMaterial){const Ls=ze.uniformsGroups;for(let yy=0,Io=Ls.length;yy<Io;yy++)if(Pe.isWebGL2){const PE=Ls[yy];Hn.update(PE,hi),Hn.bind(PE,hi)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return hi}function RO(ee,Ne){ee.ambientLightColor.needsUpdate=Ne,ee.lightProbe.needsUpdate=Ne,ee.directionalLights.needsUpdate=Ne,ee.directionalLightShadows.needsUpdate=Ne,ee.pointLights.needsUpdate=Ne,ee.pointLightShadows.needsUpdate=Ne,ee.spotLights.needsUpdate=Ne,ee.spotLightShadows.needsUpdate=Ne,ee.rectAreaLights.needsUpdate=Ne,ee.hemisphereLights.needsUpdate=Ne}function PO(ee){return ee.isMeshLambertMaterial||ee.isMeshToonMaterial||ee.isMeshPhongMaterial||ee.isMeshStandardMaterial||ee.isShadowMaterial||ee.isShaderMaterial&&ee.lights===!0}this.getActiveCubeFace=function(){return T},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return C},this.setRenderTargetTextures=function(ee,Ne,Fe){qe.get(ee.texture).__webglTexture=Ne,qe.get(ee.depthTexture).__webglTexture=Fe;const ze=qe.get(ee);ze.__hasExternalTextures=!0,ze.__hasExternalTextures&&(ze.__autoAllocateDepthBuffer=Fe===void 0,ze.__autoAllocateDepthBuffer||xe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ze.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(ee,Ne){const Fe=qe.get(ee);Fe.__webglFramebuffer=Ne,Fe.__useDefaultFramebuffer=Ne===void 0},this.setRenderTarget=function(ee,Ne=0,Fe=0){C=ee,T=Ne,E=Fe;let ze=!0,$e=null,yt=!1,jt=!1;if(ee){const Qt=qe.get(ee);Qt.__useDefaultFramebuffer!==void 0?(Te.bindFramebuffer(G.FRAMEBUFFER,null),ze=!1):Qt.__webglFramebuffer===void 0?Q.setupRenderTarget(ee):Qt.__hasExternalTextures&&Q.rebindTextures(ee,qe.get(ee.texture).__webglTexture,qe.get(ee.depthTexture).__webglTexture);const cn=ee.texture;(cn.isData3DTexture||cn.isDataArrayTexture||cn.isCompressedArrayTexture)&&(jt=!0);const on=qe.get(ee).__webglFramebuffer;ee.isWebGLCubeRenderTarget?(Array.isArray(on[Ne])?$e=on[Ne][Fe]:$e=on[Ne],yt=!0):Pe.isWebGL2&&ee.samples>0&&Q.useMultisampledRTT(ee)===!1?$e=qe.get(ee).__webglMultisampledFramebuffer:Array.isArray(on)?$e=on[Fe]:$e=on,k.copy(ee.viewport),R.copy(ee.scissor),$=ee.scissorTest}else k.copy(H).multiplyScalar(W).floor(),R.copy(K).multiplyScalar(W).floor(),$=te;if(Te.bindFramebuffer(G.FRAMEBUFFER,$e)&&Pe.drawBuffers&&ze&&Te.drawBuffers(ee,$e),Te.viewport(k),Te.scissor(R),Te.setScissorTest($),yt){const Qt=qe.get(ee.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+Ne,Qt.__webglTexture,Fe)}else if(jt){const Qt=qe.get(ee.texture),cn=Ne||0;G.framebufferTextureLayer(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,Qt.__webglTexture,Fe||0,cn)}I=-1},this.readRenderTargetPixels=function(ee,Ne,Fe,ze,$e,yt,jt){if(!(ee&&ee.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let qt=qe.get(ee).__webglFramebuffer;if(ee.isWebGLCubeRenderTarget&&jt!==void 0&&(qt=qt[jt]),qt){Te.bindFramebuffer(G.FRAMEBUFFER,qt);try{const Qt=ee.texture,cn=Qt.format,on=Qt.type;if(cn!==ja&&bt.convert(cn)!==G.getParameter(G.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const un=on===N0&&(xe.has("EXT_color_buffer_half_float")||Pe.isWebGL2&&xe.has("EXT_color_buffer_float"));if(on!==Bu&&bt.convert(on)!==G.getParameter(G.IMPLEMENTATION_COLOR_READ_TYPE)&&!(on===Pc&&(Pe.isWebGL2||xe.has("OES_texture_float")||xe.has("WEBGL_color_buffer_float")))&&!un){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Ne>=0&&Ne<=ee.width-ze&&Fe>=0&&Fe<=ee.height-$e&&G.readPixels(Ne,Fe,ze,$e,bt.convert(cn),bt.convert(on),yt)}finally{const Qt=C!==null?qe.get(C).__webglFramebuffer:null;Te.bindFramebuffer(G.FRAMEBUFFER,Qt)}}},this.copyFramebufferToTexture=function(ee,Ne,Fe=0){const ze=Math.pow(2,-Fe),$e=Math.floor(Ne.image.width*ze),yt=Math.floor(Ne.image.height*ze);Q.setTexture2D(Ne,0),G.copyTexSubImage2D(G.TEXTURE_2D,Fe,0,0,ee.x,ee.y,$e,yt),Te.unbindTexture()},this.copyTextureToTexture=function(ee,Ne,Fe,ze=0){const $e=Ne.image.width,yt=Ne.image.height,jt=bt.convert(Fe.format),qt=bt.convert(Fe.type);Q.setTexture2D(Fe,0),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,Fe.flipY),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Fe.premultiplyAlpha),G.pixelStorei(G.UNPACK_ALIGNMENT,Fe.unpackAlignment),Ne.isDataTexture?G.texSubImage2D(G.TEXTURE_2D,ze,ee.x,ee.y,$e,yt,jt,qt,Ne.image.data):Ne.isCompressedTexture?G.compressedTexSubImage2D(G.TEXTURE_2D,ze,ee.x,ee.y,Ne.mipmaps[0].width,Ne.mipmaps[0].height,jt,Ne.mipmaps[0].data):G.texSubImage2D(G.TEXTURE_2D,ze,ee.x,ee.y,jt,qt,Ne.image),ze===0&&Fe.generateMipmaps&&G.generateMipmap(G.TEXTURE_2D),Te.unbindTexture()},this.copyTextureToTexture3D=function(ee,Ne,Fe,ze,$e=0){if(b.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const yt=ee.max.x-ee.min.x+1,jt=ee.max.y-ee.min.y+1,qt=ee.max.z-ee.min.z+1,Qt=bt.convert(ze.format),cn=bt.convert(ze.type);let on;if(ze.isData3DTexture)Q.setTexture3D(ze,0),on=G.TEXTURE_3D;else if(ze.isDataArrayTexture||ze.isCompressedArrayTexture)Q.setTexture2DArray(ze,0),on=G.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,ze.flipY),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ze.premultiplyAlpha),G.pixelStorei(G.UNPACK_ALIGNMENT,ze.unpackAlignment);const un=G.getParameter(G.UNPACK_ROW_LENGTH),ei=G.getParameter(G.UNPACK_IMAGE_HEIGHT),$s=G.getParameter(G.UNPACK_SKIP_PIXELS),$r=G.getParameter(G.UNPACK_SKIP_ROWS),gs=G.getParameter(G.UNPACK_SKIP_IMAGES),Jt=Fe.isCompressedTexture?Fe.mipmaps[$e]:Fe.image;G.pixelStorei(G.UNPACK_ROW_LENGTH,Jt.width),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,Jt.height),G.pixelStorei(G.UNPACK_SKIP_PIXELS,ee.min.x),G.pixelStorei(G.UNPACK_SKIP_ROWS,ee.min.y),G.pixelStorei(G.UNPACK_SKIP_IMAGES,ee.min.z),Fe.isDataTexture||Fe.isData3DTexture?G.texSubImage3D(on,$e,Ne.x,Ne.y,Ne.z,yt,jt,qt,Qt,cn,Jt.data):Fe.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),G.compressedTexSubImage3D(on,$e,Ne.x,Ne.y,Ne.z,yt,jt,qt,Qt,Jt.data)):G.texSubImage3D(on,$e,Ne.x,Ne.y,Ne.z,yt,jt,qt,Qt,cn,Jt),G.pixelStorei(G.UNPACK_ROW_LENGTH,un),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,ei),G.pixelStorei(G.UNPACK_SKIP_PIXELS,$s),G.pixelStorei(G.UNPACK_SKIP_ROWS,$r),G.pixelStorei(G.UNPACK_SKIP_IMAGES,gs),$e===0&&ze.generateMipmaps&&G.generateMipmap(on),Te.unbindTexture()},this.initTexture=function(ee){ee.isCubeTexture?Q.setTextureCube(ee,0):ee.isData3DTexture?Q.setTexture3D(ee,0):ee.isDataArrayTexture||ee.isCompressedArrayTexture?Q.setTexture2DArray(ee,0):Q.setTexture2D(ee,0),Te.unbindTexture()},this.resetState=function(){T=0,E=0,C=null,Te.reset(),ln.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Oc}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const n=this.getContext();n.drawingBufferColorSpace=e===KP?"display-p3":"srgb",n.unpackColorSpace=dr.workingColorSpace===dE?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===rs?Df:vG}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===Df?rs:Qu}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class pve extends IG{}pve.prototype.isWebGL1Renderer=!0;class QP{constructor(e,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new xt(e),this.density=n}clone(){return new QP(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class JP{constructor(e,n=1,r=1e3){this.isFog=!0,this.name="",this.color=new xt(e),this.near=n,this.far=r}clone(){return new JP(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class kG extends tr{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,n){return super.copy(e,n),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const n=super.toJSON(e);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(n.object.backgroundIntensity=this.backgroundIntensity),n}}class eO{constructor(e,n){this.isInterleavedBuffer=!0,this.array=e,this.stride=n,this.count=e!==void 0?e.length/n:0,this.usage=h_,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=Zo()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,n){this.updateRanges.push({start:e,count:n})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,n,r){e*=this.stride,r*=n.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=n.array[r+i];return this}set(e,n=0){return this.array.set(e,n),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(n,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Zo()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Na=new ne;class Bg{constructor(e,n,r,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=n,this.offset=r,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let n=0,r=this.data.count;n<r;n++)Na.fromBufferAttribute(this,n),Na.applyMatrix4(e),this.setXYZ(n,Na.x,Na.y,Na.z);return this}applyNormalMatrix(e){for(let n=0,r=this.count;n<r;n++)Na.fromBufferAttribute(this,n),Na.applyNormalMatrix(e),this.setXYZ(n,Na.x,Na.y,Na.z);return this}transformDirection(e){for(let n=0,r=this.count;n<r;n++)Na.fromBufferAttribute(this,n),Na.transformDirection(e),this.setXYZ(n,Na.x,Na.y,Na.z);return this}setX(e,n){return this.normalized&&(n=bn(n,this.array)),this.data.array[e*this.data.stride+this.offset]=n,this}setY(e,n){return this.normalized&&(n=bn(n,this.array)),this.data.array[e*this.data.stride+this.offset+1]=n,this}setZ(e,n){return this.normalized&&(n=bn(n,this.array)),this.data.array[e*this.data.stride+this.offset+2]=n,this}setW(e,n){return this.normalized&&(n=bn(n,this.array)),this.data.array[e*this.data.stride+this.offset+3]=n,this}getX(e){let n=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(n=co(n,this.array)),n}getY(e){let n=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(n=co(n,this.array)),n}getZ(e){let n=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(n=co(n,this.array)),n}getW(e){let n=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(n=co(n,this.array)),n}setXY(e,n,r){return e=e*this.data.stride+this.offset,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this}setXYZ(e,n,r,i){return e=e*this.data.stride+this.offset,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this}setXYZW(e,n,r,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(n=bn(n,this.array),r=bn(r,this.array),i=bn(i,this.array),s=bn(s,this.array)),this.data.array[e+0]=n,this.data.array[e+1]=r,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[i+s])}return new mr(new this.array.constructor(n),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Bg(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const n=[];for(let r=0;r<this.count;r++){const i=r*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class MG extends _a{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let iv;const Cw=new ne,sv=new ne,av=new ne,ov=new Xe,Nw=new Xe,mve=new an,GN=new ne,Aw=new ne,qN=new ne,UJ=new Xe,QL=new Xe,VJ=new Xe;class gve extends tr{constructor(e=new MG){if(super(),this.isSprite=!0,this.type="Sprite",iv===void 0){iv=new Cn;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),r=new eO(n,5);iv.setIndex([0,1,2,0,2,3]),iv.setAttribute("position",new Bg(r,3,0,!1)),iv.setAttribute("uv",new Bg(r,2,3,!1))}this.geometry=iv,this.material=e,this.center=new Xe(.5,.5)}raycast(e,n){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),sv.setFromMatrixScale(this.matrixWorld),mve.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),av.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&sv.multiplyScalar(-av.z);const r=this.material.rotation;let i,s;r!==0&&(s=Math.cos(r),i=Math.sin(r));const a=this.center;XN(GN.set(-.5,-.5,0),av,a,sv,i,s),XN(Aw.set(.5,-.5,0),av,a,sv,i,s),XN(qN.set(.5,.5,0),av,a,sv,i,s),UJ.set(0,0),QL.set(1,0),VJ.set(1,1);let o=e.ray.intersectTriangle(GN,Aw,qN,!1,Cw);if(o===null&&(XN(Aw.set(-.5,.5,0),av,a,sv,i,s),QL.set(0,1),o=e.ray.intersectTriangle(GN,qN,Aw,!1,Cw),o===null))return;const l=e.ray.origin.distanceTo(Cw);l<e.near||l>e.far||n.push({distance:l,point:Cw.clone(),uv:oo.getInterpolation(Cw,GN,Aw,qN,UJ,QL,VJ,new Xe),face:null,object:this})}copy(e,n){return super.copy(e,n),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function XN(t,e,n,r,i,s){ov.subVectors(t,n).addScalar(.5).multiply(r),i!==void 0?(Nw.x=s*ov.x-i*ov.y,Nw.y=i*ov.x+s*ov.y):Nw.copy(ov),t.copy(e),t.x+=Nw.x,t.y+=Nw.y,t.applyMatrix4(mve)}const KN=new ne,WJ=new ne;class yve extends tr{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const n=e.levels;for(let r=0,i=n.length;r<i;r++){const s=n[r];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,n=0,r=0){n=Math.abs(n);const i=this.levels;let s;for(s=0;s<i.length&&!(n<i[s].distance);s++);return i.splice(s,0,{distance:n,hysteresis:r,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const n=this.levels;if(n.length>0){let r,i;for(r=1,i=n.length;r<i;r++){let s=n[r].distance;if(n[r].object.visible&&(s-=s*n[r].hysteresis),e<s)break}return n[r-1].object}return null}raycast(e,n){if(this.levels.length>0){KN.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(KN);this.getObjectForDistance(i).raycast(e,n)}}update(e){const n=this.levels;if(n.length>1){KN.setFromMatrixPosition(e.matrixWorld),WJ.setFromMatrixPosition(this.matrixWorld);const r=KN.distanceTo(WJ)/e.zoom;n[0].object.visible=!0;let i,s;for(i=1,s=n.length;i<s;i++){let a=n[i].distance;if(n[i].object.visible&&(a-=a*n[i].hysteresis),r>=a)n[i-1].object.visible=!1,n[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)n[i].object.visible=!1}}toJSON(e){const n=super.toJSON(e);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const r=this.levels;for(let i=0,s=r.length;i<s;i++){const a=r[i];n.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return n}}const HJ=new ne,GJ=new hr,qJ=new hr,bNt=new ne,XJ=new an,YN=new ne,JL=new ga,KJ=new an,e3=new Tb;class vve extends ls{constructor(e,n){super(e,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=x4,this.bindMatrix=new an,this.bindMatrixInverse=new an,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Va),this.boundingBox.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,YN),this.boundingBox.expandByPoint(YN)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new ga),this.boundingSphere.makeEmpty();const n=e.getAttribute("position");for(let r=0;r<n.count;r++)this.getVertexPosition(r,YN),this.boundingSphere.expandByPoint(YN)}copy(e,n){return super.copy(e,n),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,n){const r=this.material,i=this.matrixWorld;r!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),JL.copy(this.boundingSphere),JL.applyMatrix4(i),e.ray.intersectsSphere(JL)!==!1&&(KJ.copy(i).invert(),e3.copy(e.ray).applyMatrix4(KJ),!(this.boundingBox!==null&&e3.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,n,e3)))}getVertexPosition(e,n){return super.getVertexPosition(e,n),this.applyBoneTransform(e,n),n}bind(e,n){this.skeleton=e,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new hr,n=this.geometry.attributes.skinWeight;for(let r=0,i=n.count;r<i;r++){e.fromBufferAttribute(n,r);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),n.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===x4?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===kye?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,n){const r=this.skeleton,i=this.geometry;GJ.fromBufferAttribute(i.attributes.skinIndex,e),qJ.fromBufferAttribute(i.attributes.skinWeight,e),HJ.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const a=qJ.getComponent(s);if(a!==0){const o=GJ.getComponent(s);XJ.multiplyMatrices(r.bones[o].matrixWorld,r.boneInverses[o]),n.addScaledVector(bNt.copy(HJ).applyMatrix4(XJ),a)}}return n.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,n){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,n)}}class RG extends tr{constructor(){super(),this.isBone=!0,this.type="Bone"}}class ng extends $i{constructor(e=null,n=1,r=1,i,s,a,o,l,c=Ii,u=Ii,d,h){super(null,a,o,l,c,u,i,s,d,h),this.isDataTexture=!0,this.image={data:e,width:n,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const YJ=new an,wNt=new an;class tO{constructor(e=[],n=[]){this.uuid=Zo(),this.bones=e.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),n.length===0)this.calculateInverses();else if(e.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let r=0,i=this.bones.length;r<i;r++)this.boneInverses.push(new an)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,n=this.bones.length;e<n;e++){const r=new an;this.bones[e]&&r.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(r)}}pose(){for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&r.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,n=this.bones.length;e<n;e++){const r=this.bones[e];r&&(r.parent&&r.parent.isBone?(r.matrix.copy(r.parent.matrixWorld).invert(),r.matrix.multiply(r.matrixWorld)):r.matrix.copy(r.matrixWorld),r.matrix.decompose(r.position,r.quaternion,r.scale))}}update(){const e=this.bones,n=this.boneInverses,r=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:wNt;YJ.multiplyMatrices(o,n[s]),YJ.toArray(r,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new tO(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4);n.set(this.boneMatrices);const r=new ng(n,e,e,ja,Pc);return r.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=r,this}getBoneByName(e){for(let n=0,r=this.bones.length;n<r;n++){const i=this.bones[n];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,n){this.uuid=e.uuid;for(let r=0,i=e.bones.length;r<i;r++){const s=e.bones[r];let a=n[s];a===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),a=new RG),this.bones.push(a),this.boneInverses.push(new an().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const n=this.bones,r=this.boneInverses;for(let i=0,s=n.length;i<s;i++){const a=n[i];e.bones.push(a.uuid);const o=r[i];e.boneInverses.push(o.toArray())}return e}}class M0 extends mr{constructor(e,n,r,i=1){super(e,n,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const lv=new an,ZJ=new an,ZN=[],QJ=new Va,SNt=new an,Iw=new ls,kw=new ga;class xve extends ls{constructor(e,n,r){super(e,n),this.isInstancedMesh=!0,this.instanceMatrix=new M0(new Float32Array(r*16),16),this.instanceColor=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<r;i++)this.setMatrixAt(i,SNt)}computeBoundingBox(){const e=this.geometry,n=this.count;this.boundingBox===null&&(this.boundingBox=new Va),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,lv),QJ.copy(e.boundingBox).applyMatrix4(lv),this.boundingBox.union(QJ)}computeBoundingSphere(){const e=this.geometry,n=this.count;this.boundingSphere===null&&(this.boundingSphere=new ga),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<n;r++)this.getMatrixAt(r,lv),kw.copy(e.boundingSphere).applyMatrix4(lv),this.boundingSphere.union(kw)}copy(e,n){return super.copy(e,n),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,n){n.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,n){n.fromArray(this.instanceMatrix.array,e*16)}raycast(e,n){const r=this.matrixWorld,i=this.count;if(Iw.geometry=this.geometry,Iw.material=this.material,Iw.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),kw.copy(this.boundingSphere),kw.applyMatrix4(r),e.ray.intersectsSphere(kw)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,lv),ZJ.multiplyMatrices(r,lv),Iw.matrixWorld=ZJ,Iw.raycast(e,ZN);for(let a=0,o=ZN.length;a<o;a++){const l=ZN[a];l.instanceId=s,l.object=this,n.push(l)}ZN.length=0}}setColorAt(e,n){this.instanceColor===null&&(this.instanceColor=new M0(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,n){n.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function _Nt(t,e){return t.z-e.z}function TNt(t,e){return e.z-t.z}class ENt{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,n){const r=this.pool,i=this.list;this.index>=r.length&&r.push({start:-1,count:-1,z:-1});const s=r[this.index];i.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=n}reset(){this.list.length=0,this.index=0}}const cv="batchId",Vh=new an,JJ=new an,CNt=new an,eee=new an,t3=new mE,QN=new Va,Zp=new ga,Mw=new ne,n3=new ENt,sa=new ls,JN=[];function NNt(t,e,n=0){const r=e.itemSize;if(t.isInterleavedBufferAttribute||t.array.constructor!==e.array.constructor){const i=t.count;for(let s=0;s<i;s++)for(let a=0;a<r;a++)e.setComponent(s+n,a,t.getComponent(s,a))}else e.array.set(t.array,n*r);e.needsUpdate=!0}class bve extends ls{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,n,r=n*2,i){super(new Cn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=n,this._maxIndexCount=r,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const n=new Float32Array(e*e*4),r=new ng(n,e,e,ja,Pc);this._matricesTexture=r}_initializeGeometry(e){const n=this.geometry,r=this._maxVertexCount,i=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const o in e.attributes){const l=e.getAttribute(o),{array:c,itemSize:u,normalized:d}=l,h=new c.constructor(r*u),f=new l.constructor(h,u,d);f.setUsage(l.usage),n.setAttribute(o,f)}if(e.getIndex()!==null){const o=r>65536?new Uint32Array(s):new Uint16Array(s);n.setIndex(new mr(o,1))}const a=i>65536?new Uint32Array(r):new Uint16Array(r);n.setAttribute(cv,new mr(a,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(cv))throw new Error(`BatchedMesh: Geometry cannot use attribute "${cv}"`);const n=this.geometry;if(!!e.getIndex()!=!!n.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const r in n.attributes){if(r===cv)continue;if(!e.hasAttribute(r))throw new Error(`BatchedMesh: Added geometry missing "${r}". All geometries must have consistent attributes.`);const i=e.getAttribute(r),s=n.getAttribute(r);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Va);const e=this._geometryCount,n=this.boundingBox,r=this._active;n.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,Vh),this.getBoundingBoxAt(i,QN).applyMatrix4(Vh),n.union(QN))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new ga);const e=this._geometryCount,n=this.boundingSphere,r=this._active;n.makeEmpty();for(let i=0;i<e;i++)r[i]!==!1&&(this.getMatrixAt(i,Vh),this.getBoundingSphereAt(i,Zp).applyMatrix4(Vh),n.union(Zp))}addGeometry(e,n=-1,r=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const i={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const a=this._reservedRanges,o=this._drawRanges,l=this._bounds;this._geometryCount!==0&&(s=a[a.length-1]),n===-1?i.vertexCount=e.getAttribute("position").count:i.vertexCount=n,s===null?i.vertexStart=0:i.vertexStart=s.vertexStart+s.vertexCount;const c=e.getIndex(),u=c!==null;if(u&&(r===-1?i.indexCount=c.count:i.indexCount=r,s===null?i.indexStart=0:i.indexStart=s.indexStart+s.indexCount),i.indexStart!==-1&&i.indexStart+i.indexCount>this._maxIndexCount||i.vertexStart+i.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const d=this._visibility,h=this._active,f=this._matricesTexture,p=this._matricesTexture.image.data;d.push(!0),h.push(!0);const g=this._geometryCount;this._geometryCount++,CNt.toArray(p,g*16),f.needsUpdate=!0,a.push(i),o.push({start:u?i.indexStart:i.vertexStart,count:-1}),l.push({boxInitialized:!1,box:new Va,sphereInitialized:!1,sphere:new ga});const m=this.geometry.getAttribute(cv);for(let y=0;y<i.vertexCount;y++)m.setX(i.vertexStart+y,g);return m.needsUpdate=!0,this.setGeometryAt(g,e),g}setGeometryAt(e,n){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(n);const r=this.geometry,i=r.getIndex()!==null,s=r.getIndex(),a=n.getIndex(),o=this._reservedRanges[e];if(i&&a.count>o.indexCount||n.attributes.position.count>o.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.vertexCount;for(const f in r.attributes){if(f===cv)continue;const p=n.getAttribute(f),g=r.getAttribute(f);NNt(p,g,l);const m=p.itemSize;for(let y=p.count,x=c;y<x;y++){const b=l+y;for(let _=0;_<m;_++)g.setComponent(b,_,0)}g.needsUpdate=!0}if(i){const f=o.indexStart;for(let p=0;p<a.count;p++)s.setX(f+p,l+a.getX(p));for(let p=a.count,g=o.indexCount;p<g;p++)s.setX(f+p,l);s.needsUpdate=!0}const u=this._bounds[e];n.boundingBox!==null?(u.box.copy(n.boundingBox),u.boxInitialized=!0):u.boxInitialized=!1,n.boundingSphere!==null?(u.sphere.copy(n.boundingSphere),u.sphereInitialized=!0):u.sphereInitialized=!1;const d=this._drawRanges[e],h=n.getAttribute("position");return d.count=i?a.count:h.count,this._visibilityChanged=!0,e}deleteGeometry(e){const n=this._active;return e>=n.length||n[e]===!1?this:(n[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,n){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.box,a=this.geometry;if(i.boxInitialized===!1){s.makeEmpty();const o=a.index,l=a.attributes.position,c=this._drawRanges[e];for(let u=c.start,d=c.start+c.count;u<d;u++){let h=u;o&&(h=o.getX(h)),s.expandByPoint(Mw.fromBufferAttribute(l,h))}i.boxInitialized=!0}return n.copy(s),n}getBoundingSphereAt(e,n){if(this._active[e]===!1)return this;const i=this._bounds[e],s=i.sphere,a=this.geometry;if(i.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,QN),QN.getCenter(s.center);const o=a.index,l=a.attributes.position,c=this._drawRanges[e];let u=0;for(let d=c.start,h=c.start+c.count;d<h;d++){let f=d;o&&(f=o.getX(f)),Mw.fromBufferAttribute(l,f),u=Math.max(u,s.center.distanceToSquared(Mw))}s.radius=Math.sqrt(u),i.sphereInitialized=!0}return n.copy(s),n}setMatrixAt(e,n){const r=this._active,i=this._matricesTexture,s=this._matricesTexture.image.data,a=this._geometryCount;return e>=a||r[e]===!1?this:(n.toArray(s,e*16),i.needsUpdate=!0,this)}getMatrixAt(e,n){const r=this._active,i=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||r[e]===!1?null:n.fromArray(i,e*16)}setVisibleAt(e,n){const r=this._visibility,i=this._active,s=this._geometryCount;return e>=s||i[e]===!1||r[e]===n?this:(r[e]=n,this._visibilityChanged=!0,this)}getVisibleAt(e){const n=this._visibility,r=this._active,i=this._geometryCount;return e>=i||r[e]===!1?!1:n[e]}raycast(e,n){const r=this._visibility,i=this._active,s=this._drawRanges,a=this._geometryCount,o=this.matrixWorld,l=this.geometry;sa.material=this.material,sa.geometry.index=l.index,sa.geometry.attributes=l.attributes,sa.geometry.boundingBox===null&&(sa.geometry.boundingBox=new Va),sa.geometry.boundingSphere===null&&(sa.geometry.boundingSphere=new ga);for(let c=0;c<a;c++){if(!r[c]||!i[c])continue;const u=s[c];sa.geometry.setDrawRange(u.start,u.count),this.getMatrixAt(c,sa.matrixWorld).premultiply(o),this.getBoundingBoxAt(c,sa.geometry.boundingBox),this.getBoundingSphereAt(c,sa.geometry.boundingSphere),sa.raycast(e,JN);for(let d=0,h=JN.length;d<h;d++){const f=JN[d];f.object=this,f.batchId=c,n.push(f)}JN.length=0}sa.material=null,sa.geometry.index=null,sa.geometry.attributes={},sa.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(n=>({...n})),this._reservedRanges=e._reservedRanges.map(n=>({...n})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(n=>({boxInitialized:n.boxInitialized,box:n.box.clone(),sphereInitialized:n.sphereInitialized,sphere:n.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,n,r,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._visibility,c=this._multiDrawStarts,u=this._multiDrawCounts,d=this._drawRanges,h=this.perObjectFrustumCulled;h&&(eee.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse).multiply(this.matrixWorld),t3.setFromProjectionMatrix(eee,e.isWebGPURenderer?A0:Oc));let f=0;if(this.sortObjects){JJ.copy(this.matrixWorld).invert(),Mw.setFromMatrixPosition(r.matrixWorld).applyMatrix4(JJ);for(let m=0,y=l.length;m<y;m++)if(l[m]){this.getMatrixAt(m,Vh),this.getBoundingSphereAt(m,Zp).applyMatrix4(Vh);let x=!1;if(h&&(x=!t3.intersectsSphere(Zp)),!x){const b=Mw.distanceTo(Zp.center);n3.push(d[m],b)}}const p=n3.list,g=this.customSort;g===null?p.sort(s.transparent?TNt:_Nt):g.call(this,p,r);for(let m=0,y=p.length;m<y;m++){const x=p[m];c[f]=x.start*o,u[f]=x.count,f++}n3.reset()}else for(let p=0,g=l.length;p<g;p++)if(l[p]){let m=!1;if(h&&(this.getMatrixAt(p,Vh),this.getBoundingSphereAt(p,Zp).applyMatrix4(Vh),m=!t3.intersectsSphere(Zp)),!m){const y=d[p];c[f]=y.start*o,u[f]=y.count,f++}}this._multiDrawCount=f,this._visibilityChanged=!1}onBeforeShadow(e,n,r,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class Ya extends _a{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new xt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const tee=new ne,nee=new ne,ree=new an,r3=new Tb,e2=new ga;class np extends tr{constructor(e=new Cn,n=new Ya){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[0];for(let i=1,s=n.count;i<s;i++)tee.fromBufferAttribute(n,i-1),nee.fromBufferAttribute(n,i),r[i]=r[i-1],r[i]+=tee.distanceTo(nee);e.setAttribute("lineDistance",new Mt(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),e2.copy(r.boundingSphere),e2.applyMatrix4(i),e2.radius+=s,e.ray.intersectsSphere(e2)===!1)return;ree.copy(i).invert(),r3.copy(e.ray).applyMatrix4(ree);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=new ne,u=new ne,d=new ne,h=new ne,f=this.isLineSegments?2:1,p=r.index,m=r.attributes.position;if(p!==null){const y=Math.max(0,a.start),x=Math.min(p.count,a.start+a.count);for(let b=y,_=x-1;b<_;b+=f){const T=p.getX(b),E=p.getX(b+1);if(c.fromBufferAttribute(m,T),u.fromBufferAttribute(m,E),r3.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const I=e.ray.origin.distanceTo(h);I<e.near||I>e.far||n.push({distance:I,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}else{const y=Math.max(0,a.start),x=Math.min(m.count,a.start+a.count);for(let b=y,_=x-1;b<_;b+=f){if(c.fromBufferAttribute(m,b),u.fromBufferAttribute(m,b+1),r3.distanceSqToSegment(c,u,h,d)>l)continue;h.applyMatrix4(this.matrixWorld);const E=e.ray.origin.distanceTo(h);E<e.near||E>e.far||n.push({distance:E,point:d.clone().applyMatrix4(this.matrixWorld),index:b,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}const iee=new ne,see=new ne;class ad extends np{constructor(e,n){super(e,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const n=e.attributes.position,r=[];for(let i=0,s=n.count;i<s;i+=2)iee.fromBufferAttribute(n,i),see.fromBufferAttribute(n,i+1),r[i]=i===0?0:r[i-1],r[i+1]=r[i]+iee.distanceTo(see);e.setAttribute("lineDistance",new Mt(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class wve extends np{constructor(e,n){super(e,n),this.isLineLoop=!0,this.type="LineLoop"}}class PG extends _a{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new xt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const aee=new an,Y4=new Tb,t2=new ga,n2=new ne;class Sve extends tr{constructor(e=new Cn,n=new PG){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=n,this.updateMorphTargets()}copy(e,n){return super.copy(e,n),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,n){const r=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(r.boundingSphere===null&&r.computeBoundingSphere(),t2.copy(r.boundingSphere),t2.applyMatrix4(i),t2.radius+=s,e.ray.intersectsSphere(t2)===!1)return;aee.copy(i).invert(),Y4.copy(e.ray).applyMatrix4(aee);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=r.index,d=r.attributes.position;if(c!==null){const h=Math.max(0,a.start),f=Math.min(c.count,a.start+a.count);for(let p=h,g=f;p<g;p++){const m=c.getX(p);n2.fromBufferAttribute(d,m),oee(n2,m,l,i,e,n,this)}}else{const h=Math.max(0,a.start),f=Math.min(d.count,a.start+a.count);for(let p=h,g=f;p<g;p++)n2.fromBufferAttribute(d,p),oee(n2,p,l,i,e,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,r=Object.keys(n);if(r.length>0){const i=n[r[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function oee(t,e,n,r,i,s,a){const o=Y4.distanceSqToPoint(t);if(o<n){const l=new ne;Y4.closestPointToPoint(t,l),l.applyMatrix4(r);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,object:a})}}class ANt extends $i{constructor(e,n,r,i,s,a,o,l,c){super(e,n,r,i,s,a,o,l,c),this.isVideoTexture=!0,this.minFilter=a!==void 0?a:Ri,this.magFilter=s!==void 0?s:Ri,this.generateMipmaps=!1;const u=this;function d(){u.needsUpdate=!0,e.requestVideoFrameCallback(d)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(d)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class INt extends $i{constructor(e,n){super({width:e,height:n}),this.isFramebufferTexture=!0,this.magFilter=Ii,this.minFilter=Ii,this.generateMipmaps=!1,this.needsUpdate=!0}}class nO extends $i{constructor(e,n,r,i,s,a,o,l,c,u,d,h){super(null,a,o,l,c,u,i,s,d,h),this.isCompressedTexture=!0,this.image={width:n,height:r},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class kNt extends nO{constructor(e,n,r,i,s,a){super(e,n,r,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=pa}}class MNt extends nO{constructor(e,n,r){super(void 0,e[0].width,e[0].height,n,r,hh),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class RNt extends $i{constructor(e,n,r,i,s,a,o,l,c){super(e,n,r,i,s,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class nu{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,n){const r=this.getUtoTmapping(e);return this.getPoint(r,n)}getPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return n}getSpacedPoints(e=5){const n=[];for(let r=0;r<=e;r++)n.push(this.getPointAt(r/e));return n}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let r,i=this.getPoint(0),s=0;n.push(0);for(let a=1;a<=e;a++)r=this.getPoint(a/e),s+=r.distanceTo(i),n.push(s),i=r;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,n){const r=this.getLengths();let i=0;const s=r.length;let a;n?a=n:a=e*r[s-1];let o=0,l=s-1,c;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),c=r[i]-a,c<0)o=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,r[i]===a)return i/(s-1);const u=r[i],h=r[i+1]-u,f=(a-u)/h;return(i+f)/(s-1)}getTangent(e,n){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),l=n||(a.isVector2?new Xe:new ne);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,n){const r=this.getUtoTmapping(e);return this.getTangent(r,n)}computeFrenetFrames(e,n){const r=new ne,i=[],s=[],a=[],o=new ne,l=new an;for(let f=0;f<=e;f++){const p=f/e;i[f]=this.getTangentAt(p,new ne)}s[0]=new ne,a[0]=new ne;let c=Number.MAX_VALUE;const u=Math.abs(i[0].x),d=Math.abs(i[0].y),h=Math.abs(i[0].z);u<=c&&(c=u,r.set(1,0,0)),d<=c&&(c=d,r.set(0,1,0)),h<=c&&r.set(0,0,1),o.crossVectors(i[0],r).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let f=1;f<=e;f++){if(s[f]=s[f-1].clone(),a[f]=a[f-1].clone(),o.crossVectors(i[f-1],i[f]),o.length()>Number.EPSILON){o.normalize();const p=Math.acos(vi(i[f-1].dot(i[f]),-1,1));s[f].applyMatrix4(l.makeRotationAxis(o,p))}a[f].crossVectors(i[f],s[f])}if(n===!0){let f=Math.acos(vi(s[0].dot(s[e]),-1,1));f/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(f=-f);for(let p=1;p<=e;p++)s[p].applyMatrix4(l.makeRotationAxis(i[p],f*p)),a[p].crossVectors(i[p],s[p])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class rO extends nu{constructor(e=0,n=0,r=1,i=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=n,this.xRadius=r,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,n){const r=n||new Xe,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const u=Math.cos(this.aRotation),d=Math.sin(this.aRotation),h=l-this.aX,f=c-this.aY;l=h*u-f*d+this.aX,c=h*d+f*u+this.aY}return r.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class _ve extends rO{constructor(e,n,r,i,s,a){super(e,n,r,r,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function OG(){let t=0,e=0,n=0,r=0;function i(s,a,o,l){t=s,e=o,n=-3*s+3*a-2*o-l,r=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){i(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,u,d){let h=(a-s)/c-(o-s)/(c+u)+(o-a)/u,f=(o-a)/u-(l-a)/(u+d)+(l-o)/d;h*=u,f*=u,i(a,o,h,f)},calc:function(s){const a=s*s,o=a*s;return t+e*s+n*a+r*o}}}const r2=new ne,i3=new OG,s3=new OG,a3=new OG;class Tve extends nu{constructor(e=[],n=!1,r="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=n,this.curveType=r,this.tension=i}getPoint(e,n=new ne){const r=n,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,u;this.closed||o>0?c=i[(o-1)%s]:(r2.subVectors(i[0],i[1]).add(i[0]),c=r2);const d=i[o%s],h=i[(o+1)%s];if(this.closed||o+2<s?u=i[(o+2)%s]:(r2.subVectors(i[s-1],i[s-2]).add(i[s-1]),u=r2),this.curveType==="centripetal"||this.curveType==="chordal"){const f=this.curveType==="chordal"?.5:.25;let p=Math.pow(c.distanceToSquared(d),f),g=Math.pow(d.distanceToSquared(h),f),m=Math.pow(h.distanceToSquared(u),f);g<1e-4&&(g=1),p<1e-4&&(p=g),m<1e-4&&(m=g),i3.initNonuniformCatmullRom(c.x,d.x,h.x,u.x,p,g,m),s3.initNonuniformCatmullRom(c.y,d.y,h.y,u.y,p,g,m),a3.initNonuniformCatmullRom(c.z,d.z,h.z,u.z,p,g,m)}else this.curveType==="catmullrom"&&(i3.initCatmullRom(c.x,d.x,h.x,u.x,this.tension),s3.initCatmullRom(c.y,d.y,h.y,u.y,this.tension),a3.initCatmullRom(c.z,d.z,h.z,u.z,this.tension));return r.set(i3.calc(l),s3.calc(l),a3.calc(l)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new ne().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function lee(t,e,n,r,i){const s=(r-e)*.5,a=(i-n)*.5,o=t*t,l=t*o;return(2*n-2*r+s+a)*l+(-3*n+3*r-2*s-a)*o+s*t+n}function PNt(t,e){const n=1-t;return n*n*e}function ONt(t,e){return 2*(1-t)*t*e}function DNt(t,e){return t*t*e}function _1(t,e,n,r){return PNt(t,e)+ONt(t,n)+DNt(t,r)}function $Nt(t,e){const n=1-t;return n*n*n*e}function LNt(t,e){const n=1-t;return 3*n*n*t*e}function FNt(t,e){return 3*(1-t)*t*t*e}function jNt(t,e){return t*t*t*e}function T1(t,e,n,r,i){return $Nt(t,e)+LNt(t,n)+FNt(t,r)+jNt(t,i)}class DG extends nu{constructor(e=new Xe,n=new Xe,r=new Xe,i=new Xe){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new Xe){const r=n,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(T1(e,i.x,s.x,a.x,o.x),T1(e,i.y,s.y,a.y,o.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Eve extends nu{constructor(e=new ne,n=new ne,r=new ne,i=new ne){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=n,this.v2=r,this.v3=i}getPoint(e,n=new ne){const r=n,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return r.set(T1(e,i.x,s.x,a.x,o.x),T1(e,i.y,s.y,a.y,o.y),T1(e,i.z,s.z,a.z,o.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class $G extends nu{constructor(e=new Xe,n=new Xe){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=n}getPoint(e,n=new Xe){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new Xe){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Cve extends nu{constructor(e=new ne,n=new ne){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=n}getPoint(e,n=new ne){const r=n;return e===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(e).add(this.v1)),r}getPointAt(e,n){return this.getPoint(e,n)}getTangent(e,n=new ne){return n.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,n){return this.getTangent(e,n)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class LG extends nu{constructor(e=new Xe,n=new Xe,r=new Xe){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new Xe){const r=n,i=this.v0,s=this.v1,a=this.v2;return r.set(_1(e,i.x,s.x,a.x),_1(e,i.y,s.y,a.y)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class FG extends nu{constructor(e=new ne,n=new ne,r=new ne){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=n,this.v2=r}getPoint(e,n=new ne){const r=n,i=this.v0,s=this.v1,a=this.v2;return r.set(_1(e,i.x,s.x,a.x),_1(e,i.y,s.y,a.y),_1(e,i.z,s.z,a.z)),r}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class jG extends nu{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,n=new Xe){const r=n,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,l=i[a===0?a:a-1],c=i[a],u=i[a>i.length-2?i.length-1:a+1],d=i[a>i.length-3?i.length-1:a+2];return r.set(lee(o,l.x,c.x,u.x,d.x),lee(o,l.y,c.y,u.y,d.y)),r}copy(e){super.copy(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let n=0,r=this.points.length;n<r;n++){const i=this.points[n];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let n=0,r=e.points.length;n<r;n++){const i=e.points[n];this.points.push(new Xe().fromArray(i))}return this}}var xk=Object.freeze({__proto__:null,ArcCurve:_ve,CatmullRomCurve3:Tve,CubicBezierCurve:DG,CubicBezierCurve3:Eve,EllipseCurve:rO,LineCurve:$G,LineCurve3:Cve,QuadraticBezierCurve:LG,QuadraticBezierCurve3:FG,SplineCurve:jG});class Nve extends nu{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(n)){const r=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new xk[r](n,e))}return this}getPoint(e,n){const r=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=r){const a=i[s]-r,o=this.curves[s],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,n)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let n=0;for(let r=0,i=this.curves.length;r<i;r++)n+=this.curves[r].getLength(),e.push(n);return this.cacheLengths=e,e}getSpacedPoints(e=40){const n=[];for(let r=0;r<=e;r++)n.push(this.getPoint(r/e));return this.autoClose&&n.push(n[0]),n}getPoints(e=12){const n=[];let r;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const u=l[c];r&&r.equals(u)||(n.push(u),r=u)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(e){super.copy(e),this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let n=0,r=this.curves.length;n<r;n++){const i=this.curves[n];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let n=0,r=e.curves.length;n<r;n++){const i=e.curves[n];this.curves.push(new xk[i.type]().fromJSON(i))}return this}}class p_ extends Nve{constructor(e){super(),this.type="Path",this.currentPoint=new Xe,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let n=1,r=e.length;n<r;n++)this.lineTo(e[n].x,e[n].y);return this}moveTo(e,n){return this.currentPoint.set(e,n),this}lineTo(e,n){const r=new $G(this.currentPoint.clone(),new Xe(e,n));return this.curves.push(r),this.currentPoint.set(e,n),this}quadraticCurveTo(e,n,r,i){const s=new LG(this.currentPoint.clone(),new Xe(e,n),new Xe(r,i));return this.curves.push(s),this.currentPoint.set(r,i),this}bezierCurveTo(e,n,r,i,s,a){const o=new DG(this.currentPoint.clone(),new Xe(e,n),new Xe(r,i),new Xe(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const n=[this.currentPoint.clone()].concat(e),r=new jG(n);return this.curves.push(r),this.currentPoint.copy(e[e.length-1]),this}arc(e,n,r,i,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,n+l,r,i,s,a),this}absarc(e,n,r,i,s,a){return this.absellipse(e,n,r,r,i,s,a),this}ellipse(e,n,r,i,s,a,o,l){const c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,n+u,r,i,s,a,o,l),this}absellipse(e,n,r,i,s,a,o,l){const c=new rO(e,n,r,i,s,a,o,l);if(this.curves.length>0){const d=c.getPoint(0);d.equals(this.currentPoint)||this.lineTo(d.x,d.y)}this.curves.push(c);const u=c.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class vE extends Cn{constructor(e=[new Xe(0,-.5),new Xe(.5,0),new Xe(0,.5)],n=12,r=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:n,phiStart:r,phiLength:i},n=Math.floor(n),i=vi(i,0,Math.PI*2);const s=[],a=[],o=[],l=[],c=[],u=1/n,d=new ne,h=new Xe,f=new ne,p=new ne,g=new ne;let m=0,y=0;for(let x=0;x<=e.length-1;x++)switch(x){case 0:m=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,f.x=y*1,f.y=-m,f.z=y*0,g.copy(f),f.normalize(),l.push(f.x,f.y,f.z);break;case e.length-1:l.push(g.x,g.y,g.z);break;default:m=e[x+1].x-e[x].x,y=e[x+1].y-e[x].y,f.x=y*1,f.y=-m,f.z=y*0,p.copy(f),f.x+=g.x,f.y+=g.y,f.z+=g.z,f.normalize(),l.push(f.x,f.y,f.z),g.copy(p)}for(let x=0;x<=n;x++){const b=r+x*u*i,_=Math.sin(b),T=Math.cos(b);for(let E=0;E<=e.length-1;E++){d.x=e[E].x*_,d.y=e[E].y,d.z=e[E].x*T,a.push(d.x,d.y,d.z),h.x=x/n,h.y=E/(e.length-1),o.push(h.x,h.y);const C=l[3*E+0]*_,I=l[3*E+1],A=l[3*E+0]*T;c.push(C,I,A)}}for(let x=0;x<n;x++)for(let b=0;b<e.length-1;b++){const _=b+x*e.length,T=_,E=_+e.length,C=_+e.length+1,I=_+1;s.push(T,E,I),s.push(C,I,E)}this.setIndex(s),this.setAttribute("position",new Mt(a,3)),this.setAttribute("uv",new Mt(o,2)),this.setAttribute("normal",new Mt(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vE(e.points,e.segments,e.phiStart,e.phiLength)}}class iO extends vE{constructor(e=1,n=1,r=4,i=8){const s=new p_;s.absarc(0,-n/2,e,Math.PI*1.5,0),s.absarc(0,n/2,e,0,Math.PI*.5),super(s.getPoints(r),i),this.type="CapsuleGeometry",this.parameters={radius:e,length:n,capSegments:r,radialSegments:i}}static fromJSON(e){return new iO(e.radius,e.length,e.capSegments,e.radialSegments)}}class sO extends Cn{constructor(e=1,n=32,r=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:n,thetaStart:r,thetaLength:i},n=Math.max(3,n);const s=[],a=[],o=[],l=[],c=new ne,u=new Xe;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let d=0,h=3;d<=n;d++,h+=3){const f=r+d/n*i;c.x=e*Math.cos(f),c.y=e*Math.sin(f),a.push(c.x,c.y,c.z),o.push(0,0,1),u.x=(a[h]/e+1)/2,u.y=(a[h+1]/e+1)/2,l.push(u.x,u.y)}for(let d=1;d<=n;d++)s.push(d,d+1,0);this.setIndex(s),this.setAttribute("position",new Mt(a,3)),this.setAttribute("normal",new Mt(o,3)),this.setAttribute("uv",new Mt(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new sO(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class Cb extends Cn{constructor(e=1,n=1,r=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:n,height:r,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const u=[],d=[],h=[],f=[];let p=0;const g=[],m=r/2;let y=0;x(),a===!1&&(e>0&&b(!0),n>0&&b(!1)),this.setIndex(u),this.setAttribute("position",new Mt(d,3)),this.setAttribute("normal",new Mt(h,3)),this.setAttribute("uv",new Mt(f,2));function x(){const _=new ne,T=new ne;let E=0;const C=(n-e)/r;for(let I=0;I<=s;I++){const A=[],k=I/s,R=k*(n-e)+e;for(let $=0;$<=i;$++){const z=$/i,O=z*l+o,j=Math.sin(O),B=Math.cos(O);T.x=R*j,T.y=-k*r+m,T.z=R*B,d.push(T.x,T.y,T.z),_.set(j,C,B).normalize(),h.push(_.x,_.y,_.z),f.push(z,1-k),A.push(p++)}g.push(A)}for(let I=0;I<i;I++)for(let A=0;A<s;A++){const k=g[A][I],R=g[A+1][I],$=g[A+1][I+1],z=g[A][I+1];u.push(k,R,z),u.push(R,$,z),E+=6}c.addGroup(y,E,0),y+=E}function b(_){const T=p,E=new Xe,C=new ne;let I=0;const A=_===!0?e:n,k=_===!0?1:-1;for(let $=1;$<=i;$++)d.push(0,m*k,0),h.push(0,k,0),f.push(.5,.5),p++;const R=p;for(let $=0;$<=i;$++){const O=$/i*l+o,j=Math.cos(O),B=Math.sin(O);C.x=A*B,C.y=m*k,C.z=A*j,d.push(C.x,C.y,C.z),h.push(0,k,0),E.x=j*.5+.5,E.y=B*.5*k+.5,f.push(E.x,E.y),p++}for(let $=0;$<i;$++){const z=T+$,O=R+$;_===!0?u.push(O,O+1,z):u.push(O+1,O,z),I+=3}c.addGroup(y,I,_===!0?1:2),y+=I}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Cb(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class aO extends Cb{constructor(e=1,n=1,r=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,n,r,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:n,radialSegments:r,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new aO(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Rp extends Cn{constructor(e=[],n=[],r=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:n,radius:r,detail:i};const s=[],a=[];o(i),c(r),u(),this.setAttribute("position",new Mt(s,3)),this.setAttribute("normal",new Mt(s.slice(),3)),this.setAttribute("uv",new Mt(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(x){const b=new ne,_=new ne,T=new ne;for(let E=0;E<n.length;E+=3)f(n[E+0],b),f(n[E+1],_),f(n[E+2],T),l(b,_,T,x)}function l(x,b,_,T){const E=T+1,C=[];for(let I=0;I<=E;I++){C[I]=[];const A=x.clone().lerp(_,I/E),k=b.clone().lerp(_,I/E),R=E-I;for(let $=0;$<=R;$++)$===0&&I===E?C[I][$]=A:C[I][$]=A.clone().lerp(k,$/R)}for(let I=0;I<E;I++)for(let A=0;A<2*(E-I)-1;A++){const k=Math.floor(A/2);A%2===0?(h(C[I][k+1]),h(C[I+1][k]),h(C[I][k])):(h(C[I][k+1]),h(C[I+1][k+1]),h(C[I+1][k]))}}function c(x){const b=new ne;for(let _=0;_<s.length;_+=3)b.x=s[_+0],b.y=s[_+1],b.z=s[_+2],b.normalize().multiplyScalar(x),s[_+0]=b.x,s[_+1]=b.y,s[_+2]=b.z}function u(){const x=new ne;for(let b=0;b<s.length;b+=3){x.x=s[b+0],x.y=s[b+1],x.z=s[b+2];const _=m(x)/2/Math.PI+.5,T=y(x)/Math.PI+.5;a.push(_,1-T)}p(),d()}function d(){for(let x=0;x<a.length;x+=6){const b=a[x+0],_=a[x+2],T=a[x+4],E=Math.max(b,_,T),C=Math.min(b,_,T);E>.9&&C<.1&&(b<.2&&(a[x+0]+=1),_<.2&&(a[x+2]+=1),T<.2&&(a[x+4]+=1))}}function h(x){s.push(x.x,x.y,x.z)}function f(x,b){const _=x*3;b.x=e[_+0],b.y=e[_+1],b.z=e[_+2]}function p(){const x=new ne,b=new ne,_=new ne,T=new ne,E=new Xe,C=new Xe,I=new Xe;for(let A=0,k=0;A<s.length;A+=9,k+=6){x.set(s[A+0],s[A+1],s[A+2]),b.set(s[A+3],s[A+4],s[A+5]),_.set(s[A+6],s[A+7],s[A+8]),E.set(a[k+0],a[k+1]),C.set(a[k+2],a[k+3]),I.set(a[k+4],a[k+5]),T.copy(x).add(b).add(_).divideScalar(3);const R=m(T);g(E,k+0,x,R),g(C,k+2,b,R),g(I,k+4,_,R)}}function g(x,b,_,T){T<0&&x.x===1&&(a[b]=x.x-1),_.x===0&&_.z===0&&(a[b]=T/2/Math.PI+.5)}function m(x){return Math.atan2(x.z,-x.x)}function y(x){return Math.atan2(-x.y,Math.sqrt(x.x*x.x+x.z*x.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Rp(e.vertices,e.indices,e.radius,e.details)}}class oO extends Rp{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,i=1/r,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-r,0,-i,r,0,i,-r,0,i,r,-i,-r,0,-i,r,0,i,-r,0,i,r,0,-r,0,-i,r,0,-i,-r,0,i,r,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,n),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new oO(e.radius,e.detail)}}const i2=new ne,s2=new ne,o3=new ne,a2=new oo;class Ave extends Cn{constructor(e=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:n},e!==null){const i=Math.pow(10,4),s=Math.cos(eg*n),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],u=["a","b","c"],d=new Array(3),h={},f=[];for(let p=0;p<l;p+=3){a?(c[0]=a.getX(p),c[1]=a.getX(p+1),c[2]=a.getX(p+2)):(c[0]=p,c[1]=p+1,c[2]=p+2);const{a:g,b:m,c:y}=a2;if(g.fromBufferAttribute(o,c[0]),m.fromBufferAttribute(o,c[1]),y.fromBufferAttribute(o,c[2]),a2.getNormal(o3),d[0]=`${Math.round(g.x*i)},${Math.round(g.y*i)},${Math.round(g.z*i)}`,d[1]=`${Math.round(m.x*i)},${Math.round(m.y*i)},${Math.round(m.z*i)}`,d[2]=`${Math.round(y.x*i)},${Math.round(y.y*i)},${Math.round(y.z*i)}`,!(d[0]===d[1]||d[1]===d[2]||d[2]===d[0]))for(let x=0;x<3;x++){const b=(x+1)%3,_=d[x],T=d[b],E=a2[u[x]],C=a2[u[b]],I=`${_}_${T}`,A=`${T}_${_}`;A in h&&h[A]?(o3.dot(h[A].normal)<=s&&(f.push(E.x,E.y,E.z),f.push(C.x,C.y,C.z)),h[A]=null):I in h||(h[I]={index0:c[x],index1:c[b],normal:o3.clone()})}}for(const p in h)if(h[p]){const{index0:g,index1:m}=h[p];i2.fromBufferAttribute(o,g),s2.fromBufferAttribute(o,m),f.push(i2.x,i2.y,i2.z),f.push(s2.x,s2.y,s2.z)}this.setAttribute("position",new Mt(f,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class rg extends p_{constructor(e){super(e),this.uuid=Zo(),this.type="Shape",this.holes=[]}getPointsHoles(e){const n=[];for(let r=0,i=this.holes.length;r<i;r++)n[r]=this.holes[r].getPoints(e);return n}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const i=e.holes[n];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let n=0,r=this.holes.length;n<r;n++){const i=this.holes[n];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let n=0,r=e.holes.length;n<r;n++){const i=e.holes[n];this.holes.push(new p_().fromJSON(i))}return this}}const zNt={triangulate:function(t,e,n=2){const r=e&&e.length,i=r?e[0]*n:t.length;let s=Ive(t,0,i,n,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c,u,d,h,f;if(r&&(s=HNt(t,e,s,n)),t.length>80*n){o=c=t[0],l=u=t[1];for(let p=n;p<i;p+=n)d=t[p],h=t[p+1],d<o&&(o=d),h<l&&(l=h),d>c&&(c=d),h>u&&(u=h);f=Math.max(c-o,u-l),f=f!==0?32767/f:0}return m_(s,a,n,o,l,f,0),a}};function Ive(t,e,n,r,i){let s,a;if(i===n2t(t,e,n,r)>0)for(s=e;s<n;s+=r)a=cee(s,t[s],t[s+1],a);else for(s=n-r;s>=e;s-=r)a=cee(s,t[s],t[s+1],a);return a&&lO(a,a.next)&&(y_(a),a=a.next),a}function Ug(t,e){if(!t)return t;e||(e=t);let n=t,r;do if(r=!1,!n.steiner&&(lO(n,n.next)||ai(n.prev,n,n.next)===0)){if(y_(n),n=e=n.prev,n===n.next)break;r=!0}else n=n.next;while(r||n!==e);return e}function m_(t,e,n,r,i,s,a){if(!t)return;!a&&s&&YNt(t,r,i,s);let o=t,l,c;for(;t.prev!==t.next;){if(l=t.prev,c=t.next,s?UNt(t,r,i,s):BNt(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(c.i/n|0),y_(t),t=c.next,o=c.next;continue}if(t=c,t===o){a?a===1?(t=VNt(Ug(t),e,n),m_(t,e,n,r,i,s,2)):a===2&&WNt(t,e,n,r,i,s):m_(Ug(t),e,n,r,i,s,1);break}}}function BNt(t){const e=t.prev,n=t,r=t.next;if(ai(e,n,r)>=0)return!1;const i=e.x,s=n.x,a=r.x,o=e.y,l=n.y,c=r.y,u=i<s?i<a?i:a:s<a?s:a,d=o<l?o<c?o:c:l<c?l:c,h=i>s?i>a?i:a:s>a?s:a,f=o>l?o>c?o:c:l>c?l:c;let p=r.next;for(;p!==e;){if(p.x>=u&&p.x<=h&&p.y>=d&&p.y<=f&&Vv(i,o,s,l,a,c,p.x,p.y)&&ai(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function UNt(t,e,n,r){const i=t.prev,s=t,a=t.next;if(ai(i,s,a)>=0)return!1;const o=i.x,l=s.x,c=a.x,u=i.y,d=s.y,h=a.y,f=o<l?o<c?o:c:l<c?l:c,p=u<d?u<h?u:h:d<h?d:h,g=o>l?o>c?o:c:l>c?l:c,m=u>d?u>h?u:h:d>h?d:h,y=Z4(f,p,e,n,r),x=Z4(g,m,e,n,r);let b=t.prevZ,_=t.nextZ;for(;b&&b.z>=y&&_&&_.z<=x;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==i&&b!==a&&Vv(o,u,l,d,c,h,b.x,b.y)&&ai(b.prev,b,b.next)>=0||(b=b.prevZ,_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==i&&_!==a&&Vv(o,u,l,d,c,h,_.x,_.y)&&ai(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;b&&b.z>=y;){if(b.x>=f&&b.x<=g&&b.y>=p&&b.y<=m&&b!==i&&b!==a&&Vv(o,u,l,d,c,h,b.x,b.y)&&ai(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;_&&_.z<=x;){if(_.x>=f&&_.x<=g&&_.y>=p&&_.y<=m&&_!==i&&_!==a&&Vv(o,u,l,d,c,h,_.x,_.y)&&ai(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function VNt(t,e,n){let r=t;do{const i=r.prev,s=r.next.next;!lO(i,s)&&kve(i,r,r.next,s)&&g_(i,s)&&g_(s,i)&&(e.push(i.i/n|0),e.push(r.i/n|0),e.push(s.i/n|0),y_(r),y_(r.next),r=t=s),r=r.next}while(r!==t);return Ug(r)}function WNt(t,e,n,r,i,s){let a=t;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&JNt(a,o)){let l=Mve(a,o);a=Ug(a,a.next),l=Ug(l,l.next),m_(a,e,n,r,i,s,0),m_(l,e,n,r,i,s,0);return}o=o.next}a=a.next}while(a!==t)}function HNt(t,e,n,r){const i=[];let s,a,o,l,c;for(s=0,a=e.length;s<a;s++)o=e[s]*r,l=s<a-1?e[s+1]*r:t.length,c=Ive(t,o,l,r,!1),c===c.next&&(c.steiner=!0),i.push(QNt(c));for(i.sort(GNt),s=0;s<i.length;s++)n=qNt(i[s],n);return n}function GNt(t,e){return t.x-e.x}function qNt(t,e){const n=XNt(t,e);if(!n)return e;const r=Mve(n,t);return Ug(r,r.next),Ug(n,n.next)}function XNt(t,e){let n=e,r=-1/0,i;const s=t.x,a=t.y;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){const h=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=s&&h>r&&(r=h,i=n.x<n.next.x?n:n.next,h===s))return i}n=n.next}while(n!==e);if(!i)return null;const o=i,l=i.x,c=i.y;let u=1/0,d;n=i;do s>=n.x&&n.x>=l&&s!==n.x&&Vv(a<c?s:r,a,l,c,a<c?r:s,a,n.x,n.y)&&(d=Math.abs(a-n.y)/(s-n.x),g_(n,t)&&(d<u||d===u&&(n.x>i.x||n.x===i.x&&KNt(i,n)))&&(i=n,u=d)),n=n.next;while(n!==o);return i}function KNt(t,e){return ai(t.prev,t,e.prev)<0&&ai(e.next,t,t.next)<0}function YNt(t,e,n,r){let i=t;do i.z===0&&(i.z=Z4(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,ZNt(i)}function ZNt(t){let e,n,r,i,s,a,o,l,c=1;do{for(n=t,t=null,s=null,a=0;n;){for(a++,r=n,o=0,e=0;e<c&&(o++,r=r.nextZ,!!r);e++);for(l=c;o>0||l>0&&r;)o!==0&&(l===0||!r||n.z<=r.z)?(i=n,n=n.nextZ,o--):(i=r,r=r.nextZ,l--),s?s.nextZ=i:t=i,i.prevZ=s,s=i;n=r}s.nextZ=null,c*=2}while(a>1);return t}function Z4(t,e,n,r,i){return t=(t-n)*i|0,e=(e-r)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function QNt(t){let e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Vv(t,e,n,r,i,s,a,o){return(i-a)*(e-o)>=(t-a)*(s-o)&&(t-a)*(r-o)>=(n-a)*(e-o)&&(n-a)*(s-o)>=(i-a)*(r-o)}function JNt(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!e2t(t,e)&&(g_(t,e)&&g_(e,t)&&t2t(t,e)&&(ai(t.prev,t,e.prev)||ai(t,e.prev,e))||lO(t,e)&&ai(t.prev,t,t.next)>0&&ai(e.prev,e,e.next)>0)}function ai(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function lO(t,e){return t.x===e.x&&t.y===e.y}function kve(t,e,n,r){const i=l2(ai(t,e,n)),s=l2(ai(t,e,r)),a=l2(ai(n,r,t)),o=l2(ai(n,r,e));return!!(i!==s&&a!==o||i===0&&o2(t,n,e)||s===0&&o2(t,r,e)||a===0&&o2(n,t,r)||o===0&&o2(n,e,r))}function o2(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function l2(t){return t>0?1:t<0?-1:0}function e2t(t,e){let n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&kve(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function g_(t,e){return ai(t.prev,t,t.next)<0?ai(t,e,t.next)>=0&&ai(t,t.prev,e)>=0:ai(t,e,t.prev)<0||ai(t,t.next,e)<0}function t2t(t,e){let n=t,r=!1;const i=(t.x+e.x)/2,s=(t.y+e.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next;while(n!==t);return r}function Mve(t,e){const n=new Q4(t.i,t.x,t.y),r=new Q4(e.i,e.x,e.y),i=t.next,s=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function cee(t,e,n,r){const i=new Q4(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function y_(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Q4(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function n2t(t,e,n,r){let i=0;for(let s=e,a=n-r;s<n;s+=r)i+=(t[a]-t[s])*(t[s+1]+t[a+1]),a=s;return i}class Uu{static area(e){const n=e.length;let r=0;for(let i=n-1,s=0;s<n;i=s++)r+=e[i].x*e[s].y-e[s].x*e[i].y;return r*.5}static isClockWise(e){return Uu.area(e)<0}static triangulateShape(e,n){const r=[],i=[],s=[];uee(e),dee(r,e);let a=e.length;n.forEach(uee);for(let l=0;l<n.length;l++)i.push(a),a+=n[l].length,dee(r,n[l]);const o=zNt.triangulate(r,i);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function uee(t){const e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function dee(t,e){for(let n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}class cO extends Cn{constructor(e=new rg([new Xe(.5,.5),new Xe(-.5,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:n},e=Array.isArray(e)?e:[e];const r=this,i=[],s=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new Mt(i,3)),this.setAttribute("uv",new Mt(s,2)),this.computeVertexNormals();function a(o){const l=[],c=n.curveSegments!==void 0?n.curveSegments:12,u=n.steps!==void 0?n.steps:1,d=n.depth!==void 0?n.depth:1;let h=n.bevelEnabled!==void 0?n.bevelEnabled:!0,f=n.bevelThickness!==void 0?n.bevelThickness:.2,p=n.bevelSize!==void 0?n.bevelSize:f-.1,g=n.bevelOffset!==void 0?n.bevelOffset:0,m=n.bevelSegments!==void 0?n.bevelSegments:3;const y=n.extrudePath,x=n.UVGenerator!==void 0?n.UVGenerator:r2t;let b,_=!1,T,E,C,I;y&&(b=y.getSpacedPoints(u),_=!0,h=!1,T=y.computeFrenetFrames(u,!1),E=new ne,C=new ne,I=new ne),h||(m=0,f=0,p=0,g=0);const A=o.extractPoints(c);let k=A.shape;const R=A.holes;if(!Uu.isClockWise(k)){k=k.reverse();for(let G=0,ke=R.length;G<ke;G++){const xe=R[G];Uu.isClockWise(xe)&&(R[G]=xe.reverse())}}const z=Uu.triangulateShape(k,R),O=k;for(let G=0,ke=R.length;G<ke;G++){const xe=R[G];k=k.concat(xe)}function j(G,ke,xe){return ke||console.error("THREE.ExtrudeGeometry: vec does not exist"),G.clone().addScaledVector(ke,xe)}const B=k.length,W=z.length;function L(G,ke,xe){let Pe,Te,Ye;const qe=G.x-ke.x,Q=G.y-ke.y,X=xe.x-G.x,we=xe.y-G.y,Z=qe*qe+Q*Q,ie=qe*we-Q*X;if(Math.abs(ie)>Number.EPSILON){const ae=Math.sqrt(Z),Le=Math.sqrt(X*X+we*we),Ae=ke.x-Q/ae,Ie=ke.y+qe/ae,Ge=xe.x-we/Le,rt=xe.y+X/Le,We=((Ge-Ae)*we-(rt-Ie)*X)/(qe*we-Q*X);Pe=Ae+qe*We-G.x,Te=Ie+Q*We-G.y;const Ut=Pe*Pe+Te*Te;if(Ut<=2)return new Xe(Pe,Te);Ye=Math.sqrt(Ut/2)}else{let ae=!1;qe>Number.EPSILON?X>Number.EPSILON&&(ae=!0):qe<-Number.EPSILON?X<-Number.EPSILON&&(ae=!0):Math.sign(Q)===Math.sign(we)&&(ae=!0),ae?(Pe=-Q,Te=qe,Ye=Math.sqrt(Z)):(Pe=qe,Te=Q,Ye=Math.sqrt(Z/2))}return new Xe(Pe/Ye,Te/Ye)}const V=[];for(let G=0,ke=O.length,xe=ke-1,Pe=G+1;G<ke;G++,xe++,Pe++)xe===ke&&(xe=0),Pe===ke&&(Pe=0),V[G]=L(O[G],O[xe],O[Pe]);const H=[];let K,te=V.concat();for(let G=0,ke=R.length;G<ke;G++){const xe=R[G];K=[];for(let Pe=0,Te=xe.length,Ye=Te-1,qe=Pe+1;Pe<Te;Pe++,Ye++,qe++)Ye===Te&&(Ye=0),qe===Te&&(qe=0),K[Pe]=L(xe[Pe],xe[Ye],xe[qe]);H.push(K),te=te.concat(K)}for(let G=0;G<m;G++){const ke=G/m,xe=f*Math.cos(ke*Math.PI/2),Pe=p*Math.sin(ke*Math.PI/2)+g;for(let Te=0,Ye=O.length;Te<Ye;Te++){const qe=j(O[Te],V[Te],Pe);me(qe.x,qe.y,-xe)}for(let Te=0,Ye=R.length;Te<Ye;Te++){const qe=R[Te];K=H[Te];for(let Q=0,X=qe.length;Q<X;Q++){const we=j(qe[Q],K[Q],Pe);me(we.x,we.y,-xe)}}}const J=p+g;for(let G=0;G<B;G++){const ke=h?j(k[G],te[G],J):k[G];_?(C.copy(T.normals[0]).multiplyScalar(ke.x),E.copy(T.binormals[0]).multiplyScalar(ke.y),I.copy(b[0]).add(C).add(E),me(I.x,I.y,I.z)):me(ke.x,ke.y,0)}for(let G=1;G<=u;G++)for(let ke=0;ke<B;ke++){const xe=h?j(k[ke],te[ke],J):k[ke];_?(C.copy(T.normals[G]).multiplyScalar(xe.x),E.copy(T.binormals[G]).multiplyScalar(xe.y),I.copy(b[G]).add(C).add(E),me(I.x,I.y,I.z)):me(xe.x,xe.y,d/u*G)}for(let G=m-1;G>=0;G--){const ke=G/m,xe=f*Math.cos(ke*Math.PI/2),Pe=p*Math.sin(ke*Math.PI/2)+g;for(let Te=0,Ye=O.length;Te<Ye;Te++){const qe=j(O[Te],V[Te],Pe);me(qe.x,qe.y,d+xe)}for(let Te=0,Ye=R.length;Te<Ye;Te++){const qe=R[Te];K=H[Te];for(let Q=0,X=qe.length;Q<X;Q++){const we=j(qe[Q],K[Q],Pe);_?me(we.x,we.y+b[u-1].y,b[u-1].x+xe):me(we.x,we.y,d+xe)}}}oe(),fe();function oe(){const G=i.length/3;if(h){let ke=0,xe=B*ke;for(let Pe=0;Pe<W;Pe++){const Te=z[Pe];De(Te[2]+xe,Te[1]+xe,Te[0]+xe)}ke=u+m*2,xe=B*ke;for(let Pe=0;Pe<W;Pe++){const Te=z[Pe];De(Te[0]+xe,Te[1]+xe,Te[2]+xe)}}else{for(let ke=0;ke<W;ke++){const xe=z[ke];De(xe[2],xe[1],xe[0])}for(let ke=0;ke<W;ke++){const xe=z[ke];De(xe[0]+B*u,xe[1]+B*u,xe[2]+B*u)}}r.addGroup(G,i.length/3-G,0)}function fe(){const G=i.length/3;let ke=0;Ee(O,ke),ke+=O.length;for(let xe=0,Pe=R.length;xe<Pe;xe++){const Te=R[xe];Ee(Te,ke),ke+=Te.length}r.addGroup(G,i.length/3-G,1)}function Ee(G,ke){let xe=G.length;for(;--xe>=0;){const Pe=xe;let Te=xe-1;Te<0&&(Te=G.length-1);for(let Ye=0,qe=u+m*2;Ye<qe;Ye++){const Q=B*Ye,X=B*(Ye+1),we=ke+Pe+Q,Z=ke+Te+Q,ie=ke+Te+X,ae=ke+Pe+X;ge(we,Z,ie,ae)}}}function me(G,ke,xe){l.push(G),l.push(ke),l.push(xe)}function De(G,ke,xe){_e(G),_e(ke),_e(xe);const Pe=i.length/3,Te=x.generateTopUV(r,i,Pe-3,Pe-2,Pe-1);Ce(Te[0]),Ce(Te[1]),Ce(Te[2])}function ge(G,ke,xe,Pe){_e(G),_e(ke),_e(Pe),_e(ke),_e(xe),_e(Pe);const Te=i.length/3,Ye=x.generateSideWallUV(r,i,Te-6,Te-3,Te-2,Te-1);Ce(Ye[0]),Ce(Ye[1]),Ce(Ye[3]),Ce(Ye[1]),Ce(Ye[2]),Ce(Ye[3])}function _e(G){i.push(l[G*3+0]),i.push(l[G*3+1]),i.push(l[G*3+2])}function Ce(G){s.push(G.x),s.push(G.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes,r=this.parameters.options;return i2t(n,r,e)}static fromJSON(e,n){const r=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=n[e.shapes[s]];r.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new xk[i.type]().fromJSON(i)),new cO(r,e.options)}}const r2t={generateTopUV:function(t,e,n,r,i){const s=e[n*3],a=e[n*3+1],o=e[r*3],l=e[r*3+1],c=e[i*3],u=e[i*3+1];return[new Xe(s,a),new Xe(o,l),new Xe(c,u)]},generateSideWallUV:function(t,e,n,r,i,s){const a=e[n*3],o=e[n*3+1],l=e[n*3+2],c=e[r*3],u=e[r*3+1],d=e[r*3+2],h=e[i*3],f=e[i*3+1],p=e[i*3+2],g=e[s*3],m=e[s*3+1],y=e[s*3+2];return Math.abs(o-u)<Math.abs(a-c)?[new Xe(a,1-l),new Xe(c,1-d),new Xe(h,1-p),new Xe(g,1-y)]:[new Xe(o,1-l),new Xe(u,1-d),new Xe(f,1-p),new Xe(m,1-y)]}};function i2t(t,e,n){if(n.shapes=[],Array.isArray(t))for(let r=0,i=t.length;r<i;r++){const s=t[r];n.shapes.push(s.uuid)}else n.shapes.push(t.uuid);return n.options=Object.assign({},e),e.extrudePath!==void 0&&(n.options.extrudePath=e.extrudePath.toJSON()),n}class uO extends Rp{constructor(e=1,n=0){const r=(1+Math.sqrt(5))/2,i=[-1,r,0,1,r,0,-1,-r,0,1,-r,0,0,-1,r,0,1,r,0,-1,-r,0,1,-r,r,0,-1,r,0,1,-r,0,-1,-r,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,n),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new uO(e.radius,e.detail)}}class xE extends Rp{constructor(e=1,n=0){const r=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(r,i,e,n),this.type="OctahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new xE(e.radius,e.detail)}}class dO extends Cn{constructor(e=.5,n=1,r=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:n,thetaSegments:r,phiSegments:i,thetaStart:s,thetaLength:a},r=Math.max(3,r),i=Math.max(1,i);const o=[],l=[],c=[],u=[];let d=e;const h=(n-e)/i,f=new ne,p=new Xe;for(let g=0;g<=i;g++){for(let m=0;m<=r;m++){const y=s+m/r*a;f.x=d*Math.cos(y),f.y=d*Math.sin(y),l.push(f.x,f.y,f.z),c.push(0,0,1),p.x=(f.x/n+1)/2,p.y=(f.y/n+1)/2,u.push(p.x,p.y)}d+=h}for(let g=0;g<i;g++){const m=g*(r+1);for(let y=0;y<r;y++){const x=y+m,b=x,_=x+r+1,T=x+r+2,E=x+1;o.push(b,_,E),o.push(_,T,E)}}this.setIndex(o),this.setAttribute("position",new Mt(l,3)),this.setAttribute("normal",new Mt(c,3)),this.setAttribute("uv",new Mt(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new dO(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class hO extends Cn{constructor(e=new rg([new Xe(0,.5),new Xe(-.5,-.5),new Xe(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:n};const r=[],i=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let u=0;u<e.length;u++)c(e[u]),this.addGroup(o,l,u),o+=l,l=0;this.setIndex(r),this.setAttribute("position",new Mt(i,3)),this.setAttribute("normal",new Mt(s,3)),this.setAttribute("uv",new Mt(a,2));function c(u){const d=i.length/3,h=u.extractPoints(n);let f=h.shape;const p=h.holes;Uu.isClockWise(f)===!1&&(f=f.reverse());for(let m=0,y=p.length;m<y;m++){const x=p[m];Uu.isClockWise(x)===!0&&(p[m]=x.reverse())}const g=Uu.triangulateShape(f,p);for(let m=0,y=p.length;m<y;m++){const x=p[m];f=f.concat(x)}for(let m=0,y=f.length;m<y;m++){const x=f[m];i.push(x.x,x.y,0),s.push(0,0,1),a.push(x.x,x.y)}for(let m=0,y=g.length;m<y;m++){const x=g[m],b=x[0]+d,_=x[1]+d,T=x[2]+d;r.push(b,_,T),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),n=this.parameters.shapes;return s2t(n,e)}static fromJSON(e,n){const r=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=n[e.shapes[i]];r.push(a)}return new hO(r,e.curveSegments)}}function s2t(t,e){if(e.shapes=[],Array.isArray(t))for(let n=0,r=t.length;n<r;n++){const i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}class bE extends Cn{constructor(e=1,n=32,r=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:n,heightSegments:r,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},n=Math.max(3,Math.floor(n)),r=Math.max(2,Math.floor(r));const l=Math.min(a+o,Math.PI);let c=0;const u=[],d=new ne,h=new ne,f=[],p=[],g=[],m=[];for(let y=0;y<=r;y++){const x=[],b=y/r;let _=0;y===0&&a===0?_=.5/n:y===r&&l===Math.PI&&(_=-.5/n);for(let T=0;T<=n;T++){const E=T/n;d.x=-e*Math.cos(i+E*s)*Math.sin(a+b*o),d.y=e*Math.cos(a+b*o),d.z=e*Math.sin(i+E*s)*Math.sin(a+b*o),p.push(d.x,d.y,d.z),h.copy(d).normalize(),g.push(h.x,h.y,h.z),m.push(E+_,1-b),x.push(c++)}u.push(x)}for(let y=0;y<r;y++)for(let x=0;x<n;x++){const b=u[y][x+1],_=u[y][x],T=u[y+1][x],E=u[y+1][x+1];(y!==0||a>0)&&f.push(b,_,E),(y!==r-1||l<Math.PI)&&f.push(_,T,E)}this.setIndex(f),this.setAttribute("position",new Mt(p,3)),this.setAttribute("normal",new Mt(g,3)),this.setAttribute("uv",new Mt(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new bE(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class fO extends Rp{constructor(e=1,n=0){const r=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(r,i,e,n),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:n}}static fromJSON(e){return new fO(e.radius,e.detail)}}class pO extends Cn{constructor(e=1,n=.4,r=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:n,radialSegments:r,tubularSegments:i,arc:s},r=Math.floor(r),i=Math.floor(i);const a=[],o=[],l=[],c=[],u=new ne,d=new ne,h=new ne;for(let f=0;f<=r;f++)for(let p=0;p<=i;p++){const g=p/i*s,m=f/r*Math.PI*2;d.x=(e+n*Math.cos(m))*Math.cos(g),d.y=(e+n*Math.cos(m))*Math.sin(g),d.z=n*Math.sin(m),o.push(d.x,d.y,d.z),u.x=e*Math.cos(g),u.y=e*Math.sin(g),h.subVectors(d,u).normalize(),l.push(h.x,h.y,h.z),c.push(p/i),c.push(f/r)}for(let f=1;f<=r;f++)for(let p=1;p<=i;p++){const g=(i+1)*f+p-1,m=(i+1)*(f-1)+p-1,y=(i+1)*(f-1)+p,x=(i+1)*f+p;a.push(g,m,x),a.push(m,y,x)}this.setIndex(a),this.setAttribute("position",new Mt(o,3)),this.setAttribute("normal",new Mt(l,3)),this.setAttribute("uv",new Mt(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new pO(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class mO extends Cn{constructor(e=1,n=.4,r=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:n,tubularSegments:r,radialSegments:i,p:s,q:a},r=Math.floor(r),i=Math.floor(i);const o=[],l=[],c=[],u=[],d=new ne,h=new ne,f=new ne,p=new ne,g=new ne,m=new ne,y=new ne;for(let b=0;b<=r;++b){const _=b/r*s*Math.PI*2;x(_,s,a,e,f),x(_+.01,s,a,e,p),m.subVectors(p,f),y.addVectors(p,f),g.crossVectors(m,y),y.crossVectors(g,m),g.normalize(),y.normalize();for(let T=0;T<=i;++T){const E=T/i*Math.PI*2,C=-n*Math.cos(E),I=n*Math.sin(E);d.x=f.x+(C*y.x+I*g.x),d.y=f.y+(C*y.y+I*g.y),d.z=f.z+(C*y.z+I*g.z),l.push(d.x,d.y,d.z),h.subVectors(d,f).normalize(),c.push(h.x,h.y,h.z),u.push(b/r),u.push(T/i)}}for(let b=1;b<=r;b++)for(let _=1;_<=i;_++){const T=(i+1)*(b-1)+(_-1),E=(i+1)*b+(_-1),C=(i+1)*b+_,I=(i+1)*(b-1)+_;o.push(T,E,I),o.push(E,C,I)}this.setIndex(o),this.setAttribute("position",new Mt(l,3)),this.setAttribute("normal",new Mt(c,3)),this.setAttribute("uv",new Mt(u,2));function x(b,_,T,E,C){const I=Math.cos(b),A=Math.sin(b),k=T/_*b,R=Math.cos(k);C.x=E*(2+R)*.5*I,C.y=E*(2+R)*A*.5,C.z=E*Math.sin(k)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new mO(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class gO extends Cn{constructor(e=new FG(new ne(-1,-1,0),new ne(-1,1,0),new ne(1,1,0)),n=64,r=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:n,radius:r,radialSegments:i,closed:s};const a=e.computeFrenetFrames(n,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new ne,l=new ne,c=new Xe;let u=new ne;const d=[],h=[],f=[],p=[];g(),this.setIndex(p),this.setAttribute("position",new Mt(d,3)),this.setAttribute("normal",new Mt(h,3)),this.setAttribute("uv",new Mt(f,2));function g(){for(let b=0;b<n;b++)m(b);m(s===!1?n:0),x(),y()}function m(b){u=e.getPointAt(b/n,u);const _=a.normals[b],T=a.binormals[b];for(let E=0;E<=i;E++){const C=E/i*Math.PI*2,I=Math.sin(C),A=-Math.cos(C);l.x=A*_.x+I*T.x,l.y=A*_.y+I*T.y,l.z=A*_.z+I*T.z,l.normalize(),h.push(l.x,l.y,l.z),o.x=u.x+r*l.x,o.y=u.y+r*l.y,o.z=u.z+r*l.z,d.push(o.x,o.y,o.z)}}function y(){for(let b=1;b<=n;b++)for(let _=1;_<=i;_++){const T=(i+1)*(b-1)+(_-1),E=(i+1)*b+(_-1),C=(i+1)*b+_,I=(i+1)*(b-1)+_;p.push(T,E,I),p.push(E,C,I)}}function x(){for(let b=0;b<=n;b++)for(let _=0;_<=i;_++)c.x=b/n,c.y=_/i,f.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new gO(new xk[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class Rve extends Cn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const n=[],r=new Set,i=new ne,s=new ne;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,u=l.length;c<u;++c){const d=l[c],h=d.start,f=d.count;for(let p=h,g=h+f;p<g;p+=3)for(let m=0;m<3;m++){const y=o.getX(p+m),x=o.getX(p+(m+1)%3);i.fromBufferAttribute(a,y),s.fromBufferAttribute(a,x),hee(i,s,r)===!0&&(n.push(i.x,i.y,i.z),n.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const u=3*o+c,d=3*o+(c+1)%3;i.fromBufferAttribute(a,u),s.fromBufferAttribute(a,d),hee(i,s,r)===!0&&(n.push(i.x,i.y,i.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new Mt(n,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function hee(t,e,n){const r=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`;return n.has(r)===!0||n.has(i)===!0?!1:(n.add(r),n.add(i),!0)}var fee=Object.freeze({__proto__:null,BoxGeometry:ly,CapsuleGeometry:iO,CircleGeometry:sO,ConeGeometry:aO,CylinderGeometry:Cb,DodecahedronGeometry:oO,EdgesGeometry:Ave,ExtrudeGeometry:cO,IcosahedronGeometry:uO,LatheGeometry:vE,OctahedronGeometry:xE,PlaneGeometry:gE,PolyhedronGeometry:Rp,RingGeometry:dO,ShapeGeometry:hO,SphereGeometry:bE,TetrahedronGeometry:fO,TorusGeometry:pO,TorusKnotGeometry:mO,TubeGeometry:gO,WireframeGeometry:Rve});class Pve extends _a{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new xt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class Ove extends Ju{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class zG extends _a{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new xt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Dve extends zG{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Xe(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return vi(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new xt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new xt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new xt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class $ve extends _a{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new xt(16777215),this.specular=new xt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Lve extends _a{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new xt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class Fve extends _a{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class jve extends _a{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new xt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new xt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=uE,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class zve extends _a{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new xt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=kp,this.normalScale=new Xe(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class Bve extends Ya{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function Fm(t,e,n){return!t||!n&&t.constructor===e?t:typeof e.BYTES_PER_ELEMENT=="number"?new e(t):Array.prototype.slice.call(t)}function Uve(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Vve(t){function e(i,s){return t[i]-t[s]}const n=t.length,r=new Array(n);for(let i=0;i!==n;++i)r[i]=i;return r.sort(e),r}function J4(t,e,n){const r=t.length,i=new t.constructor(r);for(let s=0,a=0;a!==r;++s){const o=n[s]*e;for(let l=0;l!==e;++l)i[a++]=t[o+l]}return i}function BG(t,e,n,r){let i=1,s=t[0];for(;s!==void 0&&s[r]===void 0;)s=t[i++];if(s===void 0)return;let a=s[r];if(a!==void 0)if(Array.isArray(a))do a=s[r],a!==void 0&&(e.push(s.time),n.push.apply(n,a)),s=t[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[r],a!==void 0&&(e.push(s.time),a.toArray(n,n.length)),s=t[i++];while(s!==void 0);else do a=s[r],a!==void 0&&(e.push(s.time),n.push(a)),s=t[i++];while(s!==void 0)}function a2t(t,e,n,r,i=30){const s=t.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],u=c.getValueSize(),d=[],h=[];for(let f=0;f<c.times.length;++f){const p=c.times[f]*i;if(!(p<n||p>=r)){d.push(c.times[f]);for(let g=0;g<u;++g)h.push(c.values[f*u+g])}}d.length!==0&&(c.times=Fm(d,c.times.constructor),c.values=Fm(h,c.values.constructor),a.push(c))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function o2t(t,e=0,n=t,r=30){r<=0&&(r=30);const i=n.tracks.length,s=e/r;for(let a=0;a<i;++a){const o=n.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=t.tracks.find(function(y){return y.name===o.name&&y.ValueTypeName===l});if(c===void 0)continue;let u=0;const d=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=d/3);let h=0;const f=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=f/3);const p=o.times.length-1;let g;if(s<=o.times[0]){const y=u,x=d-u;g=o.values.slice(y,x)}else if(s>=o.times[p]){const y=p*d+u,x=y+d-u;g=o.values.slice(y,x)}else{const y=o.createInterpolant(),x=u,b=d-u;y.evaluate(s),g=y.resultBuffer.slice(x,b)}l==="quaternion"&&new xo().fromArray(g).normalize().conjugate().toArray(g);const m=c.times.length;for(let y=0;y<m;++y){const x=y*f+h;if(l==="quaternion")xo.multiplyQuaternionsFlat(c.values,x,g,0,c.values,x);else{const b=f-h*2;for(let _=0;_<b;++_)c.values[x+_]-=g[_]}}}return t.blendMode=yG,t}const l2t={convertArray:Fm,isTypedArray:Uve,getKeyframeOrder:Vve,sortedArray:J4,flattenJSON:BG,subclip:a2t,makeClipAdditive:o2t};class wE{constructor(e,n,r,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){const n=this.parameterPositions;let r=this._cachedIndex,i=n[r],s=n[r-1];e:{t:{let a;n:{r:if(!(e<i)){for(let o=r+2;;){if(i===void 0){if(e<s)break r;return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===o)break;if(s=i,i=n[++r],e<i)break t}a=n.length;break n}if(!(e>=s)){const o=n[1];e<o&&(r=2,s=o);for(let l=r-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===l)break;if(i=s,s=n[--r-1],e>=s)break t}a=r,r=0;break n}break e}for(;r<a;){const o=r+a>>>1;e<n[o]?a=o:r=o+1}if(i=n[r],s=n[r-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return r=n.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,i)}return this.interpolate_(r,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const n=this.resultBuffer,r=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)n[a]=r[s+a];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class Wve extends wE{constructor(e,n,r,i){super(e,n,r,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Dm,endingEnd:Dm}}intervalChanged_(e,n,r){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],l=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case $m:s=e,o=2*n-r;break;case l_:s=i.length-2,o=n+i[s]-i[s+1];break;default:s=e,o=r}if(l===void 0)switch(this.getSettings_().endingEnd){case $m:a=e,l=2*r-n;break;case l_:a=1,l=r+i[1]-i[0];break;default:a=e-1,l=n}const c=(r-n)*.5,u=this.valueSize;this._weightPrev=c/(n-o),this._weightNext=c/(l-r),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,n,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=this._offsetPrev,d=this._offsetNext,h=this._weightPrev,f=this._weightNext,p=(r-n)/(i-n),g=p*p,m=g*p,y=-h*m+2*h*g-h*p,x=(1+h)*m+(-1.5-2*h)*g+(-.5+h)*p+1,b=(-1-f)*m+(1.5+f)*g+.5*p,_=f*m-f*g;for(let T=0;T!==o;++T)s[T]=y*a[u+T]+x*a[c+T]+b*a[l+T]+_*a[d+T];return s}}class UG extends wE{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e,n,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,u=(r-n)/(i-n),d=1-u;for(let h=0;h!==o;++h)s[h]=a[c+h]*d+a[l+h]*u;return s}}class Hve extends wE{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class ru{constructor(e,n,r,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=Fm(n,this.TimeBufferType),this.values=Fm(r,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const n=e.constructor;let r;if(n.toJSON!==this.toJSON)r=n.toJSON(e);else{r={name:e.name,times:Fm(e.times,Array),values:Fm(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new Hve(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new UG(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new Wve(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let n;switch(e){case a_:n=this.InterpolantFactoryMethodDiscrete;break;case o_:n=this.InterpolantFactoryMethodLinear;break;case Q2:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return a_;case this.InterpolantFactoryMethodLinear:return o_;case this.InterpolantFactoryMethodSmooth:return Q2}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const n=this.times;for(let r=0,i=n.length;r!==i;++r)n[r]+=e}return this}scale(e){if(e!==1){const n=this.times;for(let r=0,i=n.length;r!==i;++r)n[r]*=e}return this}trim(e,n){const r=this.times,i=r.length;let s=0,a=i-1;for(;s!==i&&r[s]<e;)++s;for(;a!==-1&&r[a]>n;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const r=this.times,i=this.values,s=r.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=r[o];if(typeof l=="number"&&isNaN(l)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(i!==void 0&&Uve(i))for(let o=0,l=i.length;o!==l;++o){const c=i[o];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),n=this.values.slice(),r=this.getValueSize(),i=this.getInterpolation()===Q2,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const c=e[o],u=e[o+1];if(c!==u&&(o!==1||c!==e[0]))if(i)l=!0;else{const d=o*r,h=d-r,f=d+r;for(let p=0;p!==r;++p){const g=n[d+p];if(g!==n[h+p]||g!==n[f+p]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const d=o*r,h=a*r;for(let f=0;f!==r;++f)n[h+f]=n[d+f]}++a}}if(s>0){e[a]=e[s];for(let o=s*r,l=a*r,c=0;c!==r;++c)n[l+c]=n[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=n.slice(0,a*r)):(this.times=e,this.values=n),this}clone(){const e=this.times.slice(),n=this.values.slice(),r=this.constructor,i=new r(this.name,e,n);return i.createInterpolant=this.createInterpolant,i}}ru.prototype.TimeBufferType=Float32Array;ru.prototype.ValueBufferType=Float32Array;ru.prototype.DefaultInterpolation=o_;class cy extends ru{}cy.prototype.ValueTypeName="bool";cy.prototype.ValueBufferType=Array;cy.prototype.DefaultInterpolation=a_;cy.prototype.InterpolantFactoryMethodLinear=void 0;cy.prototype.InterpolantFactoryMethodSmooth=void 0;class VG extends ru{}VG.prototype.ValueTypeName="color";class v_ extends ru{}v_.prototype.ValueTypeName="number";class Gve extends wE{constructor(e,n,r,i){super(e,n,r,i)}interpolate_(e,n,r,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(r-n)/(i-n);let c=e*o;for(let u=c+o;c!==u;c+=4)xo.slerpFlat(s,0,a,c-o,a,c,l);return s}}class Nb extends ru{InterpolantFactoryMethodLinear(e){return new Gve(this.times,this.values,this.getValueSize(),e)}}Nb.prototype.ValueTypeName="quaternion";Nb.prototype.DefaultInterpolation=o_;Nb.prototype.InterpolantFactoryMethodSmooth=void 0;class uy extends ru{}uy.prototype.ValueTypeName="string";uy.prototype.ValueBufferType=Array;uy.prototype.DefaultInterpolation=a_;uy.prototype.InterpolantFactoryMethodLinear=void 0;uy.prototype.InterpolantFactoryMethodSmooth=void 0;class x_ extends ru{}x_.prototype.ValueTypeName="vector";class b_{constructor(e,n=-1,r,i=XP){this.name=e,this.tracks=r,this.duration=n,this.blendMode=i,this.uuid=Zo(),this.duration<0&&this.resetDuration()}static parse(e){const n=[],r=e.tracks,i=1/(e.fps||1);for(let a=0,o=r.length;a!==o;++a)n.push(u2t(r[a]).scale(i));const s=new this(e.name,e.duration,n,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const n=[],r=e.tracks,i={name:e.name,duration:e.duration,tracks:n,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,a=r.length;s!==a;++s)n.push(ru.toJSON(r[s]));return i}static CreateFromMorphTargetSequence(e,n,r,i){const s=n.length,a=[];for(let o=0;o<s;o++){let l=[],c=[];l.push((o+s-1)%s,o,(o+1)%s),c.push(0,1,0);const u=Vve(l);l=J4(l,1,u),c=J4(c,1,u),!i&&l[0]===0&&(l.push(s),c.push(c[0])),a.push(new v_(".morphTargetInfluences["+n[o].name+"]",l,c).scale(1/r))}return new this(e,-1,a)}static findByName(e,n){let r=e;if(!Array.isArray(e)){const i=e;r=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<r.length;i++)if(r[i].name===n)return r[i];return null}static CreateClipsFromMorphTargetSequences(e,n,r){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],u=c.name.match(s);if(u&&u.length>1){const d=u[1];let h=i[d];h||(i[d]=h=[]),h.push(c)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],n,r));return a}static parseAnimation(e,n){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const r=function(d,h,f,p,g){if(f.length!==0){const m=[],y=[];BG(f,m,y,p),m.length!==0&&g.push(new d(h,m,y))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let d=0;d<c.length;d++){const h=c[d].keys;if(!(!h||h.length===0))if(h[0].morphTargets){const f={};let p;for(p=0;p<h.length;p++)if(h[p].morphTargets)for(let g=0;g<h[p].morphTargets.length;g++)f[h[p].morphTargets[g]]=-1;for(const g in f){const m=[],y=[];for(let x=0;x!==h[p].morphTargets.length;++x){const b=h[p];m.push(b.time),y.push(b.morphTarget===g?1:0)}i.push(new v_(".morphTargetInfluence["+g+"]",m,y))}l=f.length*a}else{const f=".bones["+n[d].name+"]";r(x_,f+".position",h,"pos",i),r(Nb,f+".quaternion",h,"rot",i),r(x_,f+".scale",h,"scl",i)}}return i.length===0?null:new this(s,l,i,o)}resetDuration(){const e=this.tracks;let n=0;for(let r=0,i=e.length;r!==i;++r){const s=this.tracks[r];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let n=0;n<this.tracks.length;n++)e=e&&this.tracks[n].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function c2t(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return v_;case"vector":case"vector2":case"vector3":case"vector4":return x_;case"color":return VG;case"quaternion":return Nb;case"bool":case"boolean":return cy;case"string":return uy}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function u2t(t){if(t.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=c2t(t.type);if(t.times===void 0){const n=[],r=[];BG(t.keys,n,r,"value"),t.times=n,t.values=r}return e.parse!==void 0?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)}const zd={enabled:!1,files:{},add:function(t,e){this.enabled!==!1&&(this.files[t]=e)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};class WG{constructor(e,n,r){const i=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=n,this.onError=r,this.itemStart=function(u){o++,s===!1&&i.onStart!==void 0&&i.onStart(u,a,o),s=!0},this.itemEnd=function(u){a++,i.onProgress!==void 0&&i.onProgress(u,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(u){i.onError!==void 0&&i.onError(u)},this.resolveURL=function(u){return l?l(u):u},this.setURLModifier=function(u){return l=u,this},this.addHandler=function(u,d){return c.push(u,d),this},this.removeHandler=function(u){const d=c.indexOf(u);return d!==-1&&c.splice(d,2),this},this.getHandler=function(u){for(let d=0,h=c.length;d<h;d+=2){const f=c[d],p=c[d+1];if(f.global&&(f.lastIndex=0),f.test(u))return p}return null}}}const qve=new WG;class Ao{constructor(e){this.manager=e!==void 0?e:qve,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,n){const r=this;return new Promise(function(i,s){r.load(e,i,n,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Ao.DEFAULT_MATERIAL_NAME="__DEFAULT";const wd={};class d2t extends Error{constructor(e,n){super(e),this.response=n}}class fh extends Ao{constructor(e){super(e)}load(e,n,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=zd.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{n&&n(s),this.manager.itemEnd(e)},0),s;if(wd[e]!==void 0){wd[e].push({onLoad:n,onProgress:r,onError:i});return}wd[e]=[],wd[e].push({onLoad:n,onProgress:r,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const u=wd[e],d=c.body.getReader(),h=c.headers.get("Content-Length")||c.headers.get("X-File-Size"),f=h?parseInt(h):0,p=f!==0;let g=0;const m=new ReadableStream({start(y){x();function x(){d.read().then(({done:b,value:_})=>{if(b)y.close();else{g+=_.byteLength;const T=new ProgressEvent("progress",{lengthComputable:p,loaded:g,total:f});for(let E=0,C=u.length;E<C;E++){const I=u[E];I.onProgress&&I.onProgress(T)}y.enqueue(_),x()}})}}});return new Response(m)}else throw new d2t(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(u=>new DOMParser().parseFromString(u,o));case"json":return c.json();default:if(o===void 0)return c.text();{const d=/charset="?([^;"\s]*)"?/i.exec(o),h=d&&d[1]?d[1].toLowerCase():void 0,f=new TextDecoder(h);return c.arrayBuffer().then(p=>f.decode(p))}}}).then(c=>{zd.add(e,c);const u=wd[e];delete wd[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onLoad&&f.onLoad(c)}}).catch(c=>{const u=wd[e];if(u===void 0)throw this.manager.itemError(e),c;delete wd[e];for(let d=0,h=u.length;d<h;d++){const f=u[d];f.onError&&f.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class h2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=new fh(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n=[];for(let r=0;r<e.length;r++){const i=b_.parse(e[r]);n.push(i)}return n}}class f2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=[],o=new nO,l=new fh(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function u(d){l.load(e[d],function(h){const f=s.parse(h,!0);a[d]={width:f.width,height:f.height,format:f.format,mipmaps:f.mipmaps},c+=1,c===6&&(f.mipmapCount===1&&(o.minFilter=Ri),o.image=a,o.format=f.format,o.needsUpdate=!0,n&&n(o))},r,i)}if(Array.isArray(e))for(let d=0,h=e.length;d<h;++d)u(d);else l.load(e,function(d){const h=s.parse(d,!0);if(h.isCubemap){const f=h.mipmaps.length/h.mipmapCount;for(let p=0;p<f;p++){a[p]={mipmaps:[]};for(let g=0;g<h.mipmapCount;g++)a[p].mipmaps.push(h.mipmaps[p*h.mipmapCount+g]),a[p].format=h.format,a[p].width=h.width,a[p].height=h.height}o.image=a}else o.image.width=h.width,o.image.height=h.height,o.mipmaps=h.mipmaps;h.mipmapCount===1&&(o.minFilter=Ri),o.format=h.format,o.needsUpdate=!0,n&&n(o)},r,i);return o}}class w_ extends Ao{constructor(e){super(e)}load(e,n,r,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=zd.get(e);if(a!==void 0)return s.manager.itemStart(e),setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a;const o=f_("img");function l(){u(),zd.add(e,this),n&&n(this),s.manager.itemEnd(e)}function c(d){u(),i&&i(d),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}}class p2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=new pE;s.colorSpace=rs;const a=new w_(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(u){s.images[c]=u,o++,o===6&&(s.needsUpdate=!0,n&&n(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class m2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=new ng,o=new fh(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let c;try{c=s.parse(l)}catch(u){if(i!==void 0)i(u);else{console.error(u);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:pa,a.wrapT=c.wrapT!==void 0?c.wrapT:pa,a.magFilter=c.magFilter!==void 0?c.magFilter:Ri,a.minFilter=c.minFilter!==void 0?c.minFilter:Ri,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0?a.colorSpace=c.colorSpace:c.encoding!==void 0&&(a.encoding=c.encoding),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=tp),c.mipmapCount===1&&(a.minFilter=Ri),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,n&&n(a,c)},r,i),a}}class g2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=new $i,a=new w_(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,n!==void 0&&n(s)},r,i),s}}class Pp extends tr{constructor(e,n=1){super(),this.isLight=!0,this.type="Light",this.color=new xt(e),this.intensity=n}dispose(){}copy(e,n){return super.copy(e,n),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const n=super.toJSON(e);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class Xve extends Pp{constructor(e,n,r){super(e,r),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.groundColor=new xt(n)}copy(e,n){return super.copy(e,n),this.groundColor.copy(e.groundColor),this}}const l3=new an,pee=new ne,mee=new ne;class HG{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Xe(512,512),this.map=null,this.mapPass=null,this.matrix=new an,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new mE,this._frameExtents=new Xe(1,1),this._viewportCount=1,this._viewports=[new hr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const n=this.camera,r=this.matrix;pee.setFromMatrixPosition(e.matrixWorld),n.position.copy(pee),mee.setFromMatrixPosition(e.target.matrixWorld),n.lookAt(mee),n.updateMatrixWorld(),l3.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(l3),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(l3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class y2t extends HG{constructor(){super(new Ts(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const n=this.camera,r=I0*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height,s=e.distance||n.far;(r!==n.fov||i!==n.aspect||s!==n.far)&&(n.fov=r,n.aspect=i,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Kve extends Pp{constructor(e,n,r=0,i=Math.PI/3,s=0,a=2){super(e,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.target=new tr,this.distance=r,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new y2t}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const gee=new an,Rw=new ne,c3=new ne;class v2t extends HG{constructor(){super(new Ts(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new Xe(4,2),this._viewportCount=6,this._viewports=[new hr(2,1,1,1),new hr(0,1,1,1),new hr(3,1,1,1),new hr(1,1,1,1),new hr(3,0,1,1),new hr(1,0,1,1)],this._cubeDirections=[new ne(1,0,0),new ne(-1,0,0),new ne(0,0,1),new ne(0,0,-1),new ne(0,1,0),new ne(0,-1,0)],this._cubeUps=[new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,1,0),new ne(0,0,1),new ne(0,0,-1)]}updateMatrices(e,n=0){const r=this.camera,i=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),Rw.setFromMatrixPosition(e.matrixWorld),r.position.copy(Rw),c3.copy(r.position),c3.add(this._cubeDirections[n]),r.up.copy(this._cubeUps[n]),r.lookAt(c3),r.updateMatrixWorld(),i.makeTranslation(-Rw.x,-Rw.y,-Rw.z),gee.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(gee)}}class Yve extends Pp{constructor(e,n,r=0,i=2){super(e,n),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=i,this.shadow=new v2t}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,n){return super.copy(e,n),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class x2t extends HG{constructor(){super(new yE(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class Zve extends Pp{constructor(e,n){super(e,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(tr.DEFAULT_UP),this.updateMatrix(),this.target=new tr,this.shadow=new x2t}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class Qve extends Pp{constructor(e,n){super(e,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class Jve extends Pp{constructor(e,n,r=10,i=10){super(e,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=r,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const n=super.toJSON(e);return n.object.width=this.width,n.object.height=this.height,n}}class exe{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ne)}set(e){for(let n=0;n<9;n++)this.coefficients[n].copy(e[n]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,n){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.282095),n.addScaledVector(a[1],.488603*i),n.addScaledVector(a[2],.488603*s),n.addScaledVector(a[3],.488603*r),n.addScaledVector(a[4],1.092548*(r*i)),n.addScaledVector(a[5],1.092548*(i*s)),n.addScaledVector(a[6],.315392*(3*s*s-1)),n.addScaledVector(a[7],1.092548*(r*s)),n.addScaledVector(a[8],.546274*(r*r-i*i)),n}getIrradianceAt(e,n){const r=e.x,i=e.y,s=e.z,a=this.coefficients;return n.copy(a[0]).multiplyScalar(.886227),n.addScaledVector(a[1],2*.511664*i),n.addScaledVector(a[2],2*.511664*s),n.addScaledVector(a[3],2*.511664*r),n.addScaledVector(a[4],2*.429043*r*i),n.addScaledVector(a[5],2*.429043*i*s),n.addScaledVector(a[6],.743125*s*s-.247708),n.addScaledVector(a[7],2*.429043*r*s),n.addScaledVector(a[8],.429043*(r*r-i*i)),n}add(e){for(let n=0;n<9;n++)this.coefficients[n].add(e.coefficients[n]);return this}addScaledSH(e,n){for(let r=0;r<9;r++)this.coefficients[r].addScaledVector(e.coefficients[r],n);return this}scale(e){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(e);return this}lerp(e,n){for(let r=0;r<9;r++)this.coefficients[r].lerp(e.coefficients[r],n);return this}equals(e){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(e.coefficients[n]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,n=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].fromArray(e,n+i*3);return this}toArray(e=[],n=0){const r=this.coefficients;for(let i=0;i<9;i++)r[i].toArray(e,n+i*3);return e}static getBasisAt(e,n){const r=e.x,i=e.y,s=e.z;n[0]=.282095,n[1]=.488603*i,n[2]=.488603*s,n[3]=.488603*r,n[4]=1.092548*r*i,n[5]=1.092548*i*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*r*s,n[8]=.546274*(r*r-i*i)}}class txe extends Pp{constructor(e=new exe,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const n=super.toJSON(e);return n.object.sh=this.sh.toArray(),n}}class yO extends Ao{constructor(e){super(e),this.textures={}}load(e,n,r,i){const s=this,a=new fh(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n=this.textures;function r(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const i=yO.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new xt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=r(a.value);break;case"c":i.uniforms[s].value=new xt().setHex(a.value);break;case"v2":i.uniforms[s].value=new Xe().fromArray(a.value);break;case"v3":i.uniforms[s].value=new ne().fromArray(a.value);break;case"v4":i.uniforms[s].value=new hr().fromArray(a.value);break;case"m3":i.uniforms[s].value=new Tn().fromArray(a.value);break;case"m4":i.uniforms[s].value=new an().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=r(e.map)),e.matcap!==void 0&&(i.matcap=r(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=r(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=r(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=r(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new Xe().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=r(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=r(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=r(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=r(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=r(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=r(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=r(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=r(e.envMap)),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=r(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=r(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=r(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=r(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=r(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=r(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new Xe().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=r(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=r(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=r(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=r(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=r(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=r(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=r(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const n={ShadowMaterial:Pve,SpriteMaterial:MG,RawShaderMaterial:Ove,ShaderMaterial:Ju,PointsMaterial:PG,MeshPhysicalMaterial:Dve,MeshStandardMaterial:zG,MeshPhongMaterial:$ve,MeshToonMaterial:Lve,MeshNormalMaterial:Fve,MeshLambertMaterial:jve,MeshDepthMaterial:NG,MeshDistanceMaterial:AG,MeshBasicMaterial:Mp,MeshMatcapMaterial:zve,LineDashedMaterial:Bve,LineBasicMaterial:Ya,Material:_a};return new n[e]}}class eB{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let n="";for(let r=0,i=e.length;r<i;r++)n+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(e){const n=e.lastIndexOf("/");return n===-1?"./":e.slice(0,n+1)}static resolveURL(e,n){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(e)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:n+e)}}class nxe extends Cn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class rxe extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=new fh(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{n(s.parse(JSON.parse(o)))}catch(l){i?i(l):console.error(l),s.manager.itemError(e)}},r,i)}parse(e){const n={},r={};function i(f,p){if(n[p]!==void 0)return n[p];const m=f.interleavedBuffers[p],y=s(f,m.buffer),x=jv(m.type,y),b=new eO(x,m.stride);return b.uuid=m.uuid,n[p]=b,b}function s(f,p){if(r[p]!==void 0)return r[p];const m=f.arrayBuffers[p],y=new Uint32Array(m).buffer;return r[p]=y,y}const a=e.isInstancedBufferGeometry?new nxe:new Cn,o=e.data.index;if(o!==void 0){const f=jv(o.type,o.array);a.setIndex(new mr(f,1))}const l=e.data.attributes;for(const f in l){const p=l[f];let g;if(p.isInterleavedBufferAttribute){const m=i(e.data,p.data);g=new Bg(m,p.itemSize,p.offset,p.normalized)}else{const m=jv(p.type,p.array),y=p.isInstancedBufferAttribute?M0:mr;g=new y(m,p.itemSize,p.normalized)}p.name!==void 0&&(g.name=p.name),p.usage!==void 0&&g.setUsage(p.usage),a.setAttribute(f,g)}const c=e.data.morphAttributes;if(c)for(const f in c){const p=c[f],g=[];for(let m=0,y=p.length;m<y;m++){const x=p[m];let b;if(x.isInterleavedBufferAttribute){const _=i(e.data,x.data);b=new Bg(_,x.itemSize,x.offset,x.normalized)}else{const _=jv(x.type,x.array);b=new mr(_,x.itemSize,x.normalized)}x.name!==void 0&&(b.name=x.name),g.push(b)}a.morphAttributes[f]=g}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const d=e.data.groups||e.data.drawcalls||e.data.offsets;if(d!==void 0)for(let f=0,p=d.length;f!==p;++f){const g=d[f];a.addGroup(g.start,g.count,g.materialIndex)}const h=e.data.boundingSphere;if(h!==void 0){const f=new ne;h.center!==void 0&&f.fromArray(h.center),a.boundingSphere=new ga(f,h.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class b2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=this.path===""?eB.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new fh(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(d){i!==void 0&&i(d),console.error("THREE:ObjectLoader: Can't parse "+e+".",d.message);return}const u=c.metadata;if(u===void 0||u.type===void 0||u.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(c,n)},r,i)}async loadAsync(e,n){const r=this,i=this.path===""?eB.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new fh(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,n),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await r.parseAsync(o)}parse(e,n){const r=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){n!==void 0&&n(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,r),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),n!==void 0){let d=!1;for(const h in a)if(a[h].data instanceof HTMLImageElement){d=!0;break}d===!1&&n(c)}return c}async parseAsync(e){const n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,r),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,o,a,n),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),l}parseShapes(e){const n={};if(e!==void 0)for(let r=0,i=e.length;r<i;r++){const s=new rg().fromJSON(e[r]);n[s.uuid]=s}return n}parseSkeletons(e,n){const r={},i={};if(n.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new tO().fromJSON(e[s],i);r[o.uuid]=o}return r}parseGeometries(e,n){const r={};if(e!==void 0){const i=new rxe;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(l);break;default:l.type in fee?o=fee[l.type].fromJSON(l,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),r[l.uuid]=o}}return r}parseMaterials(e,n){const r={},i={};if(e!==void 0){const s=new yO;s.setTextures(n);for(let a=0,o=e.length;a<o;a++){const l=e[a];r[l.uuid]===void 0&&(r[l.uuid]=s.parse(l)),i[l.uuid]=r[l.uuid]}}return i}parseAnimations(e){const n={};if(e!==void 0)for(let r=0;r<e.length;r++){const i=e[r],s=b_.parse(i);n[s.uuid]=s}return n}parseImages(e,n){const r=this,i={};let s;function a(l){return r.manager.itemStart(l),s.load(l,function(){r.manager.itemEnd(l)},void 0,function(){r.manager.itemError(l),r.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,u=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:r.resourcePath+c;return a(u)}else return l.data?{data:jv(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new WG(n);s=new w_(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,u=e.length;c<u;c++){const d=e[c],h=d.url;if(Array.isArray(h)){const f=[];for(let p=0,g=h.length;p<g;p++){const m=h[p],y=o(m);y!==null&&(y instanceof HTMLImageElement?f.push(y):f.push(new ng(y.data,y.width,y.height)))}i[d.uuid]=new Lm(f)}else{const f=o(d.url);i[d.uuid]=new Lm(f)}}}return i}async parseImagesAsync(e){const n=this,r={};let i;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:n.resourcePath+o;return await i.loadAsync(l)}else return a.data?{data:jv(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new w_(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const u=[];for(let d=0,h=c.length;d<h;d++){const f=c[d],p=await s(f);p!==null&&(p instanceof HTMLImageElement?u.push(p):u.push(new ng(p.data,p.width,p.height)))}r[l.uuid]=new Lm(u)}else{const u=await s(l.url);r[l.uuid]=new Lm(u)}}}return r}parseTextures(e,n){function r(s,a){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),n[o.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",o.image);const l=n[o.image],c=l.data;let u;Array.isArray(c)?(u=new pE,c.length===6&&(u.needsUpdate=!0)):(c&&c.data?u=new ng:u=new $i,c&&(u.needsUpdate=!0)),u.source=l,u.uuid=o.uuid,o.name!==void 0&&(u.name=o.name),o.mapping!==void 0&&(u.mapping=r(o.mapping,w2t)),o.channel!==void 0&&(u.channel=o.channel),o.offset!==void 0&&u.offset.fromArray(o.offset),o.repeat!==void 0&&u.repeat.fromArray(o.repeat),o.center!==void 0&&u.center.fromArray(o.center),o.rotation!==void 0&&(u.rotation=o.rotation),o.wrap!==void 0&&(u.wrapS=r(o.wrap[0],yee),u.wrapT=r(o.wrap[1],yee)),o.format!==void 0&&(u.format=o.format),o.internalFormat!==void 0&&(u.internalFormat=o.internalFormat),o.type!==void 0&&(u.type=o.type),o.colorSpace!==void 0&&(u.colorSpace=o.colorSpace),o.encoding!==void 0&&(u.encoding=o.encoding),o.minFilter!==void 0&&(u.minFilter=r(o.minFilter,vee)),o.magFilter!==void 0&&(u.magFilter=r(o.magFilter,vee)),o.anisotropy!==void 0&&(u.anisotropy=o.anisotropy),o.flipY!==void 0&&(u.flipY=o.flipY),o.generateMipmaps!==void 0&&(u.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(u.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(u.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(u.compareFunction=o.compareFunction),o.userData!==void 0&&(u.userData=o.userData),i[o.uuid]=u}return i}parseObject(e,n,r,i,s){let a;function o(h){return n[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",h),n[h]}function l(h){if(h!==void 0){if(Array.isArray(h)){const f=[];for(let p=0,g=h.length;p<g;p++){const m=h[p];r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),f.push(r[m])}return f}return r[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",h),r[h]}}function c(h){return i[h]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",h),i[h]}let u,d;switch(e.type){case"Scene":a=new kG,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new xt(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new JP(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new QP(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new Ts(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new yE(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Qve(e.color,e.intensity);break;case"DirectionalLight":a=new Zve(e.color,e.intensity);break;case"PointLight":a=new Yve(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Jve(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Kve(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Xve(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new txe().fromJSON(e);break;case"SkinnedMesh":u=o(e.geometry),d=l(e.material),a=new vve(u,d),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":u=o(e.geometry),d=l(e.material),a=new ls(u,d);break;case"InstancedMesh":u=o(e.geometry),d=l(e.material);const h=e.count,f=e.instanceMatrix,p=e.instanceColor;a=new xve(u,d,h),a.instanceMatrix=new M0(new Float32Array(f.array),16),p!==void 0&&(a.instanceColor=new M0(new Float32Array(p.array),p.itemSize));break;case"BatchedMesh":u=o(e.geometry),d=l(e.material),a=new bve(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,d),a.geometry=u,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._visibility=e.visibility,a._active=e.active,a._bounds=e.bounds.map(g=>{const m=new Va;m.min.fromArray(g.boxMin),m.max.fromArray(g.boxMax);const y=new ga;return y.radius=g.sphereRadius,y.center.fromArray(g.sphereCenter),{boxInitialized:g.boxInitialized,box:m,sphereInitialized:g.sphereInitialized,sphere:y}}),a._maxGeometryCount=e.maxGeometryCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._geometryCount=e.geometryCount,a._matricesTexture=c(e.matricesTexture.uuid);break;case"LOD":a=new yve;break;case"Line":a=new np(o(e.geometry),l(e.material));break;case"LineLoop":a=new wve(o(e.geometry),l(e.material));break;case"LineSegments":a=new ad(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new Sve(o(e.geometry),l(e.material));break;case"Sprite":a=new gve(l(e.material));break;case"Group":a=new Uv;break;case"Bone":a=new RG;break;default:a=new tr}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const h=e.children;for(let f=0;f<h.length;f++)a.add(this.parseObject(h[f],n,r,i,s))}if(e.animations!==void 0){const h=e.animations;for(let f=0;f<h.length;f++){const p=h[f];a.animations.push(s[p])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const h=e.levels;for(let f=0;f<h.length;f++){const p=h[f],g=a.getObjectByProperty("uuid",p.object);g!==void 0&&a.addLevel(g,p.distance,p.hysteresis)}}return a}bindSkeletons(e,n){Object.keys(n).length!==0&&e.traverse(function(r){if(r.isSkinnedMesh===!0&&r.skeleton!==void 0){const i=n[r.skeleton];i===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",r.skeleton):r.bind(i,r.bindMatrix)}})}}const w2t={UVMapping:GP,CubeReflectionMapping:hh,CubeRefractionMapping:ep,EquirectangularReflectionMapping:n_,EquirectangularRefractionMapping:r_,CubeUVReflectionMapping:_b},yee={RepeatWrapping:i_,ClampToEdgeWrapping:pa,MirroredRepeatWrapping:s_},vee={NearestFilter:Ii,NearestMipmapNearestFilter:gk,NearestMipmapLinearFilter:b1,LinearFilter:Ri,LinearMipmapNearestFilter:cG,LinearMipmapLinearFilter:tp};class S2t extends Ao{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,n,r,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=zd.get(e);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(c=>{n&&n(c),s.manager.itemEnd(e)}).catch(c=>{i&&i(c)});return}return setTimeout(function(){n&&n(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return zd.add(e,c),n&&n(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),zd.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});zd.add(e,l),s.manager.itemStart(e)}}let c2;class GG{static getContext(){return c2===void 0&&(c2=new(window.AudioContext||window.webkitAudioContext)),c2}static setContext(e){c2=e}}class _2t extends Ao{constructor(e){super(e)}load(e,n,r,i){const s=this,a=new fh(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);GG.getContext().decodeAudioData(c,function(d){n(d)}).catch(o)}catch(c){o(c)}},r,i);function o(l){i?i(l):console.error(l),s.manager.itemError(e)}}}const xee=new an,bee=new an,Qp=new an;class T2t{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ts,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ts,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const n=this._cache;if(n.focus!==e.focus||n.fov!==e.fov||n.aspect!==e.aspect*this.aspect||n.near!==e.near||n.far!==e.far||n.zoom!==e.zoom||n.eyeSep!==this.eyeSep){n.focus=e.focus,n.fov=e.fov,n.aspect=e.aspect*this.aspect,n.near=e.near,n.far=e.far,n.zoom=e.zoom,n.eyeSep=this.eyeSep,Qp.copy(e.projectionMatrix);const i=n.eyeSep/2,s=i*n.near/n.focus,a=n.near*Math.tan(eg*n.fov*.5)/n.zoom;let o,l;bee.elements[12]=-i,xee.elements[12]=i,o=-a*n.aspect+s,l=a*n.aspect+s,Qp.elements[0]=2*n.near/(l-o),Qp.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(Qp),o=-a*n.aspect-s,l=a*n.aspect-s,Qp.elements[0]=2*n.near/(l-o),Qp.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(Qp)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(bee),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(xee)}}class qG{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=wee(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=wee();e=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=e}return e}}function wee(){return(typeof performance>"u"?Date:performance).now()}const Jp=new ne,See=new xo,E2t=new ne,em=new ne;class C2t extends tr{constructor(){super(),this.type="AudioListener",this.context=GG.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new qG}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const n=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Jp,See,E2t),em.set(0,0,-1).applyQuaternion(See),n.positionX){const i=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Jp.x,i),n.positionY.linearRampToValueAtTime(Jp.y,i),n.positionZ.linearRampToValueAtTime(Jp.z,i),n.forwardX.linearRampToValueAtTime(em.x,i),n.forwardY.linearRampToValueAtTime(em.y,i),n.forwardZ.linearRampToValueAtTime(em.z,i),n.upX.linearRampToValueAtTime(r.x,i),n.upY.linearRampToValueAtTime(r.y,i),n.upZ.linearRampToValueAtTime(r.z,i)}else n.setPosition(Jp.x,Jp.y,Jp.z),n.setOrientation(em.x,em.y,em.z,r.x,r.y,r.z)}}class ixe extends tr{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,n=this.filters.length;e<n;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const tm=new ne,_ee=new xo,N2t=new ne,nm=new ne;class A2t extends ixe{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,n,r){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=r,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(tm,_ee,N2t),nm.set(0,0,1).applyQuaternion(_ee);const n=this.panner;if(n.positionX){const r=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(tm.x,r),n.positionY.linearRampToValueAtTime(tm.y,r),n.positionZ.linearRampToValueAtTime(tm.z,r),n.orientationX.linearRampToValueAtTime(nm.x,r),n.orientationY.linearRampToValueAtTime(nm.y,r),n.orientationZ.linearRampToValueAtTime(nm.z,r)}else n.setPosition(tm.x,tm.y,tm.z),n.setOrientation(nm.x,nm.y,nm.z)}}class I2t{constructor(e,n=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const n=this.getFrequencyData();for(let r=0;r<n.length;r++)e+=n[r];return e/n.length}}class sxe{constructor(e,n,r){this.binding=e,this.valueSize=r;let i,s,a;switch(n){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(r*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(r*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(r*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,n){const r=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)r[s+o]=r[o];a=n}else{a+=n;const o=n/a;this._mixBufferRegion(r,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const n=this.buffer,r=this.valueSize,i=r*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,i,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){const n=this.valueSize,r=this.buffer,i=e*n+n,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=n*this._origIndex;this._mixBufferRegion(r,i,l,1-s,n)}a>0&&this._mixBufferRegionAdditive(r,i,this._addIndex*n,1,n);for(let l=n,c=n+n;l!==c;++l)if(r[l]!==r[l+n]){o.setValue(r,i);break}}saveOriginalState(){const e=this.binding,n=this.buffer,r=this.valueSize,i=r*this._origIndex;e.getValue(n,i);for(let s=r,a=i;s!==a;++s)n[s]=n[i+s%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,n=e+this.valueSize;for(let r=e;r<n;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[n+r]=this.buffer[e+r]}_select(e,n,r,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[n+a]=e[r+a]}_slerp(e,n,r,i){xo.slerpFlat(e,n,e,n,e,r,i)}_slerpAdditive(e,n,r,i,s){const a=this._workIndex*s;xo.multiplyQuaternionsFlat(e,a,e,n,e,r),xo.slerpFlat(e,n,e,n,e,a,i)}_lerp(e,n,r,i,s){const a=1-i;for(let o=0;o!==s;++o){const l=n+o;e[l]=e[l]*a+e[r+o]*i}}_lerpAdditive(e,n,r,i,s){for(let a=0;a!==s;++a){const o=n+a;e[o]=e[o]+e[r+a]*i}}}const XG="\\[\\]\\.:\\/",k2t=new RegExp("["+XG+"]","g"),KG="[^"+XG+"]",M2t="[^"+XG.replace("\\.","")+"]",R2t=/((?:WC+[\/:])*)/.source.replace("WC",KG),P2t=/(WCOD+)?/.source.replace("WCOD",M2t),O2t=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",KG),D2t=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",KG),$2t=new RegExp("^"+R2t+P2t+O2t+D2t+"$"),L2t=["material","materials","bones","map"];class F2t{constructor(e,n,r){const i=r||Kn.parseTrackName(n);this._targetGroup=e,this._bindings=e.subscribe_(n,i)}getValue(e,n){this.bind();const r=this._targetGroup.nCachedObjects_,i=this._bindings[r];i!==void 0&&i.getValue(e,n)}setValue(e,n){const r=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=r.length;i!==s;++i)r[i].setValue(e,n)}bind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].bind()}unbind(){const e=this._bindings;for(let n=this._targetGroup.nCachedObjects_,r=e.length;n!==r;++n)e[n].unbind()}}class Kn{constructor(e,n,r){this.path=n,this.parsedPath=r||Kn.parseTrackName(n),this.node=Kn.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,n,r){return e&&e.isAnimationObjectGroup?new Kn.Composite(e,n,r):new Kn(e,n,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(k2t,"")}static parseTrackName(e){const n=$2t.exec(e);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const r={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=r.nodeName.substring(i+1);L2t.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,n){if(n===void 0||n===""||n==="."||n===-1||n===e.name||n===e.uuid)return e;if(e.skeleton){const r=e.skeleton.getBoneByName(n);if(r!==void 0)return r}if(e.children){const r=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===n||o.uuid===n)return o;const l=r(o.children);if(l)return l}return null},i=r(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,n){e[n]=this.targetObject[this.propertyName]}_getValue_array(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)e[n++]=r[i]}_getValue_arrayElement(e,n){e[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,n){this.resolvedProperty.toArray(e,n)}_setValue_direct(e,n){this.targetObject[this.propertyName]=e[n]}_setValue_direct_setNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,n){this.targetObject[this.propertyName]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++]}_setValue_array_setNeedsUpdate(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,n){const r=this.resolvedProperty;for(let i=0,s=r.length;i!==s;++i)r[i]=e[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,n){this.resolvedProperty[this.propertyIndex]=e[n]}_setValue_arrayElement_setNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty[this.propertyIndex]=e[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,n){this.resolvedProperty.fromArray(e,n)}_setValue_fromArray_setNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,n){this.resolvedProperty.fromArray(e,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,n){this.bind(),this.getValue(e,n)}_setValue_unbound(e,n){this.bind(),this.setValue(e,n)}bind(){let e=this.node;const n=this.parsedPath,r=n.objectName,i=n.propertyName;let s=n.propertyIndex;if(e||(e=Kn.findNode(this.rootNode,n.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let c=n.objectIndex;switch(r){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let u=0;u<e.length;u++)if(e[u].name===c){c=u;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(c!==void 0){if(e[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[i];if(a===void 0){const c=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Kn.Composite=F2t;Kn.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};Kn.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};Kn.prototype.GetterByBindingType=[Kn.prototype._getValue_direct,Kn.prototype._getValue_array,Kn.prototype._getValue_arrayElement,Kn.prototype._getValue_toArray];Kn.prototype.SetterByBindingTypeAndVersioning=[[Kn.prototype._setValue_direct,Kn.prototype._setValue_direct_setNeedsUpdate,Kn.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Kn.prototype._setValue_array,Kn.prototype._setValue_array_setNeedsUpdate,Kn.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Kn.prototype._setValue_arrayElement,Kn.prototype._setValue_arrayElement_setNeedsUpdate,Kn.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Kn.prototype._setValue_fromArray,Kn.prototype._setValue_fromArray_setNeedsUpdate,Kn.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class j2t{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Zo(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let r=0,i=arguments.length;r!==i;++r)e[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const e=this._objects,n=this._indicesByUUID,r=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let u=0,d=arguments.length;u!==d;++u){const h=arguments[u],f=h.uuid;let p=n[f];if(p===void 0){p=l++,n[f]=p,e.push(h);for(let g=0,m=a;g!==m;++g)s[g].push(new Kn(h,r[g],i[g]))}else if(p<c){o=e[p];const g=--c,m=e[g];n[m.uuid]=p,e[p]=m,n[f]=g,e[g]=h;for(let y=0,x=a;y!==x;++y){const b=s[y],_=b[g];let T=b[p];b[p]=_,T===void 0&&(T=new Kn(h,r[y],i[y])),b[g]=T}}else e[p]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,u=n[c];if(u!==void 0&&u>=s){const d=s++,h=e[d];n[h.uuid]=u,e[u]=h,n[c]=d,e[d]=l;for(let f=0,p=i;f!==p;++f){const g=r[f],m=g[d],y=g[u];g[u]=m,g[d]=y}}}this.nCachedObjects_=s}uncache(){const e=this._objects,n=this._indicesByUUID,r=this._bindings,i=r.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],u=c.uuid,d=n[u];if(d!==void 0)if(delete n[u],d<s){const h=--s,f=e[h],p=--a,g=e[p];n[f.uuid]=d,e[d]=f,n[g.uuid]=h,e[h]=g,e.pop();for(let m=0,y=i;m!==y;++m){const x=r[m],b=x[h],_=x[p];x[d]=b,x[h]=_,x.pop()}}else{const h=--a,f=e[h];h>0&&(n[f.uuid]=d),e[d]=f,e.pop();for(let p=0,g=i;p!==g;++p){const m=r[p];m[d]=m[h],m.pop()}}}this.nCachedObjects_=s}subscribe_(e,n){const r=this._bindingsIndicesByPath;let i=r[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,u=this.nCachedObjects_,d=new Array(c);i=s.length,r[e]=i,a.push(e),o.push(n),s.push(d);for(let h=u,f=l.length;h!==f;++h){const p=l[h];d[h]=new Kn(p,e,n)}return d}unsubscribe_(e){const n=this._bindingsIndicesByPath,r=n[e];if(r!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];n[c]=r,a[r]=l,a.pop(),s[r]=s[o],s.pop(),i[r]=i[o],i.pop()}}}class axe{constructor(e,n,r=null,i=n.blendMode){this._mixer=e,this._clip=n,this._localRoot=r,this.blendMode=i;const s=n.tracks,a=s.length,o=new Array(a),l={endingStart:Dm,endingEnd:Dm};for(let c=0;c!==a;++c){const u=s[c].createInterpolant(null);o[c]=u,u.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=zye,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,n){return this.loop=e,this.repetitions=n,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,n,r){if(e.fadeOut(n),this.fadeIn(n),r){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,n),this.warp(o,1,n)}return this}crossFadeTo(e,n,r){return e.crossFadeFrom(this,n,r)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,n,r){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=s,l[1]=s+r,c[0]=e/a,c[1]=n/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,n,r,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*r;l<0||r===0?n=0:(this._startTime=null,n=r*l)}n*=this._updateTimeScale(e);const a=this._updateTime(n),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case yG:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(a),c[u].accumulateAdditive(o);break;case XP:default:for(let u=0,d=l.length;u!==d;++u)l[u].evaluate(a),c[u].accumulate(i,o)}}}_updateWeight(e){let n=0;if(this.enabled){n=this.weight;const r=this._weightInterpolant;if(r!==null){const i=r.evaluate(e)[0];n*=i,e>r.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(e){let n=0;if(!this.paused){n=this.timeScale;const r=this._timeScaleInterpolant;if(r!==null){const i=r.evaluate(e)[0];n*=i,e>r.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n)}}return this._effectiveTimeScale=n,n}_updateTime(e){const n=this._clip.duration,r=this.loop;let i=this.time+e,s=this._loopCount;const a=r===Bye;if(e===0)return s===-1?i:a&&(s&1)===1?n-i:i;if(r===jye){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=n)i=n;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=n||i<0){const o=Math.floor(i/n);i-=n*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?n:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return n-i}return i}_setEndings(e,n,r){const i=this._interpolantSettings;r?(i.endingStart=$m,i.endingEnd=$m):(e?i.endingStart=this.zeroSlopeAtStart?$m:Dm:i.endingStart=l_,n?i.endingEnd=this.zeroSlopeAtEnd?$m:Dm:i.endingEnd=l_)}_scheduleFading(e,n,r){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=n,o[1]=s+e,l[1]=r,this}}const z2t=new Float32Array(1);class B2t extends Th{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,n){const r=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,l=r.uuid,c=this._bindingsByRootAndName;let u=c[l];u===void 0&&(u={},c[l]=u);for(let d=0;d!==s;++d){const h=i[d],f=h.name;let p=u[f];if(p!==void 0)++p.referenceCount,a[d]=p;else{if(p=a[d],p!==void 0){p._cacheIndex===null&&(++p.referenceCount,this._addInactiveBinding(p,l,f));continue}const g=n&&n._propertyBindings[d].binding.parsedPath;p=new sxe(Kn.create(r,f,g),h.ValueTypeName,h.getValueSize()),++p.referenceCount,this._addInactiveBinding(p,l,f),a[d]=p}o[d].resultBuffer=p.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const r=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,r)}const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const n=e._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(e,n,r){const i=this._actions,s=this._actionsByClip;let a=s[n];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[n]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){const n=this._actions,r=n[n.length-1],i=e._cacheIndex;r._cacheIndex=i,n[i]=r,n.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,l[u]=c,l.pop(),e._byClipCacheIndex=null;const d=o.actionByRoot,h=(e._localRoot||this._root).uuid;delete d[h],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const n=e._propertyBindings;for(let r=0,i=n.length;r!==i;++r){const s=n[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const n=this._actions,r=e._cacheIndex,i=this._nActiveActions++,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_takeBackAction(e){const n=this._actions,r=e._cacheIndex,i=--this._nActiveActions,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_addInactiveBinding(e,n,r){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[n];a===void 0&&(a={},i[n]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const n=this._bindings,r=e.binding,i=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,o=a[i],l=n[n.length-1],c=e._cacheIndex;l._cacheIndex=c,n[c]=l,n.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const n=this._bindings,r=e._cacheIndex,i=this._nActiveBindings++,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_takeBackBinding(e){const n=this._bindings,r=e._cacheIndex,i=--this._nActiveBindings,s=n[i];e._cacheIndex=i,n[i]=e,s._cacheIndex=r,n[r]=s}_lendControlInterpolant(){const e=this._controlInterpolants,n=this._nActiveControlInterpolants++;let r=e[n];return r===void 0&&(r=new UG(new Float32Array(2),new Float32Array(2),1,z2t),r.__cacheIndex=n,e[n]=r),r}_takeBackControlInterpolant(e){const n=this._controlInterpolants,r=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=n[i];e.__cacheIndex=i,n[i]=e,s.__cacheIndex=r,n[r]=s}clipAction(e,n,r){const i=n||this._root,s=i.uuid;let a=typeof e=="string"?b_.findByName(i,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(r===void 0&&(a!==null?r=a.blendMode:r=XP),l!==void 0){const d=l.actionByRoot[s];if(d!==void 0&&d.blendMode===r)return d;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const u=new axe(this,a,n,r);return this._bindAction(u,c),this._addInactiveAction(u,o,s),u}existingAction(e,n){const r=n||this._root,i=r.uuid,s=typeof e=="string"?b_.findByName(r,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,n=this._nActiveActions;for(let r=n-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;const n=this._actions,r=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==r;++c)n[c]._update(i,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const n=this._actions,r=e.uuid,i=this._actionsByClip,s=i[r];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const u=c._cacheIndex,d=n[n.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,d._cacheIndex=u,n[u]=d,n.pop(),this._removeInactiveBindingsForAction(c)}delete i[r]}}uncacheRoot(e){const n=e.uuid,r=this._actionsByClip;for(const a in r){const o=r[a].actionByRoot,l=o[n];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[n];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,n){const r=this.existingAction(e,n);r!==null&&(this._deactivateAction(r),this._removeInactiveAction(r))}}class YG{constructor(e){this.value=e}clone(){return new YG(this.value.clone===void 0?this.value:this.value.clone())}}let U2t=0;class V2t extends Th{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:U2t++}),this.name="",this.usage=h_,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const n=this.uniforms.indexOf(e);return n!==-1&&this.uniforms.splice(n,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const n=e.uniforms;this.uniforms.length=0;for(let r=0,i=n.length;r<i;r++){const s=Array.isArray(n[r])?n[r]:[n[r]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}}class W2t extends eO{constructor(e,n,r=1){super(e,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const n=super.clone(e);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(e){const n=super.toJSON(e);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class H2t{constructor(e,n,r,i,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=n,this.itemSize=r,this.elementSize=i,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,n){return this.type=e,this.elementSize=n,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class oxe{constructor(e,n,r=0,i=1/0){this.ray=new Tb(e,n),this.near=r,this.far=i,this.camera=null,this.layers=new tg,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,n){this.ray.set(e,n)}setFromCamera(e,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(e,n=!0,r=[]){return tB(e,this,r,n),r.sort(Tee),r}intersectObjects(e,n=!0,r=[]){for(let i=0,s=e.length;i<s;i++)tB(e[i],this,r,n);return r.sort(Tee),r}}function Tee(t,e){return t.distance-e.distance}function tB(t,e,n,r){if(t.layers.test(e.layers)&&t.raycast(e,n),r===!0){const i=t.children;for(let s=0,a=i.length;s<a;s++)tB(i[s],e,n,!0)}}class G2t{constructor(e=1,n=0,r=0){return this.radius=e,this.phi=n,this.theta=r,this}set(e,n,r){return this.radius=e,this.phi=n,this.theta=r,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+n*n+r*r),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,r),this.phi=Math.acos(vi(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class q2t{constructor(e=1,n=0,r=0){return this.radius=e,this.theta=n,this.y=r,this}set(e,n,r){return this.radius=e,this.theta=n,this.y=r,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,n,r){return this.radius=Math.sqrt(e*e+r*r),this.theta=Math.atan2(e,r),this.y=n,this}clone(){return new this.constructor().copy(this)}}const Eee=new Xe;class X2t{constructor(e=new Xe(1/0,1/0),n=new Xe(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=n}set(e,n){return this.min.copy(e),this.max.copy(n),this}setFromPoints(e){this.makeEmpty();for(let n=0,r=e.length;n<r;n++)this.expandByPoint(e[n]);return this}setFromCenterAndSize(e,n){const r=Eee.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,n){return n.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,n){return n.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Eee).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Cee=new ne,u2=new ne;class K2t{constructor(e=new ne,n=new ne){this.start=e,this.end=n}set(e,n){return this.start.copy(e),this.end.copy(n),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,n){return this.delta(n).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,n){Cee.subVectors(e,this.start),u2.subVectors(this.end,this.start);const r=u2.dot(u2);let s=u2.dot(Cee)/r;return n&&(s=vi(s,0,1)),s}closestPointToPoint(e,n,r){const i=this.closestPointToPointParameter(e,n);return this.delta(r).multiplyScalar(i).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Nee=new ne;class Y2t extends tr{constructor(e,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="SpotLightHelper";const r=new Cn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,u=o/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(u),Math.sin(u),1)}r.setAttribute("position",new Mt(i,3));const s=new Ya({fog:!1,toneMapped:!1});this.cone=new ad(r,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,n=e*Math.tan(this.light.angle);this.cone.scale.set(n,n,e),Nee.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Nee),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const Wh=new ne,d2=new an,u3=new an;class Z2t extends ad{constructor(e){const n=lxe(e),r=new Cn,i=[],s=[],a=new xt(0,0,1),o=new xt(0,1,0);for(let c=0;c<n.length;c++){const u=n[c];u.parent&&u.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(a.r,a.g,a.b),s.push(o.r,o.g,o.b))}r.setAttribute("position",new Mt(i,3)),r.setAttribute("color",new Mt(s,3));const l=new Ya({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(r,l),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=n,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const n=this.bones,r=this.geometry,i=r.getAttribute("position");u3.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<n.length;s++){const o=n[s];o.parent&&o.parent.isBone&&(d2.multiplyMatrices(u3,o.matrixWorld),Wh.setFromMatrixPosition(d2),i.setXYZ(a,Wh.x,Wh.y,Wh.z),d2.multiplyMatrices(u3,o.parent.matrixWorld),Wh.setFromMatrixPosition(d2),i.setXYZ(a+1,Wh.x,Wh.y,Wh.z),a+=2)}r.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function lxe(t){const e=[];t.isBone===!0&&e.push(t);for(let n=0;n<t.children.length;n++)e.push.apply(e,lxe(t.children[n]));return e}class Q2t extends ls{constructor(e,n,r){const i=new bE(n,4,2),s=new Mp({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=r,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const J2t=new ne,Aee=new xt,Iee=new xt;class eAt extends tr{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="HemisphereLightHelper";const i=new xE(n);i.rotateY(Math.PI*.5),this.material=new Mp({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new mr(a,3)),this.add(new ls(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=e.geometry.getAttribute("color");Aee.copy(this.light.color),Iee.copy(this.light.groundColor);for(let r=0,i=n.count;r<i;r++){const s=r<i/2?Aee:Iee;n.setXYZ(r,s.r,s.g,s.b)}n.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(J2t.setFromMatrixPosition(this.light.matrixWorld).negate())}}class tAt extends ad{constructor(e=10,n=10,r=4473924,i=8947848){r=new xt(r),i=new xt(i);const s=n/2,a=e/n,o=e/2,l=[],c=[];for(let h=0,f=0,p=-o;h<=n;h++,p+=a){l.push(-o,0,p,o,0,p),l.push(p,0,-o,p,0,o);const g=h===s?r:i;g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3,g.toArray(c,f),f+=3}const u=new Cn;u.setAttribute("position",new Mt(l,3)),u.setAttribute("color",new Mt(c,3));const d=new Ya({vertexColors:!0,toneMapped:!1});super(u,d),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class nAt extends ad{constructor(e=10,n=16,r=8,i=64,s=4473924,a=8947848){s=new xt(s),a=new xt(a);const o=[],l=[];if(n>1)for(let d=0;d<n;d++){const h=d/n*(Math.PI*2),f=Math.sin(h)*e,p=Math.cos(h)*e;o.push(0,0,0),o.push(f,0,p);const g=d&1?s:a;l.push(g.r,g.g,g.b),l.push(g.r,g.g,g.b)}for(let d=0;d<r;d++){const h=d&1?s:a,f=e-e/r*d;for(let p=0;p<i;p++){let g=p/i*(Math.PI*2),m=Math.sin(g)*f,y=Math.cos(g)*f;o.push(m,0,y),l.push(h.r,h.g,h.b),g=(p+1)/i*(Math.PI*2),m=Math.sin(g)*f,y=Math.cos(g)*f,o.push(m,0,y),l.push(h.r,h.g,h.b)}}const c=new Cn;c.setAttribute("position",new Mt(o,3)),c.setAttribute("color",new Mt(l,3));const u=new Ya({vertexColors:!0,toneMapped:!1});super(c,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const kee=new ne,h2=new ne,Mee=new ne;class rAt extends tr{constructor(e,n,r){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,this.type="DirectionalLightHelper",n===void 0&&(n=1);let i=new Cn;i.setAttribute("position",new Mt([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new Ya({fog:!1,toneMapped:!1});this.lightPlane=new np(i,s),this.add(this.lightPlane),i=new Cn,i.setAttribute("position",new Mt([0,0,0,0,0,1],3)),this.targetLine=new np(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),kee.setFromMatrixPosition(this.light.matrixWorld),h2.setFromMatrixPosition(this.light.target.matrixWorld),Mee.subVectors(h2,kee),this.lightPlane.lookAt(h2),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(h2),this.targetLine.scale.z=Mee.length()}}const f2=new ne,pi=new fE;class iAt extends ad{constructor(e){const n=new Cn,r=new Ya({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(p,g){l(p),l(g)}function l(p){i.push(0,0,0),s.push(0,0,0),a[p]===void 0&&(a[p]=[]),a[p].push(i.length/3-1)}n.setAttribute("position",new Mt(i,3)),n.setAttribute("color",new Mt(s,3)),super(n,r),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new xt(16755200),u=new xt(16711680),d=new xt(43775),h=new xt(16777215),f=new xt(3355443);this.setColors(c,u,d,h,f)}setColors(e,n,r,i,s){const o=this.geometry.getAttribute("color");o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,n.r,n.g,n.b),o.setXYZ(25,n.r,n.g,n.b),o.setXYZ(26,n.r,n.g,n.b),o.setXYZ(27,n.r,n.g,n.b),o.setXYZ(28,n.r,n.g,n.b),o.setXYZ(29,n.r,n.g,n.b),o.setXYZ(30,n.r,n.g,n.b),o.setXYZ(31,n.r,n.g,n.b),o.setXYZ(32,r.r,r.g,r.b),o.setXYZ(33,r.r,r.g,r.b),o.setXYZ(34,r.r,r.g,r.b),o.setXYZ(35,r.r,r.g,r.b),o.setXYZ(36,r.r,r.g,r.b),o.setXYZ(37,r.r,r.g,r.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0}update(){const e=this.geometry,n=this.pointMap,r=1,i=1;pi.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Ni("c",n,e,pi,0,0,-1),Ni("t",n,e,pi,0,0,1),Ni("n1",n,e,pi,-1,-1,-1),Ni("n2",n,e,pi,r,-1,-1),Ni("n3",n,e,pi,-1,i,-1),Ni("n4",n,e,pi,r,i,-1),Ni("f1",n,e,pi,-1,-1,1),Ni("f2",n,e,pi,r,-1,1),Ni("f3",n,e,pi,-1,i,1),Ni("f4",n,e,pi,r,i,1),Ni("u1",n,e,pi,r*.7,i*1.1,-1),Ni("u2",n,e,pi,-1*.7,i*1.1,-1),Ni("u3",n,e,pi,0,i*2,-1),Ni("cf1",n,e,pi,-1,0,1),Ni("cf2",n,e,pi,r,0,1),Ni("cf3",n,e,pi,0,-1,1),Ni("cf4",n,e,pi,0,i,1),Ni("cn1",n,e,pi,-1,0,-1),Ni("cn2",n,e,pi,r,0,-1),Ni("cn3",n,e,pi,0,-1,-1),Ni("cn4",n,e,pi,0,i,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Ni(t,e,n,r,i,s,a){f2.set(i,s,a).unproject(r);const o=e[t];if(o!==void 0){const l=n.getAttribute("position");for(let c=0,u=o.length;c<u;c++)l.setXYZ(o[c],f2.x,f2.y,f2.z)}}const p2=new Va;class sAt extends ad{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(8*3),s=new Cn;s.setIndex(new mr(r,1)),s.setAttribute("position",new mr(i,3)),super(s,new Ya({color:n,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&p2.setFromObject(this.object),p2.isEmpty())return;const n=p2.min,r=p2.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=n.x,s[4]=r.y,s[5]=r.z,s[6]=n.x,s[7]=n.y,s[8]=r.z,s[9]=r.x,s[10]=n.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=n.z,s[15]=n.x,s[16]=r.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=r.x,s[22]=n.y,s[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,n){return super.copy(e,n),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class aAt extends ad{constructor(e,n=16776960){const r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Cn;s.setIndex(new mr(r,1)),s.setAttribute("position",new Mt(i,3)),super(s,new Ya({color:n,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class oAt extends np{constructor(e,n=1,r=16776960){const i=r,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Cn;a.setAttribute("position",new Mt(s,3)),a.computeBoundingSphere(),super(a,new Ya({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=n;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Cn;l.setAttribute("position",new Mt(o,3)),l.computeBoundingSphere(),this.add(new ls(l,new Mp({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const Ree=new ne;let m2,d3;class lAt extends tr{constructor(e=new ne(0,0,1),n=new ne(0,0,0),r=1,i=16776960,s=r*.2,a=s*.2){super(),this.type="ArrowHelper",m2===void 0&&(m2=new Cn,m2.setAttribute("position",new Mt([0,0,0,0,1,0],3)),d3=new Cb(0,.5,1,5,1),d3.translate(0,-.5,0)),this.position.copy(n),this.line=new np(m2,new Ya({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ls(d3,new Mp({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(r,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{Ree.set(e.z,0,-e.x).normalize();const n=Math.acos(e.y);this.quaternion.setFromAxisAngle(Ree,n)}}setLength(e,n=e*.2,r=n*.2){this.line.scale.set(1,Math.max(1e-4,e-n),1),this.line.updateMatrix(),this.cone.scale.set(r,n,r),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class cAt extends ad{constructor(e=1){const n=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],r=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Cn;i.setAttribute("position",new Mt(n,3)),i.setAttribute("color",new Mt(r,3));const s=new Ya({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,n,r){const i=new xt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(n),i.toArray(s,6),i.toArray(s,9),i.set(r),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class uAt{constructor(){this.type="ShapePath",this.color=new xt,this.subPaths=[],this.currentPath=null}moveTo(e,n){return this.currentPath=new p_,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,n),this}lineTo(e,n){return this.currentPath.lineTo(e,n),this}quadraticCurveTo(e,n,r,i){return this.currentPath.quadraticCurveTo(e,n,r,i),this}bezierCurveTo(e,n,r,i,s,a){return this.currentPath.bezierCurveTo(e,n,r,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function n(y){const x=[];for(let b=0,_=y.length;b<_;b++){const T=y[b],E=new rg;E.curves=T.curves,x.push(E)}return x}function r(y,x){const b=x.length;let _=!1;for(let T=b-1,E=0;E<b;T=E++){let C=x[T],I=x[E],A=I.x-C.x,k=I.y-C.y;if(Math.abs(k)>Number.EPSILON){if(k<0&&(C=x[E],A=-A,I=x[T],k=-k),y.y<C.y||y.y>I.y)continue;if(y.y===C.y){if(y.x===C.x)return!0}else{const R=k*(y.x-C.x)-A*(y.y-C.y);if(R===0)return!0;if(R<0)continue;_=!_}}else{if(y.y!==C.y)continue;if(I.x<=y.x&&y.x<=C.x||C.x<=y.x&&y.x<=I.x)return!0}}return _}const i=Uu.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const c=[];if(s.length===1)return o=s[0],l=new rg,l.curves=o.curves,c.push(l),c;let u=!i(s[0].getPoints());u=e?!u:u;const d=[],h=[];let f=[],p=0,g;h[p]=void 0,f[p]=[];for(let y=0,x=s.length;y<x;y++)o=s[y],g=o.getPoints(),a=i(g),a=e?!a:a,a?(!u&&h[p]&&p++,h[p]={s:new rg,p:g},h[p].s.curves=o.curves,u&&p++,f[p]=[]):f[p].push({h:o,p:g[0]});if(!h[0])return n(s);if(h.length>1){let y=!1,x=0;for(let b=0,_=h.length;b<_;b++)d[b]=[];for(let b=0,_=h.length;b<_;b++){const T=f[b];for(let E=0;E<T.length;E++){const C=T[E];let I=!0;for(let A=0;A<h.length;A++)r(C.p,h[A].p)&&(b!==A&&x++,I?(I=!1,d[A].push(C)):y=!0);I&&d[b].push(C)}}x>0&&y===!1&&(f=d)}let m;for(let y=0,x=h.length;y<x;y++){l=h[y].s,c.push(l),m=f[y];for(let b=0,_=m.length;b<_;b++)l.holes.push(m[b].h)}return c}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:WP}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=WP);const dAt=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:lG,AddEquation:rf,AddOperation:Tye,AdditiveAnimationBlendMode:yG,AdditiveBlending:p4,AgXToneMapping:Iye,AlphaFormat:Pye,AlwaysCompare:Zye,AlwaysDepth:yye,AlwaysStencilFunc:H4,AmbientLight:Qve,AnimationAction:axe,AnimationClip:b_,AnimationLoader:h2t,AnimationMixer:B2t,AnimationObjectGroup:j2t,AnimationUtils:l2t,ArcCurve:_ve,ArrayCamera:fve,ArrowHelper:lAt,AttachedBindMode:x4,Audio:ixe,AudioAnalyser:I2t,AudioContext:GG,AudioListener:C2t,AudioLoader:_2t,AxesHelper:cAt,BackSide:Ua,BasicDepthPacking:Uye,BasicShadowMap:Jge,BatchedMesh:bve,Bone:RG,BooleanKeyframeTrack:cy,Box2:X2t,Box3:Va,Box3Helper:aAt,BoxGeometry:ly,BoxHelper:sAt,BufferAttribute:mr,BufferGeometry:Cn,BufferGeometryLoader:rxe,ByteType:Mye,Cache:zd,Camera:fE,CameraHelper:iAt,CanvasTexture:RNt,CapsuleGeometry:iO,CatmullRomCurve3:Tve,CineonToneMapping:Nye,CircleGeometry:sO,ClampToEdgeWrapping:pa,Clock:qG,Color:xt,ColorKeyframeTrack:VG,ColorManagement:dr,CompressedArrayTexture:kNt,CompressedCubeTexture:MNt,CompressedTexture:nO,CompressedTextureLoader:f2t,ConeGeometry:aO,ConstantAlphaFactor:pye,ConstantColorFactor:hye,CubeCamera:ive,CubeReflectionMapping:hh,CubeRefractionMapping:ep,CubeTexture:pE,CubeTextureLoader:p2t,CubeUVReflectionMapping:_b,CubicBezierCurve:DG,CubicBezierCurve3:Eve,CubicInterpolant:Wve,CullFaceBack:f4,CullFaceFront:Qge,CullFaceFrontBack:x1t,CullFaceNone:Zge,Curve:nu,CurvePath:Nve,CustomBlending:eye,CustomToneMapping:Aye,CylinderGeometry:Cb,Cylindrical:q2t,Data3DTexture:SG,DataArrayTexture:YP,DataTexture:ng,DataTextureLoader:m2t,DataUtils:ISt,DecrementStencilOp:M1t,DecrementWrapStencilOp:P1t,DefaultLoadingManager:qve,DepthFormat:Of,DepthStencilFormat:zg,DepthTexture:CG,DetachedBindMode:kye,DirectionalLight:Zve,DirectionalLightHelper:rAt,DiscreteInterpolant:Hve,DisplayP3ColorSpace:KP,DodecahedronGeometry:oO,DoubleSide:Cu,DstAlphaFactor:oye,DstColorFactor:cye,DynamicCopyUsage:X1t,DynamicDrawUsage:U1t,DynamicReadUsage:H1t,EdgesGeometry:Ave,EllipseCurve:rO,EqualCompare:qye,EqualDepth:xye,EqualStencilFunc:L1t,EquirectangularReflectionMapping:n_,EquirectangularRefractionMapping:r_,Euler:hE,EventDispatcher:Th,ExtrudeGeometry:cO,FileLoader:fh,Float16BufferAttribute:DSt,Float32BufferAttribute:Mt,Float64BufferAttribute:$St,FloatType:Pc,Fog:JP,FogExp2:QP,FramebufferTexture:INt,FrontSide:dh,Frustum:mE,GLBufferAttribute:H2t,GLSL1:Y1t,GLSL3:G4,GreaterCompare:Xye,GreaterDepth:wye,GreaterEqualCompare:Yye,GreaterEqualDepth:bye,GreaterEqualStencilFunc:B1t,GreaterStencilFunc:j1t,GridHelper:tAt,Group:Uv,HalfFloatType:N0,HemisphereLight:Xve,HemisphereLightHelper:eAt,IcosahedronGeometry:uO,ImageBitmapLoader:S2t,ImageLoader:w_,ImageUtils:wG,IncrementStencilOp:k1t,IncrementWrapStencilOp:R1t,InstancedBufferAttribute:M0,InstancedBufferGeometry:nxe,InstancedInterleavedBuffer:W2t,InstancedMesh:xve,Int16BufferAttribute:PSt,Int32BufferAttribute:OSt,Int8BufferAttribute:kSt,IntType:uG,InterleavedBuffer:eO,InterleavedBufferAttribute:Bg,Interpolant:wE,InterpolateDiscrete:a_,InterpolateLinear:o_,InterpolateSmooth:Q2,InvertStencilOp:O1t,KeepStencilOp:pm,KeyframeTrack:ru,LOD:yve,LatheGeometry:vE,Layers:tg,LessCompare:Gye,LessDepth:vye,LessEqualCompare:xG,LessEqualDepth:t_,LessEqualStencilFunc:F1t,LessStencilFunc:$1t,Light:Pp,LightProbe:txe,Line:np,Line3:K2t,LineBasicMaterial:Ya,LineCurve:$G,LineCurve3:Cve,LineDashedMaterial:Bve,LineLoop:wve,LineSegments:ad,LinearDisplayP3ColorSpace:dE,LinearEncoding:vG,LinearFilter:Ri,LinearInterpolant:UG,LinearMipMapLinearFilter:T1t,LinearMipMapNearestFilter:_1t,LinearMipmapLinearFilter:tp,LinearMipmapNearestFilter:cG,LinearSRGBColorSpace:Qu,LinearToneMapping:Eye,LinearTransfer:c_,Loader:Ao,LoaderUtils:eB,LoadingManager:WG,LoopOnce:jye,LoopPingPong:Bye,LoopRepeat:zye,LuminanceAlphaFormat:Dye,LuminanceFormat:Oye,MOUSE:y1t,Material:_a,MaterialLoader:yO,MathUtils:dSt,Matrix3:Tn,Matrix4:an,MaxEquation:v4,Mesh:ls,MeshBasicMaterial:Mp,MeshDepthMaterial:NG,MeshDistanceMaterial:AG,MeshLambertMaterial:jve,MeshMatcapMaterial:zve,MeshNormalMaterial:Fve,MeshPhongMaterial:$ve,MeshPhysicalMaterial:Dve,MeshStandardMaterial:zG,MeshToonMaterial:Lve,MinEquation:y4,MirroredRepeatWrapping:s_,MixOperation:_ye,MultiplyBlending:g4,MultiplyOperation:uE,NearestFilter:Ii,NearestMipMapLinearFilter:S1t,NearestMipMapNearestFilter:w1t,NearestMipmapLinearFilter:b1,NearestMipmapNearestFilter:gk,NeverCompare:Hye,NeverDepth:gye,NeverStencilFunc:D1t,NoBlending:Xd,NoColorSpace:Wo,NoToneMapping:zu,NormalAnimationBlendMode:XP,NormalBlending:Jm,NotEqualCompare:Kye,NotEqualDepth:Sye,NotEqualStencilFunc:z1t,NumberKeyframeTrack:v_,Object3D:tr,ObjectLoader:b2t,ObjectSpaceNormalMap:Wye,OctahedronGeometry:xE,OneFactor:iye,OneMinusConstantAlphaFactor:mye,OneMinusConstantColorFactor:fye,OneMinusDstAlphaFactor:lye,OneMinusDstColorFactor:uye,OneMinusSrcAlphaFactor:mk,OneMinusSrcColorFactor:aye,OrthographicCamera:yE,P3Primaries:d_,PCFShadowMap:HP,PCFSoftShadowMap:x1,PMREMGenerator:X4,Path:p_,PerspectiveCamera:Ts,Plane:Qh,PlaneGeometry:gE,PlaneHelper:oAt,PointLight:Yve,PointLightHelper:Q2t,Points:Sve,PointsMaterial:PG,PolarGridHelper:nAt,PolyhedronGeometry:Rp,PositionalAudio:A2t,PropertyBinding:Kn,PropertyMixer:sxe,QuadraticBezierCurve:LG,QuadraticBezierCurve3:FG,Quaternion:xo,QuaternionKeyframeTrack:Nb,QuaternionLinearInterpolant:Gve,RED_GREEN_RGTC2_Format:V4,RED_RGTC1_Format:Fye,REVISION:WP,RGBADepthPacking:Vye,RGBAFormat:ja,RGBAIntegerFormat:mG,RGBA_ASTC_10x10_Format:L4,RGBA_ASTC_10x5_Format:O4,RGBA_ASTC_10x6_Format:D4,RGBA_ASTC_10x8_Format:$4,RGBA_ASTC_12x10_Format:F4,RGBA_ASTC_12x12_Format:j4,RGBA_ASTC_4x4_Format:C4,RGBA_ASTC_5x4_Format:N4,RGBA_ASTC_5x5_Format:A4,RGBA_ASTC_6x5_Format:I4,RGBA_ASTC_6x6_Format:k4,RGBA_ASTC_8x5_Format:M4,RGBA_ASTC_8x6_Format:R4,RGBA_ASTC_8x8_Format:P4,RGBA_BPTC_Format:Z2,RGBA_ETC2_EAC_Format:E4,RGBA_PVRTC_2BPPV1_Format:_4,RGBA_PVRTC_4BPPV1_Format:S4,RGBA_S3TC_DXT1_Format:X2,RGBA_S3TC_DXT3_Format:K2,RGBA_S3TC_DXT5_Format:Y2,RGB_BPTC_SIGNED_Format:z4,RGB_BPTC_UNSIGNED_Format:B4,RGB_ETC1_Format:gG,RGB_ETC2_Format:T4,RGB_PVRTC_2BPPV1_Format:w4,RGB_PVRTC_4BPPV1_Format:b4,RGB_S3TC_DXT1_Format:q2,RGFormat:Lye,RGIntegerFormat:pG,RawShaderMaterial:Ove,Ray:Tb,Raycaster:oxe,Rec709Primaries:u_,RectAreaLight:Jve,RedFormat:$ye,RedIntegerFormat:fG,ReinhardToneMapping:Cye,RenderTarget:eve,RepeatWrapping:i_,ReplaceStencilOp:I1t,ReverseSubtractEquation:nye,RingGeometry:dO,SIGNED_RED_GREEN_RGTC2_Format:W4,SIGNED_RED_RGTC1_Format:U4,SRGBColorSpace:rs,SRGBTransfer:kr,Scene:kG,ShaderChunk:xn,ShaderLib:Tc,ShaderMaterial:Ju,ShadowMaterial:Pve,Shape:rg,ShapeGeometry:hO,ShapePath:uAt,ShapeUtils:Uu,ShortType:Rye,Skeleton:tO,SkeletonHelper:Z2t,SkinnedMesh:vve,Source:Lm,Sphere:ga,SphereGeometry:bE,Spherical:G2t,SphericalHarmonics3:exe,SplineCurve:jG,SpotLight:Kve,SpotLightHelper:Y2t,Sprite:gve,SpriteMaterial:MG,SrcAlphaFactor:pk,SrcAlphaSaturateFactor:dye,SrcColorFactor:sye,StaticCopyUsage:q1t,StaticDrawUsage:h_,StaticReadUsage:W1t,StereoCamera:T2t,StreamCopyUsage:K1t,StreamDrawUsage:V1t,StreamReadUsage:G1t,StringKeyframeTrack:uy,SubtractEquation:tye,SubtractiveBlending:m4,TOUCH:v1t,TangentSpaceNormalMap:kp,TetrahedronGeometry:fO,Texture:$i,TextureLoader:g2t,TorusGeometry:pO,TorusKnotGeometry:mO,Triangle:oo,TriangleFanDrawMode:N1t,TriangleStripDrawMode:C1t,TrianglesDrawMode:E1t,TubeGeometry:gO,TwoPassDoubleSide:b1t,UVMapping:GP,Uint16BufferAttribute:_G,Uint32BufferAttribute:TG,Uint8BufferAttribute:MSt,Uint8ClampedBufferAttribute:RSt,Uniform:YG,UniformsGroup:V2t,UniformsLib:at,UniformsUtils:rve,UnsignedByteType:Bu,UnsignedInt248Type:Pf,UnsignedIntType:jd,UnsignedShort4444Type:dG,UnsignedShort5551Type:hG,UnsignedShortType:qP,VSMShadowMap:mc,Vector2:Xe,Vector3:ne,Vector4:hr,VectorKeyframeTrack:x_,VideoTexture:ANt,WebGL1Renderer:pve,WebGL3DRenderTarget:ySt,WebGLArrayRenderTarget:gSt,WebGLCoordinateSystem:Oc,WebGLCubeRenderTarget:sve,WebGLMultipleRenderTargets:vSt,WebGLRenderTarget:Kc,WebGLRenderer:IG,WebGLUtils:hve,WebGPUCoordinateSystem:A0,WireframeGeometry:Rve,WrapAroundEnding:l_,ZeroCurvatureEnding:Dm,ZeroFactor:rye,ZeroSlopeEnding:$m,ZeroStencilOp:A1t,_SRGBAFormat:yk,createCanvasElement:Jye,sRGBEncoding:Df},Symbol.toStringTag,{value:"Module"}));var cxe={exports:{}},dy={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */dy.ConcurrentRoot=1;dy.ContinuousEventPriority=4;dy.DefaultEventPriority=16;dy.DiscreteEventPriority=1;dy.IdleEventPriority=536870912;dy.LegacyRoot=0;cxe.exports=dy;var Wv=cxe.exports;function hAt(t){let e;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(e):c;if(d!==e){const h=e;e=u?d:Object.assign({},e,d),n.forEach(f=>f(e,h))}},i=()=>e,s=(c,u=i,d=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let h=u(e);function f(){const p=u(e);if(!d(h,p)){const g=h;c(h=p,g)}}return n.add(f),()=>n.delete(f)},l={setState:r,getState:i,subscribe:(c,u,d)=>u||d?s(c,u,d):(n.add(c),()=>n.delete(c)),destroy:()=>n.clear()};return e=t(r,i,l),l}const fAt=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Pee=fAt?P.useEffect:P.useLayoutEffect;function pAt(t){const e=typeof t=="function"?hAt(t):t,n=(r=e.getState,i=Object.is)=>{const[,s]=P.useReducer(m=>m+1,0),a=e.getState(),o=P.useRef(a),l=P.useRef(r),c=P.useRef(i),u=P.useRef(!1),d=P.useRef();d.current===void 0&&(d.current=r(a));let h,f=!1;(o.current!==a||l.current!==r||c.current!==i||u.current)&&(h=r(a),f=!i(d.current,h)),Pee(()=>{f&&(d.current=h),o.current=a,l.current=r,c.current=i,u.current=!1});const p=P.useRef(a);Pee(()=>{const m=()=>{try{const x=e.getState(),b=l.current(x);c.current(d.current,b)||(o.current=x,d.current=b,s())}catch{u.current=!0,s()}},y=e.subscribe(m);return e.getState()!==p.current&&m(),y},[]);const g=f?h:d.current;return P.useDebugValue(g),g};return Object.assign(n,e),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,e];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}var uxe={exports:{}},dxe={exports:{}},hxe={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(L,V){var H=L.length;L.push(V);e:for(;0<H;){var K=H-1>>>1,te=L[K];if(0<i(te,V))L[K]=V,L[H]=te,H=K;else break e}}function n(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var V=L[0],H=L.pop();if(H!==V){L[0]=H;e:for(var K=0,te=L.length,J=te>>>1;K<J;){var oe=2*(K+1)-1,fe=L[oe],Ee=oe+1,me=L[Ee];if(0>i(fe,H))Ee<te&&0>i(me,fe)?(L[K]=me,L[Ee]=H,K=Ee):(L[K]=fe,L[oe]=H,K=oe);else if(Ee<te&&0>i(me,H))L[K]=me,L[Ee]=H,K=Ee;else break e}}return V}function i(L,V){var H=L.sortIndex-V.sortIndex;return H!==0?H:L.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,g=!1,m=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,x=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(L){for(var V=n(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=L)r(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=n(c)}}function _(L){if(g=!1,b(L),!p)if(n(l)!==null)p=!0,B(T);else{var V=n(c);V!==null&&W(_,V.startTime-L)}}function T(L,V){p=!1,g&&(g=!1,y(I),I=-1),f=!0;var H=h;try{for(b(V),d=n(l);d!==null&&(!(d.expirationTime>V)||L&&!R());){var K=d.callback;if(typeof K=="function"){d.callback=null,h=d.priorityLevel;var te=K(d.expirationTime<=V);V=t.unstable_now(),typeof te=="function"?d.callback=te:d===n(l)&&r(l),b(V)}else r(l);d=n(l)}if(d!==null)var J=!0;else{var oe=n(c);oe!==null&&W(_,oe.startTime-V),J=!1}return J}finally{d=null,h=H,f=!1}}var E=!1,C=null,I=-1,A=5,k=-1;function R(){return!(t.unstable_now()-k<A)}function $(){if(C!==null){var L=t.unstable_now();k=L;var V=!0;try{V=C(!0,L)}finally{V?z():(E=!1,C=null)}}else E=!1}var z;if(typeof x=="function")z=function(){x($)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,j=O.port2;O.port1.onmessage=$,z=function(){j.postMessage(null)}}else z=function(){m($,0)};function B(L){C=L,E||(E=!0,z())}function W(L,V){I=m(function(){L(t.unstable_now())},V)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,B(T))},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(L){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var H=h;h=V;try{return L()}finally{h=H}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(L,V){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var H=h;h=L;try{return V()}finally{h=H}},t.unstable_scheduleCallback=function(L,V,H){var K=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?K+H:K):H=K,L){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=H+te,L={id:u++,callback:V,priorityLevel:L,startTime:H,expirationTime:te,sortIndex:-1},H>K?(L.sortIndex=H,e(c,L),n(l)===null&&L===n(c)&&(g?(y(I),I=-1):g=!0,W(_,H-K))):(L.sortIndex=te,e(l,L),p||f||(p=!0,B(T))),L},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(L){var V=h;return function(){var H=h;h=V;try{return L.apply(this,arguments)}finally{h=H}}}})(hxe);dxe.exports=hxe;var nB=dxe.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mAt=function(e){var n={},r=P,i=nB,s=Object.assign;function a(w){for(var S="https://reactjs.org/docs/error-decoder.html?invariant="+w,N=1;N<arguments.length;N++)S+="&args[]="+encodeURIComponent(arguments[N]);return"Minified React error #"+w+"; visit "+S+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,l=Symbol.for("react.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),d=Symbol.for("react.strict_mode"),h=Symbol.for("react.profiler"),f=Symbol.for("react.provider"),p=Symbol.for("react.context"),g=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),b=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),T=Symbol.iterator;function E(w){return w===null||typeof w!="object"?null:(w=T&&w[T]||w["@@iterator"],typeof w=="function"?w:null)}function C(w){if(w==null)return null;if(typeof w=="function")return w.displayName||w.name||null;if(typeof w=="string")return w;switch(w){case u:return"Fragment";case c:return"Portal";case h:return"Profiler";case d:return"StrictMode";case m:return"Suspense";case y:return"SuspenseList"}if(typeof w=="object")switch(w.$$typeof){case p:return(w.displayName||"Context")+".Consumer";case f:return(w._context.displayName||"Context")+".Provider";case g:var S=w.render;return w=w.displayName,w||(w=S.displayName||S.name||"",w=w!==""?"ForwardRef("+w+")":"ForwardRef"),w;case x:return S=w.displayName||null,S!==null?S:C(w.type)||"Memo";case b:S=w._payload,w=w._init;try{return C(w(S))}catch{}}return null}function I(w){var S=w.type;switch(w.tag){case 24:return"Cache";case 9:return(S.displayName||"Context")+".Consumer";case 10:return(S._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return w=S.render,w=w.displayName||w.name||"",S.displayName||(w!==""?"ForwardRef("+w+")":"ForwardRef");case 7:return"Fragment";case 5:return S;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return C(S);case 8:return S===d?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof S=="function")return S.displayName||S.name||null;if(typeof S=="string")return S}return null}function A(w){var S=w,N=w;if(w.alternate)for(;S.return;)S=S.return;else{w=S;do S=w,S.flags&4098&&(N=S.return),w=S.return;while(w)}return S.tag===3?N:null}function k(w){if(A(w)!==w)throw Error(a(188))}function R(w){var S=w.alternate;if(!S){if(S=A(w),S===null)throw Error(a(188));return S!==w?null:w}for(var N=w,M=S;;){var D=N.return;if(D===null)break;var U=D.alternate;if(U===null){if(M=D.return,M!==null){N=M;continue}break}if(D.child===U.child){for(U=D.child;U;){if(U===N)return k(D),w;if(U===M)return k(D),S;U=U.sibling}throw Error(a(188))}if(N.return!==M.return)N=D,M=U;else{for(var re=!1,be=D.child;be;){if(be===N){re=!0,N=D,M=U;break}if(be===M){re=!0,M=D,N=U;break}be=be.sibling}if(!re){for(be=U.child;be;){if(be===N){re=!0,N=U,M=D;break}if(be===M){re=!0,M=U,N=D;break}be=be.sibling}if(!re)throw Error(a(189))}}if(N.alternate!==M)throw Error(a(190))}if(N.tag!==3)throw Error(a(188));return N.stateNode.current===N?w:S}function $(w){return w=R(w),w!==null?z(w):null}function z(w){if(w.tag===5||w.tag===6)return w;for(w=w.child;w!==null;){var S=z(w);if(S!==null)return S;w=w.sibling}return null}function O(w){if(w.tag===5||w.tag===6)return w;for(w=w.child;w!==null;){if(w.tag!==4){var S=O(w);if(S!==null)return S}w=w.sibling}return null}var j=Array.isArray,B=e.getPublicInstance,W=e.getRootHostContext,L=e.getChildHostContext,V=e.prepareForCommit,H=e.resetAfterCommit,K=e.createInstance,te=e.appendInitialChild,J=e.finalizeInitialChildren,oe=e.prepareUpdate,fe=e.shouldSetTextContent,Ee=e.createTextInstance,me=e.scheduleTimeout,De=e.cancelTimeout,ge=e.noTimeout,_e=e.isPrimaryRenderer,Ce=e.supportsMutation,G=e.supportsPersistence,ke=e.supportsHydration,xe=e.getInstanceFromNode,Pe=e.preparePortalMount,Te=e.getCurrentEventPriority,Ye=e.detachDeletedInstance,qe=e.supportsMicrotasks,Q=e.scheduleMicrotask,X=e.supportsTestSelectors,we=e.findFiberRoot,Z=e.getBoundingRect,ie=e.getTextContent,ae=e.isHiddenSubtree,Le=e.matchAccessibilityRole,Ae=e.setFocusIfFocusable,Ie=e.setupIntersectionObserver,Ge=e.appendChild,rt=e.appendChildToContainer,We=e.commitTextUpdate,Ut=e.commitMount,hn=e.commitUpdate,Vt=e.insertBefore,Ot=e.insertInContainerBefore,bt=e.removeChild,ln=e.removeChildFromContainer,Hn=e.resetTextContent,Tr=e.hideInstance,Sn=e.hideTextInstance,it=e.unhideInstance,pe=e.unhideTextInstance,dt=e.clearContainer,ht=e.cloneInstance,Zt=e.createContainerChildSet,Ht=e.appendChildToContainerChildSet,vr=e.finalizeContainerChildren,ur=e.replaceContainerChildren,Ti=e.cloneHiddenInstance,ms=e.cloneHiddenTextInstance,xr=e.canHydrateInstance,Ds=e.canHydrateTextInstance,ol=e.canHydrateSuspenseInstance,kb=e.isSuspenseInstancePending,Mb=e.isSuspenseInstanceFallback,py=e.registerSuspenseInstanceRetry,Eh=e.getNextHydratableSibling,my=e.getFirstHydratableChild,ME=e.getFirstHydratableChildWithinContainer,RE=e.getFirstHydratableChildWithinSuspenseInstance,MO=e.hydrateInstance,RO=e.hydrateTextInstance,PO=e.hydrateSuspenseInstance,ee=e.getNextHydratableInstanceAfterSuspenseInstance,Ne=e.commitHydratedContainer,Fe=e.commitHydratedSuspenseInstance,ze=e.clearSuspenseBoundary,$e=e.clearSuspenseBoundaryFromContainer,yt=e.shouldDeleteUnhydratedTailInstances,jt=e.didNotMatchHydratedContainerTextInstance,qt=e.didNotMatchHydratedTextInstance,Qt;function cn(w){if(Qt===void 0)try{throw Error()}catch(N){var S=N.stack.trim().match(/\n( *(at )?)/);Qt=S&&S[1]||""}return`
`+Qt+w}var on=!1;function un(w,S){if(!w||on)return"";on=!0;var N=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(S)if(S=function(){throw Error()},Object.defineProperty(S.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(S,[])}catch(Je){var M=Je}Reflect.construct(w,[],S)}else{try{S.call()}catch(Je){M=Je}w.call(S.prototype)}else{try{throw Error()}catch(Je){M=Je}w()}}catch(Je){if(Je&&M&&typeof Je.stack=="string"){for(var D=Je.stack.split(`
`),U=M.stack.split(`
`),re=D.length-1,be=U.length-1;1<=re&&0<=be&&D[re]!==U[be];)be--;for(;1<=re&&0<=be;re--,be--)if(D[re]!==U[be]){if(re!==1||be!==1)do if(re--,be--,0>be||D[re]!==U[be]){var Ue=`
`+D[re].replace(" at new "," at ");return w.displayName&&Ue.includes("<anonymous>")&&(Ue=Ue.replace("<anonymous>",w.displayName)),Ue}while(1<=re&&0<=be);break}}}finally{on=!1,Error.prepareStackTrace=N}return(w=w?w.displayName||w.name:"")?cn(w):""}var ei=Object.prototype.hasOwnProperty,$s=[],$r=-1;function gs(w){return{current:w}}function Jt(w){0>$r||(w.current=$s[$r],$s[$r]=null,$r--)}function _t(w,S){$r++,$s[$r]=w.current,w.current=S}var ll={},In=gs(ll),hi=gs(!1),su=ll;function cl(w,S){var N=w.type.contextTypes;if(!N)return ll;var M=w.stateNode;if(M&&M.__reactInternalMemoizedUnmaskedChildContext===S)return M.__reactInternalMemoizedMaskedChildContext;var D={},U;for(U in N)D[U]=S[U];return M&&(w=w.stateNode,w.__reactInternalMemoizedUnmaskedChildContext=S,w.__reactInternalMemoizedMaskedChildContext=D),D}function ys(w){return w=w.childContextTypes,w!=null}function Ei(){Jt(hi),Jt(In)}function au(w,S,N){if(In.current!==ll)throw Error(a(168));_t(In,S),_t(hi,N)}function gy(w,S,N){var M=w.stateNode;if(S=S.childContextTypes,typeof M.getChildContext!="function")return N;M=M.getChildContext();for(var D in M)if(!(D in S))throw Error(a(108,I(w)||"Unknown",D));return s({},N,M)}function Ls(w){return w=(w=w.stateNode)&&w.__reactInternalMemoizedMergedChildContext||ll,su=In.current,_t(In,w),_t(hi,hi.current),!0}function yy(w,S,N){var M=w.stateNode;if(!M)throw Error(a(169));N?(w=gy(w,S,su),M.__reactInternalMemoizedMergedChildContext=w,Jt(hi),Jt(In),_t(In,w)):Jt(hi),_t(hi,N)}var Io=Math.clz32?Math.clz32:wwe,PE=Math.log,bwe=Math.LN2;function wwe(w){return w>>>=0,w===0?32:31-(PE(w)/bwe|0)|0}var OE=64,DE=4194304;function Rb(w){switch(w&-w){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return w&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return w&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return w}}function $E(w,S){var N=w.pendingLanes;if(N===0)return 0;var M=0,D=w.suspendedLanes,U=w.pingedLanes,re=N&268435455;if(re!==0){var be=re&~D;be!==0?M=Rb(be):(U&=re,U!==0&&(M=Rb(U)))}else re=N&~D,re!==0?M=Rb(re):U!==0&&(M=Rb(U));if(M===0)return 0;if(S!==0&&S!==M&&!(S&D)&&(D=M&-M,U=S&-S,D>=U||D===16&&(U&4194240)!==0))return S;if(M&4&&(M|=N&16),S=w.entangledLanes,S!==0)for(w=w.entanglements,S&=M;0<S;)N=31-Io(S),D=1<<N,M|=w[N],S&=~D;return M}function Swe(w,S){switch(w){case 1:case 2:case 4:return S+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return S+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _we(w,S){for(var N=w.suspendedLanes,M=w.pingedLanes,D=w.expirationTimes,U=w.pendingLanes;0<U;){var re=31-Io(U),be=1<<re,Ue=D[re];Ue===-1?(!(be&N)||be&M)&&(D[re]=Swe(be,S)):Ue<=S&&(w.expiredLanes|=be),U&=~be}}function OO(w){return w=w.pendingLanes&-1073741825,w!==0?w:w&1073741824?1073741824:0}function DO(w){for(var S=[],N=0;31>N;N++)S.push(w);return S}function Pb(w,S,N){w.pendingLanes|=S,S!==536870912&&(w.suspendedLanes=0,w.pingedLanes=0),w=w.eventTimes,S=31-Io(S),w[S]=N}function Twe(w,S){var N=w.pendingLanes&~S;w.pendingLanes=S,w.suspendedLanes=0,w.pingedLanes=0,w.expiredLanes&=S,w.mutableReadLanes&=S,w.entangledLanes&=S,S=w.entanglements;var M=w.eventTimes;for(w=w.expirationTimes;0<N;){var D=31-Io(N),U=1<<D;S[D]=0,M[D]=-1,w[D]=-1,N&=~U}}function $O(w,S){var N=w.entangledLanes|=S;for(w=w.entanglements;N;){var M=31-Io(N),D=1<<M;D&S|w[M]&S&&(w[M]|=S),N&=~D}}var Qn=0;function E6(w){return w&=-w,1<w?4<w?w&268435455?16:536870912:4:1}var LO=i.unstable_scheduleCallback,C6=i.unstable_cancelCallback,Ewe=i.unstable_shouldYield,Cwe=i.unstable_requestPaint,vs=i.unstable_now,FO=i.unstable_ImmediatePriority,Nwe=i.unstable_UserBlockingPriority,jO=i.unstable_NormalPriority,Awe=i.unstable_IdlePriority,LE=null,ou=null;function Iwe(w){if(ou&&typeof ou.onCommitFiberRoot=="function")try{ou.onCommitFiberRoot(LE,w,void 0,(w.current.flags&128)===128)}catch{}}function kwe(w,S){return w===S&&(w!==0||1/w===1/S)||w!==w&&S!==S}var lu=typeof Object.is=="function"?Object.is:kwe,od=null,FE=!1,zO=!1;function N6(w){od===null?od=[w]:od.push(w)}function Mwe(w){FE=!0,N6(w)}function cu(){if(!zO&&od!==null){zO=!0;var w=0,S=Qn;try{var N=od;for(Qn=1;w<N.length;w++){var M=N[w];do M=M(!0);while(M!==null)}od=null,FE=!1}catch(D){throw od!==null&&(od=od.slice(w+1)),LO(FO,cu),D}finally{Qn=S,zO=!1}}return null}var Rwe=o.ReactCurrentBatchConfig;function jE(w,S){if(lu(w,S))return!0;if(typeof w!="object"||w===null||typeof S!="object"||S===null)return!1;var N=Object.keys(w),M=Object.keys(S);if(N.length!==M.length)return!1;for(M=0;M<N.length;M++){var D=N[M];if(!ei.call(S,D)||!lu(w[D],S[D]))return!1}return!0}function Pwe(w){switch(w.tag){case 5:return cn(w.type);case 16:return cn("Lazy");case 13:return cn("Suspense");case 19:return cn("SuspenseList");case 0:case 2:case 15:return w=un(w.type,!1),w;case 11:return w=un(w.type.render,!1),w;case 1:return w=un(w.type,!0),w;default:return""}}function nc(w,S){if(w&&w.defaultProps){S=s({},S),w=w.defaultProps;for(var N in w)S[N]===void 0&&(S[N]=w[N]);return S}return S}var zE=gs(null),BE=null,vy=null,BO=null;function UO(){BO=vy=BE=null}function A6(w,S,N){_e?(_t(zE,S._currentValue),S._currentValue=N):(_t(zE,S._currentValue2),S._currentValue2=N)}function VO(w){var S=zE.current;Jt(zE),_e?w._currentValue=S:w._currentValue2=S}function WO(w,S,N){for(;w!==null;){var M=w.alternate;if((w.childLanes&S)!==S?(w.childLanes|=S,M!==null&&(M.childLanes|=S)):M!==null&&(M.childLanes&S)!==S&&(M.childLanes|=S),w===N)break;w=w.return}}function xy(w,S){BE=w,BO=vy=null,w=w.dependencies,w!==null&&w.firstContext!==null&&(w.lanes&S&&(Ro=!0),w.firstContext=null)}function ul(w){var S=_e?w._currentValue:w._currentValue2;if(BO!==w)if(w={context:w,memoizedValue:S,next:null},vy===null){if(BE===null)throw Error(a(308));vy=w,BE.dependencies={lanes:0,firstContext:w}}else vy=vy.next=w;return S}var uu=null,Ch=!1;function HO(w){w.updateQueue={baseState:w.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function I6(w,S){w=w.updateQueue,S.updateQueue===w&&(S.updateQueue={baseState:w.baseState,firstBaseUpdate:w.firstBaseUpdate,lastBaseUpdate:w.lastBaseUpdate,shared:w.shared,effects:w.effects})}function ld(w,S){return{eventTime:w,lane:S,tag:0,payload:null,callback:null,next:null}}function Nh(w,S){var N=w.updateQueue;N!==null&&(N=N.shared,Li!==null&&w.mode&1&&!(kn&2)?(w=N.interleaved,w===null?(S.next=S,uu===null?uu=[N]:uu.push(N)):(S.next=w.next,w.next=S),N.interleaved=S):(w=N.pending,w===null?S.next=S:(S.next=w.next,w.next=S),N.pending=S))}function UE(w,S,N){if(S=S.updateQueue,S!==null&&(S=S.shared,(N&4194240)!==0)){var M=S.lanes;M&=w.pendingLanes,N|=M,S.lanes=N,$O(w,N)}}function k6(w,S){var N=w.updateQueue,M=w.alternate;if(M!==null&&(M=M.updateQueue,N===M)){var D=null,U=null;if(N=N.firstBaseUpdate,N!==null){do{var re={eventTime:N.eventTime,lane:N.lane,tag:N.tag,payload:N.payload,callback:N.callback,next:null};U===null?D=U=re:U=U.next=re,N=N.next}while(N!==null);U===null?D=U=S:U=U.next=S}else D=U=S;N={baseState:M.baseState,firstBaseUpdate:D,lastBaseUpdate:U,shared:M.shared,effects:M.effects},w.updateQueue=N;return}w=N.lastBaseUpdate,w===null?N.firstBaseUpdate=S:w.next=S,N.lastBaseUpdate=S}function VE(w,S,N,M){var D=w.updateQueue;Ch=!1;var U=D.firstBaseUpdate,re=D.lastBaseUpdate,be=D.shared.pending;if(be!==null){D.shared.pending=null;var Ue=be,Je=Ue.next;Ue.next=null,re===null?U=Je:re.next=Je,re=Ue;var Tt=w.alternate;Tt!==null&&(Tt=Tt.updateQueue,be=Tt.lastBaseUpdate,be!==re&&(be===null?Tt.firstBaseUpdate=Je:be.next=Je,Tt.lastBaseUpdate=Ue))}if(U!==null){var fn=D.baseState;re=0,Tt=Je=Ue=null,be=U;do{var Gt=be.lane,Er=be.eventTime;if((M&Gt)===Gt){Tt!==null&&(Tt=Tt.next={eventTime:Er,lane:0,tag:be.tag,payload:be.payload,callback:be.callback,next:null});e:{var zt=w,Js=be;switch(Gt=S,Er=N,Js.tag){case 1:if(zt=Js.payload,typeof zt=="function"){fn=zt.call(Er,fn,Gt);break e}fn=zt;break e;case 3:zt.flags=zt.flags&-65537|128;case 0:if(zt=Js.payload,Gt=typeof zt=="function"?zt.call(Er,fn,Gt):zt,Gt==null)break e;fn=s({},fn,Gt);break e;case 2:Ch=!0}}be.callback!==null&&be.lane!==0&&(w.flags|=64,Gt=D.effects,Gt===null?D.effects=[be]:Gt.push(be))}else Er={eventTime:Er,lane:Gt,tag:be.tag,payload:be.payload,callback:be.callback,next:null},Tt===null?(Je=Tt=Er,Ue=fn):Tt=Tt.next=Er,re|=Gt;if(be=be.next,be===null){if(be=D.shared.pending,be===null)break;Gt=be,be=Gt.next,Gt.next=null,D.lastBaseUpdate=Gt,D.shared.pending=null}}while(!0);if(Tt===null&&(Ue=fn),D.baseState=Ue,D.firstBaseUpdate=Je,D.lastBaseUpdate=Tt,S=D.shared.interleaved,S!==null){D=S;do re|=D.lane,D=D.next;while(D!==S)}else U===null&&(D.shared.lanes=0);Ay|=re,w.lanes=re,w.memoizedState=fn}}function M6(w,S,N){if(w=S.effects,S.effects=null,w!==null)for(S=0;S<w.length;S++){var M=w[S],D=M.callback;if(D!==null){if(M.callback=null,M=N,typeof D!="function")throw Error(a(191,D));D.call(M)}}}var R6=new r.Component().refs;function GO(w,S,N,M){S=w.memoizedState,N=N(M,S),N=N==null?S:s({},S,N),w.memoizedState=N,w.lanes===0&&(w.updateQueue.baseState=N)}var WE={isMounted:function(w){return(w=w._reactInternals)?A(w)===w:!1},enqueueSetState:function(w,S,N){w=w._reactInternals;var M=Ea(),D=kh(w),U=ld(M,D);U.payload=S,N!=null&&(U.callback=N),Nh(w,U),S=ml(w,D,M),S!==null&&UE(S,w,D)},enqueueReplaceState:function(w,S,N){w=w._reactInternals;var M=Ea(),D=kh(w),U=ld(M,D);U.tag=1,U.payload=S,N!=null&&(U.callback=N),Nh(w,U),S=ml(w,D,M),S!==null&&UE(S,w,D)},enqueueForceUpdate:function(w,S){w=w._reactInternals;var N=Ea(),M=kh(w),D=ld(N,M);D.tag=2,S!=null&&(D.callback=S),Nh(w,D),S=ml(w,M,N),S!==null&&UE(S,w,M)}};function P6(w,S,N,M,D,U,re){return w=w.stateNode,typeof w.shouldComponentUpdate=="function"?w.shouldComponentUpdate(M,U,re):S.prototype&&S.prototype.isPureReactComponent?!jE(N,M)||!jE(D,U):!0}function O6(w,S,N){var M=!1,D=ll,U=S.contextType;return typeof U=="object"&&U!==null?U=ul(U):(D=ys(S)?su:In.current,M=S.contextTypes,U=(M=M!=null)?cl(w,D):ll),S=new S(N,U),w.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=WE,w.stateNode=S,S._reactInternals=w,M&&(w=w.stateNode,w.__reactInternalMemoizedUnmaskedChildContext=D,w.__reactInternalMemoizedMaskedChildContext=U),S}function D6(w,S,N,M){w=S.state,typeof S.componentWillReceiveProps=="function"&&S.componentWillReceiveProps(N,M),typeof S.UNSAFE_componentWillReceiveProps=="function"&&S.UNSAFE_componentWillReceiveProps(N,M),S.state!==w&&WE.enqueueReplaceState(S,S.state,null)}function qO(w,S,N,M){var D=w.stateNode;D.props=N,D.state=w.memoizedState,D.refs=R6,HO(w);var U=S.contextType;typeof U=="object"&&U!==null?D.context=ul(U):(U=ys(S)?su:In.current,D.context=cl(w,U)),D.state=w.memoizedState,U=S.getDerivedStateFromProps,typeof U=="function"&&(GO(w,S,U,N),D.state=w.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof D.getSnapshotBeforeUpdate=="function"||typeof D.UNSAFE_componentWillMount!="function"&&typeof D.componentWillMount!="function"||(S=D.state,typeof D.componentWillMount=="function"&&D.componentWillMount(),typeof D.UNSAFE_componentWillMount=="function"&&D.UNSAFE_componentWillMount(),S!==D.state&&WE.enqueueReplaceState(D,D.state,null),VE(w,N,D,M),D.state=w.memoizedState),typeof D.componentDidMount=="function"&&(w.flags|=4194308)}var by=[],wy=0,HE=null,GE=0,dl=[],hl=0,Dp=null,cd=1,ud="";function $p(w,S){by[wy++]=GE,by[wy++]=HE,HE=w,GE=S}function $6(w,S,N){dl[hl++]=cd,dl[hl++]=ud,dl[hl++]=Dp,Dp=w;var M=cd;w=ud;var D=32-Io(M)-1;M&=~(1<<D),N+=1;var U=32-Io(S)+D;if(30<U){var re=D-D%5;U=(M&(1<<re)-1).toString(32),M>>=re,D-=re,cd=1<<32-Io(S)+D|N<<D|M,ud=U+w}else cd=1<<U|N<<D|M,ud=w}function XO(w){w.return!==null&&($p(w,1),$6(w,1,0))}function KO(w){for(;w===HE;)HE=by[--wy],by[wy]=null,GE=by[--wy],by[wy]=null;for(;w===Dp;)Dp=dl[--hl],dl[hl]=null,ud=dl[--hl],dl[hl]=null,cd=dl[--hl],dl[hl]=null}var ko=null,Mo=null,Hr=!1,Ob=!1,rc=null;function L6(w,S){var N=gl(5,null,null,0);N.elementType="DELETED",N.stateNode=S,N.return=w,S=w.deletions,S===null?(w.deletions=[N],w.flags|=16):S.push(N)}function F6(w,S){switch(w.tag){case 5:return S=xr(S,w.type,w.pendingProps),S!==null?(w.stateNode=S,ko=w,Mo=my(S),!0):!1;case 6:return S=Ds(S,w.pendingProps),S!==null?(w.stateNode=S,ko=w,Mo=null,!0):!1;case 13:if(S=ol(S),S!==null){var N=Dp!==null?{id:cd,overflow:ud}:null;return w.memoizedState={dehydrated:S,treeContext:N,retryLane:1073741824},N=gl(18,null,null,0),N.stateNode=S,N.return=w,w.child=N,ko=w,Mo=null,!0}return!1;default:return!1}}function YO(w){return(w.mode&1)!==0&&(w.flags&128)===0}function ZO(w){if(Hr){var S=Mo;if(S){var N=S;if(!F6(w,S)){if(YO(w))throw Error(a(418));S=Eh(N);var M=ko;S&&F6(w,S)?L6(M,N):(w.flags=w.flags&-4097|2,Hr=!1,ko=w)}}else{if(YO(w))throw Error(a(418));w.flags=w.flags&-4097|2,Hr=!1,ko=w}}}function j6(w){for(w=w.return;w!==null&&w.tag!==5&&w.tag!==3&&w.tag!==13;)w=w.return;ko=w}function Db(w){if(!ke||w!==ko)return!1;if(!Hr)return j6(w),Hr=!0,!1;if(w.tag!==3&&(w.tag!==5||yt(w.type)&&!fe(w.type,w.memoizedProps))){var S=Mo;if(S){if(YO(w)){for(w=Mo;w;)w=Eh(w);throw Error(a(418))}for(;S;)L6(w,S),S=Eh(S)}}if(j6(w),w.tag===13){if(!ke)throw Error(a(316));if(w=w.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(a(317));Mo=ee(w)}else Mo=ko?Eh(w.stateNode):null;return!0}function Sy(){ke&&(Mo=ko=null,Ob=Hr=!1)}function QO(w){rc===null?rc=[w]:rc.push(w)}function $b(w,S,N){if(w=N.ref,w!==null&&typeof w!="function"&&typeof w!="object"){if(N._owner){if(N=N._owner,N){if(N.tag!==1)throw Error(a(309));var M=N.stateNode}if(!M)throw Error(a(147,w));var D=M,U=""+w;return S!==null&&S.ref!==null&&typeof S.ref=="function"&&S.ref._stringRef===U?S.ref:(S=function(re){var be=D.refs;be===R6&&(be=D.refs={}),re===null?delete be[U]:be[U]=re},S._stringRef=U,S)}if(typeof w!="string")throw Error(a(284));if(!N._owner)throw Error(a(290,w))}return w}function qE(w,S){throw w=Object.prototype.toString.call(S),Error(a(31,w==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":w))}function z6(w){var S=w._init;return S(w._payload)}function B6(w){function S(Re,Se){if(w){var Be=Re.deletions;Be===null?(Re.deletions=[Se],Re.flags|=16):Be.push(Se)}}function N(Re,Se){if(!w)return null;for(;Se!==null;)S(Re,Se),Se=Se.sibling;return null}function M(Re,Se){for(Re=new Map;Se!==null;)Se.key!==null?Re.set(Se.key,Se):Re.set(Se.index,Se),Se=Se.sibling;return Re}function D(Re,Se){return Re=Rh(Re,Se),Re.index=0,Re.sibling=null,Re}function U(Re,Se,Be){return Re.index=Be,w?(Be=Re.alternate,Be!==null?(Be=Be.index,Be<Se?(Re.flags|=2,Se):Be):(Re.flags|=2,Se)):(Re.flags|=1048576,Se)}function re(Re){return w&&Re.alternate===null&&(Re.flags|=2),Re}function be(Re,Se,Be,gt){return Se===null||Se.tag!==6?(Se=DD(Be,Re.mode,gt),Se.return=Re,Se):(Se=D(Se,Be),Se.return=Re,Se)}function Ue(Re,Se,Be,gt){var $t=Be.type;return $t===u?Tt(Re,Se,Be.props.children,gt,Be.key):Se!==null&&(Se.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===b&&z6($t)===Se.type)?(gt=D(Se,Be.props),gt.ref=$b(Re,Se,Be),gt.return=Re,gt):(gt=TC(Be.type,Be.key,Be.props,null,Re.mode,gt),gt.ref=$b(Re,Se,Be),gt.return=Re,gt)}function Je(Re,Se,Be,gt){return Se===null||Se.tag!==4||Se.stateNode.containerInfo!==Be.containerInfo||Se.stateNode.implementation!==Be.implementation?(Se=$D(Be,Re.mode,gt),Se.return=Re,Se):(Se=D(Se,Be.children||[]),Se.return=Re,Se)}function Tt(Re,Se,Be,gt,$t){return Se===null||Se.tag!==7?(Se=Vp(Be,Re.mode,gt,$t),Se.return=Re,Se):(Se=D(Se,Be),Se.return=Re,Se)}function fn(Re,Se,Be){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return Se=DD(""+Se,Re.mode,Be),Se.return=Re,Se;if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case l:return Be=TC(Se.type,Se.key,Se.props,null,Re.mode,Be),Be.ref=$b(Re,null,Se),Be.return=Re,Be;case c:return Se=$D(Se,Re.mode,Be),Se.return=Re,Se;case b:var gt=Se._init;return fn(Re,gt(Se._payload),Be)}if(j(Se)||E(Se))return Se=Vp(Se,Re.mode,Be,null),Se.return=Re,Se;qE(Re,Se)}return null}function Gt(Re,Se,Be,gt){var $t=Se!==null?Se.key:null;if(typeof Be=="string"&&Be!==""||typeof Be=="number")return $t!==null?null:be(Re,Se,""+Be,gt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case l:return Be.key===$t?Ue(Re,Se,Be,gt):null;case c:return Be.key===$t?Je(Re,Se,Be,gt):null;case b:return $t=Be._init,Gt(Re,Se,$t(Be._payload),gt)}if(j(Be)||E(Be))return $t!==null?null:Tt(Re,Se,Be,gt,null);qE(Re,Be)}return null}function Er(Re,Se,Be,gt,$t){if(typeof gt=="string"&&gt!==""||typeof gt=="number")return Re=Re.get(Be)||null,be(Se,Re,""+gt,$t);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case l:return Re=Re.get(gt.key===null?Be:gt.key)||null,Ue(Se,Re,gt,$t);case c:return Re=Re.get(gt.key===null?Be:gt.key)||null,Je(Se,Re,gt,$t);case b:var _n=gt._init;return Er(Re,Se,Be,_n(gt._payload),$t)}if(j(gt)||E(gt))return Re=Re.get(Be)||null,Tt(Se,Re,gt,$t,null);qE(Se,gt)}return null}function zt(Re,Se,Be,gt){for(var $t=null,_n=null,pn=Se,Jn=Se=0,bs=null;pn!==null&&Jn<Be.length;Jn++){pn.index>Jn?(bs=pn,pn=null):bs=pn.sibling;var er=Gt(Re,pn,Be[Jn],gt);if(er===null){pn===null&&(pn=bs);break}w&&pn&&er.alternate===null&&S(Re,pn),Se=U(er,Se,Jn),_n===null?$t=er:_n.sibling=er,_n=er,pn=bs}if(Jn===Be.length)return N(Re,pn),Hr&&$p(Re,Jn),$t;if(pn===null){for(;Jn<Be.length;Jn++)pn=fn(Re,Be[Jn],gt),pn!==null&&(Se=U(pn,Se,Jn),_n===null?$t=pn:_n.sibling=pn,_n=pn);return Hr&&$p(Re,Jn),$t}for(pn=M(Re,pn);Jn<Be.length;Jn++)bs=Er(pn,Re,Jn,Be[Jn],gt),bs!==null&&(w&&bs.alternate!==null&&pn.delete(bs.key===null?Jn:bs.key),Se=U(bs,Se,Jn),_n===null?$t=bs:_n.sibling=bs,_n=bs);return w&&pn.forEach(function(Ph){return S(Re,Ph)}),Hr&&$p(Re,Jn),$t}function Js(Re,Se,Be,gt){var $t=E(Be);if(typeof $t!="function")throw Error(a(150));if(Be=$t.call(Be),Be==null)throw Error(a(151));for(var _n=$t=null,pn=Se,Jn=Se=0,bs=null,er=Be.next();pn!==null&&!er.done;Jn++,er=Be.next()){pn.index>Jn?(bs=pn,pn=null):bs=pn.sibling;var Ph=Gt(Re,pn,er.value,gt);if(Ph===null){pn===null&&(pn=bs);break}w&&pn&&Ph.alternate===null&&S(Re,pn),Se=U(Ph,Se,Jn),_n===null?$t=Ph:_n.sibling=Ph,_n=Ph,pn=bs}if(er.done)return N(Re,pn),Hr&&$p(Re,Jn),$t;if(pn===null){for(;!er.done;Jn++,er=Be.next())er=fn(Re,er.value,gt),er!==null&&(Se=U(er,Se,Jn),_n===null?$t=er:_n.sibling=er,_n=er);return Hr&&$p(Re,Jn),$t}for(pn=M(Re,pn);!er.done;Jn++,er=Be.next())er=Er(pn,Re,Jn,er.value,gt),er!==null&&(w&&er.alternate!==null&&pn.delete(er.key===null?Jn:er.key),Se=U(er,Se,Jn),_n===null?$t=er:_n.sibling=er,_n=er);return w&&pn.forEach(function(c1e){return S(Re,c1e)}),Hr&&$p(Re,Jn),$t}function yl(Re,Se,Be,gt){if(typeof Be=="object"&&Be!==null&&Be.type===u&&Be.key===null&&(Be=Be.props.children),typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case l:e:{for(var $t=Be.key,_n=Se;_n!==null;){if(_n.key===$t){if($t=Be.type,$t===u){if(_n.tag===7){N(Re,_n.sibling),Se=D(_n,Be.props.children),Se.return=Re,Re=Se;break e}}else if(_n.elementType===$t||typeof $t=="object"&&$t!==null&&$t.$$typeof===b&&z6($t)===_n.type){N(Re,_n.sibling),Se=D(_n,Be.props),Se.ref=$b(Re,_n,Be),Se.return=Re,Re=Se;break e}N(Re,_n);break}else S(Re,_n);_n=_n.sibling}Be.type===u?(Se=Vp(Be.props.children,Re.mode,gt,Be.key),Se.return=Re,Re=Se):(gt=TC(Be.type,Be.key,Be.props,null,Re.mode,gt),gt.ref=$b(Re,Se,Be),gt.return=Re,Re=gt)}return re(Re);case c:e:{for(_n=Be.key;Se!==null;){if(Se.key===_n)if(Se.tag===4&&Se.stateNode.containerInfo===Be.containerInfo&&Se.stateNode.implementation===Be.implementation){N(Re,Se.sibling),Se=D(Se,Be.children||[]),Se.return=Re,Re=Se;break e}else{N(Re,Se);break}else S(Re,Se);Se=Se.sibling}Se=$D(Be,Re.mode,gt),Se.return=Re,Re=Se}return re(Re);case b:return _n=Be._init,yl(Re,Se,_n(Be._payload),gt)}if(j(Be))return zt(Re,Se,Be,gt);if(E(Be))return Js(Re,Se,Be,gt);qE(Re,Be)}return typeof Be=="string"&&Be!==""||typeof Be=="number"?(Be=""+Be,Se!==null&&Se.tag===6?(N(Re,Se.sibling),Se=D(Se,Be),Se.return=Re,Re=Se):(N(Re,Se),Se=DD(Be,Re.mode,gt),Se.return=Re,Re=Se),re(Re)):N(Re,Se)}return yl}var _y=B6(!0),U6=B6(!1),Lb={},fl=gs(Lb),Fb=gs(Lb),Ty=gs(Lb);function du(w){if(w===Lb)throw Error(a(174));return w}function JO(w,S){_t(Ty,S),_t(Fb,w),_t(fl,Lb),w=W(S),Jt(fl),_t(fl,w)}function Ey(){Jt(fl),Jt(Fb),Jt(Ty)}function V6(w){var S=du(Ty.current),N=du(fl.current);S=L(N,w.type,S),N!==S&&(_t(Fb,w),_t(fl,S))}function eD(w){Fb.current===w&&(Jt(fl),Jt(Fb))}var ti=gs(0);function XE(w){for(var S=w;S!==null;){if(S.tag===13){var N=S.memoizedState;if(N!==null&&(N=N.dehydrated,N===null||kb(N)||Mb(N)))return S}else if(S.tag===19&&S.memoizedProps.revealOrder!==void 0){if(S.flags&128)return S}else if(S.child!==null){S.child.return=S,S=S.child;continue}if(S===w)break;for(;S.sibling===null;){if(S.return===null||S.return===w)return null;S=S.return}S.sibling.return=S.return,S=S.sibling}return null}var tD=[];function nD(){for(var w=0;w<tD.length;w++){var S=tD[w];_e?S._workInProgressVersionPrimary=null:S._workInProgressVersionSecondary=null}tD.length=0}var KE=o.ReactCurrentDispatcher,pl=o.ReactCurrentBatchConfig,Cy=0,fi=null,Ys=null,xs=null,YE=!1,jb=!1,zb=0,Owe=0;function Zs(){throw Error(a(321))}function rD(w,S){if(S===null)return!1;for(var N=0;N<S.length&&N<w.length;N++)if(!lu(w[N],S[N]))return!1;return!0}function iD(w,S,N,M,D,U){if(Cy=U,fi=S,S.memoizedState=null,S.updateQueue=null,S.lanes=0,KE.current=w===null||w.memoizedState===null?Fwe:jwe,w=N(M,D),jb){U=0;do{if(jb=!1,zb=0,25<=U)throw Error(a(301));U+=1,xs=Ys=null,S.updateQueue=null,KE.current=zwe,w=N(M,D)}while(jb)}if(KE.current=tC,S=Ys!==null&&Ys.next!==null,Cy=0,xs=Ys=fi=null,YE=!1,S)throw Error(a(300));return w}function sD(){var w=zb!==0;return zb=0,w}function dd(){var w={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xs===null?fi.memoizedState=xs=w:xs=xs.next=w,xs}function hu(){if(Ys===null){var w=fi.alternate;w=w!==null?w.memoizedState:null}else w=Ys.next;var S=xs===null?fi.memoizedState:xs.next;if(S!==null)xs=S,Ys=w;else{if(w===null)throw Error(a(310));Ys=w,w={memoizedState:Ys.memoizedState,baseState:Ys.baseState,baseQueue:Ys.baseQueue,queue:Ys.queue,next:null},xs===null?fi.memoizedState=xs=w:xs=xs.next=w}return xs}function Lp(w,S){return typeof S=="function"?S(w):S}function ZE(w){var S=hu(),N=S.queue;if(N===null)throw Error(a(311));N.lastRenderedReducer=w;var M=Ys,D=M.baseQueue,U=N.pending;if(U!==null){if(D!==null){var re=D.next;D.next=U.next,U.next=re}M.baseQueue=D=U,N.pending=null}if(D!==null){U=D.next,M=M.baseState;var be=re=null,Ue=null,Je=U;do{var Tt=Je.lane;if((Cy&Tt)===Tt)Ue!==null&&(Ue=Ue.next={lane:0,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null}),M=Je.hasEagerState?Je.eagerState:w(M,Je.action);else{var fn={lane:Tt,action:Je.action,hasEagerState:Je.hasEagerState,eagerState:Je.eagerState,next:null};Ue===null?(be=Ue=fn,re=M):Ue=Ue.next=fn,fi.lanes|=Tt,Ay|=Tt}Je=Je.next}while(Je!==null&&Je!==U);Ue===null?re=M:Ue.next=be,lu(M,S.memoizedState)||(Ro=!0),S.memoizedState=M,S.baseState=re,S.baseQueue=Ue,N.lastRenderedState=M}if(w=N.interleaved,w!==null){D=w;do U=D.lane,fi.lanes|=U,Ay|=U,D=D.next;while(D!==w)}else D===null&&(N.lanes=0);return[S.memoizedState,N.dispatch]}function QE(w){var S=hu(),N=S.queue;if(N===null)throw Error(a(311));N.lastRenderedReducer=w;var M=N.dispatch,D=N.pending,U=S.memoizedState;if(D!==null){N.pending=null;var re=D=D.next;do U=w(U,re.action),re=re.next;while(re!==D);lu(U,S.memoizedState)||(Ro=!0),S.memoizedState=U,S.baseQueue===null&&(S.baseState=U),N.lastRenderedState=U}return[U,M]}function W6(){}function H6(w,S){var N=fi,M=hu(),D=S(),U=!lu(M.memoizedState,D);if(U&&(M.memoizedState=D,Ro=!0),M=M.queue,Ub(X6.bind(null,N,M,w),[w]),M.getSnapshot!==S||U||xs!==null&&xs.memoizedState.tag&1){if(N.flags|=2048,Bb(9,q6.bind(null,N,M,D,S),void 0,null),Li===null)throw Error(a(349));Cy&30||G6(N,S,D)}return D}function G6(w,S,N){w.flags|=16384,w={getSnapshot:S,value:N},S=fi.updateQueue,S===null?(S={lastEffect:null,stores:null},fi.updateQueue=S,S.stores=[w]):(N=S.stores,N===null?S.stores=[w]:N.push(w))}function q6(w,S,N,M){S.value=N,S.getSnapshot=M,K6(S)&&ml(w,1,-1)}function X6(w,S,N){return N(function(){K6(S)&&ml(w,1,-1)})}function K6(w){var S=w.getSnapshot;w=w.value;try{var N=S();return!lu(w,N)}catch{return!0}}function aD(w){var S=dd();return typeof w=="function"&&(w=w()),S.memoizedState=S.baseState=w,w={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Lp,lastRenderedState:w},S.queue=w,w=w.dispatch=Lwe.bind(null,fi,w),[S.memoizedState,w]}function Bb(w,S,N,M){return w={tag:w,create:S,destroy:N,deps:M,next:null},S=fi.updateQueue,S===null?(S={lastEffect:null,stores:null},fi.updateQueue=S,S.lastEffect=w.next=w):(N=S.lastEffect,N===null?S.lastEffect=w.next=w:(M=N.next,N.next=w,w.next=M,S.lastEffect=w)),w}function Y6(){return hu().memoizedState}function JE(w,S,N,M){var D=dd();fi.flags|=w,D.memoizedState=Bb(1|S,N,void 0,M===void 0?null:M)}function eC(w,S,N,M){var D=hu();M=M===void 0?null:M;var U=void 0;if(Ys!==null){var re=Ys.memoizedState;if(U=re.destroy,M!==null&&rD(M,re.deps)){D.memoizedState=Bb(S,N,U,M);return}}fi.flags|=w,D.memoizedState=Bb(1|S,N,U,M)}function oD(w,S){return JE(8390656,8,w,S)}function Ub(w,S){return eC(2048,8,w,S)}function Z6(w,S){return eC(4,2,w,S)}function Q6(w,S){return eC(4,4,w,S)}function J6(w,S){if(typeof S=="function")return w=w(),S(w),function(){S(null)};if(S!=null)return w=w(),S.current=w,function(){S.current=null}}function e8(w,S,N){return N=N!=null?N.concat([w]):null,eC(4,4,J6.bind(null,S,w),N)}function lD(){}function t8(w,S){var N=hu();S=S===void 0?null:S;var M=N.memoizedState;return M!==null&&S!==null&&rD(S,M[1])?M[0]:(N.memoizedState=[w,S],w)}function n8(w,S){var N=hu();S=S===void 0?null:S;var M=N.memoizedState;return M!==null&&S!==null&&rD(S,M[1])?M[0]:(w=w(),N.memoizedState=[w,S],w)}function Dwe(w,S){var N=Qn;Qn=N!==0&&4>N?N:4,w(!0);var M=pl.transition;pl.transition={};try{w(!1),S()}finally{Qn=N,pl.transition=M}}function r8(){return hu().memoizedState}function $we(w,S,N){var M=kh(w);N={lane:M,action:N,hasEagerState:!1,eagerState:null,next:null},i8(w)?s8(S,N):(a8(w,S,N),N=Ea(),w=ml(w,M,N),w!==null&&o8(w,S,M))}function Lwe(w,S,N){var M=kh(w),D={lane:M,action:N,hasEagerState:!1,eagerState:null,next:null};if(i8(w))s8(S,D);else{a8(w,S,D);var U=w.alternate;if(w.lanes===0&&(U===null||U.lanes===0)&&(U=S.lastRenderedReducer,U!==null))try{var re=S.lastRenderedState,be=U(re,N);if(D.hasEagerState=!0,D.eagerState=be,lu(be,re))return}catch{}finally{}N=Ea(),w=ml(w,M,N),w!==null&&o8(w,S,M)}}function i8(w){var S=w.alternate;return w===fi||S!==null&&S===fi}function s8(w,S){jb=YE=!0;var N=w.pending;N===null?S.next=S:(S.next=N.next,N.next=S),w.pending=S}function a8(w,S,N){Li!==null&&w.mode&1&&!(kn&2)?(w=S.interleaved,w===null?(N.next=N,uu===null?uu=[S]:uu.push(S)):(N.next=w.next,w.next=N),S.interleaved=N):(w=S.pending,w===null?N.next=N:(N.next=w.next,w.next=N),S.pending=N)}function o8(w,S,N){if(N&4194240){var M=S.lanes;M&=w.pendingLanes,N|=M,S.lanes=N,$O(w,N)}}var tC={readContext:ul,useCallback:Zs,useContext:Zs,useEffect:Zs,useImperativeHandle:Zs,useInsertionEffect:Zs,useLayoutEffect:Zs,useMemo:Zs,useReducer:Zs,useRef:Zs,useState:Zs,useDebugValue:Zs,useDeferredValue:Zs,useTransition:Zs,useMutableSource:Zs,useSyncExternalStore:Zs,useId:Zs,unstable_isNewReconciler:!1},Fwe={readContext:ul,useCallback:function(w,S){return dd().memoizedState=[w,S===void 0?null:S],w},useContext:ul,useEffect:oD,useImperativeHandle:function(w,S,N){return N=N!=null?N.concat([w]):null,JE(4194308,4,J6.bind(null,S,w),N)},useLayoutEffect:function(w,S){return JE(4194308,4,w,S)},useInsertionEffect:function(w,S){return JE(4,2,w,S)},useMemo:function(w,S){var N=dd();return S=S===void 0?null:S,w=w(),N.memoizedState=[w,S],w},useReducer:function(w,S,N){var M=dd();return S=N!==void 0?N(S):S,M.memoizedState=M.baseState=S,w={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:w,lastRenderedState:S},M.queue=w,w=w.dispatch=$we.bind(null,fi,w),[M.memoizedState,w]},useRef:function(w){var S=dd();return w={current:w},S.memoizedState=w},useState:aD,useDebugValue:lD,useDeferredValue:function(w){var S=aD(w),N=S[0],M=S[1];return oD(function(){var D=pl.transition;pl.transition={};try{M(w)}finally{pl.transition=D}},[w]),N},useTransition:function(){var w=aD(!1),S=w[0];return w=Dwe.bind(null,w[1]),dd().memoizedState=w,[S,w]},useMutableSource:function(){},useSyncExternalStore:function(w,S,N){var M=fi,D=dd();if(Hr){if(N===void 0)throw Error(a(407));N=N()}else{if(N=S(),Li===null)throw Error(a(349));Cy&30||G6(M,S,N)}D.memoizedState=N;var U={value:N,getSnapshot:S};return D.queue=U,oD(X6.bind(null,M,U,w),[w]),M.flags|=2048,Bb(9,q6.bind(null,M,U,N,S),void 0,null),N},useId:function(){var w=dd(),S=Li.identifierPrefix;if(Hr){var N=ud,M=cd;N=(M&~(1<<32-Io(M)-1)).toString(32)+N,S=":"+S+"R"+N,N=zb++,0<N&&(S+="H"+N.toString(32)),S+=":"}else N=Owe++,S=":"+S+"r"+N.toString(32)+":";return w.memoizedState=S},unstable_isNewReconciler:!1},jwe={readContext:ul,useCallback:t8,useContext:ul,useEffect:Ub,useImperativeHandle:e8,useInsertionEffect:Z6,useLayoutEffect:Q6,useMemo:n8,useReducer:ZE,useRef:Y6,useState:function(){return ZE(Lp)},useDebugValue:lD,useDeferredValue:function(w){var S=ZE(Lp),N=S[0],M=S[1];return Ub(function(){var D=pl.transition;pl.transition={};try{M(w)}finally{pl.transition=D}},[w]),N},useTransition:function(){var w=ZE(Lp)[0],S=hu().memoizedState;return[w,S]},useMutableSource:W6,useSyncExternalStore:H6,useId:r8,unstable_isNewReconciler:!1},zwe={readContext:ul,useCallback:t8,useContext:ul,useEffect:Ub,useImperativeHandle:e8,useInsertionEffect:Z6,useLayoutEffect:Q6,useMemo:n8,useReducer:QE,useRef:Y6,useState:function(){return QE(Lp)},useDebugValue:lD,useDeferredValue:function(w){var S=QE(Lp),N=S[0],M=S[1];return Ub(function(){var D=pl.transition;pl.transition={};try{M(w)}finally{pl.transition=D}},[w]),N},useTransition:function(){var w=QE(Lp)[0],S=hu().memoizedState;return[w,S]},useMutableSource:W6,useSyncExternalStore:H6,useId:r8,unstable_isNewReconciler:!1};function cD(w,S){try{var N="",M=S;do N+=Pwe(M),M=M.return;while(M);var D=N}catch(U){D=`
Error generating stack: `+U.message+`
`+U.stack}return{value:w,source:S,stack:D}}function uD(w,S){try{console.error(S.value)}catch(N){setTimeout(function(){throw N})}}var Bwe=typeof WeakMap=="function"?WeakMap:Map;function l8(w,S,N){N=ld(-1,N),N.tag=3,N.payload={element:null};var M=S.value;return N.callback=function(){yC||(yC=!0,AD=M),uD(w,S)},N}function c8(w,S,N){N=ld(-1,N),N.tag=3;var M=w.type.getDerivedStateFromError;if(typeof M=="function"){var D=S.value;N.payload=function(){return M(D)},N.callback=function(){uD(w,S)}}var U=w.stateNode;return U!==null&&typeof U.componentDidCatch=="function"&&(N.callback=function(){uD(w,S),typeof M!="function"&&(Ah===null?Ah=new Set([this]):Ah.add(this));var re=S.stack;this.componentDidCatch(S.value,{componentStack:re!==null?re:""})}),N}function u8(w,S,N){var M=w.pingCache;if(M===null){M=w.pingCache=new Bwe;var D=new Set;M.set(S,D)}else D=M.get(S),D===void 0&&(D=new Set,M.set(S,D));D.has(N)||(D.add(N),w=t1e.bind(null,w,S,N),S.then(w,w))}function d8(w){do{var S;if((S=w.tag===13)&&(S=w.memoizedState,S=S!==null?S.dehydrated!==null:!0),S)return w;w=w.return}while(w!==null);return null}function h8(w,S,N,M,D){return w.mode&1?(w.flags|=65536,w.lanes=D,w):(w===S?w.flags|=65536:(w.flags|=128,N.flags|=131072,N.flags&=-52805,N.tag===1&&(N.alternate===null?N.tag=17:(S=ld(-1,1),S.tag=2,Nh(N,S))),N.lanes|=1),w)}function fu(w){w.flags|=4}function f8(w,S){if(w!==null&&w.child===S.child)return!0;if(S.flags&16)return!1;for(w=S.child;w!==null;){if(w.flags&12854||w.subtreeFlags&12854)return!1;w=w.sibling}return!0}var Vb,Wb,nC,rC;if(Ce)Vb=function(w,S){for(var N=S.child;N!==null;){if(N.tag===5||N.tag===6)te(w,N.stateNode);else if(N.tag!==4&&N.child!==null){N.child.return=N,N=N.child;continue}if(N===S)break;for(;N.sibling===null;){if(N.return===null||N.return===S)return;N=N.return}N.sibling.return=N.return,N=N.sibling}},Wb=function(){},nC=function(w,S,N,M,D){if(w=w.memoizedProps,w!==M){var U=S.stateNode,re=du(fl.current);N=oe(U,N,w,M,D,re),(S.updateQueue=N)&&fu(S)}},rC=function(w,S,N,M){N!==M&&fu(S)};else if(G){Vb=function(w,S,N,M){for(var D=S.child;D!==null;){if(D.tag===5){var U=D.stateNode;N&&M&&(U=Ti(U,D.type,D.memoizedProps,D)),te(w,U)}else if(D.tag===6)U=D.stateNode,N&&M&&(U=ms(U,D.memoizedProps,D)),te(w,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),Vb(w,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===S)break;for(;D.sibling===null;){if(D.return===null||D.return===S)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};var p8=function(w,S,N,M){for(var D=S.child;D!==null;){if(D.tag===5){var U=D.stateNode;N&&M&&(U=Ti(U,D.type,D.memoizedProps,D)),Ht(w,U)}else if(D.tag===6)U=D.stateNode,N&&M&&(U=ms(U,D.memoizedProps,D)),Ht(w,U);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)U=D.child,U!==null&&(U.return=D),p8(w,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===S)break;for(;D.sibling===null;){if(D.return===null||D.return===S)return;D=D.return}D.sibling.return=D.return,D=D.sibling}};Wb=function(w,S){var N=S.stateNode;if(!f8(w,S)){w=N.containerInfo;var M=Zt(w);p8(M,S,!1,!1),N.pendingChildren=M,fu(S),vr(w,M)}},nC=function(w,S,N,M,D){var U=w.stateNode,re=w.memoizedProps;if((w=f8(w,S))&&re===M)S.stateNode=U;else{var be=S.stateNode,Ue=du(fl.current),Je=null;re!==M&&(Je=oe(be,N,re,M,D,Ue)),w&&Je===null?S.stateNode=U:(U=ht(U,Je,N,re,M,S,w,be),J(U,N,M,D,Ue)&&fu(S),S.stateNode=U,w?fu(S):Vb(U,S,!1,!1))}},rC=function(w,S,N,M){N!==M?(w=du(Ty.current),N=du(fl.current),S.stateNode=Ee(M,w,N,S),fu(S)):S.stateNode=w.stateNode}}else Wb=function(){},nC=function(){},rC=function(){};function Hb(w,S){if(!Hr)switch(w.tailMode){case"hidden":S=w.tail;for(var N=null;S!==null;)S.alternate!==null&&(N=S),S=S.sibling;N===null?w.tail=null:N.sibling=null;break;case"collapsed":N=w.tail;for(var M=null;N!==null;)N.alternate!==null&&(M=N),N=N.sibling;M===null?S||w.tail===null?w.tail=null:w.tail.sibling=null:M.sibling=null}}function Qs(w){var S=w.alternate!==null&&w.alternate.child===w.child,N=0,M=0;if(S)for(var D=w.child;D!==null;)N|=D.lanes|D.childLanes,M|=D.subtreeFlags&14680064,M|=D.flags&14680064,D.return=w,D=D.sibling;else for(D=w.child;D!==null;)N|=D.lanes|D.childLanes,M|=D.subtreeFlags,M|=D.flags,D.return=w,D=D.sibling;return w.subtreeFlags|=M,w.childLanes=N,S}function Uwe(w,S,N){var M=S.pendingProps;switch(KO(S),S.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qs(S),null;case 1:return ys(S.type)&&Ei(),Qs(S),null;case 3:return M=S.stateNode,Ey(),Jt(hi),Jt(In),nD(),M.pendingContext&&(M.context=M.pendingContext,M.pendingContext=null),(w===null||w.child===null)&&(Db(S)?fu(S):w===null||w.memoizedState.isDehydrated&&!(S.flags&256)||(S.flags|=1024,rc!==null&&(MD(rc),rc=null))),Wb(w,S),Qs(S),null;case 5:eD(S),N=du(Ty.current);var D=S.type;if(w!==null&&S.stateNode!=null)nC(w,S,D,M,N),w.ref!==S.ref&&(S.flags|=512,S.flags|=2097152);else{if(!M){if(S.stateNode===null)throw Error(a(166));return Qs(S),null}if(w=du(fl.current),Db(S)){if(!ke)throw Error(a(175));w=MO(S.stateNode,S.type,S.memoizedProps,N,w,S,!Ob),S.updateQueue=w,w!==null&&fu(S)}else{var U=K(D,M,N,w,S);Vb(U,S,!1,!1),S.stateNode=U,J(U,D,M,N,w)&&fu(S)}S.ref!==null&&(S.flags|=512,S.flags|=2097152)}return Qs(S),null;case 6:if(w&&S.stateNode!=null)rC(w,S,w.memoizedProps,M);else{if(typeof M!="string"&&S.stateNode===null)throw Error(a(166));if(w=du(Ty.current),N=du(fl.current),Db(S)){if(!ke)throw Error(a(176));if(w=S.stateNode,M=S.memoizedProps,(N=RO(w,M,S,!Ob))&&(D=ko,D!==null))switch(U=(D.mode&1)!==0,D.tag){case 3:jt(D.stateNode.containerInfo,w,M,U);break;case 5:qt(D.type,D.memoizedProps,D.stateNode,w,M,U)}N&&fu(S)}else S.stateNode=Ee(M,w,N,S)}return Qs(S),null;case 13:if(Jt(ti),M=S.memoizedState,Hr&&Mo!==null&&S.mode&1&&!(S.flags&128)){for(w=Mo;w;)w=Eh(w);return Sy(),S.flags|=98560,S}if(M!==null&&M.dehydrated!==null){if(M=Db(S),w===null){if(!M)throw Error(a(318));if(!ke)throw Error(a(344));if(w=S.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(a(317));PO(w,S)}else Sy(),!(S.flags&128)&&(S.memoizedState=null),S.flags|=4;return Qs(S),null}return rc!==null&&(MD(rc),rc=null),S.flags&128?(S.lanes=N,S):(M=M!==null,N=!1,w===null?Db(S):N=w.memoizedState!==null,M&&!N&&(S.child.flags|=8192,S.mode&1&&(w===null||ti.current&1?Qi===0&&(Qi=3):PD())),S.updateQueue!==null&&(S.flags|=4),Qs(S),null);case 4:return Ey(),Wb(w,S),w===null&&Pe(S.stateNode.containerInfo),Qs(S),null;case 10:return VO(S.type._context),Qs(S),null;case 17:return ys(S.type)&&Ei(),Qs(S),null;case 19:if(Jt(ti),D=S.memoizedState,D===null)return Qs(S),null;if(M=(S.flags&128)!==0,U=D.rendering,U===null)if(M)Hb(D,!1);else{if(Qi!==0||w!==null&&w.flags&128)for(w=S.child;w!==null;){if(U=XE(w),U!==null){for(S.flags|=128,Hb(D,!1),w=U.updateQueue,w!==null&&(S.updateQueue=w,S.flags|=4),S.subtreeFlags=0,w=N,M=S.child;M!==null;)N=M,D=w,N.flags&=14680066,U=N.alternate,U===null?(N.childLanes=0,N.lanes=D,N.child=null,N.subtreeFlags=0,N.memoizedProps=null,N.memoizedState=null,N.updateQueue=null,N.dependencies=null,N.stateNode=null):(N.childLanes=U.childLanes,N.lanes=U.lanes,N.child=U.child,N.subtreeFlags=0,N.deletions=null,N.memoizedProps=U.memoizedProps,N.memoizedState=U.memoizedState,N.updateQueue=U.updateQueue,N.type=U.type,D=U.dependencies,N.dependencies=D===null?null:{lanes:D.lanes,firstContext:D.firstContext}),M=M.sibling;return _t(ti,ti.current&1|2),S.child}w=w.sibling}D.tail!==null&&vs()>ND&&(S.flags|=128,M=!0,Hb(D,!1),S.lanes=4194304)}else{if(!M)if(w=XE(U),w!==null){if(S.flags|=128,M=!0,w=w.updateQueue,w!==null&&(S.updateQueue=w,S.flags|=4),Hb(D,!0),D.tail===null&&D.tailMode==="hidden"&&!U.alternate&&!Hr)return Qs(S),null}else 2*vs()-D.renderingStartTime>ND&&N!==1073741824&&(S.flags|=128,M=!0,Hb(D,!1),S.lanes=4194304);D.isBackwards?(U.sibling=S.child,S.child=U):(w=D.last,w!==null?w.sibling=U:S.child=U,D.last=U)}return D.tail!==null?(S=D.tail,D.rendering=S,D.tail=S.sibling,D.renderingStartTime=vs(),S.sibling=null,w=ti.current,_t(ti,M?w&1|2:w&1),S):(Qs(S),null);case 22:case 23:return RD(),M=S.memoizedState!==null,w!==null&&w.memoizedState!==null!==M&&(S.flags|=8192),M&&S.mode&1?Po&1073741824&&(Qs(S),Ce&&S.subtreeFlags&6&&(S.flags|=8192)):Qs(S),null;case 24:return null;case 25:return null}throw Error(a(156,S.tag))}var Vwe=o.ReactCurrentOwner,Ro=!1;function Ta(w,S,N,M){S.child=w===null?U6(S,null,N,M):_y(S,w.child,N,M)}function m8(w,S,N,M,D){N=N.render;var U=S.ref;return xy(S,D),M=iD(w,S,N,M,U,D),N=sD(),w!==null&&!Ro?(S.updateQueue=w.updateQueue,S.flags&=-2053,w.lanes&=~D,hd(w,S,D)):(Hr&&N&&XO(S),S.flags|=1,Ta(w,S,M,D),S.child)}function g8(w,S,N,M,D){if(w===null){var U=N.type;return typeof U=="function"&&!OD(U)&&U.defaultProps===void 0&&N.compare===null&&N.defaultProps===void 0?(S.tag=15,S.type=U,y8(w,S,U,M,D)):(w=TC(N.type,null,M,S,S.mode,D),w.ref=S.ref,w.return=S,S.child=w)}if(U=w.child,!(w.lanes&D)){var re=U.memoizedProps;if(N=N.compare,N=N!==null?N:jE,N(re,M)&&w.ref===S.ref)return hd(w,S,D)}return S.flags|=1,w=Rh(U,M),w.ref=S.ref,w.return=S,S.child=w}function y8(w,S,N,M,D){if(w!==null&&jE(w.memoizedProps,M)&&w.ref===S.ref)if(Ro=!1,(w.lanes&D)!==0)w.flags&131072&&(Ro=!0);else return S.lanes=w.lanes,hd(w,S,D);return dD(w,S,N,M,D)}function v8(w,S,N){var M=S.pendingProps,D=M.children,U=w!==null?w.memoizedState:null;if(M.mode==="hidden")if(!(S.mode&1))S.memoizedState={baseLanes:0,cachePool:null},_t(Ny,Po),Po|=N;else if(N&1073741824)S.memoizedState={baseLanes:0,cachePool:null},M=U!==null?U.baseLanes:N,_t(Ny,Po),Po|=M;else return w=U!==null?U.baseLanes|N:N,S.lanes=S.childLanes=1073741824,S.memoizedState={baseLanes:w,cachePool:null},S.updateQueue=null,_t(Ny,Po),Po|=w,null;else U!==null?(M=U.baseLanes|N,S.memoizedState=null):M=N,_t(Ny,Po),Po|=M;return Ta(w,S,D,N),S.child}function x8(w,S){var N=S.ref;(w===null&&N!==null||w!==null&&w.ref!==N)&&(S.flags|=512,S.flags|=2097152)}function dD(w,S,N,M,D){var U=ys(N)?su:In.current;return U=cl(S,U),xy(S,D),N=iD(w,S,N,M,U,D),M=sD(),w!==null&&!Ro?(S.updateQueue=w.updateQueue,S.flags&=-2053,w.lanes&=~D,hd(w,S,D)):(Hr&&M&&XO(S),S.flags|=1,Ta(w,S,N,D),S.child)}function b8(w,S,N,M,D){if(ys(N)){var U=!0;Ls(S)}else U=!1;if(xy(S,D),S.stateNode===null)w!==null&&(w.alternate=null,S.alternate=null,S.flags|=2),O6(S,N,M),qO(S,N,M,D),M=!0;else if(w===null){var re=S.stateNode,be=S.memoizedProps;re.props=be;var Ue=re.context,Je=N.contextType;typeof Je=="object"&&Je!==null?Je=ul(Je):(Je=ys(N)?su:In.current,Je=cl(S,Je));var Tt=N.getDerivedStateFromProps,fn=typeof Tt=="function"||typeof re.getSnapshotBeforeUpdate=="function";fn||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(be!==M||Ue!==Je)&&D6(S,re,M,Je),Ch=!1;var Gt=S.memoizedState;re.state=Gt,VE(S,M,re,D),Ue=S.memoizedState,be!==M||Gt!==Ue||hi.current||Ch?(typeof Tt=="function"&&(GO(S,N,Tt,M),Ue=S.memoizedState),(be=Ch||P6(S,N,be,M,Gt,Ue,Je))?(fn||typeof re.UNSAFE_componentWillMount!="function"&&typeof re.componentWillMount!="function"||(typeof re.componentWillMount=="function"&&re.componentWillMount(),typeof re.UNSAFE_componentWillMount=="function"&&re.UNSAFE_componentWillMount()),typeof re.componentDidMount=="function"&&(S.flags|=4194308)):(typeof re.componentDidMount=="function"&&(S.flags|=4194308),S.memoizedProps=M,S.memoizedState=Ue),re.props=M,re.state=Ue,re.context=Je,M=be):(typeof re.componentDidMount=="function"&&(S.flags|=4194308),M=!1)}else{re=S.stateNode,I6(w,S),be=S.memoizedProps,Je=S.type===S.elementType?be:nc(S.type,be),re.props=Je,fn=S.pendingProps,Gt=re.context,Ue=N.contextType,typeof Ue=="object"&&Ue!==null?Ue=ul(Ue):(Ue=ys(N)?su:In.current,Ue=cl(S,Ue));var Er=N.getDerivedStateFromProps;(Tt=typeof Er=="function"||typeof re.getSnapshotBeforeUpdate=="function")||typeof re.UNSAFE_componentWillReceiveProps!="function"&&typeof re.componentWillReceiveProps!="function"||(be!==fn||Gt!==Ue)&&D6(S,re,M,Ue),Ch=!1,Gt=S.memoizedState,re.state=Gt,VE(S,M,re,D);var zt=S.memoizedState;be!==fn||Gt!==zt||hi.current||Ch?(typeof Er=="function"&&(GO(S,N,Er,M),zt=S.memoizedState),(Je=Ch||P6(S,N,Je,M,Gt,zt,Ue)||!1)?(Tt||typeof re.UNSAFE_componentWillUpdate!="function"&&typeof re.componentWillUpdate!="function"||(typeof re.componentWillUpdate=="function"&&re.componentWillUpdate(M,zt,Ue),typeof re.UNSAFE_componentWillUpdate=="function"&&re.UNSAFE_componentWillUpdate(M,zt,Ue)),typeof re.componentDidUpdate=="function"&&(S.flags|=4),typeof re.getSnapshotBeforeUpdate=="function"&&(S.flags|=1024)):(typeof re.componentDidUpdate!="function"||be===w.memoizedProps&&Gt===w.memoizedState||(S.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||be===w.memoizedProps&&Gt===w.memoizedState||(S.flags|=1024),S.memoizedProps=M,S.memoizedState=zt),re.props=M,re.state=zt,re.context=Ue,M=Je):(typeof re.componentDidUpdate!="function"||be===w.memoizedProps&&Gt===w.memoizedState||(S.flags|=4),typeof re.getSnapshotBeforeUpdate!="function"||be===w.memoizedProps&&Gt===w.memoizedState||(S.flags|=1024),M=!1)}return hD(w,S,N,M,U,D)}function hD(w,S,N,M,D,U){x8(w,S);var re=(S.flags&128)!==0;if(!M&&!re)return D&&yy(S,N,!1),hd(w,S,U);M=S.stateNode,Vwe.current=S;var be=re&&typeof N.getDerivedStateFromError!="function"?null:M.render();return S.flags|=1,w!==null&&re?(S.child=_y(S,w.child,null,U),S.child=_y(S,null,be,U)):Ta(w,S,be,U),S.memoizedState=M.state,D&&yy(S,N,!0),S.child}function w8(w){var S=w.stateNode;S.pendingContext?au(w,S.pendingContext,S.pendingContext!==S.context):S.context&&au(w,S.context,!1),JO(w,S.containerInfo)}function S8(w,S,N,M,D){return Sy(),QO(D),S.flags|=256,Ta(w,S,N,M),S.child}var iC={dehydrated:null,treeContext:null,retryLane:0};function sC(w){return{baseLanes:w,cachePool:null}}function _8(w,S,N){var M=S.pendingProps,D=ti.current,U=!1,re=(S.flags&128)!==0,be;if((be=re)||(be=w!==null&&w.memoizedState===null?!1:(D&2)!==0),be?(U=!0,S.flags&=-129):(w===null||w.memoizedState!==null)&&(D|=1),_t(ti,D&1),w===null)return ZO(S),w=S.memoizedState,w!==null&&(w=w.dehydrated,w!==null)?(S.mode&1?Mb(w)?S.lanes=8:S.lanes=1073741824:S.lanes=1,null):(D=M.children,w=M.fallback,U?(M=S.mode,U=S.child,D={mode:"hidden",children:D},!(M&1)&&U!==null?(U.childLanes=0,U.pendingProps=D):U=EC(D,M,0,null),w=Vp(w,M,N,null),U.return=S,w.return=S,U.sibling=w,S.child=U,S.child.memoizedState=sC(N),S.memoizedState=iC,w):fD(S,D));if(D=w.memoizedState,D!==null){if(be=D.dehydrated,be!==null){if(re)return S.flags&256?(S.flags&=-257,aC(w,S,N,Error(a(422)))):S.memoizedState!==null?(S.child=w.child,S.flags|=128,null):(U=M.fallback,D=S.mode,M=EC({mode:"visible",children:M.children},D,0,null),U=Vp(U,D,N,null),U.flags|=2,M.return=S,U.return=S,M.sibling=U,S.child=M,S.mode&1&&_y(S,w.child,null,N),S.child.memoizedState=sC(N),S.memoizedState=iC,U);if(!(S.mode&1))S=aC(w,S,N,null);else if(Mb(be))S=aC(w,S,N,Error(a(419)));else if(M=(N&w.childLanes)!==0,Ro||M){if(M=Li,M!==null){switch(N&-N){case 4:U=2;break;case 16:U=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:U=32;break;case 536870912:U=268435456;break;default:U=0}M=U&(M.suspendedLanes|N)?0:U,M!==0&&M!==D.retryLane&&(D.retryLane=M,ml(w,M,-1))}PD(),S=aC(w,S,N,Error(a(421)))}else kb(be)?(S.flags|=128,S.child=w.child,S=n1e.bind(null,w),py(be,S),S=null):(N=D.treeContext,ke&&(Mo=RE(be),ko=S,Hr=!0,rc=null,Ob=!1,N!==null&&(dl[hl++]=cd,dl[hl++]=ud,dl[hl++]=Dp,cd=N.id,ud=N.overflow,Dp=S)),S=fD(S,S.pendingProps.children),S.flags|=4096);return S}return U?(M=E8(w,S,M.children,M.fallback,N),U=S.child,D=w.child.memoizedState,U.memoizedState=D===null?sC(N):{baseLanes:D.baseLanes|N,cachePool:null},U.childLanes=w.childLanes&~N,S.memoizedState=iC,M):(N=T8(w,S,M.children,N),S.memoizedState=null,N)}return U?(M=E8(w,S,M.children,M.fallback,N),U=S.child,D=w.child.memoizedState,U.memoizedState=D===null?sC(N):{baseLanes:D.baseLanes|N,cachePool:null},U.childLanes=w.childLanes&~N,S.memoizedState=iC,M):(N=T8(w,S,M.children,N),S.memoizedState=null,N)}function fD(w,S){return S=EC({mode:"visible",children:S},w.mode,0,null),S.return=w,w.child=S}function T8(w,S,N,M){var D=w.child;return w=D.sibling,N=Rh(D,{mode:"visible",children:N}),!(S.mode&1)&&(N.lanes=M),N.return=S,N.sibling=null,w!==null&&(M=S.deletions,M===null?(S.deletions=[w],S.flags|=16):M.push(w)),S.child=N}function E8(w,S,N,M,D){var U=S.mode;w=w.child;var re=w.sibling,be={mode:"hidden",children:N};return!(U&1)&&S.child!==w?(N=S.child,N.childLanes=0,N.pendingProps=be,S.deletions=null):(N=Rh(w,be),N.subtreeFlags=w.subtreeFlags&14680064),re!==null?M=Rh(re,M):(M=Vp(M,U,D,null),M.flags|=2),M.return=S,N.return=S,N.sibling=M,S.child=N,M}function aC(w,S,N,M){return M!==null&&QO(M),_y(S,w.child,null,N),w=fD(S,S.pendingProps.children),w.flags|=2,S.memoizedState=null,w}function C8(w,S,N){w.lanes|=S;var M=w.alternate;M!==null&&(M.lanes|=S),WO(w.return,S,N)}function pD(w,S,N,M,D){var U=w.memoizedState;U===null?w.memoizedState={isBackwards:S,rendering:null,renderingStartTime:0,last:M,tail:N,tailMode:D}:(U.isBackwards=S,U.rendering=null,U.renderingStartTime=0,U.last=M,U.tail=N,U.tailMode=D)}function N8(w,S,N){var M=S.pendingProps,D=M.revealOrder,U=M.tail;if(Ta(w,S,M.children,N),M=ti.current,M&2)M=M&1|2,S.flags|=128;else{if(w!==null&&w.flags&128)e:for(w=S.child;w!==null;){if(w.tag===13)w.memoizedState!==null&&C8(w,N,S);else if(w.tag===19)C8(w,N,S);else if(w.child!==null){w.child.return=w,w=w.child;continue}if(w===S)break e;for(;w.sibling===null;){if(w.return===null||w.return===S)break e;w=w.return}w.sibling.return=w.return,w=w.sibling}M&=1}if(_t(ti,M),!(S.mode&1))S.memoizedState=null;else switch(D){case"forwards":for(N=S.child,D=null;N!==null;)w=N.alternate,w!==null&&XE(w)===null&&(D=N),N=N.sibling;N=D,N===null?(D=S.child,S.child=null):(D=N.sibling,N.sibling=null),pD(S,!1,D,N,U);break;case"backwards":for(N=null,D=S.child,S.child=null;D!==null;){if(w=D.alternate,w!==null&&XE(w)===null){S.child=D;break}w=D.sibling,D.sibling=N,N=D,D=w}pD(S,!0,N,null,U);break;case"together":pD(S,!1,null,null,void 0);break;default:S.memoizedState=null}return S.child}function hd(w,S,N){if(w!==null&&(S.dependencies=w.dependencies),Ay|=S.lanes,!(N&S.childLanes))return null;if(w!==null&&S.child!==w.child)throw Error(a(153));if(S.child!==null){for(w=S.child,N=Rh(w,w.pendingProps),S.child=N,N.return=S;w.sibling!==null;)w=w.sibling,N=N.sibling=Rh(w,w.pendingProps),N.return=S;N.sibling=null}return S.child}function Wwe(w,S,N){switch(S.tag){case 3:w8(S),Sy();break;case 5:V6(S);break;case 1:ys(S.type)&&Ls(S);break;case 4:JO(S,S.stateNode.containerInfo);break;case 10:A6(S,S.type._context,S.memoizedProps.value);break;case 13:var M=S.memoizedState;if(M!==null)return M.dehydrated!==null?(_t(ti,ti.current&1),S.flags|=128,null):N&S.child.childLanes?_8(w,S,N):(_t(ti,ti.current&1),w=hd(w,S,N),w!==null?w.sibling:null);_t(ti,ti.current&1);break;case 19:if(M=(N&S.childLanes)!==0,w.flags&128){if(M)return N8(w,S,N);S.flags|=128}var D=S.memoizedState;if(D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),_t(ti,ti.current),M)break;return null;case 22:case 23:return S.lanes=0,v8(w,S,N)}return hd(w,S,N)}function Hwe(w,S){switch(KO(S),S.tag){case 1:return ys(S.type)&&Ei(),w=S.flags,w&65536?(S.flags=w&-65537|128,S):null;case 3:return Ey(),Jt(hi),Jt(In),nD(),w=S.flags,w&65536&&!(w&128)?(S.flags=w&-65537|128,S):null;case 5:return eD(S),null;case 13:if(Jt(ti),w=S.memoizedState,w!==null&&w.dehydrated!==null){if(S.alternate===null)throw Error(a(340));Sy()}return w=S.flags,w&65536?(S.flags=w&-65537|128,S):null;case 19:return Jt(ti),null;case 4:return Ey(),null;case 10:return VO(S.type._context),null;case 22:case 23:return RD(),null;case 24:return null;default:return null}}var oC=!1,Fp=!1,Gwe=typeof WeakSet=="function"?WeakSet:Set,pt=null;function lC(w,S){var N=w.ref;if(N!==null)if(typeof N=="function")try{N(null)}catch(M){Ja(w,S,M)}else N.current=null}function mD(w,S,N){try{N()}catch(M){Ja(w,S,M)}}var A8=!1;function qwe(w,S){for(V(w.containerInfo),pt=S;pt!==null;)if(w=pt,S=w.child,(w.subtreeFlags&1028)!==0&&S!==null)S.return=w,pt=S;else for(;pt!==null;){w=pt;try{var N=w.alternate;if(w.flags&1024)switch(w.tag){case 0:case 11:case 15:break;case 1:if(N!==null){var M=N.memoizedProps,D=N.memoizedState,U=w.stateNode,re=U.getSnapshotBeforeUpdate(w.elementType===w.type?M:nc(w.type,M),D);U.__reactInternalSnapshotBeforeUpdate=re}break;case 3:Ce&&dt(w.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(a(163))}}catch(be){Ja(w,w.return,be)}if(S=w.sibling,S!==null){S.return=w.return,pt=S;break}pt=w.return}return N=A8,A8=!1,N}function jp(w,S,N){var M=S.updateQueue;if(M=M!==null?M.lastEffect:null,M!==null){var D=M=M.next;do{if((D.tag&w)===w){var U=D.destroy;D.destroy=void 0,U!==void 0&&mD(S,N,U)}D=D.next}while(D!==M)}}function Gb(w,S){if(S=S.updateQueue,S=S!==null?S.lastEffect:null,S!==null){var N=S=S.next;do{if((N.tag&w)===w){var M=N.create;N.destroy=M()}N=N.next}while(N!==S)}}function gD(w){var S=w.ref;if(S!==null){var N=w.stateNode;switch(w.tag){case 5:w=B(N);break;default:w=N}typeof S=="function"?S(w):S.current=w}}function I8(w,S,N){if(ou&&typeof ou.onCommitFiberUnmount=="function")try{ou.onCommitFiberUnmount(LE,S)}catch{}switch(S.tag){case 0:case 11:case 14:case 15:if(w=S.updateQueue,w!==null&&(w=w.lastEffect,w!==null)){var M=w=w.next;do{var D=M,U=D.destroy;D=D.tag,U!==void 0&&(D&2||D&4)&&mD(S,N,U),M=M.next}while(M!==w)}break;case 1:if(lC(S,N),w=S.stateNode,typeof w.componentWillUnmount=="function")try{w.props=S.memoizedProps,w.state=S.memoizedState,w.componentWillUnmount()}catch(re){Ja(S,N,re)}break;case 5:lC(S,N);break;case 4:Ce?D8(w,S,N):G&&G&&(S=S.stateNode.containerInfo,N=Zt(S),ur(S,N))}}function k8(w,S,N){for(var M=S;;)if(I8(w,M,N),M.child===null||Ce&&M.tag===4){if(M===S)break;for(;M.sibling===null;){if(M.return===null||M.return===S)return;M=M.return}M.sibling.return=M.return,M=M.sibling}else M.child.return=M,M=M.child}function M8(w){var S=w.alternate;S!==null&&(w.alternate=null,M8(S)),w.child=null,w.deletions=null,w.sibling=null,w.tag===5&&(S=w.stateNode,S!==null&&Ye(S)),w.stateNode=null,w.return=null,w.dependencies=null,w.memoizedProps=null,w.memoizedState=null,w.pendingProps=null,w.stateNode=null,w.updateQueue=null}function R8(w){return w.tag===5||w.tag===3||w.tag===4}function P8(w){e:for(;;){for(;w.sibling===null;){if(w.return===null||R8(w.return))return null;w=w.return}for(w.sibling.return=w.return,w=w.sibling;w.tag!==5&&w.tag!==6&&w.tag!==18;){if(w.flags&2||w.child===null||w.tag===4)continue e;w.child.return=w,w=w.child}if(!(w.flags&2))return w.stateNode}}function O8(w){if(Ce){e:{for(var S=w.return;S!==null;){if(R8(S))break e;S=S.return}throw Error(a(160))}var N=S;switch(N.tag){case 5:S=N.stateNode,N.flags&32&&(Hn(S),N.flags&=-33),N=P8(w),vD(w,N,S);break;case 3:case 4:S=N.stateNode.containerInfo,N=P8(w),yD(w,N,S);break;default:throw Error(a(161))}}}function yD(w,S,N){var M=w.tag;if(M===5||M===6)w=w.stateNode,S?Ot(N,w,S):rt(N,w);else if(M!==4&&(w=w.child,w!==null))for(yD(w,S,N),w=w.sibling;w!==null;)yD(w,S,N),w=w.sibling}function vD(w,S,N){var M=w.tag;if(M===5||M===6)w=w.stateNode,S?Vt(N,w,S):Ge(N,w);else if(M!==4&&(w=w.child,w!==null))for(vD(w,S,N),w=w.sibling;w!==null;)vD(w,S,N),w=w.sibling}function D8(w,S,N){for(var M=S,D=!1,U,re;;){if(!D){D=M.return;e:for(;;){if(D===null)throw Error(a(160));switch(U=D.stateNode,D.tag){case 5:re=!1;break e;case 3:U=U.containerInfo,re=!0;break e;case 4:U=U.containerInfo,re=!0;break e}D=D.return}D=!0}if(M.tag===5||M.tag===6)k8(w,M,N),re?ln(U,M.stateNode):bt(U,M.stateNode);else if(M.tag===18)re?$e(U,M.stateNode):ze(U,M.stateNode);else if(M.tag===4){if(M.child!==null){U=M.stateNode.containerInfo,re=!0,M.child.return=M,M=M.child;continue}}else if(I8(w,M,N),M.child!==null){M.child.return=M,M=M.child;continue}if(M===S)break;for(;M.sibling===null;){if(M.return===null||M.return===S)return;M=M.return,M.tag===4&&(D=!1)}M.sibling.return=M.return,M=M.sibling}}function xD(w,S){if(Ce){switch(S.tag){case 0:case 11:case 14:case 15:jp(3,S,S.return),Gb(3,S),jp(5,S,S.return);return;case 1:return;case 5:var N=S.stateNode;if(N!=null){var M=S.memoizedProps;w=w!==null?w.memoizedProps:M;var D=S.type,U=S.updateQueue;S.updateQueue=null,U!==null&&hn(N,U,D,w,M,S)}return;case 6:if(S.stateNode===null)throw Error(a(162));N=S.memoizedProps,We(S.stateNode,w!==null?w.memoizedProps:N,N);return;case 3:ke&&w!==null&&w.memoizedState.isDehydrated&&Ne(S.stateNode.containerInfo);return;case 12:return;case 13:cC(S);return;case 19:cC(S);return;case 17:return}throw Error(a(163))}switch(S.tag){case 0:case 11:case 14:case 15:jp(3,S,S.return),Gb(3,S),jp(5,S,S.return);return;case 12:return;case 13:cC(S);return;case 19:cC(S);return;case 3:ke&&w!==null&&w.memoizedState.isDehydrated&&Ne(S.stateNode.containerInfo);break;case 22:case 23:return}e:if(G){switch(S.tag){case 1:case 5:case 6:break e;case 3:case 4:S=S.stateNode,ur(S.containerInfo,S.pendingChildren);break e}throw Error(a(163))}}function cC(w){var S=w.updateQueue;if(S!==null){w.updateQueue=null;var N=w.stateNode;N===null&&(N=w.stateNode=new Gwe),S.forEach(function(M){var D=r1e.bind(null,w,M);N.has(M)||(N.add(M),M.then(D,D))})}}function Xwe(w,S){for(pt=S;pt!==null;){S=pt;var N=S.deletions;if(N!==null)for(var M=0;M<N.length;M++){var D=N[M];try{var U=w;Ce?D8(U,D,S):k8(U,D,S);var re=D.alternate;re!==null&&(re.return=null),D.return=null}catch($t){Ja(D,S,$t)}}if(N=S.child,S.subtreeFlags&12854&&N!==null)N.return=S,pt=N;else for(;pt!==null;){S=pt;try{var be=S.flags;if(be&32&&Ce&&Hn(S.stateNode),be&512){var Ue=S.alternate;if(Ue!==null){var Je=Ue.ref;Je!==null&&(typeof Je=="function"?Je(null):Je.current=null)}}if(be&8192)switch(S.tag){case 13:if(S.memoizedState!==null){var Tt=S.alternate;(Tt===null||Tt.memoizedState===null)&&(CD=vs())}break;case 22:var fn=S.memoizedState!==null,Gt=S.alternate,Er=Gt!==null&&Gt.memoizedState!==null;if(N=S,Ce){e:if(M=N,D=fn,U=null,Ce)for(var zt=M;;){if(zt.tag===5){if(U===null){U=zt;var Js=zt.stateNode;D?Tr(Js):it(zt.stateNode,zt.memoizedProps)}}else if(zt.tag===6){if(U===null){var yl=zt.stateNode;D?Sn(yl):pe(yl,zt.memoizedProps)}}else if((zt.tag!==22&&zt.tag!==23||zt.memoizedState===null||zt===M)&&zt.child!==null){zt.child.return=zt,zt=zt.child;continue}if(zt===M)break;for(;zt.sibling===null;){if(zt.return===null||zt.return===M)break e;U===zt&&(U=null),zt=zt.return}U===zt&&(U=null),zt.sibling.return=zt.return,zt=zt.sibling}}if(fn&&!Er&&N.mode&1){pt=N;for(var Re=N.child;Re!==null;){for(N=pt=Re;pt!==null;){M=pt;var Se=M.child;switch(M.tag){case 0:case 11:case 14:case 15:jp(4,M,M.return);break;case 1:lC(M,M.return);var Be=M.stateNode;if(typeof Be.componentWillUnmount=="function"){var gt=M.return;try{Be.props=M.memoizedProps,Be.state=M.memoizedState,Be.componentWillUnmount()}catch($t){Ja(M,gt,$t)}}break;case 5:lC(M,M.return);break;case 22:if(M.memoizedState!==null){F8(N);continue}}Se!==null?(Se.return=M,pt=Se):F8(N)}Re=Re.sibling}}}switch(be&4102){case 2:O8(S),S.flags&=-3;break;case 6:O8(S),S.flags&=-3,xD(S.alternate,S);break;case 4096:S.flags&=-4097;break;case 4100:S.flags&=-4097,xD(S.alternate,S);break;case 4:xD(S.alternate,S)}}catch($t){Ja(S,S.return,$t)}if(N=S.sibling,N!==null){N.return=S.return,pt=N;break}pt=S.return}}}function Kwe(w,S,N){pt=w,$8(w)}function $8(w,S,N){for(var M=(w.mode&1)!==0;pt!==null;){var D=pt,U=D.child;if(D.tag===22&&M){var re=D.memoizedState!==null||oC;if(!re){var be=D.alternate,Ue=be!==null&&be.memoizedState!==null||Fp;be=oC;var Je=Fp;if(oC=re,(Fp=Ue)&&!Je)for(pt=D;pt!==null;)re=pt,Ue=re.child,re.tag===22&&re.memoizedState!==null?j8(D):Ue!==null?(Ue.return=re,pt=Ue):j8(D);for(;U!==null;)pt=U,$8(U),U=U.sibling;pt=D,oC=be,Fp=Je}L8(w)}else D.subtreeFlags&8772&&U!==null?(U.return=D,pt=U):L8(w)}}function L8(w){for(;pt!==null;){var S=pt;if(S.flags&8772){var N=S.alternate;try{if(S.flags&8772)switch(S.tag){case 0:case 11:case 15:Fp||Gb(5,S);break;case 1:var M=S.stateNode;if(S.flags&4&&!Fp)if(N===null)M.componentDidMount();else{var D=S.elementType===S.type?N.memoizedProps:nc(S.type,N.memoizedProps);M.componentDidUpdate(D,N.memoizedState,M.__reactInternalSnapshotBeforeUpdate)}var U=S.updateQueue;U!==null&&M6(S,U,M);break;case 3:var re=S.updateQueue;if(re!==null){if(N=null,S.child!==null)switch(S.child.tag){case 5:N=B(S.child.stateNode);break;case 1:N=S.child.stateNode}M6(S,re,N)}break;case 5:var be=S.stateNode;N===null&&S.flags&4&&Ut(be,S.type,S.memoizedProps,S);break;case 6:break;case 4:break;case 12:break;case 13:if(ke&&S.memoizedState===null){var Ue=S.alternate;if(Ue!==null){var Je=Ue.memoizedState;if(Je!==null){var Tt=Je.dehydrated;Tt!==null&&Fe(Tt)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(a(163))}Fp||S.flags&512&&gD(S)}catch(fn){Ja(S,S.return,fn)}}if(S===w){pt=null;break}if(N=S.sibling,N!==null){N.return=S.return,pt=N;break}pt=S.return}}function F8(w){for(;pt!==null;){var S=pt;if(S===w){pt=null;break}var N=S.sibling;if(N!==null){N.return=S.return,pt=N;break}pt=S.return}}function j8(w){for(;pt!==null;){var S=pt;try{switch(S.tag){case 0:case 11:case 15:var N=S.return;try{Gb(4,S)}catch(Ue){Ja(S,N,Ue)}break;case 1:var M=S.stateNode;if(typeof M.componentDidMount=="function"){var D=S.return;try{M.componentDidMount()}catch(Ue){Ja(S,D,Ue)}}var U=S.return;try{gD(S)}catch(Ue){Ja(S,U,Ue)}break;case 5:var re=S.return;try{gD(S)}catch(Ue){Ja(S,re,Ue)}}}catch(Ue){Ja(S,S.return,Ue)}if(S===w){pt=null;break}var be=S.sibling;if(be!==null){be.return=S.return,pt=be;break}pt=S.return}}var uC=0,dC=1,hC=2,fC=3,pC=4;if(typeof Symbol=="function"&&Symbol.for){var qb=Symbol.for;uC=qb("selector.component"),dC=qb("selector.has_pseudo_class"),hC=qb("selector.role"),fC=qb("selector.test_id"),pC=qb("selector.text")}function bD(w){var S=xe(w);if(S!=null){if(typeof S.memoizedProps["data-testname"]!="string")throw Error(a(364));return S}if(w=we(w),w===null)throw Error(a(362));return w.stateNode.current}function wD(w,S){switch(S.$$typeof){case uC:if(w.type===S.value)return!0;break;case dC:e:{S=S.value,w=[w,0];for(var N=0;N<w.length;){var M=w[N++],D=w[N++],U=S[D];if(M.tag!==5||!ae(M)){for(;U!=null&&wD(M,U);)D++,U=S[D];if(D===S.length){S=!0;break e}else for(M=M.child;M!==null;)w.push(M,D),M=M.sibling}}S=!1}return S;case hC:if(w.tag===5&&Le(w.stateNode,S.value))return!0;break;case pC:if((w.tag===5||w.tag===6)&&(w=ie(w),w!==null&&0<=w.indexOf(S.value)))return!0;break;case fC:if(w.tag===5&&(w=w.memoizedProps["data-testname"],typeof w=="string"&&w.toLowerCase()===S.value.toLowerCase()))return!0;break;default:throw Error(a(365))}return!1}function SD(w){switch(w.$$typeof){case uC:return"<"+(C(w.value)||"Unknown")+">";case dC:return":has("+(SD(w)||"")+")";case hC:return'[role="'+w.value+'"]';case pC:return'"'+w.value+'"';case fC:return'[data-testname="'+w.value+'"]';default:throw Error(a(365))}}function z8(w,S){var N=[];w=[w,0];for(var M=0;M<w.length;){var D=w[M++],U=w[M++],re=S[U];if(D.tag!==5||!ae(D)){for(;re!=null&&wD(D,re);)U++,re=S[U];if(U===S.length)N.push(D);else for(D=D.child;D!==null;)w.push(D,U),D=D.sibling}}return N}function _D(w,S){if(!X)throw Error(a(363));w=bD(w),w=z8(w,S),S=[],w=Array.from(w);for(var N=0;N<w.length;){var M=w[N++];if(M.tag===5)ae(M)||S.push(M.stateNode);else for(M=M.child;M!==null;)w.push(M),M=M.sibling}return S}var Ywe=Math.ceil,mC=o.ReactCurrentDispatcher,TD=o.ReactCurrentOwner,Ci=o.ReactCurrentBatchConfig,kn=0,Li=null,Fi=null,Fs=0,Po=0,Ny=gs(0),Qi=0,Xb=null,Ay=0,gC=0,ED=0,Kb=null,Za=null,CD=0,ND=1/0;function Iy(){ND=vs()+500}var yC=!1,AD=null,Ah=null,vC=!1,Ih=null,xC=0,Yb=0,ID=null,bC=-1,wC=0;function Ea(){return kn&6?vs():bC!==-1?bC:bC=vs()}function kh(w){return w.mode&1?kn&2&&Fs!==0?Fs&-Fs:Rwe.transition!==null?(wC===0&&(w=OE,OE<<=1,!(OE&4194240)&&(OE=64),wC=w),wC):(w=Qn,w!==0?w:Te()):1}function ml(w,S,N){if(50<Yb)throw Yb=0,ID=null,Error(a(185));var M=SC(w,S);return M===null?null:(Pb(M,S,N),(!(kn&2)||M!==Li)&&(M===Li&&(!(kn&2)&&(gC|=S),Qi===4&&Mh(M,Fs)),Qa(M,N),S===1&&kn===0&&!(w.mode&1)&&(Iy(),FE&&cu())),M)}function SC(w,S){w.lanes|=S;var N=w.alternate;for(N!==null&&(N.lanes|=S),N=w,w=w.return;w!==null;)w.childLanes|=S,N=w.alternate,N!==null&&(N.childLanes|=S),N=w,w=w.return;return N.tag===3?N.stateNode:null}function Qa(w,S){var N=w.callbackNode;_we(w,S);var M=$E(w,w===Li?Fs:0);if(M===0)N!==null&&C6(N),w.callbackNode=null,w.callbackPriority=0;else if(S=M&-M,w.callbackPriority!==S){if(N!=null&&C6(N),S===1)w.tag===0?Mwe(U8.bind(null,w)):N6(U8.bind(null,w)),qe?Q(function(){kn===0&&cu()}):LO(FO,cu),N=null;else{switch(E6(M)){case 1:N=FO;break;case 4:N=Nwe;break;case 16:N=jO;break;case 536870912:N=Awe;break;default:N=jO}N=Z8(N,B8.bind(null,w))}w.callbackPriority=S,w.callbackNode=N}}function B8(w,S){if(bC=-1,wC=0,kn&6)throw Error(a(327));var N=w.callbackNode;if(Up()&&w.callbackNode!==N)return null;var M=$E(w,w===Li?Fs:0);if(M===0)return null;if(M&30||M&w.expiredLanes||S)S=_C(w,M);else{S=M;var D=kn;kn|=2;var U=H8();(Li!==w||Fs!==S)&&(Iy(),zp(w,S));do try{Jwe();break}catch(be){W8(w,be)}while(!0);UO(),mC.current=U,kn=D,Fi!==null?S=0:(Li=null,Fs=0,S=Qi)}if(S!==0){if(S===2&&(D=OO(w),D!==0&&(M=D,S=kD(w,D))),S===1)throw N=Xb,zp(w,0),Mh(w,M),Qa(w,vs()),N;if(S===6)Mh(w,M);else{if(D=w.current.alternate,!(M&30)&&!Zwe(D)&&(S=_C(w,M),S===2&&(U=OO(w),U!==0&&(M=U,S=kD(w,U))),S===1))throw N=Xb,zp(w,0),Mh(w,M),Qa(w,vs()),N;switch(w.finishedWork=D,w.finishedLanes=M,S){case 0:case 1:throw Error(a(345));case 2:Bp(w,Za);break;case 3:if(Mh(w,M),(M&130023424)===M&&(S=CD+500-vs(),10<S)){if($E(w,0)!==0)break;if(D=w.suspendedLanes,(D&M)!==M){Ea(),w.pingedLanes|=w.suspendedLanes&D;break}w.timeoutHandle=me(Bp.bind(null,w,Za),S);break}Bp(w,Za);break;case 4:if(Mh(w,M),(M&4194240)===M)break;for(S=w.eventTimes,D=-1;0<M;){var re=31-Io(M);U=1<<re,re=S[re],re>D&&(D=re),M&=~U}if(M=D,M=vs()-M,M=(120>M?120:480>M?480:1080>M?1080:1920>M?1920:3e3>M?3e3:4320>M?4320:1960*Ywe(M/1960))-M,10<M){w.timeoutHandle=me(Bp.bind(null,w,Za),M);break}Bp(w,Za);break;case 5:Bp(w,Za);break;default:throw Error(a(329))}}}return Qa(w,vs()),w.callbackNode===N?B8.bind(null,w):null}function kD(w,S){var N=Kb;return w.current.memoizedState.isDehydrated&&(zp(w,S).flags|=256),w=_C(w,S),w!==2&&(S=Za,Za=N,S!==null&&MD(S)),w}function MD(w){Za===null?Za=w:Za.push.apply(Za,w)}function Zwe(w){for(var S=w;;){if(S.flags&16384){var N=S.updateQueue;if(N!==null&&(N=N.stores,N!==null))for(var M=0;M<N.length;M++){var D=N[M],U=D.getSnapshot;D=D.value;try{if(!lu(U(),D))return!1}catch{return!1}}}if(N=S.child,S.subtreeFlags&16384&&N!==null)N.return=S,S=N;else{if(S===w)break;for(;S.sibling===null;){if(S.return===null||S.return===w)return!0;S=S.return}S.sibling.return=S.return,S=S.sibling}}return!0}function Mh(w,S){for(S&=~ED,S&=~gC,w.suspendedLanes|=S,w.pingedLanes&=~S,w=w.expirationTimes;0<S;){var N=31-Io(S),M=1<<N;w[N]=-1,S&=~M}}function U8(w){if(kn&6)throw Error(a(327));Up();var S=$E(w,0);if(!(S&1))return Qa(w,vs()),null;var N=_C(w,S);if(w.tag!==0&&N===2){var M=OO(w);M!==0&&(S=M,N=kD(w,M))}if(N===1)throw N=Xb,zp(w,0),Mh(w,S),Qa(w,vs()),N;if(N===6)throw Error(a(345));return w.finishedWork=w.current.alternate,w.finishedLanes=S,Bp(w,Za),Qa(w,vs()),null}function V8(w){Ih!==null&&Ih.tag===0&&!(kn&6)&&Up();var S=kn;kn|=1;var N=Ci.transition,M=Qn;try{if(Ci.transition=null,Qn=1,w)return w()}finally{Qn=M,Ci.transition=N,kn=S,!(kn&6)&&cu()}}function RD(){Po=Ny.current,Jt(Ny)}function zp(w,S){w.finishedWork=null,w.finishedLanes=0;var N=w.timeoutHandle;if(N!==ge&&(w.timeoutHandle=ge,De(N)),Fi!==null)for(N=Fi.return;N!==null;){var M=N;switch(KO(M),M.tag){case 1:M=M.type.childContextTypes,M!=null&&Ei();break;case 3:Ey(),Jt(hi),Jt(In),nD();break;case 5:eD(M);break;case 4:Ey();break;case 13:Jt(ti);break;case 19:Jt(ti);break;case 10:VO(M.type._context);break;case 22:case 23:RD()}N=N.return}if(Li=w,Fi=w=Rh(w.current,null),Fs=Po=S,Qi=0,Xb=null,ED=gC=Ay=0,Za=Kb=null,uu!==null){for(S=0;S<uu.length;S++)if(N=uu[S],M=N.interleaved,M!==null){N.interleaved=null;var D=M.next,U=N.pending;if(U!==null){var re=U.next;U.next=D,M.next=re}N.pending=M}uu=null}return w}function W8(w,S){do{var N=Fi;try{if(UO(),KE.current=tC,YE){for(var M=fi.memoizedState;M!==null;){var D=M.queue;D!==null&&(D.pending=null),M=M.next}YE=!1}if(Cy=0,xs=Ys=fi=null,jb=!1,zb=0,TD.current=null,N===null||N.return===null){Qi=1,Xb=S,Fi=null;break}e:{var U=w,re=N.return,be=N,Ue=S;if(S=Fs,be.flags|=32768,Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"){var Je=Ue,Tt=be,fn=Tt.tag;if(!(Tt.mode&1)&&(fn===0||fn===11||fn===15)){var Gt=Tt.alternate;Gt?(Tt.updateQueue=Gt.updateQueue,Tt.memoizedState=Gt.memoizedState,Tt.lanes=Gt.lanes):(Tt.updateQueue=null,Tt.memoizedState=null)}var Er=d8(re);if(Er!==null){Er.flags&=-257,h8(Er,re,be,U,S),Er.mode&1&&u8(U,Je,S),S=Er,Ue=Je;var zt=S.updateQueue;if(zt===null){var Js=new Set;Js.add(Ue),S.updateQueue=Js}else zt.add(Ue);break e}else{if(!(S&1)){u8(U,Je,S),PD();break e}Ue=Error(a(426))}}else if(Hr&&be.mode&1){var yl=d8(re);if(yl!==null){!(yl.flags&65536)&&(yl.flags|=256),h8(yl,re,be,U,S),QO(Ue);break e}}U=Ue,Qi!==4&&(Qi=2),Kb===null?Kb=[U]:Kb.push(U),Ue=cD(Ue,be),be=re;do{switch(be.tag){case 3:be.flags|=65536,S&=-S,be.lanes|=S;var Re=l8(be,Ue,S);k6(be,Re);break e;case 1:U=Ue;var Se=be.type,Be=be.stateNode;if(!(be.flags&128)&&(typeof Se.getDerivedStateFromError=="function"||Be!==null&&typeof Be.componentDidCatch=="function"&&(Ah===null||!Ah.has(Be)))){be.flags|=65536,S&=-S,be.lanes|=S;var gt=c8(be,U,S);k6(be,gt);break e}}be=be.return}while(be!==null)}q8(N)}catch($t){S=$t,Fi===N&&N!==null&&(Fi=N=N.return);continue}break}while(!0)}function H8(){var w=mC.current;return mC.current=tC,w===null?tC:w}function PD(){(Qi===0||Qi===3||Qi===2)&&(Qi=4),Li===null||!(Ay&268435455)&&!(gC&268435455)||Mh(Li,Fs)}function _C(w,S){var N=kn;kn|=2;var M=H8();Li===w&&Fs===S||zp(w,S);do try{Qwe();break}catch(D){W8(w,D)}while(!0);if(UO(),kn=N,mC.current=M,Fi!==null)throw Error(a(261));return Li=null,Fs=0,Qi}function Qwe(){for(;Fi!==null;)G8(Fi)}function Jwe(){for(;Fi!==null&&!Ewe();)G8(Fi)}function G8(w){var S=Y8(w.alternate,w,Po);w.memoizedProps=w.pendingProps,S===null?q8(w):Fi=S,TD.current=null}function q8(w){var S=w;do{var N=S.alternate;if(w=S.return,S.flags&32768){if(N=Hwe(N,S),N!==null){N.flags&=32767,Fi=N;return}if(w!==null)w.flags|=32768,w.subtreeFlags=0,w.deletions=null;else{Qi=6,Fi=null;return}}else if(N=Uwe(N,S,Po),N!==null){Fi=N;return}if(S=S.sibling,S!==null){Fi=S;return}Fi=S=w}while(S!==null);Qi===0&&(Qi=5)}function Bp(w,S){var N=Qn,M=Ci.transition;try{Ci.transition=null,Qn=1,e1e(w,S,N)}finally{Ci.transition=M,Qn=N}return null}function e1e(w,S,N){do Up();while(Ih!==null);if(kn&6)throw Error(a(327));var M=w.finishedWork,D=w.finishedLanes;if(M===null)return null;if(w.finishedWork=null,w.finishedLanes=0,M===w.current)throw Error(a(177));w.callbackNode=null,w.callbackPriority=0;var U=M.lanes|M.childLanes;if(Twe(w,U),w===Li&&(Fi=Li=null,Fs=0),!(M.subtreeFlags&2064)&&!(M.flags&2064)||vC||(vC=!0,Z8(jO,function(){return Up(),null})),U=(M.flags&15990)!==0,M.subtreeFlags&15990||U){U=Ci.transition,Ci.transition=null;var re=Qn;Qn=1;var be=kn;kn|=4,TD.current=null,qwe(w,M),Xwe(w,M),H(w.containerInfo),w.current=M,Kwe(M),Cwe(),kn=be,Qn=re,Ci.transition=U}else w.current=M;if(vC&&(vC=!1,Ih=w,xC=D),U=w.pendingLanes,U===0&&(Ah=null),Iwe(M.stateNode),Qa(w,vs()),S!==null)for(N=w.onRecoverableError,M=0;M<S.length;M++)N(S[M]);if(yC)throw yC=!1,w=AD,AD=null,w;return xC&1&&w.tag!==0&&Up(),U=w.pendingLanes,U&1?w===ID?Yb++:(Yb=0,ID=w):Yb=0,cu(),null}function Up(){if(Ih!==null){var w=E6(xC),S=Ci.transition,N=Qn;try{if(Ci.transition=null,Qn=16>w?16:w,Ih===null)var M=!1;else{if(w=Ih,Ih=null,xC=0,kn&6)throw Error(a(331));var D=kn;for(kn|=4,pt=w.current;pt!==null;){var U=pt,re=U.child;if(pt.flags&16){var be=U.deletions;if(be!==null){for(var Ue=0;Ue<be.length;Ue++){var Je=be[Ue];for(pt=Je;pt!==null;){var Tt=pt;switch(Tt.tag){case 0:case 11:case 15:jp(8,Tt,U)}var fn=Tt.child;if(fn!==null)fn.return=Tt,pt=fn;else for(;pt!==null;){Tt=pt;var Gt=Tt.sibling,Er=Tt.return;if(M8(Tt),Tt===Je){pt=null;break}if(Gt!==null){Gt.return=Er,pt=Gt;break}pt=Er}}}var zt=U.alternate;if(zt!==null){var Js=zt.child;if(Js!==null){zt.child=null;do{var yl=Js.sibling;Js.sibling=null,Js=yl}while(Js!==null)}}pt=U}}if(U.subtreeFlags&2064&&re!==null)re.return=U,pt=re;else e:for(;pt!==null;){if(U=pt,U.flags&2048)switch(U.tag){case 0:case 11:case 15:jp(9,U,U.return)}var Re=U.sibling;if(Re!==null){Re.return=U.return,pt=Re;break e}pt=U.return}}var Se=w.current;for(pt=Se;pt!==null;){re=pt;var Be=re.child;if(re.subtreeFlags&2064&&Be!==null)Be.return=re,pt=Be;else e:for(re=Se;pt!==null;){if(be=pt,be.flags&2048)try{switch(be.tag){case 0:case 11:case 15:Gb(9,be)}}catch($t){Ja(be,be.return,$t)}if(be===re){pt=null;break e}var gt=be.sibling;if(gt!==null){gt.return=be.return,pt=gt;break e}pt=be.return}}if(kn=D,cu(),ou&&typeof ou.onPostCommitFiberRoot=="function")try{ou.onPostCommitFiberRoot(LE,w)}catch{}M=!0}return M}finally{Qn=N,Ci.transition=S}}return!1}function X8(w,S,N){S=cD(N,S),S=l8(w,S,1),Nh(w,S),S=Ea(),w=SC(w,1),w!==null&&(Pb(w,1,S),Qa(w,S))}function Ja(w,S,N){if(w.tag===3)X8(w,w,N);else for(;S!==null;){if(S.tag===3){X8(S,w,N);break}else if(S.tag===1){var M=S.stateNode;if(typeof S.type.getDerivedStateFromError=="function"||typeof M.componentDidCatch=="function"&&(Ah===null||!Ah.has(M))){w=cD(N,w),w=c8(S,w,1),Nh(S,w),w=Ea(),S=SC(S,1),S!==null&&(Pb(S,1,w),Qa(S,w));break}}S=S.return}}function t1e(w,S,N){var M=w.pingCache;M!==null&&M.delete(S),S=Ea(),w.pingedLanes|=w.suspendedLanes&N,Li===w&&(Fs&N)===N&&(Qi===4||Qi===3&&(Fs&130023424)===Fs&&500>vs()-CD?zp(w,0):ED|=N),Qa(w,S)}function K8(w,S){S===0&&(w.mode&1?(S=DE,DE<<=1,!(DE&130023424)&&(DE=4194304)):S=1);var N=Ea();w=SC(w,S),w!==null&&(Pb(w,S,N),Qa(w,N))}function n1e(w){var S=w.memoizedState,N=0;S!==null&&(N=S.retryLane),K8(w,N)}function r1e(w,S){var N=0;switch(w.tag){case 13:var M=w.stateNode,D=w.memoizedState;D!==null&&(N=D.retryLane);break;case 19:M=w.stateNode;break;default:throw Error(a(314))}M!==null&&M.delete(S),K8(w,N)}var Y8;Y8=function(w,S,N){if(w!==null)if(w.memoizedProps!==S.pendingProps||hi.current)Ro=!0;else{if(!(w.lanes&N)&&!(S.flags&128))return Ro=!1,Wwe(w,S,N);Ro=!!(w.flags&131072)}else Ro=!1,Hr&&S.flags&1048576&&$6(S,GE,S.index);switch(S.lanes=0,S.tag){case 2:var M=S.type;w!==null&&(w.alternate=null,S.alternate=null,S.flags|=2),w=S.pendingProps;var D=cl(S,In.current);xy(S,N),D=iD(null,S,M,w,D,N);var U=sD();return S.flags|=1,typeof D=="object"&&D!==null&&typeof D.render=="function"&&D.$$typeof===void 0?(S.tag=1,S.memoizedState=null,S.updateQueue=null,ys(M)?(U=!0,Ls(S)):U=!1,S.memoizedState=D.state!==null&&D.state!==void 0?D.state:null,HO(S),D.updater=WE,S.stateNode=D,D._reactInternals=S,qO(S,M,w,N),S=hD(null,S,M,!0,U,N)):(S.tag=0,Hr&&U&&XO(S),Ta(null,S,D,N),S=S.child),S;case 16:M=S.elementType;e:{switch(w!==null&&(w.alternate=null,S.alternate=null,S.flags|=2),w=S.pendingProps,D=M._init,M=D(M._payload),S.type=M,D=S.tag=s1e(M),w=nc(M,w),D){case 0:S=dD(null,S,M,w,N);break e;case 1:S=b8(null,S,M,w,N);break e;case 11:S=m8(null,S,M,w,N);break e;case 14:S=g8(null,S,M,nc(M.type,w),N);break e}throw Error(a(306,M,""))}return S;case 0:return M=S.type,D=S.pendingProps,D=S.elementType===M?D:nc(M,D),dD(w,S,M,D,N);case 1:return M=S.type,D=S.pendingProps,D=S.elementType===M?D:nc(M,D),b8(w,S,M,D,N);case 3:e:{if(w8(S),w===null)throw Error(a(387));M=S.pendingProps,U=S.memoizedState,D=U.element,I6(w,S),VE(S,M,null,N);var re=S.memoizedState;if(M=re.element,ke&&U.isDehydrated)if(U={element:M,isDehydrated:!1,cache:re.cache,transitions:re.transitions},S.updateQueue.baseState=U,S.memoizedState=U,S.flags&256){D=Error(a(423)),S=S8(w,S,M,N,D);break e}else if(M!==D){D=Error(a(424)),S=S8(w,S,M,N,D);break e}else for(ke&&(Mo=ME(S.stateNode.containerInfo),ko=S,Hr=!0,rc=null,Ob=!1),N=U6(S,null,M,N),S.child=N;N;)N.flags=N.flags&-3|4096,N=N.sibling;else{if(Sy(),M===D){S=hd(w,S,N);break e}Ta(w,S,M,N)}S=S.child}return S;case 5:return V6(S),w===null&&ZO(S),M=S.type,D=S.pendingProps,U=w!==null?w.memoizedProps:null,re=D.children,fe(M,D)?re=null:U!==null&&fe(M,U)&&(S.flags|=32),x8(w,S),Ta(w,S,re,N),S.child;case 6:return w===null&&ZO(S),null;case 13:return _8(w,S,N);case 4:return JO(S,S.stateNode.containerInfo),M=S.pendingProps,w===null?S.child=_y(S,null,M,N):Ta(w,S,M,N),S.child;case 11:return M=S.type,D=S.pendingProps,D=S.elementType===M?D:nc(M,D),m8(w,S,M,D,N);case 7:return Ta(w,S,S.pendingProps,N),S.child;case 8:return Ta(w,S,S.pendingProps.children,N),S.child;case 12:return Ta(w,S,S.pendingProps.children,N),S.child;case 10:e:{if(M=S.type._context,D=S.pendingProps,U=S.memoizedProps,re=D.value,A6(S,M,re),U!==null)if(lu(U.value,re)){if(U.children===D.children&&!hi.current){S=hd(w,S,N);break e}}else for(U=S.child,U!==null&&(U.return=S);U!==null;){var be=U.dependencies;if(be!==null){re=U.child;for(var Ue=be.firstContext;Ue!==null;){if(Ue.context===M){if(U.tag===1){Ue=ld(-1,N&-N),Ue.tag=2;var Je=U.updateQueue;if(Je!==null){Je=Je.shared;var Tt=Je.pending;Tt===null?Ue.next=Ue:(Ue.next=Tt.next,Tt.next=Ue),Je.pending=Ue}}U.lanes|=N,Ue=U.alternate,Ue!==null&&(Ue.lanes|=N),WO(U.return,N,S),be.lanes|=N;break}Ue=Ue.next}}else if(U.tag===10)re=U.type===S.type?null:U.child;else if(U.tag===18){if(re=U.return,re===null)throw Error(a(341));re.lanes|=N,be=re.alternate,be!==null&&(be.lanes|=N),WO(re,N,S),re=U.sibling}else re=U.child;if(re!==null)re.return=U;else for(re=U;re!==null;){if(re===S){re=null;break}if(U=re.sibling,U!==null){U.return=re.return,re=U;break}re=re.return}U=re}Ta(w,S,D.children,N),S=S.child}return S;case 9:return D=S.type,M=S.pendingProps.children,xy(S,N),D=ul(D),M=M(D),S.flags|=1,Ta(w,S,M,N),S.child;case 14:return M=S.type,D=nc(M,S.pendingProps),D=nc(M.type,D),g8(w,S,M,D,N);case 15:return y8(w,S,S.type,S.pendingProps,N);case 17:return M=S.type,D=S.pendingProps,D=S.elementType===M?D:nc(M,D),w!==null&&(w.alternate=null,S.alternate=null,S.flags|=2),S.tag=1,ys(M)?(w=!0,Ls(S)):w=!1,xy(S,N),O6(S,M,D),qO(S,M,D,N),hD(null,S,M,!0,w,N);case 19:return N8(w,S,N);case 22:return v8(w,S,N)}throw Error(a(156,S.tag))};function Z8(w,S){return LO(w,S)}function i1e(w,S,N,M){this.tag=w,this.key=N,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=S,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=M,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gl(w,S,N,M){return new i1e(w,S,N,M)}function OD(w){return w=w.prototype,!(!w||!w.isReactComponent)}function s1e(w){if(typeof w=="function")return OD(w)?1:0;if(w!=null){if(w=w.$$typeof,w===g)return 11;if(w===x)return 14}return 2}function Rh(w,S){var N=w.alternate;return N===null?(N=gl(w.tag,S,w.key,w.mode),N.elementType=w.elementType,N.type=w.type,N.stateNode=w.stateNode,N.alternate=w,w.alternate=N):(N.pendingProps=S,N.type=w.type,N.flags=0,N.subtreeFlags=0,N.deletions=null),N.flags=w.flags&14680064,N.childLanes=w.childLanes,N.lanes=w.lanes,N.child=w.child,N.memoizedProps=w.memoizedProps,N.memoizedState=w.memoizedState,N.updateQueue=w.updateQueue,S=w.dependencies,N.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext},N.sibling=w.sibling,N.index=w.index,N.ref=w.ref,N}function TC(w,S,N,M,D,U){var re=2;if(M=w,typeof w=="function")OD(w)&&(re=1);else if(typeof w=="string")re=5;else e:switch(w){case u:return Vp(N.children,D,U,S);case d:re=8,D|=8;break;case h:return w=gl(12,N,S,D|2),w.elementType=h,w.lanes=U,w;case m:return w=gl(13,N,S,D),w.elementType=m,w.lanes=U,w;case y:return w=gl(19,N,S,D),w.elementType=y,w.lanes=U,w;case _:return EC(N,D,U,S);default:if(typeof w=="object"&&w!==null)switch(w.$$typeof){case f:re=10;break e;case p:re=9;break e;case g:re=11;break e;case x:re=14;break e;case b:re=16,M=null;break e}throw Error(a(130,w==null?w:typeof w,""))}return S=gl(re,N,S,D),S.elementType=w,S.type=M,S.lanes=U,S}function Vp(w,S,N,M){return w=gl(7,w,M,S),w.lanes=N,w}function EC(w,S,N,M){return w=gl(22,w,M,S),w.elementType=_,w.lanes=N,w.stateNode={},w}function DD(w,S,N){return w=gl(6,w,null,S),w.lanes=N,w}function $D(w,S,N){return S=gl(4,w.children!==null?w.children:[],w.key,S),S.lanes=N,S.stateNode={containerInfo:w.containerInfo,pendingChildren:null,implementation:w.implementation},S}function a1e(w,S,N,M,D){this.tag=S,this.containerInfo=w,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ge,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=DO(0),this.expirationTimes=DO(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=DO(0),this.identifierPrefix=M,this.onRecoverableError=D,ke&&(this.mutableSourceEagerHydrationData=null)}function Q8(w,S,N,M,D,U,re,be,Ue){return w=new a1e(w,S,N,be,Ue),S===1?(S=1,U===!0&&(S|=8)):S=0,U=gl(3,null,null,S),w.current=U,U.stateNode=w,U.memoizedState={element:M,isDehydrated:N,cache:null,transitions:null},HO(U),w}function J8(w){if(!w)return ll;w=w._reactInternals;e:{if(A(w)!==w||w.tag!==1)throw Error(a(170));var S=w;do{switch(S.tag){case 3:S=S.stateNode.context;break e;case 1:if(ys(S.type)){S=S.stateNode.__reactInternalMemoizedMergedChildContext;break e}}S=S.return}while(S!==null);throw Error(a(171))}if(w.tag===1){var N=w.type;if(ys(N))return gy(w,N,S)}return S}function e9(w){var S=w._reactInternals;if(S===void 0)throw typeof w.render=="function"?Error(a(188)):(w=Object.keys(w).join(","),Error(a(268,w)));return w=$(S),w===null?null:w.stateNode}function t9(w,S){if(w=w.memoizedState,w!==null&&w.dehydrated!==null){var N=w.retryLane;w.retryLane=N!==0&&N<S?N:S}}function LD(w,S){t9(w,S),(w=w.alternate)&&t9(w,S)}function o1e(w){return w=$(w),w===null?null:w.stateNode}function l1e(){return null}return n.attemptContinuousHydration=function(w){if(w.tag===13){var S=Ea();ml(w,134217728,S),LD(w,134217728)}},n.attemptHydrationAtCurrentPriority=function(w){if(w.tag===13){var S=Ea(),N=kh(w);ml(w,N,S),LD(w,N)}},n.attemptSynchronousHydration=function(w){switch(w.tag){case 3:var S=w.stateNode;if(S.current.memoizedState.isDehydrated){var N=Rb(S.pendingLanes);N!==0&&($O(S,N|1),Qa(S,vs()),!(kn&6)&&(Iy(),cu()))}break;case 13:var M=Ea();V8(function(){return ml(w,1,M)}),LD(w,1)}},n.batchedUpdates=function(w,S){var N=kn;kn|=1;try{return w(S)}finally{kn=N,kn===0&&(Iy(),FE&&cu())}},n.createComponentSelector=function(w){return{$$typeof:uC,value:w}},n.createContainer=function(w,S,N,M,D,U,re){return Q8(w,S,!1,null,N,M,D,U,re)},n.createHasPseudoClassSelector=function(w){return{$$typeof:dC,value:w}},n.createHydrationContainer=function(w,S,N,M,D,U,re,be,Ue){return w=Q8(N,M,!0,w,D,U,re,be,Ue),w.context=J8(null),N=w.current,M=Ea(),D=kh(N),U=ld(M,D),U.callback=S??null,Nh(N,U),w.current.lanes=D,Pb(w,D,M),Qa(w,M),w},n.createPortal=function(w,S,N){var M=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:c,key:M==null?null:""+M,children:w,containerInfo:S,implementation:N}},n.createRoleSelector=function(w){return{$$typeof:hC,value:w}},n.createTestNameSelector=function(w){return{$$typeof:fC,value:w}},n.createTextSelector=function(w){return{$$typeof:pC,value:w}},n.deferredUpdates=function(w){var S=Qn,N=Ci.transition;try{return Ci.transition=null,Qn=16,w()}finally{Qn=S,Ci.transition=N}},n.discreteUpdates=function(w,S,N,M,D){var U=Qn,re=Ci.transition;try{return Ci.transition=null,Qn=1,w(S,N,M,D)}finally{Qn=U,Ci.transition=re,kn===0&&Iy()}},n.findAllNodes=_D,n.findBoundingRects=function(w,S){if(!X)throw Error(a(363));S=_D(w,S),w=[];for(var N=0;N<S.length;N++)w.push(Z(S[N]));for(S=w.length-1;0<S;S--){N=w[S];for(var M=N.x,D=M+N.width,U=N.y,re=U+N.height,be=S-1;0<=be;be--)if(S!==be){var Ue=w[be],Je=Ue.x,Tt=Je+Ue.width,fn=Ue.y,Gt=fn+Ue.height;if(M>=Je&&U>=fn&&D<=Tt&&re<=Gt){w.splice(S,1);break}else if(M!==Je||N.width!==Ue.width||Gt<U||fn>re){if(!(U!==fn||N.height!==Ue.height||Tt<M||Je>D)){Je>M&&(Ue.width+=Je-M,Ue.x=M),Tt<D&&(Ue.width=D-Je),w.splice(S,1);break}}else{fn>U&&(Ue.height+=fn-U,Ue.y=U),Gt<re&&(Ue.height=re-fn),w.splice(S,1);break}}}return w},n.findHostInstance=e9,n.findHostInstanceWithNoPortals=function(w){return w=R(w),w=w!==null?O(w):null,w===null?null:w.stateNode},n.findHostInstanceWithWarning=function(w){return e9(w)},n.flushControlled=function(w){var S=kn;kn|=1;var N=Ci.transition,M=Qn;try{Ci.transition=null,Qn=1,w()}finally{Qn=M,Ci.transition=N,kn=S,kn===0&&(Iy(),cu())}},n.flushPassiveEffects=Up,n.flushSync=V8,n.focusWithin=function(w,S){if(!X)throw Error(a(363));for(w=bD(w),S=z8(w,S),S=Array.from(S),w=0;w<S.length;){var N=S[w++];if(!ae(N)){if(N.tag===5&&Ae(N.stateNode))return!0;for(N=N.child;N!==null;)S.push(N),N=N.sibling}}return!1},n.getCurrentUpdatePriority=function(){return Qn},n.getFindAllNodesFailureDescription=function(w,S){if(!X)throw Error(a(363));var N=0,M=[];w=[bD(w),0];for(var D=0;D<w.length;){var U=w[D++],re=w[D++],be=S[re];if((U.tag!==5||!ae(U))&&(wD(U,be)&&(M.push(SD(be)),re++,re>N&&(N=re)),re<S.length))for(U=U.child;U!==null;)w.push(U,re),U=U.sibling}if(N<S.length){for(w=[];N<S.length;N++)w.push(SD(S[N]));return`findAllNodes was able to match part of the selector:
  `+(M.join(" > ")+`

No matching component was found for:
  `)+w.join(" > ")}return null},n.getPublicRootInstance=function(w){if(w=w.current,!w.child)return null;switch(w.child.tag){case 5:return B(w.child.stateNode);default:return w.child.stateNode}},n.injectIntoDevTools=function(w){if(w={bundleType:w.bundleType,version:w.version,rendererPackageName:w.rendererPackageName,rendererConfig:w.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:o.ReactCurrentDispatcher,findHostInstanceByFiber:o1e,findFiberByHostInstance:w.findFiberByHostInstance||l1e,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")w=!1;else{var S=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(S.isDisabled||!S.supportsFiber)w=!0;else{try{LE=S.inject(w),ou=S}catch{}w=!!S.checkDCE}}return w},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(w,S,N,M){if(!X)throw Error(a(363));w=_D(w,S);var D=Ie(w,N,M).disconnect;return{disconnect:function(){D()}}},n.registerMutableSourceForHydration=function(w,S){var N=S._getVersion;N=N(S._source),w.mutableSourceEagerHydrationData==null?w.mutableSourceEagerHydrationData=[S,N]:w.mutableSourceEagerHydrationData.push(S,N)},n.runWithPriority=function(w,S){var N=Qn;try{return Qn=w,S()}finally{Qn=N}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(w,S,N,M){var D=S.current,U=Ea(),re=kh(D);return N=J8(N),S.context===null?S.context=N:S.pendingContext=N,S=ld(U,re),S.payload={element:w},M=M===void 0?null:M,M!==null&&(S.callback=M),Nh(D,S),w=ml(D,re,U),w!==null&&UE(w,D,re),re},n};uxe.exports=mAt;var gAt=uxe.exports;const yAt=lr(gAt),ZG={},vAt=t=>void Object.assign(ZG,t);function xAt(t,e){function n(u,{args:d=[],attach:h,...f},p){let g=`${u[0].toUpperCase()}${u.slice(1)}`,m;if(u==="primitive"){if(f.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const y=f.object;m=vv(y,{type:u,root:p,attach:h,primitive:!0})}else{const y=ZG[g];if(!y)throw new Error(`R3F: ${g} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(d))throw new Error("R3F: The args prop must be an array!");m=vv(new y(...d),{type:u,root:p,attach:h,memoizedProps:{args:d}})}return m.__r3f.attach===void 0&&(m.isBufferGeometry?m.__r3f.attach="geometry":m.isMaterial&&(m.__r3f.attach="material")),g!=="inject"&&p3(m,f),m}function r(u,d){let h=!1;if(d){var f,p;(f=d.__r3f)!=null&&f.attach?f3(u,d,d.__r3f.attach):d.isObject3D&&u.isObject3D&&(u.add(d),h=!0),h||(p=u.__r3f)==null||p.objects.push(d),d.__r3f||vv(d,{}),d.__r3f.parent=u,iB(d),xv(d)}}function i(u,d,h){let f=!1;if(d){var p,g;if((p=d.__r3f)!=null&&p.attach)f3(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){d.parent=u,d.dispatchEvent({type:"added"}),u.dispatchEvent({type:"childadded",child:d});const m=u.children.filter(x=>x!==d),y=m.indexOf(h);u.children=[...m.slice(0,y),d,...m.slice(y)],f=!0}f||(g=u.__r3f)==null||g.objects.push(d),d.__r3f||vv(d,{}),d.__r3f.parent=u,iB(d),xv(d)}}function s(u,d,h=!1){u&&[...u].forEach(f=>a(d,f,h))}function a(u,d,h){if(d){var f,p,g;if(d.__r3f&&(d.__r3f.parent=null),(f=u.__r3f)!=null&&f.objects&&(u.__r3f.objects=u.__r3f.objects.filter(_=>_!==d)),(p=d.__r3f)!=null&&p.attach)Fee(u,d,d.__r3f.attach);else if(d.isObject3D&&u.isObject3D){var m;u.remove(d),(m=d.__r3f)!=null&&m.root&&NAt(eA(d),d)}const x=(g=d.__r3f)==null?void 0:g.primitive,b=!x&&(h===void 0?d.dispose!==null:h);if(!x){var y;s((y=d.__r3f)==null?void 0:y.objects,d,b),s(d.children,d,b)}if(delete d.__r3f,b&&d.dispose&&d.type!=="Scene"){const _=()=>{try{d.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?nB.unstable_scheduleCallback(nB.unstable_IdlePriority,_):_()}xv(u)}}function o(u,d,h,f){var p;const g=(p=u.__r3f)==null?void 0:p.parent;if(!g)return;const m=n(d,h,u.__r3f.root);if(u.children){for(const y of u.children)y.__r3f&&r(m,y);u.children=u.children.filter(y=>!y.__r3f)}u.__r3f.objects.forEach(y=>r(m,y)),u.__r3f.objects=[],u.__r3f.autoRemovedBeforeAppend||a(g,u),m.parent&&(m.__r3f.autoRemovedBeforeAppend=!0),r(g,m),m.raycast&&m.__r3f.eventCount&&eA(m).getState().internal.interaction.push(m),[f,f.alternate].forEach(y=>{y!==null&&(y.stateNode=m,y.ref&&(typeof y.ref=="function"?y.ref(m):y.ref.current=m))})}const l=()=>{};return{reconciler:yAt({createInstance:n,removeChild:a,appendChild:r,appendInitialChild:r,insertBefore:i,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(u,d)=>{if(!d)return;const h=u.getState().scene;h.__r3f&&(h.__r3f.root=u,r(h,d))},removeChildFromContainer:(u,d)=>{d&&a(u.getState().scene,d)},insertInContainerBefore:(u,d,h)=>{if(!d||!h)return;const f=u.getState().scene;f.__r3f&&i(f,d,h)},getRootHostContext:()=>null,getChildHostContext:u=>u,finalizeInitialChildren(u){var d;return!!((d=u==null?void 0:u.__r3f)!=null?d:{}).handlers},prepareUpdate(u,d,h,f){var p;if(((p=u==null?void 0:u.__r3f)!=null?p:{}).primitive&&f.object&&f.object!==u)return[!0];{const{args:m=[],children:y,...x}=f,{args:b=[],children:_,...T}=h;if(!Array.isArray(m))throw new Error("R3F: the args prop must be an array!");if(m.some((C,I)=>C!==b[I]))return[!0];const E=vxe(u,x,T,!0);return E.changes.length?[!1,E]:null}},commitUpdate(u,[d,h],f,p,g,m){d?o(u,f,g,m):p3(u,h)},commitMount(u,d,h,f){var p;const g=(p=u.__r3f)!=null?p:{};u.raycast&&g.handlers&&g.eventCount&&eA(u).getState().internal.interaction.push(u)},getPublicInstance:u=>u,prepareForCommit:()=>null,preparePortalMount:u=>vv(u.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(u){var d;const{attach:h,parent:f}=(d=u.__r3f)!=null?d:{};h&&f&&Fee(f,u,h),u.isObject3D&&(u.visible=!1),xv(u)},unhideInstance(u,d){var h;const{attach:f,parent:p}=(h=u.__r3f)!=null?h:{};f&&p&&f3(p,u,f),(u.isObject3D&&d.visible==null||d.visible)&&(u.visible=!0),xv(u)},createTextInstance:l,hideTextInstance:l,unhideTextInstance:l,getCurrentEventPriority:()=>e?e():Wv.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&zr.fun(performance.now)?performance.now:zr.fun(Date.now)?Date.now:()=>0,scheduleTimeout:zr.fun(setTimeout)?setTimeout:void 0,cancelTimeout:zr.fun(clearTimeout)?clearTimeout:void 0}),applyProps:p3}}var Oee,Dee;const h3=t=>"colorSpace"in t||"outputColorSpace"in t,fxe=()=>{var t;return(t=ZG.ColorManagement)!=null?t:null},pxe=t=>t&&t.isOrthographicCamera,bAt=t=>t&&t.hasOwnProperty("current"),vO=typeof window<"u"&&((Oee=window.document)!=null&&Oee.createElement||((Dee=window.navigator)==null?void 0:Dee.product)==="ReactNative")?P.useLayoutEffect:P.useEffect;function wAt(t){const e=P.useRef(t);return vO(()=>void(e.current=t),[t]),e}function SAt({set:t}){return vO(()=>(t(new Promise(()=>null)),()=>t(!1)),[t]),null}class mxe extends P.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}mxe.getDerivedStateFromError=()=>({error:!0});const gxe="__default",$ee=new Map,_At=t=>t&&!!t.memoized&&!!t.changes;function yxe(t){var e;const n=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(t)?Math.min(Math.max(t[0],n),t[1]):t}const Pw=t=>{var e;return(e=t.__r3f)==null?void 0:e.root.getState()};function eA(t){let e=t.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const zr={obj:t=>t===Object(t)&&!zr.arr(t)&&typeof t!="function",fun:t=>typeof t=="function",str:t=>typeof t=="string",num:t=>typeof t=="number",boo:t=>typeof t=="boolean",und:t=>t===void 0,arr:t=>Array.isArray(t),equ(t,e,{arrays:n="shallow",objects:r="reference",strict:i=!0}={}){if(typeof t!=typeof e||!!t!=!!e)return!1;if(zr.str(t)||zr.num(t)||zr.boo(t))return t===e;const s=zr.obj(t);if(s&&r==="reference")return t===e;const a=zr.arr(t);if(a&&n==="reference")return t===e;if((a||s)&&t===e)return!0;let o;for(o in t)if(!(o in e))return!1;if(s&&n==="shallow"&&r==="shallow"){for(o in i?e:t)if(!zr.equ(t[o],e[o],{strict:i,objects:"reference"}))return!1}else for(o in i?e:t)if(t[o]!==e[o])return!1;if(zr.und(o)){if(a&&t.length===0&&e.length===0||s&&Object.keys(t).length===0&&Object.keys(e).length===0)return!0;if(t!==e)return!1}return!0}};function TAt(t){t.dispose&&t.type!=="Scene"&&t.dispose();for(const e in t)e.dispose==null||e.dispose(),delete t[e]}function vv(t,e){const n=t;return n.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},t}function rB(t,e){let n=t;if(e.includes("-")){const r=e.split("-"),i=r.pop();return n=r.reduce((s,a)=>s[a],t),{target:n,key:i}}else return{target:n,key:e}}const Lee=/-\d+$/;function f3(t,e,n){if(zr.str(n)){if(Lee.test(n)){const s=n.replace(Lee,""),{target:a,key:o}=rB(t,s);Array.isArray(a[o])||(a[o]=[])}const{target:r,key:i}=rB(t,n);e.__r3f.previousAttach=r[i],r[i]=e}else e.__r3f.previousAttach=n(t,e)}function Fee(t,e,n){var r,i;if(zr.str(n)){const{target:s,key:a}=rB(t,n),o=e.__r3f.previousAttach;o===void 0?delete s[a]:s[a]=o}else(r=e.__r3f)==null||r.previousAttach==null||r.previousAttach(t,e);(i=e.__r3f)==null||delete i.previousAttach}function vxe(t,{children:e,key:n,ref:r,...i},{children:s,key:a,ref:o,...l}={},c=!1){const u=t.__r3f,d=Object.entries(i),h=[];if(c){const p=Object.keys(l);for(let g=0;g<p.length;g++)i.hasOwnProperty(p[g])||d.unshift([p[g],gxe+"remove"])}d.forEach(([p,g])=>{var m;if((m=t.__r3f)!=null&&m.primitive&&p==="object"||zr.equ(g,l[p]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(p))return h.push([p,g,!0,[]]);let y=[];p.includes("-")&&(y=p.split("-")),h.push([p,g,!1,y]);for(const x in i){const b=i[x];x.startsWith(`${p}-`)&&h.push([x,b,!1,x.split("-")])}});const f={...i};return u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.args&&(f.args=u.memoizedProps.args),u!=null&&u.memoizedProps&&u!=null&&u.memoizedProps.attach&&(f.attach=u.memoizedProps.attach),{memoized:f,changes:h}}function p3(t,e){var n;const r=t.__r3f,i=r==null?void 0:r.root,s=i==null||i.getState==null?void 0:i.getState(),{memoized:a,changes:o}=_At(e)?e:vxe(t,e),l=r==null?void 0:r.eventCount;t.__r3f&&(t.__r3f.memoizedProps=a);for(let h=0;h<o.length;h++){let[f,p,g,m]=o[h];if(h3(t)){const _="srgb",T="srgb-linear";f==="encoding"?(f="colorSpace",p=p===3001?_:T):f==="outputEncoding"&&(f="outputColorSpace",p=p===3001?_:T)}let y=t,x=y[f];if(m.length&&(x=m.reduce((b,_)=>b[_],t),!(x&&x.set))){const[b,..._]=m.reverse();y=_.reverse().reduce((T,E)=>T[E],t),f=b}if(p===gxe+"remove")if(y.constructor){let b=$ee.get(y.constructor);b||(b=new y.constructor,$ee.set(y.constructor,b)),p=b[f]}else p=0;if(g&&r)p?r.handlers[f]=p:delete r.handlers[f],r.eventCount=Object.keys(r.handlers).length;else if(x&&x.set&&(x.copy||x instanceof tg)){if(Array.isArray(p))x.fromArray?x.fromArray(p):x.set(...p);else if(x.copy&&p&&p.constructor&&x.constructor===p.constructor)x.copy(p);else if(p!==void 0){var c;const b=(c=x)==null?void 0:c.isColor;!b&&x.setScalar?x.setScalar(p):x instanceof tg&&p instanceof tg?x.mask=p.mask:x.set(p),!fxe()&&s&&!s.linear&&b&&x.convertSRGBToLinear()}}else{var u;if(y[f]=p,(u=y[f])!=null&&u.isTexture&&y[f].format===ja&&y[f].type===Bu&&s){const b=y[f];h3(b)&&h3(s.gl)?b.colorSpace=s.gl.outputColorSpace:b.encoding=s.gl.outputEncoding}}xv(t)}if(r&&r.parent&&t.raycast&&l!==r.eventCount){const h=eA(t).getState().internal,f=h.interaction.indexOf(t);f>-1&&h.interaction.splice(f,1),r.eventCount&&h.interaction.push(t)}return!(o.length===1&&o[0][0]==="onUpdate")&&o.length&&(n=t.__r3f)!=null&&n.parent&&iB(t),t}function xv(t){var e,n;const r=(e=t.__r3f)==null||(n=e.root)==null||n.getState==null?void 0:n.getState();r&&r.internal.frames===0&&r.invalidate()}function iB(t){t.onUpdate==null||t.onUpdate(t)}function EAt(t,e){t.manual||(pxe(t)?(t.left=e.width/-2,t.right=e.width/2,t.top=e.height/2,t.bottom=e.height/-2):t.aspect=e.width/e.height,t.updateProjectionMatrix(),t.updateMatrixWorld())}function g2(t){return(t.eventObject||t.object).uuid+"/"+t.index+t.instanceId}function CAt(){var t;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Wv.DefaultEventPriority;switch((t=e.event)==null?void 0:t.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Wv.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Wv.ContinuousEventPriority;default:return Wv.DefaultEventPriority}}function xxe(t,e,n,r){const i=n.get(e);i&&(n.delete(e),n.size===0&&(t.delete(r),i.target.releasePointerCapture(r)))}function NAt(t,e){const{internal:n}=t.getState();n.interaction=n.interaction.filter(r=>r!==e),n.initialHits=n.initialHits.filter(r=>r!==e),n.hovered.forEach((r,i)=>{(r.eventObject===e||r.object===e)&&n.hovered.delete(i)}),n.capturedMap.forEach((r,i)=>{xxe(n.capturedMap,e,r,i)})}function AAt(t){function e(l){const{internal:c}=t.getState(),u=l.offsetX-c.initialClick[0],d=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(u*u+d*d))}function n(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(u=>{var d;return(d=c.__r3f)==null?void 0:d.handlers["onPointer"+u]}))}function r(l,c){const u=t.getState(),d=new Set,h=[],f=c?c(u.internal.interaction):u.internal.interaction;for(let y=0;y<f.length;y++){const x=Pw(f[y]);x&&(x.raycaster.camera=void 0)}u.previousRoot||u.events.compute==null||u.events.compute(l,u);function p(y){const x=Pw(y);if(!x||!x.events.enabled||x.raycaster.camera===null)return[];if(x.raycaster.camera===void 0){var b;x.events.compute==null||x.events.compute(l,x,(b=x.previousRoot)==null?void 0:b.getState()),x.raycaster.camera===void 0&&(x.raycaster.camera=null)}return x.raycaster.camera?x.raycaster.intersectObject(y,!0):[]}let g=f.flatMap(p).sort((y,x)=>{const b=Pw(y.object),_=Pw(x.object);return!b||!_?y.distance-x.distance:_.events.priority-b.events.priority||y.distance-x.distance}).filter(y=>{const x=g2(y);return d.has(x)?!1:(d.add(x),!0)});u.events.filter&&(g=u.events.filter(g,u));for(const y of g){let x=y.object;for(;x;){var m;(m=x.__r3f)!=null&&m.eventCount&&h.push({...y,eventObject:x}),x=x.parent}}if("pointerId"in l&&u.internal.capturedMap.has(l.pointerId))for(let y of u.internal.capturedMap.get(l.pointerId).values())d.has(g2(y.intersection))||h.push(y.intersection);return h}function i(l,c,u,d){const h=t.getState();if(l.length){const f={stopped:!1};for(const p of l){const g=Pw(p.object)||h,{raycaster:m,pointer:y,camera:x,internal:b}=g,_=new ne(y.x,y.y,0).unproject(x),T=k=>{var R,$;return(R=($=b.capturedMap.get(k))==null?void 0:$.has(p.eventObject))!=null?R:!1},E=k=>{const R={intersection:p,target:c.target};b.capturedMap.has(k)?b.capturedMap.get(k).set(p.eventObject,R):b.capturedMap.set(k,new Map([[p.eventObject,R]])),c.target.setPointerCapture(k)},C=k=>{const R=b.capturedMap.get(k);R&&xxe(b.capturedMap,p.eventObject,R,k)};let I={};for(let k in c){let R=c[k];typeof R!="function"&&(I[k]=R)}let A={...p,...I,pointer:y,intersections:l,stopped:f.stopped,delta:u,unprojectedPoint:_,ray:m.ray,camera:x,stopPropagation(){const k="pointerId"in c&&b.capturedMap.get(c.pointerId);if((!k||k.has(p.eventObject))&&(A.stopped=f.stopped=!0,b.hovered.size&&Array.from(b.hovered.values()).find(R=>R.eventObject===p.eventObject))){const R=l.slice(0,l.indexOf(p));s([...R,p])}},target:{hasPointerCapture:T,setPointerCapture:E,releasePointerCapture:C},currentTarget:{hasPointerCapture:T,setPointerCapture:E,releasePointerCapture:C},nativeEvent:c};if(d(A),f.stopped===!0)break}}return l}function s(l){const{internal:c}=t.getState();for(const u of c.hovered.values())if(!l.length||!l.find(d=>d.object===u.object&&d.index===u.index&&d.instanceId===u.instanceId)){const h=u.eventObject.__r3f,f=h==null?void 0:h.handlers;if(c.hovered.delete(g2(u)),h!=null&&h.eventCount){const p={...u,intersections:l};f.onPointerOut==null||f.onPointerOut(p),f.onPointerLeave==null||f.onPointerLeave(p)}}}function a(l,c){for(let u=0;u<c.length;u++){const d=c[u].__r3f;d==null||d.handlers.onPointerMissed==null||d.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:u}=t.getState();"pointerId"in c&&u.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{u.capturedMap.has(c.pointerId)&&(u.capturedMap.delete(c.pointerId),s([]))})}}return function(u){const{onPointerMissed:d,internal:h}=t.getState();h.lastEvent.current=u;const f=l==="onPointerMove",p=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",m=r(u,f?n:void 0),y=p?e(u):0;l==="onPointerDown"&&(h.initialClick=[u.offsetX,u.offsetY],h.initialHits=m.map(b=>b.eventObject)),p&&!m.length&&y<=2&&(a(u,h.interaction),d&&d(u)),f&&s(m);function x(b){const _=b.eventObject,T=_.__r3f,E=T==null?void 0:T.handlers;if(T!=null&&T.eventCount)if(f){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const C=g2(b),I=h.hovered.get(C);I?I.stopped&&b.stopPropagation():(h.hovered.set(C,b),E.onPointerOver==null||E.onPointerOver(b),E.onPointerEnter==null||E.onPointerEnter(b))}E.onPointerMove==null||E.onPointerMove(b)}else{const C=E[l];C?(!p||h.initialHits.includes(_))&&(a(u,h.interaction.filter(I=>!h.initialHits.includes(I))),C(b)):p&&h.initialHits.includes(_)&&a(u,h.interaction.filter(I=>!h.initialHits.includes(I)))}}i(m,u,y,x)}}return{handlePointer:o}}const bxe=t=>!!(t!=null&&t.render),IAt=P.createContext(null),kAt=(t,e)=>{const n=pAt((o,l)=>{const c=new ne,u=new ne,d=new ne;function h(y=l().camera,x=u,b=l().size){const{width:_,height:T,top:E,left:C}=b,I=_/T;x.isVector3?d.copy(x):d.set(...x);const A=y.getWorldPosition(c).distanceTo(d);if(pxe(y))return{width:_/y.zoom,height:T/y.zoom,top:E,left:C,factor:1,distance:A,aspect:I};{const k=y.fov*Math.PI/180,R=2*Math.tan(k/2)*A,$=R*(_/T);return{width:$,height:R,top:E,left:C,factor:_/$,distance:A,aspect:I}}}let f;const p=y=>o(x=>({performance:{...x.performance,current:y}})),g=new Xe;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(y=1)=>t(l(),y),advance:(y,x)=>e(y,x,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new qG,pointer:g,mouse:g,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const y=l();f&&clearTimeout(f),y.performance.current!==y.performance.min&&p(y.performance.min),f=setTimeout(()=>p(l().performance.max),y.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:h},setEvents:y=>o(x=>({...x,events:{...x.events,...y}})),setSize:(y,x,b,_,T)=>{const E=l().camera,C={width:y,height:x,top:_||0,left:T||0,updateStyle:b};o(I=>({size:C,viewport:{...I.viewport,...h(E,u,C)}}))},setDpr:y=>o(x=>{const b=yxe(y);return{viewport:{...x.viewport,dpr:b,initialDpr:x.viewport.initialDpr||b}}}),setFrameloop:(y="always")=>{const x=l().clock;x.stop(),x.elapsedTime=0,y!=="never"&&(x.start(),x.elapsedTime=0),o(()=>({frameloop:y}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:P.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(y,x,b)=>{const _=l().internal;return _.priority=_.priority+(x>0?1:0),_.subscribers.push({ref:y,priority:x,store:b}),_.subscribers=_.subscribers.sort((T,E)=>T.priority-E.priority),()=>{const T=l().internal;T!=null&&T.subscribers&&(T.priority=T.priority-(x>0?1:0),T.subscribers=T.subscribers.filter(E=>E.ref!==y))}}}}}),r=n.getState();let i=r.size,s=r.viewport.dpr,a=r.camera;return n.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:u,set:d}=n.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){var h;i=l,s=c.dpr,EAt(o,l),u.setPixelRatio(c.dpr);const f=(h=l.updateStyle)!=null?h:typeof HTMLCanvasElement<"u"&&u.domElement instanceof HTMLCanvasElement;u.setSize(l.width,l.height,f)}o!==a&&(a=o,d(f=>({viewport:{...f.viewport,...f.viewport.getCurrentViewport(o)}})))}),n.subscribe(o=>t(o)),n};let y2,MAt=new Set,RAt=new Set,PAt=new Set;function m3(t,e){if(t.size)for(const{callback:n}of t.values())n(e)}function Ow(t,e){switch(t){case"before":return m3(MAt,e);case"after":return m3(RAt,e);case"tail":return m3(PAt,e)}}let g3,y3;function v3(t,e,n){let r=e.clock.getDelta();for(e.frameloop==="never"&&typeof t=="number"&&(r=t-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=t),g3=e.internal.subscribers,y2=0;y2<g3.length;y2++)y3=g3[y2],y3.ref.current(y3.store.getState(),r,n);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function OAt(t){let e=!1,n=!1,r,i,s;function a(c){i=requestAnimationFrame(a),e=!0,r=0,Ow("before",c),n=!0;for(const d of t.values()){var u;s=d.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((u=s.gl.xr)!=null&&u.isPresenting)&&(r+=v3(c,s))}if(n=!1,Ow("after",c),r===0)return Ow("tail",c),e=!1,cancelAnimationFrame(i)}function o(c,u=1){var d;if(!c)return t.forEach(h=>o(h.store.getState(),u));(d=c.gl.xr)!=null&&d.isPresenting||!c.internal.active||c.frameloop==="never"||(u>1?c.internal.frames=Math.min(60,c.internal.frames+u):n?c.internal.frames=2:c.internal.frames=1,e||(e=!0,requestAnimationFrame(a)))}function l(c,u=!0,d,h){if(u&&Ow("before",c),d)v3(c,d,h);else for(const f of t.values())v3(c,f.store.getState());u&&Ow("after",c)}return{loop:a,invalidate:o,advance:l}}const R0=new Map,{invalidate:jee,advance:zee}=OAt(R0),{reconciler:bk,applyProps:uv}=xAt(R0,CAt),dv={objects:"shallow",strict:!1},DAt=(t,e)=>{const n=typeof t=="function"?t(e):t;return bxe(n)?n:new IG({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...t})};function $At(t,e){const n=typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement;if(e){const{width:r,height:i,top:s,left:a,updateStyle:o=n}=e;return{width:r,height:i,top:s,left:a,updateStyle:o}}else if(typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&t.parentElement){const{width:r,height:i,top:s,left:a}=t.parentElement.getBoundingClientRect();return{width:r,height:i,top:s,left:a,updateStyle:n}}else if(typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height,top:0,left:0,updateStyle:n};return{width:0,height:0,top:0,left:0}}function LAt(t){const e=R0.get(t),n=e==null?void 0:e.fiber,r=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=r||kAt(jee,zee),a=n||bk.createContainer(s,Wv.ConcurrentRoot,null,!1,null,"",i,null);e||R0.set(t,{fiber:a,store:s});let o,l=!1,c;return{configure(u={}){let{gl:d,size:h,scene:f,events:p,onCreated:g,shadows:m=!1,linear:y=!1,flat:x=!1,legacy:b=!1,orthographic:_=!1,frameloop:T="always",dpr:E=[1,2],performance:C,raycaster:I,camera:A,onPointerMissed:k}=u,R=s.getState(),$=R.gl;R.gl||R.set({gl:$=DAt(d,t)});let z=R.raycaster;z||R.set({raycaster:z=new oxe});const{params:O,...j}=I||{};if(zr.equ(j,z,dv)||uv(z,{...j}),zr.equ(O,z.params,dv)||uv(z,{params:{...z.params,...O}}),!R.camera||R.camera===c&&!zr.equ(c,A,dv)){c=A;const H=A instanceof fE,K=H?A:_?new yE(0,0,0,0,.1,1e3):new Ts(75,0,.1,1e3);H||(K.position.z=5,A&&(uv(K,A),("aspect"in A||"left"in A||"right"in A||"bottom"in A||"top"in A)&&(K.manual=!0,K.updateProjectionMatrix())),!R.camera&&!(A!=null&&A.rotation)&&K.lookAt(0,0,0)),R.set({camera:K}),z.camera=K}if(!R.scene){let H;f!=null&&f.isScene?H=f:(H=new kG,f&&uv(H,f)),R.set({scene:vv(H)})}if(!R.xr){var B;const H=(J,oe)=>{const fe=s.getState();fe.frameloop!=="never"&&zee(J,!0,fe,oe)},K=()=>{const J=s.getState();J.gl.xr.enabled=J.gl.xr.isPresenting,J.gl.xr.setAnimationLoop(J.gl.xr.isPresenting?H:null),J.gl.xr.isPresenting||jee(J)},te={connect(){const J=s.getState().gl;J.xr.addEventListener("sessionstart",K),J.xr.addEventListener("sessionend",K)},disconnect(){const J=s.getState().gl;J.xr.removeEventListener("sessionstart",K),J.xr.removeEventListener("sessionend",K)}};typeof((B=$.xr)==null?void 0:B.addEventListener)=="function"&&te.connect(),R.set({xr:te})}if($.shadowMap){const H=$.shadowMap.enabled,K=$.shadowMap.type;if($.shadowMap.enabled=!!m,zr.boo(m))$.shadowMap.type=x1;else if(zr.str(m)){var W;const te={basic:Jge,percentage:HP,soft:x1,variance:mc};$.shadowMap.type=(W=te[m])!=null?W:x1}else zr.obj(m)&&Object.assign($.shadowMap,m);(H!==$.shadowMap.enabled||K!==$.shadowMap.type)&&($.shadowMap.needsUpdate=!0)}const L=fxe();L&&("enabled"in L?L.enabled=!b:"legacyMode"in L&&(L.legacyMode=b)),l||uv($,{outputEncoding:y?3e3:3001,toneMapping:x?zu:lG}),R.legacy!==b&&R.set(()=>({legacy:b})),R.linear!==y&&R.set(()=>({linear:y})),R.flat!==x&&R.set(()=>({flat:x})),d&&!zr.fun(d)&&!bxe(d)&&!zr.equ(d,$,dv)&&uv($,d),p&&!R.events.handlers&&R.set({events:p(s)});const V=$At(t,h);return zr.equ(V,R.size,dv)||R.setSize(V.width,V.height,V.updateStyle,V.top,V.left),E&&R.viewport.dpr!==yxe(E)&&R.setDpr(E),R.frameloop!==T&&R.setFrameloop(T),R.onPointerMissed||R.set({onPointerMissed:k}),C&&!zr.equ(C,R.performance,dv)&&R.set(H=>({performance:{...H.performance,...C}})),o=g,l=!0,this},render(u){return l||this.configure(),bk.updateContainer(v.jsx(FAt,{store:s,children:u,onCreated:o,rootElement:t}),a,null,()=>{}),s},unmount(){wxe(t)}}}function FAt({store:t,children:e,onCreated:n,rootElement:r}){return vO(()=>{const i=t.getState();i.set(s=>({internal:{...s.internal,active:!0}})),n&&n(i),t.getState().events.connected||i.events.connect==null||i.events.connect(r)},[]),v.jsx(IAt.Provider,{value:t,children:e})}function wxe(t,e){const n=R0.get(t),r=n==null?void 0:n.fiber;if(r){const i=n==null?void 0:n.store.getState();i&&(i.internal.active=!1),bk.updateContainer(null,r,null,()=>{i&&setTimeout(()=>{try{var s,a,o,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=i.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),TAt(i),R0.delete(t)}catch{}},500)})}}bk.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:P.version});const x3={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function jAt(t){const{handlePointer:e}=AAt(t);return{priority:1,enabled:!0,compute(n,r,i){r.pointer.set(n.offsetX/r.size.width*2-1,-(n.offsetY/r.size.height)*2+1),r.raycaster.setFromCamera(r.pointer,r.camera)},connected:void 0,handlers:Object.keys(x3).reduce((n,r)=>({...n,[r]:e(r)}),{}),update:()=>{var n;const{events:r,internal:i}=t.getState();(n=i.lastEvent)!=null&&n.current&&r.handlers&&r.handlers.onPointerMove(i.lastEvent.current)},connect:n=>{var r;const{set:i,events:s}=t.getState();s.disconnect==null||s.disconnect(),i(a=>({events:{...a.events,connected:n}})),Object.entries((r=s.handlers)!=null?r:[]).forEach(([a,o])=>{const[l,c]=x3[a];n.addEventListener(l,o,{passive:c})})},disconnect:()=>{const{set:n,events:r}=t.getState();if(r.connected){var i;Object.entries((i=r.handlers)!=null?i:[]).forEach(([s,a])=>{if(r&&r.connected instanceof HTMLElement){const[o]=x3[s];r.connected.removeEventListener(o,a)}}),n(s=>({events:{...s.events,connected:void 0}}))}}}}function Bee(t,e){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...r),e)}}function zAt({debounce:t,scroll:e,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=P.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=P.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=t?typeof t=="number"?t:t.scroll:null,c=t?typeof t=="number"?t:t.resize:null,u=P.useRef(!1);P.useEffect(()=>(u.current=!0,()=>void(u.current=!1)));const[d,h,f]=P.useMemo(()=>{const y=()=>{if(!o.current.element)return;const{left:x,top:b,width:_,height:T,bottom:E,right:C,x:I,y:A}=o.current.element.getBoundingClientRect(),k={left:x,top:b,width:_,height:T,bottom:E,right:C,x:I,y:A};o.current.element instanceof HTMLElement&&r&&(k.height=o.current.element.offsetHeight,k.width=o.current.element.offsetWidth),Object.freeze(k),u.current&&!WAt(o.current.lastBounds,k)&&a(o.current.lastBounds=k)};return[y,c?Bee(y,c):y,l?Bee(y,l):y]},[a,r,l,c]);function p(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(y=>y.removeEventListener("scroll",f,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function g(){o.current.element&&(o.current.resizeObserver=new i(f),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(y=>y.addEventListener("scroll",f,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{f()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const m=y=>{!y||y===o.current.element||(p(),o.current.element=y,o.current.scrollContainers=Sxe(y),g())};return UAt(f,!!e),BAt(h),P.useEffect(()=>{p(),g()},[e,f,h]),P.useEffect(()=>p,[]),[m,s,d]}function BAt(t){P.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function UAt(t,e){P.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function Sxe(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(t);return[n,r,i].some(s=>s==="auto"||s==="scroll")&&e.push(t),[...e,...Sxe(t.parentElement)]}const VAt=["x","y","top","bottom","left","right","width","height"],WAt=(t,e)=>VAt.every(n=>t[n]===e[n]);var HAt=Object.defineProperty,GAt=Object.defineProperties,qAt=Object.getOwnPropertyDescriptors,Uee=Object.getOwnPropertySymbols,XAt=Object.prototype.hasOwnProperty,KAt=Object.prototype.propertyIsEnumerable,Vee=(t,e,n)=>e in t?HAt(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Wee=(t,e)=>{for(var n in e||(e={}))XAt.call(e,n)&&Vee(t,n,e[n]);if(Uee)for(var n of Uee(e))KAt.call(e,n)&&Vee(t,n,e[n]);return t},YAt=(t,e)=>GAt(t,qAt(e)),Hee,Gee;typeof window<"u"&&((Hee=window.document)!=null&&Hee.createElement||((Gee=window.navigator)==null?void 0:Gee.product)==="ReactNative")?P.useLayoutEffect:P.useEffect;function _xe(t,e,n){if(!t)return;if(n(t)===!0)return t;let r=t.child;for(;r;){const i=_xe(r,e,n);if(i)return i;r=r.sibling}}function Txe(t){try{return Object.defineProperties(t,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return t}}const qee=console.error;console.error=function(){const t=[...arguments].join("");if(t!=null&&t.startsWith("Warning:")&&t.includes("useContext")){console.error=qee;return}return qee.apply(this,arguments)};const QG=Txe(P.createContext(null));class Exe extends P.Component{render(){return P.createElement(QG.Provider,{value:this._reactInternals},this.props.children)}}function ZAt(){const t=P.useContext(QG);if(t===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=P.useId();return P.useMemo(()=>{for(const r of[t,t==null?void 0:t.alternate]){if(!r)continue;const i=_xe(r,!1,s=>{let a=s.memoizedState;for(;a;){if(a.memoizedState===e)return!0;a=a.next}});if(i)return i}},[t,e])}function QAt(){const t=ZAt(),[e]=P.useState(()=>new Map);e.clear();let n=t;for(;n;){if(n.type&&typeof n.type=="object"){const i=n.type._context===void 0&&n.type.Provider===n.type?n.type:n.type._context;i&&i!==QG&&!e.has(i)&&e.set(i,P.useContext(Txe(i)))}n=n.return}return e}function JAt(){const t=QAt();return P.useMemo(()=>Array.from(t.keys()).reduce((e,n)=>r=>P.createElement(e,null,P.createElement(n.Provider,YAt(Wee({},r),{value:t.get(n)}))),e=>P.createElement(Exe,Wee({},e))),[t])}const eIt=P.forwardRef(function({children:e,fallback:n,resize:r,style:i,gl:s,events:a=jAt,eventSource:o,eventPrefix:l,shadows:c,linear:u,flat:d,legacy:h,orthographic:f,frameloop:p,dpr:g,performance:m,raycaster:y,camera:x,scene:b,onPointerMissed:_,onCreated:T,...E},C){P.useMemo(()=>vAt(dAt),[]);const I=JAt(),[A,k]=zAt({scroll:!0,debounce:{scroll:50,resize:0},...r}),R=P.useRef(null),$=P.useRef(null);P.useImperativeHandle(C,()=>R.current);const z=wAt(_),[O,j]=P.useState(!1),[B,W]=P.useState(!1);if(O)throw O;if(B)throw B;const L=P.useRef(null);vO(()=>{const H=R.current;k.width>0&&k.height>0&&H&&(L.current||(L.current=LAt(H)),L.current.configure({gl:s,events:a,shadows:c,linear:u,flat:d,legacy:h,orthographic:f,frameloop:p,dpr:g,performance:m,raycaster:y,camera:x,scene:b,size:k,onPointerMissed:(...K)=>z.current==null?void 0:z.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(o?bAt(o)?o.current:o:$.current),l&&K.setEvents({compute:(te,J)=>{const oe=te[l+"X"],fe=te[l+"Y"];J.pointer.set(oe/J.size.width*2-1,-(fe/J.size.height)*2+1),J.raycaster.setFromCamera(J.pointer,J.camera)}}),T==null||T(K)}}),L.current.render(v.jsx(I,{children:v.jsx(mxe,{set:W,children:v.jsx(P.Suspense,{fallback:v.jsx(SAt,{set:j}),children:e??null})})})))}),P.useEffect(()=>{const H=R.current;if(H)return()=>wxe(H)},[]);const V=o?"none":"auto";return v.jsx("div",{ref:$,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:V,...i},...E,children:v.jsx("div",{ref:A,style:{width:"100%",height:"100%"},children:v.jsx("canvas",{ref:R,style:{display:"block"},children:n})})})}),tIt=P.forwardRef(function(e,n){return v.jsx(Exe,{children:v.jsx(eIt,{...e,ref:n})})});var Cxe=["PageUp","PageDown"],Nxe=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Axe={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Ab="Slider",[sB,nIt,rIt]=Yk(Ab),[Ixe,eFt]=Yl(Ab,[rIt]),[iIt,xO]=Ixe(Ab),kxe=P.forwardRef((t,e)=>{const{name:n,min:r=0,max:i=100,step:s=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:f=!1,form:p,...g}=t,m=P.useRef(new Set),y=P.useRef(0),b=a==="horizontal"?sIt:aIt,[_=[],T]=zf({prop:u,defaultProp:c,onChange:R=>{var z;(z=[...m.current][y.current])==null||z.focus(),d(R)}}),E=P.useRef(_);function C(R){const $=dIt(_,R);k(R,$)}function I(R){k(R,y.current)}function A(){const R=E.current[y.current];_[y.current]!==R&&h(_)}function k(R,$,{commit:z}={commit:!1}){const O=mIt(s),j=gIt(Math.round((R-r)/s)*s+r,O),B=hk(j,[r,i]);T((W=[])=>{const L=cIt(W,B,$);if(pIt(L,l*s)){y.current=L.indexOf(B);const V=String(L)!==String(W);return V&&z&&h(L),V?L:W}else return W})}return v.jsx(iIt,{scope:t.__scopeSlider,name:n,disabled:o,min:r,max:i,valueIndexToChangeRef:y,thumbs:m.current,values:_,orientation:a,form:p,children:v.jsx(sB.Provider,{scope:t.__scopeSlider,children:v.jsx(sB.Slot,{scope:t.__scopeSlider,children:v.jsx(b,{"aria-disabled":o,"data-disabled":o?"":void 0,...g,ref:e,onPointerDown:kt(g.onPointerDown,()=>{o||(E.current=_)}),min:r,max:i,inverted:f,onSlideStart:o?void 0:C,onSlideMove:o?void 0:I,onSlideEnd:o?void 0:A,onHomeKeyDown:()=>!o&&k(r,0,{commit:!0}),onEndKeyDown:()=>!o&&k(i,_.length-1,{commit:!0}),onStepKeyDown:({event:R,direction:$})=>{if(!o){const j=Cxe.includes(R.key)||R.shiftKey&&Nxe.includes(R.key)?10:1,B=y.current,W=_[B],L=s*j*$;k(W+L,B,{commit:!0})}}})})})})});kxe.displayName=Ab;var[Mxe,Rxe]=Ixe(Ab,{startEdge:"left",endEdge:"right",size:"width",direction:1}),sIt=P.forwardRef((t,e)=>{const{min:n,max:r,dir:i,inverted:s,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=t,[d,h]=P.useState(null),f=Vn(e,b=>h(b)),p=P.useRef(void 0),g=OP(i),m=g==="ltr",y=m&&!s||!m&&s;function x(b){const _=p.current||d.getBoundingClientRect(),T=[0,_.width],C=JG(T,y?[n,r]:[r,n]);return p.current=_,C(b-_.left)}return v.jsx(Mxe,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:v.jsx(Pxe,{dir:g,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:b=>{const _=x(b.clientX);a==null||a(_)},onSlideMove:b=>{const _=x(b.clientX);o==null||o(_)},onSlideEnd:()=>{p.current=void 0,l==null||l()},onStepKeyDown:b=>{const T=Axe[y?"from-left":"from-right"].includes(b.key);c==null||c({event:b,direction:T?-1:1})}})})}),aIt=P.forwardRef((t,e)=>{const{min:n,max:r,inverted:i,onSlideStart:s,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=t,u=P.useRef(null),d=Vn(e,u),h=P.useRef(void 0),f=!i;function p(g){const m=h.current||u.current.getBoundingClientRect(),y=[0,m.height],b=JG(y,f?[r,n]:[n,r]);return h.current=m,b(g-m.top)}return v.jsx(Mxe,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:v.jsx(Pxe,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:g=>{const m=p(g.clientY);s==null||s(m)},onSlideMove:g=>{const m=p(g.clientY);a==null||a(m)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:g=>{const y=Axe[f?"from-bottom":"from-top"].includes(g.key);l==null||l({event:g,direction:y?-1:1})}})})}),Pxe=P.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:i,onSlideEnd:s,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=t,u=xO(Ab,n);return v.jsx(Wt.span,{...c,ref:e,onKeyDown:kt(t.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):Cxe.concat(Nxe).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:kt(t.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:kt(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&i(d)}),onPointerUp:kt(t.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),s(d))})})}),Oxe="SliderTrack",Dxe=P.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=xO(Oxe,n);return v.jsx(Wt.span,{"data-disabled":i.disabled?"":void 0,"data-orientation":i.orientation,...r,ref:e})});Dxe.displayName=Oxe;var aB="SliderRange",$xe=P.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,i=xO(aB,n),s=Rxe(aB,n),a=P.useRef(null),o=Vn(e,a),l=i.values.length,c=i.values.map(h=>jxe(h,i.min,i.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return v.jsx(Wt.span,{"data-orientation":i.orientation,"data-disabled":i.disabled?"":void 0,...r,ref:o,style:{...t.style,[s.startEdge]:u+"%",[s.endEdge]:d+"%"}})});$xe.displayName=aB;var oB="SliderThumb",Lxe=P.forwardRef((t,e)=>{const n=nIt(t.__scopeSlider),[r,i]=P.useState(null),s=Vn(e,o=>i(o)),a=P.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return v.jsx(oIt,{...t,ref:s,index:a})}),oIt=P.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,name:i,...s}=t,a=xO(oB,n),o=Rxe(oB,n),[l,c]=P.useState(null),u=Vn(e,x=>c(x)),d=l?a.form||!!l.closest("form"):!0,h=wse(l),f=a.values[r],p=f===void 0?0:jxe(f,a.min,a.max),g=uIt(r,a.values.length),m=h==null?void 0:h[o.size],y=m?hIt(m,p,o.direction):0;return P.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),v.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${p}% + ${y}px)`},children:[v.jsx(sB.ItemSlot,{scope:t.__scopeSlider,children:v.jsx(Wt.span,{role:"slider","aria-label":t["aria-label"]||g,"aria-valuemin":a.min,"aria-valuenow":f,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...s,ref:u,style:f===void 0?{display:"none"}:t.style,onFocus:kt(t.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&v.jsx(Fxe,{name:i??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:f},r)]})});Lxe.displayName=oB;var lIt="RadioBubbleInput",Fxe=P.forwardRef(({__scopeSlider:t,value:e,...n},r)=>{const i=P.useRef(null),s=Vn(i,r),a=fge(e);return P.useEffect(()=>{const o=i.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==e&&u){const d=new Event("input",{bubbles:!0});u.call(o,e),o.dispatchEvent(d)}},[a,e]),v.jsx(Wt.input,{style:{display:"none"},...n,ref:s,defaultValue:e})});Fxe.displayName=lIt;function cIt(t=[],e,n){const r=[...t];return r[n]=e,r.sort((i,s)=>i-s)}function jxe(t,e,n){const s=100/(n-e)*(t-e);return hk(s,[0,100])}function uIt(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function dIt(t,e){if(t.length===1)return 0;const n=t.map(i=>Math.abs(i-e)),r=Math.min(...n);return n.indexOf(r)}function hIt(t,e,n){const r=t/2,s=JG([0,50],[0,r]);return(r-s(e)*n)*n}function fIt(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function pIt(t,e){if(e>0){const n=fIt(t);return Math.min(...n)>=e}return!0}function JG(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function mIt(t){return(String(t).split(".")[1]||"").length}function gIt(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var zxe=kxe,yIt=Dxe,vIt=$xe,xIt=Lxe;const tA=P.forwardRef(({className:t,...e},n)=>v.jsxs(zxe,{ref:n,className:Pt("relative flex w-full touch-none select-none items-center",t),...e,children:[v.jsx(yIt,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:v.jsx(vIt,{className:"absolute h-full bg-primary"})}),v.jsx(xIt,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));tA.displayName=zxe.displayName;const bIt=()=>{const[t,e]=P.useState("intro"),[n,r]=P.useState("rangeOfMotion"),[i,s]=P.useState(1),[a,o]=P.useState(null),[l,c]=P.useState(!1),[u,d]=P.useState("portrait");P.useEffect(()=>{var m;"xr"in navigator?(m=navigator.xr)==null||m.isSessionSupported("immersive-ar").then(y=>{o(y)}).catch(()=>{o(!1)}):o(!1);const g=()=>{d(window.innerHeight>window.innerWidth?"portrait":"landscape")};return window.addEventListener("resize",g),g(),()=>{window.removeEventListener("resize",g)}},[]);const{data:h=[]}=Kr({queryKey:["/api/exercises"]}),f=h?h.filter(g=>g.type==="mobility"||g.type==="balance"):[],p=()=>{c(!0),e("arView")};return v.jsxs(nd,{title:"AR Therapy",children:[v.jsxs("div",{className:"mb-6",children:[v.jsx("h1",{className:"text-2xl font-bold mb-2",children:"AR Therapy Exercises"}),v.jsx("p",{className:"text-neutral-600",children:"Use augmented reality on your mobile device to follow guided exercises in your real environment."})]}),v.jsxs(oy,{defaultValue:"intro",className:"mb-6",onValueChange:e,children:[v.jsxs(Np,{children:[v.jsx(oi,{value:"intro",children:"Introduction"}),v.jsx(oi,{value:"arView",children:"AR Experience"}),v.jsx(oi,{value:"exercises",children:"Exercise Library"}),v.jsx(oi,{value:"settings",children:"Settings"})]}),v.jsxs(li,{value:"intro",className:"space-y-4",children:[v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Getting Started with AR Therapy"}),v.jsx(Nr,{children:"Experience guided physiotherapy exercises in your real environment using augmented reality"})]}),v.jsx(Lt,{className:"space-y-4",children:v.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[v.jsxs("div",{className:"md:w-2/3",children:[v.jsx("h3",{className:"text-lg font-medium mb-3",children:"How AR Therapy Works"}),v.jsx("p",{className:"mb-3",children:"AR Therapy uses your device's camera to overlay exercise guides, targets, and feedback in your real-world environment, making rehabilitation more engaging and effective."}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-6",children:[v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:v.jsx(Gie,{className:"h-5 w-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-medium",children:"Camera Access"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"You'll need to grant camera access to use AR features"})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:v.jsx(oCe,{className:"h-5 w-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-medium",children:"Device Requirements"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"Works best on newer smartphones and tablets"})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:v.jsx(iCe,{className:"h-5 w-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-medium",children:"Exercise Tracking"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"AI algorithms track your movement accuracy"})]})]}),v.jsxs("div",{className:"flex items-start",children:[v.jsx("div",{className:"bg-primary/10 p-2 rounded-full mr-3",children:v.jsx(uCe,{className:"h-5 w-5 text-primary"})}),v.jsxs("div",{children:[v.jsx("h4",{className:"font-medium",children:"Calibration"}),v.jsx("p",{className:"text-sm text-neutral-600",children:"You'll be guided through a brief calibration process"})]})]})]})]}),v.jsxs("div",{className:"md:w-1/3 bg-gray-100 rounded-lg p-4",children:[v.jsx("h3",{className:"text-lg font-medium mb-3",children:"AR Compatibility"}),v.jsxs("div",{className:"mb-4",children:[v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("span",{children:"Device Support:"}),v.jsx("span",{className:`px-2 py-1 rounded text-xs ${a===!0?"bg-green-100 text-green-800":a===!1?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:a===!0?"AR Supported":a===!1?"AR Not Supported":"Checking..."})]}),v.jsxs("div",{className:"flex items-center justify-between mb-2",children:[v.jsx("span",{children:"Orientation:"}),v.jsx("span",{className:"px-2 py-1 rounded text-xs bg-blue-100 text-blue-800",children:u})]}),v.jsx("div",{className:"text-sm text-neutral-600 mt-4",children:a===!1?v.jsx("p",{children:"Your device does not appear to support WebXR for AR experiences. You can still view demonstration videos and guides."}):v.jsx("p",{children:"For the best AR experience, make sure you're in a well-lit area with enough space to move freely."})})]}),v.jsx(et,{onClick:p,disabled:a===!1,className:"w-full",children:a===null?"Checking AR Support...":a===!1?"View Demo Only":"Start AR Experience"})]})]})})]}),v.jsxs(Dt,{children:[v.jsx(en,{children:v.jsx(tn,{children:"Recommended Exercises"})}),v.jsx(Lt,{children:v.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:f.length>0?f.slice(0,3).map((g,m)=>v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-2",children:g.name}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:g.description}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{var y,x,b;r((y=g.targetArea)!=null&&y.toLowerCase().includes("shoulder")?"rangeOfMotion":(x=g.targetArea)!=null&&x.toLowerCase().includes("back")?"postureCorrection":(b=g.targetArea)!=null&&b.toLowerCase().includes("leg")?"walkingGait":"balanceTraining"),p()},children:"Start in AR"})]},m)):v.jsx("div",{className:"col-span-3 text-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:v.jsx("p",{className:"text-neutral-600",children:"No exercises have been assigned yet. Please check back later or contact your therapist."})})})})]})]}),v.jsxs(li,{value:"arView",className:"space-y-4",children:[v.jsx(Dt,{className:"overflow-hidden",children:v.jsx(Lt,{className:"p-0",children:v.jsxs("div",{className:"relative aspect-[9/16] md:aspect-[16/9] bg-black",children:[a!==!1?v.jsxs("div",{className:"absolute inset-0",children:[v.jsxs(tIt,{children:[v.jsx("ambientLight",{intensity:.5}),v.jsx("pointLight",{position:[10,10,10]})]}),v.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2",children:v.jsx(et,{className:"px-4 py-2 bg-primary text-white rounded-lg",onClick:()=>c(!l),children:l?"Exit AR":"Enter AR"})})]}):v.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:v.jsxs("div",{className:"text-center text-white p-8",children:[v.jsx("h3",{className:"text-xl font-medium mb-4",children:"AR Not Available"}),v.jsx("p",{className:"mb-6",children:"Your device doesn't support AR features. Here's a video demonstration instead."}),v.jsx("div",{className:"border-2 border-white/20 p-4 rounded-lg",children:v.jsx("p",{children:"Video demonstration would appear here"})})]})}),v.jsx("div",{className:"absolute top-4 left-4 right-4 bg-black/30 backdrop-blur-sm p-3 rounded-lg text-white",children:v.jsxs("div",{className:"flex justify-between items-center",children:[v.jsx("h3",{className:"font-medium",children:n==="rangeOfMotion"?"Range of Motion Exercise":n==="postureCorrection"?"Posture Correction":n==="balanceTraining"?"Balance Training":"Walking Gait Analysis"}),v.jsxs("span",{className:"px-2 py-1 bg-primary/80 rounded text-xs",children:["Level ",i]})]})}),v.jsx("div",{className:"absolute bottom-20 left-4 right-4 bg-black/30 backdrop-blur-sm p-3 rounded-lg text-white",children:v.jsxs("div",{className:"flex justify-between gap-2",children:[v.jsx(et,{variant:"outline",size:"sm",className:"text-white border-white/50 hover:bg-white/20 hover:text-white flex-1",children:"Pause"}),v.jsx(et,{variant:"outline",size:"sm",className:"text-white border-white/50 hover:bg-white/20 hover:text-white flex-1",children:"Reset"}),v.jsx(et,{variant:"outline",size:"sm",className:"text-white border-white/50 hover:bg-white/20 hover:text-white flex-1",children:"Guide"})]})})]})})}),v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"Exercise Selection"})}),v.jsx(Lt,{children:v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Exercise Type"}),v.jsxs(Yw,{value:n,onValueChange:g=>r(g),children:[v.jsx(Lv,{children:v.jsx(Zw,{placeholder:"Select exercise type"})}),v.jsxs(Fv,{children:[v.jsx(ts,{value:"rangeOfMotion",children:"Range of Motion"}),v.jsx(ts,{value:"postureCorrection",children:"Posture Correction"}),v.jsx(ts,{value:"balanceTraining",children:"Balance Training"}),v.jsx(ts,{value:"walkingGait",children:"Walking Gait Analysis"})]})]})]}),v.jsxs("div",{children:[v.jsxs("label",{className:"block text-sm font-medium mb-1",children:["Difficulty Level: ",i]}),v.jsx(tA,{min:1,max:5,step:1,value:[i],onValueChange:g=>s(g[0]),className:"py-4"}),v.jsxs("div",{className:"flex justify-between text-xs text-neutral-500",children:[v.jsx("span",{children:"Easy"}),v.jsx("span",{children:"Advanced"})]})]})]})})]}),v.jsxs(Dt,{children:[v.jsx(en,{className:"pb-2",children:v.jsx(tn,{children:"AR Guidance Tips"})}),v.jsxs(Lt,{children:[v.jsxs("ul",{className:"space-y-2 text-sm",children:[v.jsxs("li",{className:"flex items-start",children:[v.jsx("span",{className:"bg-primary/10 p-1 rounded-full mr-2 text-primary",children:"1"}),"Find a well-lit area with enough space to move"]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx("span",{className:"bg-primary/10 p-1 rounded-full mr-2 text-primary",children:"2"}),"Point your camera at a flat surface to establish the AR environment"]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx("span",{className:"bg-primary/10 p-1 rounded-full mr-2 text-primary",children:"3"}),"Follow the virtual targets and guides for proper form"]}),v.jsxs("li",{className:"flex items-start",children:[v.jsx("span",{className:"bg-primary/10 p-1 rounded-full mr-2 text-primary",children:"4"}),"Move slowly and focus on accurate movement patterns"]})]}),v.jsx("div",{className:"mt-4 flex justify-end",children:v.jsxs(et,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[v.jsx(aCe,{className:"h-4 w-4"}),v.jsx("span",{children:"Share Session"})]})})]})]})]})]}),v.jsx(li,{value:"exercises",className:"space-y-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"Exercise Library"}),v.jsx(Nr,{children:"Browse available AR-enabled exercises"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-1",children:"Range of Motion Exercises"}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:"Guided exercises to improve joint mobility and flexibility"}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{r("rangeOfMotion"),p()},children:"Start Exercise"})]}),v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-1",children:"Posture Correction"}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:"Real-time feedback to improve standing and sitting posture"}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{r("postureCorrection"),p()},children:"Start Exercise"})]}),v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-1",children:"Balance Training"}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:"Games and exercises to improve stability and balance"}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{r("balanceTraining"),p()},children:"Start Exercise"})]}),v.jsxs("div",{className:"border rounded-lg p-4",children:[v.jsx("h3",{className:"font-medium mb-1",children:"Walking Gait Analysis"}),v.jsx("p",{className:"text-sm text-neutral-600 mb-3",children:"Analysis and correction of walking patterns"}),v.jsx(et,{variant:"outline",size:"sm",onClick:()=>{r("walkingGait"),p()},children:"Start Exercise"})]})]})})]})}),v.jsx(li,{value:"settings",className:"space-y-4",children:v.jsxs(Dt,{children:[v.jsxs(en,{children:[v.jsx(tn,{children:"AR Settings"}),v.jsx(Nr,{children:"Customize your AR therapy experience"})]}),v.jsx(Lt,{children:v.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[v.jsx("div",{className:"space-y-4",children:v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-3",children:"Visual Settings"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Guide Opacity"}),v.jsx(tA,{min:0,max:100,step:10,defaultValue:[70],className:"py-4"})]}),v.jsxs("div",{children:[v.jsx("label",{className:"block text-sm font-medium mb-1",children:"Guide Size"}),v.jsx(tA,{min:0,max:100,step:10,defaultValue:[50],className:"py-4"})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"Show Movement Path"}),v.jsx("input",{type:"checkbox",defaultChecked:!0})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"Show Real-time Feedback"}),v.jsx("input",{type:"checkbox",defaultChecked:!0})]})]})]})}),v.jsxs("div",{className:"space-y-4",children:[v.jsxs("div",{children:[v.jsx("h3",{className:"font-medium mb-3",children:"Performance Settings"}),v.jsxs("div",{className:"space-y-3",children:[v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"High-Quality Rendering"}),v.jsx("input",{type:"checkbox",defaultChecked:!0})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"Battery Saver Mode"}),v.jsx("input",{type:"checkbox"})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"Record Sessions"}),v.jsx("input",{type:"checkbox"})]}),v.jsxs("div",{className:"flex items-center justify-between",children:[v.jsx("label",{className:"text-sm font-medium",children:"Share Progress with Therapist"}),v.jsx("input",{type:"checkbox",defaultChecked:!0})]})]})]}),v.jsx("div",{className:"mt-6",children:v.jsx(et,{className:"w-full",children:"Save Settings"})})]})]})})]})})]})]})};function wIt(){return v.jsx("div",{className:"min-h-screen w-full flex items-center justify-center bg-gray-50",children:v.jsx(Dt,{className:"w-full max-w-md mx-4",children:v.jsxs(Lt,{className:"pt-6",children:[v.jsxs("div",{className:"flex mb-4 gap-2",children:[v.jsx(z0,{className:"h-8 w-8 text-red-500"}),v.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"404 Page Not Found"})]}),v.jsx("p",{className:"mt-4 text-sm text-gray-600",children:"Did you forget to add the page to the router?"})]})})})}function SIt(){return v.jsxs(hTe,{children:[v.jsx(sc,{path:"/",component:Zxt}),v.jsx(sc,{path:"/session",component:S0t}),v.jsx(sc,{path:"/profile",component:cwt}),v.jsx(sc,{path:"/exercises",component:Ewt}),v.jsx(sc,{path:"/progress",component:Cwt}),v.jsx(sc,{path:"/therapist",component:Nwt}),v.jsx(sc,{path:"/payments",component:Awt}),v.jsx(sc,{path:"/gutrehab",component:jwt}),v.jsx(sc,{path:"/vr-therapy",component:g1t}),v.jsx(sc,{path:"/ar-therapy",component:bIt}),v.jsx(sc,{component:wIt})]})}function _It(){return v.jsx(DTe,{client:KTe,children:v.jsx(w2e,{attribute:"class",defaultTheme:"light",children:v.jsxs(y2e,{children:[v.jsx(GCe,{}),v.jsx(SIt,{})]})})})}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bxe={kernelName:uM,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,Z0(nt(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TIt={kernelName:U_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=fr(nt(n,"float32")),i=Is(ut(It(1),r));return Dr(ct(t,i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EIt={kernelName:V_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Is(ut(fr(nt(n,"float32")),1));return ct(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CIt={kernelName:X0,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{let o=t;const l=Yi(n.shape,i);return l.length>0&&(o=Et(o,l)),de(o,n.shape)},b:()=>{let o=t;const l=Yi(r.shape,i);return l.length>0&&(o=Et(o,l)),de(o,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NIt={kernelName:dM,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((r,i)=>{n[i]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AIt={kernelName:hM,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fn(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IIt={kernelName:fM,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Fn(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIt={kernelName:W_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,Is(ut(It(1),fr(nt(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MIt={kernelName:H_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Is(He(It(1),fr(nt(n,"float32"))));return ct(t,r)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIt={kernelName:X_,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{const o=He(fr(n),fr(r));let l=se(t,ct(r,o));const c=Yi(n.shape,i);return c.length>0&&(l=Et(l,c)),de(l,n.shape)},b:()=>{const o=He(fr(n),fr(r));let l=Dr(se(t,ct(n,o)));const c=Yi(r.shape,i);return c.length>0&&(l=Et(l,c)),de(l,r.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PIt={kernelName:G_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,He(fr(nt(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OIt={kernelName:q_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,ut(It(1),fr(nt(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DIt(t,e,n,r,i,s){const a=Y(t,"dy","avgPool3dGrad"),o=Y(e,"input","avgPool3dGrad");let l=a,c=o,u=!1;o.rank===4&&(u=!0,l=de(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),c=de(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]])),q(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),q(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),wa("avgPool3dGrad",i,s);const d={dy:l,input:c},h={filterSize:n,strides:r,pad:i,dimRoundingMode:s},f=ue.runKernel(KU,d,h);return u?de(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const $It=ce({avgPool3dGrad_:DIt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LIt={kernelName:mM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:s,pad:a,dimRoundingMode:o}=n;return{x:()=>$It(t,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FIt(t,e,n,r,i){const s=Y(t,"dy","avgPoolGrad"),a=Y(e,"input","avgPoolGrad");q(a.rank===s.rank,()=>`Rank of input (${a.rank}) does not match rank of dy (${s.rank})`);let o=a,l=s,c=!1;a.rank===3&&(c=!0,o=de(a,[1,a.shape[0],a.shape[1],a.shape[2]]),l=de(s,[1,s.shape[0],s.shape[1],s.shape[2]])),q(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),q(o.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${o.rank}.`);const u={dy:l,input:o},d={filterSize:n,strides:r,pad:i},h=ue.runKernel(XU,u,d);return c?de(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const jIt=ce({avgPoolGrad_:FIt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zIt={kernelName:pM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{filterSize:i,strides:s,pad:a}=n;return{x:()=>jIt(t,r,i,s,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BIt={kernelName:gM,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[r,i]=e,{transposeA:s,transposeB:a}=n;return!s&&!a?{a:()=>Mn(t,i,!1,!0),b:()=>Mn(r,t,!0,!1)}:!s&&a?{a:()=>Mn(t,i,!1,!1),b:()=>Mn(t,r,!0,!1)}:s&&!a?{a:()=>Mn(i,t,!1,!0),b:()=>Mn(r,t,!1,!1)}:{a:()=>Mn(i,t,!0,!0),b:()=>Mn(t,r,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UIt={kernelName:yM,gradFunc:(t,e,n)=>{const{blockShape:r,crops:i}=n;return{x:()=>TR(t,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIt={kernelName:JAe,gradFunc:(t,e,n)=>{const r=n,i=r.inputShape,s=r.shape,a=Array.from(s);for(let l=i.length-1;l>=0;l--)if(i[l]===s[l])a[l]=1;else if(i[l]!==1)throw new Error(`broadcastTo(): [${i}] cannot be broadcast to [${s}].`);const o=[];for(let l=0;l<a.length;l++)a[l]>1&&o.push(l);return{x:()=>Et(t,o,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WIt={kernelName:K_,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIt={kernelName:Y_,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GIt={kernelName:Z_,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{clipValueMin:i,clipValueMax:s}=n;return{x:()=>Hs(Gu(yp(r,i),Kg(r,s)),t,Fn(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qIt={kernelName:xM,inputsToSave:["x"],gradFunc:Bxe.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIt={kernelName:bM,saveAllInputs:!0,gradFunc:(t,e,n)=>{const r=e.map(l=>l.shape),{axis:i}=n,s=Nn(i,e[0].shape)[0],a=r.map(l=>l[s]);return vo(t,a,s).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KIt={kernelName:wM,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{dilations:s,strides:a,pad:o,dataFormat:l}=n;return q(Gf(s),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`),{x:()=>iW(r.shape,t,i,a,o,l),filter:()=>jW(r,t,i.shape,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YIt={kernelName:SM,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,{strides:s,pad:a,dataFormat:o,dimRoundingMode:l}=n;return{dy:()=>qf(t,i,s,a,o,1,l),filter:()=>jW(t,r,i.shape,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZIt(t,e,n,r,i){let s=t;t.rank===4&&(s=de(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let a=e;a.rank===4&&(a=de(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),q(s.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${s.shape}.`),q(a.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${a.shape}.`),q(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),q(s.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${s.shape[4]}) must match input depth in filter (${n[3]}.`),q(a.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${a.shape[4]}) must match output depth for filter (${n[4]}).`);const o={x:s,dy:a},l={strides:r,pad:i,filterShape:n};return ue.runKernel(eV,o,l)}const QIt=ce({conv3DBackpropFilter_:ZIt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIt={kernelName:_M,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:s}=n;q(Gf(r),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${r}'`);const[a,o]=e;return{x:()=>xoe(a.shape,t,o,i,s),filter:()=>QIt(a,t,o.shape,i,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ekt={kernelName:Q_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(Dr(IW(nt(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tkt={kernelName:J_,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(kW(nt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nkt={kernelName:TM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i,exclusive:s,reverse:a}=n;return{x:()=>{const o=Jr([i],r.rank);let l=oW(t,i,s,!a);return o!=null&&(l=Ln(l,o)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rkt={kernelName:EM,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:r,strides:i,pad:s,dimRoundingMode:a}=n,o=r??[1,1];q(Gf(o),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[l,c]=e;return q(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),q(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),q(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),q(ks(i,o),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${i} and dilations '${o}'.`),wa("depthwiseConv2d",s,a),{x:()=>ele(l.shape,t,c,i,s,o,a),filter:()=>Joe(l,t,c.shape,i,s,o,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ikt={kernelName:CM,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[r,i]=e,s={x:r,filter:i,dy:t},a={x:r,filter:i,dy:t};return{x:()=>ue.runKernel(GF,s,n),filter:()=>ue.runKernel(qF,a,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const skt={kernelName:tT,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,r={dy:t,y:n};return{x:()=>ue.runKernel(uV,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const akt={kernelName:nT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=se(va(Dr(fr(n))),2/Math.sqrt(Math.PI));return{x:()=>se(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const okt={kernelName:rT,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lkt={kernelName:AM,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>de(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ckt={kernelName:iT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,va(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ukt={kernelName:sT,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dkt={kernelName:aT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{const o=ct(t,nt(r,"float32")),l=Yi(n.shape,i);return l.length>0?de(Et(o,l),n.shape):o},b:()=>{let o=se(t,nt(n,"float32"));const l=Yi(r.shape,i);l.length>0&&(o=de(Et(o,l),r.shape));const c=fr(r);return Dr(ct(o,nt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hkt={kernelName:IM,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:r}=n,[i,s,a,o]=e,l=o??It(1),c=Yi(s.shape,i.shape),u=[];if(s.rank===1){for(let _=0;_<i.shape.length-1;++_)u.push(i.shape[_]);u.push(1)}const d=ut(i,s),h=se(t,l),f=CW(He(a,It(r))),p=se(se(se(f,f),f),It(-.5));return{x:()=>s.rank===1?de(se(se(t,Dl(de(f,[1,1,1,s.shape[0]]),u)),l),i.shape):de(se(se(t,f),l),i.shape),mean:()=>{let _=se(se(f,It(-1)),h);return s.rank===1&&(_=Et(_,c)),de(_,s.shape)},variance:()=>{let _=se(se(p,d),h);return s.rank===1&&(_=Et(_,c)),de(_,s.shape)},scale:()=>{const _=se(d,f);let T=se(t,_);return s.rank===1&&(T=Et(T,c)),de(T,s.shape)},offset:()=>{let _=t;return s.rank===1&&(_=Et(_,c)),de(_,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fkt={kernelName:kM,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[r,i]=e,{axis:s,batchDims:a}=n,o=Nn(s,r.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,o),g=p.length,m=h.slice(s,h.length).slice(1),y=m.length,x=Xee(0,g),b=Xee(g+1,g+1+y),_=Kee([p,[f],m]),T=de(d,_),E=de(u,[f]),C=Kee([[g],x,b]),I=Ln(T,C);let A=$W(I,E,c.shape[o]);const k=gp(C);return A=Ln(A,k),A};if(a===1){const c=r.shape[0],u=r.split(c,0);return{x:()=>wo(u.map((f,p)=>l(f,i.slice(p,1),t.slice(p,1))())).reshape(r.shape),indices:()=>i}}else return{x:l(r,i,t),indices:()=>i}}};function Xee(t,e){const n=[];for(let r=t;r<e;++r)n.push(r);return n}function Kee(t){const e=[];for(let n=0;n<t.length;++n)for(let r=0;r<t[n].length;++r)e.push(t[n][r]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pkt={kernelName:oT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>Fn(n),b:()=>Fn(r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mkt={kernelName:lT,gradFunc:t=>({x:()=>nt(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gkt={kernelName:cT,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ykt={kernelName:uT,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vkt={kernelName:dT,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xkt={kernelName:RM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{alpha:i}=n,s=Co(r,0);return{x:()=>Hs(s,t,se(t,i))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bkt={kernelName:fT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,He(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wkt={kernelName:hT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,nt(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Skt={kernelName:eIe,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;return{logits:()=>{const a=va(r);return ut(t,se(Et(t,i,!0),a))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _kt(t,e,n,r=5,i=1,s=1,a=.5){const o={x:t,y:e,dy:n},l={depthRadius:r,bias:i,alpha:s,beta:a};return ue.runKernel(vV,o,l)}const Tkt=ce({localResponseNormalizationBackprop_:_kt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ekt={kernelName:FM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{depthRadius:s,bias:a,alpha:o,beta:l}=n;return{x:()=>Tkt(r,i,t,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uxe(t,e,n,r){return e.rank<n.rank&&(e=de(e,bi(e.shape,r))),t.rank<n.rank&&(t=de(t,bi(t.shape,r))),{x:()=>se(t,nt(Hc(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yee={kernelName:jM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{reductionIndices:i}=r,s=e[0],a=e[1],o=Nn(i,s.shape),l=Uxe(t,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ckt={kernelName:pT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>se(t,nt(yp(n,r),"float32")),b:()=>se(t,nt(Z1(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nkt(t,e,n,r,i,s,a){const o=Y(t,"dy","maxPool3dGrad"),l=Y(e,"input","maxPool3dGrad"),c=Y(n,"output","maxPool3dGrad");let u=o,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=de(o,[1,o.shape[0],o.shape[1],o.shape[2],o.shape[3]]),d=de(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=de(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),q(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),q(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),q(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),wa("maxPool3dGrad",s,a);const p={dy:u,input:d,output:h},g={filterSize:r,strides:i,pad:s,dimRoundingMode:a},m=ue.runKernel(bV,p,g);return f?de(m,[m.shape[1],m.shape[2],m.shape[3],m.shape[4]]):m}const Akt=ce({maxPool3dGrad_:Nkt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ikt={kernelName:BM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=n;return{x:()=>Akt(t,r,i,s,a,o,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kkt(t,e,n,r,i,s,a){const o=Y(t,"dy","maxPoolGrad"),l=Y(e,"input","maxPoolGrad"),c=Y(n,"output","maxPoolGrad");q(l.rank===o.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${o.rank})`),q(o.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${o.rank}.`),q(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),wa("maxPoolGrad",s,a);const u={dy:o,input:l,output:c},d={filterSize:r,strides:i,pad:s,dimRoundingMode:a};return ue.runKernel(xV,u,d)}const Mkt=ce({maxPoolGrad_:kkt});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rkt={kernelName:zM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r,i]=e,{filterSize:s,strides:a,pad:o}=n;return{x:()=>Mkt(t,r,i,s,a,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pkt={kernelName:UM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n,s=Nn(i,r.shape),o=fs(r.shape,s)[1],l=Oe(o);return{x:()=>{const u=r.shape.slice();s.forEach(f=>{u[f]=1});const d=de(t,u);return ct(se(d,fo(r.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Okt={kernelName:VM,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const r=n,{axis:i}=r,[s,a]=e,o=Nn(i,s.shape),l=Uxe(t,a,s,o);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dkt={kernelName:mT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e;return{a:()=>se(t,nt(Kg(n,r),"float32")),b:()=>se(t,nt(Co(n,r),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $kt={kernelName:WM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>Kt(t,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lkt={kernelName:gT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{const o=Yi(n.shape,i);return o.length>0?de(Et(t,o),n.shape):t},b:()=>{const o=se(t,Dr(VT(ct(n,r)))),l=Yi(r.shape,i);return l.length>0?de(Et(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fkt={kernelName:yT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{const o=se(t,nt(r,"float32")),l=Yi(n.shape,i);return l.length>0?de(Et(o,l),n.shape):o},b:()=>{const o=se(t,nt(n,"float32")),l=Yi(r.shape,i);return l.length>0?de(Et(o,l),r.shape):o}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jkt={kernelName:HM,gradFunc:t=>({x:()=>Dr(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zkt={kernelName:XM,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Pi(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bkt={kernelName:qM,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ukt={kernelName:KM,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:r}=n;return Xl(t,r).map(s=>()=>s)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zee={kernelName:YM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const r=e[0],{paddings:i}=n,s=i.map(a=>a[0]);return{x:()=>Kt(t,s,r.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vkt={kernelName:vT,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,r,i]=e,s=n,a=r,o=dn(s.shape,a.shape);return{a:()=>{const u=nt(a,"float32");let d=se(t,se(u,nh(s,ut(u,It(1)))));const h=Yi(s.shape,o);return h.length>0&&(d=Et(d,h)),de(d,s.shape)},b:()=>{const u=Co(s,0),d=Hs(u,el(s),Fn(s));let h=se(t,se(i,d));const f=Yi(a.shape,o);return f.length>0&&(h=Et(h,f)),de(h,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wkt={kernelName:ZM,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,r]=e,i=Co(n,0);return{x:()=>Hs(i,t,se(t,r)),alpha:()=>{let s=Hs(i,Fn(t),se(t,n));const a=Yi(r.shape,t.shape);return a.length>0&&(s=Et(s,a)),de(s,r.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hkt(t,e,n){const r=t.shape.slice();r[n]=1;const i=de(e,r),s=WA(t,n,!0,!1),a=WA(t,n,!0,!0),o=se(s,a);return se(i,o)}function Gkt(t,e,n){const r=t.shape.length,i=r-n.length,s=Jr(n,r);let a=t;s!=null&&(a=Ln(t,s));const o=a.shape.slice(),c=o.splice(r-n.length,n.length).reduce((h,f)=>h*f,1);o.push(c);const u=a.reshape(o);let d=Hkt(u,e,i);if(d=d.reshape(a.shape),s!=null){const h=gp(s);d=Ln(d,h)}return d}const qkt={kernelName:QM,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{axis:i}=n;let s=[];return i==null?s=r.shape.map((a,o)=>o):typeof i=="number"?s=[i]:s=i,{x:()=>Gkt(r,t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xkt={kernelName:eT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{const o=ct(t,nt(r,"float32")),l=Yi(n.shape,i);return l.length>0?de(Et(o,l),n.shape):o},b:()=>{let o=se(t,nt(n,"float32"));const l=Yi(r.shape,i);l.length>0&&(o=de(Et(o,l),r.shape));const c=fr(r);return Dr(ct(o,nt(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kkt={kernelName:xT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,Dr(fr(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ykt={kernelName:wT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,r=se(Kg(n,6),Z0(n));return{x:()=>se(t,nt(r,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zkt={kernelName:bT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,nt(Z0(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qkt={kernelName:JM,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>de(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jkt={kernelName:tR,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>ue.runKernel(RV,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eMt={kernelName:eR,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[r]=e,i={dy:t,images:r};return{images:()=>ue.runKernel(MV,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tMt={kernelName:nR,gradFunc:(t,e,n)=>{const{dims:r}=n,i=Nn(r,t.shape);return{x:()=>ql(t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nMt={kernelName:ST,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rMt={kernelName:_T,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Dr(ct(t,se(nh(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iMt={kernelName:rR,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>nt(Fn(n),"float32"),t:()=>se(t,nt(n,t.dtype)),e:()=>se(t,nt(wR(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sMt={kernelName:TT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const r=Co(n,It(0)),i=It(FR),s=It(jR),a=se(t,s),o=se(se(t,i),va(nt(n,"float32")));return Hs(r,a,o)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aMt={kernelName:AT,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,se(n,ut(It(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oMt={kernelName:NT,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lMt={kernelName:ET,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(gR(nt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cMt={kernelName:CT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(aW(nt(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uMt={kernelName:iR,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{begin:i,size:s}=n,a=r.shape,[o,l]=$R(r,i,s),c=[];for(let u=0;u<t.rank;u++)c.push([o[u],a[u]-o[u]-l[u]]);return{x:()=>Gc(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dMt={kernelName:lR,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[r]=e,{dim:i}=n,s=!0,a=se(t,r);return{logits:()=>ut(a,se(Et(a,[i],s),r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hMt={kernelName:IT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,Ko(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qee={kernelName:aR,gradFunc:(t,e,n)=>{const{blockShape:r,paddings:i}=n;return{x:()=>mR(t,r,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jee={kernelName:oR,gradFunc:(t,e,n)=>{const{axis:r}=n;return{x:()=>Qr(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fMt={kernelName:kT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,se(Is(nt(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pMt={kernelName:BV,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(t,se(nt(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mMt={kernelName:MT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=It(2);return{a:()=>se(t,se(i,ut(n,r))),b:()=>se(t,se(i,ut(r,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gMt={kernelName:$T,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yMt={kernelName:RT,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,r]=e,i=dn(n.shape,r.shape);return{a:()=>{let o=t;const l=Yi(n.shape,i);return l.length>0&&(o=Et(o,l)),de(o,n.shape)},b:()=>{let o=t;const l=Yi(r.shape,i);return l.length>0&&(o=Et(o,l)),de(Dr(o),r.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vMt={kernelName:sR,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,i=r.shape.slice(),{axis:s}=n;Nn(s,r.shape).forEach(c=>{i[c]=1});const o=de(t,i),l=se(o,fo(r.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xMt={kernelName:PT,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ct(t,fr(gR(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bMt={kernelName:OT,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>se(ut(It(1),fr(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wMt={kernelName:DT,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[r]=e,{reps:i}=n;return{x:()=>{let a=Fn(r);if(r.rank===1)for(let o=0;o<i[0];++o)a=He(a,Kt(t,[o*r.shape[0]],[r.shape[0]]));else if(r.rank===2)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)a=He(a,Kt(t,[o*r.shape[0],l*r.shape[1]],[r.shape[0],r.shape[1]]));else if(r.rank===3)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)a=He(a,Kt(t,[o*r.shape[0],l*r.shape[1],c*r.shape[2]],[r.shape[0],r.shape[1],r.shape[2]]));else if(r.rank===4)for(let o=0;o<i[0];++o)for(let l=0;l<i[1];++l)for(let c=0;c<i[2];++c)for(let u=0;u<i[3];++u)a=He(a,Kt(t,[o*r.shape[0],l*r.shape[1],c*r.shape[2],u*r.shape[3]],[r.shape[0],r.shape[1],r.shape[2],r.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${r.rank} tensors yet.`);return a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SMt={kernelName:nx,gradFunc:(t,e,n)=>{const r=n,{perm:i}=r,s=gp(i);return{x:()=>Ln(t,s)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Mt={kernelName:uR,gradFunc:(t,e,n)=>{const r=n,{axis:i}=r;return{value:()=>wo(t,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TMt={kernelName:dR,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>EMt(t,n)}}};function EMt(t,e){const n=vh(e,Fn(e)),r=WT(t,n);let i=yp(e,It(0,"int32"));const s=r.rank-i.rank;for(let o=0;o<s;++o)i=Mi(i,o+1);i=Gu(i,fo(r.shape,"bool"));const a=Fn(r);return Hs(i,r,a)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CMt={kernelName:hR,gradFunc:t=>({x:()=>Fn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NMt=[Bxe,TIt,EIt,CIt,NIt,AIt,IIt,kIt,MIt,RIt,PIt,OIt,LIt,zIt,BIt,UIt,VIt,WIt,HIt,GIt,qIt,XIt,YIt,KIt,JIt,ekt,tkt,nkt,rkt,ikt,Xkt,skt,akt,okt,lkt,ckt,dkt,ukt,hkt,fkt,pkt,mkt,gkt,ykt,vkt,xkt,bkt,wkt,Skt,Ekt,Yee,Yee,Ckt,Ikt,Rkt,Pkt,Okt,Dkt,$kt,Lkt,Fkt,jkt,zkt,Bkt,Ukt,Zee,Zee,Vkt,Wkt,qkt,Kkt,Ykt,Zkt,Qkt,Jkt,eMt,tMt,nMt,rMt,iMt,sMt,aMt,oMt,lMt,cMt,uMt,dMt,hMt,Qee,Qee,Jee,Jee,fMt,mMt,pMt,gMt,yMt,vMt,xMt,bMt,wMt,SMt,_Mt,TMt,CMt];for(const t of NMt)nIe(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.abs=function(){return this.throwIfDisposed(),Bi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.acos=function(){return this.throwIfDisposed(),eoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.acosh=function(){return this.throwIfDisposed(),toe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.add=function(t){return this.throwIfDisposed(),He(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.all=function(t,e){return this.throwIfDisposed(),tW(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.any=function(t,e){return this.throwIfDisposed(),VA(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.argMax=function(t){return this.throwIfDisposed(),wg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.argMin=function(t){return this.throwIfDisposed(),noe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asScalar=function(){return this.throwIfDisposed(),q(this.size===1,()=>"The array must have only 1 element."),de(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asType=function(t){return this.throwIfDisposed(),nt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as1D=function(){return this.throwIfDisposed(),de(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as2D=function(t,e){return this.throwIfDisposed(),de(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),de(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as4D=function(t,e,n,r){return this.throwIfDisposed(),de(this,[t,e,n,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.as5D=function(t,e,n,r,i){return this.throwIfDisposed(),de(this,[t,e,n,r,i])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asin=function(){return this.throwIfDisposed(),roe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.asinh=function(){return this.throwIfDisposed(),ioe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atan=function(){return this.throwIfDisposed(),soe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atan2=function(t){return this.throwIfDisposed(),aoe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.atanh=function(){return this.throwIfDisposed(),ooe(this)};je().prototype.avgPool=function(t,e,n,r){return this.throwIfDisposed(),pR(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),mR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.batchNorm=function(t,e,n,r,i){return this.throwIfDisposed(),jT(this,t,e,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.broadcastTo=function(t){return this.throwIfDisposed(),sx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cast=function(t){return this.throwIfDisposed(),nt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.ceil=function(){return this.throwIfDisposed(),foe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ha(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof rr&&(t=[t]),Qr([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv1d=function(t,e,n,r,i,s){return this.throwIfDisposed(),rW(this,t,e,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv2dTranspose=function(t,e,n,r,i){return this.throwIfDisposed(),sW(this,t,e,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.conv2d=function(t,e,n,r,i,s){return this.throwIfDisposed(),qf(this,t,e,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cos=function(){return this.throwIfDisposed(),gR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cosh=function(){return this.throwIfDisposed(),aW(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),WA(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),oW(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),woe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.depthwiseConv2d=function(t,e,n,r,i,s){return this.throwIfDisposed(),zT(this,t,e,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.dilation2d=function(t,e,n,r,i){return this.throwIfDisposed(),Soe(this,t,e,n,r,i)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.divNoNan=function(t){return this.throwIfDisposed(),_oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.div=function(t){return this.throwIfDisposed(),ct(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.dot=function(t){return this.throwIfDisposed(),Toe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.elu=function(){return this.throwIfDisposed(),BT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.equal=function(t){return this.throwIfDisposed(),Hc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.erf=function(){return this.throwIfDisposed(),lW(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),Noe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.exp=function(){return this.throwIfDisposed(),va(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.expandDims=function(t){return this.throwIfDisposed(),Mi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.expm1=function(){return this.throwIfDisposed(),Aoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.fft=function(){return this.throwIfDisposed(),kR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.flatten=function(){return this.throwIfDisposed(),de(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.floor=function(){return this.throwIfDisposed(),VT(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.floorDiv=function(t){return this.throwIfDisposed(),eW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.gather=function(t,e,n){return this.throwIfDisposed(),WT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.greaterEqual=function(t){return this.throwIfDisposed(),yp(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.greater=function(t){return this.throwIfDisposed(),Co(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.ifft=function(){return this.throwIfDisposed(),eS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.irfft=function(){return this.throwIfDisposed(),RW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isFinite=function(){return this.throwIfDisposed(),Ioe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isInf=function(){return this.throwIfDisposed(),koe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.isNaN=function(){return this.throwIfDisposed(),Moe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.leakyRelu=function(t){return this.throwIfDisposed(),vR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.lessEqual=function(t){return this.throwIfDisposed(),Kg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.less=function(t){return this.throwIfDisposed(),Z1(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.localResponseNormalization=function(t,e,n,r){return this.throwIfDisposed(),Roe(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSigmoid=function(){return this.throwIfDisposed(),Poe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSoftmax=function(t){return this.throwIfDisposed(),dW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),bR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.log=function(){return this.throwIfDisposed(),el(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.log1p=function(){return this.throwIfDisposed(),xR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Gu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalNot=function(){return this.throwIfDisposed(),wR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalOr=function(t){return this.throwIfDisposed(),hW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.logicalXor=function(t){return this.throwIfDisposed(),Ooe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),Mn(this,t,e,n)};je().prototype.maxPool=function(t,e,n,r){return this.throwIfDisposed(),SR(this,t,e,n,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.max=function(t,e){return this.throwIfDisposed(),Bl(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.maximum=function(t){return this.throwIfDisposed(),vh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mean=function(t,e){return this.throwIfDisposed(),ii(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.min=function(t,e){return this.throwIfDisposed(),Y1(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.minimum=function(t){return this.throwIfDisposed(),Xf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),pW(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mod=function(t){return this.throwIfDisposed(),$oe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.mul=function(t){return this.throwIfDisposed(),se(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.neg=function(){return this.throwIfDisposed(),Dr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.norm=function(t,e,n){return this.throwIfDisposed(),UT(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.notEqual=function(t){return this.throwIfDisposed(),Xx(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),mW(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.onesLike=function(){return this.throwIfDisposed(),tl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.pad=function(t,e){return this.throwIfDisposed(),Gc(this,t,e)};je().prototype.pool=function(t,e,n,r,i,s){return this.throwIfDisposed(),Loe(this,t,e,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.pow=function(t){return this.throwIfDisposed(),nh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.prelu=function(t){return this.throwIfDisposed(),ER(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.prod=function(t,e){return this.throwIfDisposed(),Foe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reciprocal=function(){return this.throwIfDisposed(),zoe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.relu=function(){return this.throwIfDisposed(),rd(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.relu6=function(){return this.throwIfDisposed(),TW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reshapeAs=function(t){return this.throwIfDisposed(),de(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reshape=function(t){return this.throwIfDisposed(),de(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),rle(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),ile(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.reverse=function(t){return this.throwIfDisposed(),ql(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.rfft=function(){return this.throwIfDisposed(),MR(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.round=function(){return this.throwIfDisposed(),EW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.rsqrt=function(){return this.throwIfDisposed(),CW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.selu=function(){return this.throwIfDisposed(),NW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.separableConv2d=function(t,e,n,r,i,s){return this.throwIfDisposed(),AW(this,t,e,n,r,i,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sigmoid=function(){return this.throwIfDisposed(),Ko(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sign=function(){return this.throwIfDisposed(),Boe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sin=function(){return this.throwIfDisposed(),IW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sinh=function(){return this.throwIfDisposed(),kW(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.slice=function(t,e){return this.throwIfDisposed(),Kt(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.softmax=function(t){return this.throwIfDisposed(),IR(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.softplus=function(){return this.throwIfDisposed(),Y0(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),TR(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.split=function(t,e){return this.throwIfDisposed(),vo(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sqrt=function(){return this.throwIfDisposed(),Is(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.square=function(){return this.throwIfDisposed(),fr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.squaredDifference=function(t){return this.throwIfDisposed(),PW(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.squeeze=function(t){return this.throwIfDisposed(),Yn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof rr?[this,t]:[this,...t];return wo(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.step=function(t){return this.throwIfDisposed(),Z0(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.stridedSlice=function(t,e,n,r,i,s,a,o){return this.throwIfDisposed(),Uoe(this,t,e,n,r,i,s,a,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sub=function(t){return this.throwIfDisposed(),ut(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.sum=function(t,e){return this.throwIfDisposed(),Et(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tan=function(){return this.throwIfDisposed(),Voe(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tanh=function(){return this.throwIfDisposed(),_g(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.tile=function(t){return this.throwIfDisposed(),Dl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toBool=function(){return this.throwIfDisposed(),nt(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toFloat=function(){return this.throwIfDisposed(),nt(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.toInt=function(){return this.throwIfDisposed(),nt(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.topk=function(t,e){return this.throwIfDisposed(),Goe(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.transpose=function(t){return this.throwIfDisposed(),Ln(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unique=function(t){return this.throwIfDisposed(),qoe(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),$W(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.unstack=function(t){return this.throwIfDisposed(),Xl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.where=function(t,e){return this.throwIfDisposed(),Hs(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */je().prototype.zerosLike=function(){return this.throwIfDisposed(),Fn(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wu extends Error{constructor(e){super(e),Object.setPrototypeOf(this,wu.prototype)}}class Fl extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Fl.prototype)}}class he extends Error{constructor(e){super(e),Object.setPrototypeOf(this,he.prototype)}}class mn extends Error{constructor(e){super(e),Object.setPrototypeOf(this,mn.prototype)}}class e6 extends Error{constructor(e){super(e),Object.setPrototypeOf(this,e6.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Vxe{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const r=this.cache.keys().next().value;this.cache.delete(r)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const r=this.cache.keys().next().value;this.cache.delete(r)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vg(t,e){if(Array.isArray(t)){let n=[];for(let r=0;r<e;r++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Su(t,e){if(!t)throw new e6(e)}function ete(t,e){let n=0;for(const r of t)r===e&&n++;return n}function $a(t){return t.length===1?t[0]:t}function ar(t){return Array.isArray(t)?t:[t]}function Id(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function bm(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let Sl={};function t6(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function lB(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>lB(e));else{const e=Object.keys(t);for(const n of e){const r=t[n];r!=null&&typeof r=="object"&&(!Array.isArray(r)&&r.type==="ndarray"&&typeof r.value=="number"?t[n]=r.value:lB(r))}}}function SE(t,e={},n={},r="object",i=!1){if(typeof t=="string"){const s=t;let a;if(s in n)a=n[s];else if(s in Sl)a=Sl[s];else if(a=e[s],a==null)throw new he(`Unknown ${r}: ${t}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return a}else{const s=t;if(s.className==null||s.config==null)throw new he(`${r}: Improper config format: ${JSON.stringify(s)}.
'className' and 'config' must set.`);const a=s.className;let o,l;if(a in n?[o,l]=n[a]:a in Sl?[o,l]=Sl.className:a in e&&([o,l]=e[a]),o==null)throw new he(`Unknown ${r}: ${a}. This may be due to one of the following reasons:
1. The ${r} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${r} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(Sl))c[f]=Sl[f];for(const f of Object.keys(n))c[f]=n[f];const u=s.config;u.customObjects=c;const d=Object.assign({},Sl);for(const f of Object.keys(n))Sl[f]=n[f];lB(s.config);const h=l(o,s.config,n,i);return Sl=Object.assign({},d),h}else{const c=Object.assign({},Sl);for(const d of Object.keys(n))Sl[d]=n[d];const u=new o(s.config);return Sl=Object.assign({},c),u}}}function AMt(t,e){return t<e?-1:t>e?1:0}function v2(t,e){return-1*AMt(t,e)}function $f(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function IMt(t){if(t==null)throw new he(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function hy(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new he(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function n6(t,e,n=0,r=1/0){return Su(n>=0),Su(r>=n),Array.isArray(t)&&t.length>=n&&t.length<=r&&t.every(i=>typeof i===e)}function cs(t,e){Array.isArray(t)?(q(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,r)=>cs(n,`element ${r+1} of ${e}`))):q(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${Wxe(t)}.`)}function Wxe(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>Wxe(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function kMt(t,e,n){let r=n!=null?n():Oa(),i;return(...a)=>{const o=n!=null?n():Oa();return o-r<e||(r=o,i=t(...a)),i}}function Hxe(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let MMt=0;function Gxe(){return MMt++}const x2={};function bO(t=""){return t in x2||(x2[t]=0),x2[t]+=1,t+x2[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const RMt=["channelsFirst","channelsLast"],PMt=["nearest","bilinear"],OMt=["valid","same","causal"],DMt=["max","avg"],$Mt=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const hv=new Map;function _i(t){hy(RMt,"DataFormat",t)}function LMt(t){hy(PMt,"InterpolationFormat",t)}function al(t){hy(OMt,"PaddingMode",t)}function qxe(t){hy(DMt,"PoolMode",t)}const E1=[],tte="/";function ig(t,e){E1.push(t);try{const n=e();return E1.pop(),n}catch(n){throw E1.pop(),n}}function FMt(){return E1.length===0?"":E1.join(tte)+tte}function Xxe(t){if(!Yxe(t))throw new Error("Not a valid tensor name: '"+t+"'");return FMt()+t}function Kxe(t){if(!Yxe(t))throw new Error("Not a valid tensor name: '"+t+"'");hv.has(t)||hv.set(t,0);const e=hv.get(t);if(hv.set(t,hv.get(t)+1),e>0){const n=`${t}_${e}`;return hv.set(n,1),n}else return t}const jMt=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function Yxe(t){return!!t.match(jMt)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zMt(t){return t===parseInt(t.toString(),10)}function Lf(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let r=1;for(let i=e;i<n;++i)r*=t[i];return r}function P0(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r<e&&(e=r)}return e}function rp(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const r=t[n];r>e&&(e=r)}return e}function Yc(t,e){if(e<t)throw new he(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let r=t;r<e;++r)n.push(r);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let b3;function Vi(){return b3==null&&(b3=vg().epsilon()),b3}function Zc(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Vu(t,e){return nt(t,e)}function _E(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),de(t,n)}function BMt(t,e){return ve(()=>{if(t.shape.length!==2)throw new he(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=_E(t,1);return cB(n,[1,e,1])})}function UMt(t){const e=[Lf(t.shape)];return de(t,e)}function VMt(t){if(t.rank<=1)throw new he(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Lf(t.shape,1)];return de(t,e)}function sg(t,e,n){return ve(()=>{switch(t.rank){case 1:return NR(t,e,n);case 2:return MW(t,[e,0],[n,t.shape[1]]);case 3:return AR(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return J1(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Kt(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Kt(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new he(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function w3(t,e,n){return ve(()=>{switch(t.rank){case 1:return NR(t,e,n);case 2:return MW(t,[0,e],[t.shape[0],n]);case 3:return AR(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return J1(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function b2(t,e,n,r){return ve(()=>{switch(t.rank){case 1:return NR(t,e,n);case 2:switch(r){case 1:return sg(t,e,n);case 2:return w3(t,e,n);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}case 3:switch(r){case 1:return sg(t,e,n);case 2:return AR(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return w3(t,e,n);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}case 4:switch(r){case 1:return sg(t,e,n);case 2:return J1(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return J1(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return w3(t,e,n);default:throw new he(`The axis is not within the rank of the tensor ${r}`)}default:throw new he(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function r6(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Qr(t,e)}function nte(t,e){switch(t.rank){case 1:return poe([t,e]);case 2:return moe([t,e],0);case 3:return goe([t,e],0);case 4:return yoe([t,e],0);default:throw new he(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function cB(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new he(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Dl(t,e)}function wO(t,e=0,n=1,r,i){return _W(t,e,n,r,i)}function Wu(t,e,n,r){if(t.rank<2||e.rank<2)throw new mn(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const i=t.shape.slice(-1)[0],s=e.shape.slice(-2)[0];if(i!==s)throw new mn(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return cj({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?uB(t.rank,r,Zc()):null,activation:n});{const i=t.shape.slice(),s=i.pop();t=de(t,[-1,s]);const a=e.shape.slice(),o=a.pop(),l=a.pop(),c=[...a,o],u=Array.from({length:e.rank},(p,g)=>g===0?e.rank-2:g<=e.rank-2?g-1:g);e=de(Ln(e,u),[l,-1]);const d=[...i,...c];return de(cj({a:t,b:e,transposeA:!1,transposeB:!1,bias:r?uB(t.rank,r,Zc()):null,activation:n}),d)}}function Zxe(t,e,n){return ve(()=>(Array.isArray(e)?e=Oi(e,"int32"):e=nt(e,"int32"),WT(t,e,n)))}function TE(t){return se(t,t)}function uB(t,e,n){const r=e.shape;if(e.rank!==1&&e.rank!==t)throw new he(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return r.length===1?de(e,[1,r[0],1,1,1]):de(e,[1,r[3],r[0],r[1],r[2]]);if(n==="channelsLast")return r.length===1?de(e,[1,1,1,1,r[0]]):de(e,[1].concat(r))}else if(t===4){if(n==="channelsFirst")return r.length===1?de(e,[1,r[0],1,1]):de(e,[1,r[2],r[0],r[1]]);if(n==="channelsLast")return r.length===1?de(e,[1,1,1,r[0]]):de(e,[1].concat(r))}else if(t===3){if(n==="channelsFirst")return r.length===1?de(e,[1,r[0],1]):de(e,[1,r[1],r[0]]);if(n==="channelsLast")return r.length===1?de(e,[1,1,r[0]]):de(e,[1].concat(r))}else if(t<3)return e;throw new he(`Unsupported input rank by biasAdd: ${e.rank}`)}function iu(t,e,n){return ve(()=>(n==null&&(n=Zc()),_i(n),He(t,uB(t.rank,e,n))))}function WMt(t,e=1){if(e!==1)throw new mn(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return BT(t)}function HMt(t){return ve(()=>ct(t,He(Bi(t),1)))}function Qxe(t,e,n,r){return ve(()=>Yoe(t,e,n,r))}function GMt(t){return ve(()=>{const e=He(.5,se(.2,t));return Ha(e,0,1)})}function EE(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const qMt=["fanIn","fanOut","fanAvg"],XMt=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function KMt(t){hy(qMt,"FanMode",t)}function YMt(t){hy(XMt,"Distribution",t)}class tc extends J0{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class Jxe extends tc{apply(e,n){return Pi(e,n)}}Jxe.className="Zeros";Ke(Jxe);class i6 extends tc{apply(e,n){return fo(e,n)}}i6.className="Ones";Ke(i6);class e0e extends tc{constructor(e){if(super(),typeof e!="object")throw new he(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new he(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return ve(()=>se(It(this.value),fo(e,n)))}getConfig(){return{value:this.value}}}e0e.className="Constant";Ke(e0e);class t0e extends tc{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Zg(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}t0e.className="RandomUniform";Ke(t0e);class n0e extends tc{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new mn(`randomNormal does not support dType ${n}.`);return wO(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}n0e.className="RandomNormal";Ke(n0e);class r0e extends tc{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new mn(`truncatedNormal does not support dType ${n}.`);return DW(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}r0e.className="TruncatedNormal";Ke(r0e);class i0e extends tc{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return ve(()=>{if(e.length!==2||e[0]!==e[1])throw new he("Identity matrix initializer can only be used for 2D square matrices.");return se(this.gain,uW(e[0]))})}getConfig(){return{gain:this.gain}}}i0e.className="Identity";Ke(i0e);function ZMt(t,e="channelsLast"){let n,r;if(_i(e),t.length===2)n=t[0],r=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const i=Lf(t,2);n=t[1]*i,r=t[0]*i}else if(e==="channelsLast"){const i=Lf(t,0,t.length-2);n=t[t.length-2]*i,r=t[t.length-1]*i}}else{const i=Lf(t);n=Math.sqrt(i),r=Math.sqrt(i)}return[n,r]}class _o extends tc{constructor(e){if(super(),e.scale<0)throw new he(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,KMt(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,YMt(this.distribution),this.seed=e.seed}apply(e,n){const r=ZMt(e),i=r[0],s=r[1];let a=this.scale;if(this.mode==="fanIn"?a/=Math.max(1,i):this.mode==="fanOut"?a/=Math.max(1,s):a/=Math.max(1,(i+s)/2),this.distribution==="normal"){const o=Math.sqrt(a);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new mn(`${this.getClassName()} does not support dType ${n}.`);return DW(e,0,o,n,this.seed)}else{const o=Math.sqrt(3*a);return Zg(e,-o,o,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}_o.className="VarianceScaling";Ke(_o);class s6 extends _o{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _o.className}}s6.className="GlorotUniform";Ke(s6);class a6 extends _o{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _o.className}}a6.className="GlorotNormal";Ke(a6);class o6 extends _o{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _o.className}}o6.className="HeNormal";Ke(o6);class l6 extends _o{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _o.className}}l6.className="HeUniform";Ke(l6);class c6 extends _o{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return _o.className}}c6.className="LeCunNormal";Ke(c6);class u6 extends _o{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return _o.className}}u6.className="LeCunUniform";Ke(u6);class s0e extends tc{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return ve(()=>{if(e.length<2)throw new mn("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const r=Oe(e.slice(0,-1)),i=e[e.length-1],s=r*i;s>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${s}) elements: Slowness may result.`);const a=[Math.max(i,r),Math.min(i,r)],o=wO(a,0,1,n,this.seed),l=sle.qr(o,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(i,r)*Math.min(i,r)],[Math.min(i,r)+1]);return c=se(c,d.sign()),r<i&&(c=c.transpose()),se(It(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}s0e.className="Orthogonal";Ke(s0e);const rte={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function ite(t,e={}){return SE(t,kl.getMap().classNameMap,e,"initializer")}function Zr(t){return t6(t)}function Vr(t){if(typeof t=="string"){const e=t in rte?rte[t]:t;if(e==="GlorotNormal")return new a6;if(e==="GlorotUniform")return new s6;if(e==="HeNormal")return new o6;if(e==="HeUniform")return new l6;if(e==="LeCunNormal")return new c6;if(e==="LeCunUniform")return new u6;{const n={};return n.className=e,n.config={},ite(n)}}else return t instanceof tc?t:ite(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function dB(t){return Array.isArray(t)&&Array.isArray(t[0])}function wk(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Yt(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new he(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function Xn(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new he(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Sk(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((r,i)=>r*i);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ste="Variable";class QMt{constructor(e,n="float32",r=ste,i=!0,s=null){this.dtype=n??"float32",this.shape=e.shape,this.id=Gxe(),r=r??ste,this.originalName=Xxe(r),this.name=Kxe(this.originalName),this.trainable_=i,this.constraint=s,this.val=Xoe(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),JMt(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function JMt(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function hB(t){return t.map(e=>e.read())}function d6(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Wi{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ed{constructor(e,n,r,i,s,a,o){this.dtype=e,this.shape=n,this.sourceLayer=r,this.inputs=i,this.callArgs=s,this.outputTensorIndex=o,this.id=Gxe(),a!=null&&(this.originalName=Xxe(a),this.name=Kxe(this.originalName)),this.rank=n.length}}let eRt=0,SO=class{constructor(e,n){this.callArgs=n,this.id=eRt++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const r of e.inboundLayers)r!=null&&r.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}},tRt=0;class An extends J0{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=tRt++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const r=this.getClassName();n=Id(r)+"_"+bO(r)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let r;if(e.batchInputShape!=null)r=e.batchInputShape;else if(e.inputShape!=null){let s=null;e.batchSize!=null&&(s=e.batchSize),r=[s].concat(e.inputShape)}this.batchInputShape=r;let i=e.dtype;i==null&&(i=e.inputDType),i==null&&(i="float32"),this.dtype=i}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Fl(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new he(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return $a(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return $a(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new wu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new wu(`Layer ${this.name} is not connected, no input to return.`);return $a(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new wu(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new wu(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return $a(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=ar(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const r=ar(this.inputSpec);if(n.length!==r.length)throw new he(`Layer ${this.name} expects ${r.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let i=0;i<n.length;i++){const s=n[i],a=r[i];if(a==null)continue;const o=s.rank;if(a.ndim!=null&&o!==a.ndim)throw new he(`Input ${i} is incompatible with layer ${this.name}: expected ndim=${a.ndim}, found ndim=${o}`);if(a.maxNDim!=null&&o>a.maxNDim)throw new he(`Input ${i} is incompatible with layer ${this.name}: expected max_ndim=${a.maxNDim}, found ndim=${o}`);if(a.minNDim!=null&&o<a.minNDim)throw new he(`Input ${i} is incompatible with layer ${this.name}: expected min_ndim=${a.minNDim}, found ndim=${o}.`);if(a.dtype!=null&&s.dtype!==a.dtype)throw new he(`Input ${i} is incompatible with layer ${this.name} : expected dtype=${a.dtype}, found dtype=${s.dtype}.`);if(a.axes){const l=s.shape;for(const c in a.axes){const u=Number(c),d=a.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new he(`Input ${i} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(a.shape!=null)for(let l=0;l<a.shape.length;++l){const c=a.shape[l],u=s.shape[l];if(c!=null&&u!=null&&c!==u)throw new he(`Input ${i} is incompatible with layer ${this.name}: expected shape=${a.shape}, found shape=${s.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const r=ar(e),i=iRt(e),s=sRt(e);if(i===s)throw new he("Arguments to apply() must be all SymbolicTensors or all Tensors");return ig(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const a=[];for(const o of ar(e))a.push(o.shape);this.build($a(a)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&s&&(this._refCount=1)}if(this.assertInputCompatibility(e),s){let a=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,a);const o=ar(a),l=[];for(let c of o)r.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(a=$a(l),this.activityRegularizer!=null)throw new mn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return a}else{const a=nRt(e),o=this.computeOutputShape(a);let l;const c=rRt(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?a[0]:a),o!=null&&o.length>0&&Array.isArray(o[0])?l=o.map((u,d)=>new ed(c,u,this,ar(e),n,this.name,d)):l=new ed(c,o,this,ar(e),n,this.name),this.addInboundNode(e,l,null,null,a,o,n),this._refCount++,this.activityRegularizer!=null)throw new mn("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((r,i)=>{r!=null&&e[i]!=null&&e[i]!==r&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new wu(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const r=JSON.stringify(n.outputShapes);e.indexOf(r)===-1&&e.push(r)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new wu(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Fl(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Sk(this.weights)}build(e){this.built=!0}getWeights(e=!1){return hB(e?this.trainableWeights:this.weights)}setWeights(e){ve(()=>{const n=this.weights;if(n.length!==e.length)throw new he(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const r=[],i=hB(n);for(let s=0;s<i.length;++s){const a=i[s],o=n[s],l=e[s];if(!Pn(a.shape,l.shape))throw new he(`Layer weight shape ${a.shape} not compatible with provided weight shape ${l.shape}`);r.push([o,l])}d6(r)})}addWeight(e,n,r,i,s,a,o,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new he(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),r==null&&(r="float32"),this.fastWeightInitDuringBuild&&(i=l!=null?l():Vr("zeros"));const c=i.apply(n,r),u=new QMt(c,r,e,a,o);return c.dispose(),s!=null&&this.addLoss(()=>s.apply(u.read())),a==null&&(a=!0),a?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ar(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(r=>{if(r!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,r){if(!this.supportsMasking)return;const i=this.computeMask(e,r),s=ar(n),a=ar(i);if(s.length!==a.length)throw new Error(`${this.name} outputs ${s.length} tensors but ${s.length} masks for those tensors`);for(let o=0;o<s.length;o++)s[o].kerasMask=a[o]}addInboundNode(e,n,r,i,s,a,o=null){const l=ar(e);n=ar(n),r=ar(r),i=ar(i),s=wk(s),a=wk(a);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new SO({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:r,outputMasks:i,inputShapes:s,outputShapes:a},o);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function nRt(t){t=ar(t);const e=[];for(const n of t)e.push(n.shape);return $a(e)}function rRt(t){return"float32"}function a0e(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const r=e.inboundNodes[n];if(r.inboundLayers.length===0)return r.inputTensors;{const i=[];for(let s=0;s<r.inboundLayers.length;s++){const a=r.inputTensors[s],o=r.inboundLayers[s],l=r.nodeIndices[s],c=a0e(a,o,l);for(const u of c)i.indexOf(u)===-1&&i.push(u)}return i}}}function iRt(t){let e=!0;for(const n of ar(t))if(!(n instanceof ed)){e=!1;break}return e}function sRt(t){let e=!0;for(const n of ar(t))if(n instanceof ed){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class CE extends An{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:bO("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new he("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new he("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new he("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const r=e.dtype||"float32";this.batchInputShape=n,this.dtype=r,this.inputSpec=[{shape:n}];const i=new ed(this.dtype,this.batchInputShape,this,[],{},this.name);i.nodeIndex=0,i.tensorIndex=0,new SO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[i],outputTensors:[i],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new he(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}CE.className="InputLayer";Ke(CE);function aRt(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new he("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new CE({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oRt(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return nt(e,t.dtype)}catch{throw new he(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class bf{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof bf)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,r){if(this.id2Value[e.id]==null)this.id2Value[e.id]=oRt(e,n),this.name2Id[e.name]=e.id,r!=null&&(this.id2Mask[e.id]=r);else throw new he(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ed){if(this.id2Value[e.id]==null)throw new he(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new he(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof ed){if(this.id2Value[e.id]==null)throw new he(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new he(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Bt(this.id2Mask)}}const _k=new Vxe,Tk=new Vxe;function lRt(t){_k!=null&&_k.setMaxEntries(t),Tk!=null&&Tk.setMaxEntries(t)}function Jw(t,e,n,r){const i=n==null?!1:n.training,s=Array.isArray(t),a=s?t:[t],o=a.map(p=>p.name),l=[],c=e.names();for(const p of o)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);const u=o.join(",")+"|"+e.names().sort().join(",");let d=_k.get(u),h;if(d==null){const p=cRt(a,e);d=p.sorted,h=p.recipientCounts,_k.put(u,d),Tk.put(u,h)}h={},i||Object.assign(h,Tk.get(u));const f=new bf(e);for(let p=0;p<d.length;++p){const g=d[p],m=g.sourceLayer;if(m instanceof CE)continue;const y=[],x=[],b=[];let _=!1;for(const A of g.inputs){const k=f.getValue(A),R=f.getMask(A);y.push(k),x.push(R),R!=null&&(_=!0),i||(h[A.name]--,h[A.name]===0&&!e.hasKey(A)&&o.indexOf(A.name)===-1&&!k.isDisposed&&A.sourceLayer.stateful!==!0&&b.push(k))}_&&(n=n||{},n.mask=x[0]);const T=ar(m.apply(y,n));let E=null;m.supportsMasking&&(E=m.computeMask(y,x));const C=dRt(g),I=Array.isArray(C)?C:[C];for(let A=0;A<I.length;++A){f.hasKey(I[A])||f.add(I[A],T[A],Array.isArray(E)?E[0]:E);const k=o.indexOf(I[A].name);k!==-1&&(l[k]=T[A])}i||Bt(b)}return f.disposeMasks(),s?l:l[0]}function cRt(t,e){q(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],r={};if(t.length===1){const i=ate(t[0],e);n=i.sorted,r=i.recipientMap}else{const i=new Set;for(const s of t){const{sorted:a,recipientMap:o}=ate(s,e);for(const l of a)i.has(l.name)||(n.push(l),i.add(l.name));for(const l in o)r[l]==null&&(r[l]=new Set),o[l].forEach(c=>r[l].add(c))}}return{sorted:n,recipientCounts:uRt(r)}}function uRt(t){const e={};for(const n in t)e[n]=t[n].size;return e}function ate(t,e){const n=new Set,r=[],i={};for(const o of e.names())n.add(o);const s=[],a=[];for(s.push(t);s.length>0;){const o=s[s.length-1];if(n.has(o.name)){s.pop();continue}const l=a[a.length-1]===s.length-1;if(o.inputs.length===0||l)s.pop(),r.push(o),n.add(o.name),l&&a.pop();else{a.push(s.length-1);for(const c of o.inputs)i[c.name]==null&&(i[c.name]=new Set),i[c.name].add(o.name),!n.has(c.name)&&s.push(c)}}return{sorted:r,recipientMap:i}}function dRt(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let r=0;r<t.sourceLayer.inboundNodes.length;++r)for(const i of t.sourceLayer.inboundNodes[r].outputTensors)if(i.id===t.id){n=r;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hRt=Me();hRt.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,lRt);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function h6(t,e){return ve(()=>Is(Et(se(t,t),e,!0)))}class NE extends J0{getConfig(){return{}}}class o0e extends NE{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ve(()=>{const n=h6(e,this.axis),r=Ha(n,0,this.maxValue);return se(e,ct(r,He(Vi(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}o0e.className="MaxNorm";Ke(o0e);class l0e extends NE{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ve(()=>ct(e,He(Vi(),h6(e,this.axis))))}getConfig(){return{axis:this.axis}}}l0e.className="UnitNorm";Ke(l0e);class c0e extends NE{apply(e){return rd(e)}}c0e.className="NonNeg";Ke(c0e);class u0e extends NE{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return ve(()=>{const n=h6(e,this.axis),r=He(se(this.rate,Ha(n,this.minValue,this.maxValue)),se(1-this.rate,n));return se(e,ct(r,He(Vi(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}u0e.className="MinMaxNorm";Ke(u0e);const ote={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function qi(t){return t6(t)}function lte(t,e={}){return SE(t,kl.getMap().classNameMap,e,"constraint")}function Xi(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in ote?ote[t]:t,config:{}};return lte(n)}else return t instanceof NE?t:lte(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function rm(t){if(t==null)return;const e=[],n=[],r=[];for(const i in t){const s=t[i];if(typeof s!="number"){const a=s;e.push(a.data()),n.push(i),r.push(a)}}if(e.length>0){const i=await Promise.all(e);for(let s=0;s<i.length;++s)t[n[s]]=i[s][0];Bt(r)}}function d0e(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var cte;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(cte||(cte={}));const fRt=125;class S_{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class pRt{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const r of this.callbacks)await r.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class mRt extends S_{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const r=n.size==null?0:n.size;this.seen+=r;for(const i in n){const s=n[i];if(typeof s=="number")this.totals.hasOwnProperty(i)||(this.totals[i]=0),this.totals[i]=this.totals[i]+s*r;else{let a;i in this.totals?a=this.totals[i]:this.totals[i]=0;const o=ve(()=>He(this.totals[i],se(s,r)));this.totals[i]=o,a!=null&&a.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const r of this.params.metrics)this.totals[r]!=null&&(typeof this.totals[r]=="number"?n[r]=this.totals[r]/this.seen:ve(()=>{const i=se(ct(1,this.seen),this.totals[r]);n[r]=i,this.totals[r].dispose(),as(n[r])}))}}class gRt extends S_{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const r in n)this.history[r]==null&&(this.history[r]=[]),this.history[r].push(n[r])}async syncData(){const e=[],n=[],r=[];for(const s in this.history){const a=this.history[s];for(let o=0;o<a.length;++o)if(typeof a[o]!="number"){const l=a[o];e.push(l.data()),n.push(s),r.push(o)}}const i=await Promise.all(e);for(let s=0;s<i.length;++s)this.history[n[s]][r[s]].dispose(),this.history[n[s]][r[s]]=i[s][0]}}class yRt extends S_{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||Nle,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=fRt),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");VF(this.yieldEvery)&&(this.maybeWait=kMt(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,r){const i=[];this.yield!=null&&(await rm(r),i.push(this.yield(e,n,r))),i.push(this.nextFrameFunc()),await Promise.all(i)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await rm(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const r=[];this.epochEnd!=null&&(await rm(n),r.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&r.push(this.nextFrameFunc()),await Promise.all(r)}async onBatchBegin(e,n){this.batchBegin!=null&&(await rm(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const r=[];this.batchEnd!=null&&(await rm(n),r.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?r.push(this.nextFrameFunc()):VF(this.yieldEvery)&&r.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(r)}async onTrainBegin(e){this.trainBegin!=null&&(await rm(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await rm(e),await this.trainEnd(e))}}function h0e(t,e){return t==null&&(t={}),t instanceof S_?[t]:Array.isArray(t)&&t[0]instanceof S_?t:ar(t).map(r=>new yRt(r,e))}class _l{constructor(){}static registerCallbackConstructor(e,n){q(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),_l.checkForDuplicate(n),_l.constructors[e]==null&&(_l.constructors[e]=[]),_l.constructors[e].push(n)}static checkForDuplicate(e){for(const n in _l.constructors)_l.constructors[+n].forEach(i=>{if(i===e)throw new he("Duplicate callback constructor.")})}static clear(){_l.constructors={}}static createCallbacks(e){const n=[];for(const r in _l.constructors){const i=+r;e>=i&&n.push(..._l.constructors[i])}return n.map(r=>new r)}}_l.constructors={};function f0e(t,e,n,r,i,s,a,o,l){const c=new gRt,u=[new mRt,..._l.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new pRt(u);return d.setParams({epochs:n,initialEpoch:r,samples:i,steps:s,batchSize:a,verbose:e,doValidation:o,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kd(t,e={},n=!1){return SE(t,kl.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ek(t,e){return ve(()=>{t.dtype!=="float32"&&(t=nt(t,"float32"));const n=Et(TE(t),e,!0),r=K0(n.shape,Vi()),i=Is(vh(n,r));return ct(t,i)})}function _O(t,e){return ve(()=>ii(TE(ut(e,t)),-1))}function f6(t,e){return ve(()=>ii(Bi(ut(e,t)),-1))}function p6(t,e){return ve(()=>{const n=ut(t,e),r=Ha(Bi(t),Vi(),Number.MAX_VALUE),i=Bi(ct(n,r));return se(100,ii(i,-1))})}function vRt(t,e){return ve(()=>{const n=Ha(e,Vi(),Number.MAX_VALUE),r=el(He(1,n)),i=Ha(t,Vi(),Number.MAX_VALUE),s=el(He(1,i));return ii(TE(ut(r,s)),-1)})}function xRt(t,e){return ve(()=>{const n=vh(0,ut(1,se(t,e)));return ii(TE(n),-1)})}function bRt(t,e){return ve(()=>{const n=vh(0,ut(1,se(t,e)));return ii(n,-1)})}function wRt(t,e){return ve(()=>{const n=Et(se(t,e),-1),r=Bl(se(ut(1,t),e),-1);return vh(0,He(1,ut(r,n)))})}function SRt(t,e){return ve(()=>{const n=Math.log(2),r=ut(e,t),i=ut(He(r,Y0(se(-2,r))),n);return ii(i,-1)})}function __(t,e,n=!1){return ve(()=>{if(n)e=IR(e);else{const r=Et(e,e.shape.length-1,!0);e=ct(e,r)}return e=Ha(e,Vi(),1-Vi()),Dr(Et(se(nt(t,"float32"),el(e)),e.shape.length-1))})}function Ck(t,e,n=!1){return ve(()=>{const r=nt(VT(UMt(t)),"int32");e=Ha(e,Vi(),1-Vi());const i=e.shape,s=de(mW(r,i[i.length-1]),i);return __(s,e,n)})}function _Rt(t,e){if(!Pn(t.shape,e.shape))throw new he(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return ve(()=>{const n=rd(e),r=Dr(Bi(e));return He(ut(n,se(e,t)),xR(va(r)))})}function TO(t,e){return ve(()=>{let n;return n=Ha(e,Vi(),1-Vi()),n=el(ct(n,ut(1,n))),ii(_Rt(t,n),-1)})}function TRt(t,e){return ve(()=>{const n=Ha(t,Vi(),1),r=Ha(e,Vi(),1);return Et(se(t,el(ct(n,r))),-1)})}function ERt(t,e){return ve(()=>{const n=el(He(Vi(),e));return ii(ut(e,se(t,n)),-1)})}function p0e(t,e){return ve(()=>{const n=Ek(t,-1),r=Ek(e,-1),i=se(n,r);return Dr(Et(i,-1))})}const Nk={meanSquaredError:_O,meanAbsoluteError:f6,meanAbsolutePercentageError:p6,meanSquaredLogarithmicError:vRt,squaredHinge:xRt,hinge:bRt,categoricalHinge:wRt,logcosh:SRt,categoricalCrossentropy:__,sparseCategoricalCrossentropy:Ck,binaryCrossentropy:TO,kullbackLeiblerDivergence:TRt,poisson:ERt,cosineProximity:p0e};function S3(t){if(typeof t=="string"){if(t in Nk)return Nk[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new he(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m0e(t,e){return ve(()=>{const n=se(.5,tl(e)),r=Vu(Co(e,n),t.dtype);return ii(Hc(t,r),-1)})}function g0e(t,e){return ve(()=>Vu(Hc(wg(t,-1),wg(e,-1)),"float32"))}function CRt(t,e){return ve(()=>nt(Et(Gu(Hc(t,1),Hc(e,1))),"float32"))}function NRt(t,e){return ve(()=>nt(Et(Gu(Hc(t,0),Hc(e,1))),"float32"))}function ARt(t,e){return ve(()=>{const n=CRt(t,e),r=NRt(t,e),i=He(n,r);return nt(Hs(Co(i,0),ct(n,i),0),"float32")})}function IRt(t,e){return TO(t,e)}function kRt(t,e){return t.rank===e.rank&&(t=Yn(t,[t.rank-1])),e=wg(e,-1),e.dtype!==t.dtype&&(e=nt(e,t.dtype)),nt(Hc(t,e),"float32")}const MRt=_O,RRt=_O,PRt=f6,ORt=f6,DRt=p6,$Rt=p6,y0e=__,LRt=p0e,v0e=Ck,Ak={binaryAccuracy:m0e,categoricalAccuracy:g0e,precision:ARt,categoricalCrossentropy:y0e,sparseCategoricalCrossentropy:v0e,mse:MRt,MSE:RRt,mae:PRt,MAE:ORt,mape:DRt,MAPE:$Rt,cosine:LRt};function FRt(t){if(typeof t=="string"&&t in Ak)return Ak[t];if(typeof t!="string"&&t!=null)return t;throw new he(`Unknown metric ${t}`)}function w2(t){if(Su(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Nk))if(Nk[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Ak))if(Ak[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jRt(t){const e={Adagrad:()=>Dy.adagrad(.01),Adadelta:()=>Dy.adadelta(1,.95,Vi()),Adam:()=>Dy.adam(.001,.9,.999,Vi()),Adamax:()=>Dy.adamax(.002,.9,.999,Vi(),0),RMSProp:()=>Dy.rmsprop(.001,.9,0,Vi()),SGD:()=>Dy.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new he(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ute=1*1024*1024;function dte(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!fB(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const r=JSON.stringify(t);r.length>ute&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${r.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${ute}.`)}}function fB(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!fB(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!fB(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zRt(t,e,n,r=console.log){const i=URt(t),s=["Layer (type)","Input Shape","Output shape","Param #"];i?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let a;if(!i){s.push("Receives inputs"),a=[];for(const u in t.nodesByDepth)a.push(...t.nodesByDepth[u])}r("_".repeat(e)),Ik(s,n,r),r("=".repeat(e));const o=t.layers;for(let u=0;u<o.length;++u)i?VRt(o[u],n,r):WRt(o[u],n,a,r),r((u===o.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=BRt(t),c=Sk(t.nonTrainableWeights);r(`Total params: ${l+c}`),r(`Trainable params: ${l}`),r(`Non-trainable params: ${c}`),r("_".repeat(e))}function BRt(t){let e;return t.collectedTrainableWeights!=null?e=Sk(t.collectedTrainableWeights):e=Sk(t.trainableWeights),e}function URt(t){let e=!0;const n=[],r=[];for(const i in t.nodesByDepth)n.push(t.nodesByDepth[i]);for(const i of n){if(i.length>1||i.length===1&&i[0].inboundLayers.length>1){e=!1;break}r.push(...i)}if(e)for(const i of t.layers){let s=!1;for(const a of i.inboundNodes)if(r.indexOf(a)!==-1)if(s){e=!1;break}else s=!0;if(!e)break}return e}function Ik(t,e,n=console.log){let r="";for(let i=0;i<t.length;++i)i>0&&(r=r.slice(0,r.length-1)+" "),r+=t[i],r=r.slice(0,e[i]),r+=" ".repeat(e[i]-r.length);n(r)}function VRt(t,e,n){let r,i;try{i=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{i="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const s=t.name,a=t.getClassName(),o=[`${s} (${a})`,i,r,t.countParams().toString()];Ik(o,e,n)}function WRt(t,e,n,r){let i,s;try{s=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{s="multiple"}try{i=JSON.stringify(t.outputShape)}catch{i="multiple"}const a=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],g=d.tensorIndices[h];a.push(`${f}[${p}][${g}]`)}const o=t.name,l=t.getClassName(),c=a.length===0?"":a[0],u=[`${o} (${l})`,s,i,t.countParams().toString(),c];Ik(u,e,r);for(let d=1;d<a.length;++d)Ik(["","","","",a[d]],e,r)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function x0e(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function pB(t,e){if(t===null)return null;if(typeof t=="string")return bm(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const s=t[i];x0e(e,i,s)?n.push(s):n.push(pB(s,e))}return n}else{const n={};for(const r of Object.keys(t)){const i=t[r];if(r==="name"&&typeof i=="string")n[r]=i;else{const s=bm(r);n[s]=pB(i,s)}}return n}}function mB(t,e){if(t==null)return null;if(typeof t=="string")return Id(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],r=t.length;for(let i=0;i<r;++i){const s=t[i];x0e(e,i,s)?n.push(s):n.push(mB(s,e))}return n}else{const n={};for(const r of Object.keys(t)){const i=t[r],s=Id(r);(r==="name"||r==="className")&&typeof i=="string"?n[s]=i:n[s]=mB(i,r)}return n}}/** @license See the LICENSE file. */const b0e="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const HRt=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class fc extends An{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const x=this.getClassName().toLowerCase();this.name=bO(x)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],$f(this.inputs).length!==this.inputs.length)throw new he(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(x=>x.name)}`);$f(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(x=>x.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const x of this.outputs){const b=x.sourceLayer,_=x.nodeIndex,T=x.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(_),this.outputLayersTensorIndices.push(T)}for(const x of this.inputs){const b=x.sourceLayer,_=x.nodeIndex,T=x.tensorIndex;Su(_===0,"input layer has >1 nodes"),Su(T===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(_),this.inputLayersTensorIndices.push(T)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let x=0;x<this.inputLayers.length;x++){const b=this.inputLayers[x];if(!(b instanceof CE))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${x} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const x of this.outputLayers)this.outputNames.push(x.name);this.internalInputShapes=this.inputs.map(x=>x.shape),this.internalOutputShapes=this.outputs.map(x=>x.shape);const n={},r={},i={},s={},a={},o=[],l=(x,b,_,T,E,C)=>{(T==null||E==null||C==null)&&(T=x.sourceLayer,E=x.nodeIndex,C=x.tensorIndex);const I=T.inboundNodes[E];if(_.indexOf(I)!==-1)throw new Fl(`The tensor ${x.name} at layer "${T.name}" is part of a cycle.`);if(b.indexOf(I)!==-1)return;this.containerNodes.add(fc.nodeKey(T,E)),T.id in a||(a[T.id]=Object.keys(a).length),_.indexOf(I)===-1&&_.push(I);const A=I.inboundLayers.length;for(let k=0;k<A;k++){const R=I.inputTensors[k],$=I.inboundLayers[k],z=I.nodeIndices[k],O=I.tensorIndices[k];l(R,b,_,$,z,O)}for(b.push(I);_.indexOf(I)>=0;)_.splice(_.indexOf(I),1);o.push(I)},c=[],u=[];for(const x of this.outputs)l(x,c,u);const d=o.slice().reverse();for(const x of d){r[x.id]=x,x.id in n||(n[x.id]=0);let b=n[x.id];const _=i[x.outboundLayer.id]==null?0:i[x.outboundLayer.id];b=Math.max(b,_),i[x.outboundLayer.id]=b,s[x.outboundLayer.id]=x.outboundLayer,n[x.id]=b;for(let T=0;T<x.inboundLayers.length;T++){const E=x.inboundLayers[T],C=x.nodeIndices[T],I=E.inboundNodes[C],A=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(b+1,A),r[I.id]=I}}const h={};for(const x in n){const b=n[x];b in h||(h[b]=[]),h[b].push(r[x])}const f={};for(const x in i){const b=i[x];b in f||(f[b]=[]),f[b].push(s[x])}let p=Object.keys(f).map(x=>parseInt(x,10)).sort(v2);this.layers=[];for(const x of p){const b=f[x];b.sort((_,T)=>{const E=a[_.id],C=a[T.id];return E<C?-1:E>C?1:0});for(const _ of b)_ instanceof fc&&this.internalContainerRefs.push(_),this.layers.push(_)}this.layersByDepth=f,p=Object.keys(h).map(x=>parseInt(x,10)).sort(v2);const g=this.inputs.slice(),m=[];for(const x of p)for(const b of h[x]){const _=b.outboundLayer;if(_!=null){for(const T of b.inputTensors)if(g.indexOf(T)===-1)throw new Fl(`Graph disconnected: cannot obtain value for tensor ${T} at layer "${_.name}". The following previous layers were accessed without issue: ${m}`);for(const T of b.outputTensors)g.push(T);m.push(_.name)}}this.nodesByDepth=h;const y=this.layers.map(x=>x.name);for(const x of y){const b=y.filter(_=>_===x).length;if(b!==1)throw new Fl(`The name "${x}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(y))}this.outboundNodes=[],this.inboundNodes=[],new SO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(x=>null),outputMasks:this.outputs.map(x=>null),inputShapes:this.inputs.map(x=>x.shape),outputShapes:this.outputs.map(x=>x.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(r=>r.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new he("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.layers)n.push(...r.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const r={};let i=0;const s=HRt(e);s&&this.parseWeights(e);for(const o of this.layers)for(const[l,c]of o.weights.entries()){const u=s?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(r[u]!=null)throw new he(`Duplicate weight name: ${u}`);r[u]=c,i++}const a=[];for(const o in e){let l=o;if(r[o]==null){const c=o.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(r[l]!=null)a.push([r[l],e[o]]);else if(n)throw new he(`Provided weight data has no target variable: ${o}`);delete r[l]}if(n){const o=[];for(const l in r)o.push(l);if(o.length>0)throw new he(`${o.length} of ${i} weights are not set: ${o}`)}d6(a)}parseWeights(e){for(const n in Object.keys(e)){const r=n.split("/"),i=["vars","layer_checkpoint_dependencies"],s=r.map(a=>a.startsWith("_")?a.slice(1):a).filter(a=>!i.includes(a)).join("/");s!==n&&(e[s]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${b0e}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const r=mB(this.updatedConfig());return n?JSON.stringify(r):r}call(e,n){return ve(()=>{e=ar(e);const r=new bf;for(let i=0;i<this.inputs.length;++i)r.add(this.inputs[i],e[i]);return Jw(this.outputs,r,n)})}computeMask(e,n){return ve(()=>{e=ar(e);let r;return n==null?r=Vg(null,e.length):r=ar(n),this.runInternalGraph(e,r)[1]})}computeOutputShape(e){const n=wk(e);if(n.length!==this.inputLayers.length)throw new he(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const r={};for(let o=0;o<n.length;o++){const l=this.inputLayers[o],c=n[o],u=l.name+"_0_0";r[u]=c}const i=Object.keys(this.nodesByDepth).map(o=>parseInt(o,10)).sort(v2);if(i.length>1)for(const o of i){const l=this.nodesByDepth[o];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(g=>g.id).indexOf(u.id)!==-1)continue;const d=[];for(let g=0;g<c.inboundLayers.length;g++){const m=c.inboundLayers[g],y=c.nodeIndices[g],x=c.tensorIndices[g],b=`${m.name}_${y}_${x}`,_=r[b];d.push(_)}const h=u.computeOutputShape($a(d)),f=wk(h),p=u.inboundNodes.indexOf(c);for(let g=0;g<f.length;g++){const m=`${u.name}_${p}_${g}`;r[m]=f[g]}}}const s=[],a=[];for(let o=0;o<this.outputLayers.length;o++){const l=this.outputLayers[o],c=this.outputLayersNodeIndices[o],u=this.outputLayersTensorIndices[o],d=`${l.name}_${c}_${u}`;a.push(d)}for(let o=0;o<a.length;o++){const l=a[o];Su(l in r),s.push(r[l])}return $a(s)}runInternalGraph(e,n){n==null&&(n=Vg(null,e.length));const r={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];r[c.id]=[u,d]}const i=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(v2);for(const l of i){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const g of h)g.id in r&&p.push(r[g.id]);if(p.length===h.length){let g={},m,y,x,b;if(u.callArgs!=null&&(g=u.callArgs),p.length===1){const[_,T]=p[0];g.mask==null&&(g.mask=T),x=ar(d.call(_,g)),b=ar(d.computeMask(_,T)),m=[_],y=[T]}else m=p.map(_=>_[0]),y=p.map(_=>_[1]),g.mask==null&&(g.mask=y),x=ar(d.call(m,g)),b=ar(d.computeMask(m,y));if(d.activityRegularizer)throw new mn("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let _=0;_<f.length;++_){const T=f[_],E=x[_],C=b[_];r[T.id]=[E,C]}}}}const s=[],a=[],o=[];for(const l of this.outputs){Su(l.id in r,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=r[l.id];o.push(c.shape),s.push(c),a.push(u)}return[s,a,o]}buildNodeConversionMap(e){const n={};let r;for(const i of this.layers){r=i instanceof fc?1:0;for(let s=0;s<i.inboundNodes.length;s++){const a=fc.nodeKey(i,s);this.containerNodes.has(a)&&(n[a]=r,r+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new he("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const r of this.layers)if(r.name===e)return r;throw new he(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new he(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return ve(()=>{const e=[];for(const n of this.layers)for(let r=0;r<n.inboundNodes.length;++r){const i=fc.nodeKey(n,r);this.containerNodes.has(i)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),r=[];for(const a of this.layers){const o=a.getClassName(),l=a.getConfig(),c=[];for(let d=0;d<a.inboundNodes.length;d++){const h=a.inboundNodes[d],f=fc.nodeKey(a,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${a.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const g=[];for(let m=0;m<h.inboundLayers.length;m++){const y=h.inboundLayers[m],x=h.nodeIndices[m],b=h.tensorIndices[m],_=fc.nodeKey(y,x);let T=n[_];T==null&&(T=0),g.push([y.name,T,b,p])}c.push(g)}}}const u={};u.name=a.name,u.className=o,u.config=l,u.inboundNodes=c,r.push(u)}e.layers=r;const i=[];for(let a=0;a<this.inputLayers.length;a++){const o=this.inputLayers[a],l=this.inputLayersNodeIndices[a],c=fc.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[a];i.push([o.name,u,d])}e.inputLayers=i;const s=[];for(let a=0;a<this.outputLayers.length;a++){const o=this.outputLayers[a],l=this.outputLayersNodeIndices[a],c=fc.nodeKey(o,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[a];s.push([o.name,u,d])}return e.outputLayers=s,e}static fromConfig(e,n,r={},i=!1){const s={},a={};function o(m,y){m.name in a?a[m.name].push(y):a[m.name]=[y]}function l(m,y){const x=[];let b;for(const _ of y){const T=_[0],E=_[1],C=_[2];if(b=_[3]==null?{}:_[3],!(T in s)){o(m,y);return}const I=s[T];if(I.inboundNodes.length<=E){o(m,y);return}const A=I.inboundNodes[E];x.push(A.outputTensors[C])}x.length>0&&m.apply($a(x),b)}function c(m){const y=m.name,x=Kd(m,n.customObjects!=null?n.customObjects:{});x.setFastWeightInitDuringBuild(i),s[y]=x,m.inboundNodes.forEach(_=>{if(!(_ instanceof Array))throw new he(`Corrupted configuration, expected array for nodeData: ${_}`);o(x,_)})}const u=n.name,d=n.layers;for(const m of d)c(m);for(;!IMt(a);)for(const m of d){const y=s[m.name];if(y.name in a){const x=a[y.name];delete a[y.name];for(const b of x)l(y,b)}}const h=[],f=[],p=n.inputLayers;for(const m of p){const y=m[0],x=m[1],b=m[2];Su(y in s);const T=s[y].inboundNodes[x].outputTensors;h.push(T[b])}const g=n.outputLayers;for(const m of g){const y=m[0],x=m[1],b=m[2];Su(y in s);const T=s[y].inboundNodes[x].outputTensors;f.push(T[b])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new he("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){ve(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GRt(t,e,n){const r=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(i=>null);if(r===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==r)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${r} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const i=[];return e.forEach(s=>{s in t?i.push(t[s]):i.push(null)}),i}else throw new Error(`The model has multiple (${r}) outputs, so ${n} must be either an array with ${r} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function w0e(t,e){return GRt(t,e,"classWeight")}async function S0e(t,e,n,r){if(n!=null){const i=ve(()=>{if(t.shape.length===1)return Wd(t);if(t.shape.length===2){if(t.shape[1]>1)return wg(t,1);if(t.shape[1]===1)return de(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),s=Array.from(await i.data());Bt(i);const a=[];return s.forEach(o=>{if(n[o]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${o} exists in the data but not in classWeight`);a.push(n[o])}),Oi(a,"float32")}else return null}function qRt(t,e){return se(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const XRt=32;function _0e(t,e){let n,r;const i=e;n=i.xs,r=i.ys,q(n!=null&&r!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const s=hte("input",t.inputNames,n),a=hte("output",t.outputNames,r),o=s[0].shape[0];q(s.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${s.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),q(a.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${a.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<s.length;l++)q(s[l].shape[0]===o,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${s[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);for(let l=0;l<a.length;l++)q(a[l].shape[0]===o,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${a[l].shape[0]}; expected  ${o} based on input ${t.inputNames[0]}.`);return{xs:s,ys:a}}function hte(t,e,n){if(n instanceof rr)return[n];if(Array.isArray(n))return q(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const r=[];for(const i of e){if(n[i]==null)throw new he(`The feature data generated by the dataset lacks the required ${t} key '${i}'.`);r.push(n[i])}return r}}function KRt(t){if(t.length===3)throw new mn("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function YRt(t,e,n){const r=n.batchesPerEpoch!=null;if(q(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),q(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),q(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),q(!r||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),q(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const i=n.validationData!=null;let s,a;if(i)if(fte(n.validationData))q(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const m=KRt(n.validationData);s=m.xs,a=m.ys}const o=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;i?c=l.slice().concat(l.map(m=>"val_"+m)):c=l.slice();const u=h0e(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=f0e(u,d,n.epochs,null,null,ZRt(e,n),null,i,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,g=await e.iterator();for(;p<n.epochs;){const m={};await h.onEpochBegin(p);let y=0,x=0;for(r||(g=await e.iterator());!r||y<n.batchesPerEpoch;){const b=await g.next();if(r&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${y} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:_,ys:T}=_0e(t,b.value),E={};E.batch=x,E.size=_[0].shape[0],await h.onBatchBegin(x,E);const C=[];if(n.classWeight!=null){const k=w0e(n.classWeight,t.outputNames);for(let R=0;R<k.length;++R)C.push(await S0e(T[R],null,k[R]))}const I=_.concat(T).concat(C),A=o(I);Bt(I);for(let k=0;k<l.length;++k){const R=l[k],$=A[k];E[R]=$,as($)}await h.onBatchEnd(x,E),d0e(E),x++,y++}if(r?y>=n.batchesPerEpoch:b.done){if(i){let _;fte(n.validationData)?_=ar(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):_=ar(t.evaluate(s,a,{batchSize:n.validationBatchSize==null?XRt:n.validationBatchSize,verbose:0}));for(let T=0;T<t.metricsNames.length;++T)m[`val_${t.metricsNames[T]}`]=_[T]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,m),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function ZRt(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function fte(t){return typeof t.iterator=="function"}function QRt(t){return typeof t.next=="function"}async function JRt(t,e,n){n=n||{};const r=n.batches!=null,i=t.testFunction;let s=[];if(n.verbose>0)throw new mn("Verbose mode is not implemented yet.");q(!r||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const a=QRt(e)?e:await e.iterator();let o=0,l=0;for(;!r||l<n.batches;){const c=await a.next();if(s=ve(()=>{if(c.value){const{xs:u,ys:d}=_0e(t,c.value),h=u.concat(d),f=ve(()=>i(h));if(Bt(h),l===0)for(let g=0;g<f.length;++g)s.push(It(0));const p=h[0].shape[0];for(let g=0;g<f.length;++g){const m=f[g],y=s[g];s[g]=ve(()=>He(s[g],se(p,m))),l>0&&Bt(y)}Bt(f),o+=p,++l}return s}),c.done){r&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<s.length;++c){const u=s[c];s[c]=ct(s[c],o),Bt(u)}return $a(s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _3(t){q(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function Dw(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(r=>sg(r,e,n-e)):sg(t,e,n-e)}function gB(t,e){return ve(()=>t==null?null:Array.isArray(t)?t.map(n=>gB(n,e)):Zxe(t,e.dtype==="int32"?e:nt(e,"int32")))}function T3(t,e){const n=[];let r=0,i=null;for(;r<t;)i=r+e,i>=t&&(i=t),n.push([r,i]),r=i;return n}function T0e(t){const e=[];t instanceof rr&&(t=[t]);for(let n=0;n<t.length;++n){const r=t[n];if(r.rank===1)e.push(_E(r,1));else{if(r.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(r)}}return e}function dc(t,e){if(t==null)return;const n=[];if(e instanceof rr)n.push(e.id);else if(Array.isArray(e))e.forEach(i=>n.push(i.id));else if(e!=null)for(const i in e){const s=e[i];n.push(s.id)}const r=[];if(t instanceof rr)n.indexOf(t.id)===-1&&r.push(t);else if(Array.isArray(t))t.forEach(i=>{n.indexOf(i.id)===-1&&r.push(i)});else if(t!=null)for(const i in t){const s=t[i];n.indexOf(s.id)===-1&&r.push(s)}r.forEach(i=>{i.isDisposed||i.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ePt(t){return t instanceof rr}function yB(t){return Array.isArray(t)}function pte(t){return!ePt(t)&&!yB(t)}function mte(t,e,n,r=!0,i=""){if(e==null||e.length===0){if(t!=null){let a=!1;if(yB(t)&&t.length>0)a=!0;else if(pte(t)){for(const o in t)if(t.hasOwnProperty(o)){a=!0;break}}else a=!0;if(a)throw new he(`Error when checking model ${i} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(a=>null);let s;if(pte(t)){t=t,s=[];for(const a of e){if(t[a]==null)throw new he(`No data provided for "${a}". Need data for each key in: ${e}`);s.push(t[a])}}else if(yB(t)){if(t=t,t.length!==e.length)throw new he(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);s=t}else{if(t=t,e.length>1)throw new he(`The model ${i} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);s=[t]}if(s=T0e(s),n!=null)for(let a=0;a<e.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new he(`Error when checking ${i}: expected ${e[a]} to have ${n[a].length} dimension(s). but got array with shape ${o.shape}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const c=o.shape[l],u=n[a][l];if(u!=null&&u>=0&&c!==u)throw new he(`${i} expected a batch of elements where each example has shape [${n[a].slice(1,n[a].length)}] (i.e.,tensor shape [*,${n[a].slice(1,n[a].length)}]) but the ${i} received an input with ${o.shape[0]} examples, each with shape [${o.shape.slice(1,o.shape.length)}] (tensor shape [${o.shape}])`)}}return s}function tPt(t,e,n){const r=$f(t.map(s=>s.shape[0]));r.sort();const i=$f(e.map(s=>s.shape[0]));if(i.sort(),r.length>1)throw new he(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(s=>s.shape))}`);if(i.length>1)throw new he(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(s=>s.shape))}`);if(r.length>0&&i.length>0&&!Pn(r,i))throw new he(`Input Tensors should have the same number of samples as target Tensors. Found ${r[0]} input sample(s) and ${i[0]} target sample(s).`)}function nPt(t,e,n){const r=[_O,TO,__];for(let i=0;i<t.length;++i){const s=t[i],a=e[i],o=n[i];if(a!=null){if(a===__&&s.shape[s.shape.length-1]===1)throw new he(`You are passing a target array of shape ${s.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(r.indexOf(a)!==-1){const l=s.shape.slice(1),c=o.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new he(`A target Tensor with shape ${s.shape} was passed for an output of shape ${o}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function gte(t,e,n,r=!0,i=""){let s;if(Array.isArray(t)){if(t.length!==e.length)throw new he(`Error when checking model ${i}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);s=t}else{if(e.length>1)throw new he(`The model expects ${e.length} ${i} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);s=[t]}if(n!=null)for(let a=0;a<e.length;++a){if(n[a]==null)continue;const o=s[a];if(o.shape.length!==n[a].length)throw new he(`Error when checking ${i}: expected ${e[a]} to have ${n[a].length} dimension(s), but got array with shape ${JSON.stringify(o.shape)}`);for(let l=0;l<n[a].length;++l){if(l===0&&!r)continue;const c=o.shape[l],u=n[a][l];if(u!=null&&u!==c)throw new he(`Error when checking ${i}: expected ${e[a]} to have shape ${JSON.stringify(n[a])} but got array with shape ${JSON.stringify(o.shape)}.`)}}}function rPt(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(r=>n);{const r=[];for(const i of e){let s=n.hasOwnProperty(i)?n[i]:[];Array.isArray(s)||(s=[s]),r.push(s)}return r}}const iPt="layers-model";class vx extends fc{constructor(e){super(e),this.isTraining=!1}summary(e,n,r=console.log){if(!this.built)throw new he("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");zRt(this,e,n,r)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=jRt(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof vp))throw new he("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const a in e.loss)if(this.outputNames.indexOf(a)===-1)throw new he(`Unknown entry in loss dictionary: "${a}". Only expected the following keys: ${this.outputNames}`);for(const a of this.outputNames)e.loss[a]==null&&console.warn(`Output "${a}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${a} during training`),n.push(S3(e.loss[a]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new he(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(o=>S3(o))}else{const a=S3(e.loss);this.outputs.forEach(o=>{n.push(a)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let a=0;a<this.outputs.length;++a){const o=this.internalOutputShapes[a],l=this.outputNames[a];this.feedOutputNames.push(l),this.feedOutputShapes.push(o),this.feedLossFns.push(this.lossFunctions[a])}const r=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],ig("loss",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=this.lossFunctions[a];this.outputs.length>1&&(this.metricsTensors.push([o,a]),this.metricsNames.push(this.outputNames[a]+"_loss"))}});const i=rPt(e.metrics,this.outputNames),s=(a,o,l)=>{this.outputNames.length>1&&(o=this.outputNames[a]+"_"+o),this.metricsNames.push(o),this.metricsTensors.push([l,a])};ig("metric",()=>{for(let a=0;a<this.outputs.length;++a){if(r.indexOf(a)!==-1)continue;const o=i[a];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const m=this.internalOutputShapes[a];m[m.length-1]===1||this.lossFunctions[a]===TO?["accuracy","acc"].indexOf(p)!==-1?h=m0e:["crossentropy","ce"].indexOf(p)!==-1&&(h=IRt):this.lossFunctions[a]===Ck?["accuracy","acc"].indexOf(p)!==-1?h=kRt:["crossentropy","ce"].indexOf(p)!==-1&&(h=v0e):["accuracy","acc"].indexOf(p)!==-1?h=g0e:["crossentropy","ce"].indexOf(p)!==-1&&(h=y0e);let y;["accuracy","acc"].indexOf(p)!==-1?y="acc":["crossentropy","ce"].indexOf(p)!==-1&&(y="ce"),f=h,d=u+y}else f=FRt(p),d=u+w2(p);let g;ig(d,()=>{g=f}),s(a,d,g)}})(o)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,r={}){const i=r.batchSize==null?32:r.batchSize;_3(i);const a=this.standardizeUserDataXY(e,n,!0,i);try{const o=a[0].concat(a[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,o,i,r.verbose,r.steps);return $a(c)}finally{dc(a[0],e),dc(a[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),JRt(this,e,n)}checkNumSamples(e,n,r,i="steps"){let s;if(r!=null){if(s=null,n!=null)throw new he(`If ${i} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?s=e[0].shape[0]:s=e.shape[0];else throw new he(`Either the input data should have a defined shape, or ${i} shoud be specified.`);return s}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new he("`outputs` is an empty Array, which is not allowed.");const r=Array.isArray(n),i=r?n:[n],s=this.retrieveSymbolicTensors(i),a=new bf;if(e instanceof rr&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new he(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)a.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new he(`No value is provided for the model's input ${l.name}`);a.add(l,c)}const o=Jw(s,a);return r?o:o[0]}retrieveSymbolicTensors(e){const n=Vg(null,e.length);let r=e.length;for(const i of this.layers){const s=Array.isArray(i.output)?i.output:[i.output],a=s.map(o=>o.name);for(let o=0;o<e.length;++o){const l=a.indexOf(e[o]);if(l!==-1&&(n[o]=s[l],r--),r===0)break}if(r===0)break}if(r>0){const i=[];throw n.forEach((s,a)=>{s==null&&i.push(e[a])}),new he(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(i)}`)}return n}predictLoop(e,n=32,r=!1){return ve(()=>{const i=this.checkNumSamples(e);if(r)throw new mn("Verbose predictLoop() is not implemented yet.");const s=T3(i,n),a=this.outputs.map(o=>[]);for(let o=0;o<s.length;++o)ve(()=>{const c=s[o][0],u=s[o][1],d=Dw(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new bf(h);return Jw(this.outputs,f)}).forEach((c,u)=>a[u].push(c));return $a(a.map(o=>Qr(o,0)))})}predict(e,n={}){const r=T0e(e);gte(r,this.inputNames,this.feedInputShapes,!1);try{const i=n.batchSize==null?32:n.batchSize;return _3(i),this.predictLoop(r,i)}finally{dc(r,e)}}predictOnBatch(e){gte(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,r=!0,i){if(this.optimizer_==null)throw new Fl("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const s=[];for(let a=0;a<this.feedOutputShapes.length;++a){const o=this.feedOutputShapes[a];this.feedLossFns[a]===Ck?s.push(o.slice(0,o.length-1).concat([1])):s.push(o)}if(e=mte(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=mte(n,this.feedOutputNames,s,!1,"target"),tPt(e,n),nPt(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&i!=null&&i>0&&e[0].shape[0]%i!==0)throw new he(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${i}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,r,i,s=!0,a){const[o,l]=this.standardizeUserDataXY(e,n,s,a);if(r!=null)throw new Error("sample weight is not supported yet.");let c=null;if(i!=null){const u=w0e(i,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await S0e(l[d],null,u[d]))}return[o,l,c]}testLoop(e,n,r,i=0,s){return ve(()=>{const a=this.checkNumSamples(n,r,s,"steps"),o=[];if(i>0)throw new mn("Verbose mode is not implemented yet.");if(s!=null)throw new mn("steps mode in testLoop() is not implemented yet");{const l=T3(a,r),c=Oi(Yc(0,a));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=sg(c,d,h-d),p=gB(n,f),g=e(p);if(u===0)for(let m=0;m<g.length;++m)o.push(It(0));for(let m=0;m<g.length;++m){const y=g[m];o[m]=He(o[m],se(h-d,y))}}for(let u=0;u<o.length;++u)o[u]=ct(o[u],a)}return o})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let r=0;r<e.length;++r){const i=e[r];let s=i;if(ete(e,i)>1){const a=ete(e.slice(0,r),i);s+=`_${a}`}n.push(s)}return n}makeTrainFunction(){return e=>{const n=[],r=e.slice(0,this.inputs.length),i=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),s=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),a=[],o=()=>{const d=[];for(let g=0;g<this.inputs.length;++g)d.push({key:this.inputs[g],value:r[g]});const h=new bf(d),f=Jw(this.outputs,h,{training:!0});let p;for(let g=0;g<this.lossFunctions.length;++g){const m=this.lossFunctions[g];let y=m(i[g],f[g]);s[g]!=null&&(y=qRt(y,s[g]));const x=ii(y);n.push(x),g===0?p=y:p=He(p,y)}for(let g=0;g<this.metricsTensors.length;++g){let m;if(this.outputs.length>1&&g<this.outputs.length)m=n[g];else{const y=this.metricsTensors[g][0],x=this.metricsTensors[g][1];m=ii(y(i[x],f[x]))}as(m),a.push(m)}return p=ii(p),this.calculateLosses().forEach(g=>{p=He(p,g)}),p},l=this.collectedTrainableWeights.map(d=>d.read());return[this.optimizer_.minimize(o,!0,l)].concat(a)}}makeTestFunction(){this.testFunction=e=>ve(()=>{const n=[];let r;const i=e.slice(0,this.inputs.length),s=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=[];for(let c=0;c<this.inputs.length;++c)a.push({key:this.inputs[c],value:i[c]});const o=new bf(a),l=Jw(this.outputs,o);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=ii(u(s[c],l[c]));c===0?r=d:r=He(r,d),n.push(r)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=ii(u(s[d],l[d]));n.push(h)}return n})}async fit(e,n,r={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let i,s,a,o,l,c,u,d,h;try{const f=r.batchSize==null?32:r.batchSize;_3(f);const g=await this.standardizeUserData(e,n,r.sampleWeight,r.classWeight,!1,f);i=g[0],s=g[1],h=g[2];let m=!1,y;if(r.validationData!=null&&r.validationData.length>0){if(m=!0,r.validationData.length===2)l=r.validationData[0],c=r.validationData[1];else throw r.validationData.length===3?new mn("validationData including sample weights is not supported yet."):new he(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${r.validationData} is invalid.`);const k=await this.standardizeUserData(l,c,null,null,!0,f);u=k[0],d=k[1],y=u.concat(d)}else if(r.validationSplit!=null&&r.validationSplit>0&&r.validationSplit<1){m=!0;const A=Math.floor(i[0].shape[0]*(1-r.validationSplit)),k=i[0].shape[0];u=Dw(i,A,k),a=i,i=Dw(i,0,A),d=Dw(s,A,k),o=s,s=Dw(s,0,A),y=u.concat(d)}else r.validationSteps!=null&&(m=!0);const x=i.concat(s).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),_=this.getDedupedMetricsNames();let T,E;m?(this.makeTestFunction(),T=this.testFunction,E=_.slice().concat(_.map(A=>"val_"+A))):(T=null,y=[],E=_.slice());const C=h0e(r.callbacks,r.yieldEvery);return await this.fitLoop(b,x,_,f,r.epochs,r.verbose,C,T,y,r.shuffle,E,r.initialEpoch,null,null)}finally{this.isTraining=!1,dc(i,e),dc(s,n),dc(a,e),dc(o,n),dc(u,l),dc(d,c),h!=null&&Bt(h)}}async fitLoop(e,n,r,i,s,a,o,l,c,u,d,h,f,p){i==null&&(i=32),s==null&&(s=1),u==null&&(u=!0),h==null&&(h=0);let g=!1;if(l!=null&&c!=null&&(g=!0),p!=null&&(g=!0,f==null))throw new he("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const m=this.checkNumSamples(n,i,f,"steps_per_epoch");let y;m!=null&&(y=Yc(0,m)),a==null&&(a=1);const{callbackList:x,history:b}=f0e(o,a,s,h,m,f,i,g,d);x.setModel(this),this.history=b,await x.onTrainBegin(),this.stopTraining_=!1;for(let _=h;_<s;++_){await x.onEpochBegin(_);const T={};if(f!=null)throw new mn("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new mn("batch shuffling is not implemneted yet");u&&jAe(y);const E=Oi(y),C=T3(m,i);for(let I=0;I<C.length;++I){const A={};if(await x.onBatchBegin(I,A),ve(()=>{const k=C[I][0],R=C[I][1],$=sg(E,k,R-k);A.batch=I,A.size=R-k;const z=gB(n,$),O=e(z);for(let j=0;j<r.length;++j){const B=r[j],W=O[j];A[B]=W,as(W)}if(I===C.length-1&&g){const j=this.testLoop(l,c,i);for(let B=0;B<r.length;++B){const W=r[B],L=j[B];as(L),T["val_"+W]=L}}}),await x.onBatchEnd(I,A),d0e(A),this.stopTraining_)break}E.dispose()}if(await x.onEpochEnd(_,T),this.stopTraining_)break}return await x.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return YRt(this,e,n)}async trainOnBatch(e,n){const r=await this.standardizeUserData(e,n),i=r[0],s=r[1],o=this.makeTrainFunction()(i.concat(s)),l=[];for(const c of o){const u=await c.data();l.push(u[0])}return Bt(o),dc(r[0],e),dc(r[1],n),$a(l)}getNamedWeights(e){const n=[],r=e!=null&&e.trainableOnly,i=r?this.trainableWeights:this.weights,s=this.getWeights(r);for(let a=0;a<i.length;++a)r&&!i[a].trainable||n.push({name:i[a].originalName,tensor:s[a]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=x7().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-x7().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=Id(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>Id(n))}else{const n=Object.keys(this.loss);e={};const r=this.loss;for(const i of n)if(typeof r[i]=="string")e[i]=Id(r[i]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[Id(w2(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>Id(w2(e)));{const e={};for(const n in this.metrics)e[n]=Id(w2(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=pB(e.optimizer_config),r=Kd(n);let i;if(typeof e.loss=="string")i=bm(e.loss);else if(Array.isArray(e.loss))i=e.loss.map(a=>bm(a));else if(e.loss!=null){i={};for(const a in e.loss)i[a]=bm(e.loss[a])}let s;if(Array.isArray(e.metrics))s=e.metrics.map(a=>bm(a));else if(e.metrics!=null){s={};for(const a in e.metrics)s[a]=bm(e.metrics[a])}this.compile({loss:i,metrics:s,optimizer:r})}async save(e,n){if(typeof e=="string"){const c=Hae(e);if(c.length===0)throw new he(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new he(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new he("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const r=await nj(this.getNamedWeights(n)),o={modelTopology:this.toJSON(null,!1),format:iPt,generatedBy:`TensorFlow.js tfjs-layers v${b0e}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){o.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await nj(await this.optimizer.getWeights(),c);r.specs.push(...d),r.data=Uae([r.data,u])}return this.userDefinedMetadata!=null&&(dte(this.userDefinedMetadata,this.name,!0),o.userDefinedMetadata=this.userDefinedMetadata),o.weightData=r.data,o.weightSpecs=r.specs,e.save(o)}setUserDefinedMetadata(e){dte(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}vx.className="Model";Ke(vx);class E0e extends vx{}E0e.className="Functional";Ke(E0e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class T_ extends vx{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:bO("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(r=>r<0))throw new he(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof T_||e instanceof vx;let r;if(n){if(r=e,r.outputs.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(r.inputs.length!==1)throw new he("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new he("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const i=aRt({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(i)}if(n)this.outputs=r.outputs,this.inputs=r.inputs;else{if(e.inboundNodes.length!==1)throw new he(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new he("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=a0e(this.outputs[0])}this.inboundNodes=[],new SO({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Vg(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(i=>i.shape),outputShapes:this.outputs[0].shape})}else{const i=e.apply(this.outputs[0]);if(Array.isArray(i))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[i],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(Xn(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new vx({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,r=console.log){this.built||this.build(),super.summary(e,n,r)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,r={}){if(!this.built)throw new Fl("The model needs to be compiled before being used.");return this.model.evaluate(e,n,r)}async evaluateDataset(e,n){if(!this.built)throw new Fl("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,r={}){if(!this.built)throw new Fl("The model needs to be compiled before being used.");return this.model.fit(e,n,r)}async fitDataset(e,n){if(!this.built)throw new Fl("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,r={},i=!1){let s,a={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new he("Legacy serialization format not supported yet.");s=n}else q(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),s=n.layers,delete n.layers,a=n;const o=new e(a);if(!(o instanceof T_))throw new mn(`Sequential.fromConfig called on non-Sequential input: ${o}`);for(const l of s){const u=Kd(l,void 0,i);i&&u.setFastWeightInitDuringBuild(!0),o.add(u)}return o}set stopTraining(e){if(this.model==null)throw new he("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new he("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const r={};r.className=n.getClassName(),r.config=n.getConfig(),e.push(r)}return{name:this.name,layers:e}}}T_.className="Sequential";Ke(T_);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Ks=class extends J0{getConfig(){return{}}};class C0e extends Ks{apply(e,n=1){return WMt(e,n)}}C0e.className="elu";Ke(C0e);class N0e extends Ks{apply(e){return NW(e)}}N0e.className="selu";Ke(N0e);class A0e extends Ks{apply(e){return rd(e)}}A0e.className="relu";Ke(A0e);class I0e extends Ks{apply(e){return ve(()=>Xf(6,rd(e)))}}I0e.className="relu6";Ke(I0e);class k0e extends Ks{apply(e){return e}}k0e.className="linear";Ke(k0e);class M0e extends Ks{apply(e){return Ko(e)}}M0e.className="sigmoid";Ke(M0e);class R0e extends Ks{apply(e){return GMt(e)}}R0e.className="hardSigmoid";Ke(R0e);class P0e extends Ks{apply(e){return Y0(e)}}P0e.className="softplus";Ke(P0e);class O0e extends Ks{apply(e){return HMt(e)}}O0e.className="softsign";Ke(O0e);class D0e extends Ks{apply(e){return _g(e)}}D0e.className="tanh";Ke(D0e);let m6=class extends Ks{apply(e,n=-1){return IR(e,n)}};m6.className="softmax";Ke(m6);class $0e extends Ks{apply(e,n=-1){return dW(e,n)}}$0e.className="logSoftmax";Ke($0e);class L0e extends Ks{apply(e){return ve(()=>ve(()=>{const n=Math.sqrt(2),r=se(.5,He(1,lW(ct(e,n))));return se(e,r)}))}}L0e.className="gelu";Ke(L0e);class F0e extends Ks{apply(e){return ve(()=>se(.5,se(e,He(1,_g(se(Is(ct(2,Math.PI)),He(e,se(.044715,nh(e,3)))))))))}}F0e.className="gelu_new";Ke(F0e);class j0e extends Ks{apply(e){return ve(()=>se(e,_g(Y0(e))))}}j0e.className="mish";Ke(j0e);class z0e extends Ks{apply(e,n=1){return ve(()=>se(Ko(se(e,n)),e))}}z0e.className="swish";Ke(z0e);function ip(t){return t.getClassName()}function E3(t,e={}){return SE(t,kl.getMap().classNameMap,e,"activation")}function sp(t){if(t==null){const e={};return e.className="linear",e.config={},E3(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},E3(e)}else return t instanceof Ks?t:E3(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function sPt(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class B0e extends J0{}class U0e extends B0e{constructor(e){super(),sPt(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return ve(()=>{let n=Pi([1]);return this.hasL1&&(n=He(n,Et(se(this.l1,Bi(e))))),this.hasL2&&(n=He(n,Et(se(this.l2,TE(e))))),de(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}U0e.className="L1L2";Ke(U0e);const yte={l1l2:"L1L2"};function _r(t){return t6(t)}function vte(t,e={}){return SE(t,kl.getMap().classNameMap,e,"regularizer")}function Wr(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in yte?yte[t]:t,config:{}};return vte(n)}else return t instanceof B0e?t:vte(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class V0e extends An{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Yt(e);let r=rd(e);return this.maxValue!=null&&(r=Ha(r,0,this.maxValue)),r}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}V0e.className="ReLU";Ke(V0e);class W0e extends An{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=Yt(e);return vR(r,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}W0e.className="LeakyReLU";Ke(W0e);class H0e extends An{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Vr(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Wr(e.alphaRegularizer),this.alphaConstraint=Xi(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new he(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=Xn(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const i of this.sharedAxes)n[i-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const r={};if(this.sharedAxes!=null)for(let i=1;i<e.length;++i)r[i]=e[i];this.inputSpec=[new Wi({ndim:e.length,axes:r})],this.built=!0}call(e,n){return e=Yt(e),ER(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Zr(this.alphaInitializer),alphaRegularizer:_r(this.alphaRegularizer),alphaConstraint:qi(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}H0e.className="PReLU";Ke(H0e);class G0e extends An{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new mn(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const r=Yt(e);return BT(r)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}G0e.className="ELU";Ke(G0e);class q0e extends An{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const r=Yt(e);return se(r,nt(Co(r,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}q0e.className="ThresholdedReLU";Ke(q0e);class X0e extends An{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new m6().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return ve(()=>{let r=Yt(e);const i=n.mask;if(i!=null){const s=se(ut(fo(r.shape),nt(i,r.dtype)),It(-1e9));r=He(r,s)}return this.axis instanceof Array?this.axis.length>1?va(ut(r,bR(r,this.axis,!0))):this.softmax(r,this.axis[0]):this.softmax(r,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}X0e.className="Softmax";Ke(X0e);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xx(t,e,n){if(typeof t=="number")return Vg(t,e);if(t.length!==e)throw new he(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let r=0;r<e;++r){const i=t[r];if(!zMt(i))throw new he(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${i}`)}return t}function Bc(t,e,n,r,i=1){if(t==null)return t;const s=e+(e-1)*(i-1);let a;return n==="same"?a=t:a=t-s+1,Math.floor((a+r-1)/r)}function _u(t,e,n,r){if(t==null)return null;if(r==="valid")t=t*e+rp([n-e,0]);else if(r==="same")t=t*e;else throw new he(`Unsupport padding mode: ${r}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g6(t,e){return ve(()=>(_i(e),e==="channelsFirst"?Ln(t,[0,2,3,1]):t))}function K0e(t,e){return ve(()=>(_i(e),e==="channelsFirst"?Ln(t,[0,2,3,4,1]):t))}function aPt(t,e,n,r=1,i="valid",s,a=1){return ve(()=>{if(s==null&&(s=Zc()),_i(s),t.shape.length!==3)throw new he(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new he(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new he(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(s==="channelsFirst"&&(t=Ln(t,[0,2,1])),i==="causal")throw new mn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let o=rW(t,e,r,i==="same"?"same":"valid","NWC",a);return n!=null&&(o=iu(o,n)),o})}function xte(t,e,n,r=[1,1],i="valid",s,a,o=null){return ve(()=>{if(s==null&&(s=Zc()),_i(s),t.rank!==3&&t.rank!==4)throw new he(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new he(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=g6(t,s);if(i==="causal")throw new mn("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Qoe({x:l,filter:e,strides:r,pad:i==="same"?"same":"valid",dilations:a,dataFormat:"NHWC",bias:n,activation:o}),s==="channelsFirst"&&(l=Ln(l,[0,3,1,2])),l})}function oPt(t,e,n,r=[1,1,1],i="valid",s,a){return ve(()=>{if(s==null&&(s=Zc()),_i(s),t.rank!==4&&t.rank!==5)throw new he(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new he(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let o=K0e(t,s);if(i==="causal")throw new mn("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return o=voe(o,e,r,i==="same"?"same":"valid","NDHWC",a),n!=null&&(o=iu(o,n)),s==="channelsFirst"&&(o=Ln(o,[0,4,1,2,3])),o})}class EO extends An{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",EO.verifyArgs(n),this.rank=e,cs(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new mn(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=xx(n.kernelSize,e,"kernelSize"),this.strides=xx(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,al(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,_i(this.dataFormat),this.activation=sp(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Vr(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Xi(n.biasConstraint),this.biasRegularizer=Wr(n.biasRegularizer),this.activityRegularizer=Wr(n.activityRegularizer),this.dilationRate=xx(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new he(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new he(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new he(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Su("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!n6(e.kernelSize,"number",1,3))throw new he(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:ip(this.activation),useBias:this.useBias,biasInitializer:Zr(this.biasInitializer),biasRegularizer:_r(this.biasRegularizer),activityRegularizer:_r(this.activityRegularizer),biasConstraint:qi(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Ib extends EO{constructor(e,n){super(e,n),this.kernel=null,Ib.verifyArgs(n),this.filters=n.filters,cs(this.filters,"filters"),this.kernelInitializer=Vr(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Xi(n.kernelConstraint),this.kernelRegularizer=Wr(n.kernelRegularizer)}build(e){e=Xn(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new he(`The channel dimension of the input should be defined. Found ${e[n]}`);const r=e[n],i=this.kernelSize.concat([r,this.filters]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:r}}],this.built=!0}call(e,n){return ve(()=>{e=Yt(e);let r;const i=this.bias==null?null:this.bias.read(),s=Hxe(this.activation.getClassName());if(s!=null&&this.rank===2)r=xte(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate,s);else{if(this.rank===1)r=aPt(e,this.kernel.read(),i,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)r=xte(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)r=oPt(e,this.kernel.read(),i,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new mn("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(r=this.activation.apply(r))}return r})}computeOutputShape(e){e=Xn(e);const n=[],r=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let s=0;s<r.length;++s){const a=Bc(r[s],this.kernelSize[s],this.padding,this.strides[s],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[s]);n.push(a)}let i=[e[0]];return this.dataFormat==="channelsLast"?(i=i.concat(n),i.push(this.filters)):(i.push(this.filters),i=i.concat(n)),i}getConfig(){const e={filters:this.filters,kernelInitializer:Zr(this.kernelInitializer),kernelRegularizer:_r(this.kernelRegularizer),kernelConstraint:qi(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new he(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class AE extends Ib{constructor(e){super(2,e),AE.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!n6(e.kernelSize,"number",1,2))throw new he(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}AE.className="Conv2D";Ke(AE);class IE extends Ib{constructor(e){super(3,e),IE.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new he(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}IE.className="Conv3D";Ke(IE);class Y0e extends AE{constructor(e){if(super(e),this.inputSpec=[new Wi({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new he(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Xn(e),e.length!==4)throw new he("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new he("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wi({ndim:4,axes:{[n]:r}})],this.built=!0}call(e,n){return ve(()=>{let r=Yt(e);if(r.shape.length!==4)throw new he(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o;this.dataFormat==="channelsFirst"?(a=2,o=3):(a=1,o=2);const l=i[a],c=i[o],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=_u(l,h,u,this.padding),g=_u(c,f,d,this.padding),m=[s,p,g,this.filters];this.dataFormat!=="channelsLast"&&(r=Ln(r,[0,2,3,1]));let y=sW(r,this.kernel.read(),m,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(y=Ln(y,[0,3,1,2])),this.bias!=null&&(y=iu(y,this.bias.read(),this.dataFormat)),this.activation!=null&&(y=this.activation.apply(y)),y})}computeOutputShape(e){e=Xn(e);const n=e.slice();let r,i,s;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3):(r=3,i=1,s=2);const a=this.kernelSize[0],o=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[r]=this.filters,n[i]=_u(n[i],l,a,this.padding),n[s]=_u(n[s],c,o,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Y0e.className="Conv2DTranspose";Ke(Y0e);class Z0e extends IE{constructor(e){if(super(e),this.inputSpec=[new Wi({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new he(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=Xn(e),e.length!==5)throw new he("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new he("The channel dimension of the inputs should be defined. Found `None`.");const r=e[n],i=this.kernelSize.concat([this.filters,r]);this.kernel=this.addWeight("kernel",i,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new Wi({ndim:5,axes:{[n]:r}})],this.built=!0}call(e,n){return ve(()=>{let r=Yt(e);if(r.shape.length!==5)throw new he(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${r.shape.length}`);const i=r.shape,s=i[0];let a,o,l;this.dataFormat==="channelsFirst"?(l=2,a=3,o=4):(l=1,a=2,o=3);const c=i[l],u=i[a],d=i[o],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],g=this.strides[0],m=this.strides[1],y=this.strides[2],x=_u(c,g,h,this.padding),b=_u(u,m,f,this.padding),_=_u(d,y,p,this.padding),T=[s,x,b,_,this.filters];this.dataFormat!=="channelsLast"&&(r=Ln(r,[0,2,3,4,1]));let E=boe(r,this.kernel.read(),T,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(E=Ln(E,[0,4,1,2,3])),this.bias!==null&&(E=iu(E,this.bias.read(),this.dataFormat)),this.activation!==null&&(E=this.activation.apply(E)),E})}computeOutputShape(e){e=Xn(e);const n=e.slice();let r,i,s,a;this.dataFormat==="channelsFirst"?(r=1,i=2,s=3,a=4):(r=4,i=1,s=2,a=3);const o=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[r]=this.filters,n[i]=_u(n[i],u,o,this.padding),n[s]=_u(n[s],d,l,this.padding),n[a]=_u(n[a],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}Z0e.className="Conv3DTranspose";Ke(Z0e);class Q0e extends Ib{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new he("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new he("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new he(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Vr(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Wr(n.depthwiseRegularizer),this.depthwiseConstraint=Xi(n.depthwiseConstraint),this.pointwiseInitializer=Vr(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Wr(n.pointwiseRegularizer),this.pointwiseConstraint=Xi(n.pointwiseConstraint)}build(e){if(e=Xn(e),e.length<this.rank+2)throw new he(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new he(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const r=e[n],i=this.kernelSize.concat([r,this.depthMultiplier]),s=[];for(let o=0;o<this.rank;++o)s.push(1);s.push(r*this.depthMultiplier,this.filters);const a=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",i,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,a,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",s,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,a,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,a,this.biasConstraint):this.bias=null,this.inputSpec=[new Wi({ndim:this.rank+2,axes:{[n]:r}})],this.built=!0}call(e,n){return ve(()=>{e=Yt(e);let r;if(this.rank===1)throw new mn("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=Ln(e,[0,2,3,1])),r=AW(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(r=iu(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),this.dataFormat==="channelsFirst"&&(r=Ln(r,[0,3,1,2])),r})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Zr(this.depthwiseInitializer),e.pointwiseInitializer=Zr(this.pointwiseInitializer),e.depthwiseRegularizer=_r(this.depthwiseRegularizer),e.pointwiseRegularizer=_r(this.pointwiseRegularizer),e.depthwiseConstraint=qi(this.depthwiseConstraint),e.pointwiseConstraint=qi(this.pointwiseConstraint),e}}Q0e.className="SeparableConv";class J0e extends Q0e{constructor(e){super(2,e)}}J0e.className="SeparableConv2D";Ke(J0e);class CO extends Ib{constructor(e){super(1,e),CO.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!n6(e.kernelSize,"number",1,1))throw new he(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}CO.className="Conv1D";Ke(CO);class ebe extends An{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return ve(()=>{if(e=Yt(e),this.dataFormat==="channelsLast"){const r=b2(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return b2(r,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const r=b2(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return b2(r,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}ebe.className="Cropping2D";Ke(ebe);class tbe extends An{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,_i(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,LMt(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],r=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,r]}else{const n=e[1]==null?null:this.size[0]*e[1],r=e[2]==null?null:this.size[1]*e[2];return[e[0],n,r,e[3]]}}call(e,n){return ve(()=>{let r=Yt(e);const i=r.shape;if(this.dataFormat==="channelsFirst"){r=Ln(r,[0,2,3,1]);const s=this.size[0]*i[2],a=this.size[1]*i[3],o=this.interpolation==="nearest"?ma.resizeNearestNeighbor(r,[s,a]):ma.resizeBilinear(r,[s,a]);return Ln(o,[0,3,1,2])}else{const s=this.size[0]*i[1],a=this.size[1]*i[2];return this.interpolation==="nearest"?ma.resizeNearestNeighbor(r,[s,a]):ma.resizeBilinear(r,[s,a])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}tbe.className="UpSampling2D";Ke(tbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function lPt(t,e,n=[1,1],r="valid",i,s){return ve(()=>{i==null&&(i=Zc()),_i(i);let a=g6(t,i);if(t.rank!==4)throw new he(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new he(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return a=zT(a,e,n,r==="same"?"same":"valid","NHWC",s),i==="channelsFirst"&&(a=Ln(a,[0,3,1,2])),a})}class nbe extends EO{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Vr(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Xi(e.depthwiseConstraint),this.depthwiseRegularizer=Wr(e.depthwiseRegularizer)}build(e){if(e=Xn(e),e.length<4)throw new he(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new he(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const r=e[n],i=[this.kernelSize[0],this.kernelSize[1],r,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",i,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[r*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ve(()=>{e=Yt(e);let r=lPt(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(r=iu(r,this.bias.read(),this.dataFormat)),this.activation!=null&&(r=this.activation.apply(r)),r})}computeOutputShape(e){e=Xn(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,s=Bc(n,this.kernelSize[0],this.padding,this.strides[0]),a=Bc(r,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],i,s,a]:[e[0],s,a,i]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Zr(this.depthwiseInitializer),e.depthwiseRegularizer=_r(this.depthwiseRegularizer),e.depthwiseConstraint=qi(this.depthwiseRegularizer),e}}nbe.className="DepthwiseConv2D";Ke(nbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rbe(t,e,n,r){if(Array.isArray(t)){if(e!=null||n!=null)throw new he("When inputs is an array, neither initialState or constants should be provided");r!=null&&(n=t.slice(t.length-r,t.length),t=t.slice(0,t.length-r)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function i(s){return s==null||Array.isArray(s)?s:[s]}return e=i(e),n=i(n),{inputs:t,initialState:e,constants:n}}function ibe(t,e,n,r=!1,i,s,a=!1,o=!1){return ve(()=>{const l=e.shape.length;if(l<3)throw new he(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(Yc(2,l));e=Ln(e,c),a&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),i!=null&&(i=nt(nt(i,"bool"),"float32"),i.rank===l-1&&(i=Mi(i,-1)),i=Ln(i,c)),r&&(e=ql(e,0),i!=null&&(i=ql(i,0)));const u=[];let d,h=n;const f=e.shape[0],p=Xl(e);let g;i!=null&&(g=Xl(i));for(let y=0;y<f;++y){const x=p[y],b=ve(()=>t(x,h));if(i==null)d=b[0],h=b[1];else{const _=ve(()=>{const T=g[y],E=ut(tl(T),T),C=He(se(b[0],T),se(h[0],E)),I=h.map((A,k)=>He(se(b[1][k],T),se(A,E)));return{output:C,newStates:I}});d=_.output,h=_.newStates}o&&u.push(d)}let m;return o&&(m=wo(u,1)),[d,m,h]})}class Op extends An{constructor(e){super(e);let n;if(e.cell==null)throw new he("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new x6({cells:e.cell}):n=e.cell,n.stateSize==null)throw new he("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new Wi({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return Yc(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){dB(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const r=n[0];let i;if(this.returnSequences?i=[e[0],e[1],r]:i=[e[0],r],this.returnState){const s=[];for(const a of n)s.push([e[0],a]);return[i].concat(s)}else return i}computeMask(e,n){return ve(()=>{Array.isArray(n)&&(n=n[0]);const r=this.returnSequences?n:null;if(this.returnState){const i=this.states.map(s=>null);return[r].concat(i)}else return r})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let r=0;r<e;++r)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new mn("Constants support is not implemented in RNN yet.");dB(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,r=e.slice(2);this.inputSpec[0]=new Wi({shape:[n,null,...r]});const i=[e[0]].concat(e.slice(2));this.cell.build(i);let s;if(Array.isArray(this.cell.stateSize)?s=this.cell.stateSize:s=[this.cell.stateSize],this.stateSpec!=null){if(!Pn(this.stateSpec.map(a=>a.shape[a.shape.length-1]),s))throw new he(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=s.map(a=>new Wi({shape:[null,a]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){ve(()=>{if(!this.stateful)throw new wu("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape[0];if(r==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Pi([r,i])):this.states_=[Pi([r,this.cell.stateSize])];else if(e==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(i=>Pi([r,i])):this.states_[0]=Pi([r,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let i=0;i<this.states_.length;++i){const s=e[i],a=Array.isArray(this.cell.stateSize)?this.cell.stateSize[i]:this.cell.stateSize,o=[r,a];if(!Pn(s.shape,o))throw new he(`State ${i} is incompatible with layer ${this.name}: expected shape=${o}, received shape=${s.shape}`);this.states_[i]=s}}this.states_=this.states_.map(i=>as(i.clone()))})}apply(e,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=rbe(e,r,i,this.numConstants);e=s.inputs,r=s.initialState,i=s.constants;let a=[],o=[];if(r!=null){n.initialState=r,a=a.concat(r),this.stateSpec=[];for(const c of r)this.stateSpec.push(new Wi({shape:c.shape}));o=o.concat(this.stateSpec)}if(i!=null&&(n.constants=i,a=a.concat(i),this.numConstants=i.length),a[0]instanceof ed){const c=[e].concat(a),u=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ve(()=>{const r=n==null?null:n.mask,i=n==null?null:n.training;let s=n==null?null:n.initialState;e=Yt(e),s==null&&(this.stateful?s=this.states_:s=this.getInitialState(e));const a=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(s.length!==a)throw new he(`RNN Layer has ${a} state(s) but was passed ${s.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const o={training:i},c=ibe((p,g)=>{const m=this.cell.call([p].concat(g),o);return[m[0],m.slice(1)]},e,s,this.goBackwards,r,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,i);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return ve(()=>{let n=Pi(e.shape);return n=Et(n,[1,2]),n=_E(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(r=>r>1?cB(n,[1,r]):n):this.cell.stateSize>1?[cB(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const r=this.cell.getConfig();return this.getClassName()===Op.className&&(n.cell={className:this.cell.getClassName(),config:r}),Object.assign(Object.assign(Object.assign({},r),e),n)}static fromConfig(e,n,r={}){const i=n.cell,s=Kd(i,r);return new e(Object.assign(n,{cell:s}))}}Op.className="RNN";Ke(Op);class NO extends An{}class y6 extends NO{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,cs(this.units,"units"),this.activation=sp(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wr(e.kernelRegularizer),this.recurrentRegularizer=Wr(e.recurrentRegularizer),this.biasRegularizer=Wr(e.biasRegularizer),this.kernelConstraint=Xi(e.kernelConstraint),this.recurrentConstraint=Xi(e.recurrentConstraint),this.biasConstraint=Xi(e.biasConstraint),this.dropout=P0([1,rp([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=P0([1,rp([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Xn(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ve(()=>{if(e=e,e.length!==2)throw new he(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let r=e[1];e=e[0];const i=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ap({ones:()=>tl(e),rate:this.dropout,training:i,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ap({ones:()=>tl(r),rate:this.recurrentDropout,training:i,dropoutFunc:this.dropoutFunc}));let s;const a=this.dropoutMask,o=this.recurrentDropoutMask;a!=null?s=Wu(se(e,a),this.kernel.read()):s=Wu(e,this.kernel.read()),this.bias!=null&&(s=iu(s,this.bias.read())),o!=null&&(r=se(r,o));let l=He(s,Wu(r,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ip(this.activation),useBias:this.useBias,kernelInitializer:Zr(this.kernelInitializer),recurrentInitializer:Zr(this.recurrentInitializer),biasInitializer:Zr(this.biasInitializer),kernelRegularizer:_r(this.kernelRegularizer),recurrentRegularizer:_r(this.recurrentRegularizer),biasRegularizer:_r(this.biasRegularizer),activityRegularizer:_r(this.activityRegularizer),kernelConstraint:qi(this.kernelConstraint),recurrentConstraint:qi(this.recurrentConstraint),biasConstraint:qi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}y6.className="SimpleRNNCell";Ke(y6);class sbe extends Op{constructor(e){e.cell=new y6(e),super(e)}call(e,n){return ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:i,initialState:s})})}static fromConfig(e,n){return new e(n)}}sbe.className="SimpleRNN";Ke(sbe);class v6 extends NO{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new he("GRUCell does not support reset_after parameter set to true.");this.units=e.units,cs(this.units,"units"),this.activation=sp(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=sp(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Wr(e.kernelRegularizer),this.recurrentRegularizer=Wr(e.recurrentRegularizer),this.biasRegularizer=Wr(e.biasRegularizer),this.kernelConstraint=Xi(e.kernelConstraint),this.recurrentConstraint=Xi(e.recurrentConstraint),this.biasConstraint=Xi(e.biasConstraint),this.dropout=P0([1,rp([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=P0([1,rp([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=Xn(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return ve(()=>{if(e=e,e.length!==2)throw new he(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training==null?!1:n.training;let i=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ap({ones:()=>tl(e),rate:this.dropout,training:r,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ap({ones:()=>tl(i),rate:this.recurrentDropout,training:r,count:3,dropoutFunc:this.dropoutFunc}));const s=this.dropoutMask,a=this.recurrentDropoutMask;let o,l,c;0<this.dropout&&this.dropout<1&&(e=se(e,s[0]));let u=Wu(e,this.kernel.read());this.useBias&&(u=iu(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(i=se(i,a[0]));const d=this.recurrentKernel.read(),[h,f]=vo(d,[2*this.units,this.units],d.rank-1),p=Wu(i,h),[g,m,y]=vo(u,3,u.rank-1),[x,b]=vo(p,2,p.rank-1);o=this.recurrentActivation.apply(He(g,x)),l=this.recurrentActivation.apply(He(m,b));const _=Wu(se(l,i),f);c=this.activation.apply(He(y,_));const T=He(se(o,i),se(He(1,Dr(o)),c));return[T,T]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ip(this.activation),recurrentActivation:ip(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Zr(this.kernelInitializer),recurrentInitializer:Zr(this.recurrentInitializer),biasInitializer:Zr(this.biasInitializer),kernelRegularizer:_r(this.kernelRegularizer),recurrentRegularizer:_r(this.recurrentRegularizer),biasRegularizer:_r(this.biasRegularizer),activityRegularizer:_r(this.activityRegularizer),kernelConstraint:qi(this.kernelConstraint),recurrentConstraint:qi(this.recurrentConstraint),biasConstraint:qi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}v6.className="GRUCell";Ke(v6);class abe extends Op{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new v6(e),super(e)}call(e,n){return ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:i,initialState:s})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}abe.className="GRU";Ke(abe);class AO extends NO{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,cs(this.units,"units"),this.activation=sp(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=sp(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Vr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Vr(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Vr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Wr(e.kernelRegularizer),this.recurrentRegularizer=Wr(e.recurrentRegularizer),this.biasRegularizer=Wr(e.biasRegularizer),this.kernelConstraint=Xi(e.kernelConstraint),this.recurrentConstraint=Xi(e.recurrentConstraint),this.biasConstraint=Xi(e.biasConstraint),this.dropout=P0([1,rp([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=P0([1,rp([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=Xn(e);const r=e[e.length-1];this.kernel=this.addWeight("kernel",[r,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let i;if(this.useBias){if(this.unitForgetBias){const s=this.biasInitializer,a=this.units;i=new(n=class extends tc{apply(l,c){const u=s.apply([a]),d=new i6().apply([a]),h=s.apply([a*2]);return nte(nte(u,d),h)}},n.className="CustomInit",n)}else i=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,i,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return ve(()=>{const r=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new he(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let i=e[1];const s=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ap({ones:()=>tl(e),rate:this.dropout,training:r,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ap({ones:()=>tl(i),rate:this.recurrentDropout,training:r,count:4,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,o=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=se(e,a[0]));let h=Wu(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(i=se(i,o[0])),h=He(h,Wu(i,this.recurrentKernel.read())),this.useBias&&(h=iu(h,this.bias.read()));const[f,p,g,m]=vo(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=He(se(c,s),se(l,this.activation.apply(g))),d=this.recurrentActivation.apply(m);const y=se(d,this.activation.apply(u));return[y,y,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:ip(this.activation),recurrentActivation:ip(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Zr(this.kernelInitializer),recurrentInitializer:Zr(this.recurrentInitializer),biasInitializer:Zr(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:_r(this.kernelRegularizer),recurrentRegularizer:_r(this.recurrentRegularizer),biasRegularizer:_r(this.biasRegularizer),activityRegularizer:_r(this.activityRegularizer),kernelConstraint:qi(this.kernelConstraint),recurrentConstraint:qi(this.recurrentConstraint),biasConstraint:qi(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}AO.className="LSTMCell";Ke(AO);class obe extends Op{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new AO(e),super(e)}call(e,n){return ve(()=>{this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:i,initialState:s})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}obe.className="LSTM";Ke(obe);class x6 extends NO{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return ve(()=>{e=e;let r=e.slice(1);const i=[];for(const o of this.cells.slice().reverse())Array.isArray(o.stateSize)?i.push(r.splice(0,o.stateSize.length)):i.push(r.splice(0,1));i.reverse();const s=[];let a;for(let o=0;o<this.cells.length;++o){const l=this.cells[o];r=i[o],o===0?a=[e[0]].concat(r):a=[a[0]].concat(r),a=l.call(a,n),s.push(a.slice(1))}r=[];for(const o of s.slice().reverse())r.push(...o);return[a[0]].concat(r)})}build(e){dB(e)&&(e=e[0]),e=e;let n;this.cells.forEach((r,i)=>{ig(`RNNCell_${i}`,()=>{r.build(e),Array.isArray(r.stateSize)?n=r.stateSize[0]:n=r.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=s=>({className:s.getClassName(),config:s.getConfig()}),i={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),i)}static fromConfig(e,n,r={}){const i=[];for(const s of n.cells)i.push(Kd(s,r));return new e({cells:i})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const r of this.cells)n.push(...r.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return hB(e)}setWeights(e){const n=[];for(const r of this.cells){const i=r.weights.length,s=e.splice(i);for(let a=0;a<r.weights.length;++a)n.push([r.weights[a],s[a]])}d6(n)}}x6.className="StackedRNNCells";Ke(x6);function ap(t){const{ones:e,rate:n,training:r=!1,count:i=1,dropoutFunc:s}=t,a=()=>s!=null?s(e(),n):Qxe(e(),n),o=()=>EE(a,e,r);return!i||i<=1?as(o().clone()):Array(i).fill(void 0).map(o).map(c=>as(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var cPt=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n};class lbe extends Op{constructor(e){if(e.unroll)throw new mn("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new mn("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new Wi({ndim:5})]}call(e,n){return ve(()=>{if(this.cell.dropoutMask!=null&&(Bt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Bt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new he("ConvRNN2D cell does not support constants");const r=n==null?null:n.mask,i=n==null?null:n.training,s=n==null?null:n.initialState;return super.call(e,{mask:r,training:i,initialState:s})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return ve(()=>{const{stateSize:n}=this.cell,r=e.shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)],a=Pi(s);return Array.isArray(n)?Array(n.length).fill(a):[a]})}resetStates(e,n=!1){ve(()=>{if(!this.stateful)throw new wu("Cannot call resetStates() on an RNN Layer that is not stateful.");const r=this.inputSpec[0].shape,i=this.computeSingleOutputShape(r),s=[i[0],...i.slice(2)];if(r[0]==null)throw new he("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Pi(s)):this.states_=[Pi(s)];else if(e==null)Bt(this.states_),this.keptStates!=null&&(Bt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Pi(s)):this.states_[0]=Pi(s);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new he(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Bt(this.states_);for(let o=0;o<this.states_.length;++o){const l=e[o],c=s;if(!Pn(l.shape,c))throw new he(`State ${o} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[o]=l}}this.states_=this.states_.map(o=>as(o.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:r,kernelSize:i,padding:s,strides:a,dilationRate:o}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=Bc(c,i[0],s,a[0],o[0]),h=Bc(u,i[1],s,a[1],o[1]);return[...e.slice(0,2),...l?[r,d,h]:[d,h,r]]}}lbe.className="ConvRNN2D";class b6 extends AO{constructor(e){const{filters:n,kernelSize:r,strides:i,padding:s,dataFormat:a,dilationRate:o}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,cs(this.filters,"filters"),this.kernelSize=xx(r,2,"kernelSize"),this.kernelSize.forEach(l=>cs(l,"kernelSize")),this.strides=xx(i||1,2,"strides"),this.strides.forEach(l=>cs(l,"strides")),this.padding=s||"valid",al(this.padding),this.dataFormat=a||"channelsLast",_i(this.dataFormat),this.dilationRate=xx(o||1,2,"dilationRate"),this.dilationRate.forEach(l=>cs(l,"dilationRate"))}build(e){var n;e=Xn(e);const r=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[r]==null)throw new he(`The channel dimension of the input should be defined. Found ${e[r]}`);const i=e[r],s=4,a=this.kernelSize.concat([i,this.filters*s]);this.kernel=this.addWeight("kernel",a,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const o=this.kernelSize.concat([this.filters,this.filters*s]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",o,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends tc{apply(h,f){const p=c.apply([u]),g=fo([u]),m=c.apply([u*2]);return r6([p,g,m])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*s],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return ve(()=>{if(e.length!==3)throw new he(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const r=n.training||!1,i=e[0],s=e[1],a=e[2],o=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=ap({ones:()=>tl(i),rate:this.dropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(H,K,te)=>!K||!K[te]?H:se(K[te],H);let u=c(i,l,0),d=c(i,l,1),h=c(i,l,2),f=c(i,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=ap({ones:()=>tl(s),rate:this.recurrentDropout,training:r,count:o,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let g=c(s,p,0),m=c(s,p,1),y=c(s,p,2),x=c(s,p,3);const b=3,[_,T,E,C]=vo(this.kernel.read(),o,b),[I,A,k,R]=this.useBias?vo(this.bias.read(),o):[null,null,null,null];u=this.inputConv(u,_,I,this.padding),d=this.inputConv(d,T,A,this.padding),h=this.inputConv(h,E,k,this.padding),f=this.inputConv(f,C,R,this.padding);const[$,z,O,j]=vo(this.recurrentKernel.read(),o,b);g=this.recurrentConv(g,$),m=this.recurrentConv(m,z),y=this.recurrentConv(y,O),x=this.recurrentConv(x,j);const B=this.recurrentActivation.apply(He(u,g)),W=this.recurrentActivation.apply(He(d,m)),L=He(se(W,a),se(B,this.activation.apply(He(h,y)))),V=se(this.recurrentActivation.apply(He(f,x)),this.activation.apply(L));return[V,V,L]})}getConfig(){const e=super.getConfig(),{units:n}=e,r=cPt(e,["units"]),i={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},r),i)}inputConv(e,n,r,i){const s=qf(e,n,this.strides,i||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return r?iu(s,r,this.dataFormat):s}recurrentConv(e,n){return qf(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}b6.className="ConvLSTM2DCell";Ke(b6);class cbe extends lbe{constructor(e){const n=new b6(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}cbe.className="ConvLSTM2D";Ke(cbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class w6 extends An{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,r=[];for(let i=0;i<this.noiseShape.length;++i)r.push(this.noiseShape[i]==null?n[i]:this.noiseShape[i]);return r}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e);if(0<this.rate&&this.rate<1){const i=n.training==null?!1:n.training,s=this.getNoiseShape(r);return EE(()=>Qxe(r,this.rate,s,this.seed),()=>r,i)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}w6.className="Dropout";Ke(w6);class ube extends w6{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}ube.className="SpatialDropout1D";Ke(ube);class dbe extends An{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,cs(this.units,"units"),this.activation=sp(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Vr(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Vr(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Xi(e.kernelConstraint),this.biasConstraint=Xi(e.biasConstraint),this.kernelRegularizer=Wr(e.kernelRegularizer),this.biasRegularizer=Wr(e.biasRegularizer),this.activityRegularizer=Wr(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=Xn(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=Xn(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e),i=Hxe(this.activation.getClassName());let s;return i!=null?s=Wu(r,this.kernel.read(),i,this.bias?this.bias.read():null):(s=Wu(r,this.kernel.read()),this.bias!=null&&(s=iu(s,this.bias.read())),this.activation!=null&&(s=this.activation.apply(s))),s})}getConfig(){const e={units:this.units,activation:ip(this.activation),useBias:this.useBias,kernelInitializer:Zr(this.kernelInitializer),biasInitializer:Zr(this.biasInitializer),kernelRegularizer:_r(this.kernelRegularizer),biasRegularizer:_r(this.biasRegularizer),activityRegularizer:_r(this.activityRegularizer),kernelConstraint:qi(this.kernelConstraint),biasConstraint:qi(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}dbe.className="Dense";Ke(dbe);class hbe extends An{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=Xn(e);for(const n of e.slice(1))if(n==null)throw new he(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Lf(e,1)]}call(e,n){return ve(()=>{this.invokeCallHook(e,n);let r=Yt(e);if(this.dataFormat==="channelsFirst"&&r.rank>1){const i=[0];for(let s=2;s<r.rank;++s)i.push(s);i.push(1),r=Ln(r,i)}return VMt(r)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}hbe.className="Flatten";Ke(hbe);class fbe extends An{constructor(e){super(e),this.supportsMasking=!0,this.activation=sp(e.activation)}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e);return this.activation.apply(r)})}getConfig(){const e={activation:ip(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}fbe.className="Activation";Ke(fbe);class pbe extends An{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return ve(()=>(e=Yt(e),BMt(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}pbe.className="RepeatVector";Ke(pbe);class mbe extends An{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const r="Total size of new array must be unchanged.",i=n.slice();let s=1,a=null;for(let l=0;l<i.length;++l){const c=i[l];if(this.isUnknown(c))if(a===null)a=l;else throw new he("Can only specifiy one unknown dimension.");else s*=c}const o=Lf(e);if(a!==null){if(s===0||o%s!==0)throw new he(r);i[a]=o/s}else if(o!==s)throw new he(r);return i}computeOutputShape(e){let n=!1;for(let r=0;r<e.length;++r)if(this.isUnknown(e[r])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e),i=r.shape,s=i.slice(0,1).concat(this.fixUnknownDimension(i.slice(1),this.targetShape));return de(r,s)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}mbe.className="Reshape";Ke(mbe);class gbe extends An{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=Yc(1,e.dims.length+1);if(!Pn(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new Wi({ndim:this.dims.length+1})]}computeOutputShape(e){e=Xn(e);const n=e.slice();return this.dims.forEach((r,i)=>{n[i+1]=e[r]}),n}call(e,n){return Ln(Yt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}gbe.className="Permute";Ke(gbe);class ybe extends An{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const r=Yt(e);return VA(Xx(r,this.maskValue),-1)}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e),a=VA(Xx(r,this.maskValue),-1,!0);return se(r,nt(a,r.dtype))})}}ybe.className="Masking";Ke(ybe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class vbe extends An{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ar(e.inputLength))}this.inputDim=e.inputDim,cs(this.inputDim,"inputDim"),this.outputDim=e.outputDim,cs(this.outputDim,"outputDim"),this.embeddingsInitializer=Vr(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Wr(e.embeddingsRegularizer),this.activityRegularizer=Wr(e.activityRegularizer),this.embeddingsConstraint=Xi(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return ve(()=>this.maskZero?(e=Yt(e),Xx(e,Fn(e))):null)}computeOutputShape(e){if(e=Xn(e),this.inputLength==null)return[...e,this.outputDim];const n=ar(this.inputLength);if(n.length!==e.length-1)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let r=0;for(let i=0;i<n.length;++i){const s=n[i],a=e[i+1];if(s!=null&&a!=null&&s!==a)throw new he(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);s==null&&(n[r]=a),r++}}return[e[0],...n,this.outputDim]}call(e,n){return ve(()=>{this.invokeCallHook(e,n);let r=Yt(e);r.dtype!=="int32"&&(r=Vu(r,"int32"));const i=Zxe(this.embeddings.read(),de(r,[r.size]));return de(i,Xn(this.computeOutputShape(r.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Zr(this.embeddingsInitializer),embeddingsRegularizer:_r(this.embeddingsRegularizer),activityRegularizer:_r(this.activityRegularizer),embeddingsConstraint:qi(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}vbe.className="Embedding";Ke(vbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class fy extends An{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new mn}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const r=e.slice(0,e.length-n.length);for(let i=0;i<n.length;++i){const s=e[e.length-n.length+i],a=n[i];if(s==null||a==null||s<0||a<0)r.push(null);else if(s===1)r.push(a);else if(a===1)r.push(s);else{if(s!==a)throw new he("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));r.push(s)}}return r}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[Xn(e)]),e=e,e.length<2)throw new he(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const s of e)s!=null&&s[0]!==null&&n.push(s[0]);if(n=$f(n),n.length>1)throw new he(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let r=e[0]==null?null:e[0].slice(1);for(let s=1;s<e.length;++s){const a=e[s]==null?null:e[s].slice(1);r=this.computeElementwiseOpOutputShape(r,a)}const i=e.map(s=>s.length);e.indexOf(null)===-1&&$f(i).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return ve(()=>{if(e=e,this.reshapeRequired){const r=[],i=e.map(s=>s.rank);if(i.indexOf(null)===-1){const s=rp(i);for(let a of e){const o=a.rank;for(let l=0;l<s-o;++l)a=_E(a,1);r.push(a)}return this.mergeFunction(r)}else{let s=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=de(l,[d].concat(Lf(u.slice(1))));f=Ln(f,[1,0]),f=de(f,h),r.push(f),s=!0}else if(c>1){const u=Yc(1,c).concat([0]);r.push(Ln(l,u)),s=!0}else r.push(l)}let a=this.mergeFunction(r);const o=a.rank;if(s){if(o==null){const l=a.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));a=de(Ln(de(a,[-1,u]),[1,0]),d)}else if(o>1){const l=[o-1].concat(Yc(0,o-1));a=Ln(a,l)}}return a}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let i=1;i<e.length;++i){const s=e[i]==null?null:e[i].slice(1);n=this.computeElementwiseOpOutputShape(n,s)}let r=[];for(const i of e)i!=null&&i[0]!==null&&r.push(i[0]);return r=$f(r),r.length===1?n=r.concat(n):n=[null].concat(n),n}computeMask(e,n){return ve(()=>{if(n==null)return null;if(!Array.isArray(n))throw new he("`mask` should be an Array");if(!Array.isArray(e))throw new he("`inputs` should be an Array");if(n.length!==e.length)throw new he(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(i=>i==null))return null;n=n.map(i=>i==null?i:Mi(i,0));let r=n[0];for(let i=1;i<n.length-1;++i)r=Gu(r,n[i]);return r})}}class xbe extends fy{constructor(e){super(e)}mergeFunction(e){return ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=He(n,e[r]);return n})}}xbe.className="Add";Ke(xbe);class bbe extends fy{constructor(e){super(e)}mergeFunction(e){return ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=se(n,e[r]);return n})}}bbe.className="Multiply";Ke(bbe);class wbe extends fy{constructor(e){super(e)}mergeFunction(e){return ve(()=>{let n=e[0].clone();for(let r=1;r<e.length;++r)n=He(n,e[r]);return se(1/e.length,n)})}}wbe.className="Average";Ke(wbe);class Sbe extends fy{constructor(e){super(e)}mergeFunction(e){return ve(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=vh(n,e[r]);return n})}}Sbe.className="Maximum";Ke(Sbe);class _be extends fy{constructor(e){super(e)}mergeFunction(e){return ve(()=>{let n=e[0];for(let r=1;r<e.length;++r)n=Xf(n,e[r]);return n})}}_be.className="Minimum";Ke(_be);class Tbe extends fy{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new he("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const i of e)if(i!=null){n=!1;break}if(n)return;const r=[];for(let i=0;i<e.length;++i){const s=e[i].slice();s.splice(this.axis,1);let a=!1;for(const o of r)if(Pn(o,s)){a=!0;break}a||r.push(s)}if(r.length>1)throw new he("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return ve(()=>r6(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new he("A `Concatenate` layer should be called on a list of inputs.");const n=e,r=n[0].slice(),i=this.axis<0?r.length+this.axis:this.axis;for(const s of n.slice(1)){if(r[i]==null||s[i]==null){r[i]=null;break}r[i]+=s[i]}return r}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new he("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new he("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new he(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return ve(()=>{let r=!0;if(n.forEach(a=>{if(a!=null){r=!1;return}}),r)return null;const i=[];for(let a=0;a<e.length;++a)n[a]==null?i.push(nt(tl(e[a]),"bool")):n[a].rank<e[a].rank?i.push(Mi(n[a],-1)):i.push(n[a]);const s=Qr(i,this.axis);return tW(s,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}Tbe.className="Concatenate";Ke(Tbe);function $w(t,e){for(;t<0;)t+=e;return t}function uPt(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new mn("batchDot is not implemented for tensors of 4D or higher rank yet");if(q(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),q(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new mn("batchDot is not implemented for complex64-type Tensors yet.");const r=t.shape.length,i=e.shape.length;n==null&&(n=[r-1,i-2]);const s=n;return ve(()=>{let a;if(r>i){a=r-i;const l=[];for(let c=0;c<a;++c)l.push(1);e=de(e,e.shape.concat(l))}else if(i>r){a=i-r;const l=[];for(let c=0;c<a;++c)l.push(1);t=de(t,t.shape.concat(l))}else a=0;let o;if(t.shape.length===2&&e.shape.length===2)s[0]===s[1]?o=Et(se(t,e),s[0]):o=Et(se(Ln(t,[1,0]),e),s[1]);else{const l=s[0]!==t.shape.length-1,c=s[1]===e.shape.length-1;o=Mn(t,e,l,c)}if(a>0){let l;r>i?l=r+i-3:l=r-1;const c=[];for(let u=l;u<l+a;++u)c.push(u);o=Yn(o,c)}return o.shape.length===1&&(o=Mi(o,1)),o})}class Ebe extends fy{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){q(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],r=e[1];if(n.length>3||r.length>3)throw new mn("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);if(n[i[0]]!==r[i[1]])throw new he(`Dimension incompatibility: ${n[i[0]]} !== ${r[i[1]]}`)}mergeFunction(e){if(e.length!==2)throw new he(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],r=e[1],i;return Array.isArray(this.axes)?i=this.axes.map((s,a)=>$w(s,e[a].shape.length)):i=[$w(this.axes,n.shape.length),$w(this.axes,r.shape.length)],this.normalize&&(n=Ek(n,i[0]),r=Ek(r,i[1])),uPt(n,r,i)}interpretAxes(e,n){let r;return Array.isArray(this.axes)?r=this.axes:r=[$w(this.axes,e.length),$w(this.axes,n.length)],r}computeOutputShape(e){q(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),r=e[1].slice();if(n.length>3||r.length>3)throw new mn("Dot layer does not support tensors of 4D or higher rank yet.");const i=this.interpretAxes(n,r);n.splice(i[0],1),r.splice(i[1],1),r.splice(0,1);const s=n.concat(r);return s.length===1&&s.push(1),s}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}Ebe.className="Dot";Ke(Ebe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Cbe extends An{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e);return EE(()=>He(wO(r.shape,0,this.stddev),r),()=>r,n.training||!1)})}}Cbe.className="GaussianNoise";Ke(Cbe);class Nbe extends An{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ve(()=>{this.invokeCallHook(e,n);const r=Yt(e);return this.rate>0&&this.rate<1?EE(()=>{const s=Math.sqrt(this.rate/(1-this.rate));return se(r,wO(r.shape,1,s))},()=>r,n.training||!1):r})}}Nbe.className="GaussianDropout";Ke(Nbe);class Abe extends An{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Yt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return ve(()=>{if(this.rate<1&&this.rate>0){const r=this._getNoiseShape(e);return EE(()=>{const s=Yt(e),o=-1.6732632423543772*1.0507009873554805;let l=yp(Zg(r),this.rate);l=Vu(l,"float32");const c=((1-this.rate)*(1+this.rate*o**2))**-.5,u=-c*o*this.rate,d=He(se(s,l),se(He(l,-1),o));return He(se(d,c),u)},()=>Yt(e),n.training||!1)}return e})}}Abe.className="AlphaDropout";Ke(Abe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function E_(t,e,n,r,i,s=.001){let a;if(t.rank===2)a=coe(t,e,n,r,i,s);else if(t.rank===3)a=uoe(t,e,n,r,i,s);else if(t.rank===4)a=doe(t,e,n,r,i,s);else throw new mn(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return a}function dPt(t,e,n,r,i=.001){return ve(()=>{const s=_R(t,r),a=s.mean,o=s.variance;return[E_(t,a,o,n,e,i),a,o]})}function hPt(t,e,n,r,i=.001){return ve(()=>{const s=_R(t,r),a=s.mean,o=s.variance,l=[];for(const p of Yc(0,t.rank))r.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=de(a,l),u=de(o,l),d=e==null?null:de(e,l),h=n==null?null:de(n,l);return[E_(t,c,u,h,d,i),a,o]})}function fPt(t,e,n,r,i=.001){return Pn(r.slice().sort(),Yc(0,t.rank-1))?dPt(t,e,n,r,i):hPt(t,e,n,r,i)}class Ibe extends An{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Vr(e.betaInitializer||"zeros"),this.gammaInitializer=Vr(e.gammaInitializer||"ones"),this.movingMeanInitializer=Vr(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Vr(e.movingVarianceInitializer||"ones"),this.betaConstraint=Xi(e.betaConstraint),this.gammaConstraint=Xi(e.gammaConstraint),this.betaRegularizer=Wr(e.betaRegularizer),this.gammaRegularizer=Wr(e.gammaRegularizer)}build(e){e=Xn(e);const n=this.axis>=0?this.axis:this.axis+e.length,r=e[n];if(r==null)throw new he(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new Wi({ndim:e.length,axes:{[n]:r}})];const i=[r];this.scale&&(this.gamma=this.addWeight("gamma",i,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",i,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",i,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",i,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return ve(()=>{const r=n.training==null?!1:n.training,i=Yt(e),s=i.shape,a=s.length,o=Yc(0,a),l=this.axis>=0?this.axis:this.axis+a;o.splice(l,1);const c=Vg(1,a);c[l]=s[l];const u=o.slice();u.sort();const d=!Pn(u,Yc(0,a).slice(0,a-1)),h=()=>{if(d){const x=de(this.movingMean.read(),c),b=de(this.movingVariance.read(),c),_=this.center?de(this.beta.read(),c):null,T=this.scale?de(this.gamma.read(),c):null;return E_(i,x,b,_,T,this.epsilon)}else return E_(i,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!r)return h();const[f,p,g]=fPt(i,this.gamma.read(),this.beta.read(),o,this.epsilon),m=(x,b,_)=>{ve(()=>{const T=1-_,E=x.read(),C=se(ut(E,b),T);x.write(ut(E,C))})};return(()=>{m(this.movingMean,p,this.momentum),m(this.movingVariance,g,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Zr(this.betaInitializer),gammaInitializer:Zr(this.gammaInitializer),movingMeanInitializer:Zr(this.movingMeanInitializer),movingVarianceInitializer:Zr(this.movingVarianceInitializer),betaRegularizer:_r(this.betaRegularizer),gammaRegularizer:_r(this.gammaRegularizer),betaConstraint:qi(this.betaConstraint),gammaConstraint:qi(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}Ibe.className="BatchNormalization";Ke(Ibe);class kbe extends An{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Vr(e.betaInitializer||"zeros"),this.gammaInitializer=Vr(e.gammaInitializer||"ones"),this.betaRegularizer=Wr(e.betaRegularizer),this.gammaRegularizer=Wr(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=Xn(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let s=0;s<this.axis.length;++s)this.axis[s]<0&&(this.axis[s]+=n);for(const s of this.axis)if(s<0||s>=n)throw new Error(`Invalid axis: ${s}`);if(this.axis.length!==$f(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const r=this.axis.map(s=>e[s]),i=!0;this.scale?this.gamma=this.addWeight("gamma",r,"float32",this.gammaInitializer,this.gammaRegularizer,i):this.gamma=null,this.center?this.beta=this.addWeight("beta",r,"float32",this.betaInitializer,this.betaRegularizer,i):this.beta=null,this.built=!0}call(e,n){const r=Yt(e),i=r.shape,s=i.length;return ve(()=>{let{mean:o,variance:l}=_R(r,this.axis,!0);const c=Vg(1,s);for(const g of this.axis)c[g]=i[g];const u=g=>g!=null&&g.shape.length!==s?de(g,c):g;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let g=0;g<s;++g)this.axis.indexOf(g)!==-1?(f.push(i[g]),p.push(1)):(f.push(1),p.push(i[g]));return o=Dl(o,f),l=Dl(l,f),d!=null&&(d=Dl(d,p)),h!=null&&(h=Dl(h,p)),E_(r,o,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Zr(this.betaInitializer),gammaInitializer:Zr(this.gammaInitializer),betaRegularizer:_r(this.betaRegularizer),gammaRegularizer:_r(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}kbe.className="LayerNormalization";Ke(kbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function pPt(t,e,n){return ve(()=>{if(t.rank!==4)throw new he(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new he("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=Zc()),n!=="channelsLast"&&n!=="channelsFirst")throw new he(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let r;return n==="channelsFirst"?r=[[0,0],[0,0],e[0],e[1]]:r=[[0,0],e[0],e[1],[0,0]],Gc(t,r)})}class Mbe extends An{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?Zc():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new he(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,r;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],r=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new he(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new he(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);r=e.padding[1]}this.padding=[n,r]}this.inputSpec=[new Wi({ndim:4})]}computeOutputShape(e){e=Xn(e);let n,r;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?r=e[3]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],e[1],n,r]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?r=e[2]+this.padding[1][0]+this.padding[1][1]:r=null,[e[0],n,r,e[3]])}call(e,n){return ve(()=>pPt(Yt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}Mbe.className="ZeroPadding2D";Ke(Mbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function IO(t,e,n,r,i,s){return ve(()=>{_i(i),qxe(s),al(r),n==null&&(n=[1,1]),r==null&&(r="valid"),i==null&&(i=Zc()),s==null&&(s="max"),t=g6(t,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=SR(t,e,n,o):a=pR(t,e,n,o),i==="channelsFirst"&&(a=Ln(a,[0,3,1,2])),a})}function Rbe(t,e,n,r,i,s){return ve(()=>{_i(i),qxe(s),al(r),n==null&&(n=[1,1,1]),r==null&&(r="valid"),i==null&&(i=Zc()),s==null&&(s="max"),t=K0e(t,i);let a;const o=r==="same"?"same":"valid";return s==="max"?a=Doe(t,e,n,o):a=loe(t,e,n,o),i==="channelsFirst"&&(a=Ln(a,[0,4,1,2,3])),a})}class Pbe extends An{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new he(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(cs(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new he(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);cs(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,al(this.padding),this.inputSpec=[new Wi({ndim:3})]}computeOutputShape(e){e=Xn(e);const n=Bc(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return ve(()=>{this.invokeCallHook(e,n),e=_E(Yt(e),2);const r=this.poolingFunction(Yt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Yn(r,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class Obe extends Pbe{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),IO(e,n,r,i,s,"max")}}Obe.className="MaxPooling1D";Ke(Obe);class Dbe extends Pbe{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),IO(e,n,r,i,s,"avg")}}Dbe.className="AveragePooling1D";Ke(Dbe);class $be extends An{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new he(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];cs(this.poolSize,"poolSize"),cs(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,_i(this.dataFormat),al(this.padding),this.inputSpec=[new Wi({ndim:4})]}computeOutputShape(e){e=Xn(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=Bc(n,this.poolSize[0],this.padding,this.strides[0]),r=Bc(r,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r]:[e[0],n,r,e[3]]}call(e,n){return ve(()=>(this.invokeCallHook(e,n),this.poolingFunction(Yt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Lbe extends $be{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),IO(e,n,r,i,s,"max")}}Lbe.className="MaxPooling2D";Ke(Lbe);class Fbe extends $be{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),IO(e,n,r,i,s,"avg")}}Fbe.className="AveragePooling2D";Ke(Fbe);class jbe extends An{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new he(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];cs(this.poolSize,"poolSize"),cs(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,_i(this.dataFormat),al(this.padding),this.inputSpec=[new Wi({ndim:5})]}computeOutputShape(e){e=Xn(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],r=this.dataFormat==="channelsFirst"?e[3]:e[2],i=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=Bc(n,this.poolSize[0],this.padding,this.strides[0]),r=Bc(r,this.poolSize[1],this.padding,this.strides[1]),i=Bc(i,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,r,i]:[e[0],n,r,i,e[4]]}call(e,n){return ve(()=>(this.invokeCallHook(e,n),this.poolingFunction(Yt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class zbe extends jbe{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),Rbe(e,n,r,i,s,"max")}}zbe.className="MaxPooling3D";Ke(zbe);class Bbe extends jbe{constructor(e){super(e)}poolingFunction(e,n,r,i,s){return _i(s),al(i),Rbe(e,n,r,i,s,"avg")}}Bbe.className="AveragePooling3D";Ke(Bbe);class Ube extends An{constructor(e){super(e),this.inputSpec=[new Wi({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new mn}}class Vbe extends Ube{constructor(e){super(e||{})}call(e,n){return ve(()=>{const r=Yt(e);return ii(r,1)})}}Vbe.className="GlobalAveragePooling1D";Ke(Vbe);class Wbe extends Ube{constructor(e){super(e||{})}call(e,n){return ve(()=>{const r=Yt(e);return Bl(r,1)})}}Wbe.className="GlobalMaxPooling1D";Ke(Wbe);class Hbe extends An{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,_i(this.dataFormat),this.inputSpec=[new Wi({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new mn}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class Gbe extends Hbe{call(e,n){return ve(()=>{const r=Yt(e);return this.dataFormat==="channelsLast"?ii(r,[1,2]):ii(r,[2,3])})}}Gbe.className="GlobalAveragePooling2D";Ke(Gbe);class qbe extends Hbe{call(e,n){return ve(()=>{const r=Yt(e);return this.dataFormat==="channelsLast"?Bl(r,[1,2]):Bl(r,[2,3])})}}qbe.className="GlobalMaxPooling2D";Ke(qbe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Xbe extends An{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,r={}){const i=n.layer,s=Kd(i,r);delete n.layer;const a={layer:s};return Object.assign(a,n),new e(a)}}class Kbe extends Xbe{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=Xn(e),e.length<3)throw new he(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=Xn(e);const n=[e[0]].concat(e.slice(2)),r=this.layer.computeOutputShape(n),i=e[1];return[r[0],i].concat(r.slice(1))}call(e,n){return ve(()=>(e=Yt(e),ibe((a,o)=>[Yt(this.layer.call(a,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}Kbe.className="TimeDistributed";Ke(Kbe);function mPt(t){hy($Mt,"BidirectionalMergeMode",t)}const gPt="concat";class Ybe extends Xbe{constructor(e){super(e);const n=e.layer.getConfig(),r={};r.className=e.layer.getClassName(),r.config=n,this.forwardLayer=Kd(r),n.goBackwards=n.goBackwards!==!0;const i={};if(i.className=e.layer.getClassName(),i.config=n,this.backwardLayer=Kd(i),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?gPt:e.mergeMode,mPt(this.mergeMode),e.weights)throw new mn("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,r=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,r)),this.backwardLayer.setWeights(e.slice(r))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let r,i,s;return this.returnState&&(s=n.slice(1)),r=n[0],r=r,this.mergeMode==="concat"?(r[r.length-1]*=2,i=[r]):this.mergeMode==null?i=[r,r.slice()]:i=[r],this.returnState?this.mergeMode==null?i.concat(s).concat(s.slice()):[r].concat(s).concat(s.slice()):$a(i)}apply(e,n){let r=n==null?null:n.initialState,i=n==null?null:n.constants;n==null&&(n={});const s=rbe(e,r,i,this.numConstants);if(e=s.inputs,r=s.initialState,i=s.constants,Array.isArray(e)&&(r=e.slice(1),e=e[0]),(r==null||r.length===0)&&i==null)return super.apply(e,n);const a=[],o=[];if(r!=null){const c=r.length;if(c%2>0)throw new he("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=r,a.push(...r);const u=r.map(d=>new Wi({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),o.push(...u)}if(i!=null)throw new mn("Support for constants in Bidirectional layers is not implemented yet.");const l=a[0]instanceof ed;for(const c of a)if(c instanceof ed!==l)throw new he("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(a),u=this.inputSpec.concat(o),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return ve(()=>{const r=n.initialState;let i,s;if(r==null)i=this.forwardLayer.call(e,n),s=this.backwardLayer.call(e,n);else{const l=r.slice(0,r.length/2),c=r.slice(r.length/2);i=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),s=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let a;this.returnState&&(Array.isArray(i)&&(a=i.slice(1).concat(s.slice(1))),i=i[0],s=s[0]),this.returnSequences&&(s=ql(s,1));let o;return this.mergeMode==="concat"?o=r6([i,s]):this.mergeMode==="sum"?o=He(i,s):this.mergeMode==="ave"?o=se(.5,He(i,s)):this.mergeMode==="mul"?o=se(i,s):this.mergeMode==null&&(o=[i,s]),this.returnState?this.mergeMode==null?o.concat(a):[o].concat(a):o})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){ig(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),ig(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let r;if(this.returnSequences?this.mergeMode==null?r=[n,n]:r=n:this.mergeMode==null?r=[null,null]:r=null,this.returnState){const s=this.forwardLayer.states.map(a=>null);return Array.isArray(r)?r.concat(s).concat(s):[r].concat(s).concat(s)}else return r}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const r=Kd(n.layer);if(delete n.layer,n.numConstants!=null)throw new mn("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const i=n;return i.layer=r,new e(i)}}Ybe.className="Bidirectional";Ke(Ybe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zbe extends An{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ve(()=>(e=Yt(e),e.dtype!=="float32"&&(e=Vu(e,"float32")),He(se(e,this.scale),this.offset)))}}Zbe.className="Rescaling";Ke(Zbe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:yPt,cropAndResize:vPt}=ma;class Qbe extends An{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,r,i,s,a,o,l){return ve(()=>{let c,u=!1;const d=n/a,h=r/o,f=(i+n)/a,p=(s+r)/o,g=[d,h,f,p],m=[];e.rank===3?(u=!0,c=wo([e])):c=e;for(let T=0;T<c.shape[0];T++)m.push(g);const y=Fc(m,[m.length,4]),x=Kx(0,m.length,1,"int32"),_=vPt(c,y,x,[i,s],"nearest");return Vu(u?Yt(Xl(_)):_,l)})}upsize(e,n,r,i){return ve(()=>{const s=yPt(e,[n,r]);return Vu(s,i)})}call(e,n){return ve(()=>{const r=Yt(e),i=r.dtype,s=r.shape,a=s[s.length-3],o=s[s.length-2];let l=0;a!==this.height&&(l=Math.floor((a-this.height)/2));let c=0;return o!==this.width&&(c=Math.floor((o-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(r,l,c,this.height,this.width,a,o,i):this.upsize(e,this.height,this.width,i)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Xn(e);const n=e.length-3,r=e.length-2;return e[n]=this.height,e[r]=this.width,e}}Qbe.className="CenterCrop";Ke(Qbe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function xPt(t,e,n,r){let i=Yt(t);if(i.dtype!=="int32"&&(i=Vu(i,"int32")),e==="int")return i;const s=i.shape;if(i.rank===0&&(i=Mi(i,-1)),e==="oneHot"&&i.shape[i.shape.length-1]!==1&&(i=Mi(i,-1)),i.rank>2)throw new he(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${s} which would result in output rank ${i.rank}.`);const a=["multiHot","oneHot"].includes(e),o=i;let l;if(typeof r<"u"&&e==="count"?l=lj(o,r,n,a):l=lj(o,[],n,a),e!=="tfIdf")return l;if(r)return se(l,r);throw new he("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Jbe extends An{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=Xn(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return ve(()=>{e=Yt(e),e.dtype!=="int32"&&(e=Vu(e,"int32"));let r;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new he(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);r=Yt(n.countWeights)}const i=Bl(e),s=Y1(e),a=Co(this.numTokens,i).bufferSync().get(0),o=yp(s,0).bufferSync().get(0);if(!(a&&o))throw new he(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return xPt(e,this.outputMode,this.numTokens,r)})}}Jbe.className="CategoryEncoding";Ke(Jbe);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const bPt=["bilinear","nearest"],bte=new Set(bPt);class ewe extends An{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(bte.has(e.interpolation))this.interpolation=e.interpolation;else throw new he(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=Xn(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return ve(()=>{const r=[this.height,this.width];if(this.interpolation==="bilinear")return ma.resizeBilinear(e,r,!this.cropToAspectRatio);if(this.interpolation==="nearest")return ma.resizeNearestNeighbor(e,r,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...bte]} are supported`)})}}ewe.className="Resizing";Ke(ewe);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class twe{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}twe.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class nwe extends An{constructor(e){super(e),this.randomGenerator=new twe(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}nwe.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const wPt=["bilinear","nearest"],wte=new Set(wPt);class rwe extends nwe{constructor(e){super(e);const{factor:n,interpolation:r="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new he(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new he(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new he(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(r)if(wte.has(r))this.interpolation=r;else throw new he(`Invalid interpolation parameter: ${r} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=Xn(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return ve(()=>{const r=Yt(e);this.imgHeight=r.shape[r.shape.length-3];const i=r.shape[r.shape.length-2];this.widthFactor=Zg([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let s=this.widthFactor.dataSync()[0]*i;s=Math.round(s);const a=[this.imgHeight,s];switch(this.interpolation){case"bilinear":return ma.resizeBilinear(e,a);case"nearest":return ma.resizeNearestNeighbor(e,a);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...wte]} are supported`)}})}}rwe.className="RandomWidth";Ke(rwe);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var Ste;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(Ste||(Ste={}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPt=LW;class kO extends UU{nextDataId(){return kO.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new cae(this,Fo())}write(e,n,r){this.firstUse&&(this.firstUse=!1,Me().get("IS_NODE")&&Uo(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const i={id:this.nextDataId()};return this.data.set(i,{values:e,dtype:r,refCount:1}),i}makeTensorInfo(e,n,r){let i;if(n==="string"&&r!=null&&r.length>0&&B_(r[0])){const s=r.map(a=>kf(a));i=this.write(s,e,n)}else i=this.write(r,e,n);return{dataId:i,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,r,i,s){this.data.set(e,{values:n,dtype:i,refCount:s})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:r}=this.data.get(e);if(n==="complex64"){const i=this.readSync(r.real.dataId),s=this.readSync(r.imag.dataId);return ih(i,s)}return GAe(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const r=n.map(i=>Vf(i));return yn(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return yn(e.shape,e.dtype,n)}makeOutput(e,n,r){return Fo().makeTensorFromTensorInfo(this.makeTensorInfo(n,r,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:r}=this.data.get(e);r!=null&&(this.disposeData(r.real.dataId,!0),this.disposeData(r.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=Oa();return e(),{kernelMs:Oa()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ct([e],"where");const n=this.readSync(e.dataId);return SPt(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}kO.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Fae("cpu",()=>new kO,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iwe=cr(tT,t=>t>=0?t:Math.exp(t)-1),_Pt={kernelName:tT,backendName:"cpu",kernelFunc:iwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function swe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{alpha:s}=r;Ct([i],"leakyRelu");const a=Oe(i.shape),o=n.data.get(i.dataId).values,l=As("float32",a);for(let c=0;c<o.length;c++)l[c]=o[c]<0?s*o[c]:o[c];return n.makeTensorInfo(i.shape,"float32",l)}const TPt={kernelName:RM,backendName:"cpu",kernelFunc:swe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EPt=Si((t,e)=>t<0?e*t:t);function awe(t){const{inputs:e,backend:n}=t,{x:r,alpha:i}=e;Ct([r,i],"prelu");const s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,[o,l]=EPt(r.shape,i.shape,s,a,"float32");return n.makeTensorInfo(l,"float32",o)}const CPt={kernelName:ZM,backendName:"cpu",kernelFunc:awe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const owe=cr(bT,t=>Math.max(0,t)),NPt={kernelName:bT,backendName:"cpu",kernelFunc:owe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lwe=cr(wT,t=>Math.min(Math.max(0,t),6)),APt={kernelName:wT,backendName:"cpu",kernelFunc:lwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kk(t,e,n,r,i){if(n==="linear")return qu({inputs:{x:e},backend:t});if(n==="relu")return owe({inputs:{x:e},backend:t});if(n==="elu")return iwe({inputs:{x:e},backend:t});if(n==="relu6")return lwe({inputs:{x:e},backend:t});if(n==="prelu")return awe({inputs:{x:e,alpha:r},backend:t});if(n==="leakyrelu")return swe({inputs:{x:e},backend:t,attrs:{alpha:i}});if(n==="sigmoid")return Uce({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ir(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{shape:s}=r,a=Oe(i.shape),o=uae(s,a),l=Oe(o);q(a===l,()=>`The new shape (${o}) has ${l} elements and the old shape (${i.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`),n.incRef(i.dataId);const c=n.data.get(i.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=o,d.shape=o}return{dataId:i.dataId,shape:o,dtype:i.dtype}}const IPt={kernelName:JM,backendName:"cpu",kernelFunc:Ir};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cwe(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:s}=e,{transposeA:a,transposeB:o}=r;Ct([i,s],"matMul");const l=i.shape.length,c=s.shape.length,u=a?i.shape[l-2]:i.shape[l-1],d=o?s.shape[c-1]:s.shape[c-2],h=a?i.shape[l-1]:i.shape[l-2],f=o?s.shape[c-2]:s.shape[c-1],p=i.shape.slice(0,-2),g=s.shape.slice(0,-2),m=Oe(p),y=Oe(g),b=dn(i.shape.slice(0,-2),s.shape.slice(0,-2)).concat([h,f]);q(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${i.shape} and ${s.shape} and transposeA=${a} and transposeB=${o} must match.`);const _=a?[m,u,h]:[m,h,u],T=o?[y,f,d]:[y,d,f],E=Ir({inputs:{x:i},backend:n,attrs:{shape:_}}),C=Ir({inputs:{x:s},backend:n,attrs:{shape:T}}),I=a?E.shape[1]:E.shape[2],A=a?E.shape[2]:E.shape[1],k=o?C.shape[1]:C.shape[2],R=Math.max(m,y),$=n.data.get(E.dataId).values,z=n.data.get(C.dataId).values,O=Ft(E.shape),j=Ft(C.shape),[B,W,L]=a?[O[0],1,O[1]]:[O[0],O[1],1],[V,H,K]=o?[1,j[1],j[0]]:[j[1],1,j[0]],te=A*k,J=yn([R,A,k],E.dtype),oe=J.values,fe=n.blockSize;for(let Ee=0;Ee<R;Ee++){const me=Ee%m,De=Ee%y;for(let ge=0;ge<A;ge+=fe){const _e=Math.min(ge+fe,A);for(let Ce=0;Ce<k;Ce+=fe){const G=Math.min(Ce+fe,k);for(let ke=0;ke<I;ke+=fe){const xe=Math.min(ke+fe,I);for(let Pe=ge;Pe<_e;Pe++)for(let Te=Ce;Te<G;Te++){let Ye=0;for(let qe=ke;qe<xe;qe++){const Q=$[me*B+Pe*W+qe*L],X=z[qe*V+Te*H+De*K];Ye+=Q*X}oe[Ee*te+(Pe*k+Te)]+=Ye}}}}}return n.disposeIntermediateTensorInfo(E),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(b,J.dtype,J.values)}const kPt={kernelName:gM,backendName:"cpu",kernelFunc:cwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MPt(t){const{inputs:e,backend:n,attrs:r}=t,{a:i,b:s,bias:a,preluActivationWeights:o}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=r;let h,f,p;const g=[];h=cwe({inputs:{a:i,b:s},attrs:{transposeA:l,transposeB:c},backend:n}),a&&(f=Qx({inputs:{a:h,b:a},backend:n}),g.push(h),h=f),u&&(p=kk(n,h,u,o,d),g.push(h),h=p);for(const y of g)n.disposeIntermediateTensorInfo(y);return h}const RPt={kernelName:DA,backendName:"cpu",kernelFunc:MPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PPt=cr(U_,t=>Math.acos(t)),OPt={kernelName:U_,backendName:"cpu",kernelFunc:PPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DPt=cr(V_,t=>Math.acosh(t)),$Pt={kernelName:V_,backendName:"cpu",kernelFunc:DPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LPt(t){const{inputs:e,backend:n}=t,r=e;Ct(e,"addN");const i=r.map(o=>n.data.get(o.dataId).values),s=yn(r[0].shape,r[0].dtype),a=s.values;for(let o=0;o<r.length;o++){const l=i[o];for(let c=0;c<a.length;c++)a[c]+=l[c]}return n.makeTensorInfo(s.shape,s.dtype,s.values)}const FPt={kernelName:dM,backendName:"cpu",kernelFunc:LPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jPt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;Ct(i,"all");const o=Nn(s,i.shape);let l=o;const c=Jr(l,i.shape.length);let u=i;c!=null&&(u=Ga({inputs:{x:i},backend:n,attrs:{perm:c}}),l=wi(l.length,i.shape.length)),Ms("all",l,u.shape.length);const[d,h]=fs(u.shape,l),f=Oe(h),p=qs(Oe(d),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let b=g[x];for(let _=0;_<f;++_){const T=g[x+_];b=b&&T}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(d,u.dtype,p);if(a){const y=bi(d,o),x=Ir({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),x}return m}const zPt={kernelName:GU,backendName:"cpu",kernelFunc:jPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;Ct(i,"any");const o=Nn(s,i.shape);let l=o;const c=Jr(l,i.shape.length);let u=i;c!=null&&(u=Ga({inputs:{x:i},backend:n,attrs:{perm:c}}),l=wi(l.length,i.shape.length)),Ms("any",l,u.shape.length);const[d,h]=fs(u.shape,l),f=Oe(h),p=qs(Oe(d),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let b=g[x];for(let _=0;_<f;++_){const T=g[x+_];b=b||T}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(d,u.dtype,p);if(a){const y=bi(d,o),x=Ir({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),x}return m}const UPt={kernelName:qU,backendName:"cpu",kernelFunc:BPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VPt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s}=r;Ct(i,"argMax");let a=Nn(s,i.shape);const o=Jr(a,i.shape.length);let l=i;const c=[];o!=null&&(l=Ga({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),a=wi(a.length,l.shape.length)),a=[a[0]],Ms("argMax",a,l.shape.length);const[u,d]=fs(l.shape,a),h=Oe(u),f=qs(h,"int32"),p=Oe(d),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const y=m*p;let x=g[y],b=0;for(let _=0;_<p;++_){const T=g[y+_];T>x&&(x=T,b=_)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const WPt={kernelName:hM,backendName:"cpu",kernelFunc:VPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HPt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s}=r;Ct(i,"argMin");let a=Nn(s,i.shape);const o=Jr(a,i.shape.length);let l=i;const c=[];o!=null&&(l=Ga({inputs:{x:i},backend:n,attrs:{perm:o}}),c.push(l),a=wi(a.length,l.shape.length)),a=[a[0]],Ms("argMin",a,l.shape.length);const[u,d]=fs(l.shape,a),h=Oe(u),f=qs(h,"int32"),p=Oe(d),g=n.data.get(l.dataId).values;for(let m=0;m<f.length;++m){const y=m*p;let x=g[y],b=0;for(let _=0;_<p;++_){const T=g[y+_];T<x&&(x=T,b=_)}f[m]=b}return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),n.makeTensorInfo(u,"int32",f)}const GPt={kernelName:fM,backendName:"cpu",kernelFunc:HPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qPt=cr(W_,t=>Math.asin(t)),XPt={kernelName:W_,backendName:"cpu",kernelFunc:qPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KPt=cr(H_,t=>Math.asinh(t)),YPt={kernelName:H_,backendName:"cpu",kernelFunc:KPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZPt=cr(G_,t=>Math.atan(t)),QPt={kernelName:G_,backendName:"cpu",kernelFunc:ZPt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JPt=Si((t,e)=>Math.atan2(t,e)),eOt=Zi(X_,JPt),tOt={kernelName:X_,backendName:"cpu",kernelFunc:eOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nOt=cr(q_,t=>Math.atanh(t)),rOt={kernelName:q_,backendName:"cpu",kernelFunc:nOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(t,e,n,r,i,s){const a=i.strideHeight,o=i.strideWidth,l=i.dilationHeight,c=i.dilationWidth,u=i.effectiveFilterHeight,d=i.effectiveFilterWidth,h=i.padInfo.top,f=i.padInfo.left,p=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,g=yn(i.outShape,n),m=g.values,y=i.outShape[1]*i.outShape[2]*i.outShape[3],x=i.outShape[2]*i.outShape[3],b=i.outShape[3];for(let _=0;_<i.batchSize;++_){const T=_*y,E=_*r[0];for(let C=0;C<i.inChannels;++C)for(let I=0;I<i.outHeight;++I){const A=I*a-h,k=Math.max(0,A),R=Math.min(i.inHeight,u+A),$=T+I*x;for(let z=0;z<i.outWidth;++z){const O=z*o-f,j=Math.max(0,O),B=Math.min(i.inWidth,d+O);let W=p,L=0,V=0;for(let K=k;K<R;K+=l){const te=E+K*r[1];for(let J=j;J<B;J+=c){const oe=te+J*r[2],fe=t[oe+C];s==="max"&&fe>W?W=fe:s==="avg"&&(L+=fe,V++)}if(isNaN(W))break}const H=$+z*b+C;m[H]=s==="avg"?L/V:W}}}return g}function uwe(t,e,n,r,i=!1,s=!1){const a=yn(r.outShape,"int32"),o=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,d=r.effectiveFilterHeight,h=r.effectiveFilterWidth,f=r.padInfo.top,p=r.padInfo.left,g=yn(e,n,t);for(let m=0;m<r.batchSize;++m)for(let y=0;y<r.inChannels;++y)for(let x=0;x<r.outHeight;++x){const b=x*o-f;let _=b;for(;_<0;)_+=c;const T=Math.min(r.inHeight,d+b);for(let E=0;E<r.outWidth;++E){const C=E*l-p;let I=C;for(;I<0;)I+=u;const A=Math.min(r.inWidth,h+C);let k=Number.NEGATIVE_INFINITY,R=-1;for(let $=_;$<T;$+=c){const z=$-b;for(let O=I;O<A;O+=u){const j=O-C,B=g.get(m,$,O,y);B>k&&(k=B,i?R=s?((m*r.inHeight+$)*r.inWidth+O)*r.inChannels+y:($*r.inWidth+O)*r.inChannels+y:R=z*h+j)}}a.set(R,m,x,E,y)}}return a}function dwe(t,e,n,r,i,s){const a=i.strideDepth,o=i.strideHeight,l=i.strideWidth,c=i.dilationDepth,u=i.dilationHeight,d=i.dilationWidth,h=i.effectiveFilterDepth,f=i.effectiveFilterHeight,p=i.effectiveFilterWidth,g=i.padInfo.front,m=i.padInfo.top,y=i.padInfo.left,x=s==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=yn(i.outShape,n),_=b.values,T=i.outShape[1]*i.outShape[2]*i.outShape[3]*i.outShape[4],E=i.outShape[2]*i.outShape[3]*i.outShape[4],C=i.outShape[3]*i.outShape[4],I=i.outShape[4];for(let A=0;A<i.batchSize;++A){const k=A*T,R=A*r[0];for(let $=0;$<i.inChannels;++$)for(let z=0;z<i.outDepth;++z){const O=z*a-g;let j=O;for(;j<0;)j+=c;const B=Math.min(i.inDepth,h+O),W=k+z*E;for(let L=0;L<i.outHeight;++L){const V=L*o-m;let H=V;for(;H<0;)H+=u;const K=Math.min(i.inHeight,f+V),te=W+L*C;for(let J=0;J<i.outWidth;++J){const oe=J*l-y;let fe=oe;for(;fe<0;)fe+=d;const Ee=Math.min(i.inWidth,p+oe),me=te+J*I;let De=x,ge=0,_e=0;for(let G=j;G<B;G+=c){const ke=R+G*r[1];for(let xe=H;xe<K;xe+=u){const Pe=ke+xe*r[2];for(let Te=fe;Te<Ee;Te+=d){const Ye=Pe+Te*r[3],qe=t[Ye+$];if(s==="max"&&qe>De?De=qe:s==="avg"&&(ge+=qe,_e++),isNaN(De))break}if(isNaN(De))break}if(isNaN(De))break}const Ce=me+$;_[Ce]=s==="avg"?ge/Math.max(_e,1):De}}}}return b}function iOt(t,e){const n=yn(e.outShape,"int32"),r=e.strideDepth,i=e.strideHeight,s=e.strideWidth,a=e.dilationDepth,o=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let g=0;g<e.batchSize;++g)for(let m=0;m<e.inChannels;++m)for(let y=0;y<e.outDepth;++y){const x=y*r-h;let b=x;for(;b<0;)b+=a;const _=Math.min(e.inDepth,c+x);for(let T=0;T<e.outHeight;++T){const E=T*i-f;let C=E;for(;C<0;)C+=o;const I=Math.min(e.inHeight,u+E);for(let A=0;A<e.outWidth;++A){const k=A*s-p;let R=k;for(;R<0;)R+=l;const $=Math.min(e.inWidth,d+k);let z=Number.NEGATIVE_INFINITY,O=-1;for(let j=b;j<_;j+=a){const B=j-x;for(let W=C;W<I;W+=o){const L=W-E;for(let V=R;V<$;V+=l){const H=V-k,K=t.get(g,j,W,V,m);K>=z&&(z=K,O=B*u*d+L*u+H)}}}n.set(O,g,y,T,A,m)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Ct(i,"avgPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,c=1;q(ks(a,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Zl(i.shape,s,a,c,o,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Pn(u.inShape,u.outShape))d=qu({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,f=Ft(i.shape),p=S6(h,i.shape,i.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,i.dtype,p.values)}return d}const aOt={kernelName:pM,backendName:"cpu",kernelFunc:sOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r;Ct(i,"avgPool3d");const u=gh(i.shape,s,a,1,o,l,c),d=n.data.get(i.dataId).values,h=dwe(d,i.shape,i.dtype,Ft(i.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const lOt={kernelName:mM,backendName:"cpu",kernelFunc:oOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cOt(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=r;Ct([i,s],"avgPool3DGrad");const u=gh(s.shape,a,o,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,g=u.filterHeight,m=u.filterWidth,y=u.dilationDepth,x=u.dilationHeight,b=u.dilationWidth,_=u.effectiveFilterDepth,T=u.effectiveFilterHeight,E=u.effectiveFilterWidth,C=_-1-u.padInfo.front,I=E-1-u.padInfo.left,A=T-1-u.padInfo.top,k=yn(s.shape,"float32"),R=1/(p*g*m),$=n.bufferSync(i);for(let z=0;z<u.batchSize;++z)for(let O=0;O<u.inChannels;++O)for(let j=0;j<u.inDepth;++j)for(let B=0;B<u.inHeight;++B)for(let W=0;W<u.inWidth;++W){const L=j-C,V=B-A,H=W-I;let K=0;for(let te=0;te<_;te+=y){const J=(L+te)/d;if(!(J<0||J>=u.outDepth||Math.floor(J)!==J))for(let oe=0;oe<T;oe+=x){const fe=(V+oe)/h;if(!(fe<0||fe>=u.outHeight||Math.floor(fe)!==fe))for(let Ee=0;Ee<E;Ee+=b){const me=(H+Ee)/f;if(me<0||me>=u.outWidth||Math.floor(me)!==me)continue;const De=$.get(z,J,fe,me,O);K+=De}}}k.set(K*R,z,j,B,W,O)}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const uOt={kernelName:KU,backendName:"cpu",kernelFunc:cOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dOt(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,a=s;Ct([i,s],"avgPoolGrad");const{filterSize:o,strides:l,pad:c}=r,u=Zl(a.shape,o,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,g=u.dilationHeight,m=u.dilationWidth,y=u.effectiveFilterHeight,x=u.effectiveFilterWidth,b=x-1-u.padInfo.left,_=y-1-u.padInfo.top,T=yn(a.shape,"float32"),E=1/(f*p),C=n.data.get(i.dataId).values,I=yn(i.shape,"float32",C);for(let A=0;A<u.batchSize;++A)for(let k=0;k<u.inChannels;++k)for(let R=0;R<u.inHeight;++R)for(let $=0;$<u.inWidth;++$){const z=R-_,O=$-b;let j=0;for(let B=0;B<y;B+=g){const W=(z+B)/d;if(!(W<0||W>=u.outHeight||Math.floor(W)!==W))for(let L=0;L<x;L+=m){const V=(O+L)/h;if(V<0||V>=u.outWidth||Math.floor(V)!==V)continue;const H=I.get(A,W,V,k);j+=H}}T.set(j*E,A,R,$,k)}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const hOt={kernelName:XU,backendName:"cpu",kernelFunc:dOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,scale:s,offset:a,mean:o,variance:l}=e;q(o.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),q(a==null||o.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),q(s==null||o.shape.length===s.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ct([i,o,l,s,a],"batchNorm");let{varianceEpsilon:c}=r;c==null&&(c=.001);const u=n.data.get(i.dataId).values,d=n.data.get(o.dataId).values,h=n.data.get(l.dataId).values,f=s?n.data.get(s.dataId).values:new Float32Array([1]),p=a?n.data.get(a.dataId).values:new Float32Array([0]),g=new Float32Array(u.length),m=p.length,y=f.length,x=h.length,b=d.length;let _=0,T=0,E=0,C=0;for(let I=0;I<u.length;++I)g[I]=p[_++]+(u[I]-d[T++])*f[E++]/Math.sqrt(h[C++]+c),_>=m&&(_=0),T>=b&&(T=0),E>=y&&(E=0),C>=x&&(C=0);return n.makeTensorInfo(i.shape,i.dtype,g)}const pOt={kernelName:IM,backendName:"cpu",kernelFunc:fOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:s,crops:a}=r;Ct([i],"batchToSpaceND");const o=s.reduce((y,x)=>y*x),l=HT(i.shape,s,o),c=GT(l.length,s.length),u=qT(i.shape,s,o),d=r5(a,s.length),h=i5(u,a,s.length),f=Ir({inputs:{x:i},backend:n,attrs:{shape:l}}),p=Ga({inputs:{x:f},backend:n,attrs:{perm:c}}),g=Ir({inputs:{x:p},backend:n,attrs:{shape:u}}),m=Cg({inputs:{x:g},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const gOt={kernelName:yM,backendName:"cpu",kernelFunc:mOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:s}=e,{size:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=T5(o,l,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,c)}const vOt={kernelName:YU,backendName:"cpu",kernelFunc:yOt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xOt(t){const{inputs:e,backend:n}=t,{s0:r,s1:i}=e,s=n.data.get(r.dataId).values,a=n.data.get(i.dataId).values,o=dn(Array.from(s),Array.from(a));return n.makeTensorInfo([o.length],"int32",Int32Array.from(o))}const bOt={kernelName:ZU,backendName:"cpu",kernelFunc:xOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wOt=cr(Z_,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),SOt={kernelName:Z_,backendName:"cpu",kernelFunc:wOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ot=t=>{const{x:e}=t.inputs,n=t.backend,r=new Float32Array(Oe(e.shape)),i=n.data.get(e.dataId),s=i.complexTensorInfos.real,a=i.complexTensorInfos.imag,o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values;for(let c=0;c<o.length;c++){const u=o[c],d=l[c];r[c]=Math.hypot(u,d)}return n.makeOutput(r,e.shape,"float32")},TOt={kernelName:xM,backendName:"cpu",kernelFunc:_Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O0(t){const{inputs:e,backend:n}=t,{input:r}=e,i=n.data.get(r.dataId).complexTensorInfos.imag,s=n.data.get(i.dataId).values;return n.makeTensorInfo(i.shape,i.dtype,s)}const EOt={kernelName:gV,backendName:"cpu",kernelFunc:O0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D0(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r,s=Nn(i,e[0].shape)[0],a=e.map(g=>g.shape);e5(a,s);let o=Du(e.map(g=>g.shape),s);if(Oe(o)===0)return n.makeTensorInfo(o,e[0].dtype,[]);const l=e.filter(g=>Oe(g.shape)>0);if(l.length===1)return qu({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const g=l.map(_=>Eg({inputs:{input:_},backend:n})),m=l.map(_=>O0({inputs:{input:_},backend:n})),y=D0({inputs:g,backend:n,attrs:{axis:s}}),x=D0({inputs:m,backend:n,attrs:{axis:s}}),b=lo({inputs:{real:y,imag:x},backend:n});return g.forEach(_=>n.disposeIntermediateTensorInfo(_)),m.forEach(_=>n.disposeIntermediateTensorInfo(_)),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),b}const c=l.map(g=>{const y=[-1,Oe(g.shape.slice(s))];return Ir({inputs:{x:g},backend:n,attrs:{shape:y}})}),u=c.map(g=>({vals:n.data.get(g.dataId).values,shape:g.shape}));o=Du(c.map(g=>g.shape),1);const d=c[0].shape[0]===1,h=mce(u,o,e[0].dtype,d),f=Du(l.map(g=>g.shape),s),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(g=>n.disposeIntermediateTensorInfo(g)),p}const COt={kernelName:bM,backendName:"cpu",kernelFunc:D0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dataFormat:l,dilations:c,dimRoundingMode:u}=r;Ct([i,s],"conv2d");const d=yh(l),h=hs(i.shape,s.shape,a,c,o,u,!1,d),f=h.filterHeight,p=h.filterWidth,g=h.dilationHeight,m=h.dilationWidth,y=h.padInfo.left,x=h.padInfo.top,b=h.dataFormat==="channelsLast",_=new Hi(h.outShape,i.dtype),T=Ft(i.shape),E=Ft(s.shape),C=T[0],I=b?T[1]:T[2],A=b?T[2]:1,k=b?1:T[1],R=_.strides[0],$=b?_.strides[1]:_.strides[2],z=b?_.strides[2]:1,O=b?1:_.strides[1],j=n.data.get(i.dataId).values,B=n.data.get(s.dataId).values,W=_.values;for(let L=0;L<h.batchSize;++L){const V=L*C,H=L*R;for(let K=0;K<h.outHeight;++K){const te=H+K*$,J=K*h.strideHeight-x;for(let oe=0;oe<f;++oe){const fe=J+oe*g;if(fe<0||fe>=h.inHeight)continue;const Ee=oe*E[0],me=V+fe*I;for(let De=0;De<h.outWidth;++De){const ge=te+De*z,_e=De*h.strideWidth-y;for(let Ce=0;Ce<p;++Ce){const G=_e+Ce*m;if(G<0||G>=h.inWidth)continue;const ke=Ee+Ce*E[1],xe=me+G*A;let Pe=ke;for(let Te=0;Te<h.inChannels;++Te){const Ye=j[xe+Te*k];for(let qe=0;qe<h.outChannels;++qe)W[ge+qe*O]+=Ye*B[Pe+qe];Pe+=h.outChannels}}}}}}return n.makeTensorInfo(_.shape,_.dtype,W)}const NOt={kernelName:wM,backendName:"cpu",kernelFunc:hwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,pad:o,dataFormat:l,dimRoundingMode:c,filterShape:u}=r;Ct([i,s],"conv2dBackpropFilter");const d=yh(l),h=hs(i.shape,u,a,1,o,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:g,filterWidth:m}=h,y=h.dataFormat==="channelsLast",x=new Hi(h.filterShape,"float32"),b=h.padInfo.left,_=h.padInfo.top,T=n.data.get(i.dataId).values,E=n.data.get(s.dataId).values,C=new Hi(i.shape,i.dtype,T),I=new Hi(s.shape,s.dtype,E);for(let A=0;A<g;++A){const k=Math.max(0,Math.ceil((_-A)/f)),R=Math.min(h.outHeight,(h.inHeight+_-A)/f);for(let $=0;$<m;++$){const z=Math.max(0,Math.ceil((b-$)/p)),O=Math.min(h.outWidth,(h.inWidth+b-$)/p);for(let j=0;j<h.inChannels;++j)for(let B=0;B<h.outChannels;++B){let W=0;for(let L=0;L<h.batchSize;++L)for(let V=k;V<R;++V){const H=A+V*f-_;for(let K=z;K<O;++K){const te=$+K*p-b;y?W+=C.get(L,H,te,j)*I.get(L,V,K,B):W+=C.get(L,j,H,te)*I.get(L,B,V,K)}}x.set(W,A,$,j,B)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const IOt={kernelName:JU,backendName:"cpu",kernelFunc:AOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kOt(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{inputShape:a,strides:o,pad:l,dataFormat:c,dimRoundingMode:u}=r;Ct([i,s],"conv2dBackpropInput");const d=Ft(s.shape),h=Ft(i.shape);let f=yh(c);const p=hs(a,s.shape,o,1,l,u,!1,f),g=new Hi(p.inShape,"float32"),m=g.values,y=n.data.get(i.dataId).values,x=n.data.get(s.dataId).values,[b,_,T]=d,{batchSize:E,filterHeight:C,filterWidth:I,inChannels:A,inHeight:k,inWidth:R,outChannels:$,outHeight:z,outWidth:O,strideHeight:j,strideWidth:B}=p;f=p.dataFormat;const W=C-1-p.padInfo.top,L=I-1-p.padInfo.left,V=f==="channelsLast",H=g.strides[0],K=V?g.strides[1]:g.strides[2],te=V?g.strides[2]:1,J=V?1:g.strides[1],oe=h[0],fe=V?h[1]:h[2],Ee=V?h[2]:1,me=V?1:h[1];for(let De=0;De<E;++De)for(let ge=0;ge<A;++ge)for(let _e=0;_e<k;++_e){const Ce=_e-W,G=Math.max(0,Math.ceil(Ce/j)),ke=Math.min(z,(C+Ce)/j);for(let xe=0;xe<R;++xe){const Pe=xe-L,Te=Math.max(0,Math.ceil(Pe/B)),Ye=Math.min(O,(I+Pe)/B);let qe=0;for(let X=G;X<ke;++X){const we=X*j-Ce;for(let Z=Te;Z<Ye;++Z){const ie=Z*B-Pe,ae=oe*De+fe*X+Ee*Z,Le=b*(C-1-we)+_*(I-1-ie)+T*ge;for(let Ae=0;Ae<$;++Ae){const Ie=y[ae+me*Ae],Ge=x[Le+Ae];qe+=Ie*Ge}}}const Q=H*De+K*_e+te*xe+J*ge;m[Q]=qe}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const MOt={kernelName:SM,backendName:"cpu",kernelFunc:kOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ROt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dilations:l}=r;Ct([i,s],"conv3d");const c=mp(i.shape,s.shape,a,l,o),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:g,padInfo:m}=c,y=m.front,x=m.left,b=m.top,_=new Hi(c.outShape,i.dtype),T=n.data.get(i.dataId).values,E=n.data.get(s.dataId).values,C=_.values,I=Ft(i.shape),A=Ft(s.shape);for(let k=0;k<c.batchSize;++k){const R=k*I[0],$=k*_.strides[0];for(let z=0;z<c.outDepth;++z){const O=$+z*_.strides[1],j=z*c.strideDepth-y;for(let B=0;B<u;++B){const W=j+B*f;if(W<0||W>=c.inDepth)continue;const L=B*A[0],V=R+W*I[1];for(let H=0;H<c.outHeight;++H){const K=O+H*_.strides[2],te=H*c.strideHeight-b;for(let J=0;J<d;++J){const oe=te+J*p;if(oe<0||oe>=c.inHeight)continue;const fe=L+J*A[1],Ee=V+oe*I[2];for(let me=0;me<c.outWidth;++me){const De=K+me*c.outChannels,ge=me*c.strideWidth-x;for(let _e=0;_e<h;++_e){const Ce=ge+_e*g;if(Ce<0||Ce>=c.inWidth)continue;const G=fe+_e*A[2],ke=Ee+Ce*c.inChannels;let xe=G;for(let Pe=0;Pe<c.inChannels;++Pe){const Te=T[ke+Pe];for(let Ye=0;Ye<c.outChannels;++Ye)C[De+Ye]+=Te*E[xe+Ye];xe+=c.outChannels}}}}}}}}return n.makeTensorInfo(_.shape,_.dtype,_.values)}const POt={kernelName:_M,backendName:"cpu",kernelFunc:ROt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,pad:o,filterShape:l}=r;Ct([i,s],"conv3dBackpropFilterV2");const c=Ft(i.shape),u=Ft(s.shape),d=mp(i.shape,l,a,1,o),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,g=d.filterDepth,m=d.filterHeight,y=d.filterWidth,x=new Hi(d.filterShape,"float32"),b=x.values,[_,T,E,C]=x.strides,I=n.data.get(s.dataId).values,[A,k,R,$]=u,z=n.data.get(i.dataId).values,[O,j,B,W]=c,L=d.padInfo.front,V=d.padInfo.left,H=d.padInfo.top;for(let K=0;K<g;++K){const te=Math.max(0,Math.ceil((L-K)/h)),J=Math.min(d.outDepth,(d.inDepth+L-K)/h),oe=K*_;for(let fe=0;fe<m;++fe){const Ee=Math.max(0,Math.ceil((H-fe)/f)),me=Math.min(d.outHeight,(d.inHeight+H-fe)/f),De=fe*T+oe;for(let ge=0;ge<y;++ge){const _e=Math.max(0,Math.ceil((V-ge)/p)),Ce=Math.min(d.outWidth,(d.inWidth+V-ge)/p),G=ge*E+De;for(let ke=0;ke<d.inChannels;++ke){const xe=ke*C+G;for(let Pe=0;Pe<d.outChannels;++Pe){let Te=0;for(let Ye=0;Ye<d.batchSize;++Ye){const qe=Ye*O,Q=Ye*A;for(let X=te;X<J;++X){const Z=(K+X*h-L)*j+qe,ie=X*k+Q;for(let ae=Ee;ae<me;++ae){const Ae=(fe+ae*f-H)*B+Z,Ie=ae*R+ie;for(let Ge=_e;Ge<Ce;++Ge){const We=(ge+Ge*p-V)*W+Ae,Ut=Ge*$+Ie;Te+=z[We+ke]*I[Ut+Pe]}}}}b[xe+Pe]=Te}}}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const DOt={kernelName:eV,backendName:"cpu",kernelFunc:OOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ot(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{pad:a,strides:o,inputShape:l}=r;Ct([i],"conv3dBackpropInputV2");const c=Ft(i.shape),u=Ft(s.shape),d=mp(l,s.shape,o,1,a),h=new Hi(d.inShape,"float32"),f=h.values,[p,g,m,y]=h.strides,x=n.data.get(i.dataId).values,[b,_,T,E]=c,C=n.data.get(s.dataId).values,[I,A,k,R]=u,{batchSize:$,filterDepth:z,filterHeight:O,filterWidth:j,inChannels:B,inDepth:W,inHeight:L,inWidth:V,outChannels:H,outDepth:K,outHeight:te,outWidth:J,strideDepth:oe,strideHeight:fe,strideWidth:Ee}=d,me=z-1-d.padInfo.front,De=O-1-d.padInfo.top,ge=j-1-d.padInfo.left;for(let _e=0;_e<$;++_e)for(let Ce=0;Ce<B;++Ce)for(let G=0;G<W;++G){const ke=G-me,xe=Math.max(0,Math.ceil(ke/oe)),Pe=Math.min(K,(z+ke)/oe);for(let Te=0;Te<L;++Te){const Ye=Te-De,qe=Math.max(0,Math.ceil(Ye/fe)),Q=Math.min(te,(O+Ye)/fe);for(let X=0;X<V;++X){const we=X-ge,Z=Math.max(0,Math.ceil(we/Ee)),ie=Math.min(J,(j+we)/Ee);let ae=0;for(let Le=xe;Le<Pe;++Le){const Ae=Le*oe-ke;for(let Ie=qe;Ie<Q;++Ie){const Ge=Ie*fe-Ye;for(let rt=Z;rt<ie;++rt){const We=rt*Ee-we,Ut=b*_e+_*Le+T*Ie+E*rt,hn=I*(z-1-Ae)+A*(O-1-Ge)+k*(j-1-We)+R*Ce;for(let Vt=0;Vt<H;++Vt){const Ot=x[Ut+Vt],bt=C[hn+Vt];ae+=Ot*bt}}}}f[p*_e+g*G+m*Te+y*X+Ce]=ae}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const LOt={kernelName:tV,backendName:"cpu",kernelFunc:$Ot};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FOt=cr(Q_,t=>Math.cos(t)),jOt={kernelName:Q_,backendName:"cpu",kernelFunc:FOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zOt=cr(J_,t=>Math.cosh(t)),BOt={kernelName:J_,backendName:"cpu",kernelFunc:zOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UOt(t){const{inputs:e,backend:n,attrs:r}=t,{image:i,boxes:s,boxInd:a}=e,{cropSize:o,method:l,extrapolationValue:c}=r,[u,d,h,f]=i.shape,p=s.shape[0],[g,m]=o,y=yn([p,g,m,f],"float32"),x=n.data.get(s.dataId).values,b=n.data.get(a.dataId).values,_=n.data.get(i.dataId).values,T=Ft(i.shape),E=Ft(y.shape);for(let C=0;C<p;C++){const I=C*4,A=x[I],k=x[I+1],R=x[I+2],$=x[I+3],z=b[C];if(z>=u)continue;const O=g>1?(R-A)*(d-1)/(g-1):0,j=m>1?($-k)*(h-1)/(m-1):0;for(let B=0;B<g;B++){const W=g>1?A*(d-1)+B*O:.5*(A+R)*(d-1);if(W<0||W>d-1){for(let L=0;L<m;L++)for(let V=0;V<f;V++){const H=V+L*E[2]+B*E[1]+C*E[0];y.values[H]=c}continue}if(l==="bilinear"){const L=Math.floor(W),V=Math.ceil(W),H=W-L;for(let K=0;K<m;K++){const te=m>1?k*(h-1)+K*j:.5*(k+$)*(h-1);if(te<0||te>h-1){for(let Ee=0;Ee<f;Ee++){const me=Ee+K*E[2]+B*E[1]+C*E[0];y.values[me]=c}continue}const J=Math.floor(te),oe=Math.ceil(te),fe=te-J;for(let Ee=0;Ee<f;Ee++){let me=Ee+J*T[2]+L*T[1]+z*T[0];const De=_[me];me=Ee+oe*T[2]+L*T[1]+z*T[0];const ge=_[me];me=Ee+J*T[2]+V*T[1]+z*T[0];const _e=_[me];me=Ee+oe*T[2]+V*T[1]+z*T[0];const Ce=_[me],G=De+(ge-De)*fe,ke=_e+(Ce-_e)*fe;me=Ee+K*E[2]+B*E[1]+C*E[0],y.values[me]=G+(ke-G)*H}}}else for(let L=0;L<m;++L){const V=m>1?k*(h-1)+L*j:.5*(k+$)*(h-1);if(V<0||V>h-1){for(let te=0;te<f;te++){const J=te+L*E[2]+B*E[1]+C*E[0];y.values[J]=c}continue}const H=Math.round(V),K=Math.round(W);for(let te=0;te<f;te++){const J=te+H*T[2]+K*T[1]+z*T[0],oe=te+L*E[2]+B*E[1]+C*E[0];y.values[oe]=_[J]}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const VOt={kernelName:rV,backendName:"cpu",kernelFunc:UOt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,exclusive:a,reverse:o}=r;Ct(i,"cumprod");const l=Jr([s],i.shape.length);let c=i;l!=null&&(c=Ga({inputs:{x:i},backend:n,attrs:{perm:l}}));const u=wi(1,i.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=bo(c.dtype,"int32"),h=WU(Oe(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=o?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const b=g(y,x);if(x===0)h[b]=a?1:f[b];else{const _=g(y,x-1);h[b]=a?f[_]*h[_]:f[b]*h[_]}}const m=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=gp(l),x=Ga({inputs:{x:m},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),x}return m}const HOt={kernelName:nV,backendName:"cpu",kernelFunc:WOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,exclusive:a,reverse:o}=r;Ct(i,"cumsum");const l=Jr([s],i.shape.length);let c=i;l!=null&&(c=Ga({inputs:{x:i},backend:n,attrs:{perm:l}}));const u=wi(1,i.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=bo(c.dtype,"int32"),h=qs(Oe(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],g=o?(y,x)=>y+p-x-1:(y,x)=>y+x;for(let y=0;y<f.length;y+=p)for(let x=0;x<p;x++){const b=g(y,x);if(x===0)h[b]=a?0:f[b];else{const _=g(y,x-1);h[b]=a?f[_]+h[_]:f[b]+h[_]}}const m=n.makeTensorInfo(c.shape,d,h);if(l!=null){const y=gp(l),x=Ga({inputs:{x:m},backend:n,attrs:{perm:y}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(c),x}return m}const qOt={kernelName:TM,backendName:"cpu",kernelFunc:GOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,weights:s}=e,{size:a,binaryOutput:o}=r;if(i.shape.length===1){const l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,u=T5(l,c,s.dtype,s.shape,a);return n.makeTensorInfo([a],s.dtype,u)}else if(i.shape.length===2){const l=n.bufferSync(i),c=n.bufferSync(s),u=hce(l,c,a,o);return n.makeTensorInfo(u.shape,s.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${i.shape.length}.`)}const KOt={kernelName:iV,backendName:"cpu",kernelFunc:XOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockSize:s,dataFormat:a}=r;q(a==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${a}`);const o=i.shape[0],l=i.shape[1],c=i.shape[2],u=i.shape[3],d=l*s,h=c*s,f=u/(s*s),p=n.data.get(i.dataId).values,g=new Float32Array(o*d*h*f);let m=0;for(let y=0;y<o;++y)for(let x=0;x<d;++x){const b=Math.floor(x/s),_=x%s;for(let T=0;T<h;++T){const E=Math.floor(T/s),C=T%s,I=(_*s+C)*f;for(let A=0;A<f;++A){const R=A+I+u*(E+c*(b+l*y));g[m++]=p[R]}}}return n.makeTensorInfo([o,d,h,f],i.dtype,g)}const ZOt={kernelName:sV,backendName:"cpu",kernelFunc:YOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s}=e,{strides:a,pad:o,dilations:l,dimRoundingMode:c}=r;Ct([i,s],"depthwiseConv2DNative");const u=Ft(i.shape),d=Ft(s.shape);let h=l;h==null&&(h=[1,1]),q(ks(a,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${a} and dilations '${h}'`);const f=hs(i.shape,s.shape,a,h,o,c,!0),{filterHeight:p,filterWidth:g,dilationHeight:m,dilationWidth:y,padInfo:x}=f,b=x.left,_=x.top,T=f.outChannels/f.inChannels,E=new Hi(f.outShape,i.dtype),C=n.data.get(i.dataId).values,I=n.data.get(s.dataId).values,A=E.values;for(let k=0;k<f.batchSize;++k){const R=k*u[0],$=k*E.strides[0];for(let z=0;z<f.outHeight;++z){const O=$+z*E.strides[1],j=z*f.strideHeight-_;for(let B=0;B<p;++B){const W=j+B*m;if(W<0||W>=f.inHeight)continue;const L=B*d[0],V=R+W*u[1];for(let H=0;H<f.outWidth;++H){const K=O+H*E.strides[2],te=H*f.strideWidth-b;for(let J=0;J<g;++J){const oe=te+J*y;if(oe<0||oe>=f.inWidth)continue;const fe=L+J*d[1],Ee=V+oe*f.inChannels;let me=K,De=fe;for(let ge=0;ge<f.inChannels;++ge){const _e=C[Ee+ge];for(let Ce=0;Ce<T;++Ce)A[me+Ce]+=_e*I[De+Ce];me+=T,De+=T}}}}}}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const QOt={kernelName:EM,backendName:"cpu",kernelFunc:fwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JOt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,dy:s}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,filterShape:u}=r;Ct([i,s],"depthwiseConv2dNativeBackpropFilter");const d=hs(i.shape,u,a,o,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:g}=d,m=new Hi(d.filterShape,"float32"),y=d.padInfo.left,x=d.padInfo.top,b=d.outChannels/d.inChannels,_=n.data.get(i.dataId).values,T=new Hi(i.shape,i.dtype,_),E=n.data.get(s.dataId).values,C=new Hi(s.shape,s.dtype,E);for(let I=0;I<p;++I){const A=Math.max(0,Math.ceil((x-I)/h)),k=Math.min(d.outHeight,(d.inHeight+x-I)/h);for(let R=0;R<g;++R){const $=Math.max(0,Math.ceil((y-R)/f)),z=Math.min(d.outWidth,(d.inWidth+y-R)/f);for(let O=0;O<d.outChannels;++O){const j=Math.trunc(O/b),B=O%b;let W=0;for(let L=0;L<d.batchSize;++L)for(let V=A;V<k;++V){const H=I+V*h-x;for(let K=$;K<z;++K){const te=R+K*f-y;W+=T.get(L,H,te,j)*C.get(L,V,K,O)}}m.set(W,I,R,j,B)}}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const eDt={kernelName:aV,backendName:"cpu",kernelFunc:JOt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tDt(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,filter:s}=e,{strides:a,dilations:o,pad:l,dimRoundingMode:c,inputShape:u}=r;Ct([i,s],"depthwiseConv2DNativeBackpropInput");const d=Ft(i.shape),h=Ft(s.shape),f=hs(u,s.shape,a,o,l,c,!0),p=new Hi(f.inShape,"float32"),g=p.values,[m,y,x]=p.strides,b=n.data.get(i.dataId).values,[_,T,E]=d,C=n.data.get(s.dataId).values,[I,A,k]=h,{batchSize:R,filterHeight:$,filterWidth:z,inChannels:O,inHeight:j,inWidth:B,outChannels:W,outHeight:L,outWidth:V,strideHeight:H,strideWidth:K}=f,te=$-1-f.padInfo.top,J=z-1-f.padInfo.left,oe=W/O;for(let fe=0;fe<R;++fe)for(let Ee=0;Ee<O;++Ee)for(let me=0;me<j;++me){const De=me-te,ge=Math.max(0,Math.ceil(De/H)),_e=Math.min(L,($+De)/H);for(let Ce=0;Ce<B;++Ce){const G=Ce-J,ke=Math.max(0,Math.ceil(G/K)),xe=Math.min(V,(z+G)/K);let Pe=0;for(let Te=ge;Te<_e;++Te){const Ye=Te*H-De;for(let qe=ke;qe<xe;++qe){const Q=qe*K-G,X=_*fe+T*Te+E*qe,we=I*($-1-Ye)+A*(z-1-Q)+k*Ee;for(let Z=0;Z<oe;++Z){const ie=Ee*oe+Z,ae=b[X+ie],Le=C[we+Z];Pe+=ae*Le}}}g[m*fe+y*me+x*Ce+Ee]=Pe}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const nDt={kernelName:oV,backendName:"cpu",kernelFunc:tDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDt(t){const{inputs:e,backend:n}=t,{x:r}=e,i=Oe(r.shape),s=n.data.get(r.dataId).values,a=yn([i,i],r.dtype),o=a.values;for(let c=0;c<s.length;c++)o[c*i+c]=s[c];const l=[...r.shape,...r.shape];return n.makeTensorInfo(l,a.dtype,a.values)}const iDt={kernelName:lV,backendName:"cpu",kernelFunc:rDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sDt={kernelName:CM,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i}=t,{strides:s,pad:a,dilations:o}=n,l=e,c=l.data.get(r.dataId).values,u=r.shape.length,d=l.data.get(i.dataId).values,h=i.shape.length,{batchSize:f,inHeight:p,inWidth:g,inChannels:m,outHeight:y,outWidth:x,padInfo:b,strideHeight:_,strideWidth:T,filterHeight:E,filterWidth:C,dilationHeight:I,dilationWidth:A,outShape:k}=FT(r.shape,i.shape,s,a,"NHWC",o),R=Oe(k),$=k.length,z=xi(r.dtype,R);for(let j=0;j<f;++j)for(let B=0;B<y;++B){const W=B*_-b.top;for(let L=0;L<x;++L){const V=L*T-b.left;for(let H=0;H<m;++H){let K=Number.MIN_SAFE_INTEGER;for(let J=0;J<E;++J){const oe=W+J*I;if(oe>=0&&oe<p)for(let fe=0;fe<C;++fe){const Ee=V+fe*A;if(Ee>=0&&Ee<g){const me=Ou([j,oe,Ee,H],u,Ft(r.shape)),De=Ou([J,fe,H],h,Ft(i.shape)),ge=c[me]+d[De];ge>K&&(K=ge)}}}const te=Ou([j,B,L,H],$,Ft(k));z[te]=K}}}return{dataId:l.write(Xg(z,r.dtype),k,r.dtype),shape:k,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aDt={kernelName:qF,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:s}=t,{strides:a,pad:o,dilations:l}=n,c=e,u=zl(r.shape,c.data.get(r.dataId).values),d=zl(i.shape,c.data.get(i.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:y,padInfo:x,strideHeight:b,strideWidth:_,filterHeight:T,filterWidth:E,dilationHeight:C,dilationWidth:I,outShape:A}=FT(r.shape,i.shape,a,o,"NHWC",l);q(s.rank===A.length,()=>`Error in ${qF}, dy must have the same rank as output ${A.length}, but got ${s.rank}`);const k=zl(A,c.data.get(s.dataId).values),R=fae(i.shape,i.dtype);for(let z=0;z<h;++z)for(let O=0;O<m;++O){const j=O*b-x.top;for(let B=0;B<y;++B){const W=B*_-x.left;for(let L=0;L<g;++L){let V=Number.MIN_SAFE_INTEGER,H=0,K=0;for(let te=0;te<T;++te){const J=j+te*C;if(J>=0&&J<f)for(let oe=0;oe<E;++oe){const fe=W+oe*I;if(fe>=0&&fe<p){const Ee=u[z][J][fe][L]+d[te][oe][L];Ee>V&&(V=Ee,H=te,K=oe)}}}R[H][K][L]+=k[z][O][B][L]}}}return{dataId:c.write(Xg(R,r.dtype),i.shape,i.dtype),shape:i.shape,dtype:i.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oDt={kernelName:GF,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:r,filter:i,dy:s}=t,{strides:a,pad:o,dilations:l}=n,c=e,u=zl(r.shape,c.data.get(r.dataId).values),d=zl(i.shape,c.data.get(i.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:g,outHeight:m,outWidth:y,padInfo:x,strideHeight:b,strideWidth:_,filterHeight:T,filterWidth:E,dilationHeight:C,dilationWidth:I,outShape:A}=FT(r.shape,i.shape,a,o,"NHWC",l);q(s.rank===A.length,()=>`Error in ${GF}, dy must have the same rank as output ${A.length}, but got ${s.rank}`);const k=zl(A,c.data.get(s.dataId).values),R=fae(r.shape,r.dtype);for(let z=0;z<h;++z)for(let O=0;O<m;++O){const j=O*b-x.top;for(let B=0;B<y;++B){const W=B*_-x.left;for(let L=0;L<g;++L){let V=Number.MIN_SAFE_INTEGER,H=j<0?0:j,K=W<0?0:W;for(let te=0;te<T;++te){const J=j+te*C;if(J>=0&&J<f)for(let oe=0;oe<E;++oe){const fe=W+oe*I;if(fe>=0&&fe<p){const Ee=u[z][J][fe][L]+d[te][oe][L];Ee>V&&(V=Ee,H=J,K=fe)}}}R[z][H][K][L]+=k[z][O][B][L]}}}return{dataId:c.write(Xg(R,r.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDt(t){const{inputs:e,backend:n,attrs:r}=t,{image:i}=e,{canvas:s,options:a}=r,{contextOptions:o,imageOptions:l}=a||{},c=(l==null?void 0:l.alpha)||1,u=(o==null?void 0:o.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${o.contextType} is not supported by the CPU backend.`);const d=s.getContext(u,(o==null?void 0:o.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=i.shape.slice(0,2),p=i.shape.length===2?1:i.shape[2],g=n.data.get(i.dataId).values,m=i.dtype==="float32"?255:1,y=new Uint8ClampedArray(f*h*4);for(let b=0;b<h*f;++b){const _=[0,0,0,255*c];for(let E=0;E<p;E++){const C=g[b*p+E];if(i.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(i.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);p===1?(_[0]=C*m,_[1]=C*m,_[2]=C*m):_[E]=C*m}const T=b*4;y[T+0]=Math.round(_[0]),y[T+1]=Math.round(_[1]),y[T+2]=Math.round(_[2]),y[T+3]=Math.round(_[3])}s.width=f,s.height=h;const x=new ImageData(y,f,h);return d.putImageData(x,0,0),i}const cDt={kernelName:gae,backendName:"cpu",kernelFunc:lDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kE(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;Ct(i,"sum");let o;i.dtype==="bool"?o=Kf({inputs:{x:i},backend:n,attrs:{dtype:"int32"}}):o=qu({inputs:{x:i},backend:n});const l=o.shape.length,c=Nn(s,o.shape),u=Jr(c,l);let d=c,h=o;u!=null&&(h=Ga({inputs:{x:o},backend:n,attrs:{perm:u}}),d=wi(d.length,l)),Ms("sum",d,h.shape.length);const[f,p]=fs(h.shape,d),g=bo(h.dtype,"int32");let m=GA(n,f,g);const y=Oe(p),x=n.data.get(m.dataId).values,b=n.data.get(h.dataId).values;for(let _=0;_<x.length;++_){const T=_*y;let E=0;for(let C=0;C<y;++C)E+=b[T+C];x[_]=E}if(a){const _=bi(m.shape,c),T=m;m=Ir({inputs:{x:m},backend:n,attrs:{shape:_}}),n.disposeIntermediateTensorInfo(T)}return n.disposeIntermediateTensorInfo(o),u!=null&&n.disposeIntermediateTensorInfo(h),m}const uDt={kernelName:sR,backendName:"cpu",kernelFunc:kE};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dDt(t){const{inputs:e,backend:n,attrs:r}=t,{equation:i}=r,s=e,{allDims:a,summedDims:o,idDims:l}=h5(i,s.length);p5(a.length,l,s);const{path:c,steps:u}=m5(o,l),d=u.length;let h=null,f=a.length;const p=[];for(let g=0;g<d;++g){for(const m of u[g]){const{permutationIndices:y,expandDims:x}=f5(f,l[m]);let b;g5(y)?b=s[m]:(b=Ga({inputs:{x:s[m]},backend:n,attrs:{perm:y}}),p.push(b));const _=b.shape.slice();for(let T=0;T<x.length;++T)_.splice(x[T],0,1);Pn(b.shape,_)||(b=Ir({inputs:{x:b},backend:n,attrs:{shape:_}}),p.push(b)),h===null?h=b:(h=BR({inputs:{a:b,b:h},backend:n}),p.push(h))}g<d-1&&(c[g]>=0&&(h=kE({inputs:{x:h},backend:n,attrs:{axis:c[g]-(a.length-f),keepDims:!1}}),p.push(h)),f--)}for(const g of p)g!==h&&n.disposeIntermediateTensorInfo(g);return h}const hDt={kernelName:cV,backendName:"cpu",kernelFunc:dDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fDt(t){const{inputs:e,backend:n}=t,{dy:r,y:i}=e;Ct([r,i],"eluGrad");const s=new Float32Array(Oe(i.shape)),a=n.data.get(i.dataId).values,o=n.data.get(r.dataId).values;for(let l=0;l<a.length;++l){const c=a[l];c>=0?s[l]=o[l]:s[l]=o[l]*(c+1)}return n.makeTensorInfo(i.shape,"float32",s)}const pDt={kernelName:uV,backendName:"cpu",kernelFunc:fDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mDt=s5,gDt=a5,yDt=o5,vDt=l5,xDt=c5,bDt=u5,wDt=cr(nT,t=>{const e=Math.sign(t),n=Math.abs(t),r=1/(1+mDt*n);return e*(1-((((bDt*r+xDt)*r+vDt)*r+yDt)*r+gDt)*r*Math.exp(-n*n))}),SDt={kernelName:nT,backendName:"cpu",kernelFunc:wDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mk(t){const{inputs:e,backend:n,attrs:r}=t,{input:i}=e,{dim:s}=r,a=i.shape.length,o=i.shape.slice();let l=s;return s<0&&(q(-(a+1)<=s,()=>`Axis must be in the interval [${-(a+1)}, ${a}]`),l=a+s+1),o.splice(l,0,1),Ir({inputs:{x:i},backend:n,attrs:{shape:o}})}const _Dt={kernelName:AM,backendName:"cpu",kernelFunc:Mk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TDt=Si((t,e)=>t/e),_6=Zi(eT,TDt),vB={kernelName:eT,backendName:"cpu",kernelFunc:_6};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pwe(t,e,n){const r=t.shape,i=r[0],s=r[1],a=n.data.get(t.dataId),o=a.complexTensorInfos.real,l=a.complexTensorInfos.imag,c=[i,s],u=Oe(c),d=As("float32",u),h=As("float32",u);for(let m=0;m<i;m++){const y=Cg({inputs:{x:o},backend:n,attrs:{begin:[m,0],size:[1,s]}}),x=Cg({inputs:{x:l},backend:n,attrs:{begin:[m,0],size:[1,s]}}),b=lo({inputs:{real:y,imag:x},backend:n}),{real:_,imag:T}=EDt(b,e,n),E=ih(_,T);for(let C=0;C<s;C++){const I=d5(E,C);d[m*s+C]=I.real,h[m*s+C]=I.imag}n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),g=lo({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),g}function EDt(t,e,n){const r=Oe(t.shape),i=n.data.get(t.dataId),s=n.data.get(i.complexTensorInfos.real.dataId).values,a=n.data.get(i.complexTensorInfos.imag.dataId).values;if(CDt(r)){const o=xB(s,a,r,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",o.real),u=n.makeTensorInfo(l,"float32",o.imag),d=n.makeTensorInfo([],"float32",hp(r,"float32")),h=qu({inputs:{x:d},backend:n}),f=vB.kernelFunc({inputs:{a:c,b:d},backend:n}),p=vB.kernelFunc({inputs:{a:u,b:h},backend:n}),g=n.data.get(f.dataId).values,m=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:g,imag:m}}return o}else{const o=ih(s,a),l=NDt(o,r,e);return Rle(l)}}function CDt(t){return(t&t-1)===0}function xB(t,e,n,r,i){if(n===1)return{real:t,imag:e};const s=ih(t,e),a=n/2,o=Ple(s),l=o.real,c=o.imag,u=[l.length],d=i.makeTensorInfo(u,"float32",l),h=i.makeTensorInfo(u,"float32",c),f=lo({inputs:{real:d,imag:h},backend:i}),p=Ole(s),g=p.real,m=p.imag,y=[g.length],x=i.makeTensorInfo(y,"float32",g),b=i.makeTensorInfo(y,"float32",m),_=lo({inputs:{real:x,imag:b},backend:i}),T=xB(l,c,a,r,i),E=T.real,C=T.imag,I=[E.length],A=i.makeTensorInfo(I,"float32",E),k=i.makeTensorInfo(I,"float32",C),R=lo({inputs:{real:A,imag:k},backend:i}),$=xB(g,m,a,r,i),z=$.real,O=$.imag,j=[z.length],B=i.makeTensorInfo(j,"float32",z),W=i.makeTensorInfo(j,"float32",O),L=lo({inputs:{real:B,imag:W},backend:i}),V=$le(n,r),H=[V.real.length],K=i.makeTensorInfo(H,"float32",V.real),te=i.makeTensorInfo(H,"float32",V.imag),J=lo({inputs:{real:K,imag:te},backend:i}),oe=BR({inputs:{a:J,b:L},backend:i}),fe=Qx({inputs:{a:R,b:oe},backend:i}),Ee=A5({inputs:{a:R,b:oe},backend:i}),me=Eg({inputs:{input:fe},backend:i}),De=Eg({inputs:{input:Ee},backend:i}),ge=O0({inputs:{input:fe},backend:i}),_e=O0({inputs:{input:Ee},backend:i}),Ce=D0({inputs:[me,De],backend:i,attrs:{axis:0}}),G=D0({inputs:[ge,_e],backend:i,attrs:{axis:0}}),ke=i.data.get(Ce.dataId).values,xe=i.data.get(G.dataId).values;return i.disposeIntermediateTensorInfo(d),i.disposeIntermediateTensorInfo(h),i.disposeIntermediateTensorInfo(f),i.disposeIntermediateTensorInfo(x),i.disposeIntermediateTensorInfo(b),i.disposeIntermediateTensorInfo(_),i.disposeIntermediateTensorInfo(A),i.disposeIntermediateTensorInfo(k),i.disposeIntermediateTensorInfo(R),i.disposeIntermediateTensorInfo(B),i.disposeIntermediateTensorInfo(W),i.disposeIntermediateTensorInfo(L),i.disposeIntermediateTensorInfo(K),i.disposeIntermediateTensorInfo(te),i.disposeIntermediateTensorInfo(J),i.disposeIntermediateTensorInfo(oe),i.disposeIntermediateTensorInfo(fe),i.disposeIntermediateTensorInfo(Ee),i.disposeIntermediateTensorInfo(me),i.disposeIntermediateTensorInfo(ge),i.disposeIntermediateTensorInfo(De),i.disposeIntermediateTensorInfo(_e),i.disposeIntermediateTensorInfo(Ce),i.disposeIntermediateTensorInfo(G),{real:ke,imag:xe}}function NDt(t,e,n){const r=new Float32Array(e*2);for(let i=0;i<e;i++){let s=0,a=0;for(let o=0;o<e;o++){const l=Lle(i*o,e,n),c=d5(t,o);s+=c.real*l.real-c.imag*l.imag,a+=c.real*l.imag+c.imag*l.real}n&&(s/=e,a/=e),Dle(r,s,a,i)}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADt(t){const{inputs:e,backend:n}=t,{input:r}=e,i=Oe(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=Ir({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=pwe(o,!1,n),c=Ir({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const IDt={kernelName:dV,backendName:"cpu",kernelFunc:ADt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t){const{backend:e,attrs:n}=t,{shape:r,value:i,dtype:s}=n,a=s||G0(i),o=xi(a,Oe(r));return MDt(o,i,a),e.makeTensorInfo(r,a,o)}const kDt={kernelName:hV,backendName:"cpu",kernelFunc:T6};function MDt(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RDt={kernelName:fV,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,i=n,s=As(r.dtype,Oe(r.shape)),[a,o,l,c]=r.shape,u=i.data.get(r.dataId).values;for(let h=0;h<a;h++){const f=h*l*o*c;for(let p=0;p<o;p++){const g=p*(l*c);for(let m=0;m<l;m++){const y=m*c;for(let x=0;x<c;x++){const b=Math.round(l-m-1),_=f+g+y+x;let T=u[_];if(b>=0&&b<l){const E=b*c,C=f+g+E+x;T=u[C]}s[_]=T}}}}return{dataId:i.write(s,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let g=hwe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(a){const m=g;if(u==="NCHW"&&a.shape.length===1&&a.shape[0]!==1){const y=Ir({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});g=Qx({inputs:{a:g,b:y},backend:n}),n.disposeIntermediateTensorInfo(y)}else g=Qx({inputs:{a:g,b:a},backend:n});n.disposeIntermediateTensorInfo(m)}if(f){const m=g;if(u==="NCHW"&&f==="prelu"&&o.shape.length===1&&o.shape[0]!==1){const y=Ir({inputs:{x:o},backend:n,attrs:{shape:[o.shape[0],1,1]}});g=kk(n,g,f,y,p),n.disposeIntermediateTensorInfo(y)}else g=kk(n,g,f,o,p);n.disposeIntermediateTensorInfo(m)}return g}const ODt={kernelName:$A,backendName:"cpu",kernelFunc:PDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DDt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,filter:s,bias:a,preluActivationWeights:o}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=r;let g=fwe({inputs:{x:i,filter:s},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(a){const m=g;g=Qx({inputs:{a:g,b:a},backend:n}),n.disposeIntermediateTensorInfo(m)}if(f){const m=g;g=kk(n,g,f,o,p),n.disposeIntermediateTensorInfo(m)}return g}const $Dt={kernelName:LA,backendName:"cpu",kernelFunc:DDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LDt(t){const{inputs:e,backend:n}=t,{params:r,indices:i}=e,s=Oe(r.shape),a=i.shape,o=a[a.length-1],[l,c,u,d]=XW(r,i);if(c===0)return n.makeTensorInfo(l,r.dtype,[]);const h=n.data.get(i.dataId).values,f=n.bufferSync(r),p=_ce(h,f,r.dtype,c,o,u,d,r.shape,s);return n.makeTensorInfo(l,r.dtype,p.values)}const FDt={kernelName:pV,backendName:"cpu",kernelFunc:LDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jDt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,indices:s}=e,{axis:a,batchDims:o}=r;Ct([i,s],"gatherV2");const l=Nn(a,i.shape)[0],c=n.data.get(s.dataId).values,u=i.shape[l];for(let _=0;_<c.length;++_){const T=c[_];q(T<=u-1&&T>=0,()=>`GatherV2: the index value ${T} is not in [0, ${u-1}]`)}let d=o;o==null&&(d=0);const h=Oe(s.shape),f=v5(i,s,l,d),p=Ir({inputs:{x:i},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),g=Ir({inputs:{x:s},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),m=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],y=n.bufferSync(g),x=n.bufferSync(p),b=Tce(x,y,m);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const zDt={kernelName:kM,backendName:"cpu",kernelFunc:jDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BDt(t){const{inputs:e,backend:n}=t,{input:r}=e,i=Oe(r.shape),s=r.shape[r.shape.length-1],a=i/s,o=Ir({inputs:{x:r},backend:n,attrs:{shape:[a,s]}}),l=pwe(o,!0,n),c=Ir({inputs:{x:l},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(l),c}const UDt={kernelName:mV,backendName:"cpu",kernelFunc:BDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VDt=cr(cT,t=>Number.isFinite(t)?1:0,"bool"),WDt={kernelName:cT,backendName:"cpu",kernelFunc:VDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HDt=cr(uT,t=>Math.abs(t)===1/0?1:0,"bool"),GDt={kernelName:uT,backendName:"cpu",kernelFunc:HDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qDt=cr(dT,t=>Number.isNaN(t)?1:0,"bool"),XDt={kernelName:dT,backendName:"cpu",kernelFunc:qDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KDt(t){const{backend:e,attrs:n}=t,{start:r,stop:i,num:s}=n,a=Ice(r,i,s);return e.makeTensorInfo([a.length],"float32",a)}const YDt={kernelName:yV,backendName:"cpu",kernelFunc:KDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZDt=cr(fT,t=>Math.log1p(t)),QDt={kernelName:fT,backendName:"cpu",kernelFunc:ZDt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JDt=Si((t,e)=>t&&e),e$t=Zi(DM,JDt,null,"bool"),t$t={kernelName:DM,backendName:"cpu",kernelFunc:e$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n$t=cr($M,t=>t?0:1,"bool"),r$t={kernelName:$M,backendName:"cpu",kernelFunc:n$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$t=Si((t,e)=>t||e),s$t=Zi(LM,i$t,null,"bool"),a$t={kernelName:LM,backendName:"cpu",kernelFunc:s$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{depthRadius:s,bias:a,alpha:o,beta:l}=r;Ct(i,"LRN");const c=i.shape[3],u=c-1,d=n.data.get(i.dataId).values,h=Oe(i.shape),f=new Float32Array(h);function p(g){const m=g%c;let y=g-m+Math.max(0,m-s);const x=g-m+Math.min(m+s,u);let b=0;for(;y<=x;y++){const _=d[y];b+=_*_}return b}for(let g=0;g<h;g++){const m=p(g),y=d[g]*Math.pow(a+o*m,-l);f[g]=y}return n.makeTensorInfo(i.shape,i.dtype,f)}const l$t={kernelName:FM,backendName:"cpu",kernelFunc:o$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,y:s,dy:a}=e,{depthRadius:o,bias:l,alpha:c,beta:u}=r;Ct(a,"LRNGrad");const d=Oe(a.shape),h=a.shape[3],f=n.data.get(a.dataId).values,p=n.data.get(i.dataId).values,g=n.data.get(s.dataId).values,m=new Float32Array(d),y=d;for(let x=0;x<y;x++){const b=x%h,_=x-b+Math.max(0,b-o),T=x-b+Math.min(h,b+o+1);let E=0;for(let C=_;C<T;C++)E+=Math.pow(p[C],2);E=c*E+l;for(let C=_;C<T;C++){let I=-2*c*u*p[C]*g[x]/E;x===C&&(I+=Math.pow(E,-u)),I*=f[x],m[C]+=I}}return n.makeTensorInfo(a.shape,i.dtype,m)}const u$t={kernelName:vV,backendName:"cpu",kernelFunc:c$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mwe(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reductionIndices:s,keepDims:a}=r,o=n;let l=i.shape;const c=l.length,u=Nn(s,l);let d=u;const h=Jr(d,c);let f=o.data.get(i.dataId).values;if(h!=null){const _=new Array(c);for(let T=0;T<_.length;T++)_[T]=l[h[T]];f=C5(f,l,i.dtype,h,_),d=wi(d.length,c),l=_}Ct(i,"max"),Ms("max",d,c);const[p,g]=fs(l,d),m=Oe(g),y=Mce(f,m,p,i.dtype),x=o.write(y,p,i.dtype);let b=p;return a&&(b=bi(p,u)),{dataId:x,shape:b,dtype:i.dtype}}const d$t={kernelName:jM,backendName:"cpu",kernelFunc:mwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e;Ct(i,"maxPool");const{filterSize:s,strides:a,pad:o,dimRoundingMode:l}=r,c=1;q(ks(a,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${c}'`);const u=Zl(i.shape,s,a,c,o,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&Pn(u.inShape,u.outShape))d=qu({inputs:{x:i},backend:n});else{const h=n.data.get(i.dataId).values,f=Ft(i.shape),p=S6(h,i.shape,i.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,i.dtype,p.values)}return d}const f$t={kernelName:zM,backendName:"cpu",kernelFunc:h$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{filterSize:s,strides:a,pad:o,dimRoundingMode:l,dataFormat:c}=r;Ct(i,"maxPool3d");const u=gh(i.shape,s,a,1,o,l,c),d=n.data.get(i.dataId).values,h=dwe(d,i.shape,i.dtype,Ft(i.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const m$t={kernelName:BM,backendName:"cpu",kernelFunc:p$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$t(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s}=e,{filterSize:a,strides:o,pad:l,dimRoundingMode:c}=r;Ct([i,s],"maxPool3DGrad");const u=gh(s.shape,a,o,1,l,c),d=n.bufferSync(s),h=iOt(d,u),f=u.strideDepth,p=u.strideHeight,g=u.strideWidth,m=u.dilationDepth,y=u.dilationHeight,x=u.dilationWidth,b=u.effectiveFilterDepth,_=u.effectiveFilterHeight,T=u.effectiveFilterWidth,E=b-1-u.padInfo.front,C=T-1-u.padInfo.left,I=_-1-u.padInfo.top,A=yn(s.shape,"float32"),k=n.bufferSync(i);for(let R=0;R<u.batchSize;++R)for(let $=0;$<u.inChannels;++$)for(let z=0;z<u.inDepth;++z)for(let O=0;O<u.inHeight;++O)for(let j=0;j<u.inWidth;++j){const B=z-E,W=O-I,L=j-C;let V=0;for(let H=0;H<b;H+=m){const K=(B+H)/f;if(!(K<0||K>=u.outDepth||Math.floor(K)!==K))for(let te=0;te<_;te+=y){const J=(W+te)/p;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let oe=0;oe<T;oe+=x){const fe=(L+oe)/g;if(fe<0||fe>=u.outWidth||Math.floor(fe)!==fe)continue;const Ee=b*_*T-1-h.get(R,K,J,fe,$),me=H*_*T+te*T+oe,De=Ee===me?1:0;if(De===0)continue;const ge=k.get(R,K,J,fe,$);V+=ge*De}}}A.set(V,R,z,O,j,$)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const y$t={kernelName:bV,backendName:"cpu",kernelFunc:g$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v$t(t){const{inputs:e,backend:n,attrs:r}=t,{dy:i,input:s,output:a}=e,o=s;Ct([s,a],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=r,h=Zl(o.shape,l,c,1,u,d),f=n.data.get(o.dataId).values,p=yn(h.outShape,o.dtype,uwe(f,o.shape,o.dtype,h).values),g=h.strideHeight,m=h.strideWidth,y=h.dilationHeight,x=h.dilationWidth,b=h.effectiveFilterHeight,_=h.effectiveFilterWidth,T=_-1-h.padInfo.left,E=b-1-h.padInfo.top,C=yn(o.shape,"float32"),I=n.data.get(i.dataId).values,A=yn(i.shape,"float32",I);for(let k=0;k<h.batchSize;++k)for(let R=0;R<h.inChannels;++R)for(let $=0;$<h.inHeight;++$)for(let z=0;z<h.inWidth;++z){const O=$-E,j=z-T;let B=0;for(let W=0;W<b;W+=y){const L=(O+W)/g;if(!(L<0||L>=h.outHeight||Math.floor(L)!==L))for(let V=0;V<_;V+=x){const H=(j+V)/m;if(H<0||H>=h.outWidth||Math.floor(H)!==H)continue;const K=b*_-1-p.get(k,L,H,R),te=W*_+V,J=K===te?1:0;if(J===0)continue;const oe=A.get(k,L,H,R);B+=oe*J}}C.set(B,k,$,z,R)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const x$t={kernelName:xV,backendName:"cpu",kernelFunc:v$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b$t(t,e,n,r,i){const s=Ft(e),a=S6(t,e,n,s,i,"max"),o=uwe(t,e,n,i,!0,r);return[a.values,o.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w$t={kernelName:wV,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:r}=t,{filterSize:i,strides:s,pad:a,includeBatchInIndex:o}=e,l=n;Ct(r,"MaxPoolWithArgmax");const c=l.data.get(r.dataId).values,u=Zl(r.shape,i,s,[1,1],a),[d,h]=b$t(c,r.shape,r.dtype,o,u),f=l.write(d,u.outShape,r.dtype),p=l.write(h,u.outShape,r.dtype);return[{dataId:f,shape:u.outShape,dtype:r.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r,o=Nn(s,i.shape),c=fs(i.shape,o)[1],u=Oe(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=Kf({inputs:{x:i},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=_6({inputs:{a:f,b:h},backend:n});d.push(p);const g=kE({inputs:{x:p},backend:n,attrs:{axis:s,keepDims:a}});return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),g}const _$t={kernelName:UM,backendName:"cpu",kernelFunc:S$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{axis:s,keepDims:a}=r;Ct(i,"min");const o=Nn(s,i.shape);let l=o;const c=Jr(l,i.shape.length);let u=i;c!=null&&(u=Ga({inputs:{x:i},backend:n,attrs:{perm:c}}),l=wi(l.length,i.shape.length)),Ms("min",l,u.shape.length);const[d,h]=fs(u.shape,l),f=Oe(h),p=qs(Oe(d),u.dtype),g=n.data.get(u.dataId).values;for(let y=0;y<p.length;++y){const x=y*f;let b=g[x];for(let _=0;_<f;++_){const T=g[x+_];(Number.isNaN(T)||T<b)&&(b=T)}p[y]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const m=n.makeTensorInfo(d,u.dtype,p);if(a){const y=bi(d,o),x=Ir({inputs:{x:m},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(m),x}return m}const E$t={kernelName:VM,backendName:"cpu",kernelFunc:T$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:s,mode:a}=r;Ct(i,"mirrorPad");const o=s.map((b,_)=>b[0]+i.shape[_]+b[1]),l=s.map(b=>b[0]),c=s.map((b,_)=>b[0]+i.shape[_]),u=a==="reflect"?0:1,d=n.data.get(i.dataId).values,h=i.shape.length,f=Ft(i.shape),p=Oe(o),g=o.length,m=Ft(o),y=As(i.dtype,p);for(let b=0;b<p;b++){let _=q0(b,g,m);for(let E=0;E<g;E++)_[E]<l[E]?_[E]=l[E]*2-_[E]-u:_[E]>=c[E]&&(_[E]=(c[E]-1)*2-_[E]+u);_=_.map((E,C)=>E-l[C]);const T=Ou(_,h,f);y[b]=d[T]}return{dataId:n.write(y,o,i.dtype),shape:o,dtype:i.dtype}}const N$t={kernelName:WM,backendName:"cpu",kernelFunc:C$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$t=Si((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),I$t=Zi(gT,A$t),k$t={kernelName:gT,backendName:"cpu",kernelFunc:I$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gwe(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{dim:s}=r,a=i.shape.length;let o=s;if(o===-1&&(o=a-1),o!==a-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${a} and dim was ${o}`);const l=Nn([o],i.shape),c=mwe({inputs:{x:i},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=bi(c.shape,l),d=Ir({inputs:{x:c},backend:n,attrs:{shape:u}}),h=A5({inputs:{a:i,b:d},backend:n}),f=xce({inputs:{x:h},backend:n}),p=kE({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),g=Ir({inputs:{x:p},backend:n,attrs:{shape:u}}),m=_6({inputs:{a:f,b:g},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),m}const M$t={kernelName:lR,backendName:"cpu",kernelFunc:gwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$t(t){const{inputs:e,backend:n,attrs:r}=t,{logits:i}=e,{numSamples:s,seed:a,normalized:o}=r;Ct(i,"multinomial");const l=o?i:gwe({inputs:{logits:i},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,s],f=qs(Oe(h),"int32");for(let p=0;p<c;++p){const g=p*u,m=new Float32Array(u-1);m[0]=d[g];for(let b=1;b<m.length;++b)m[b]=m[b-1]+d[g+b];const y=CR.alea(a.toString()),x=p*s;for(let b=0;b<s;++b){const _=y();f[x+b]=m.length;for(let T=0;T<m.length;T++)if(_<m[T]){f[x+b]=T;break}}}return o||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const P$t={kernelName:SV,backendName:"cpu",kernelFunc:R$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$t=zW;function D$t(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l}=r;Ct(i,"NonMaxSuppression");const c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,{selectedIndices:d}=O$t(c,u,a,o,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const $$t={kernelName:_V,backendName:"cpu",kernelFunc:D$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L$t=BW;function F$t(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,padToMaxOutputSize:c}=r;Ct(i,"NonMaxSuppressionPadded");const u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,{selectedIndices:h,validOutputs:f}=L$t(u,d,a,o,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const j$t={kernelName:TV,backendName:"cpu",kernelFunc:F$t};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z$t=UW;function B$t(t){const{inputs:e,backend:n,attrs:r}=t,{boxes:i,scores:s}=e,{maxOutputSize:a,iouThreshold:o,scoreThreshold:l,softNmsSigma:c}=r;Ct(i,"NonMaxSuppressionWithScore");const u=n.data.get(i.dataId).values,d=n.data.get(s.dataId).values,h=a,f=o,p=l,g=c,{selectedIndices:m,selectedScores:y}=z$t(u,d,h,f,p,g);return[n.makeTensorInfo([m.length],"int32",new Int32Array(m)),n.makeTensorInfo([y.length],"float32",new Float32Array(y))]}const U$t={kernelName:EV,backendName:"cpu",kernelFunc:B$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V$t(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i}=e,{dtype:s,depth:a,onValue:o,offValue:l}=r;Ct(i,"oneHot");const c=Oe(i.shape),u=new Float32Array(c*a);u.fill(l);const d=n.data.get(i.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<a&&(u[h*a+d[h]]=o);return n.makeTensorInfo([...i.shape,a],s,u)}const W$t={kernelName:XM,backendName:"cpu",kernelFunc:V$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rk(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Eg({inputs:{input:r},backend:n}),s=Rk({inputs:{x:i},backend:n}),a=O0({inputs:{input:r},backend:n}),o=Rk({inputs:{x:a},backend:n}),l=lo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return T6({backend:n,attrs:{shape:r.shape,value:0,dtype:r.dtype}})}const H$t={kernelName:hR,backendName:"cpu",kernelFunc:Rk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ywe(t){const{inputs:e,backend:n}=t,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(r.dtype==="complex64"){const i=Eg({inputs:{input:r},backend:n}),s=ywe({inputs:{x:i},backend:n}),a=O0({inputs:{input:r},backend:n}),o=Rk({inputs:{x:a},backend:n}),l=lo({inputs:{real:s,imag:o},backend:n});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(o),l}else return T6({backend:n,attrs:{shape:r.shape,value:1,dtype:r.dtype}})}const G$t={kernelName:qM,backendName:"cpu",kernelFunc:ywe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vwe(t){const{inputs:e,backend:n,attrs:r}=t,{axis:i}=r;if(e.length===1)return Mk({inputs:{input:e[0]},backend:n,attrs:{dim:i}});const s=e[0].shape,a=e[0].dtype;e.forEach(u=>{To(s,u.shape,"All tensors passed to stack must have matching shapes"),q(a===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const o=[],l=e.map(u=>{const d=Mk({inputs:{input:u},backend:n,attrs:{dim:i}});return o.push(d),d}),c=D0({inputs:l,backend:n,attrs:{axis:i}});return o.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const q$t={kernelName:KM,backendName:"cpu",kernelFunc:vwe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X$t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{paddings:s,constantValue:a}=r;Ct(i,"pad");const o=s.map((x,b)=>x[0]+i.shape[b]+x[1]),l=s.map(x=>x[0]),c=n.data.get(i.dataId).values,u=Oe(i.shape),d=i.shape.length,h=Ft(i.shape),f=Oe(o),p=o.length,g=Ft(o),m=As(i.dtype,f);a!==0&&m.fill(a);for(let x=0;x<u;x++){const _=q0(x,d,h).map((E,C)=>E+l[C]),T=Ou(_,p,g);m[T]=c[x]}return{dataId:n.write(m,o,i.dtype),shape:o,dtype:i.dtype}}const xwe={kernelName:YM,backendName:"cpu",kernelFunc:X$t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K$t=Si((t,e)=>Math.pow(t,e)),Y$t=Zi(vT,K$t),Z$t={kernelName:vT,backendName:"cpu",kernelFunc:Y$t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q$t(t){const{inputs:e,backend:n,attrs:r}=t,{paramsNestedSplits:i,paramsDenseValues:s,indices:a}=e,{outputRaggedRank:o}=r,l=i.map(y=>n.data.get(y.dataId).values),c=i.map(y=>y.shape),u=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,[h,f,p]=Lce(l,c,u,s.shape,s.dtype,d,a.shape),g=h.map(y=>n.makeTensorInfo([y.length],"int32",y)),m=n.makeTensorInfo(p,s.dtype,f);return g.concat([m])}const J$t={kernelName:CV,backendName:"cpu",kernelFunc:Q$t};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eLt(t){const{inputs:e,backend:n}=t,{starts:r,limits:i,deltas:s}=e,a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[c,u]=Fce(a,r.shape,r.dtype,o,i.shape,l,s.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],r.dtype,u);return[d,h]}const tLt={kernelName:NV,backendName:"cpu",kernelFunc:eLt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nLt(t){const{inputs:e,backend:n,attrs:r}=t,{shape:i,values:s,defaultValue:a,rowPartitionTensors:o}=e,{rowPartitionTypes:l}=r,c=n.data.get(i.dataId).values,u=n.data.get(s.dataId).values,d=n.data.get(a.dataId).values,h=o.map(m=>n.data.get(m.dataId).values),f=o.map(m=>m.shape),[p,g]=jce(c,i.shape,u,s.shape,s.dtype,d,a.shape,h,f,l);return n.makeTensorInfo(p,s.dtype,g)}const rLt={kernelName:AV,backendName:"cpu",kernelFunc:nLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iLt(t){const{backend:e,attrs:n}=t,{start:r,stop:i,dtype:s,step:a}=n,o=zce(r,i,a,s);return e.makeTensorInfo([o.length],s,o)}const sLt={kernelName:IV,backendName:"cpu",kernelFunc:iLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aLt=cr(xT,t=>1/t),oLt={kernelName:xT,backendName:"cpu",kernelFunc:aLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lLt(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ct(i,"resizeBilinear");const l=Ft(i.shape),[c,u]=o,[d,h,f,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(Oe([d,c,u,p])),y=[s&&c>1?h-1:h,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u];let b=0;const _=y[0]/x[0],T=y[1]/x[1];for(let E=0;E<d;E++)for(let C=0;C<c;C++){let I;a?I=_*(C+.5)-.5:I=_*C;const A=Math.max(0,Math.floor(I)),k=I-A,R=Math.min(h-1,Math.ceil(I)),$=E*l[0]+A*l[1],z=E*l[0]+R*l[1];for(let O=0;O<u;O++){let j;a?j=T*(O+.5)-.5:j=T*O;const B=Math.max(0,Math.floor(j)),W=j-B,L=Math.min(f-1,Math.ceil(j)),V=$+B*l[2],H=z+B*l[2],K=$+L*l[2],te=z+L*l[2];for(let J=0;J<p;J++){const oe=g[V+J],fe=g[H+J],Ee=g[K+J],me=g[te+J],De=oe+(Ee-oe)*W,ge=fe+(me-fe)*W,_e=De+(ge-De)*k;m[b++]=_e}}}return n.makeTensorInfo([d,c,u,p],"float32",m)}const cLt={kernelName:tR,backendName:"cpu",kernelFunc:lLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uLt(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:s}=e,{alignCorners:a}=r;Ct([s,i],"resizeBilinearGrad");const o=Ft(i.shape),[l,c,u,d]=i.shape,[,h,f]=s.shape,p=new Float32Array(l*c*u*d),g=[a&&h>1?c-1:c,a&&f>1?u-1:u],m=[a&&h>1?h-1:h,a&&f>1?f-1:f],y=g[0]/m[0],x=g[1]/m[1],b=n.data.get(s.dataId).values;let _=0;for(let T=0;T<l;T++){const E=T*o[0];for(let C=0;C<h;C++){const I=C*y,A=Math.floor(I),k=Math.min(Math.ceil(I),c-1),R=E+A*o[1],$=E+k*o[1],z=I-A,O=1-z;for(let j=0;j<f;j++){const B=j*x,W=Math.floor(B),L=Math.min(Math.ceil(B),u-1),V=B-W,H=1-V,K=R+W*o[2],te=R+L*o[2],J=$+W*o[2],oe=$+L*o[2],fe=O*H,Ee=O*V,me=z*H,De=z*V;for(let ge=0;ge<d;ge++){const _e=b[_++];p[K+ge]+=_e*fe,p[te+ge]+=_e*Ee,p[J+ge]+=_e*me,p[oe+ge]+=_e*De}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const dLt={kernelName:RV,backendName:"cpu",kernelFunc:uLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hLt(t){const{inputs:e,backend:n,attrs:r}=t,{images:i}=e,{alignCorners:s,halfPixelCenters:a,size:o}=r;Ct(i,"resizeNearestNeighbor");const l=Ft(i.shape),[c,u]=o,[d,h,f,p]=i.shape,g=n.data.get(i.dataId).values,m=new Float32Array(d*c*u*p),y=[s&&c>1?h-1:h,s&&u>1?f-1:f],x=[s&&c>1?c-1:c,s&&u>1?u-1:u],b=y[0]/x[0],_=y[1]/x[1];let T=0;for(let E=0;E<d;E++){const C=E*l[0];for(let I=0;I<c;I++){const A=a?b*(I+.5):b*I;let k=Math.min(h-1,s?Math.round(A):Math.floor(A));a&&(k=Math.max(0,k));const R=C+k*l[1];for(let $=0;$<u;$++){const z=a?_*($+.5):_*$;let O=Math.min(f-1,s?Math.round(z):Math.floor(z));a&&(O=Math.max(0,O));const j=R+O*l[2];for(let B=0;B<p;B++){const W=g[j+B];m[T++]=W}}}}return n.makeTensorInfo([d,c,u,p],i.dtype,m)}const fLt={kernelName:eR,backendName:"cpu",kernelFunc:hLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pLt(t){const{inputs:e,backend:n,attrs:r}=t,{images:i,dy:s}=e,{alignCorners:a}=r;Ct([s,i],"resizeNearestNeighborGrad");const o=Ft(i.shape),l=Ft(s.shape),[c,u,d,h]=i.shape,[,f,p]=s.shape,g=new Float32Array(c*u*d*h),m=n.data.get(s.dataId).values,y=[a&&f>1?u-1:u,a&&p>1?d-1:d],x=[a&&f>1?f-1:f,a&&p>1?p-1:p],b=y[0]/x[0],_=y[1]/x[1],T=1/b,E=1/_,C=Math.ceil(T)*2+2,I=Math.ceil(E)*2+2;for(let A=0;A<c;A++){const k=A*o[0];for(let R=0;R<u;R++){const $=k+R*o[1],z=Math.floor(R*T),O=Math.floor(z-C/2);for(let j=0;j<d;j++){const B=$+j*o[2],W=Math.floor(j*E),L=Math.floor(W-I/2);for(let V=0;V<h;V++){let H=0;for(let K=0;K<C;K++){const te=K+O;if(te<0||te>=f)continue;const J=k+te*l[1],oe=te*b,fe=Math.min(u-1,a?Math.round(oe):Math.floor(oe));if(R===fe)for(let Ee=0;Ee<I;Ee++){const me=Ee+L;if(me<0||me>=p)continue;const De=J+me*l[2],ge=me*_,_e=Math.min(d-1,a?Math.round(ge):Math.floor(ge));j===_e&&(H+=m[De+V])}}g[B+V]=H}}}}return n.makeTensorInfo(i.shape,i.dtype,g)}const mLt={kernelName:MV,backendName:"cpu",kernelFunc:pLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gLt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{dims:s}=r;Ct(i,"reverse");const a=i.shape.length,o=Nn(s,i.shape);if(a===0)return qu({inputs:{x:i},backend:n});const l=new Hi(i.shape,i.dtype),c=n.bufferSync(i);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();o.forEach(f=>h[f]=i.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const yLt={kernelName:nR,backendName:"cpu",kernelFunc:gLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vLt={kernelName:KV,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:r}=t,{radians:i,fillValue:s,center:a}=e,o=n,l=As(r.dtype,Oe(r.shape)),[c,u,d,h]=r.shape,[f,p]=n5(a,u,d),g=255,m=Math.sin(i),y=Math.cos(i),x=o.data.get(r.dataId).values;for(let _=0;_<c;_++){const T=_*d*u*h;for(let E=0;E<u;E++){const C=E*(d*h);for(let I=0;I<d;I++){const A=I*h;for(let k=0;k<h;k++){const R=[c,E,I,k],$=R[2],z=R[1];let O=($-f)*y-(z-p)*m,j=($-f)*m+(z-p)*y;O=Math.round(O+f),j=Math.round(j+p);let B=s;if(typeof s!="number"&&(k===3?B=g:B=s[k]),O>=0&&O<d&&j>=0&&j<u){const L=j*(d*h),V=O*h,H=T+L+V+k;B=x[H]}const W=T+C+A+k;l[W]=B}}}}return{dataId:o.write(l,r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xLt=cr(ST,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),bLt={kernelName:ST,backendName:"cpu",kernelFunc:xLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wLt(t){const{inputs:e,backend:n,attrs:r}=t,{indices:i,updates:s}=e,{shape:a}=r,{sliceRank:o,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Qg(s,i,a),h=!0,f=n.bufferSync(i),p=n.bufferSync(s),g=Nm(f,p,a,d,c,l,o,u,0,h);return n.makeTensorInfo(a,g.dtype,g.values)}const SLt={kernelName:PV,backendName:"cpu",kernelFunc:wLt};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Lt(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<e?n=i+1:r=i;return r}function TLt(t,e){let n=0,r=t.length,i=0;for(;n<r;)i=Math.floor((n+r)/2),t[i]<=e?n=i+1:r=i;return r}function ELt(t,e,n,r,i,s){const a=xi("int32",n*i);for(let o=0;o<n;++o){const l=t.slice(o*r,(o+1)*r),c=o*i;for(let u=0;u<i;++u)a[c+u]=s==="left"?_Lt(l,e[u+c]):TLt(l,e[u+c])}return a}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CLt(t){const{inputs:e,backend:n,attrs:r}=t,{sortedSequence:i,values:s}=e,{side:a}=r,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,c=ELt(o,l,i.shape[0],i.shape[1],s.shape[1],a);return n.makeTensorInfo(s.shape,"int32",c)}const NLt={kernelName:DV,backendName:"cpu",kernelFunc:CLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ALt(t){const{inputs:e,backend:n}=t,{condition:r,t:i,e:s}=e;Ct([r,i,s],"select");const a=r.shape.length,o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,u=bo(i.dtype,s.dtype),d=qs(Oe(i.shape),u);let h=0;const f=a===0||a>1||i.shape.length===1?1:Oe(i.shape.slice(1));for(let p=0;p<o.length;p++)for(let g=0;g<f;g++)o[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(i.shape,u,d)}const ILt={kernelName:rR,backendName:"cpu",kernelFunc:ALt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kLt=FR,MLt=jR,RLt=cr(TT,t=>t>=0?MLt*t:kLt*(Math.exp(t)-1)),PLt={kernelName:TT,backendName:"cpu",kernelFunc:RLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OLt=cr(NT,t=>t<0?-1:t>0?1:0),DLt={kernelName:NT,backendName:"cpu",kernelFunc:OLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Lt=cr(ET,t=>Math.sin(t)),LLt={kernelName:ET,backendName:"cpu",kernelFunc:$Lt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FLt=cr(CT,t=>Math.sinh(t)),jLt={kernelName:CT,backendName:"cpu",kernelFunc:FLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zLt=11920928955078125e-23,_te=Math.log(zLt)+2,BLt=cr(IT,t=>{const e=t>-_te,n=t<_te,r=Math.exp(t);let i;return n?i=r:e?i=t:i=Math.log(1+r),i}),ULt={kernelName:IT,backendName:"cpu",kernelFunc:BLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VLt(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{blockShape:s,paddings:a}=r;Ct([i],"spaceToBatchND");const o=Oe(s),l=[[0,0]];l.push(...a);for(let E=1+s.length;E<i.shape.length;++E)l.push([0,0]);const c=xwe.kernelFunc({inputs:{x:i},backend:n,attrs:{paddings:l,constantValue:0}}),u=HT(c.shape,s,o,!1),d=GT(u.length,s.length,!1),h=qT(c.shape,s,o,!1),g=Ir({inputs:{x:c},backend:n,attrs:{shape:u}}),x=Ga({inputs:{x:g},backend:n,attrs:{perm:d}}),T=Ir({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(x),T}const WLt={kernelName:aR,backendName:"cpu",kernelFunc:VLt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HLt(t){const{inputs:e,backend:n}=t,{indices:r,values:i,denseShape:s,defaultValue:a}=e;if(s.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${s.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${i.shape}`);if(a.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${a.shape}`);const o=n.data.get(r.dataId).values,l=n.data.get(i.dataId).values,c=n.data.get(s.dataId).values,u=n.data.get(a.dataId).values[0],[d,h,f,p,g]=Wce(o,r.shape,r.dtype,l,i.dtype,c,u);return[n.makeTensorInfo(h,r.dtype,d),n.makeTensorInfo([h[0]],i.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(m=>Number(m)))),n.makeTensorInfo([g.length],r.dtype,new Int32Array(g))]}const GLt={kernelName:$V,backendName:"cpu",kernelFunc:HLt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qLt(t){const{inputs:e,backend:n}=t,{inputIndices:r,inputShape:i,newShape:s}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${r.shape}`);if(i.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${i.shape}`);if(s.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${s.shape}`);const a=Array.from(n.data.get(i.dataId).values),o=n.data.get(r.dataId).values,l=Array.from(n.data.get(s.dataId).values),[c,u,d]=Hce(o,r.shape,r.dtype,a,l);return[n.makeTensorInfo(u,r.dtype,c),n.makeTensorInfo([d.length],s.dtype,new Int32Array(d))]}const XLt={kernelName:LV,backendName:"cpu",kernelFunc:qLt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KLt(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[c,u]=N5(a,r.shape,r.dtype,o,l,!0);return n.makeTensorInfo(u,r.dtype,c)}const YLt={kernelName:FV,backendName:"cpu",kernelFunc:KLt};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZLt(t){const{inputs:e,backend:n}=t,{data:r,indices:i,segmentIds:s}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(i.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${i.shape}`);if(s.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${s.shape}`);if(i.shape[0]!==s.shape[0])throw new Error("segmentIds and indices should have same size.");const a=n.data.get(r.dataId).values,o=n.data.get(i.dataId).values,l=n.data.get(s.dataId).values,[c,u]=N5(a,r.shape,r.dtype,o,l);return n.makeTensorInfo(u,r.dtype,c)}const QLt={kernelName:jV,backendName:"cpu",kernelFunc:ZLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JLt(t){const{inputs:e,backend:n,attrs:r}=t,{sparseIndices:i,sparseValues:s,defaultValue:a}=e,{outputShape:o}=r,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Qg(s,i,o),f=!1,p=n.bufferSync(i);let g;switch(s.dtype){case"bool":{const m=n.bufferSync(s),y=!!n.data.get(a.dataId).values[0];g=Nm(p,m,o,h,u,c,l,d,y,f);break}case"float32":{const m=n.bufferSync(s),y=n.data.get(a.dataId).values[0];g=Nm(p,m,o,h,u,c,l,d,y,f);break}case"int32":{const m=n.bufferSync(s),y=n.data.get(a.dataId).values[0];g=Nm(p,m,o,h,u,c,l,d,y,f);break}case"string":{const m=n.bufferSync(s),y=Vf(n.data.get(a.dataId).values[0]);g=Nm(p,m,o,h,u,c,l,d,y,f);break}default:throw new Error(`Unsupported type ${s.dtype}`)}return n.makeTensorInfo(o,g.dtype,g.values)}const e3t={kernelName:zV,backendName:"cpu",kernelFunc:JLt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t3t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{numOrSizeSplits:s,axis:a}=r,o=Nn(a,i.shape)[0],l=y5(i,s,o),c=new Array(i.shape.length).fill(0),u=i.shape.slice();return l.map(d=>{const h=[...u];h[o]=d;const f=Cg({inputs:{x:i},backend:n,attrs:{begin:c,size:h}});return c[o]+=d,f})}const n3t={kernelName:oR,backendName:"cpu",kernelFunc:t3t};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r3t={kernelName:BV,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,r=e;Ct(n,"square");const i=r.data.get(n.dataId).values,s=new Float32Array(i.length);for(let o=0;o<i.length;++o){const l=i[o];s[o]=l*l}return{dataId:r.write(s,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i3t=cr($T,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),s3t={kernelName:$T,backendName:"cpu",kernelFunc:i3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{begin:s,end:a,strides:o,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=r;Ct(i,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:g,sliceDim0:m,isSimpleSlice:y,begin:x,end:b,strides:_}=JW(i.shape,s,a,o,l,c,u,d,h);let T;if(g)T=Ir({inputs:{x:i},backend:n,attrs:{shape:p}});else if(m||y){q(i.shape.length>=1,()=>`Input must have rank at least 1, got: ${i.shape.length}`);const E=YW(x,b,_),C=Cg({inputs:{x:i},backend:n,attrs:{begin:x,size:E}});T=Ir({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else{const E=n.bufferSync(i),C=Xce(f,E,_,x);T=n.makeTensorInfo(p,C.dtype,C.values)}return T}const o3t={kernelName:UV,backendName:"cpu",kernelFunc:a3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l3t(t){const{inputs:e,backend:n,attrs:r}=t,{separator:i,nGramWidths:s,leftPad:a,rightPad:o,padWidth:l,preserveShortSequences:c}=r,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,g]=Kce(h,f,i,s,a,o,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",g)]}const c3t={kernelName:VV,backendName:"cpu",kernelFunc:l3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u3t(t){const{inputs:e,backend:n,attrs:r}=t,{skipEmpty:i}=r,{input:s,delimiter:a}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(s.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${s.shape}`);if(a.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${a.shape}`);const o=n.data.get(s.dataId).values,l=n.data.get(a.dataId).values[0],[c,u,d]=Yce(o,l,i),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const d3t={kernelName:WV,backendName:"cpu",kernelFunc:u3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h3t(t){const{inputs:e,backend:n,attrs:r}=t,{numBuckets:i}=r,{input:s}=e;if(s.dtype!=="string")throw new Error("Input must be of datatype string");if(i<=0)throw new Error("Number of buckets must be at least 1");const a=n.data.get(s.dataId).values,o=Zce(a,i);return n.makeTensorInfo(s.shape,"int32",o)}const f3t={kernelName:HV,backendName:"cpu",kernelFunc:h3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p3t=cr(PT,t=>Math.tan(t)),m3t={kernelName:PT,backendName:"cpu",kernelFunc:p3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3t=cr(OT,t=>Math.tanh(t)),y3t={kernelName:OT,backendName:"cpu",kernelFunc:g3t};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v3t(t){const{inputs:e,backend:n}=t,{tensor:r,indices:i,updates:s}=e,{sliceRank:a,numUpdates:o,sliceSize:l,strides:c,outputSize:u}=Qg(s,i,r.shape),d=!1,h=n.bufferSync(i),f=n.bufferSync(s),p=n.bufferSync(r),g=Nm(h,f,r.shape,u,l,o,a,c,p,d);return n.makeTensorInfo(r.shape,g.dtype,g.values)}const x3t={kernelName:OV,backendName:"cpu",kernelFunc:v3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b3t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{reps:s}=r;Ct(i,"tile");const a=Jce(n.bufferSync(i),s);return n.makeTensorInfo(a.shape,a.dtype,a.values)}const w3t={kernelName:DT,backendName:"cpu",kernelFunc:b3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S3t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i}=e,{k:s,sorted:a}=r;Ct(i,"topk");const o=n.data.get(i.dataId).values,[l,c]=tue(o,i.shape,i.dtype,s,a);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const _3t={kernelName:GV,backendName:"cpu",kernelFunc:S3t};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T3t(t){const{inputs:e,attrs:n,backend:r}=t,{image:i,transforms:s}=e,{interpolation:a,fillMode:o,fillValue:l,outputShape:c}=n,[u,d,h,f]=i.shape,[p,g]=c??[d,h],m=[u,p,g,f],y=Ft(i.shape),x=y[0],b=y[1],_=y[2],T=Ft(m),E=T[0],C=T[1],I=T[2],A=As(i.dtype,Oe(m));A.fill(l);const k=r.data.get(i.dataId).values,R=r.data.get(s.dataId).values;for(let z=0;z<u;++z){const O=s.shape[0]===1?R:R.subarray(z*8,z*8+8);for(let j=0;j<p;++j)for(let B=0;B<g;++B)for(let W=0;W<f;++W){let L;const V=O[6]*B+O[7]*j+1;if(V===0)continue;const H=(O[0]*B+O[1]*j+O[2])/V,K=(O[3]*B+O[4]*j+O[5])/V,te=Tte(H,h,o),J=Tte(K,d,o);switch(a){case"nearest":L=k3t(k,d,h,x,b,_,z,J,te,W,l);break;case"bilinear":L=M3t(k,d,h,x,b,_,z,J,te,W,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${a}`)}const oe=z*E+j*C+B*I+W;A[oe]=L}return r.makeTensorInfo(m,i.dtype,A)}return{dataId:r.write(A,m,i.dtype),shape:i.shape,dtype:i.dtype}}const E3t={kernelName:qV,backendName:"cpu",kernelFunc:T3t};function Tte(t,e,n){switch(n){case"reflect":return C3t(t,e);case"wrap":return N3t(t,e);case"nearest":return I3t(t,e);case"constant":default:return A3t(t)}}function C3t(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=2*e;n<r&&(n=r*Math.trunc(-n/r)+n),n=n<-e?n+r:-n-1}else if(n>e-1)if(e<=1)n=0;else{const r=2*e;n-=r*Math.trunc(n/r),n>=e&&(n=r-n-1)}return pg(0,n,e-1)}function N3t(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const r=e-1;n+=e*(Math.trunc(-n/r)+1)}else if(n>e-1)if(e<=1)n=0;else{const r=e-1;n-=e*Math.trunc(n/r)}return pg(0,n,e-1)}function A3t(t,e){return t}function I3t(t,e){return pg(0,t,e-1)}function e1(t,e,n,r,i,s,a,o,l,c,u){const d=a*r+o*i+l*s+c;return 0<=o&&o<e&&0<=l&&l<n?t[d]:u}function k3t(t,e,n,r,i,s,a,o,l,c,u){const d=Math.round(o),h=Math.round(l);return e1(t,e,n,r,i,s,a,d,h,c,u)}function M3t(t,e,n,r,i,s,a,o,l,c,u){const d=Math.floor(o),h=Math.floor(l),f=d+1,p=h+1,g=(p-l)*e1(t,e,n,r,i,s,a,d,h,c,u)+(l-h)*e1(t,e,n,r,i,s,a,d,p,c,u),m=(p-l)*e1(t,e,n,r,i,s,a,f,h,c,u)+(l-h)*e1(t,e,n,r,i,s,a,f,p,c,u);return(f-o)*g+(o-d)*m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R3t(t){const{inputs:e,attrs:n,backend:r}=t,{axis:i}=n,{x:s}=e;Ct(s,"unique");const a=r.data.get(s.dataId).values,{outputValues:o,outputShape:l,indices:c}=nue(a,i,s.shape,s.dtype);return[r.makeTensorInfo(l,s.dtype,o),r.makeTensorInfo([c.length],"int32",c)]}const P3t={kernelName:XV,backendName:"cpu",kernelFunc:R3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3t(t){const{inputs:e,backend:n,attrs:r}=t,{value:i}=e;let{axis:s}=r;s<0&&(s+=i.shape.length);const a=i.shape.length,o=i.shape[s],l=new Array(a-1);let c=0;for(let f=0;f<a;f++)f!==s&&(l[c++]=i.shape[f]);const u=new Array(a).fill(0),d=i.shape.slice();d[s]=1;const h=new Array(o);for(let f=0;f<h.length;f++){u[s]=f;const p=Cg({inputs:{x:i},backend:n,attrs:{begin:u,size:d}});h[f]=Ir({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const D3t={kernelName:uR,backendName:"cpu",kernelFunc:O3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3t(t){const{inputs:e,backend:n,attrs:r}=t,{x:i,segmentIds:s}=e,{numSegments:a}=r;Ct(i,"unsortedSegmentSum");const o=i.shape.length,l=s.shape.length,c=[],u=[],d=o-l;let h=s;for(let p=0;p<d;++p){const g=Mk({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=g,u.push(g)}for(let p=0;p<a;++p){const g=hp(p,"int32"),m=n.makeTensorInfo([],"int32",g),y=yce({inputs:{a:m,b:h},backend:n}),x=Kf({inputs:{x:y},backend:n,attrs:{dtype:"float32"}}),b=BR({inputs:{a:x,b:i},backend:n}),_=kE({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(_),u.push(m),u.push(y),u.push(x),u.push(b),u.push(_)}const f=vwe({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const L3t={kernelName:dR,backendName:"cpu",kernelFunc:$3t};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F3t=[RPt,sFe,OPt,$Pt,dFe,FPt,zPt,UPt,WPt,GPt,XPt,YPt,QPt,tOt,rOt,aOt,lOt,uOt,hOt,kPt,pOt,gOt,vOt,fFe,bOt,cFe,mFe,SOt,aFe,TOt,COt,NOt,IOt,MOt,POt,DOt,LOt,jOt,BOt,VOt,HOt,qOt,KOt,ZOt,QOt,eDt,nDt,iDt,sDt,aDt,oDt,cDt,hDt,_Pt,pDt,gFe,SDt,yFe,_Dt,xFe,IDt,kDt,RDt,wFe,_Fe,ODt,$Dt,FDt,zDt,EFe,NFe,oFe,UDt,EOt,WDt,GDt,XDt,TPt,IFe,MFe,YDt,PFe,QDt,t$t,r$t,a$t,l$t,u$t,d$t,DFe,f$t,m$t,y$t,x$t,w$t,_$t,E$t,LFe,N$t,k$t,P$t,jFe,BFe,$$t,j$t,U$t,VFe,W$t,G$t,q$t,xwe,Z$t,CPt,GFe,J$t,tLt,rLt,sLt,lFe,vB,oLt,NPt,APt,IPt,cLt,dLt,fLt,mLt,yLt,vLt,bLt,eje,SLt,NLt,ILt,PLt,nje,DLt,LLt,jLt,rje,M$t,ULt,WLt,GLt,XLt,YLt,QLt,e3t,n3t,aje,r3t,lje,uje,s3t,o3t,c3t,d3t,f3t,pje,uDt,m3t,y3t,x3t,w3t,_3t,E3t,WFe,P3t,D3t,L3t,H$t];for(const t of F3t)yae(t);Xre(document.getElementById("root")).render(v.jsx(_It,{}));
